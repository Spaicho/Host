!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){function n(e){return window.wizAssets&&window.wizAssets.initialize?void window.wizAssets.initialize(e,function(){console.error("failed to init wizAssets"),window.wizAssets=null,e()}):e()}function o(){if(f.isWebGlSupported()){var e=i(1345);window.isoEngine=new e,window.actorManager=window.isoEngine.actorManager,window.background=window.isoEngine.background}window.dofus.start()}i(1),i(2),i(3),i(4),i(5),i(6);var s=i(7),a=i(185);window.developmentMode=!1,window.buildVersion="1.47.4",console.log("Production variant is active");for(var r=window.location.search.slice(1).split(";"),l=0,c=r.length;l<c;l+=1){var u=r[l],d=u.split("=");"appVersion"===d[0]&&(window.appInfo=window.appInfo||{},window.appInfo.version=d[1])}a.isAndroid&&window.MobileAccessibility&&window.MobileAccessibility.usePreferredTextZoom(!1),window.assetPreloader=i(202),window.dofus=i(207);var h=document.createElement("div");h.id="dofusBody",document.body.appendChild(h);var p=i(380),m=i(476);window.gui=new m,window.foreground=new p;var f=i(445),g=window.chrome;"object"==typeof g&&g.system&&g.system.memory&&a.isPhoneGap?g.system.memory.getInfo(function(e){a.capacity=e.capacity,n(o)}):n(o),a.isCordova?a.isAndroid?window.cordova&&window.cordova.plugins&&window.cordova.plugins.isemulator?window.cordova.plugins.isemulator.assess(function(e){s.wKpi.sendPlatform(e?"emulator":"device")},function(e){console.error("cordova.plugins.isemulator.assess failed: "+e)}):console.error("cordova.plugins.isemulator plugin missing"):s.wKpi.sendPlatform("device"):s.wKpi.sendPlatform("browser")},function(e,t){},function(e,t){},function(e,t,i){!function(e,i){i(t)}(this,function(e){"use strict";function t(e){return e&&DataView.prototype.isPrototypeOf(e)}function i(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function n(e){return"string"!=typeof e&&(e=String(e)),e}function o(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return y.iterable&&(t[Symbol.iterator]=function(){return t}),t}function s(e){this.map={},e instanceof s?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function a(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function r(e){return new Promise(function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}})}function l(e){var t=new FileReader,i=r(t);return t.readAsArrayBuffer(e),i}function c(e){var t=new FileReader,i=r(t);return t.readAsText(e),i}function u(e){for(var t=new Uint8Array(e),i=new Array(t.length),n=0;n<t.length;n++)i[n]=String.fromCharCode(t[n]);return i.join("")}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:y.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:y.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():y.arrayBuffer&&y.blob&&t(e)?(this._bodyArrayBuffer=d(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||w(e))?this._bodyArrayBuffer=d(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?a(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(l)}),this.text=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return c(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(e){var t=e.toUpperCase();return M.indexOf(t)>-1?t:e}function m(e,t){t=t||{};var i=t.body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new s(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new s(t.headers)),this.method=p(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function f(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var i=e.split("="),n=i.shift().replace(/\+/g," "),o=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}}),t}function g(e){var t=new s,i=e.replace(/\r?\n[\t ]+/g," ");return i.split(/\r?\n/).forEach(function(e){var i=e.split(":"),n=i.shift().trim();if(n){var o=i.join(":").trim();t.append(n,o)}}),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new s(t.headers),this.url=t.url||"",this._initBody(e)}function v(t,i){return new Promise(function(n,o){function s(){r.abort()}var a=new m(t,i);if(a.signal&&a.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var r=new XMLHttpRequest;r.onload=function(){var e={status:r.status,statusText:r.statusText,headers:g(r.getAllResponseHeaders()||"")};e.url="responseURL"in r?r.responseURL:e.headers.get("X-Request-URL");var t="response"in r?r.response:r.responseText;n(new _(t,e))},r.onerror=function(){o(new TypeError("Network request failed"))},r.ontimeout=function(){o(new TypeError("Network request failed"))},r.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},r.open(a.method,a.url,!0),"include"===a.credentials?r.withCredentials=!0:"omit"===a.credentials&&(r.withCredentials=!1),"responseType"in r&&y.blob&&(r.responseType="blob"),a.headers.forEach(function(e,t){r.setRequestHeader(t,e)}),a.signal&&(a.signal.addEventListener("abort",s),r.onreadystatechange=function(){4===r.readyState&&a.signal.removeEventListener("abort",s)}),r.send("undefined"==typeof a._bodyInit?null:a._bodyInit)})}var y={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(y.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=ArrayBuffer.isView||function(e){return e&&b.indexOf(Object.prototype.toString.call(e))>-1};s.prototype.append=function(e,t){e=i(e),t=n(t);var o=this.map[e];this.map[e]=o?o+", "+t:t},s.prototype["delete"]=function(e){delete this.map[i(e)]},s.prototype.get=function(e){return e=i(e),this.has(e)?this.map[e]:null},s.prototype.has=function(e){return this.map.hasOwnProperty(i(e))},s.prototype.set=function(e,t){this.map[i(e)]=n(t)},s.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)},s.prototype.keys=function(){var e=[];return this.forEach(function(t,i){e.push(i)}),o(e)},s.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),o(e)},s.prototype.entries=function(){var e=[];return this.forEach(function(t,i){e.push([i,t])}),o(e)},y.iterable&&(s.prototype[Symbol.iterator]=s.prototype.entries);var M=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},h.call(m.prototype),h.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new s(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var T=[301,302,303,307,308];_.redirect=function(e,t){if(T.indexOf(t)===-1)throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.DOMException=self.DOMException;try{new e.DOMException}catch(C){e.DOMException=function(e,t){this.message=e,this.name=t;var i=Error(e);this.stack=i.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}v.polyfill=!0,self.fetch||(self.fetch=v,self.Headers=s,self.Request=m,self.Response=_),e.Headers=s,e.Request=m,e.Response=_,e.fetch=v,Object.defineProperty(e,"__esModule",{value:!0})})},function(e,t){"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e,t){return void 0===t&&(t=0),this.slice(t,e.length+t)===e}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e,t){var i=this.toString();(void 0===t||t>i.length)&&(t=i.length),t-=e.length;var n=i.indexOf(e,t);return n!==-1&&n===t})},function(e,t){/*! https://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||!function(){"use strict";var e=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(n){}return i}(),t=function(e){if(null==this)throw TypeError();var t=String(this),i=t.length,n=e?Number(e):0;if(n!=n&&(n=0),!(n<0||n>=i)){var o,s=t.charCodeAt(n);return s>=55296&&s<=56319&&i>n+1&&(o=t.charCodeAt(n+1),o>=56320&&o<=57343)?1024*(s-55296)+o-56320+65536:s}};e?e(String.prototype,"codePointAt",{value:t,configurable:!0,writable:!0}):String.prototype.codePointAt=t}()},function(e,t){/*! http://mths.be/fromcodepoint v0.2.1 by @mathias */
String.fromCodePoint||!function(){var e=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(n){}return i}(),t=String.fromCharCode,i=Math.floor,n=function(e){var n,o,s=16384,a=[],r=-1,l=arguments.length;if(!l)return"";for(var c="";++r<l;){var u=Number(arguments[r]);if(!isFinite(u)||u<0||u>1114111||i(u)!=u)throw RangeError("Invalid code point: "+u);u<=65535?a.push(u):(u-=65536,n=(u>>10)+55296,o=u%1024+56320,a.push(n,o)),(r+1==l||a.length>s)&&(c+=t.apply(null,a),a.length=0)}return c};e?e(String,"fromCodePoint",{value:n,configurable:!0,writable:!0}):String.fromCodePoint=n}()},function(e,t,i){i(8),e.exports=i(9)},function(e,t,i){var n=i(9),o=i(201),s=0;n.logTutorialStepStart=function(e){var t=o.STEP_START[e];t&&(s=Date.now(),n.log(t))},n.logTutorialStepEnd=function(e){var t=o.STEP_END[e];if(t){var i=Math.ceil((Date.now()-s)/1e3);s=0,n.log(o.STEP_END[e],{time_spent_on_action:i})}},n.logTutorialSubStep=function(e,t){var i=o.SUB_STEP[e];i&&i[t]&&n.log(i[t])}},function(e,t,i){function n(e,t,i){c.length>50&&(console.error("The stackEvent exceed 50 events, the stack is trash"),c=[]),i.override&&c.forEach(function(t,i){e===t.name&&c.splice(i,1)}),c.push({name:e,data:t,options:i})}function o(){for(;c.length;){var e=c.shift();t.log(e.name,e.data,e.options)}}var s=i(10),a=i(19),r=i(42),l=i(182),c=[],u=!1;t.init=function(e){e=e||{};var t=e.wizAnalytics;for(var n in t){var o=t[n];s.register(n,o.token,o.options)}a.init(e.ankAnalytics),i(197)},t.register=function(e,t,i){a.register(t),s.freeze(e,i),u=!0,o()},t.unregister=function(){u=!1,a.unregister()},t.log=function(e,t,i){if(t=t||{},i=i||{},!u)return void n(e,t,i);i.withPlayerInfo!==!1&&l.addCharacterInfo(t),i.withEquipment&&l.addEquippedItem(t,window.gui.playerData);var o;try{o=JSON.parse(JSON.stringify(t))}catch(c){var d='Analytics: unable to duplicate KPI data for event "'+e+'" ('+(c.message||c)+")";console.error(d),o=null}return o?(l.addAccountId(o),i.withResolution&&l.addResolution(o),i.withSubscriptionInfo&&l.addSubscriptionInfo(o)):o=t,s.send(e,o),i.wizAnalyticsOnly?void("Currency.BidHouse_Buy_Success"!==e&&"Currency.Shop_Buy_Success"!==e||r.logger(e,o)):void a.send(e,t)},t.wKpi=r},function(e,t,i){function n(e,t,n){try{var o=i(11)("./"+e+"/index.js");o.init(t,n),l.push(o)}catch(s){console.error("Analytics Error: Initialization failed",e,s)}}function o(e,t){for(var i=0;i<l.length;i+=1){var n=l[i];if(n.idendity)try{n.idendity(e.valueOf())}catch(o){console.error("Analytics Error: couldn't set identity",n.name,o)}if(n.register)try{n.register(t)}catch(o){console.error("Analytics Error: couldn't freeze data",n.name,o)}}}function s(e,t){for(var i=0;i<l.length;i+=1){var n=l[i];try{n.log(e,t)}catch(o){console.error("Analytics Error: couldn't log",e,n.name,o)}}}function a(e){for(var t=0;t<l.length;t+=1){var i=l[t];if(i.screen)try{i.screen(e)}catch(n){console.error("Analytics Error: not able to register the screen",i.name,n)}}}function r(e,t){for(var i=0;i<l.length;i+=1){var n=l[i];if(n.revenue)try{n.revenue(e,t)}catch(o){console.error("Analytics Error: couldn't log revenue",n.name,o)}}}var l=[];t.freeze=o,t.send=s,t.screen=a,t.revenue=r,t.register=n},function(e,t,i){function n(e){return i(o(e))}function o(e){return s[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var s={"./analog/index.js":12,"./flurry/index.js":13,"./localytics/index.js":15,"./mixpanel/index.js":17};n.keys=function(){return Object.keys(s)},n.resolve=o,e.exports=n,n.id=11},function(e,t){t.name="analog",t._basicData={},t.init=function(e){console.log("inititialized with: ",e)},t.idendity=function(e){console.log("Freeze ID: ",e.valueOf())},t.register=function(e){for(var i in e)t._basicData["_"+i]=e[i];console.log("Freeze data: ",e)},t.log=function(e,i){i=i||{};for(var n in t._basicData)i[n]=i[n]||t._basicData[n];console.log("Logging",e,i)},t.screen=function(e){console.log("Screen",e)},t.revenue=function(e){console.log("Revenue",e)}},function(e,t,i){t.name="flurry",t.init=function(e){i(14),t._flurry=window.FlurryAgent,t._flurry.startSession(e)},t.idendity=function(e){t._flurry.setUserId(e)},t.register=function(e){t._basicData=e||{}},t.log=function(e,i){i=i||{};for(var n in t._basicData)i[n]=i[n]||t._basicData[n];t._flurry.logEvent(e,i)},t.screen=function(e){t._flurry.logEvent("screen",{view:e})}},function(e,t){!function(){function e(e){throw e}function t(e,t){function i(){this.constructor=e}for(var n in t)g.call(t,n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i,e.wa=t.prototype}var i,n,o,s,a,r,l,c,u,d,h,p=!0,m=null,f=!1,g={}.hasOwnProperty;i=function(e,t,i,n,o){o==m&&(o=h),o.n(e),o.l(e),o.N(e),o.o(t),o.z(t),o.p(t.length,255),o.n(n),o.l(n),this.ce=e,this.bp=t,this.bq=n,i?(o.Ua(i),this.bs=i):this.bs={}},n=function(){function e(){}return e.ia=function(e){var t,i,n,o,s,a,r,l,c,e=this.Ob(e);for(r="",n=l=0,c=e.length;l<c;n=l+=3)t=e.charCodeAt(n),i=e.charCodeAt(n+1),n=e.charCodeAt(n+2),o=t>>2,t=(3&t)<<4|i>>4,s=(15&i)<<2|n>>6,a=63&n,isNaN(i)?s=a=64:isNaN(n)&&(a=64),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(s)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a);return r},e.lb=function(e){var t,i,n,o,s,a,r,l,e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(a="",s=r=0,l=e.length;r<l;s=r+=4)t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(s)),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(s+1)),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(s+2)),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(s+3)),t=t<<2|i>>4,i=(15&i)<<4|o>>2,n=(3&o)<<6|s,a+=String.fromCharCode(t),64!==o&&(a+=String.fromCharCode(i)),64!==s&&(a+=String.fromCharCode(n));return a=this.Nb(a)},e.Ob=function(e){var t,i,n,o,e=e.replace(/\r\n/g,"\n");for(i="",t=n=0,o=e.length;0<=o?n<o:n>o;t=0<=o?++n:--n)t=e.charCodeAt(t),t<128?i+=String.fromCharCode(t):(t>127&&t<2048?i+=String.fromCharCode(t>>6|192):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128)),i+=String.fromCharCode(63&t|128));return i},e.Nb=function(e){var t,i,n,o,s;for(s="",o=0;o<e.length;)t=e.charCodeAt(o),t<128?(s+=String.fromCharCode(t),o++):t>191&&t<224?(i=e.charCodeAt(o+1),s+=String.fromCharCode((31&t)<<6|63&i),o+=2):(i=e.charCodeAt(o+1),n=e.charCodeAt(o+2),s+=String.fromCharCode((15&t)<<12|(63&i)<<6|63&n),o+=3);return s},e}(),o=function(){function e(){}return e.bb=function(e){var t,i,n,o,s;for(t=1,i=0,n=o=0,s=e.length;0<=s?o<s:o>s;n=0<=s?++o:--o)n=e.charCodeAt(n),t+=n,i+=t;return t%=65521,i%=65521,65536*i+t},e}(),s=function(e){function i(e,t,n,o,s,a){a==m&&(a=h),a.M(o),i.wa.constructor.call(this,e,t,n,s),this.timed=o,this.br=0}return t(i,e),i}(i),a=function(){function t(){}var i;return i=function(e){var t,i;i={};try{t=n.lb(e),i=JSON.parse(t)}catch(o){console.log(o)}return i},t.ga=function(e,t){return(t?this.Da:"")+{install:"fit",session:"fs",lastPoll:"flp",firstPartyCookie:"fid"}[e]},t.i=p,t.appVersion="",t.O="",t.Ha=0,t.ka=Date.now(),t.Da=m,t.F=m,t.Ka=p,t.Bb=p,t.Qa=f,t.Ea=f,t.localStorage=f,t.fa=m,t.Ja="",t.referrer="",t.J=0,t.e=m,t.$=[],t.w=m,t.Y=5e3,t.ea=m,t.I=f,t.Z=m,t.h=function(e){if(this.Qa)return"string"==typeof e?this.g(""+e):this.g(""+e.name+"=>"+e.message)},t.g=function(e){if(this.Ea)return console.log("Flurry "+new Date+": "+e)},t.Ub=function(){},t.ub=function(){return this.g("getFlurryAgentVersion() called"),9},t.da=function(e){this.g("setAppVersion("+e+") called");try{return h.o(e),h.z(e),h.p(e.length,255),this.appVersion=e,this.e&&this.e.da(e),this.i=p}catch(t){return this.h(t)}},t.ua=function(e){this.g("setUserId("+e+") called");try{return h.j(this.e),h.o(e),h.z(e),h.p(e.length,"userId"),this.e.ua(e),this.i=p}catch(t){return this.h(t)}},t.ra=function(e){this.g("setGender("+e+") called");try{return h.j(this.e),h.o(e),h.Ta(e,{m:1,f:0}),this.e.ra(e),this.i=p}catch(t){return this.h(t)}},t.qa=function(e){this.g("setAge("+e+") called");try{return h.j(this.e),h.n(e),h.l(e),h.N(e),h.va(e),this.e.qa(e),this.i=p}catch(t){return this.h(t)}},t.sa=function(e,t,i){i==m&&(i=0),this.g("setLocation("+e+","+t+","+i+") called");try{return h.j(this.e),h.n(e),h.l(e),h.n(t),h.l(t),h.n(i),h.l(i),this.e.sa(e,t,i),this.i=p}catch(n){return this.h(n)}},t.mb=function(){this.Ja=navigator.platform},t.nb=function(){this.referrer=document.referrer},t.ib=function(){this.mb(),this.nb()},t.L=function(e){this.g("setSessionContinueSeconds("+e+") called");try{if(h.n(e),h.l(e),h.N(e),h.va(e),this.J=e,this.e)return this.e.L(e)}catch(t){return this.h(t)}},t.Jb=function(e){this.g("setShowErrorInLogEnabled("+e+") called");try{return h.M(e),this.Qa=e}catch(t){return this.h(t)}},t.Gb=function(e){this.g("setDebugLogEnabled("+e+") called");try{return h.M(e),this.Ea=e}catch(t){return this.h(t)}},t.Ib=function(e){this.g("setLocalStorageEnabled("+e+") called");try{h.M(e),this.localStorage=e}catch(t){this.h(t)}},t.kb=function(){var e,t,i=this;t=window.onfocus,window.onfocus=function(){if(i.g("ACTIVE"),t!=m&&t(),i.e)return i.e.Ma()?i.ta():(i.A(),i.Ra(i.O))},e=window.onblur,window.onblur=function(){var t;if(i.g("PAUSE"),e!=m&&e(),i.e&&(t=Date.now(),i.e.Pa(t),i.Q(),i.Bb))return i.q()}},t.jb=function(){var e;(e=parseInt(this.G("install")))?this.ka=e:this.K("install",this.ka)},t.Ca=function(){var e;(e=this.G("firstPartyCookie",f))?this.F=e:this.F!==m&&this.K("firstPartyCookie",this.F,f)},t.Fb=function(){this.Da=n.ia(this.O).replace("=","")+"_"},t.G=function(e,t){var i,n,o,s,a,r,l;for(t==m&&(t=p),a=this.ga(e,t),n=document.cookie.split(";"),r=0,l=n.length;r<l;r++)if(i=n[r],s=i.indexOf("="),o=i.slice(0,s).trim(),o===a)return i.slice(s+1);return m},t.eb=function(){return this.G("install")!=m},t.ha=function(e){var t;return t==m&&(t=p),document.cookie=""+this.ga(e,t)+"=; expires='Thu, 01 Jan 1970 00:00:00 GMT'; path=/"},t.K=function(e,t,i){var n;i==m&&(i=p),n=new Date,n.setTime(Date.now()+31536e7),document.cookie=this.ga(e,i)+"="+t+"; expires="+n.toGMTString()+"; path=/"},t.ta=function(e){var t=this;try{e&&h.va(1e3*e-5e3),h.j(this.e)}catch(i){return void this.h(i)}return this.Q(),e&&(this.Y=1e3*e),this.fa=window.setInterval(function(){return t.ea=Date.now(),t.K("lastPoll",t.ea),t.q()},this.Y),this.ea&&Date.now()-this.ea>this.Y&&this.q(),this.Y/1e3},t.Q=function(){this.fa&&window.clearInterval(this.fa),this.fa=m},t.$a=function(){var e,t,n;return t=this.G("session"),e=this.G("lastPoll"),this.ha("session"),this.ha("lastPoll"),t!=m&&e!=m&&(this.g("found paused session"),t=i(t),t[d.c.r]=e,e=new d(t),this.J&&e.L(this.J),e.Ma()&&(this.g("paused session resumed"),n=e)),n||(this.g("creating new session"),n=new d,this.J&&n.L(this.J)),this.appVersion&&n.da(this.appVersion),n},t.Ra=function(t){this.g("startSession("+t+") called");try{if(!this.e)return h.o(t),h.z(t),h.p(t,255),this.O=t,this.Fb(),this.i=p,this.e=this.$a(),this.jb(),this.Ca(),this.eb()||(this.Ka=f,this.A(),e("CookieError=>session ending since cookies not enabled!")),this.Ha||(this.ib(),this.kb()),this.ta(),this.q(),this.Ha++}catch(i){return this.h(i)}},t.A=function(){this.g("endSession() called");try{if(this.Q(),this.e)return this.e.A(),this.i=p,this.Ka?this.q():this.$.push(this.e),this.e=m,this.ha("session")}catch(e){return this.h(e)}},t.yb=function(){this.g("pauseSession() called");try{return this.Q(),this.Na(),this.e?(this.q(),this.e=m):this.g("no session to pause!")}catch(e){return this.h(e)}},t.Na=function(){var e;try{h.j(this.e),e=Date.now(),this.e.Pa(e),this.Tb=e,this.K("session",this.e.Ya()),this.K("lastPoll",e)}catch(t){this.h(t)}},t.t=function(e,t,i){t==m&&(t={}),i==m&&(i=f),this.g("logEvent("+e+","+t+","+i+") called");try{return h.j(this.e),this.e.Wa(e,t,i),this.i=p}catch(n){return this.h(n)}},t.qb=function(e,t){t==m&&(t=m),this.g("endTimedEvent("+e+","+t+") called");try{return h.j(this.e),this.e.pb(e,t),this.i=p}catch(i){return this.h(i)}},t.k=function(){var e,t,i,n,o;t=[];try{for(h.j(this.e),o=this.e[d.c.k],i=0,n=o.length;i<n;i++)e=o[i],t.push(e.bp)}catch(s){this.h(s)}return t},t.Hb=function(e){this.g("setEventLogging("+e+") called");try{return h.j(this.e),h.M(e),this.e.ja=e}catch(t){return this.h(t)}},t.U=function(e,t,i,n){t==m&&(t=0),i==m&&(i="USD"),n==m&&(n={}),this.g("logPurchase("+e+","+t+","+i+","+n+") called");try{return h.j(this.e),this.e.Xa(e,t,i,n),this.i=p}catch(o){return this.h(o)}},t.wb=function(e,t,i){i==m&&(i=0),this.g("logError("+e+","+t+","+i+") called");try{return h.j(this.e),this.e.Va(e,t,i),this.i=p}catch(n){return this.h(n)}},t.q=function(){var e;this.g("REQUEST INITIATED");try{if(!this.I&&(this.w?this.w.Kb():this.i&&(e=new u,e.Za(this.appVersion,this.O,this.ka,this.Ja,this.Rb,this.referrer,this.e,this.$,this.F),this.w=e.request,this.fb(e)),this.w))return this.Na(),this.rb(JSON.stringify(this.w))}catch(t){return this.h(t)}},t.fb=function(e){this.e.gb(e.sessionIncluded.events,e.sessionIncluded.purchases,e.sessionIncluded.errors),this.$=this.$.slice(e.sessionsIncluded),0===e.level&&(this.i=f)},t.rb=function(e){var t,i=this;return this.g("REQUEST EXECUTED"),this.I=p,this.Z=window.setInterval(function(){return i.P(f)},1e4),t=document.createElement("script"),t.type="text/javascript",t.async=p,t.src=encodeURI(c.Fa+"?d="+n.ia(e)+"&c="+o.bb(e)),e=document.getElementsByTagName("script"),e[0].parentNode.insertBefore(t,e[0])},t.Cb=function(t){this.g("RESPONSE RECEIVED");try{if(this.I||e("ResponseError=>request considered timed out!"),"object"!=typeof t&&(this.P(f),e("ResponseError=>input is not a valid object!")),t.a!=m&&t.a>0?this.P(p):this.P(f),t.b!=m&&this.Ib(t.b),t.d!=m&&(this.F=t.d,this.Ca(),this.i=p),this.i)return this.q()}catch(i){return this.h(i)}},t.P=function(e){if(this.g("CLEAR REQUEST with "+e),this.I)return this.Z&&window.clearInterval(this.Z),e&&(this.w=m),this.I=f,this.Z=m},t}(),window.FlurryAgent=a,a.setAppVersion=a.da,a.getFlurryAgentVersion=a.ub,a.setShowErrorInLogEnabled=a.Jb,a.setDebugLogEnabled=a.Gb,a.setSessionContinueSeconds=a.L,a.setRequestInterval=a.ta,a.startSession=a.Ra,a.endSession=a.A,a.pauseSession=a.yb,a.logEvent=a.t,a.endTimedEvent=a.qb,a.timedEvents=a.k,a.logError=a.wb,a.logPurchase=a.U,a.setUserId=a.ua,a.setAge=a.qa,a.setGender=a.ra,a.setLocation=a.sa,a.setEventLogging=a.Hb,a.requestCallback=a.Cb,r=function(e,t,i,n,o){o==m&&(o=h),o.n(e),o.l(e),o.N(e),o.o(t),o.z(t),o.p(t.length,255),o.o(i),o.z(i),o.p(i.length,255),o.n(n),o.l(n),o.N(n),this.cf=e,this.bz=t,this.ca=i,this.cb=n.toString(),this.cc=Date.now()},l=function(e){function i(e,t,o,s,a,r,l){l==m&&(l=h),l.n(o),l.l(o),l.Qb(o),l.o(s),l.Ta(s,n),i.wa.constructor.call(this,e,t,a,r),this.bw=100*o,this.bx=n[s]}var n;return t(i,e),n={USD:0,EUR:1,GBP:2,CHF:3},i}(i),c=function(){function e(n,o,s,a,r,l,c,u,h,p,f){for(this.a={},this.a.af=Date.now(),this.a.aa=t,this.a.ab=n,this.a.ac=o,this.a.ae=s,this.a.ad=a,this.a.ag=r,this.a.ah=h[d.c.timestamp],e.g("about to check if firstPartyCookieUID "+f+" should be assigned to global map in the report request"),f!==m&&(this.a.cg=f,e.g("firstPartyCookieUID "+f+" was assigned to global map")),0===h.requestsMade&&(this.a.ai=l,this.a.aj=u,h.Db()),this.a.ak=i,this.b=[],h&&(h.Oa(),s=e.za(h),this.b.push(s)),n=0,o=p.length;n<o;n++)s=p[n],s=e.za(s),this.b.push(s)}var t,i;return i=t=1,e.Ab={timedEvents:"timedEvents",eventLogging:"eventLogging",sessionContinue:"sessionContinue",pauseTimestamp:"pauseTimestamp",age:"age",numEventNames:"numEventNames",numPurchaseNames:"numPurchaseNames",requestsMade:"requestsMade",totalEventNames:"totalEventNames",totalPurchaseNames:"totalPurchaseNames",numEventsLogged:"numEventsLogged",numPurchasesLogged:"numPurchasesLogged",numErrorsLogged:"numErrorsLogged",eventCounter:"eventCounter",purchaseCounter:"purchaseCounter",errorCounter:"errorCounter"},e.zb={timed:"timed"},e.Fa="https://data.flurry.com/aah.do",e.g=function(){},e.Sb=function(){return this.Fa},e.hb=function(e){var t,i,n;i={};for(t in e)n=e[t],this.zb.hasOwnProperty(t)||(i[t]=n);return i},e.za=function(e){var t,i,n,o,s,a;n={};for(i in e)if(o=e[i],i===d.c.location)o.bg!=m&&(n[i]=o);else if(i===d.c.D)for(n[i]=[],s=0,a=o.length;s<a;s++)t=o[s],n[i].push(this.hb(t));else this.Ab.hasOwnProperty(i)||(n[i]=o);return n},e.prototype.Kb=function(){this.a.af=Date.now()},e}(),u=function(){function t(){this.sessionsIncluded=0,this.sessionIncluded={},this.request={},this.level=0}return t.g=function(){},t.prototype.Za=function(t,i,n,o,s,a,r,l,u){for(this.request=new c(10,9,t,i,n,o,s,a,r,l,u),i=[];;){if(4===this.level&&e("RequestError=>request length is set too short!"),t=JSON.stringify(this.request),4*t.length/3<=3e3){this.sessionsIncluded=this.request.b.length-1,this.sessionIncluded.events=this.request.b[0].bo.length,this.sessionIncluded.purchases=this.request.b[0].bv.length,this.sessionIncluded.errors=this.request.b[0].by.length;break}i.push(this.request=this.xb(this.request))}},t.prototype.xb=function(e){switch(this.level){case 0:1===e.b.length?this.level=1:e.b=this.R(e.b);break;case 1:0===e.b[0].by.length?this.level=2:e.b[0].by=this.R(e.b[0].by);break;case 2:0===e.b[0].bv.length?this.level=3:e.b[0].bv=this.R(e.b[0].bv);break;case 3:0===e.b[0].bo.length?this.level=4:e.b[0].bo=this.R(e.b[0].bo)}return e},t.prototype.R=function(e){var t;return e.length>=1&&(t=parseInt(e.length/2),e=e.slice(0,t)),e},t}(),d=function(){function t(e){e==m&&(e={}),this[t.c.appVersion]="",this[t.c.Sa]="",this[t.c.Ga]=-1,this[t.c.xa]=0,this[t.c.ya]=0,this[t.c.location]={},this[t.c.vb]=t.sb(),this[t.c.k]=e[t.c.k]||[],this[t.c.C]=e[t.c.C]||0,this[t.c.D]=[],this[t.c.V]=0,this[t.c.Aa]=f,this[t.c.T]={},this[t.c.s]={},this[t.c.ma]=0,this[t.c.H]=e[t.c.H]||0,this[t.c.X]=[],this[t.c.W]=0,this[t.c.Ba]=f,this[t.c.oa]={},this[t.c.v]={},this[t.c.na]=0,this[t.c.B]=e[t.c.B]||0,this[t.c.S]=[],this[t.c.la]=0,this[t.c.Ia]=0,this.ba=e[t.c.timestamp]||Date.now(),this[t.c.duration]=0,this[t.c.ja]=p,this[t.c.pa]=i,this[t.c.r]=e[t.c.r]||0,this[t.c.u]=e[t.c.u]||-1,this[t.c.La]=0,this[t.c.Lb]=t.tb()}var i;return t.c={appVersion:"bd",Sa:"be",Ga:"bk",xa:"age",ya:"bl",location:"bf",vb:"bj",k:"timedEvents",C:"eventCounter",D:"bo",V:"numEventsLogged",Aa:"bm",T:"totalEventNames",s:"bn",ma:"numEventNames",H:"purchaseCounter",X:"bv",W:"numPurchasesLogged",Ba:"bt",oa:"totalPurchaseNames",v:"bu",na:"numPurchaseNames",B:"errorCounter",S:"by",la:"numErrorsLogged",Ia:"cd",timestamp:"ba",duration:"bb",ja:"eventLogging",pa:"sessionContinue",r:"pauseTimestamp",u:"bc",La:"requestsMade",Lb:"ch"},i=3e5,t.sb=function(){var e;return e="",navigator.language!=m?e=navigator.language:navigator.Mb!=m&&(e=navigator.Mb),e},t.tb=function(){var e;return e=(new Date).getTimezoneOffset()/60,"Etc/GMT"+(e>0?"+":"-")+Math.abs(e)},t.prototype.Db=function(){this[t.c.La]++},t.prototype.da=function(e){return this[t.c.appVersion]=e},t.prototype.ua=function(e){return this[t.c.Sa]=e},t.prototype.ra=function(e){return this[t.c.Ga]="f"===e?0:1},t.prototype.qa=function(e){return this.Eb(e),this[t.c.xa]=e},t.prototype.Eb=function(e){var i;i=new Date,this[t.c.ya]=new Date(i.getFullYear()-e,i.getMonth(),1).getTime()},t.prototype.sa=function(e,i,n){return this[t.c.location]={bg:e,bh:i,bi:n}},t.prototype.L=function(e){return this[t.c.pa]=1e3*e},t.prototype.Oa=function(){this[t.c.duration]=Date.now()-this[t.c.timestamp]},t.prototype.gb=function(e,i,n){this[t.c.D]=this[t.c.D].slice(e),this[t.c.s]={},this[t.c.X]=this[t.c.X].slice(i),this[t.c.v]={},this[t.c.S]=this[t.c.S].slice(n)},t.prototype.A=function(){if(this.ob(),this.Oa(),this[t.c.V]<1e3&&(this[t.c.Aa]=f),this[t.c.W]<100)return this[t.c.Ba]=f},t.prototype.Pa=function(e){this[t.c.r]=e},t.prototype.Ma=function(){var e;return e=this[t.c.r]>0?Date.now()-this[t.c.r]:0,e>0&&(this[t.c.u]===-1&&(this[t.c.u]=0),this[t.c.u]+=e,this[t.c.r]=0),e<this[t.c.pa]},t.prototype.Ya=function(){var e,i,o,s,a;for(e={},o=[t.c.timestamp,t.c.u,t.c.C,t.c.H,t.c.B,t.c.k],s=0,a=o.length;s<a;s++)i=o[s],e[i]=this[i];return n.ia(JSON.stringify(e))},t.prototype.t=function(e){if(this[t.c.ja]&&this[t.c.V]<1e3)return e.timed&&!e.br?this[t.c.k].push(e):(this[t.c.D].push(e),this[t.c.V]++)},t.prototype.Wa=function(i,n,o){this[t.c.C]++,n=new s(this[t.c.C],i,n,o,Date.now()-this[t.c.timestamp]),i in this[t.c.T]?(this[t.c.T][i]++,i in this[t.c.s]?this[t.c.s][i]++:this[t.c.s][i]=1,this.t(n)):this[t.c.ma]<100?(this[t.c.T][i]=this[t.c.s][i]=1,this[t.c.ma]++,this.t(n)):e("LogError=>unique name limit reached!")},t.prototype.pb=function(e,i){var n,o,s,a,r;for(o=0,r=this[t.c.k],s=0,a=r.length;s<a;s++){if(n=r[s],n.bp===e){n.br=Date.now()-(this[t.c.timestamp]+n.bq),i&&h.Ua(i)&&(n.bs=i),this.t(n);break}o++}this[t.c.k].splice(o,1)},t.prototype.ob=function(){var e,i,n,o;for(o=this[t.c.k],i=0,n=o.length;i<n;i++)e=o[i],e.br=Date.now()-(this[t.c.timestamp]+e.bq),this.t(e);this[t.c.k]=[]},t.prototype.U=function(e){if(this[t.c.W]<100)return this[t.c.X].push(e),this[t.c.W]++},t.prototype.Xa=function(i,n,o,s){this[t.c.H]++,n=new l(this[t.c.H],i,n,o,s,Date.now()-this[t.c.timestamp]),i in this[t.c.oa]?(this.totalPurchaseNames[i]++,i in this[t.c.v]?this[t.c.v][i]++:this[t.c.v][i]=1,this.U(n)):this[t.c.na]<10?(this[t.c.oa][i]=this[t.c.v][i]=1,this[t.c.na]++,this.U(n)):e("PurchaseError=>unique name limit reached!")},t.prototype.Va=function(e,i,n){this[t.c.B]++,e=new r(this[t.c.B],e,i,n),this[t.c.la]<10&&(this[t.c.S].push(e),this[t.c.la]++),this[t.c.Ia]++},t}(),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),h=function(){function t(){}return t.M=function(t){"boolean"!=typeof t&&e("ValidationError=>input is not valid!")},t.n=function(t){"number"!=typeof t&&e("ValidationError=>input is not valid!")},t.o=function(t){"string"!=typeof t&&e("ValidationError=>input is not valid!")},t.Pb=function(t){"object"!=typeof t&&e("ValidationError=>input is not valid!")},t.N=function(t){t!==parseInt(t)&&e("ValidationError=>input is not valid!")},t.z=function(t){t.trim()||e("ValidationError=>input is not valid!")},t.p=function(t,i){t>i&&e("ValidationError=>input is not valid!")},t.l=function(t){isNaN(t)&&e("ValidationError=>input is not valid!")},t.Qb=function(t){t===parseInt(t)||t.toFixed(2)===t.toString()||t.toFixed(1)===t.toString()||e("ValidationError=>input is not valid!")},t.Ta=function(t,i){i.hasOwnProperty(t)||e("ValidationError=>input is not valid!")},t.va=function(t){t<0&&e("ValidationError=>input is not valid!")},t.j=function(t){t||e("ValidationError=>input does not exist!")},t.Ua=function(e){var t,i,n;this.Pb(e),i=1;for(t in e)n=e[t],this.o(t),this.p(t.length,255),this.o(n),this.p(n.length,255),this.p(i,10),i++;return p},t}()}()},function(e,t,i){t.name="localytics";var n;t.init=function(e,o){var s=i(16);o=o||{},o.useCustomerId=!0,o.sessionTimeoutSeconds=o.sessionTimeoutSeconds||!1,o.polling=o.polling||0,t._localyticsSession=s(e,o),n=o.defaultDimension,t._localyticsSession.open(),t._localyticsSession.upload()},t.idendity=function(e){t._localyticsSession.setCustomerId(e)},t.register=function(e){for(var i in e)t._localyticsSession.setIdentifier("customer_"+i,e[i])};var o=null;t.log=function(e,i){t._localyticsSession.tagEvent(e,i,n),o||(o=window.setTimeout(function(){t._localyticsSession.upload(),o=null},1e3))},t.screen=function(e){t._localyticsSession.tagScreen(e)},t.revenue=function(e,i){t._localyticsSession.tagEvent("revenue",{price:e},i,e),t._localyticsSession.upload()}},function(e,t){/*!
	 * Localytics HTML5/JavaScript Library
	 * Copyright (C) 2013 Char Software Inc., DBA Localytics
	 *
	 * This code is provided under the Localytics Modified BSD License.
	 * A copy of this license is available at
	 * http://www.localytics.com/docs/opensourceinfo/#license-documentation
	 *
	 * Please visit www.localytics.com for more information.
	 */
var i=function(e,t){var i=function(e){},n=function(){return console&&console.log?function(e){console.log(e)}:i}(),o=i,s={},a={};s.setItem=function(e,t){try{window.localStorage.setItem(e,t)}catch(i){o("setItem failed by exception.")}a[e]=t.toString()},s.getItem=function(e){var t=null;try{t=window.localStorage.getItem(e)}catch(i){o("getItem failed by exception.")}return a.hasOwnProperty(e)?t||a[e]:t},s.removeItem=function(e){try{window.localStorage.removeItem(e)}catch(t){o("removeItem failed by exception.")}delete a[e]},t=t?t:{};var r=null==t.namespace?"":t.namespace+"_";return function(a,l){var c,u,d,h,p,m,f,g,_,v,y,b,w,M,T,C,I,A,S,E='window.__localytics_callbacks__["'+r+'"]',x="html5_2.6",L=16e3,N=["open","close","tagEvent","tagScreen","tagEvent","upload","setIdentifier","setCustomerEmail","setCustomerId","setCustomerName"],O=30,D=1e4,R=3e4,P=500,B=!1,k=1e4,F={},z="__ll_"+r+"iu",H="__ll_"+r+"es",q="__ll_"+r+"ch",W="__ll_"+r+"pa",U="__ll_"+r+"csu",Y="__ll_"+r+"cst",G="__ll_"+r+"csi",j="__ll_"+r+"csq",V="__ll_"+r+"cso",X="__ll_"+r+"ub",Q="__ll_"+r+"lot",K="__ll_"+r+"lct",J="__ll_"+r+"chs",Z="__ll_"+r+"fl",$="__ll_"+r+"cd",ee="__ll_"+r+"ids",te=[z,H,q,W,U,Y,G,j,V,X,K,J,Z,$,ee],ie=/loaded|complete/;F._switchLogger=function(e){o=e?n:i};var ne=navigator.userAgent,oe=function(){return"undefined"!=typeof WinJS&&"function"==typeof WinJS.xhr}();F._getStore=function(e,t){if(s){var i,n=s.getItem(e);if(null!=n)try{i=t?JSON.parse(n):n}catch(a){o("Error parsing JSON from localStorage."+e)}return i}};var se=function(e){var t=(F._getStore(J,!1)||"").length,i=(""+e).length,n=i-t;e+=n;try{return s.setItem(J,e),T=e,e}catch(o){return l}},ae=function(){T=ue(),se(T)};F._writeStore=function(e,t){if(s){var i,n,a,r,c;T===l&&(T=F._getStore(J,!0),T||ae()),i=F._getStore(e,!1),i=i?i.length:0;try{if(null==t)se(T-i),s.removeItem(e);else if(r=JSON.stringify(t),n=r.length,a=n-i)if(c=T+a,a<0){if(se(c)===l)return o("Write aborted: delta was negative, but unable to update storage"),l;s.setItem(e,r)}else{if(c+=(""+c).length-(""+T).length,!(c<k&&se(c)!==l))return o("Write aborted: writing would exceed storage limits"),l;s.setItem(e,r)}else s.setItem(e,r);return t}catch(u){return o("Write to localStorage failed by exception."),l}}};var re=function(e){h||(o("No event store found, searching localStorage"),h=F._getStore(H,!0),h||(o("No event storage in localStorage found, creating an empty array"),h=[])),o("Pushing event to event store"),h.push(e),F._writeStore(H,h)},le=function(t){var i="http:"+F.__url__+"api/v2/applications/"+encodeURIComponent(e)+"/uploads";WinJS.xhr({url:i,type:"POST",data:t,headers:{"Content-Type":"application/json","x-upload-time":he()}}).done(ke,ke)},ce=function(t){var i=document.createElement("script"),n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,s="http:"+F.__url__+"api/v2/applications/"+encodeURIComponent(e)+"/uploads?callback="+E+"&client_date="+he()+"&data="+encodeURIComponent(t);return o("Uploading blob: \n"+t),o("Request length: "+s.length),s.length>L?(o("Upload length exceeds maximum supported length.  Deleting data without uploading."),void F._clearStoredUploads()):(i.async="async",i.src=s,i.onload=function(){i.readyState&&!ie.test(i.readyState)||(o("Unloading script tag from header"),i.onload=null,n&&i.parentNode&&n.removeChild(i),i=l)},void n.insertBefore(i,n.firstChild))};F._send=function(){return oe?function(e){le(e)}:function(e){ce(e)}}();var ue=function(){var e,t,i,n=0;for(e=0,t=te.length;e<t;e+=1)i=F._getStore(te[e],!1),i&&i.length&&(n+=i.length);return n},de=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},he=function(){return(new Date).getTime()/1e3|0},pe=function(){return(new Date).getTime()},me=function(){return!1},fe=function(){return[]},ge=function(){return""},_e=function(){return 0},ve=function(){return{}};F._getOrCreateProperty=function(e,t,i,n){return n?(e=i(),F._writeStore(t,e)):null==e&&(e=F._getStore(t,!0),e||(e=i(),F._writeStore(t,e))),e};var ye=function(){var e=F._getStore(ee,!0);return null==e&&(o("No identifiers in localStorage found, creating an empty map"),e=ve()),e},be=function(){return t.useCustomerId?"":de()},we=function(){return d=F._getOrCreateProperty(d,z,be,!1)},Me=function(e){return f=F._getOrCreateProperty(f,U,de,e)},Te=function(e){return g=F._getOrCreateProperty(g,Y,he,e)},Ce=function(){return m=F._getOrCreateProperty(m,W,he,!1)};F._getSessionIndex=function(){return _=F._getOrCreateProperty(_,G,_e,!1)};var Ie=function(){return F._getSessionIndex(),_+=1,F._writeStore(G,_),_},Ae=function(){return v=F._getOrCreateProperty(v,j,_e,!1),v+=1,F._writeStore(j,v),v},Se=function(){return y=F._getOrCreateProperty(y,V,me,!1)};F._getOSVersion=function(e){var t,i,n,o,s,a,r=e.split(/[)]?\s[(]?/),l=r.length,c=r[1];if(e.match(/iPhone|iPad|iPod/))o=e.match(/OS (\d+)\D(\d+)/),o&&3===o.length&&(n="iOS "+o[1]+"."+o[2]);else if(c&&c.match(/Macintosh/)){for(t=2;t<l;t++)if("OS"==r[t]){var u=t-1,d=t+2;for(i=t-1;i>1;i--)if(";"===r[i].substr(-1)||"Intel"===r[i]||"CPU"===r[i]){u=i+1;break}for(i=t+1;i<t+4;i++){if(";"===r[i].substr(-1)){d=i;break}if("like"===r[i]){d=i-1;break}}n=r.splice(u,d-(u-1)).join(" "),n=n.replace(";","").replace("_",".").replace(/_\d$/,"").replace("Mac ","");break}}else/^Android/.test(r[3])?n=(r[3]+" "+r[4]).replace(";",""):(o=e.match(/Windows NT (\d)\.(\d)/))?o.length>2&&(s=o[1],a=o[2],"6"===s&&"2"===a?n="Windows 8":"6"===s&&"1"===a?n="Windows 7":"6"===s&&"0"===a?n="Windows Vista":"5"===s&&"1"===a?n="Windows XP":"5"===s&&"0"===a?n="Windows 2000":"5"===s&&"2"===a&&(n="Windows Server 2003")):e.match(/SymbOS/)?n="SymbOS":e.match(/BlackBerry/)&&(o=e.match(/Version\/(\d+)\./))&&(n="BlackBerry "+o[1]);return n},F._generateHeader=function(){o("Generating a new header");var t,i=(navigator.language||navigator.userLanguage||"").toUpperCase();if(i)if(i.match(/-/)){var n=i.split(/-/);i=n[0],t=n[1]}else t=ne.match(new RegExp("^.*?\\(.*?"+i+"-(\\w\\w).*?\\).*?$","i")),t=t&&t[1];var s=navigator.platform,a=navigator.vendor,r=navigator.platform,l={dt:"h",pa:Ce(),seq:Ae(),u:de()},d={dt:"a",au:e,iu:we(),lv:x,ua:ne};r&&(d.dmo=r),s&&(d.dp=s),i&&(d.dll=i);var h=F._getOSVersion(ne);return h&&(d.dov=h),c&&(d.av=c),u&&(d.nc=u),t&&(d.dc=t.toUpperCase()),a&&(d.dma=a),l.attrs=d,0==Fe(ye())&&(l.ids=ye()),l};var Ee=function(e){return p=F._getOrCreateProperty(p,q,F._generateHeader,e)},xe=function(){A?o("Already polling."):(o("Beginning to poll for closes"),A=a.setTimeout(Ne,D))},Le=function(){A?(o("Stopping close polling"),a.clearTimeout(A),A=null):o("No polling to stop")},Ne=function(){F._markNewClose(),A=a.setTimeout(Ne,D)};F._markNewClose=function(){return o("Marking a new close."),w=pe(),F._writeStore(K,w)};var Oe=function(){w=F._getOrCreateProperty(w,K,pe,!1),C=F._getOrCreateProperty(C,Z,fe,!1);var e=w/1e3|0,t=Te(),i=e-t,n={dt:"c",u:de(),ss:t,su:Me(),ct:e,ctl:i,cta:i};return C.length>0&&(n.fl=C),Pe(n,F._getOrCreateProperty(I,$,fe,!1)),n},De=function(){o("Finalizing close with last polled close"),Le(),re(Oe()),C=[],F._writeStore(Z,C),F._writeStore(V,!1)};F._finalizeClose=De,F._clearStoredUploads=function(){b=null,F._writeStore(X,b)};var Re=function(e){var t;if(null!=e.polling&&(D=e.polling?+e.polling:0),e.uploadTimeout&&(R=e.uploadTimeout),e.screenLimit&&(P=e.screenLimit),e.appVersion)c=""+e.appVersion;else if(e.version)o("'version' is deprecated, please use 'appVersion' instead."),c=""+e.version;else if("undefined"!=typeof Windows)try{t=Windows.ApplicationModel.Package.current.id.version,c=[t.major,t.minor,t.build,t.revision].join(".")}catch(i){}e.carrier&&(u=""+e.carrier),null!=e.sessionTimeoutSeconds?O=e.sessionTimeoutSeconds?+e.sessionTimeoutSeconds:0:null!=e.timeout&&(o("'timeout' is deprecated, please use 'sessionTimeoutSeconds' instead."),O=e.timeout?+e.timeout/1e3:0),null!=e.storage&&(k=e.storage?+e.storage:0),null!=e.logger&&(B=!!e.logger),F._switchLogger(B),ae(),oe||(a.__localytics_callbacks__=a.__localytics_callbacks__||{},a.__localytics_callbacks__[r]=ke),Ee(!0),o("LocalyticsSession successfully initialized")},Pe=function(e,t){var i;if(t&&Be(t))for(i=0;i<4;i+=1)t[i]&&(e["c"+i]=""+t[i])},Be=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};F._open=function(e){var t;if(w=F._getStore(K,!0)||0,pe()-w<1e3*O)o("Open called within timeout, resuming last session.");else{Se()&&De(),Ie();var i=Te(!0);if(t={dt:"s",ct:i,u:Me(!0),nth:F._getSessionIndex()},M=M||F._getStore(Q,!0)||0,M&&0!=M){var n=i-M;n>=1&&(t.sl=Math.round(n))}M=F._writeStore(Q,i),e&&(I=F._writeStore($,e.slice(0)),Pe(t,e)),re(t)}y=!0,F._writeStore(V,y),o("Appended open tag to event store"),D?xe():o("Polling timeout was set to 0; no close polling will be done.")},F._tagEvent=function(e,t,i,n){if(!Se())return void o("Cannot tag event: either no session was opened, or it was already closed");isNaN(n)?(o("Customer value increase not a number, setting to 0."),n=0):parseFloat(n)!=parseInt(n)&&o("Customer value increase passed as floating point number.");var s,a,r={dt:"e",ct:he(),u:de(),su:Me(),n:""+e,v:n};if(!i&&Be(t)&&(i=t,t=null),t){a={};for(s in t)t.hasOwnProperty(s)&&(a[s]=""+t[s]);r.attrs=a}Pe(r,i),re(r),o("Tagged event: '"+e+"' with attributes (JSON): '"+JSON.stringify(a)+"'")},F._tagScreen=function(e){if(!Se())return void o("Cannot tag screen: either no session was opened, or it was already closed");C=F._getOrCreateProperty(C,Z,fe,!1);var t=C.length||0,i=""+e;t<P&&C[t-1]!==i&&(C.push(i),F._writeStore(Z,C))},F._close=function(){return Se()?(Le(),void F._markNewClose()):void o("Cannot close session: either no session was opened, or it was already closed")},F._upload=function(){if(null!=S&&pe()-S<R)return void o("Upload in progress, returning");if(h=F._getOrCreateProperty(h,H,fe,!1),b=F._getOrCreateProperty(b,X,ge,!1),!(h&&0!==h.length||b))return void o("Nothing to upload, returning.");var e,t,i=h.splice(0),n="";for(i.unshift(Ee(!1)),e=0,t=i.length;e<t;e+=1)n+=JSON.stringify(i[e])+"\n";b+=n,F._writeStore(X,b),h=null,F._writeStore(H,h),F._send(b),S=pe(),Ee(!0)};var ke=function(e){var t=+(e.response_code||e.status);S=null,o("Callback called with response:"),t&&(o("Response code: "+t),202===t||200===t?(o("Upload succeeded, clearing uploaded items."),F._clearStoredUploads()):t>=400&&t>500?(o("Response was 4XX, clearing items"),F._clearStoredUploads()):e.message&&(o("Upload failed with message:"),o(e.message)))},Fe=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},ze=function(e,t){e+="",t+="";var i=ye();o("Adding identifier:"+e+" to identifiers map"),i[e]=t,F._writeStore(ee,i)},He=function(e){e+="";var t=ye();o("Deleting value for key:"+e),delete t[e],F._writeStore(ee,t)};F._setIdentifier=function(e,t){null!=e&&0!=e.length&&(null==t?He(e):0==t.length?He(e):ze(e,t))},F._setCustomerName=function(e){F.setIdentifier("customer_name",e)},F._setCustomerId=function(e){F.setIdentifier("customer_id",e),t.useCustomerId&&(d=e,F._writeStore(z,d),Ee(!0))},F._setCustomerEmail=function(e){F.setIdentifier("customer_email",e)},F.__url__="//analytics.localytics.com/";var qe=function(e,t){console.log("> Call to Localytics client library failed ."),console.log("> localyticsSession."+e+" failed ."),console.log("> "+t),console.log(t);for(var e in N)F[e]=i};return function(){var e,i,n=N.length;for(e=0;e<n;e++)i=N[e],F[i]=function(e){return function(){try{F["_"+e].apply(F,arguments)}catch(t){qe(e,t)}}}(i);Re(t)}(),F}(window)};e.exports=i},function(e,t,i){t.name="mixpanel",t._mixpanel=window.mixpanel=[],t._mixpanel.__SV=1.2,t.init=function(e,n){i(18),window.mixpanel.init(e,n),t._mixpanel=window.mixpanel},t.idendity=function(e){t._mixpanel.identify(e),t._mixpanel.people.set_once("firstLogin",new Date),t._mixpanel.people.set("lastLogin",new Date),t._mixpanel.people.increment("nbLogin")},t.register=function(e){e.name&&(t._mixpanel.people.set("$name",e.name),t._mixpanel.name_tag(e.name)),t._mixpanel.register(e),t._mixpanel.people.set(e)},t.log=function(e,i){t._mixpanel.track(e,i)},t.screen=function(e){t._mixpanel.track_pageview(e)},t.revenue=function(e,i){i=i||{},i.$time=new Date,t._mixpanel.people.track_charge(e,i)}},function(e,t){!function(e){function t(){t.done||(t.done=!0,N=!0,S=!1,E.each(H,function(e){e._dom_loaded()}))}function i(){try{u.documentElement.doScroll("left")}catch(e){return void setTimeout(i,1)}t()}var n=Array.prototype,o=Object.prototype,s=n.slice,a=o.toString,r=o.hasOwnProperty,l=window.console,c=window.navigator,u=window.document,d=c.userAgent,h="mixpanel",p="__mps",m="__mpso",f="__mpa",g="__mpap",_="$set",v="$set_once",y="$add",b="$append",w="$people_distinct_id",M="__alias",T=[p,m,f,g,w,M],C="https:"==u.location.protocol?"https://":"http://",I=e&&e.__SV||0,A=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,S=!A&&d.indexOf("MSIE")==-1,E={},x=!1,L={api_host:C+"api.mixpanel.com",cross_subdomain_cookie:!0,cookie_name:"",loaded:function(){},store_google:!0,save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_cookie:!1,secure_cookie:!1,ip:!0},N=!1;!function(){var e=n.forEach,t=n.indexOf,i=Array.isArray,o={},l=E.each=function(t,i,n){if(null!=t)if(e&&t.forEach===e)t.forEach(i,n);else if(t.length===+t.length){for(var s=0,a=t.length;s<a;s++)if(s in t&&i.call(n,t[s],s,t)===o)return}else for(var l in t)if(r.call(t,l)&&i.call(n,t[l],l,t)===o)return};E.extend=function(e){return l(s.call(arguments,1),function(t){for(var i in t)void 0!==t[i]&&(e[i]=t[i])}),e},E.isArray=i||function(e){return"[object Array]"===a.call(e)},E.isFunction=function(e){try{return/^\s*\bfunction\b/.test(e)}catch(t){return!1}},E.isArguments=function(e){return!(!e||!r.call(e,"callee"))},E.toArray=function(e){return e?e.toArray?e.toArray():E.isArray(e)?s.call(e):E.isArguments(e)?s.call(e):E.values(e):[]},E.values=function(e){var t=[];return null==e?t:(l(e,function(e){t[t.length]=e}),t)},E.identity=function(e){return e},E.include=function(e,i){var n=!1;return null==e?n:t&&e.indexOf===t?e.indexOf(i)!=-1:(l(e,function(e){if(n||(n=e===i))return o}),n)},E.includes=function(e,t){return e.indexOf(t)!==-1}}(),E.inherit=function(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e},E.isObject=function(e){return e===Object(e)&&!E.isArray(e)},E.isEmptyObject=function(e){if(E.isObject(e)){for(var t in e)if(r.call(e,t))return!1;return!0}return!1},E.isUndefined=function(e){return void 0===e},E.isString=function(e){return"[object String]"==a.call(e)},E.isDate=function(e){return"[object Date]"==a.call(e)},E.isNumber=function(e){return"[object Number]"==a.call(e)},E.encodeDates=function(e){return E.each(e,function(t,i){E.isDate(t)?e[i]=E.formatDate(t):E.isObject(t)&&(e[i]=E.encodeDates(t))}),e},E.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())},E.strip_empty_properties=function(e){var t={};return E.each(e,function(e,i){E.isString(e)&&e.length>0&&(t[i]=e)}),t},E.truncate=function(e,t){var i;return"string"==typeof e?i=e.slice(0,t):E.isArray(e)?(i=[],E.each(e,function(e){i.push(E.truncate(e,t))})):E.isObject(e)?(i={},E.each(e,function(e,n){i[n]=E.truncate(e,t)})):i=e,i},E.JSONEncode=function(){return function(e){var t=e,i=function(e){var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return t.lastIndex=0,t.test(e)?'"'+e.replace(t,function(e){var t=i[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},n=function(e,t){var o="",s="    ",l=0,c="",u="",d=0,h=o,p=[],m=t[e];switch(m&&"object"==typeof m&&"function"==typeof m.toJSON&&(m=m.toJSON(e)),typeof m){case"string":return i(m);case"number":return isFinite(m)?String(m):"null";case"boolean":case"null":return String(m);case"object":if(!m)return"null";if(o+=s,p=[],"[object Array]"===a.apply(m)){for(d=m.length,l=0;l<d;l+=1)p[l]=n(l,m)||"null";return u=0===p.length?"[]":o?"[\n"+o+p.join(",\n"+o)+"\n"+h+"]":"["+p.join(",")+"]",o=h,u}for(c in m)r.call(m,c)&&(u=n(c,m),u&&p.push(i(c)+(o?": ":":")+u));return u=0===p.length?"{}":o?"{"+p.join(",")+h+"}":"{"+p.join(",")+"}",o=h,u}};return n("",{"":t})}}(),E.JSONDecode=function(){var e,t,i,n,o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},s=function(t){throw{name:"SyntaxError",message:t,at:e,text:i}},a=function(n){return n&&n!==t&&s("Expected '"+n+"' instead of '"+t+"'"),t=i.charAt(e),e+=1,t},r=function(){var e,i="";for("-"===t&&(i="-",a("-"));t>="0"&&t<="9";)i+=t,a();if("."===t)for(i+=".";a()&&t>="0"&&t<="9";)i+=t;if("e"===t||"E"===t)for(i+=t,a(),"-"!==t&&"+"!==t||(i+=t,a());t>="0"&&t<="9";)i+=t,a();return e=+i,isFinite(e)?e:void s("Bad number")},l=function(){var e,i,n,r="";if('"'===t)for(;a();){if('"'===t)return a(),r;if("\\"===t)if(a(),"u"===t){for(n=0,i=0;i<4&&(e=parseInt(a(),16),isFinite(e));i+=1)n=16*n+e;r+=String.fromCharCode(n)}else{if("string"!=typeof o[t])break;r+=o[t]}else r+=t}s("Bad string")},c=function(){for(;t&&t<=" ";)a()},u=function(){switch(t){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null}s("Unexpected '"+t+"'")},d=function(){var e=[];if("["===t){if(a("["),c(),"]"===t)return a("]"),e;for(;t;){if(e.push(n()),c(),"]"===t)return a("]"),e;a(","),c()}}s("Bad array")},h=function(){var e,i={};if("{"===t){if(a("{"),c(),"}"===t)return a("}"),i;for(;t;){if(e=l(),c(),a(":"),Object.hasOwnProperty.call(i,e)&&s('Duplicate key "'+e+'"'),i[e]=n(),c(),"}"===t)return a("}"),i;a(","),c()}}s("Bad object")};return n=function(){switch(c(),t){case"{":return h();case"[":return d();case'"':return l();case"-":return r();default:return t>="0"&&t<="9"?r():u()}},function(o){var a;return i=o,e=0,t=" ",a=n(),c(),t&&s("Syntax error"),a}}(),E.base64Encode=function(e){var t,i,n,o,s,a,r,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,d=0,h="",p=[];if(!e)return e;e=E.utf8Encode(e);do t=e.charCodeAt(u++),i=e.charCodeAt(u++),n=e.charCodeAt(u++),l=t<<16|i<<8|n,o=l>>18&63,s=l>>12&63,a=l>>6&63,r=63&l,p[d++]=c.charAt(o)+c.charAt(s)+c.charAt(a)+c.charAt(r);while(u<e.length);switch(h=p.join(""),e.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h},E.utf8Encode=function(e){e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var t,i,n,o="",s=0;for(t=i=0,s=e.length,n=0;n<s;n++){var a=e.charCodeAt(n),r=null;a<128?i++:r=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==r&&(i>t&&(o+=e.substring(t,i)),o+=r,t=i=n+1)}return i>t&&(o+=e.substring(t,e.length)),o},E.UUID=function(){var e=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)},t=function(){return Math.random().toString(16).replace(".","")},i=function(e){function t(e,t){var i,n=0;for(i=0;i<t.length;i++)n|=s[i]<<8*i;return e^n}var i,n,o=d,s=[],a=0;for(i=0;i<o.length;i++)n=o.charCodeAt(i),s.unshift(255&n),s.length>=4&&(a=t(a,s),s=[]);return s.length>0&&(a=t(a,s)),a.toString(16)};return function(){var n=(screen.height*screen.width).toString(16);return e()+"-"+t()+"-"+i()+"-"+n+"-"+e()}}(),E.isBlockedUA=function(){var e=d;return!!/(google web preview|baiduspider|yandexbot)/i.test(e)},E.HTTPBuildQuery=function(e,t){var i,n,o=[];return"undefined"==typeof t&&(t="&"),E.each(e,function(e,t){i=encodeURIComponent(e.toString()),n=encodeURIComponent(t),o[o.length]=n+"="+i}),o.join(t)},E.getQueryParam=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+t+"=([^&#]*)",n=new RegExp(i),o=n.exec(e);return null===o||o&&"string"!=typeof o[1]&&o[1].length?"":decodeURIComponent(o[1]).replace(/\+/g," ")},E.cookie={get:function(e){for(var t=e+"=",i=u.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return null},parse:function(e){var t;try{t=E.JSONDecode(E.cookie.get(e))||{}}catch(i){}return t},set:function(e,t,i,n,o){var s="",a="",r="";if(n){var l=u.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),c=l?l[0]:"";s=c?"; domain=."+c:""}if(i){var d=new Date;d.setTime(d.getTime()+24*i*60*60*1e3),a="; expires="+d.toGMTString()}o&&(r="; secure"),u.cookie=e+"="+encodeURIComponent(t)+a+"; path=/"+s+r},remove:function(e,t){E.cookie.set(e,"",-1,t)}},E.register_event=function(){function e(e,i,n){var o=function(o){if(o=o||t(window.event)){var s,a,r=!0;return E.isFunction(n)&&(s=n(o)),a=i.call(e,o),!1!==s&&!1!==a||(r=!1),r}};return o}function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation),e}var i=function(t,i,n,o){if(!t)return void O.error("No valid element provided to register_event");if(t.addEventListener&&!o)t.addEventListener(i,n,!1);else{var s="on"+i,a=t[s];t[s]=e(t,n,a)}};return t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0},i}(),E.dom_query=function(){function e(e){return e.all?e.all:e.getElementsByTagName("*")}function t(e,t){var i=" "+t+" ";return(" "+e.className+" ").replace(n," ").indexOf(i)>=0}function i(i){if(!u.getElementsByTagName)return new Array;for(var n,o=i.split(" "),s=new Array(u),a=0;a<o.length;a++)if(n=o[a].replace(/^\s+/,"").replace(/\s+$/,""),n.indexOf("#")>-1){var r=n.split("#"),l=r[0],c=r[1],d=u.getElementById(c);if(!d||l&&d.nodeName.toLowerCase()!=l)return new Array;s=new Array(d)}else if(n.indexOf(".")>-1){var r=n.split("."),l=r[0],h=r[1];l||(l="*");for(var p=new Array,m=0,f=0;f<s.length;f++){var g;g="*"==l?e(s[f]):s[f].getElementsByTagName(l);for(var _=0;_<g.length;_++)p[m++]=g[_]}s=new Array;for(var v=0,y=0;y<p.length;y++)p[y].className&&E.isString(p[y].className)&&t(p[y],h)&&(s[v++]=p[y])}else if(n.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var l=RegExp.$1,b=RegExp.$2,w=RegExp.$3,M=RegExp.$4;l||(l="*");for(var p=new Array,m=0,f=0;f<s.length;f++){var g;g="*"==l?e(s[f]):s[f].getElementsByTagName(l);for(var _=0;_<g.length;_++)p[m++]=g[_]}s=new Array;var T,v=0;switch(w){case"=":T=function(e){return e.getAttribute(b)==M};break;case"~":T=function(e){return e.getAttribute(b).match(new RegExp("\\b"+M+"\\b"))};break;case"|":T=function(e){return e.getAttribute(b).match(new RegExp("^"+M+"-?"))};break;case"^":T=function(e){return 0==e.getAttribute(b).indexOf(M)};break;case"$":T=function(e){return e.getAttribute(b).lastIndexOf(M)==e.getAttribute(b).length-M.length};break;case"*":T=function(e){return e.getAttribute(b).indexOf(M)>-1};break;default:T=function(e){return e.getAttribute(b)}}s=new Array,v=0;for(var y=0;y<p.length;y++)T(p[y])&&(s[v++]=p[y])}else{l=n;for(var p=new Array,m=0,f=0;f<s.length;f++)for(var g=s[f].getElementsByTagName(l),_=0;_<g.length;_++)p[m++]=g[_];s=p}return s}var n=/[\t\r\n]/g;return i}(),E.info={campaignParams:function(){var e="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),t="",i={};return E.each(e,function(e){t=E.getQueryParam(u.URL,e),t.length&&(i[e]=t)}),i},searchEngine:function(e){return 0===e.search("https?://(.*)google.([^/?]*)")?"google":0===e.search("https?://(.*)bing.com")?"bing":0===e.search("https?://(.*)yahoo.com")?"yahoo":0===e.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(e){var t=E.info.searchEngine(e),i="yahoo"!=t?"q":"p",n={};if(null!==t){n.$search_engine=t;var o=E.getQueryParam(e,i);o.length&&(n.mp_keyword=o)}return n},browser:function(){var e=d,t=c.vendor||"";return window.opera?E.includes(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":E.includes(e,"Chrome")?"Chrome":E.includes(t,"Apple")?E.includes(e,"Mobile")?"Mobile Safari":"Safari":E.includes(e,"Android")?"Android Mobile":E.includes(e,"Konqueror")?"Konqueror":E.includes(e,"Firefox")?"Firefox":E.includes(e,"MSIE")?"Internet Explorer":E.includes(e,"Gecko")?"Mozilla":""},os:function(){var e=d;return/Windows/i.test(e)?/Phone/.test(e)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"Mac OS X":/Linux/.test(e)?"Linux":""},device:function(){var e=d;return/iPhone/.test(e)?"iPhone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Windows Phone/i.test(e)?"Windows Phone":/Android/.test(e)?"Android":""},referringDomain:function(e){var t=e.split("/");return t.length>=3?t[2]:""},properties:function(){return E.strip_empty_properties({$os:E.info.os(),$browser:E.info.browser(),$referrer:u.referrer,$referring_domain:E.info.referringDomain(u.referrer),$device:E.info.device(),mp_lib:"web"})},people_properties:function(){return E.strip_empty_properties({$os:E.info.os(),$browser:E.info.browser()})},pageviewInfo:function(e){return E.strip_empty_properties({mp_page:e,mp_referrer:u.referrer,mp_browser:E.info.browser(),mp_platform:E.info.os()})}};var O={log:function(){if(x&&!E.isUndefined(l)&&l)try{l.log.apply(l,arguments)}catch(e){E.each(arguments,function(e){l.log(e)})}},error:function(){if(x&&!E.isUndefined(l)&&l){var e=["Mixpanel error:"].concat(E.toArray(arguments));try{l.error.apply(l,e)}catch(t){E.each(e,function(e){l.error(e)})}}},critical:function(){if(!E.isUndefined(l)&&l){var e=["Mixpanel error:"].concat(E.toArray(arguments));try{l.error.apply(l,e)}catch(t){E.each(e,function(e){l.error(e)})}}}},D=function(){};D.prototype.create_properties=function(){},D.prototype.event_handler=function(){},D.prototype.after_track_handler=function(){},D.prototype.init=function(e){return this.mp=e,this},D.prototype.track=function(e,t,i,n){var o=this,s=E.dom_query(e);return 0==s.length?void O.error("The DOM query ("+e+") returned 0 elements"):(E.each(s,function(e){E.register_event(e,this.override_event,function(e){var s={},a=o.create_properties(i,this),r=o.mp.get_config("track_links_timeout");o.event_handler(e,this,s),window.setTimeout(o.track_callback(n,a,s,!0),r),o.mp.track(t,a,o.track_callback(n,a,s))})},this),!0)},D.prototype.track_callback=function(e,t,i,n){n=n||!1;var o=this;return function(){i.callback_fired||(i.callback_fired=!0,e&&e(n,t)===!1||o.after_track_handler(t,i,n))}},D.prototype.create_properties=function(e,t){var i;return i="function"==typeof e?e(t):E.extend({},e)};var R=function(){this.override_event="click"};E.inherit(R,D),R.prototype.create_properties=function(e,t){var i=R.superclass.create_properties.apply(this,arguments);return t.href&&(i.url=t.href),i},R.prototype.event_handler=function(e,t,i){i.new_tab=2===e.which||e.metaKey||"_blank"===t.target,i.href=t.href,i.new_tab||e.preventDefault()},R.prototype.after_track_handler=function(e,t,i){t.new_tab||setTimeout(function(){window.location=t.href},0)};var P=function(){this.override_event="submit"};E.inherit(P,D),P.prototype.event_handler=function(e,t,i){i.element=t,e.preventDefault()},P.prototype.after_track_handler=function(e,t,i){setTimeout(function(){t.element.submit()},0)};var B=function(e){this.props={},this.campaign_params_saved=!1,e.cookie_name?this.name="mp_"+e.cookie_name:this.name="mp_"+e.token+"_mixpanel",this.load(),this.update_config(e),this.upgrade(e),this.save()};B.prototype.properties=function(){var e={};return E.each(this.props,function(t,i){E.include(T,i)||(e[i]=t)}),e},B.prototype.load=function(){if(!this.disabled){var e=E.cookie.parse(this.name);e&&(this.props=E.extend({},e))}},B.prototype.upgrade=function(e){var t,i,n=e.upgrade;n&&(t="mp_super_properties","string"==typeof n&&(t=n),i=E.cookie.parse(t),E.cookie.remove(t),E.cookie.remove(t,!0),i&&(this.props=E.extend(this.props,i.all,i.events))),e.cookie_name||"mixpanel"===e.name||(t="mp_"+e.token+"_"+e.name,i=E.cookie.parse(t),i&&(E.cookie.remove(t),E.cookie.remove(t,!0),this.register_once(i)))},B.prototype.save=function(){this.disabled||E.cookie.set(this.name,E.JSONEncode(this.props),this.expire_days,this.cross_subdomain,this.secure)},B.prototype.remove=function(){E.cookie.remove(this.name,!1),E.cookie.remove(this.name,!0)},B.prototype.clear=function(){this.remove(),this.props={}},B.prototype.register_once=function(e,t,i){return!!E.isObject(e)&&("undefined"==typeof t&&(t="None"),this.expire_days="undefined"==typeof i?this.default_expiry:i,E.each(e,function(e,i){this.props[i]&&this.props[i]!==t||(this.props[i]=e)},this),this.save(),!0)},B.prototype.register=function(e,t){return!!E.isObject(e)&&(this.expire_days="undefined"==typeof t?this.default_expiry:t,E.extend(this.props,e),this.save(),!0)},B.prototype.unregister=function(e){e in this.props&&(delete this.props[e],this.save())},B.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(E.info.campaignParams()),this.campaign_params_saved=!0)},B.prototype.update_search_keyword=function(e){this.register(E.info.searchInfo(e))},B.prototype.update_referrer_info=function(e){this.register_once({$initial_referrer:e||"$direct",$initial_referring_domain:E.info.referringDomain(e)||"$direct"},"")},B.prototype.get_referrer_info=function(){return E.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})},B.prototype.safe_merge=function(e){return E.each(this.props,function(t,i){i in e||(e[i]=t)}),e},B.prototype.update_config=function(e){this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_cookie),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie)},B.prototype.set_disabled=function(e){this.disabled=e,this.disabled&&this.remove()},B.prototype.set_cross_subdomain=function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())},B.prototype.get_cross_subdomain=function(){return this.cross_subdomain},B.prototype.set_secure=function(e){e!==this.secure&&(this.secure=!!e,this.remove(),this.save())},B.prototype._add_to_people_queue=function(e,t){var i=this._get_queue_key(e),n=t[e],o=this._get_or_create_queue(_),s=this._get_or_create_queue(v),a=this._get_or_create_queue(y),r=this._get_or_create_queue(b,[]);i===p?(E.extend(o,n),this._pop_from_people_queue(y,n)):i===m?E.each(n,function(e,t){t in s||(s[t]=e)}):i===f?E.each(n,function(e,t){t in o?o[t]+=e:(t in a||(a[t]=0),a[t]+=e)},this):i===g&&r.push(n),O.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):"),O.log(t),this.save()},B.prototype._pop_from_people_queue=function(e,t){var i=this._get_queue(e);E.isUndefined(i)||(E.each(t,function(e,t){delete i[t]},this),this.save())},B.prototype._get_queue_key=function(e){return e===_?p:e===v?m:e===y?f:e===b?g:void O.error("Invalid queue:",e)},B.prototype._get_queue=function(e){return this.props[this._get_queue_key(e)]},B.prototype._get_or_create_queue=function(e,t){var i=this._get_queue_key(e),t=E.isUndefined(t)?{}:t;return this.props[i]||(this.props[i]=t)};var k=function(t,i,n){var o,s=n===h?e:e[n];return s&&!E.isArray(s)?void O.error("You have already initialized "+n):(o=new F,o._init(t,i,n),o.people=new z,o.people._init(o),x=x||o.get_config("debug"),E.isUndefined(s)||(o._execute_array.call(o.people,s.people),o._execute_array(s)),o)},F=function(){};F.prototype.init=function(t,i,n){if("undefined"==typeof n)return void O.error("You must name your new library: init(token, config, name)");if(n===h)return void O.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");var o=k(t,i,n);return e[n]=o,o._loaded(),o},F.prototype._init=function(e,t,i){this.__loaded=!0,this.config={},this.set_config(E.extend({},L,t,{name:i,token:e,callback_fn:(i===h?i:"mixpanel."+i)+"._jsc"})),this._jsc=function(){},this.__dom_loaded_queue=[],this.__request_queue=[],this.__disabled_events=[],this._flags={disable_all_events:!1,identify_called:!1},this.cookie=new B(this.config),this.register_once({distinct_id:E.UUID()},"")},F.prototype._loaded=function(){
this.get_config("loaded")(this),this.get_config("track_pageview")&&this.track_pageview()},F.prototype._dom_loaded=function(){E.each(this.__dom_loaded_queue,function(e){this._track_dom.apply(this,e)},this),E.each(this.__request_queue,function(e){this._send_request.apply(this,e)},this),delete this.__dom_loaded_queue,delete this.__request_queue},F.prototype._track_dom=function(e,t){if(this.get_config("img"))return O.error("You can't use DOM tracking functions with img = true."),!1;if(!N)return this.__dom_loaded_queue.push([e,t]),!1;var i=(new e).init(this);return i.track.apply(i,t)},F.prototype._prepare_callback=function(e,t){if(E.isUndefined(e))return null;if(A){var i=function(i){e(i,t)};return i}var n=this._jsc,o=""+Math.floor(1e8*Math.random()),s=this.get_config("callback_fn")+'["'+o+'"]';return n[o]=function(i){delete n[o],e(i,t)},s},F.prototype._send_request=function(e,t,i){if(S)return void this.__request_queue.push(arguments);var n=this.get_config("verbose");if(this.get_config("test")&&(t.test=1),n&&(t.verbose=1),this.get_config("img")&&(t.img=1),A||(i?t.callback=i:(n||this.get_config("test"))&&(t.callback="(function(){})")),t.ip=this.get_config("ip")?1:0,t._=(new Date).getTime().toString(),e+="?"+E.HTTPBuildQuery(t),"img"in t){var o=u.createElement("img");o.src=e,u.body.appendChild(o)}else if(A){var s=new XMLHttpRequest;s.open("GET",e,!0),s.withCredentials=!0,s.onreadystatechange=function(e){if(4===s.readyState)if(200===s.status)i&&i(n?E.JSONDecode(s.responseText):Number(s.responseText));else{var t="Bad HTTP status: "+s.status+" "+s.statusText;O.error(t),i&&i(n?{status:0,error:t}:0)}},s.send(null)}else{var a=u.createElement("script");a.type="text/javascript",a.async=!0,a.defer=!0,a.src=e;var r=u.getElementsByTagName("script")[0];r.parentNode.insertBefore(a,r)}},F.prototype._execute_array=function(e){var t,i=[],n=[],o=[];E.each(e,function(e){e&&(t=e[0],"function"==typeof e?e.call(this):E.isArray(e)&&"alias"===t?i.push(e):E.isArray(e)&&t.indexOf("track")!=-1&&"function"==typeof this[t]?o.push(e):n.push(e))},this);var s=function(e,t){E.each(e,function(e){this[e[0]].apply(this,e.slice(1))},t)};s(i,this),s(n,this),s(o,this)},F.prototype.push=function(e){this._execute_array([e])},F.prototype.disable=function(e){"undefined"==typeof e?this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(e)},F.prototype.track=function(e,t,i){if("undefined"==typeof e)return void O.error("No event name provided to mixpanel.track");if(E.isBlockedUA()||this._flags.disable_all_events||E.include(this.__disabled_events,e))return void("undefined"!=typeof i&&i(0));t=t||{},t.token=t.token||this.get_config("token"),this.cookie.update_search_keyword(u.referrer),this.get_config("store_google")&&this.cookie.update_campaign_params(),this.get_config("save_referrer")&&this.cookie.update_referrer_info(u.referrer),t=E.extend({},E.info.properties(),this.cookie.properties(),t);var n={event:e,properties:t},o=E.truncate(n,255),s=E.JSONEncode(o),a=E.base64Encode(s);return O.log("MIXPANEL REQUEST:"),O.log(o),this._send_request(this.get_config("api_host")+"/track/",{data:a},this._prepare_callback(i,o)),o},F.prototype.track_pageview=function(e){"undefined"==typeof e&&(e=u.location.href),this.track("mp_page_view",E.info.pageviewInfo(e))},F.prototype.track_links=function(){return this._track_dom.call(this,R,arguments)},F.prototype.track_forms=function(){return this._track_dom.call(this,P,arguments)},F.prototype.register=function(e,t){this.cookie.register(e,t)},F.prototype.register_once=function(e,t,i){this.cookie.register_once(e,t,i)},F.prototype.unregister=function(e){this.cookie.unregister(e)},F.prototype._register_single=function(e,t){var i={};i[e]=t,this.register(i)},F.prototype.identify=function(e,t,i,n,o){e!=this.get_distinct_id()&&e!=this.get_property(M)&&(this.unregister(M),this._register_single("distinct_id",e)),this._flags.identify_called=!0,this.people._flush(t,i,n,o)},F.prototype.get_distinct_id=function(){return this.get_property("distinct_id")},F.prototype.alias=function(e,t){if(e===this.get_property(w))return O.critical("Attempting to create alias for existing People user - aborting."),-2;var i=this;return E.isUndefined(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(M,e),this.track("$create_alias",{alias:e,distinct_id:t},function(t){i.identify(e)})):(O.error("alias matches current distinct_id - skipping api call."),this.identify(e),-1)},F.prototype.name_tag=function(e){this._register_single("mp_name_tag",e)},F.prototype.set_config=function(e){E.isObject(e)&&(E.extend(this.config,e),this.cookie&&this.cookie.update_config(this.config),x=x||this.get_config("debug"))},F.prototype.get_config=function(e){return this.config[e]},F.prototype.get_property=function(e){return this.cookie.props[e]},F.prototype.toString=function(){var e=this.get_config("name");return e!==h&&(e="mixpanel."+e),e};var z=function(){};if(z.prototype._init=function(e){this._mixpanel=e},z.prototype.set=function(e,t,i){var n={},o={};return E.isObject(e)?(E.each(e,function(e,t){"$distinct_id"!=t&&"$token"!=t&&(o[t]=e)}),i=t):o[e]=t,this._get_config("save_referrer")&&this._mixpanel.cookie.update_referrer_info(u.referrer),o=E.extend({},E.info.people_properties(),this._mixpanel.cookie.get_referrer_info(),o),n[_]=o,this._send_request(n,i)},z.prototype.set_once=function(e,t,i){var n={},o={};return E.isObject(e)?(E.each(e,function(e,t){"$distinct_id"!=t&&"$token"!=t&&(o[t]=e)}),i=t):o[e]=t,n[v]=o,this._send_request(n,i)},z.prototype.increment=function(e,t,i){var n={},o={};return E.isObject(e)?(E.each(e,function(e,t){if("$distinct_id"!=t&&"$token"!=t)return isNaN(parseFloat(e))?void O.error("Invalid increment value passed to mixpanel.people.increment - must be a number"):void(o[t]=e)}),i=t):(E.isUndefined(t)&&(t=1),o[e]=t),n[y]=o,this._send_request(n,i)},z.prototype.append=function(e,t,i){var n={},o={};return E.isObject(e)?(E.each(e,function(e,t){"$distinct_id"!=t&&"$token"!=t&&(o[t]=e)}),i=t):o[e]=t,n[b]=o,this._send_request(n,i)},z.prototype.track_charge=function(e,t,i){return!E.isNumber(e)&&(e=parseFloat(e),isNaN(e))?void O.error("Invalid value passed to mixpanel.people.track_charge - must be a number"):this.append("$transactions",E.extend({$amount:e},t),i)},z.prototype.clear_charges=function(e){return this.set("$transactions",[],e)},z.prototype.delete_user=function(){if(!this._identify_called())return void O.error("mixpanel.people.delete_user() requires you to call identify() first");var e={$delete:this._mixpanel.get_distinct_id()};return this._send_request(e)},z.prototype.toString=function(){return this._mixpanel.toString()+".people"},z.prototype._send_request=function(e,t){e.$token=this._get_config("token"),e.$distinct_id=this._mixpanel.get_distinct_id();var i=E.encodeDates(e),n=E.truncate(i,255),o=E.JSONEncode(i),s=E.base64Encode(o);return this._identify_called()?(O.log("MIXPANEL PEOPLE REQUEST:"),O.log(n),this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:s},this._mixpanel._prepare_callback(t,n)),n):(this._enqueue(e),E.isUndefined(t)||t(this._get_config("verbose")?{status:-1,error:null}:-1),n)},z.prototype._get_config=function(e){return this._mixpanel.get_config(e)},z.prototype._identify_called=function(){return this._mixpanel._flags.identify_called===!0},z.prototype._enqueue=function(e){_ in e?this._mixpanel.cookie._add_to_people_queue(_,e):v in e?this._mixpanel.cookie._add_to_people_queue(v,e):y in e?this._mixpanel.cookie._add_to_people_queue(y,e):b in e?this._mixpanel.cookie._add_to_people_queue(b,e):O.error("Invalid call to _enqueue():",e)},z.prototype._flush=function(e,t,i,n){var o=this,s=E.extend({},this._mixpanel.cookie._get_queue(_)),a=E.extend({},this._mixpanel.cookie._get_queue(v)),r=E.extend({},this._mixpanel.cookie._get_queue(y)),l=this._mixpanel.cookie._get_queue(b);if(E.isUndefined(s)||!E.isObject(s)||E.isEmptyObject(s)||(o._mixpanel.cookie._pop_from_people_queue(_,s),this.set(s,function(t,i){0==t&&o._mixpanel.cookie._add_to_people_queue(_,s),E.isUndefined(e)||e(t,i)})),E.isUndefined(a)||!E.isObject(a)||E.isEmptyObject(a)||(o._mixpanel.cookie._pop_from_people_queue(v,a),this.set_once(a,function(e,t){0==e&&o._mixpanel.cookie._add_to_people_queue(v,a),E.isUndefined(n)||n(e,t)})),E.isUndefined(r)||!E.isObject(r)||E.isEmptyObject(r)||(o._mixpanel.cookie._pop_from_people_queue(y,r),this.increment(r,function(e,i){0==e&&o._mixpanel.cookie._add_to_people_queue(y,r),E.isUndefined(t)||t(e,i)})),!E.isUndefined(l)&&E.isArray(l)&&l.length){for(var c=l.length-1;c>=0;c--){var u=l.pop();o.append(u,function(e,t){0==e&&o._mixpanel.cookie._add_to_people_queue(b,u),E.isUndefined(i)||i(e,t)})}o._mixpanel.cookie.save()}},E.toArray=E.toArray,E.isObject=E.isObject,E.JSONEncode=E.JSONEncode,E.JSONDecode=E.JSONDecode,E.isEmptyObject=E.isEmptyObject,F.prototype.init=F.prototype.init,F.prototype.disable=F.prototype.disable,F.prototype.track=F.prototype.track,F.prototype.track_links=F.prototype.track_links,F.prototype.track_forms=F.prototype.track_forms,F.prototype.track_pageview=F.prototype.track_pageview,F.prototype.register=F.prototype.register,F.prototype.register_once=F.prototype.register_once,F.prototype.unregister=F.prototype.unregister,F.prototype.identify=F.prototype.identify,F.prototype.alias=F.prototype.alias,F.prototype.name_tag=F.prototype.name_tag,F.prototype.set_config=F.prototype.set_config,F.prototype.get_config=F.prototype.get_config,F.prototype.get_property=F.prototype.get_property,F.prototype.get_distinct_id=F.prototype.get_distinct_id,F.prototype.toString=F.prototype.toString,B.prototype.properties=B.prototype.properties,B.prototype.update_search_keyword=B.prototype.update_search_keyword,B.prototype.update_referrer_info=B.prototype.update_referrer_info,B.prototype.get_cross_subdomain=B.prototype.get_cross_subdomain,B.prototype.clear=B.prototype.clear,z.prototype.set=z.prototype.set,z.prototype.set_once=z.prototype.set_once,z.prototype.increment=z.prototype.increment,z.prototype.append=z.prototype.append,z.prototype.track_charge=z.prototype.track_charge,z.prototype.clear_charges=z.prototype.clear_charges,z.prototype.delete_user=z.prototype.delete_user,z.prototype.toString=z.prototype.toString,E.isUndefined(e))return void O.critical("'mixpanel' object not initialized. Ensure you are using the latest version of the Mixpanel JS Library along with the snippet we provide.");if(e.__loaded||e.config&&e.cookie)return void O.error("Mixpanel library has already been downloaded at least once.");if(I<1.1)return void O.critical("Version mismatch; please ensure you're using the latest version of the Mixpanel code snippet.");var H={};E.each(e._i,function(e){var t,i;e&&E.isArray(e)&&(t=e[e.length-1],i=k.apply(this,e),H[t]=i)});var q=function(){E.each(H,function(t,i){i!==h&&(e[i]=t)}),e._=E};if(e.init=function(t,i,n){if(n)e[n]||(e[n]=H[n]=k(t,i,n),e[n]._loaded());else{var o=e;H[h]?o=H[h]:t&&(o=k(t,i,h)),window[h]=e=o,q()}},e.init(),E.each(H,function(e){e._loaded()}),u.addEventListener)"complete"==u.readyState?t():u.addEventListener("DOMContentLoaded",t,!1);else if(u.attachEvent){u.attachEvent("onreadystatechange",t);var W=!1;try{W=null==window.frameElement}catch(U){}u.documentElement.doScroll&&W&&i()}E.register_event(window,"load",t,!0)}(window.mixpanel)},function(e,t,i){function n(e){var t=r[e];return void 0===t?(a.error("ankAnalytics.getEventId: "+e+" is missing from the event map"),-1):t}function o(e,t){var i=l[e];if(!i)return void console.error("ankAnalytics checkModel: "+e+" is missing from the models");for(var n=Object.keys(t),o=[],s=0,a=i.length;s<a;s+=1){var r=i[s];if("relative_soft_currency_gained"!==r&&"relative_hard_currency_gained"!==r&&"time_spent_on_action"!==r){var c=n.indexOf(r)===-1,u=b.indexOf(r)===-1&&(void 0===t[r]||null===t[r]);(c||u)&&o.push(r)}}o.length&&console.error("ankAnalytics checkModel: missing params on event",e,o)}var s,a,r=i(20),l=i(21),c=i(22),u=i(23),d=i(27),h=i(28),p=!1,m=!1,f=!1,g=!1,_=18,v=null,y=!1,b=["amu_id","weapon_id","ringl_id","belt_id","ringr_id","boots_id","hat_id","cloack_id","pet_id","ride_id","comp_id","shield_id"];t.init=function(e){a=window.dofus.logger,e&&(s=e.version,e.debug&&(f=!0),e.analog?(m=!0,y=!0):e.useUrlMap?(g=!0,y=!0):y=!1)},t.register=function(e){y&&(v=e||0)},t.unregister=function(){v=null},t.send=function(e,t){if(y){t=t||{};var i=n(e);window.developmentMode&&f&&o(e,t);var r={game_id:_,event_id:i,session_id:v,date:d(t.date||h.now(),"UTC:yyyy-mm-dd HH:MM:ss")+" GMT",data:t};if(m)a.info("ankAnalytics.send: "+e,JSON.stringify(r));else if(g){var l=window.gui.serversData.connectedServerId,b=c[l];if(!b)return void(p||(p=!0,console.error("ankAnalytics send: eventServerURL is missing for server "+l)));u(b,r,s,function(e){if(e)return a.error("ankAnalytics.send:",e)})}}}},function(e,t){e.exports={"Session_Info.Login":558,"Session_Info.Choose_Server":559,"Session_Info.Choose_Character":560,"F_T_U_E.Step3300_Use_shop":658,"F_T_U_E.Step0000_Chose_Nickname":320,"F_T_U_E.Step0100_Chose_Server":321,"F_T_U_E.Step0200_Create_First_Character":322,"F_T_U_E.Step0300_Enter_Tuto":323,"F_T_U_E.Step9999_Quit_Tuto":324,"F_T_U_E.Step0400_Start_Tuto_Step_1_Move":325,"F_T_U_E.Step0500_Succeed_Tuto_Step_1_Move":326,"F_T_U_E.Step0600_Start_Tuto_Step_2_Speak_To_NPC":327,"F_T_U_E.Step0630_Clic_Maitre_Pifo":328,"F_T_U_E.Step0660_Answer_Maitre_Pifo":329,"F_T_U_E.Step0700_Succeed_Tuto_Step_2_Speak_To_NPC":330,"F_T_U_E.Step0800_Start_Tuto_Step_3_Equip_Ring":331,"F_T_U_E.Step0820_Clic_Menu_Bag":332,"F_T_U_E.Step0840_Clic_Menu_Weapons":333,"F_T_U_E.Step0860_Equip_Ring":334,"F_T_U_E.Step0880_Close_Menu":335,"F_T_U_E.Step0900_Succed_Tuto_Step_3_Equip_Ring":336,"F_T_U_E.Step1000_Start_Tuto_Step_4_Change_Map":337,"F_T_U_E.Step1100_Succeed_Tuto_Step_4_Change_Map":338,"F_T_U_E.Step1200_Start_Tuto_Step_5_Start_Fight":339,"F_T_U_E.Step1230_Clic_Scarecrow":340,"F_T_U_E.Step1260_Clic_Attack":341,"F_T_U_E.Step1300_Succeed_Tuto_Step_5_Start_Fight":342,"F_T_U_E.Step1400_Start_Tuto_Step_6_Chose_Starting_Position":343,"F_T_U_E.Step1430_Clic_Desired_Position_Square":344,"F_T_U_E.Step1460_Clic_Ready_Button":345,"F_T_U_E.Step1500_Succeed_Tuto_Step_6_Chose_Starting_Position":346,"F_T_U_E.Step1600_Start_Tuto_Step_7_Move_In_Fight":347,"F_T_U_E.Step1630_Clic_Desired_Position_Square":348,"F_T_U_E.Step1660_Clic_Validate_Move":349,"F_T_U_E.Step1700_Succed_Tuto_Step_7_Move_In_Fight":350,"F_T_U_E.Step1800_Start_Tuto_Step_8_Use_Spell":351,"F_T_U_E.Step1820_Clic_Attack_Button":352,"F_T_U_E.Step1850_Select_Target":353,"F_T_U_E.Step1870_Validate_Attack":354,"F_T_U_E.Step1890_Succeed_Tuto_Step_8_Use_Spell":355,"F_T_U_E.Step1900_Start_Tuto_Step_9_End_Turn":356,"F_T_U_E.Step1950_Clic_End_Turn_Button":357,"F_T_U_E.Step2000_Succeed_Tuto_Step_9_End_Turn":358,"F_T_U_E.Step2100_Start_Tuto_Step_10_Win_Fight":359,"F_T_U_E.Step2140_Scarecrow_Figh_End":360,"F_T_U_E.Step2180_Close_Fight_Summary_Window":361,"F_T_U_E.Step2200_Succeed_Tuto_Step_10_Win_Fight":362,"F_T_U_E.Step2300_Start_Tuto_Step_11_Start_Quest":363,"F_T_U_E.Step2330_Talk_To_NPC_Maitre_Pifo":364,"F_T_U_E.Step2360_Answer_NPC_Maitre_Pifo":365,"F_T_U_E.Step2400_Succeed_Tuto_Step_11_Start_Quest":366,"F_T_U_E.Step2500_Start_Tuto_Step_12_Equip_Items":367,"F_T_U_E.Step2510_Clic_Bag_Menu":368,"F_T_U_E.Step2520_Clic_Weapon_Menu":369,"F_T_U_E.Step2530_Equip_Cloak":370,"F_T_U_E.Step2540_Equip_Amulet":371,"F_T_U_E.Step2550_Equip_Belt":372,"F_T_U_E.Step2560_Equip_Shield":373,"F_T_U_E.Step2570_Equip_Sword":374,"F_T_U_E.Step2580_Equip_Boots":375,"F_T_U_E.Step2590_Quit_Bag_Menu":376,"F_T_U_E.Step2600_Succeed_Tuto_Step_12_Equip_Items":377,"F_T_U_E.Step2700_Start_Tuto_Step_13_Defeat_Monster":378,"F_T_U_E.Step2720_Change_Map":379,"F_T_U_E.Step2750_Clic_Monster_Lupus_Minimus":380,"F_T_U_E.Step2770_Attack_Monster_Lupus_Minimus":381,"F_T_U_E.Step2800_Succed_Tuto_Step_13_Defeat_Monster":382,"F_T_U_E.Step2900_Start_Tuto_Step_14_End_Fight":383,"F_T_U_E.Step2910_Lupus_Minimus_Figh_End":384,"F_T_U_E.Step2930_Win_Fight_Monster_Lupus_Minimus":385,"F_T_U_E.Step2960_Close_Fight_Summary_Window":386,"F_T_U_E.Step3000_Succed_Tuto_Step_14_End_Fight":387,"F_T_U_E.Step3100_Start_Tuto_Step_15_End_Learning":388,"F_T_U_E.Step3130_Talk_To_NPC_Maitre_Pifo":389,"F_T_U_E.Step3160_Answer_NPC_Maitre_Pifo":390,"F_T_U_E.Step3200_Succeed_Tuto_Step_15_End_Learning":391,"fight_report.fight_end_alive_monster_description":583,"character_progression.spell_level_change":585,"social.fight_group_join":586,"social.fight_group_quit":587,"social.guild_join":588,"social.guild_quit":589,"Fight_Action.Spell_Cast_By_User":398,"Fight_Report.Fight_Start":405,"Fight_Report.Fight_End":407,"User_Life_Cycle.Level_Up":415,"User_Life_Cycle.Achievement_Achieved":416,"User_Life_Cycle.Achievement_Get_Reward":417,"User_Life_Cycle.Quest_Start":418,"User_Life_Cycle.Quest_End":419,"User_Life_Cycle.Quest_Step_Success":420,"User_Life_Cycle.Quest_Step_Objective_Success":421,"User_Life_Cycle.Profession_Level_Up":426,"User_Life_Cycle.Death":427,"Fight_Report.Fight_Character_Description":555,"Fight_Report.Fight_Monster_Description":556,"Virtual_Economy.Receive_Item":428,"Game_Action.Talk_To_NPC":403,"Game_Action.Player_Answer_To_NPC":404,"HUD.Click_on_button":413,"HUD.Display_Menu":414}},function(e,t){e.exports={"Session_Info.Login":["account_session_id","character_level"],"Session_Info.Choose_Server":["account_session_id","character_level"],"Session_Info.Choose_Character":["character_level"],"F_T_U_E.Step3300_Use_shop":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0000_Chose_Nickname":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0100_Chose_Server":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0200_Create_First_Character":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","used_name_generator","used_proposed_style"],"F_T_U_E.Step0300_Enter_Tuto":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step9999_Quit_Tuto":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0400_Start_Tuto_Step_1_Move":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0500_Succeed_Tuto_Step_1_Move":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0600_Start_Tuto_Step_2_Speak_To_NPC":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0630_Clic_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","message_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0660_Answer_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0700_Succeed_Tuto_Step_2_Speak_To_NPC":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0800_Start_Tuto_Step_3_Equip_Ring":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0820_Clic_Menu_Bag":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0840_Clic_Menu_Weapons":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0860_Equip_Ring":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0880_Close_Menu":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step0900_Succed_Tuto_Step_3_Equip_Ring":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1000_Start_Tuto_Step_4_Change_Map":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1100_Succeed_Tuto_Step_4_Change_Map":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1200_Start_Tuto_Step_5_Start_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1230_Clic_Scarecrow":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1260_Clic_Attack":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1300_Succeed_Tuto_Step_5_Start_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1400_Start_Tuto_Step_6_Chose_Starting_Position":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1430_Clic_Desired_Position_Square":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1460_Clic_Ready_Button":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1500_Succeed_Tuto_Step_6_Chose_Starting_Position":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1600_Start_Tuto_Step_7_Move_In_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1630_Clic_Desired_Position_Square":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1660_Clic_Validate_Move":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1700_Succed_Tuto_Step_7_Move_In_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1800_Start_Tuto_Step_8_Use_Spell":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1820_Clic_Attack_Button":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1850_Select_Target":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1870_Validate_Attack":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1890_Succeed_Tuto_Step_8_Use_Spell":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1900_Start_Tuto_Step_9_End_Turn":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step1950_Clic_End_Turn_Button":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2000_Succeed_Tuto_Step_9_End_Turn":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2100_Start_Tuto_Step_10_Win_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2140_Scarecrow_Figh_End":["character_level","fight_id","hard_currency_balance","map_id","nb_turns","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","winner_team_id","winner_team_life_points"],"F_T_U_E.Step2180_Close_Fight_Summary_Window":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2200_Succeed_Tuto_Step_10_Win_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2300_Start_Tuto_Step_11_Start_Quest":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2330_Talk_To_NPC_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","message_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2360_Answer_NPC_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2400_Succeed_Tuto_Step_11_Start_Quest":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2500_Start_Tuto_Step_12_Equip_Items":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2510_Clic_Bag_Menu":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2520_Clic_Weapon_Menu":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2530_Equip_Cloak":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2540_Equip_Amulet":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2550_Equip_Belt":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2560_Equip_Shield":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2570_Equip_Sword":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2580_Equip_Boots":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2590_Quit_Bag_Menu":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2600_Succeed_Tuto_Step_12_Equip_Items":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2700_Start_Tuto_Step_13_Defeat_Monster":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2720_Change_Map":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2750_Clic_Monster_Lupus_Minimus":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2770_Attack_Monster_Lupus_Minimus":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2800_Succed_Tuto_Step_13_Defeat_Monster":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2900_Start_Tuto_Step_14_End_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2910_Lupus_Minimus_Figh_End":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2930_Win_Fight_Monster_Lupus_Minimus":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step2960_Close_Fight_Summary_Window":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step3000_Succed_Tuto_Step_14_End_Fight":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step3100_Start_Tuto_Step_15_End_Learning":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],
"F_T_U_E.Step3130_Talk_To_NPC_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","message_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step3160_Answer_NPC_Maitre_Pifo":["answer_id","character_level","hard_currency_balance","map_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"F_T_U_E.Step3200_Succeed_Tuto_Step_15_End_Learning":["character_level","fight_id","hard_currency_balance","map_id","nb_turns","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","winner_team_id","winner_team_life_points"],"fight_report.fight_end_alive_monster_description":["character_level","fight_id","hard_currency_balance","map_id","monster_grade","monster_id","monster_level","ratio_life_remaining","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","team_id","time_spent_on_action"],"character_progression.spell_level_change":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","spell_level_after","spell_level_before","time_spent_on_action"],"social.fight_group_join":["character_level","group_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"social.fight_group_quit":["character_level","group_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"social.guild_join":["character_level","guild_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"social.guild_quit":["character_level","guild_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Fight_Action.Spell_Cast_By_User":["character_level","fight_id","breed_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","spell_level","time_spent_on_action"],"Fight_Action.Spell_Confirmation":["character_level","fight_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","spell_level","spell_was_confirmed","time_spent_on_action"],"Fight_Action.Move_confirmation":["character_level","fight_id","hard_currency_balance","map_id","moved_confirmed","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Fight_Report.Fight_Start":["character_level","fight_id","fight_type","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","team_0_hp","team_1_hp","time_spent_on_action"],"Fight_Report.Fight_End":["character_level","fight_id","hard_currency_balance","map_id","nb_turns","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","winner_team_id","winner_team_life_points"],"User_Life_Cycle.Level_Up":["character_level","hard_currency_balance","map_id","old_level","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Achievement_Achieved":["achievement_id","character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Achievement_Get_Reward":["achievement_id","character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Quest_Start":["character_level","hard_currency_balance","map_id","quest_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Quest_End":["character_level","hard_currency_balance","map_id","quest_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Quest_Step_Success":["character_level","hard_currency_balance","map_id","quest_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","step_id","time_spent_on_action"],"User_Life_Cycle.Quest_Step_Objective_Success":["character_level","hard_currency_balance","map_id","objective_id","quest_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","step_id","time_spent_on_action"],"User_Life_Cycle.Profession_Level_Up":["character_level","hard_currency_balance","job_id","map_id","new_level","old_level","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"User_Life_Cycle.Death":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Fight_Report.Fight_Character_Description":["amu_id","belt_id","boots_id","character_level","cloack_id","comp_id","fight_id","hard_currency_balance","hat_id","is_incarnation","map_id","pet_id","relative_hard_currency_gained","relative_soft_currency_gained","ride_id","ringl_id","ringr_id","shield_id","soft_currency_balance","team_id","time_spent_on_action","weapon_id"],"Fight_Report.Fight_Monster_Description":["character_level","fight_id","hard_currency_balance","map_id","monster_grade","monster_id","monster_level","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","team_id","time_spent_on_action"],"Game_Action.Arrives_On_Map":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Virtual_Economy.Receive_Item":["character_level","context","context_id","hard_currency_balance","item_id","map_id","quantity","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Virtual_Economy.Dispose_Item":["character_level","context","context_id","hard_currency_balance","item_id","map_id","quantity","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"fight_action.spell_cast_by_monster":["character_level","fight_id","hard_currency_balance","map_id","monster_grade","monster_id","monster_level","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","spell_level","time_spent_on_action"],"fight_action.damage_ally":["ally_is_killed","character_level","fight_id","hard_currency_balance","life_points_removed_count","life_points_removed_percentage","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","target_character_id","target_monster_id","time_spent_on_action"],"fight_action.heal_ennemy":["character_level","fight_id","hard_currency_balance","life_points_given_count","life_points_given_percentage","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","target_character_id","target_monster_id","time_spent_on_action"],"user_life_cycle.xp_gained":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","xp"],"Game_Action.Travel":["character_level","destination_map_id","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","travel_method_category","travel_method_id"],"Game_Action.Talk_To_NPC":["answer_id","character_level","hard_currency_balance","map_id","message_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Game_Action.Player_Answer_To_NPC":["answer_id","character_level","hard_currency_balance","map_id","npc_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Game_Action.Mode_Marchant_On":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Game_Action.Memorize_New_Zaap":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action","zaap_id"],"Game_Action.Use_Scenery_Object":["character_level","element_uid","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Character_Progression.Caracteristic_Level_Up":["character_level","characteristic_id","characteristic_initial","characteristic_new","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Character_Progression.Caracteristic_Reset":["character_level","characteristic_name","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Character_Progression.New_Spell_Unlocked":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","spell_id","time_spent_on_action"],"Character_Progression.Incarnation_Level_Up":["character_level","hard_currency_balance","incarnation_id","incarnation_new_level","incarnation_old_level","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"HUD.Click_on_button":["button_id","character_level","clic_parameter_key","clic_parameter_value","clic_type","hard_currency_balance","interface_id","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"HUD.Display_Menu":["character_level","hard_currency_balance","interface_id","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"],"Virtual_Economy.Use_Bank_Account":["character_level","hard_currency_balance","map_id","relative_hard_currency_gained","relative_soft_currency_gained","soft_currency_balance","time_spent_on_action"]}},function(e,t){e.exports={300:"http://localhost:8888/forward",401:"https://analytics-north-virginia.touch.dofus.com/forward",402:"https://analytics-north-virginia.touch.dofus.com/forward",407:"https://analytics-north-virginia.touch.dofus.com/forward",403:"https://analytics-ireland.touch.dofus.com/forward",404:"https://analytics-ireland.touch.dofus.com/forward",405:"https://analytics-ireland.touch.dofus.com/forward",406:"https://analytics-ireland.touch.dofus.com/forward",408:"https://analytics-ireland.touch.dofus.com/forward",409:"https://analytics-ireland.touch.dofus.com/forward",410:"https://analytics-ireland.touch.dofus.com/forward",411:"https://analytics-ireland.touch.dofus.com/forward",900:"https://analytics-ireland.touch.dofus.com/forward"}},function(e,t,i){function n(e,t,i){var n;return 204!==~~t&&(n="analytics.request: event "+e+", xhrError: "+t+" for url: "+i),n}var o=i(24);e.exports=function(e,t,i,s){if(!e)return s(new Error("analytics.request: url is empty"));t=t||{};var a=t.event_id,r=new XMLHttpRequest;r.timeout=5e3;var l=o.operation({retries:4,randomize:!0});r.onreadystatechange=function(){if(4===~~r.readyState){var t=n(a,r.status,e);return l.retry(t)?void console.warn("analytics.request failed event",a,"on the url",e,"will retry..."):t?s(l.mainError()):void s()}},l.attempt(function(){r.open("POST",e,!0),r.setRequestHeader("x-version",i),r.setRequestHeader("Content-type","application/json"),r.send(JSON.stringify(t))})}},function(e,t,i){e.exports=i(25)},function(e,t,i){var n=i(26);t.operation=function(e){var i=t.timeouts(e);return new n(i,{forever:e&&e.forever,unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var i in e)t[i]=e[i];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<t.retries;o++)n.push(this.createTimeout(o,t));return e&&e.forever&&!n.length&&n.push(this.createTimeout(o,t)),n.sort(function(e,t){return e-t}),n},t.createTimeout=function(e,t){var i=t.randomize?Math.random()+1:1,n=Math.round(i*t.minTimeout*Math.pow(t.factor,e));return n=Math.min(n,t.maxTimeout)},t.wrap=function(e,i,n){if(i instanceof Array&&(n=i,i=null),!n){n=[];for(var o in e)"function"==typeof e[o]&&n.push(o)}for(var s=0;s<n.length;s++){var a=n[s],r=e[a];e[a]=function(n){var o=t.operation(i),s=Array.prototype.slice.call(arguments,1),a=s.pop();s.push(function(e){o.retry(e)||(e&&(arguments[0]=o.mainError()),a.apply(this,arguments))}),o.attempt(function(){n.apply(e,s)})}.bind(e,r),e[a].options=i}}},function(e,t){function i(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=i,i.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},i.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},i.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var i=this._timeouts.shift();if(void 0===i){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),i=this._timeouts.shift()}var n=this,o=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},i);return this._options.unref&&o.unref(),!0},i.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var i=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){i._operationTimeoutCb()},i._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},i.prototype["try"]=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},i.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},i.prototype.start=i.prototype["try"],i.prototype.errors=function(){return this._errors},i.prototype.attempts=function(){return this._attempts},i.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,i=0,n=0;n<this._errors.length;n++){var o=this._errors[n],s=o.message,a=(e[s]||0)+1;e[s]=a,a>=i&&(t=o,i=a)}return t}},function(e,t,i){var n;!function(o){"use strict";function s(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function a(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var i=new Date(t.getFullYear(),0,4);i.setDate(i.getDate()-(i.getDay()+6)%7+3);var n=t.getTimezoneOffset()-i.getTimezoneOffset();t.setHours(t.getHours()-n);var o=(t-i)/6048e5;return 1+Math.floor(o)}function r(e){var t=e.getDay();return 0===t&&(t=7),t}function l(e){return null===e?"null":void 0===e?"undefined":"object"!=typeof e?typeof e:Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}var c=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g;return function(n,o,u,d){if(1!==arguments.length||"string"!==l(n)||/\d/.test(n)||(o=n,n=void 0),n=n||new Date,n instanceof Date||(n=new Date(n)),isNaN(n))throw TypeError("Invalid date");o=String(c.masks[o]||o||c.masks["default"]);var h=o.slice(0,4);"UTC:"!==h&&"GMT:"!==h||(o=o.slice(4),u=!0,"GMT:"===h&&(d=!0));var p=u?"getUTC":"get",m=n[p+"Date"](),f=n[p+"Day"](),g=n[p+"Month"](),_=n[p+"FullYear"](),v=n[p+"Hours"](),y=n[p+"Minutes"](),b=n[p+"Seconds"](),w=n[p+"Milliseconds"](),M=u?0:n.getTimezoneOffset(),T=a(n),C=r(n),I={d:m,dd:s(m),ddd:c.i18n.dayNames[f],dddd:c.i18n.dayNames[f+7],m:g+1,mm:s(g+1),mmm:c.i18n.monthNames[g],mmmm:c.i18n.monthNames[g+12],yy:String(_).slice(2),yyyy:_,h:v%12||12,hh:s(v%12||12),H:v,HH:s(v),M:y,MM:s(y),s:b,ss:s(b),l:s(w,3),L:s(Math.round(w/10)),t:v<12?c.i18n.timeNames[0]:c.i18n.timeNames[1],tt:v<12?c.i18n.timeNames[2]:c.i18n.timeNames[3],T:v<12?c.i18n.timeNames[4]:c.i18n.timeNames[5],TT:v<12?c.i18n.timeNames[6]:c.i18n.timeNames[7],Z:d?"GMT":u?"UTC":(String(n).match(t)||[""]).pop().replace(i,""),o:(M>0?"-":"+")+s(100*Math.floor(Math.abs(M)/60)+Math.abs(M)%60,4),S:["th","st","nd","rd"][m%10>3?0:(m%100-m%10!=10)*m%10],W:T,N:C};return o.replace(e,function(e){return e in I?I[e]:e.slice(1,e.length-1)})}}();c.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},c.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},n=function(){return c}.call(t,i,t,e),!(void 0!==n&&(e.exports=n))}(this)},function(e,t,i){function n(e){var t=parseInt(e,10);return t>9?t:"0"+t}function o(e){this.timestamp=e}var s=i(29).getText;t.time={serverTimeLag:0,serverUtcTimeLag:0,timezoneOffset:0,dofusTimeYearLag:-1370},t.getDateNow=function(){return Date.now()},t.leadWithZero=n,t.initialize=function(e){e.on("BasicTimeMessage",function(e){var i=t.getDateNow(),n=t.time;n.serverTimeLag=1e3*(e.timestamp+60*e.timezoneOffset)-i,n.serverUtcTimeLag=1e3*e.timestamp-i,n.timezoneOffset=60*e.timezoneOffset*1e3})},t.now=function(){return t.getDateNow()+t.time.serverUtcTimeLag},t.DofusDate=o,o.prototype.getLocalDate=function(e){var i=new Date(1e3*this.timestamp);return this.dofusDate=e,this.date=i,this.year=i.getFullYear()+(e?t.time.dofusTimeYearLag:0),this.month=i.getMonth(),this.day=i.getDate(),this.hour=i.getHours(),this.minute=i.getMinutes(),this},o.prototype.getServerDate=function(e){var i=new Date(1e3*this.timestamp+t.time.timezoneOffset);return this.dofusDate=e,this.date=i,this.year=i.getUTCFullYear()+(e?t.time.dofusTimeYearLag:0),this.month=i.getUTCMonth(),this.day=i.getUTCDate(),this.hour=i.getUTCHours(),this.minute=i.getUTCMinutes(),this},o.prototype.toString=function(e){if(!this.date)return{};var i=!this.dofusDate&&e,o=this.year+(i?t.time.dofusTimeYearLag:0),a=n(this.day),r=n(this.month+1),l=n(this.hour),c=n(this.minute);return{date:s("ui.time.dateNumbers",a,r,o),time:l+":"+c,year:o,month:r,monthName:window.gui.databases.Months[this.month].nameId,day:a,hour:l,minute:c}}},function(e,t,i){function n(e,t,i){for(var n=void 0!==i?i:t[1],o="",s=0,a=e.length;s<a;s++){var r=e[s];if("%"===r||"#"===r){var l=parseInt(e[s+1],10);if(!isNaN(l)){var c=t[l];void 0===i&&(n=c),void 0!==c&&null!==c&&(o+=c),s++;continue}}if("{"===r||"("===r){var u=e.indexOf("{"===r?"}":")",s);if(u!==-1&&"~"===e[s+1]){var d=!1;switch(e[s+2]){case"p":d=1!==n&&"1"!==n;break;//!=1 is gramatically correct and similar to Ankama's code
case"s":d=1===n||"1"===n;break;case"m":d=0===n;break;case"f":d=0!==n;break;case"1":"~"===e[s+3]&&"2"===e[s+4]&&(d=void 0!==t[1]&&null!==t[1]&&void 0!==t[2]&&null!==t[2],s+=2);break;default:console.error("Found unknown marker in:",e)}d&&(o+=e.substring(s+3,u)),s=u;continue}}o+=r}return o}function o(e,t){return u?a+"["+e+"]":void 0===t[1]?e:n(e,t)}var s=i(30),a="en",r="en",l=null,c=null,u=!1;t.initialize=function(e,t){return l&&a===e.language&&u===e.chaseText?t():(a=e.language,u=e.chaseText,r=e.failoverLanguage||r,void s.initializeDictionariesAndDiskCache(a,r,function(e,i,n){return e?t(e):(l=i,c=n,void t())}))},t.initializeStatic=function(e,t){a=e,l=t},t.findText=function(e){return u?a+"["+e+"]":e},t.getText=function(e){var t=l[e];if(!t){if(console.warn("getText: no getText was found for",e,"in",a),!c||!c[e])return console.error("getText: no failover getText was found for",e,"in",r),a+"[?"+e+"]";t=c[e]}return o(t,arguments)},t.getTextFailover=function(e){var t=c[e];return t?o(t,arguments):(console.error("getTextFailover: no failover getText was found for",e,"in",r),a+"[?"+e+"]")},t.hasText=function(e){return!(!l[e]&&!c[e])},t.processText=function(e){return n(e,arguments)},t.processTextWithModifier=function(e,t){return n(e,Array.prototype.slice.call(arguments,1),t)}},function(e,t,i){function n(e){f.initialize(y+m.cacheDatabaseSuffix,m,function(t){if(t){var i="tablet.fatal.idb",n=d&&d[i]||h&&h[i]||"IDB failure";return"string"==typeof t&&"IDB_"===t.substr(0,4)&&(n+="\n\n("+t+")"),window.dofus.reloadAppOnFatalError("InitializeDiskCache: "+t,n)}return e()})}function o(e,t,i){return g(v,"/data/"+e,t,y,i)}function s(e,t){for(var i=Object.keys(e),n=i.length,o=new Array(n),s=0;s<n;s++)o[s]=e[i[s]];if(t&&t.sortBy){var a=t.sortBy;o.sort(function(e,t){return e[a]-t[a]})}return o}function a(e,t,i){var n=[];for(var o in e)n.push(e[o]);if(i){var s=m.getKey(t);n.sort(function(e,t){return e[s]-t[s]})}return n}function r(e,t){f.requestAll(e,function(i,n){return i?t(i):n?t(null,n):o("map",{"class":e},function(i,n){if(i)return t(i);var o,s=m.getKey(e);for(var a in n){o=n[a]&&void 0!==n[a][s];break}return o?f.putAll(e,n,function(e){e&&console.warn("_getAllDataMap putAll: Caching data on disk failed with error: "+e)}):console.warn("Request to cache table "+e+' which has no "'+s+'" key; table will not be cached.'),t(null,n)})})}function l(e,t){var i={};p.eachLimit(e,5,function(e,t){return r(e,function(n,o){return n?t(n):(i[e]=o,t())})},function(e){return e?t(e):t(null,i)})}function c(e,t,i){r(e,function(n,o){return n?i(n):i(null,a(o,e,t))})}function u(e,t,i){var n={};p.eachLimit(e,5,function(e,i){return c(e,t,function(t,o){return t?i(t):(n[e]=o,i())})},function(e){return e?i(e):i(null,n)})}var d,h,p=i(31),m=i(35),f=i(36),g=i(38),_=f.DUMMY_RECORD_FLAG,v=null,y=null;t.initialize=function(e){v=e.dataUrl},t.initializeDiskCache=n,t.eraseDiskCache=function(e){var t=["en","fr","es","it","de","pt"];p.eachSeries(t,function(e,t){return f["delete"](e+m.cacheDatabaseSuffix,t)},e)},t.changeLanguage=function(e){y=e},t.initializeDictionariesAndDiskCache=function(e,t,i){d=null,h=null;var s=[];y=null,p.series([function(i){return e===t?i():void o("dictionary",{lang:e},function(e,t){e?s.push(e):d=t,i()})},function(e){o("dictionary",{lang:t},function(t,i){t?s.push(t):h=i,e()})}],function(){var o=s.join(", ");return d||h?(o&&console.error("Failed getting dictionaries: "+o),d?y=e:(d=h,y=t),h||(h=d),void n(function(){i(null,d,h)})):window.dofus.reloadAppOnFatalError("No "+e+"/"+t+" dictionary: "+o)})},t.getText=function(e,t){var i={};Array.isArray(e)?i.ids=e:i.id=e,o("text",i,function(e,i){return e?t(e):void t(null,i)})},t.getDataMap=function(e,t,i){return Array.isArray(t)?void f.request(e,t,function(t,n,s){if(t)return i(t);var a={};for(var r in n)n[r][_]||(a[r]=n[r]);if(0===s.length)return i(null,a);var l={"class":e,ids:s};o("map",l,function(t,n){if(t)return i(t);for(var o=0,r=s.length;o<r;o++){var l=s[o],c=n[l];c?a[l]=c:n[l]=f.newDummyRecord(m.getKey(e),l)}return f.put(e,n,function(e){e&&console.warn("getDataMap put: Caching data on disk failed with error:",e)}),i(null,a)})}):i(new TypeError("Data ids should be passed as an array"))},t.getDataArray=function(e,i,n,o){"function"==typeof n&&(o=n,n=null),t.getDataMap(e,i,function(e,t){return e?o(e):void o(null,s(t,n))})},t.searchDataMap=function(e,t,i){var n={"class":e,match:t.match,matchProp:t.matchProp};o("map",n,function(t,n){return t?i(t):(f.put(e,n,function(e){e&&console.warn("searchDataMap put: Caching search results on disk failed with error: "+e)}),i(null,n))})},t.getObject=function(e,i,n){return i||0===i?void t.getDataMap(e,[i],function(t,o){if(t)return n(t);var s=o[i];return s?n(null,s):n("Missing ID #"+i+" in static data "+e)}):n(new Error("You must pass an ID"))},t.getData=function(e,i,n){return Array.isArray(i)?t.getDataArray(e,i,null,n):i||0===i?void t.getDataMap(e,[i],function(e,t){return e?n(e):n(null,t[i])}):n(new Error("You must pass an ID"))},t.getAllDataTable=function(e,t){return Array.isArray(e)?u(e,!0,t):c(e,!0,t)},t.getAllDataBulk=function(e,t){return Array.isArray(e)?u(e,!1,t):c(e,!1,t)},t.getAllDataMap=function(e,t){return Array.isArray(e)?l(e,t):r(e,t)}},function(e,t,i){(function(e,i,n,o){!function(e,i){i(t)}(this,function(t){"use strict";function s(e,t){t=0|t;for(var i=Math.max(e.length-t,0),n=Array(i),o=0;o<i;o++)n[o]=e[t+o];return n}function a(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function r(e){setTimeout(e,0)}function l(e){return function(t){var i=s(arguments,1);e(function(){t.apply(null,i)})}}function c(e){return ut(function(t,i){var n;try{n=e.apply(this,t)}catch(o){return i(o)}a(n)&&"function"==typeof n.then?n.then(function(e){u(i,null,e)},function(e){u(i,e.message?e:new Error(e))}):i(null,n)})}function u(e,t,i){try{e(t,i)}catch(n){pt(d,n)}}function d(e){throw e}function h(e){return mt&&"AsyncFunction"===e[Symbol.toStringTag]}function p(e){return h(e)?c(e):e}function m(e){return function(t){var i=s(arguments,1),n=ut(function(i,n){var o=this;return e(t,function(e,t){p(e).apply(o,i.concat(t))},n)});return i.length?n.apply(this,i):n}}function f(e){var t=bt.call(e,Mt),i=e[Mt];try{e[Mt]=void 0;var n=!0}catch(o){}var s=wt.call(e);return n&&(t?e[Mt]=i:delete e[Mt]),s}function g(e){return Ct.call(e)}function _(e){return null==e?void 0===e?At:It:St&&St in Object(e)?f(e):g(e)}function v(e){if(!a(e))return!1;var t=_(e);return t==xt||t==Lt||t==Et||t==Nt}function y(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ot}function b(e){return null!=e&&y(e.length)&&!v(e)}function w(){}function M(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}function T(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}function C(e){return null!=e&&"object"==typeof e}function I(e){return C(e)&&_(e)==Bt}function A(){return!1}function S(e,t){var i=typeof e;return t=null==t?Xt:t,!!t&&("number"==i||"symbol"!=i&&Qt.test(e))&&e>-1&&e%1==0&&e<t}function E(e){return C(e)&&y(e.length)&&!!bi[_(e)]}function x(e){return function(t){return e(t)}}function L(e,t){var i=qt(e),n=!i&&Ht(e),o=!i&&!n&&Vt(e),s=!i&&!n&&!o&&Si(e),a=i||n||o||s,r=a?T(e.length,String):[],l=r.length;for(var c in e)!t&&!xi.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||S(c,l))||r.push(c);return r}function N(e){var t=e&&e.constructor,i="function"==typeof t&&t.prototype||Li;return e===i}function O(e,t){return function(i){return e(t(i))}}function D(e){if(!N(e))return Ni(e);var t=[];for(var i in Object(e))Di.call(e,i)&&"constructor"!=i&&t.push(i);return t}function R(e){return b(e)?L(e):D(e)}function P(e){var t=-1,i=e.length;return function(){return++t<i?{value:e[t],key:t}:null}}function B(e){var t=-1;return function(){var i=e.next();return i.done?null:(t++,{value:i.value,key:t})}}function k(e){var t=R(e),i=-1,n=t.length;return function(){var o=t[++i];return i<n?{value:e[o],key:o}:null}}function F(e){if(b(e))return P(e);var t=Pt(e);return t?B(t):k(e)}function z(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function H(e){return function(t,i,n){function o(e,t){if(l-=1,e)r=!0,n(e);else{if(t===Dt||r&&l<=0)return r=!0,n(null);c||s()}}function s(){for(c=!0;l<e&&!r;){var t=a();if(null===t)return r=!0,void(l<=0&&n(null));l+=1,i(t.value,t.key,z(o))}c=!1}if(n=M(n||w),e<=0||!t)return n(null);var a=F(t),r=!1,l=0,c=!1;s()}}function q(e,t,i,n){H(t)(e,p(i),n)}function W(e,t){return function(i,n,o){return e(i,t,n,o)}}function U(e,t,i){function n(e,t){e?i(e):++s!==a&&t!==Dt||i(null)}i=M(i||w);var o=0,s=0,a=e.length;for(0===a&&i(null);o<a;o++)t(e[o],o,z(n))}function Y(e){return function(t,i,n){return e(Pi,t,p(i),n)}}function G(e,t,i,n){n=n||w,t=t||[];var o=[],s=0,a=p(i);e(t,function(e,t,i){var n=s++;a(e,function(e,t){o[n]=t,i(e)})},function(e){n(e,o)})}function j(e){return function(t,i,n,o){return e(H(i),t,p(n),o)}}function V(e,t){for(var i=-1,n=null==e?0:e.length;++i<n&&t(e[i],i,e)!==!1;);return e}function X(e){return function(t,i,n){for(var o=-1,s=Object(t),a=n(t),r=a.length;r--;){var l=a[e?r:++o];if(i(s[l],l,s)===!1)break}return t}}function Q(e,t){return e&&qi(e,t,R)}function K(e,t,i,n){for(var o=e.length,s=i+(n?1:-1);n?s--:++s<o;)if(t(e[s],s,e))return s;return-1}function J(e){return e!==e}function Z(e,t,i){for(var n=i-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}function $(e,t,i){return t===t?Z(e,t,i):K(e,J,i)}function ee(e,t){for(var i=-1,n=null==e?0:e.length,o=Array(n);++i<n;)o[i]=t(e[i],i,e);return o}function te(e){return"symbol"==typeof e||C(e)&&_(e)==Ui}function ie(e){if("string"==typeof e)return e;if(qt(e))return ee(e,ie)+"";if(te(e))return ji?ji.call(e):"";var t=e+"";return"0"==t&&1/e==-Yi?"-0":t}function ne(e,t,i){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),i=i>o?o:i,i<0&&(i+=o),o=t>i?0:i-t>>>0,t>>>=0;for(var s=Array(o);++n<o;)s[n]=e[n+t];return s}function oe(e,t,i){var n=e.length;return i=void 0===i?n:i,!t&&i>=n?e:ne(e,t,i)}function se(e,t){for(var i=e.length;i--&&$(t,e[i],0)>-1;);return i}function ae(e,t){for(var i=-1,n=e.length;++i<n&&$(t,e[i],0)>-1;);return i}function re(e){return e.split("")}function le(e){return en.test(e)}function ce(e){return e.match(wn)||[]}function ue(e){return le(e)?ce(e):re(e)}function de(e){return null==e?"":ie(e)}function he(e,t,i){if(e=de(e),e&&(i||void 0===t))return e.replace(Mn,"");if(!e||!(t=ie(t)))return e;var n=ue(e),o=ue(t),s=ae(n,o),a=se(n,o)+1;return oe(n,s,a).join("")}function pe(e){return e=e.toString().replace(An,""),e=e.match(Tn)[2].replace(" ",""),e=e?e.split(Cn):[],e=e.map(function(e){return he(e.replace(In,""))})}function me(e,t){var i={};Q(e,function(e,t){function n(t,i){var n=ee(o,function(e){return t[e]});n.push(i),p(e).apply(null,n)}var o,s=h(e),a=!s&&1===e.length||s&&0===e.length;if(qt(e))o=e.slice(0,-1),e=e[e.length-1],i[t]=o.concat(o.length>0?n:e);else if(a)i[t]=e;else{if(o=pe(e),0===e.length&&!s&&0===o.length)throw new Error("autoInject task functions require explicit parameters.");s||o.pop(),i[t]=o.concat(n)}}),Wi(i,t)}function fe(){this.head=this.tail=null,this.length=0}function ge(e,t){e.length=1,e.head=e.tail=t}function _e(e,t,i){function n(e,t,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(u.started=!0,qt(e)||(e=[e]),0===e.length&&u.idle())return pt(function(){u.drain()});for(var n=0,o=e.length;n<o;n++){var s={data:e[n],callback:i||w};t?u._tasks.unshift(s):u._tasks.push(s)}l||(l=!0,pt(function(){l=!1,u.process()}))}function o(e){return function(t){a-=1;for(var i=0,n=e.length;i<n;i++){var o=e[i],s=$(r,o,0);0===s?r.shift():s>0&&r.splice(s,1),o.callback.apply(o,arguments),null!=t&&u.error(t,o.data)}a<=u.concurrency-u.buffer&&u.unsaturated(),u.idle()&&u.drain(),u.process()}}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var s=p(e),a=0,r=[],l=!1,c=!1,u={_tasks:new fe,concurrency:t,payload:i,saturated:w,unsaturated:w,buffer:t/4,empty:w,drain:w,error:w,started:!1,paused:!1,push:function(e,t){n(e,!1,t)},kill:function(){u.drain=w,u._tasks.empty()},unshift:function(e,t){n(e,!0,t)},remove:function(e){u._tasks.remove(e)},process:function(){if(!c){for(c=!0;!u.paused&&a<u.concurrency&&u._tasks.length;){var e=[],t=[],i=u._tasks.length;u.payload&&(i=Math.min(i,u.payload));for(var n=0;n<i;n++){var l=u._tasks.shift();e.push(l),r.push(l),t.push(l.data)}a+=1,0===u._tasks.length&&u.empty(),a===u.concurrency&&u.saturated();var d=z(o(e));s(t,d)}c=!1}},length:function(){return u._tasks.length},running:function(){return a},workersList:function(){return r},idle:function(){return u._tasks.length+a===0},pause:function(){u.paused=!0},resume:function(){u.paused!==!1&&(u.paused=!1,pt(u.process))}};return u}function ve(e,t){return _e(e,1,t)}function ye(e,t,i,n){n=M(n||w);var o=p(i);En(e,function(e,i,n){o(t,e,function(e,i){t=i,n(e)})},function(e){n(e,t)})}function be(){var e=ee(arguments,p);return function(){var t=s(arguments),i=this,n=t[t.length-1];"function"==typeof n?t.pop():n=w,ye(e,t,function(e,t,n){t.apply(i,e.concat(function(e){var t=s(arguments,1);n(e,t)}))},function(e,t){n.apply(i,[e].concat(t))})}}function we(e){return e}function Me(e,t){return function(i,n,o,s){s=s||w;var a,r=!1;i(n,function(i,n,s){o(i,function(n,o){n?s(n):e(o)&&!a?(r=!0,a=t(!0,i),s(null,Dt)):s()})},function(e){e?s(e):s(null,r?a:t(!1))})}}function Te(e,t){return t}function Ce(e){return function(t){var i=s(arguments,1);i.push(function(t){var i=s(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&V(i,function(t){console[e](t)}))}),p(t).apply(null,i)}}function Ie(e,t,i){function n(e){if(e)return i(e);var t=s(arguments,1);t.push(o),r.apply(this,t)}function o(e,t){return e?i(e):t?void a(n):i(null)}i=z(i||w);var a=p(e),r=p(t);o(null,!0)}function Ae(e,t,i){i=z(i||w);var n=p(e),o=function(e){if(e)return i(e);var a=s(arguments,1);return t.apply(this,a)?n(o):void i.apply(null,[null].concat(a))};n(o)}function Se(e,t,i){Ae(e,function(){return!t.apply(this,arguments)},i)}function Ee(e,t,i){function n(e){return e?i(e):void a(o)}function o(e,t){return e?i(e):t?void s(n):i(null)}i=z(i||w);var s=p(t),a=p(e);a(o)}function xe(e){return function(t,i,n){return e(t,n)}}function Le(e,t,i){Pi(e,xe(p(t)),i)}function Ne(e,t,i,n){H(t)(e,xe(p(i)),n)}function Oe(e){return h(e)?e:ut(function(t,i){var n=!0;t.push(function(){var e=arguments;n?pt(function(){i.apply(null,e)}):i.apply(null,e)}),e.apply(this,t),n=!1})}function De(e){return!e}function Re(e){return function(t){return null==t?void 0:t[e]}}function Pe(e,t,i,n){var o=new Array(t.length);e(t,function(e,t,n){i(e,function(e,i){o[t]=!!i,n(e)})},function(e){if(e)return n(e);for(var i=[],s=0;s<t.length;s++)o[s]&&i.push(t[s]);n(null,i)})}function Be(e,t,i,n){var o=[];e(t,function(e,t,n){i(e,function(i,s){i?n(i):(s&&o.push({index:t,value:e}),n())})},function(e){e?n(e):n(null,ee(o.sort(function(e,t){return e.index-t.index}),Re("value")))})}function ke(e,t,i,n){var o=b(t)?Pe:Be;o(e,t,p(i),n||w)}function Fe(e,t){function i(e){return e?n(e):void o(i)}var n=z(t||w),o=p(Oe(e));i()}function ze(e,t,i,n){n=M(n||w);var o={},s=p(i);q(e,t,function(e,t,i){s(e,t,function(e,n){return e?i(e):(o[t]=n,void i())})},function(e){n(e,o)})}function He(e,t){return t in e}function qe(e,t){var i=Object.create(null),n=Object.create(null);t=t||we;var o=p(e),a=ut(function(e,a){var r=t.apply(null,e);He(i,r)?pt(function(){a.apply(null,i[r])}):He(n,r)?n[r].push(a):(n[r]=[a],o.apply(null,e.concat(function(){var e=s(arguments);i[r]=e;var t=n[r];delete n[r];for(var o=0,a=t.length;o<a;o++)t[o].apply(null,e)})))});return a.memo=i,a.unmemoized=e,a}function We(e,t,i){i=i||w;var n=b(t)?[]:{};e(t,function(e,t,i){p(e)(function(e,o){arguments.length>2&&(o=s(arguments,1)),n[t]=o,i(e)})},function(e){i(e,n)})}function Ue(e,t){We(Pi,e,t)}function Ye(e,t,i){We(H(t),e,i)}function Ge(e,t){if(t=M(t||w),!qt(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var i=0,n=e.length;i<n;i++)p(e[i])(t)}function je(e,t,i,n){var o=s(e).reverse();ye(o,t,i,n)}function Ve(e){var t=p(e);return ut(function(e,i){return e.push(function(e,t){if(e)i(null,{error:e});else{var n;n=arguments.length<=2?t:s(arguments,1),i(null,{value:n})}}),t.apply(this,e)})}function Xe(e){var t;return qt(e)?t=ee(e,Ve):(t={},Q(e,function(e,i){t[i]=Ve.call(this,e)})),t}function Qe(e,t,i,n){ke(e,t,function(e,t){i(e,function(e,i){t(e,!i)})},n)}function Ke(e){return function(){return e}}function Je(e,t,i){function n(e,t){if("object"==typeof t)e.times=+t.times||s,e.intervalFunc="function"==typeof t.interval?t.interval:Ke(+t.interval||a),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||s}}function o(){l(function(e){e&&c++<r.times&&("function"!=typeof r.errorFilter||r.errorFilter(e))?setTimeout(o,r.intervalFunc(c)):i.apply(null,arguments)})}var s=5,a=0,r={times:s,intervalFunc:Ke(a)};if(arguments.length<3&&"function"==typeof e?(i=t||w,t=e):(n(r,e),i=i||w),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var l=p(t),c=1;o()}function Ze(e,t){We(En,e,t)}function $e(e,t,i){function n(e,t){var i=e.criteria,n=t.criteria;return i<n?-1:i>n?1:0}var o=p(t);Bi(e,function(e,t){o(e,function(i,n){return i?t(i):void t(null,{value:e,criteria:n})})},function(e,t){return e?i(e):void i(null,ee(t.sort(n),Re("value")))})}function et(e,t,i){var n=p(e);return ut(function(o,s){function a(){var t=e.name||"anonymous",n=new Error('Callback function "'+t+'" timed out.');n.code="ETIMEDOUT",i&&(n.info=i),l=!0,s(n)}var r,l=!1;o.push(function(){l||(s.apply(null,arguments),clearTimeout(r))}),r=setTimeout(a,t),n.apply(null,o)})}function tt(e,t,i,n){for(var o=-1,s=co(lo((t-e)/(i||1)),0),a=Array(s);s--;)a[n?s:++o]=e,e+=i;return a}function it(e,t,i,n){var o=p(i);Fi(tt(0,e,1),t,o,n)}function nt(e,t,i,n){arguments.length<=3&&(n=i,i=t,t=qt(e)?[]:{}),n=M(n||w);var o=p(i);Pi(e,function(e,i,n){o(t,e,i,n)},function(e){n(e,t)})}function ot(e,t){var i,n=null;t=t||w,zn(e,function(e,t){p(e)(function(e,o){i=arguments.length>2?s(arguments,1):o,n=e,t(!e)})},function(){t(n,i)})}function st(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function at(e,t,i){i=z(i||w);var n=p(t);if(!e())return i(null);var o=function(t){if(t)return i(t);if(e())return n(o);var a=s(arguments,1);i.apply(null,[null].concat(a))};n(o)}function rt(e,t,i){at(function(){return!e.apply(this,arguments)},t,i)}var lt,ct=function(e){var t=s(arguments,1);return function(){var i=s(arguments);return e.apply(null,t.concat(i))}},ut=function(e){return function(){var t=s(arguments),i=t.pop();e.call(this,t,i)}},dt="function"==typeof e&&e,ht="object"==typeof i&&"function"==typeof i.nextTick;lt=dt?e:ht?i.nextTick:r;var pt=l(lt),mt="function"==typeof Symbol,ft="object"==typeof n&&n&&n.Object===Object&&n,gt="object"==typeof self&&self&&self.Object===Object&&self,_t=ft||gt||Function("return this")(),vt=_t.Symbol,yt=Object.prototype,bt=yt.hasOwnProperty,wt=yt.toString,Mt=vt?vt.toStringTag:void 0,Tt=Object.prototype,Ct=Tt.toString,It="[object Null]",At="[object Undefined]",St=vt?vt.toStringTag:void 0,Et="[object AsyncFunction]",xt="[object Function]",Lt="[object GeneratorFunction]",Nt="[object Proxy]",Ot=9007199254740991,Dt={},Rt="function"==typeof Symbol&&Symbol.iterator,Pt=function(e){return Rt&&e[Rt]&&e[Rt]()},Bt="[object Arguments]",kt=Object.prototype,Ft=kt.hasOwnProperty,zt=kt.propertyIsEnumerable,Ht=I(function(){return arguments}())?I:function(e){return C(e)&&Ft.call(e,"callee")&&!zt.call(e,"callee")},qt=Array.isArray,Wt="object"==typeof t&&t&&!t.nodeType&&t,Ut=Wt&&"object"==typeof o&&o&&!o.nodeType&&o,Yt=Ut&&Ut.exports===Wt,Gt=Yt?_t.Buffer:void 0,jt=Gt?Gt.isBuffer:void 0,Vt=jt||A,Xt=9007199254740991,Qt=/^(?:0|[1-9]\d*)$/,Kt="[object Arguments]",Jt="[object Array]",Zt="[object Boolean]",$t="[object Date]",ei="[object Error]",ti="[object Function]",ii="[object Map]",ni="[object Number]",oi="[object Object]",si="[object RegExp]",ai="[object Set]",ri="[object String]",li="[object WeakMap]",ci="[object ArrayBuffer]",ui="[object DataView]",di="[object Float32Array]",hi="[object Float64Array]",pi="[object Int8Array]",mi="[object Int16Array]",fi="[object Int32Array]",gi="[object Uint8Array]",_i="[object Uint8ClampedArray]",vi="[object Uint16Array]",yi="[object Uint32Array]",bi={};bi[di]=bi[hi]=bi[pi]=bi[mi]=bi[fi]=bi[gi]=bi[_i]=bi[vi]=bi[yi]=!0,bi[Kt]=bi[Jt]=bi[ci]=bi[Zt]=bi[ui]=bi[$t]=bi[ei]=bi[ti]=bi[ii]=bi[ni]=bi[oi]=bi[si]=bi[ai]=bi[ri]=bi[li]=!1;var wi="object"==typeof t&&t&&!t.nodeType&&t,Mi=wi&&"object"==typeof o&&o&&!o.nodeType&&o,Ti=Mi&&Mi.exports===wi,Ci=Ti&&ft.process,Ii=function(){try{var e=Mi&&Mi.require&&Mi.require("util").types;return e?e:Ci&&Ci.binding&&Ci.binding("util")}catch(t){}}(),Ai=Ii&&Ii.isTypedArray,Si=Ai?x(Ai):E,Ei=Object.prototype,xi=Ei.hasOwnProperty,Li=Object.prototype,Ni=O(Object.keys,Object),Oi=Object.prototype,Di=Oi.hasOwnProperty,Ri=W(q,1/0),Pi=function(e,t,i){var n=b(e)?U:Ri;n(e,p(t),i)},Bi=Y(G),ki=m(Bi),Fi=j(G),zi=W(Fi,1),Hi=m(zi),qi=X(),Wi=function(e,t,i){function n(e,t){v.push(function(){l(e,t)})}function o(){if(0===v.length&&0===f)return i(null,m);for(;v.length&&f<t;){var e=v.shift();e()}}function a(e,t){var i=_[e];i||(i=_[e]=[]),i.push(t)}function r(e){var t=_[e]||[];V(t,function(e){e()}),o()}function l(e,t){if(!g){var n=z(function(t,n){if(f--,arguments.length>2&&(n=s(arguments,1)),t){var o={};Q(m,function(e,t){o[t]=e}),o[e]=n,g=!0,_=Object.create(null),i(t,o)}else m[e]=n,r(e)});f++;var o=p(t[t.length-1]);t.length>1?o(m,n):o(n)}}function c(){for(var e,t=0;y.length;)e=y.pop(),t++,V(u(e),function(e){0===--b[e]&&y.push(e)});if(t!==h)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function u(t){var i=[];return Q(e,function(e,n){qt(e)&&$(e,t,0)>=0&&i.push(n)}),i}"function"==typeof t&&(i=t,t=null),i=M(i||w);var d=R(e),h=d.length;if(!h)return i(null);t||(t=h);var m={},f=0,g=!1,_=Object.create(null),v=[],y=[],b={};Q(e,function(t,i){if(!qt(t))return n(i,[t]),void y.push(i);var o=t.slice(0,t.length-1),s=o.length;return 0===s?(n(i,t),void y.push(i)):(b[i]=s,void V(o,function(r){if(!e[r])throw new Error("async.auto task `"+i+"` has a non-existent dependency `"+r+"` in "+o.join(", "));a(r,function(){s--,0===s&&n(i,t)})}))}),c(),o()},Ui="[object Symbol]",Yi=1/0,Gi=vt?vt.prototype:void 0,ji=Gi?Gi.toString:void 0,Vi="\\ud800-\\udfff",Xi="\\u0300-\\u036f",Qi="\\ufe20-\\ufe2f",Ki="\\u20d0-\\u20ff",Ji=Xi+Qi+Ki,Zi="\\ufe0e\\ufe0f",$i="\\u200d",en=RegExp("["+$i+Vi+Ji+Zi+"]"),tn="\\ud800-\\udfff",nn="\\u0300-\\u036f",on="\\ufe20-\\ufe2f",sn="\\u20d0-\\u20ff",an=nn+on+sn,rn="\\ufe0e\\ufe0f",ln="["+tn+"]",cn="["+an+"]",un="\\ud83c[\\udffb-\\udfff]",dn="(?:"+cn+"|"+un+")",hn="[^"+tn+"]",pn="(?:\\ud83c[\\udde6-\\uddff]){2}",mn="[\\ud800-\\udbff][\\udc00-\\udfff]",fn="\\u200d",gn=dn+"?",_n="["+rn+"]?",vn="(?:"+fn+"(?:"+[hn,pn,mn].join("|")+")"+_n+gn+")*",yn=_n+gn+vn,bn="(?:"+[hn+cn+"?",cn,pn,mn,ln].join("|")+")",wn=RegExp(un+"(?="+un+")|"+bn+yn,"g"),Mn=/^\s+|\s+$/g,Tn=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Cn=/,/,In=/(=.+)?(\s*)$/,An=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;fe.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},fe.prototype.empty=function(){for(;this.head;)this.shift();return this},fe.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},fe.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},fe.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):ge(this,e)},fe.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):ge(this,e)},fe.prototype.shift=function(){return this.head&&this.removeLink(this.head)},fe.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},fe.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,i=0;i<this.length;i++)e[i]=t.data,t=t.next;return e},fe.prototype.remove=function(e){for(var t=this.head;t;){var i=t.next;e(t)&&this.removeLink(t),t=i}return this};var Sn,En=W(q,1),xn=function(){return be.apply(null,s(arguments).reverse())},Ln=Array.prototype.concat,Nn=function(e,t,i,n){n=n||w;var o=p(i);Fi(e,t,function(e,t){o(e,function(e){return e?t(e):t(null,s(arguments,1))})},function(e,t){for(var i=[],o=0;o<t.length;o++)t[o]&&(i=Ln.apply(i,t[o]));return n(e,i)})},On=W(Nn,1/0),Dn=W(Nn,1),Rn=function(){var e=s(arguments),t=[null].concat(e);return function(){var e=arguments[arguments.length-1];return e.apply(this,t)}},Pn=Y(Me(we,Te)),Bn=j(Me(we,Te)),kn=W(Bn,1),Fn=Ce("dir"),zn=W(Ne,1),Hn=Y(Me(De,De)),qn=j(Me(De,De)),Wn=W(qn,1),Un=Y(ke),Yn=j(ke),Gn=W(Yn,1),jn=function(e,t,i,n){n=n||w;var o=p(i);Fi(e,t,function(e,t){o(e,function(i,n){return i?t(i):t(null,{key:n,val:e})})},function(e,t){for(var i={},o=Object.prototype.hasOwnProperty,s=0;s<t.length;s++)if(t[s]){var a=t[s].key,r=t[s].val;o.call(i,a)?i[a].push(r):i[a]=[r]}return n(e,i)})},Vn=W(jn,1/0),Xn=W(jn,1),Qn=Ce("log"),Kn=W(ze,1/0),Jn=W(ze,1);Sn=ht?i.nextTick:dt?e:r;var Zn=l(Sn),$n=function(e,t){var i=p(e);return _e(function(e,t){i(e[0],t)},t,1)},eo=function(e,t){var i=$n(e,t);return i.push=function(e,t,n){if(null==n&&(n=w),"function"!=typeof n)throw new Error("task callback must be a function");if(i.started=!0,qt(e)||(e=[e]),0===e.length)return pt(function(){i.drain()});t=t||0;for(var o=i._tasks.head;o&&t>=o.priority;)o=o.next;for(var s=0,a=e.length;s<a;s++){var r={data:e[s],priority:t,callback:n};o?i._tasks.insertBefore(o,r):i._tasks.push(r)}pt(i.process)},delete i.unshift,i},to=Y(Qe),io=j(Qe),no=W(io,1),oo=function(e,t){t||(t=e,e=null);var i=p(t);return ut(function(t,n){function o(e){i.apply(null,t.concat(e))}e?Je(e,o,n):Je(o,n)})},so=Y(Me(Boolean,we)),ao=j(Me(Boolean,we)),ro=W(ao,1),lo=Math.ceil,co=Math.max,uo=W(it,1/0),ho=W(it,1),po=function(e,t){function i(t){var i=p(e[o++]);t.push(z(n)),i.apply(null,t)}function n(n){return n||o===e.length?t.apply(null,arguments):void i(s(arguments,1))}if(t=M(t||w),!qt(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var o=0;i([])},mo={apply:ct,applyEach:ki,applyEachSeries:Hi,asyncify:c,auto:Wi,autoInject:me,cargo:ve,compose:xn,concat:On,concatLimit:Nn,concatSeries:Dn,constant:Rn,detect:Pn,detectLimit:Bn,detectSeries:kn,dir:Fn,doDuring:Ie,doUntil:Se,doWhilst:Ae,during:Ee,each:Le,eachLimit:Ne,eachOf:Pi,eachOfLimit:q,eachOfSeries:En,eachSeries:zn,ensureAsync:Oe,every:Hn,everyLimit:qn,everySeries:Wn,filter:Un,filterLimit:Yn,filterSeries:Gn,forever:Fe,groupBy:Vn,groupByLimit:jn,groupBySeries:Xn,log:Qn,map:Bi,mapLimit:Fi,mapSeries:zi,mapValues:Kn,mapValuesLimit:ze,mapValuesSeries:Jn,memoize:qe,nextTick:Zn,parallel:Ue,parallelLimit:Ye,priorityQueue:eo,queue:$n,race:Ge,reduce:ye,reduceRight:je,reflect:Ve,reflectAll:Xe,reject:to,rejectLimit:io,rejectSeries:no,retry:Je,retryable:oo,seq:be,series:Ze,setImmediate:pt,some:so,someLimit:ao,someSeries:ro,sortBy:$e,timeout:et,times:uo,timesLimit:it,timesSeries:ho,transform:nt,tryEach:ot,unmemoize:st,until:rt,waterfall:po,whilst:at,all:Hn,allLimit:qn,allSeries:Wn,any:so,anyLimit:ao,anySeries:ro,find:Pn,findLimit:Bn,findSeries:kn,forEach:Le,forEachSeries:zn,forEachLimit:Ne,forEachOf:Pi,forEachOfSeries:En,forEachOfLimit:q,inject:ye,foldl:ye,foldr:je,select:Un,selectLimit:Yn,selectSeries:Gn,wrapSync:c};t["default"]=mo,t.apply=ct,t.applyEach=ki,t.applyEachSeries=Hi,t.asyncify=c,t.auto=Wi,t.autoInject=me,t.cargo=ve,t.compose=xn,t.concat=On,t.concatLimit=Nn,t.concatSeries=Dn,t.constant=Rn,t.detect=Pn,t.detectLimit=Bn,t.detectSeries=kn,t.dir=Fn,t.doDuring=Ie,t.doUntil=Se,t.doWhilst=Ae,t.during=Ee,t.each=Le,t.eachLimit=Ne,t.eachOf=Pi,t.eachOfLimit=q,t.eachOfSeries=En,t.eachSeries=zn,t.ensureAsync=Oe,t.every=Hn,t.everyLimit=qn,t.everySeries=Wn,t.filter=Un,t.filterLimit=Yn,t.filterSeries=Gn,t.forever=Fe,t.groupBy=Vn,t.groupByLimit=jn,t.groupBySeries=Xn,t.log=Qn,t.map=Bi,t.mapLimit=Fi,t.mapSeries=zi,t.mapValues=Kn,t.mapValuesLimit=ze,t.mapValuesSeries=Jn,t.memoize=qe,t.nextTick=Zn,t.parallel=Ue,t.parallelLimit=Ye,t.priorityQueue=eo,t.queue=$n,t.race=Ge,t.reduce=ye,t.reduceRight=je,t.reflect=Ve,t.reflectAll=Xe,t.reject=to,t.rejectLimit=io,t.rejectSeries=no,t.retry=Je,t.retryable=oo,t.seq=be,t.series=Ze,t.setImmediate=pt,t.some=so,t.someLimit=ao,t.someSeries=ro,t.sortBy=$e,t.timeout=et,t.times=uo,t.timesLimit=it,t.timesSeries=ho,t.transform=nt,t.tryEach=ot,t.unmemoize=st,t.until=rt,t.waterfall=po,t.whilst=at,t.all=Hn,t.allLimit=qn,t.allSeries=Wn,t.any=so,t.anyLimit=ao,t.anySeries=ro,t.find=Pn,t.findLimit=Bn,t.findSeries=kn,t.forEach=Le,t.forEachSeries=zn,t.forEachLimit=Ne,t.forEachOf=Pi,t.forEachOfSeries=En,t.forEachOfLimit=q,t.inject=ye,t.foldl=ye,t.foldr=je,t.select=Un,t.selectLimit=Yn,t.selectSeries=Gn,t.wrapSync=c,Object.defineProperty(t,"__esModule",{value:!0})})}).call(t,i(32).setImmediate,i(33),function(){return this}(),i(34)(e))},function(e,t,i){(function(e,n){function o(e,t){this._id=e,this._clearFn=t}var s=i(33).nextTick,a=Function.prototype.apply,r=Array.prototype.slice,l={},c=0;t.setTimeout=function(){return new o(a.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(a.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var i=c++,n=!(arguments.length<2)&&r.call(arguments,1);return l[i]=!0,s(function(){l[i]&&(n?e.apply(null,n):e.call(null),t.clearImmediate(i))}),i},t.clearImmediate="function"==typeof n?n:function(e){delete l[e]}}).call(t,i(32).setImmediate,i(32).clearImmediate)},function(e,t){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(u===setTimeout)return setTimeout(e,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function s(e){if(d===clearTimeout)return clearTimeout(e);if((d===n||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){f&&p&&(f=!1,p.length?m=p.concat(m):g=-1,m.length&&r())}function r(){if(!f){var e=o(a);f=!0;for(var t=m.length;t;){for(p=m,m=[];++g<t;)p&&p[g].run();g=-1,t=m.length}p=null,f=!1,s(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var u,d,h=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(e){u=i}try{d="function"==typeof clearTimeout?clearTimeout:n}catch(e){d=n}}();var p,m=[],f=!1,g=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];m.push(new l(e,t)),1!==m.length||f||o(r)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=c,h.addListener=c,h.once=c,h.off=c,h.removeListener=c,h.removeAllListeners=c,h.emit=c,h.prependListener=c,h.prependOnceListener=c,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){e.exports.cacheDatabaseSuffix="DataCache";
var i="isCacheComplete";e.exports.cacheCompletion=i,e.exports.typeNames=["AbuseReasons","AchievementCategories","AchievementObjectives","AchievementRewards","Achievements","ActionDescriptions","AlignmentBalance","AlignmentEffect","AlignmentGift","AlignmentOrder","AlignmentRank","AlignmentRankJntGift","AlignmentSides","AlignmentTitles","AlmanaxCalendars","Appearances","Areas","BidHouseCategories","Breeds","CensoredContents","CensoredWords","Challenge","ChatChannels","CompanionCharacteristics","Companions","CompanionSpells","CreatureBonesOverrides","CreatureBonesTypes","Documents","Dungeons","Effects","EmblemBackgrounds","EmblemSymbolCategories","EmblemSymbols","Emoticons","ExternalNotifications","Heads","HintCategory","Hints","Houses","Incarnation","IncarnationLevels","InfoMessages","Interactives","Items","ItemSets","ItemTypes","Jobs","LegendaryTreasureHunts","LivingObjectSkinJntMood","MapCoordinates","MapPositions","MapReferences","MapScrollActions","MonsterMiniBoss","MonsterRaces","Monsters","MonsterSuperRaces","Months","MountBehaviors","MountBones","Mounts","Notifications","NpcActions","NpcMessages","Npcs","OptionalFeatures","Ornaments","Pack","Pets","Phoenixes","PointOfInterest","PointOfInterestCategory","PresetIcons","QuestCategory","QuestObjectives","QuestObjectiveTypes","Quests","QuestStepRewards","QuestSteps","RankNames","Recipes","RideFood","ServerCommunities","ServerGameTypes","ServerPopulations","Servers","ShieldModelsLevels","SkillNames","Skills","SkinMappings","SkinPositions","Smileys","SoundBones","SoundUi","SoundUiHook","SpeakingItemsText","SpeakingItemsTriggers","SpellBombs","SpellLevels","SpellPairs","Spells","SpellStates","SpellTypes","StealthBones","SubAreas","SubAreaIdPerCoordinate","SubAreasWorldMapData","SuperAreas","TaxCollectorFirstnames","TaxCollectorNames","Tips","TitleCategories","Titles","ToaRank","TypeActions","Url","Waypoints","WorldMaps"];var n={AbuseReasons:"_abuseReasonId",AlignmentTitles:"sideId",CreatureBonesOverrides:"creatureBoneId",Houses:"typeId",InfoMessages:"messageId",LivingObjectSkinJntMood:"skinId",MapCoordinates:"compressedCoords",Phoenixes:"mapId",Recipes:"resultId",SpeakingItemsText:"textId",SpeakingItemsTriggers:"triggersId"};e.exports.getKey=function(e){return n[e]||"id"};var o={};o[i]=!0,e.exports.hasStringId=function(e){return o[e]||!1}},function(e,t,i){function n(e){return"string"==typeof e?e:e.toString()}function o(e){if("number"==typeof e)return e;var t=parseInt(e,10);return isNaN(t)?null:t}function s(e){return m.hasStringId(e)?n:o}function a(e){try{for(var t=1;t<arguments.length;t++)t>1&&(e+=", "),e+=r(arguments[t]);for(var i in w)if(e.indexOf(i)!==-1){var n=++w[i];if(n%M!==1)return e;e+=" (x"+n+")"}console.error(e)}catch(o){console.error('Failed logging createError for "'+e+'": '+o)}return e}function r(e){switch(typeof e){case"string":return e;case"object":if(null===e)return"null";if(void 0!==e.name||void 0!==e.code||void 0!==e.message){var t=e.name?e.name:e.code;return t+(e.message?"("+e.message+")":"")}var i="{ ";for(var n in e)i+=n+":"+e[n]+" ";return i+"}";default:return""+e}}function l(e,t){function i(i){var n=m.getKey(i),o=e.createObjectStore(i,{keyPath:n}),s=o.transaction;s.oncomplete=function(){if(console.info("Object store creation completed for: "+i),!b)return y++,y===v?(p=e,b=!0,t()):void 0},s.onabort=function(){b||(b=!0,t(a("Object store creation aborted for "+i+": ",s.error)))},s.onerror=function(){b||(b=!0,t(a("Object store creation failed for "+i+": ",s.error)))}}y=0;var n=m.typeNames;v=n.length+(m.cacheCompletion?1:0);for(var o=0,s=n.length;o<s;++o)i(n[o]);m.cacheCompletion&&i(m.cacheCompletion)}function c(e,t,i){function n(t){if(void 0===t||null===t)return void console.error(new Error("IndexedDB id to get in object store: "+e+", is invalid: "+t));if(t=u(t),null===t)return void console.error(new Error("IndexedDB id to get in object store: "+e+", is invalid: "+t));var i=c.get(t);i.onsuccess=function(e){e.target.result?o[t]=e.target.result:r.push(t)},i.onerror=function(){a("Requesting id: "+t+", in store: "+e+", failed: ",i.error),r.push(t)}}var o={},r=[];if(!t.length)return i(null,o,r);for(var l=p.transaction(e,g.READ_ONLY),c=l.objectStore(e),u=s(e),d=0,h=t.length;d<h;++d)n(t[d]);l.oncomplete=function(){i(null,o,r)},l.onabort=function(){i(a("IndexedDB request transaction aborted with error: ",l.error))},l.onerror=function(){i(a("IndexedDB request transaction failed with error: ",l.error))}}function u(e,t,i){function n(t){if(!t)return void console.error("IndexedDB object to put in object store: "+e+", is invalid: "+t);if(t[u]=d(t[u]),null===t[u])return void console.error("IndexedDB object to put in object store: "+e+", is invalid: "+t);var i=c.put(t);i.onsuccess=function(){},i.onerror=function(){a("IndexedDB put object in store: "+e+", failed: ",i.error)}}var o,r=!0;for(o in t){r=!1;break}if(r)return i();var l=p.transaction(e,g.READ_WRITE),c=l.objectStore(e),u=m.getKey(e),d=s(e);for(o in t)n(t[o]);l.oncomplete=function(){i()},l.onabort=function(){i(a("IndexedDB put transaction aborted with error: ",l.error))},l.onerror=function(){i(a("IndexedDB put transaction failed with error: ",l.error))}}function d(e,t){var i={},n=p.transaction(e,g.READ_ONLY),o=n.objectStore(e),s=m.getKey(e),r=o.openCursor();r.onsuccess=function(e){var t=e.target.result;if(t){var n=t.value;n[_]||(i[n[s]]=n),t["continue"]()}},r.onerror=function(){a("IndexedDB opening cursor on object store: "+e+" failed: ",r.error)},n.oncomplete=function(){t(null,i)},n.onabort=function(){t(a("IndexedDB requestAll transaction aborted with error: ",n.error))},n.onerror=function(){t(a("IndexedDB requestAll transaction failed with error: ",n.error))}}function h(e,t,i){return p?p.objectStoreNames.contains(e)?void u(e,t,i):void i(new Error("IndexedDB request failed: object store: "+e+" not found in disk cache")):void i(new Error("IndexedDB request failed: disk cache not yet initialized"))}i(37);var p,m,f=window.indexedDB||window.shimIndexedDB,g=window.IDBTransaction,_=t.DUMMY_RECORD_FLAG="MISSING_ID";t.newDummyRecord=function(e,t){var i={};return i[_]=!0,i[e]=t,i};var v,y,b,w={QuotaExceededError:0},M=100;t.initialize=function(e,t,i){if(!f)return i(a("IDB_NOT_SUPPORTED"));p&&(p.close(),p=null),m=t,b=!1;var n=f.open(e);n.onupgradeneeded=function(e){console.info("IDB request.onupgradeneeded");var t=e.target.result;t.onerror=function(){a("IndexedDB post-upgrade request error: ",t.error)},l(t,i)},n.onsuccess=function(){console.info("open request.onsuccess; create count: "+y+"/"+v),v>0&&0===y||b||(p=n.result,p.onerror=function(){a("IndexedDB database error: ",p.error)},b=!0,i())},n.onerror=function(){b||i(a("IndexedDB open error: ",n.error))}},t["delete"]=function(e,t){console.info("IDB.delete called for "+e+" current: "+(p&&p.name)),p&&p.name===e&&(p.close(),p=null);var i=f.deleteDatabase(e);i.onsuccess=function(){return console.info("IDB successfully deleted "+e),t()},i.onerror=function(){return t(a("Could not delete database: ",i.error))},i.onblocked=function(){return t(a("Delete database operation was blocked"))}},t.request=function(e,t,i){return p?p.objectStoreNames.contains(e)?void c(e,t,i):void i(new Error("IndexedDB request failed: object store: "+e+" not found in disk cache")):void i(new Error("IndexedDB request failed: disk cache not yet initialized"))},t.put=h,t.requestAll=function(e,t){if(!p)return void t(new Error("IndexedDB request failed: disk cache not yet initialized"));var i=m.cacheCompletion;return i&&p.objectStoreNames.contains(i)?void c(i,[e],function(i,n){if(i)return t(i);var o=n[e];return o?p.objectStoreNames.contains(e)?void d(e,t):void t(new Error("IndexedDB request failed: object store: "+e+" not found in disk cache")):t(null,null)}):void t(new Error("IndexedDB isCacheComplete failed: cache completion not initialized"))},t.putAll=function(e,t,i){h(e,t,function(t){if(t)return i(t);var n=m.cacheCompletion;if(!n||!p.objectStoreNames.contains(n))return void i(new Error("IndexedDB putAll operation called but cache completion is not set up"));var o={completedType:{id:e}};h(n,o,function(e){return e?i(e):i()})})}},function(module,exports){/*! IndexedDBShim, based on v0.1.2 - 2014-08-07 BUT modified: see file history and PR comments */
"use strict";var idbModules={},cleanInterface=!1;!function(){var e={test:!0};if(Object.defineProperty)try{Object.defineProperty(e,"test",{enumerable:!1}),e.test&&(cleanInterface=!0)}catch(t){}}(),function(e){function t(e,t,i,n){i.target=t,"function"==typeof t[e]&&t[e].apply(t,[i]),"function"==typeof n&&n()}function i(t,i,n){var o={};throw o.name=t,o.message=i,e.DEBUG&&(console.log(t,i,n,o),console.trace&&console.trace()),o}var n=function(){this.length=0,this._items=[],cleanInterface&&Object.defineProperty(this,"_items",{enumerable:!1})};if(n.prototype={contains:function(e){return-1!==this._items.indexOf(e)},item:function(e){return this._items[e]},indexOf:function(e){return this._items.indexOf(e)},push:function(e){this._items.push(e),this.length+=1;for(var t=0;this._items.length>t;t++)this[t]=this._items[t]},splice:function(){this._items.splice.apply(this._items,arguments),this.length=this._items.length;for(var e in this)e===parseInt(e,10)+""&&delete this[e];for(e=0;this._items.length>e;e++)this[e]=this._items[e]}},cleanInterface)for(var o in{indexOf:!1,push:!1,splice:!1})Object.defineProperty(n.prototype,o,{enumerable:!1});e.util={throwDOMException:i,callback:t,quote:function(e){return"'"+e+"'"},StringList:n}}(idbModules),function(idbModules){var Sca=function(){return{decycle:function(object,callback){function checkForCompletion(){0===queuedObjects.length&&returnCallback(derezObj)}function readBlobAsDataURL(e,t){var i=new FileReader;i.onloadend=function(e){var i=e.target.result,n="blob";updateEncodedBlob(i,t,n)},i.readAsDataURL(e)}function updateEncodedBlob(dataURL,path,blobtype){var encoded=queuedObjects.indexOf(path);path=path.replace("$","derezObj"),eval(path+'.$enc="'+dataURL+'"'),eval(path+'.$type="'+blobtype+'"'),queuedObjects.splice(encoded,1),checkForCompletion()}function derez(e,t){var i,n,o;if(!("object"!=typeof e||null===e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof Blob||e instanceof String)){for(i=0;objects.length>i;i+=1)if(objects[i]===e)return{$ref:paths[i]};if(objects.push(e),paths.push(t),"[object Array]"===Object.prototype.toString.apply(e))for(o=[],i=0;e.length>i;i+=1)o[i]=derez(e[i],t+"["+i+"]");else{o={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=derez(e[n],t+"["+JSON.stringify(n)+"]"))}return o}return e instanceof Blob?(queuedObjects.push(t),readBlobAsDataURL(e,t)):e instanceof Boolean?e={$type:"bool",$enc:""+e}:e instanceof Date?e={$type:"date",$enc:e.getTime()}:e instanceof Number?e={$type:"num",$enc:""+e}:e instanceof RegExp&&(e={$type:"regex",$enc:""+e}),e}var objects=[],paths=[],queuedObjects=[],returnCallback=callback,derezObj=derez(object,"$");checkForCompletion()},retrocycle:function retrocycle($){function dataURLToBlob(e){var t,i,n,o=";base64,";if(-1===e.indexOf(o))return i=e.split(","),t=i[0].split(":")[1],n=i[1],new Blob([n],{type:t});i=e.split(o),t=i[0].split(":")[1],n=window.atob(i[1]);for(var s=n.length,a=new Uint8Array(s),r=0;s>r;++r)a[r]=n.charCodeAt(r);return new Blob([a.buffer],{type:t})}function rez(value){var i,item,name,path;if(value&&"object"==typeof value)if("[object Array]"===Object.prototype.toString.apply(value))for(i=0;value.length>i;i+=1)item=value[i],item&&"object"==typeof item&&(path=item.$ref,value[i]="string"==typeof path&&px.test(path)?eval(path):rez(item));else if(void 0!==value.$type)switch(value.$type){case"blob":case"file":value=dataURLToBlob(value.$enc);break;case"bool":value=Boolean("true"===value.$enc);break;case"date":value=new Date(value.$enc);break;case"num":value=Number(value.$enc);break;case"regex":value=eval(value.$enc)}else for(name in value)"object"==typeof value[name]&&(item=value[name],item&&(path=item.$ref,value[name]="string"==typeof path&&px.test(path)?eval(path):rez(item)));return value}var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return rez($),$},encode:function(e,t){function i(e){t(JSON.stringify(e))}this.decycle(e,i)},decode:function(e){return this.retrocycle(JSON.parse(e))}}}();idbModules.Sca=Sca}(idbModules),function(e){var t=["","number","string","boolean","object","undefined"],i=function(){return{encode:function(e){return t.indexOf(typeof e)+"-"+JSON.stringify(e)},decode:function(e){return void 0===e?void 0:JSON.parse(e.substring(2))}}},n={number:i("number"),"boolean":i(),object:i(),string:{encode:function(e){return t.indexOf("string")+"-"+e},decode:function(e){return""+e.substring(2)}},undefined:{encode:function(){return t.indexOf("undefined")+"-undefined"},decode:function(){}}},o=function(){return{encode:function(e){return n[typeof e].encode(e)},decode:function(e){return n[t[e.substring(0,1)]].decode(e)}}}();e.Key=o}(idbModules),function(e){var t=function(e,t){return{type:e,debug:t,bubbles:!1,cancelable:!1,eventPhase:0,timeStamp:new Date}};e.Event=t}(idbModules),function(e){var t=function(){this.onsuccess=this.onerror=this.result=this.error=this.source=this.transaction=null,this.readyState="pending"},i=function(){this.onblocked=this.onupgradeneeded=null};i.prototype=t,e.IDBRequest=t,e.IDBOpenRequest=i}(idbModules),function(e,t){var i=function(e,t,i,n){this.lower=e,this.upper=t,this.lowerOpen=i,this.upperOpen=n};i.only=function(e){return new i(e,e,(!1),(!1))},i.lowerBound=function(e,n){return new i(e,t,n,t)},i.upperBound=function(e){return new i(t,e,t,open)},i.bound=function(e,t,n,o){return new i(e,t,n,o)},e.IDBKeyRange=i}(idbModules),function(e,t){function i(i,n,o,s,a,r){!i||i instanceof e.IDBKeyRange||(i=new e.IDBKeyRange(i,i,(!1),(!1))),this.__range=i,this.source=this.__idbObjectStore=o,this.__req=s,this.key=t,this.direction=n,this.__keyColumnName=a,this.__valueColumnName=r,this.__valueDecoder="value"===r?e.Sca:e.Key,this.source.transaction.__active||e.util.throwDOMException("TransactionInactiveError - The transaction this IDBObjectStore belongs to is not active."),this.__offset=-1,this.__lastKeyContinued=t,this["continue"]()}i.prototype.__find=function(i,n,o,s,a){a=a||1;var r=this,l=["SELECT * FROM ",e.util.quote(r.__idbObjectStore.name)],c=[];l.push("WHERE ",r.__keyColumnName," NOT NULL"),r.__range&&(r.__range.lower||r.__range.upper)&&(l.push("AND"),r.__range.lower&&(l.push(r.__keyColumnName+(r.__range.lowerOpen?" >":" >= ")+" ?"),c.push(e.Key.encode(r.__range.lower))),r.__range.lower&&r.__range.upper&&l.push("AND"),r.__range.upper&&(l.push(r.__keyColumnName+(r.__range.upperOpen?" < ":" <= ")+" ?"),c.push(e.Key.encode(r.__range.upper)))),i!==t&&(r.__lastKeyContinued=i,r.__offset=0),r.__lastKeyContinued!==t&&(l.push("AND "+r.__keyColumnName+" >= ?"),c.push(e.Key.encode(r.__lastKeyContinued))),l.push("ORDER BY ",r.__keyColumnName),l.push("LIMIT "+a+" OFFSET "+r.__offset),e.DEBUG&&console.log(l.join(" "),c),r.__prefetchedData=null,n.executeSql(l.join(" "),c,function(i,n){n.rows.length>1?(r.__prefetchedData=n.rows,r.__prefetchedIndex=0,e.DEBUG&&console.log("Preloaded "+r.__prefetchedData.length+" records for cursor"),r.__decode(n.rows.item(0),o)):1===n.rows.length?r.__decode(n.rows.item(0),o):(e.DEBUG&&console.log("Reached end of cursors"),o(t,t))},function(t,i){e.DEBUG&&console.log("Could not execute Cursor.continue"),s(i)})},i.prototype.__decode=function(t,i){var n=e.Key.decode(t[this.__keyColumnName]),o=this.__valueDecoder.decode(t[this.__valueColumnName]),s=e.Key.decode(t.key);i(n,o,s)},i.prototype["continue"]=function(i){var n=e.cursorPreloadPackSize||100,o=this;this.__idbObjectStore.transaction.__addToTransactionQueue(function(e,s,a,r){o.__offset++;var l=function(e,i,n){o.key=e,o.value=i,o.primaryKey=n,a(o.key!==t?o:t,o.__req)};return o.__prefetchedData&&(o.__prefetchedIndex++,o.__prefetchedIndex<o.__prefetchedData.length)?(o.__decode(o.__prefetchedData.item(o.__prefetchedIndex),l),t):(o.__find(i,e,l,r,n),t)})},i.prototype.advance=function(i){0>=i&&e.util.throwDOMException("Type Error - Count is invalid - 0 or negative",i);var n=this;this.__idbObjectStore.transaction.__addToTransactionQueue(function(e,o,s,a){n.__offset+=i,n.__find(t,e,function(e,i){n.key=e,n.value=i,s(n.key!==t?n:t,n.__req)},a)})},i.prototype.update=function(i){var n=this,o=this.__idbObjectStore.transaction.__createRequest(function(){});return e.Sca.encode(i,function(i){n.__idbObjectStore.transaction.__pushToQueue(o,function(o,s,a,r){n.__find(t,o,function(t,s,l){var c="UPDATE "+e.util.quote(n.__idbObjectStore.name)+" SET value = ? WHERE key = ?";e.DEBUG&&console.log(c,i,t,l),o.executeSql(c,[i,e.Key.encode(l)],function(e,i){n.__prefetchedData=null,1===i.rowsAffected?a(t):r("No rows with key found"+t)},function(e,t){r(t)})},r)})}),o},i.prototype["delete"]=function(){var i=this;return this.__idbObjectStore.transaction.__addToTransactionQueue(function(n,o,s,a){i.__find(t,n,function(o,r,l){var c="DELETE FROM  "+e.util.quote(i.__idbObjectStore.name)+" WHERE key = ?";e.DEBUG&&console.log(c,o,l),n.executeSql(c,[e.Key.encode(l)],function(e,n){i.__prefetchedData=null,1===n.rowsAffected?(i.__offset--,s(t)):a("No rows with key found"+o)},function(e,t){a(t)})},a)})},e.IDBCursor=i}(idbModules),function(idbModules,undefined){function IDBIndex(e,t){this.indexName=this.name=e,this.__idbObjectStore=this.objectStore=this.source=t;var i=t.__storeProps&&t.__storeProps.indexList;i&&(i=JSON.parse(i)),this.keyPath=i&&i[e]&&i[e].keyPath||e,["multiEntry","unique"].forEach(function(t){this[t]=!!(i&&i[e]&&i[e].optionalParams&&i[e].optionalParams[t])},this)}IDBIndex.prototype.__createIndex=function(indexName,keyPath,optionalParameters){var me=this,transaction=me.__idbObjectStore.transaction;transaction.__addToTransactionQueue(function(tx,args,success,failure){me.__idbObjectStore.__getStoreProps(tx,function(){function error(){idbModules.util.throwDOMException(0,"Could not create new index",arguments)}2!==transaction.mode&&idbModules.util.throwDOMException(0,"Invalid State error, not a version transaction",me.transaction);var idxList=JSON.parse(me.__idbObjectStore.__storeProps.indexList);idxList[indexName]!==undefined&&idbModules.util.throwDOMException(0,"Index already exists on store",idxList);var columnName=indexName;idxList[indexName]={columnName:columnName,keyPath:keyPath,optionalParams:optionalParameters},me.__idbObjectStore.__storeProps.indexList=JSON.stringify(idxList);var sql=["ALTER TABLE",idbModules.util.quote(me.__idbObjectStore.name),"ADD",columnName,"BLOB"].join(" ");idbModules.DEBUG&&console.log(sql),tx.executeSql(sql,[],function(tx,data){tx.executeSql("SELECT * FROM "+idbModules.util.quote(me.__idbObjectStore.name),[],function(tx,data){!function initIndexForRow(i){if(data.rows.length>i)try{var value=idbModules.Sca.decode(data.rows.item(i).value),indexKey=eval("value['"+keyPath+"']");tx.executeSql("UPDATE "+idbModules.util.quote(me.__idbObjectStore.name)+" set "+columnName+" = ? where key = ?",[idbModules.Key.encode(indexKey),data.rows.item(i).key],function(){initIndexForRow(i+1)},error)}catch(e){initIndexForRow(i+1)}else idbModules.DEBUG&&console.log("Updating the indexes in table",me.__idbObjectStore.__storeProps),tx.executeSql("UPDATE __sys__ set indexList = ? where name = ?",[me.__idbObjectStore.__storeProps.indexList,me.__idbObjectStore.name],function(){me.__idbObjectStore.__setReadyState("createIndex",!0),success(me)},error)}(0)},error)},error)},"createObjectStore")})},IDBIndex.prototype.openCursor=function(e,t){var i=new idbModules.IDBRequest;return new idbModules.IDBCursor(e,t,this.source,i,this.indexName,"value"),i},IDBIndex.prototype.openKeyCursor=function(e,t){var i=new idbModules.IDBRequest;return new idbModules.IDBCursor(e,t,this.source,i,this.indexName,"key"),i},IDBIndex.prototype.__fetchIndexData=function(e,t){var i=this;return i.__idbObjectStore.transaction.__addToTransactionQueue(function(n,o,s,a){var r=["SELECT * FROM ",idbModules.util.quote(i.__idbObjectStore.name)," WHERE",i.indexName,"NOT NULL"],l=[];e!==undefined&&(r.push("AND",i.indexName," = ?"),l.push(idbModules.Key.encode(e))),idbModules.DEBUG&&console.log("Trying to fetch data for Index",r.join(" "),l),n.executeSql(r.join(" "),l,function(e,i){var n;n="count"===t?i.rows.length:0===i.rows.length?undefined:"key"===t?idbModules.Key.decode(i.rows.item(0).key):idbModules.Sca.decode(i.rows.item(0).value),s(n)},a)})},IDBIndex.prototype.get=function(e){return this.__fetchIndexData(e,"value")},IDBIndex.prototype.getKey=function(e){return this.__fetchIndexData(e,"key")},IDBIndex.prototype.count=function(e){return this.__fetchIndexData(e,"count")},idbModules.IDBIndex=IDBIndex}(idbModules),function(idbModules){var IDBObjectStore=function(e,t,i){this.name=e,this.transaction=t,this.__ready={},this.__setReadyState("createObjectStore",void 0===i||i),this.indexNames=new idbModules.util.StringList};IDBObjectStore.prototype.__setReadyState=function(e,t){this.__ready[e]=t},IDBObjectStore.prototype.__waitForReady=function(e,t){var i=!0;if(void 0!==t)i=void 0===this.__ready[t]||this.__ready[t];else for(var n in this.__ready)this.__ready[n]||(i=!1);if(i)e();else{idbModules.DEBUG&&console.log("Waiting for to be ready",t);var o=this;window.setTimeout(function(){o.__waitForReady(e,t)},100)}},IDBObjectStore.prototype.__getStoreProps=function(e,t,i){var n=this;this.__waitForReady(function(){n.__storeProps?(idbModules.DEBUG&&console.log("Store properties - cached",n.__storeProps),t(n.__storeProps)):e.executeSql("SELECT * FROM __sys__ where name = ?",[n.name],function(e,i){1!==i.rows.length?t():(n.__storeProps={name:i.rows.item(0).name,indexList:i.rows.item(0).indexList,autoInc:i.rows.item(0).autoInc,keyPath:i.rows.item(0).keyPath},idbModules.DEBUG&&console.log("Store properties",n.__storeProps),t(n.__storeProps))},function(){t()})},i)},IDBObjectStore.prototype.__deriveKey=function(tx,value,key,callback){function getNextAutoIncKey(){tx.executeSql("SELECT * FROM sqlite_sequence where name like ?",[me.name],function(e,t){callback(1!==t.rows.length?0:t.rows.item(0).seq)},function(e,t){idbModules.util.throwDOMException(0,"Data Error - Could not get the auto increment value for key",t)})}var me=this;me.__getStoreProps(tx,function(props){if(props||idbModules.util.throwDOMException(0,"Data Error - Could not locate defination for this table",props),props.keyPath)if(void 0!==key&&idbModules.util.throwDOMException(0,"Data Error - The object store uses in-line keys and the key parameter was provided",props),value)try{var primaryKey=eval("value['"+props.keyPath+"']");void 0===primaryKey?"true"===props.autoInc?getNextAutoIncKey():idbModules.util.throwDOMException(0,"Data Error - Could not eval key from keyPath"):callback(primaryKey)}catch(e){idbModules.util.throwDOMException(0,"Data Error - Could not eval key from keyPath",e)}else idbModules.util.throwDOMException(0,"Data Error - KeyPath was specified, but value was not");else void 0!==key?callback(key):"false"===props.autoInc?idbModules.util.throwDOMException(0,"Data Error - The object store uses out-of-line keys and has no key generator and the key parameter was not provided. ",props):getNextAutoIncKey()})},IDBObjectStore.prototype.__insertData=function(tx,encoded,value,primaryKey,success,error){var paramMap={};void 0!==primaryKey&&(paramMap.key=idbModules.Key.encode(primaryKey));var indexes=JSON.parse(this.__storeProps.indexList);for(var key in indexes)try{paramMap[indexes[key].columnName]=idbModules.Key.encode(eval("value['"+indexes[key].keyPath+"']"))}catch(e){error(e)}var sqlStart=["INSERT INTO ",idbModules.util.quote(this.name),"("],sqlEnd=[" VALUES ("],sqlValues=[];for(key in paramMap)sqlStart.push(key+","),sqlEnd.push("?,"),sqlValues.push(paramMap[key]);sqlStart.push("value )"),sqlEnd.push("?)"),sqlValues.push(encoded);var sql=sqlStart.join(" ")+sqlEnd.join(" ");idbModules.DEBUG&&console.log("SQL for adding",sql,sqlValues),tx.executeSql(sql,sqlValues,function(){success(primaryKey)},function(e,t){error(t)})},IDBObjectStore.prototype.add=function(e,t){var i=this,n=i.transaction.__createRequest(function(){});return idbModules.Sca.encode(e,function(o){i.transaction.__pushToQueue(n,function(n,s,a,r){i.__deriveKey(n,e,t,function(t){i.__insertData(n,o,e,t,a,r)})})}),n},IDBObjectStore.prototype.put=function(e,t){var i=this,n=i.transaction.__createRequest(function(){});return idbModules.Sca.encode(e,function(o){i.transaction.__pushToQueue(n,function(n,s,a,r){i.__deriveKey(n,e,t,function(t){var s="DELETE FROM "+idbModules.util.quote(i.name)+" where key = ?";n.executeSql(s,[idbModules.Key.encode(t)],function(n,s){idbModules.DEBUG&&console.log("Did the row with the",t,"exist? ",s.rowsAffected),i.__insertData(n,o,e,t,a,r)},function(e,t){r(t)})})})}),n},IDBObjectStore.prototype.get=function(e){var t=this;return t.transaction.__addToTransactionQueue(function(i,n,o,s){t.__waitForReady(function(){var n=idbModules.Key.encode(e);idbModules.DEBUG&&console.log("Fetching",t.name,n),i.executeSql("SELECT * FROM "+idbModules.util.quote(t.name)+" where key = ?",[n],function(e,t){idbModules.DEBUG&&console.log("Fetched data",t);try{if(0===t.rows.length)return o();o(idbModules.Sca.decode(t.rows.item(0).value))}catch(i){idbModules.DEBUG&&console.log(i),o(void 0)}},function(e,t){s(t)})})})},IDBObjectStore.prototype["delete"]=function(e){var t=this;return t.transaction.__addToTransactionQueue(function(i,n,o,s){t.__waitForReady(function(){var n=idbModules.Key.encode(e);idbModules.DEBUG&&console.log("Fetching",t.name,n),i.executeSql("DELETE FROM "+idbModules.util.quote(t.name)+" where key = ?",[n],function(e,t){idbModules.DEBUG&&console.log("Deleted from database",t.rowsAffected),o()},function(e,t){s(t)})})})},IDBObjectStore.prototype.clear=function(){var e=this;return e.transaction.__addToTransactionQueue(function(t,i,n,o){e.__waitForReady(function(){t.executeSql("DELETE FROM "+idbModules.util.quote(e.name),[],function(e,t){idbModules.DEBUG&&console.log("Cleared all records from database",t.rowsAffected),n()},function(e,t){o(t)})})})},IDBObjectStore.prototype.count=function(e){var t=this;return t.transaction.__addToTransactionQueue(function(i,n,o,s){t.__waitForReady(function(){var n="SELECT * FROM "+idbModules.util.quote(t.name)+(void 0!==e?" WHERE key = ?":""),a=[];void 0!==e&&a.push(idbModules.Key.encode(e)),i.executeSql(n,a,function(e,t){o(t.rows.length)},function(e,t){s(t)})})})},IDBObjectStore.prototype.openCursor=function(e,t){var i=new idbModules.IDBRequest;return new idbModules.IDBCursor(e,t,this,i,"key","value"),i},IDBObjectStore.prototype.index=function(e){var t=new idbModules.IDBIndex(e,this);return t},IDBObjectStore.prototype.createIndex=function(e,t,i){var n=this;i=i||{},n.__setReadyState("createIndex",!1);var o=new idbModules.IDBIndex(e,n);return n.__waitForReady(function(){o.__createIndex(e,t,i)},"createObjectStore"),n.indexNames.push(e),o},IDBObjectStore.prototype.deleteIndex=function(e){var t=new idbModules.IDBIndex(e,this,(!1));return t.__deleteIndex(e),t},idbModules.IDBObjectStore=IDBObjectStore}(idbModules),function(e){var t=0,i=1,n=2,o=function(n,o,s){if("number"==typeof o)this.mode=o,2!==o&&e.DEBUG&&console.log("Mode should be a string, but was specified as ",o);else if("string"==typeof o)switch(o){case"readwrite":this.mode=i;break;case"readonly":this.mode=t;break;default:this.mode=t}this.storeNames="string"==typeof n?[n]:n;for(var a=0;this.storeNames.length>a;a++)s.objectStoreNames.contains(this.storeNames[a])||e.util.throwDOMException(0,"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened.",this.storeNames[a]);this.__active=!0,this.__running=!1,this.__requests=[],this.__aborted=!1,this.db=s,this.error=null,this.onabort=this.onerror=this.oncomplete=null};o.prototype.__executeRequests=function(){if(this.__running&&this.mode!==n)return void(e.DEBUG&&console.log("Looks like the request set is already running",this.mode));this.__running=!0;var t=this;window.setTimeout(function(){2===t.mode||t.__active||e.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished",t.__active),t.db.__db.transaction(function(i){function n(t,i){i&&(a.req=i),a.req.readyState="done",a.req.result=t,delete a.req.error;var n=e.Event("success");e.util.callback("onsuccess",a.req,n),r++,s()}function o(){a.req.readyState="done",a.req.error="DOMError";var t=e.Event("error",arguments);e.util.callback("onerror",a.req,t),r++,s()}function s(){return r>=t.__requests.length?(t.__active=!1,void(t.__requests=[])):(a=t.__requests[r],void a.op(i,a.args,n,o))}t.__tx=i;var a=null,r=0;try{s()}catch(l){e.DEBUG&&console.log("An exception occured in transaction",arguments),"function"==typeof t.onerror&&t.onerror()}},function(){e.DEBUG&&console.log("An error in transaction",arguments),"function"==typeof t.onerror&&t.onerror()},function(){e.DEBUG&&console.log("Transaction completed",arguments),"function"==typeof t.oncomplete&&t.oncomplete()})},1)},o.prototype.__addToTransactionQueue=function(t,i){this.__active||this.mode===n||e.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished.",this.__mode);var o=this.__createRequest();return this.__pushToQueue(o,t,i),o},o.prototype.__createRequest=function(){var t=new e.IDBRequest;return t.source=this.db,t.transaction=this,t},o.prototype.__pushToQueue=function(e,t,i){this.__requests.push({op:t,args:i,req:e}),this.__executeRequests()},o.prototype.objectStore=function(t){return new e.IDBObjectStore(t,this)},o.prototype.abort=function(){!this.__active&&e.util.throwDOMException(0,"A request was placed against a transaction which is currently not active, or which is finished",this.__active)},o.prototype.READ_ONLY=0,o.prototype.READ_WRITE=1,o.prototype.VERSION_CHANGE=2,e.IDBTransaction=o}(idbModules),function(e){var t=function(t,i,n,o){this.__db=t,this.version=n,this.__storeProperties=o,this.objectStoreNames=new e.util.StringList;for(var s=0;o.rows.length>s;s++)this.objectStoreNames.push(o.rows.item(s).name);this.name=i,this.onabort=this.onerror=this.onversionchange=null};t.prototype.createObjectStore=function(t,i){var n=this;i=i||{},i.keyPath=i.keyPath||null;var o=new e.IDBObjectStore(t,n.__versionTransaction,(!1)),s=n.__versionTransaction;return s.__addToTransactionQueue(function(s,a,r){function l(){e.util.throwDOMException(0,"Could not create new object store",arguments)}n.__versionTransaction||e.util.throwDOMException(0,"Invalid State error",n.transaction);var c=["CREATE TABLE",e.util.quote(t),"(key BLOB",i.autoIncrement?", inc INTEGER PRIMARY KEY AUTOINCREMENT":"PRIMARY KEY",", value BLOB)"].join(" ");e.DEBUG&&console.log(c),s.executeSql(c,[],function(e){e.executeSql("INSERT INTO __sys__ VALUES (?,?,?,?)",[t,i.keyPath,!!i.autoIncrement,"{}"],function(){o.__setReadyState("createObjectStore",!0),r(o)},l)},l)}),n.objectStoreNames.push(t),o},t.prototype.deleteObjectStore=function(t){var i=function(){e.util.throwDOMException(0,"Could not delete ObjectStore",arguments)},n=this;!n.objectStoreNames.contains(t)&&i("Object Store does not exist"),n.objectStoreNames.splice(n.objectStoreNames.indexOf(t),1);var o=n.__versionTransaction;o.__addToTransactionQueue(function(){n.__versionTransaction||e.util.throwDOMException(0,"Invalid State error",n.transaction),n.__db.transaction(function(n){n.executeSql("SELECT * FROM __sys__ where name = ?",[t],function(n,o){o.rows.length>0&&n.executeSql("DROP TABLE "+e.util.quote(t),[],function(){n.executeSql("DELETE FROM __sys__ WHERE name = ?",[t],function(){},i)},i)})})})},t.prototype.close=function(){},t.prototype.transaction=function(t,i){var n=new e.IDBTransaction(t,i||1,this);return n},e.IDBDatabase=t}(idbModules),function(e){var t=4194304;if(window.openDatabase){var i=window.openDatabase("__sysdb__",1,"System Database",t);i.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS dbVersions (name VARCHAR(255), version INT);",[])},function(){e.DEBUG&&console.log("Error in sysdb transaction - when creating dbVersions",arguments)});var n={open:function(n,o){function s(){if(!l){var t=e.Event("error",arguments);r.readyState="done",r.error="DOMError",e.util.callback("onerror",r,t),l=!0}}function a(a){var l=window.openDatabase(n,1,n,t);r.readyState="done",void 0===o&&(o=a||1),(0>=o||a>o)&&e.util.throwDOMException(0,"An attempt was made to open a database using a lower version than the existing version.",o),l.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS __sys__ (name VARCHAR(255), keyPath VARCHAR(255), autoInc BOOLEAN, indexList BLOB)",[],function(){t.executeSql("SELECT * FROM __sys__",[],function(t,c){var u=e.Event("success");r.source=r.result=new e.IDBDatabase(l,n,o,c),o>a?i.transaction(function(t){t.executeSql("UPDATE dbVersions set version = ? where name = ?",[o,n],function(){var t=e.Event("upgradeneeded");t.oldVersion=a,t.newVersion=o,r.transaction=r.result.__versionTransaction=new e.IDBTransaction([],2,r.source),e.util.callback("onupgradeneeded",r,t,function(){var t=e.Event("success");e.util.callback("onsuccess",r,t)})},s)},s):e.util.callback("onsuccess",r,u)},s)},s)},s)}var r=new e.IDBOpenRequest,l=!1;return i.transaction(function(e){e.executeSql("SELECT * FROM dbVersions where name = ?",[n],function(e,t){0===t.rows.length?e.executeSql("INSERT INTO dbVersions VALUES (?,?)",[n,o||1],function(){a(0)},s):a(t.rows.item(0).version)},s)},s),r},deleteDatabase:function(n){function o(t){if(!r){a.readyState="done",a.error="DOMError";var i=e.Event("error");i.message=t,i.debug=arguments,e.util.callback("onerror",a,i),r=!0}}function s(){i.transaction(function(t){t.executeSql("DELETE FROM dbVersions where name = ? ",[n],function(){a.result=void 0;var t=e.Event("success");t.newVersion=null,t.oldVersion=l,e.util.callback("onsuccess",a,t)},o)},o)}var a=new e.IDBOpenRequest,r=!1,l=null;return i.transaction(function(i){i.executeSql("SELECT * FROM dbVersions where name = ?",[n],function(i,r){if(0===r.rows.length){a.result=void 0;var c=e.Event("success");return c.newVersion=null,c.oldVersion=l,void e.util.callback("onsuccess",a,c)}l=r.rows.item(0).version;var u=window.openDatabase(n,1,n,t);u.transaction(function(t){t.executeSql("SELECT * FROM __sys__",[],function(t,i){var n=i.rows;!function a(i){i>=n.length?t.executeSql("DROP TABLE __sys__",[],function(){s()},o):t.executeSql("DROP TABLE "+e.util.quote(n.item(i).name),[],function(){a(i+1)},function(){a(i+1)})}(0)},function(){s()})},o)})},o),a},cmp:function(t,i){return e.Key.encode(t)>e.Key.encode(i)?1:t===i?0:-1}};e.shimIndexedDB=n}}(idbModules),function(e,t){void 0!==e.openDatabase&&(e.shimIndexedDB=t.shimIndexedDB,e.shimIndexedDB&&(e.shimIndexedDB.__useShim=function(){e.indexedDB=t.shimIndexedDB,e.IDBDatabase=t.IDBDatabase,e.IDBTransaction=t.IDBTransaction,e.IDBCursor=t.IDBCursor,e.IDBKeyRange=t.IDBKeyRange,e.indexedDB!==t.shimIndexedDB&&Object.defineProperty&&Object.defineProperty(e,"indexedDB",{value:t.shimIndexedDB})},e.shimIndexedDB.__debug=function(e){t.DEBUG=e})),"indexedDB"in e||(e.indexedDB=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.oIndexedDB||e.msIndexedDB);var i=!1;if((navigator.userAgent.match(/Android 2/)||navigator.userAgent.match(/Android 3/)||navigator.userAgent.match(/Android 4\.[0-3]/))&&(navigator.userAgent.match(/Chrome/)||(i=!0)),void 0!==e.indexedDB&&!i||void 0===e.openDatabase){e.IDBDatabase=e.IDBDatabase||e.webkitIDBDatabase,e.IDBTransaction=e.IDBTransaction||e.webkitIDBTransaction,e.IDBCursor=e.IDBCursor||e.webkitIDBCursor,e.IDBKeyRange=e.IDBKeyRange||e.webkitIDBKeyRange,e.IDBTransaction||(e.IDBTransaction={});try{e.IDBTransaction.READ_ONLY=e.IDBTransaction.READ_ONLY||"readonly",e.IDBTransaction.READ_WRITE=e.IDBTransaction.READ_WRITE||"readwrite"}catch(n){}}else e.shimIndexedDB.__useShim()}(window,idbModules)},function(e,t,i){var n=i(39),o=i(24);e.exports=function(e,t,i,s,a){if(!e)return a(new Error("staticContent is not initialized. Cannot perform request: "+t));var r=o.operation({retries:4,randomize:!0});i=i||{};var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4===~~l.readyState){var e;if(200!==~~l.status&&(e="staticContent xhrError: "+l.status),r.retry(e))return console.warn("staticContent.request failed code ",l.status+", will retry...");if(e)return a(r.mainError());var t;try{t=JSON.parse(l.response)}catch(i){return a(i)}a(null,t)}};var c={lang:i.lang||s,v:window.buildVersion},u=e+t+"?"+n.stringify(c);r.attempt(function(){l.open("POST",u,!0),l.setRequestHeader("Content-type","application/json"),l.send(JSON.stringify(i))})}},function(e,t,i){"use strict";t.decode=t.parse=i(40),t.encode=t.stringify=i(41)},function(e,t){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var r=1e3;o&&"number"==typeof o.maxKeys&&(r=o.maxKeys);var l=e.length;r>0&&l>r&&(l=r);for(var c=0;c<l;++c){var u,d,h,p,m=e[c].replace(a,"%20"),f=m.indexOf(n);f>=0?(u=m.substr(0,f),d=m.substr(f+1)):(u=m,d=""),h=decodeURIComponent(u),p=decodeURIComponent(d),i(s,h)?Array.isArray(s[h])?s[h].push(p):s[h]=[s[h],p]:s[h]=p}return s}},function(e,t){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,o){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(o){var s=encodeURIComponent(i(o))+n;return Array.isArray(e[o])?e[o].map(function(e){return s+encodeURIComponent(i(e))}).join(t):s+encodeURIComponent(i(e[o]))}).join(t):o?encodeURIComponent(i(o))+n+encodeURIComponent(i(e)):""}},function(e,t,i){function n(e){var t=e;return t>0&&(t*=-1),t=window.parseInt(t,10),isNaN(t)?(console.error(new Error("value cannot be formatted, value is not a number: "+e)),0):t}function o(e){return~~e}function s(e,t){var i=e&&e.consumeResult;if(i instanceof Array&&i.length>0)for(var n=i.length,o=0;o<n;o++)c.log(v,{articleId:i[o].id,caption:i[o].name,articlesCount:n,isRestore:t},h);else{console.error("wKpi mysteryBox"+(t?" (restore)":"")+": unparsable msg content");var s={articleId:-1,caption:"unknown",articlesCount:0,isRestore:t};c.log(v,s,h)}}var a,r=i(43),l=i(44),c=i(9),u=i(28),d=i(45),h={wizAnalyticsOnly:!0},p="hdv",m="0",f="shop",g="0";t.bidHouseBuyPrepare=function(e){var t=e.itemInstance;if(!t)return console.error("wKpi.bidHouseBuyPrepare: invalid itemInstance");var i=t.item;return i&&i.type?void(a={currency:e.isHardCurrency?"hard":"soft",spent:e.spent,itemId:t.objectGID,itemCaption:t.shortName,type:r.ITEM_TYPE_NAME[i.type.id]||"not referenced",superType:r.ITEM_SUPERTYPE_NAME[i.getSuperTypeId()]||"not referenced",quantity:e.quantity}):console.error("wKpi.bidHouseBuyPrepare: invalid itemInstance.item")},t.bidHouseBuySuccess=function(){if(a){c.log("Currency.BidHouse_Buy_Success",a,h);var e=n(a.spent),t={context:p,context_id:m,item_id:a.itemId,quantity:a.quantity,relative_hard_currency_gained:"hard"===a.currency?e:0,relative_soft_currency_gained:"soft"===a.currency?e:0};c.log("Virtual_Economy.Receive_Item",t),a=null}};var _;t.shopBuyPrepare=function(e){if(!e)return console.error("wKpi.shopBuyPrepare: no params provided");var t=e.currency,i=e.article,n=t===l.KAMA,s=i.itemsId instanceof Array?i.itemsId.map(o).sort():null;_={currency:n?"soft":"hard",spent:n?i._softPrice:i._hardPrice,articleId:i.id,articleCaption:i.name,itemsId:s}},t.shopBuySuccess=function(){if(_){c.log("Currency.Shop_Buy_Success",_,h);var e=n(_.spent),t={context:f,context_id:g,item_id:_.articleId,quantity:1,relative_hard_currency_gained:"hard"===_.currency?e:0,relative_soft_currency_gained:"soft"===_.currency?e:0};c.log("Virtual_Economy.Receive_Item",t),_=null}};var v="Mystery_Box_Success";t.mysteryBoxSuccess=function(e){s(e,!1)},t.restoreMysteryBoxSuccess=function(e){s(e,!0)};var y,b="Hard_Currency_Amount";t.hardCurrencyAmount=function(e){var t=d(u.now());y&&y.isSame(t,"day")||(c.log(b,{amount:e},h),y=t)},t.sendPlatform=function(e){c.log("Platform.Type",{platform:e},h)},t.logger=function(e,t){var i,n,o=window.Config&&window.Config.dataUrl||"";try{n=JSON.stringify(t),i=JSON.stringify({channelName:"error",
message:'Analytics Info: {"name":"'+e+'","data":'+n+"}"})}catch(s){console.error("wKpi logger cannot stringify: "+s),i=null}if(i){var a={};a.Accept="application/json",a["Content-Type"]="application/json",window.fetch(o+"/logger",{method:"post",headers:a,body:i})}}},function(e,t){t.ITEM_SUPERTYPE_NAME={0:"empty",1:"amulet",2:"weapon",3:"ring",4:"belt",5:"boot",6:"usable",7:"shield",8:"capture item",9:"resource",10:"hat",11:"cape",12:"pet/dofus"},t.ITEM_TYPE_NAME={1:"Amulet",2:"Bow",3:"Wand",4:"Staff",5:"Dagger",6:"Sword",7:"Hammer",8:"Shovel",9:"Ring",10:"Belt",11:"Boots",12:"Potion",13:"Experience scroll",14:"Order ability item",15:"Miscellaneous",16:"Hat",17:"Cloak",18:"Pet",19:"Axe",20:"Tool",21:"Pickaxe",22:"Scythe",23:"Dofus",24:"Miscellaneous",25:"Document",26:"Smithmagic potion",27:"Mutation item",28:"Boost food",29:"Blessing",30:"Curse",31:"Roleplay buff",32:"Following character",33:"Bread",34:"Cereal",35:"Flower",36:"Plant",37:"Beer",38:"Wood",39:"Ore",40:"Alloy",41:"Fish",42:"Treat",43:"Spell deleveling potion",44:"Profession deleveling potion",45:"Weapon skill deleveling potion",46:"Fruit",47:"Bone",48:"Powder",49:"Edible fish",50:"Precious stone",51:"Stone",52:"Flour",53:"Feather",54:"Hair",55:"Fabric",56:"Leather",57:"Wool",58:"Seed",59:"Skin",60:"Oil",61:"Stuffed toy",62:"Gutted fish",63:"Meat",64:"Preserved meat",65:"Tail",66:"Metaria",68:"Vegetable",69:"Edible meat",70:"Dye",71:"Alchemy equipment",72:"Pet egg",73:"Skill",74:"Fairywork",75:"Spell-learning scroll",76:"Characteristic scroll",77:"Pet certificate",78:"Smithmagic rune",79:"Drink",80:"Mission item",81:"Backpack",82:"Shield",83:"Soul stone",84:"Key",85:"Full soul stone",86:"Perceptor deleveling potion",87:"Seeker scroll",88:"Magic stone",89:"Gift",90:"Pet ghost",91:"Dragoturkey",92:"Gobball",93:"Breeding item",94:"Various",95:"Plank",96:"Bark",97:"Mount certificate",98:"Root",99:"Capturing net",100:"Bag of resources",102:"Crossbow",103:"Leg",104:"Wing",105:"Egg",106:"Ear",107:"Carapace",108:"Bud",109:"Eye",110:"Jelly",111:"Shell",112:"Prism",113:"Living object",114:"Magic weapon",115:"Fragment of Shushu soul",116:"Pet potion",118:"Equipment",119:"Mushroom",121:"Petsmount",122:"Petsmount potion",123:"Petsmount certificate",124:"Petsmount ghost",125:"Souvenir",126:"Main quests",127:"Temple quests",128:"Wanted notice",129:"Alignment",130:"City order",131:"Event",132:"Archipelago of Vulkania",133:"Astrub",134:"City quests",136:"Bwork Camp",137:"Cania",138:"Amakna Castle",139:"Frigost Island",140:"Otomai Island",141:"Kwismas Island",142:"Incarnam",143:"Koalak Mountain",144:"Pandala",145:"Madrestam Harbour",146:"Province of Amakna",147:"Krosmoz",148:"Token",149:"Moon Island",150:"Wabbit Islands",151:"Trophy",152:"Pebble",153:"Kwismas",154:"Wrapping paper",155:"Sufokia",156:"Almanax",157:"Figurine",158:"Caramel Rabmajoke",159:"Strawberry Rabmajoke",160:"Lemon Rabmajoke",161:"Orange Rabmajoke",162:"Kola Rabmajoke",163:"Nougat Rabmajoke",164:"Garment",165:"Conquest potion",166:"Mimisymbic"}},function(e,t){e.exports={GOULTINE:"GOU",KAMA:"KMS",INAPP:"FAK"}},function(e,t,i){var n=e.exports=i(46);n.tz.load(i(181))},function(e,t,i){var n,o,s;//! moment-timezone.js
//! version : 0.5.26
//! Copyright (c) JS Foundation and other contributors
//! license : MIT
//! github.com/moment/moment-timezone
!function(a,r){"use strict";"object"==typeof e&&e.exports?e.exports=r(i(47)):(o=[i(47)],n=r,s="function"==typeof n?n.apply(t,o):n,!(void 0!==s&&(e.exports=s)))}(this,function(e){"use strict";function t(e){return e>96?e-87:e>64?e-29:e-48}function i(e){var i,n=0,o=e.split("."),s=o[0],a=o[1]||"",r=1,l=0,c=1;for(45===e.charCodeAt(0)&&(n=1,c=-1),n;n<s.length;n++)i=t(s.charCodeAt(n)),l=60*l+i;for(n=0;n<a.length;n++)r/=60,i=t(a.charCodeAt(n)),l+=i*r;return l*c}function n(e){for(var t=0;t<e.length;t++)e[t]=i(e[t])}function o(e,t){for(var i=0;i<t;i++)e[i]=Math.round((e[i-1]||0)+6e4*e[i]);e[t-1]=1/0}function s(e,t){var i,n=[];for(i=0;i<t.length;i++)n[i]=e[t[i]];return n}function a(e){var t=e.split("|"),i=t[2].split(" "),a=t[3].split(""),r=t[4].split(" ");return n(i),n(a),n(r),o(r,a.length),{name:t[0],abbrs:s(t[1].split(" "),a),offsets:s(i,a),untils:r,population:0|t[5]}}function r(e){e&&this._set(a(e))}function l(e){var t=e.toTimeString(),i=t.match(/\([a-z ]+\)/i);i&&i[0]?(i=i[0].match(/[A-Z]/g),i=i?i.join(""):void 0):(i=t.match(/[A-Z]{3,5}/g),i=i?i[0]:void 0),"GMT"===i&&(i=void 0),this.at=+e,this.abbr=i,this.offset=e.getTimezoneOffset()}function c(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function u(e,t){for(var i,n;n=6e4*((t.at-e.at)/12e4|0);)i=new l(new Date(e.at+n)),i.offset===e.offset?e=i:t=i;return e}function d(){var e,t,i,n=(new Date).getFullYear()-2,o=new l(new Date(n,0,1)),s=[o];for(i=1;i<48;i++)t=new l(new Date(n,i,1)),t.offset!==o.offset&&(e=u(o,t),s.push(e),s.push(new l(new Date(e.at+6e4)))),o=t;for(i=0;i<4;i++)s.push(new l(new Date(n+i,0,1))),s.push(new l(new Date(n+i,6,1)));return s}function h(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:e.zone.population!==t.zone.population?t.zone.population-e.zone.population:t.zone.name.localeCompare(e.zone.name)}function p(e,t){var i,o;for(n(t),i=0;i<t.length;i++)o=t[i],P[o]=P[o]||{},P[o][e]=!0}function m(e){var t,i,n,o=e.length,s={},a=[];for(t=0;t<o;t++){n=P[e[t].offset]||{};for(i in n)n.hasOwnProperty(i)&&(s[i]=!0)}for(t in s)s.hasOwnProperty(t)&&a.push(R[t]);return a}function f(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e&&e.length>3){var t=R[_(e)];if(t)return t;I("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(i){}var n,o,s,a=d(),r=a.length,l=m(a),u=[];for(o=0;o<l.length;o++){for(n=new c(y(l[o]),r),s=0;s<r;s++)n.scoreOffsetAt(a[s]);u.push(n)}return u.sort(h),u.length>0?u[0].zone.name:void 0}function g(e){return L&&!e||(L=f()),L}function _(e){return(e||"").toLowerCase().replace(/\//g,"_")}function v(e){var t,i,n,o;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)n=e[t].split("|"),i=n[0],o=_(i),O[o]=e[t],R[o]=i,p(o,n[2].split(" "))}function y(e,t){e=_(e);var i,n=O[e];return n instanceof r?n:"string"==typeof n?(n=new r(n),O[e]=n,n):D[e]&&t!==y&&(i=y(D[e],y))?(n=O[e]=new r,n._set(i),n.name=R[e],n):null}function b(){var e,t=[];for(e in R)R.hasOwnProperty(e)&&(O[e]||O[D[e]])&&R[e]&&t.push(R[e]);return t.sort()}function w(e){var t,i,n,o;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)i=e[t].split("|"),n=_(i[0]),o=_(i[1]),D[n]=o,R[n]=i[0],D[o]=n,R[o]=i[1]}function M(e){v(e.zones),w(e.links),A.dataVersion=e.version}function T(e){return T.didShowError||(T.didShowError=!0,I("moment.tz.zoneExists('"+e+"') has been deprecated in favor of !moment.tz.zone('"+e+"')")),!!y(e)}function C(e){var t="X"===e._f||"x"===e._f;return!(!e._a||void 0!==e._tzm||t)}function I(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function A(t){var i=Array.prototype.slice.call(arguments,0,-1),n=arguments[arguments.length-1],o=y(n),s=e.utc.apply(null,i);return o&&!e.isMoment(t)&&C(s)&&s.add(o.parse(s),"minutes"),s.tz(n),s}function S(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}function E(e){return function(){return this._z=null,e.apply(this,arguments)}}function x(e){return function(){return arguments.length>0&&(this._z=null),e.apply(this,arguments)}}var L,N="0.5.26",O={},D={},R={},P={};e&&"string"==typeof e.version||I("Moment Timezone requires Moment.js. See https://momentjs.com/timezone/docs/#/use-it/browser/");var B=e.version.split("."),k=+B[0],F=+B[1];(k<2||2===k&&F<6)&&I("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+e.version+". See momentjs.com"),r.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){var t,i=+e,n=this.untils;for(t=0;t<n.length;t++)if(i<n[t])return t},parse:function(e){var t,i,n,o,s=+e,a=this.offsets,r=this.untils,l=r.length-1;for(o=0;o<l;o++)if(t=a[o],i=a[o+1],n=a[o?o-1:o],t<i&&A.moveAmbiguousForward?t=i:t>n&&A.moveInvalidForward&&(t=n),s<r[o]-6e4*t)return a[o];return a[l]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return I("zone.offset has been deprecated in favor of zone.utcOffset"),this.offsets[this._index(e)]},utcOffset:function(e){return this.offsets[this._index(e)]}},c.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.utcOffset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},A.version=N,A.dataVersion="",A._zones=O,A._links=D,A._names=R,A.add=v,A.link=w,A.load=M,A.zone=y,A.zoneExists=T,A.guess=g,A.names=b,A.Zone=r,A.unpack=a,A.unpackBase60=i,A.needsOffset=C,A.moveInvalidForward=!0,A.moveAmbiguousForward=!1;var z=e.fn;e.tz=A,e.defaultZone=null,e.updateOffset=function(t,i){var n,o=e.defaultZone;if(void 0===t._z&&(o&&C(t)&&!t._isUTC&&(t._d=e.utc(t._a)._d,t.utc().add(o.parse(t),"minutes")),t._z=o),t._z)if(n=t._z.utcOffset(t),Math.abs(n)<16&&(n/=60),void 0!==t.utcOffset){var s=t._z;t.utcOffset(-n,i),t._z=s}else t.zone(n,i)},z.tz=function(t,i){if(t){if("string"!=typeof t)throw new Error("Time zone name must be a string, got "+t+" ["+typeof t+"]");return this._z=y(t),this._z?e.updateOffset(this,i):I("Moment Timezone has no data for "+t+". See http://momentjs.com/timezone/docs/#/data-loading/."),this}if(this._z)return this._z.name},z.zoneName=S(z.zoneName),z.zoneAbbr=S(z.zoneAbbr),z.utc=E(z.utc),z.local=E(z.local),z.utcOffset=x(z.utcOffset),e.tz.setDefault=function(t){return(k<2||2===k&&F<9)&&I("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+e.version+"."),e.defaultZone=t?y(t):null,e};var H=e.momentProperties;return"[object Array]"===Object.prototype.toString.call(H)?(H.push("_z"),H.push("_a")):H&&(H._z=null),e})},function(e,t,i){var n;(function(e){!function(t,i){e.exports=i()}(this,function(){"use strict";function t(){return no.apply(null,arguments)}function o(e){no=e}function s(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function a(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(r(e,t))return!1;return!0}function c(e){return void 0===e}function u(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function d(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function h(e,t){var i,n=[];for(i=0;i<e.length;++i)n.push(t(e[i],i));return n}function p(e,t){for(var i in t)r(t,i)&&(e[i]=t[i]);return r(t,"toString")&&(e.toString=t.toString),r(t,"valueOf")&&(e.valueOf=t.valueOf),e}function m(e,t,i,n){return Et(e,t,i,n,!0).utc()}function f(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function g(e){return null==e._pf&&(e._pf=f()),e._pf}function _(e){if(null==e._isValid){var t=g(e),i=oo.call(t.parsedDateParts,function(e){return null!=e}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i);if(e._strict&&(n=n&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return n;e._isValid=n}return e._isValid}function v(e){var t=m(NaN);return null!=e?p(g(t),e):g(t).userInvalidated=!0,t}function y(e,t){var i,n,o;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=g(t)),c(t._locale)||(e._locale=t._locale),so.length>0)for(i=0;i<so.length;i++)n=so[i],o=t[n],c(o)||(e[n]=o);return e}function b(e){y(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ao===!1&&(ao=!0,t.updateOffset(this),ao=!1)}function w(e){return e instanceof b||null!=e&&null!=e._isAMomentObject}function M(e){t.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function T(e,i){var n=!0;return p(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),n){var o,s,a,l=[];for(s=0;s<arguments.length;s++){if(o="","object"==typeof arguments[s]){o+="\n["+s+"] ";for(a in arguments[0])r(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[s];l.push(o)}M(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),n=!1}return i.apply(this,arguments)},i)}function C(e,i){null!=t.deprecationHandler&&t.deprecationHandler(e,i),ro[e]||(M(i),ro[e]=!0)}function I(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function A(e){var t,i;for(i in e)r(e,i)&&(t=e[i],I(t)?this[i]=t:this["_"+i]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function S(e,t){var i,n=p({},e);for(i in t)r(t,i)&&(a(e[i])&&a(t[i])?(n[i]={},p(n[i],e[i]),p(n[i],t[i])):null!=t[i]?n[i]=t[i]:delete n[i]);for(i in e)r(e,i)&&!r(t,i)&&a(e[i])&&(n[i]=p({},n[i]));return n}function E(e){null!=e&&this.set(e)}function x(e,t,i){var n=this._calendar[e]||this._calendar.sameElse;return I(n)?n.call(t,i):n}function L(e,t,i){var n=""+Math.abs(e),o=t-n.length,s=e>=0;return(s?i?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}function N(e,t,i,n){var o=n;"string"==typeof n&&(o=function(){return this[n]()}),e&&(fo[e]=o),t&&(fo[t[0]]=function(){return L(o.apply(this,arguments),t[1],t[2])}),i&&(fo[i]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function O(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function D(e){var t,i,n=e.match(ho);for(t=0,i=n.length;t<i;t++)fo[n[t]]?n[t]=fo[n[t]]:n[t]=O(n[t]);return function(t){var o,s="";for(o=0;o<i;o++)s+=I(n[o])?n[o].call(t,e):n[o];return s}}function R(e,t){return e.isValid()?(t=P(t,e.localeData()),mo[t]=mo[t]||D(t),mo[t](e)):e.localeData().invalidDate()}function P(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(po.lastIndex=0;n>=0&&po.test(e);)e=e.replace(po,i),po.lastIndex=0,n-=1;return e}function B(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];return t||!i?t:(this._longDateFormat[e]=i.match(ho).map(function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e}).join(""),this._longDateFormat[e])}function k(){return this._invalidDate}function F(e){return this._ordinal.replace("%d",e)}function z(e,t,i,n){var o=this._relativeTime[i];return I(o)?o(e,t,i,n):o.replace(/%d/i,e)}function H(e,t){var i=this._relativeTime[e>0?"future":"past"];return I(i)?i(t):i.replace(/%s/i,t)}function q(e,t){var i=e.toLowerCase();wo[i]=wo[i+"s"]=wo[t]=e}function W(e){return"string"==typeof e?wo[e]||wo[e.toLowerCase()]:void 0}function U(e){var t,i,n={};for(i in e)r(e,i)&&(t=W(i),t&&(n[t]=e[i]));return n}function Y(e,t){Mo[e]=t}function G(e){var t,i=[];for(t in e)r(e,t)&&i.push({unit:t,priority:Mo[t]});return i.sort(function(e,t){return e.priority-t.priority}),i}function j(e){return e%4===0&&e%100!==0||e%400===0}function V(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function X(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=V(t)),i}function Q(e,i){return function(n){return null!=n?(J(this,e,n),t.updateOffset(this,i),this):K(this,e)}}function K(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function J(e,t,i){e.isValid()&&!isNaN(i)&&("FullYear"===t&&j(e.year())&&1===e.month()&&29===e.date()?(i=X(i),e._d["set"+(e._isUTC?"UTC":"")+t](i,e.month(),le(i,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](i))}function Z(e){return e=W(e),I(this[e])?this[e]():this}function $(e,t){if("object"==typeof e){e=U(e);var i,n=G(e);for(i=0;i<n.length;i++)this[n[i].unit](e[n[i].unit])}else if(e=W(e),I(this[e]))return this[e](t);return this}function ee(e,t,i){co[e]=I(t)?t:function(e,n){return e&&i?i:t}}function te(e,t){return r(co,e)?co[e](t._strict,t._locale):new RegExp(ie(e))}function ie(e){return ne(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,o){return t||i||n||o}))}function ne(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function oe(e,t){var i,n=t;for("string"==typeof e&&(e=[e]),u(t)&&(n=function(e,i){i[t]=X(e)}),i=0;i<e.length;i++)qo[e[i]]=n}function se(e,t){oe(e,function(e,i,n,o){n._w=n._w||{},t(e,n._w,n,o)})}function ae(e,t,i){null!=t&&r(qo,e)&&qo[e](t,i._a,i,e)}function re(e,t){return(e%t+t)%t}function le(e,t){if(isNaN(e)||isNaN(t))return NaN;var i=re(t,12);return e+=(t-i)/12,1===i?j(e)?29:28:31-i%7%2}function ce(e,t){return e?s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||$o).test(t)?"format":"standalone"][e.month()]:s(this._months)?this._months:this._months.standalone}function ue(e,t){return e?s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[$o.test(t)?"format":"standalone"][e.month()]:s(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function de(e,t,i){var n,o,s,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=m([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return i?"MMM"===t?(o=Ho.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Ho.call(this._longMonthsParse,a),o!==-1?o:null):"MMM"===t?(o=Ho.call(this._shortMonthsParse,a),o!==-1?o:(o=Ho.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Ho.call(this._longMonthsParse,a),o!==-1?o:(o=Ho.call(this._shortMonthsParse,a),o!==-1?o:null))}function he(e,t,i){var n,o,s;if(this._monthsParseExact)return de.call(this,e,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=m([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(s="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(i&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!i&&this._monthsParse[n].test(e))return n}}function pe(e,t){var i;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=X(t);else if(t=e.localeData().monthsParse(t),!u(t))return e;return i=Math.min(e.date(),le(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e}function me(e){return null!=e?(pe(this,e),t.updateOffset(this,!0),this):K(this,"Month")}function fe(){return le(this.year(),this.month())}function ge(e){return this._monthsParseExact?(r(this,"_monthsRegex")||ve.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(r(this,"_monthsShortRegex")||(this._monthsShortRegex=es),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function _e(e){return this._monthsParseExact?(r(this,"_monthsRegex")||ve.call(this),e?this._monthsStrictRegex:this._monthsRegex):(r(this,"_monthsRegex")||(this._monthsRegex=ts),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function ve(){function e(e,t){return t.length-e.length}var t,i,n=[],o=[],s=[];for(t=0;t<12;t++)i=m([2e3,t]),n.push(this.monthsShort(i,"")),o.push(this.months(i,"")),s.push(this.months(i,"")),s.push(this.monthsShort(i,""));for(n.sort(e),o.sort(e),s.sort(e),t=0;t<12;t++)n[t]=ne(n[t]),o[t]=ne(o[t]);for(t=0;t<24;t++)s[t]=ne(s[t]);this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function ye(e){return j(e)?366:365}function be(){return j(this.year())}function we(e,t,i,n,o,s,a){var r;return e<100&&e>=0?(r=new Date(e+400,t,i,n,o,s,a),isFinite(r.getFullYear())&&r.setFullYear(e)):r=new Date(e,t,i,n,o,s,a),r}function Me(e){var t,i;return e<100&&e>=0?(i=Array.prototype.slice.call(arguments),i[0]=e+400,t=new Date(Date.UTC.apply(null,i)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Te(e,t,i){var n=7+t-i,o=(7+Me(e,0,n).getUTCDay()-t)%7;return-o+n-1}function Ce(e,t,i,n,o){var s,a,r=(7+i-n)%7,l=Te(e,n,o),c=1+7*(t-1)+r+l;return c<=0?(s=e-1,a=ye(s)+c):c>ye(e)?(s=e+1,a=c-ye(e)):(s=e,a=c),{year:s,dayOfYear:a}}function Ie(e,t,i){var n,o,s=Te(e.year(),t,i),a=Math.floor((e.dayOfYear()-s-1)/7)+1;return a<1?(o=e.year()-1,n=a+Ae(o,t,i)):a>Ae(e.year(),t,i)?(n=a-Ae(e.year(),t,i),o=e.year()+1):(o=e.year(),n=a),{week:n,year:o}}function Ae(e,t,i){var n=Te(e,t,i),o=Te(e+1,t,i);return(ye(e)-n+o)/7}function Se(e){return Ie(e,this._week.dow,this._week.doy).week}function Ee(){return this._week.dow}function xe(){return this._week.doy}function Le(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ne(e){var t=Ie(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Oe(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function De(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Re(e,t){return e.slice(t,7).concat(e.slice(0,t))}function Pe(e,t){var i=s(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?Re(i,this._week.dow):e?i[e.day()]:i}function Be(e){return e===!0?Re(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function ke(e){return e===!0?Re(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Fe(e,t,i){var n,o,s,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=m([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return i?"dddd"===t?(o=Ho.call(this._weekdaysParse,a),o!==-1?o:null):"ddd"===t?(o=Ho.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Ho.call(this._minWeekdaysParse,a),o!==-1?o:null):"dddd"===t?(o=Ho.call(this._weekdaysParse,a),o!==-1?o:(o=Ho.call(this._shortWeekdaysParse,a),o!==-1?o:(o=Ho.call(this._minWeekdaysParse,a),o!==-1?o:null))):"ddd"===t?(o=Ho.call(this._shortWeekdaysParse,a),o!==-1?o:(o=Ho.call(this._weekdaysParse,a),o!==-1?o:(o=Ho.call(this._minWeekdaysParse,a),o!==-1?o:null))):(o=Ho.call(this._minWeekdaysParse,a),o!==-1?o:(o=Ho.call(this._weekdaysParse,a),o!==-1?o:(o=Ho.call(this._shortWeekdaysParse,a),o!==-1?o:null)))}function ze(e,t,i){var n,o,s;if(this._weekdaysParseExact)return Fe.call(this,e,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=m([2e3,1]).day(n),i&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),i&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(i&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(i&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!i&&this._weekdaysParse[n].test(e))return n}}function He(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Oe(e,this.localeData()),this.add(e-t,"d")):t}function qe(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function We(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=De(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Ue(e){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||je.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(r(this,"_weekdaysRegex")||(this._weekdaysRegex=rs),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Ye(e){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||je.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(r(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ls),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ge(e){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||je.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(r(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=cs),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function je(){function e(e,t){return t.length-e.length}var t,i,n,o,s,a=[],r=[],l=[],c=[];for(t=0;t<7;t++)i=m([2e3,1]).day(t),n=ne(this.weekdaysMin(i,"")),o=ne(this.weekdaysShort(i,"")),s=ne(this.weekdays(i,"")),a.push(n),r.push(o),l.push(s),c.push(n),c.push(o),c.push(s);a.sort(e),r.sort(e),l.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Ve(){return this.hours()%12||12}function Xe(){return this.hours()||24}function Qe(e,t){N(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ke(e,t){return t._meridiemParse}function Je(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ze(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"}function $e(e,t){var i,n=Math.min(e.length,t.length);for(i=0;i<n;i+=1)if(e[i]!==t[i])return i;return n}function et(e){return e?e.toLowerCase().replace("_","-"):e}function tt(e){for(var t,i,n,o,s=0;s<e.length;){for(o=et(e[s]).split("-"),t=o.length,i=et(e[s+1]),i=i?i.split("-"):null;t>0;){if(n=it(o.slice(0,t).join("-")))return n;if(i&&i.length>=t&&$e(o,i)>=t-1)break;t--}s++}return us}function it(t){var o,s=null;if(void 0===ms[t]&&"undefined"!=typeof e&&e&&e.exports)try{s=us._abbr,o=n,i(48)("./"+t),nt(s)}catch(a){ms[t]=null}return ms[t]}function nt(e,t){var i;return e&&(i=c(t)?at(e):ot(e,t),i?us=i:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),us._abbr}function ot(e,t){if(null!==t){var i,n=ps;if(t.abbr=e,null!=ms[e])C("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ms[e]._config;else if(null!=t.parentLocale)if(null!=ms[t.parentLocale])n=ms[t.parentLocale]._config;else{if(i=it(t.parentLocale),null==i)return fs[t.parentLocale]||(fs[t.parentLocale]=[]),fs[t.parentLocale].push({name:e,config:t}),null;n=i._config}return ms[e]=new E(S(n,t)),fs[e]&&fs[e].forEach(function(e){ot(e.name,e.config)}),nt(e),ms[e]}return delete ms[e],null}function st(e,t){if(null!=t){var i,n,o=ps;null!=ms[e]&&null!=ms[e].parentLocale?ms[e].set(S(ms[e]._config,t)):(n=it(e),null!=n&&(o=n._config),t=S(o,t),null==n&&(t.abbr=e),i=new E(t),i.parentLocale=ms[e],ms[e]=i),nt(e)}else null!=ms[e]&&(null!=ms[e].parentLocale?(ms[e]=ms[e].parentLocale,e===nt()&&nt(e)):null!=ms[e]&&delete ms[e]);return ms[e]}function at(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return us;if(!s(e)){if(t=it(e))return t;e=[e]}return tt(e)}function rt(){return lo(ms)}function lt(e){var t,i=e._a;return i&&g(e).overflow===-2&&(t=i[Uo]<0||i[Uo]>11?Uo:i[Yo]<1||i[Yo]>le(i[Wo],i[Uo])?Yo:i[Go]<0||i[Go]>24||24===i[Go]&&(0!==i[jo]||0!==i[Vo]||0!==i[Xo])?Go:i[jo]<0||i[jo]>59?jo:i[Vo]<0||i[Vo]>59?Vo:i[Xo]<0||i[Xo]>999?Xo:-1,g(e)._overflowDayOfYear&&(t<Wo||t>Yo)&&(t=Yo),g(e)._overflowWeeks&&t===-1&&(t=Qo),g(e)._overflowWeekday&&t===-1&&(t=Ko),g(e).overflow=t),e}function ct(e){var t,i,n,o,s,a,r=e._i,l=gs.exec(r)||_s.exec(r);if(l){for(g(e).iso=!0,t=0,i=ys.length;t<i;t++)if(ys[t][1].exec(l[1])){o=ys[t][0],n=ys[t][2]!==!1;break}if(null==o)return void(e._isValid=!1);if(l[3]){for(t=0,i=bs.length;t<i;t++)if(bs[t][1].exec(l[3])){s=(l[2]||" ")+bs[t][0];break}if(null==s)return void(e._isValid=!1)}if(!n&&null!=s)return void(e._isValid=!1);if(l[4]){if(!vs.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=o+(s||"")+(a||""),wt(e)}else e._isValid=!1}function ut(e,t,i,n,o,s){var a=[dt(e),Zo.indexOf(t),parseInt(i,10),parseInt(n,10),parseInt(o,10)];return s&&a.push(parseInt(s,10)),a}function dt(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function ht(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function pt(e,t,i){if(e){var n=ss.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return g(i).weekdayMismatch=!0,i._isValid=!1,!1}return!0}function mt(e,t,i){if(e)return Ts[e];if(t)return 0;var n=parseInt(i,10),o=n%100,s=(n-o)/100;return 60*s+o}function ft(e){var t,i=Ms.exec(ht(e._i));if(i){if(t=ut(i[4],i[3],i[2],i[5],i[6],i[7]),!pt(i[1],t,e))return;e._a=t,e._tzm=mt(i[8],i[9],i[10]),e._d=Me.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function gt(e){var i=ws.exec(e._i);return null!==i?void(e._d=new Date((+i[1]))):(ct(e),void(e._isValid===!1&&(delete e._isValid,ft(e),e._isValid===!1&&(delete e._isValid,e._strict?e._isValid=!1:t.createFromInputFallback(e)))))}function _t(e,t,i){return null!=e?e:null!=t?t:i}function vt(e){var i=new Date(t.now());return e._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function yt(e){var t,i,n,o,s,a=[];if(!e._d){for(n=vt(e),e._w&&null==e._a[Yo]&&null==e._a[Uo]&&bt(e),null!=e._dayOfYear&&(s=_t(e._a[Wo],n[Wo]),(e._dayOfYear>ye(s)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),i=Me(s,0,e._dayOfYear),e._a[Uo]=i.getUTCMonth(),e._a[Yo]=i.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=n[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Go]&&0===e._a[jo]&&0===e._a[Vo]&&0===e._a[Xo]&&(e._nextDay=!0,e._a[Go]=0),e._d=(e._useUTC?Me:we).apply(null,a),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Go]=24),e._w&&"undefined"!=typeof e._w.d&&e._w.d!==o&&(g(e).weekdayMismatch=!0)}}function bt(e){var t,i,n,o,s,a,r,l,c;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(s=1,a=4,i=_t(t.GG,e._a[Wo],Ie(xt(),1,4).year),n=_t(t.W,1),o=_t(t.E,1),(o<1||o>7)&&(l=!0)):(s=e._locale._week.dow,a=e._locale._week.doy,c=Ie(xt(),s,a),i=_t(t.gg,e._a[Wo],c.year),n=_t(t.w,c.week),null!=t.d?(o=t.d,(o<0||o>6)&&(l=!0)):null!=t.e?(o=t.e+s,(t.e<0||t.e>6)&&(l=!0)):o=s),n<1||n>Ae(i,s,a)?g(e)._overflowWeeks=!0:null!=l?g(e)._overflowWeekday=!0:(r=Ce(i,n,o,s,a),e._a[Wo]=r.year,e._dayOfYear=r.dayOfYear)}function wt(e){if(e._f===t.ISO_8601)return void ct(e);if(e._f===t.RFC_2822)return void ft(e);e._a=[],g(e).empty=!0;var i,n,o,s,a,r,l=""+e._i,c=l.length,u=0;for(o=P(e._f,e._locale).match(ho)||[],i=0;i<o.length;i++)s=o[i],n=(l.match(te(s,e))||[])[0],n&&(a=l.substr(0,l.indexOf(n)),a.length>0&&g(e).unusedInput.push(a),l=l.slice(l.indexOf(n)+n.length),u+=n.length),fo[s]?(n?g(e).empty=!1:g(e).unusedTokens.push(s),ae(s,n,e)):e._strict&&!n&&g(e).unusedTokens.push(s);g(e).charsLeftOver=c-u,l.length>0&&g(e).unusedInput.push(l),e._a[Go]<=12&&g(e).bigHour===!0&&e._a[Go]>0&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[Go]=Mt(e._locale,e._a[Go],e._meridiem),r=g(e).era,null!==r&&(e._a[Wo]=e._locale.erasConvertYear(r,e._a[Wo])),yt(e),lt(e)}function Mt(e,t,i){var n;return null==i?t:null!=e.meridiemHour?e.meridiemHour(t,i):null!=e.isPM?(n=e.isPM(i),n&&t<12&&(t+=12),n||12!==t||(t=0),t):t}function Tt(e){var t,i,n,o,s,a,r=!1;if(0===e._f.length)return g(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)s=0,a=!1,t=y({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],wt(t),_(t)&&(a=!0),s+=g(t).charsLeftOver,s+=10*g(t).unusedTokens.length,g(t).score=s,r?s<n&&(n=s,i=t):(null==n||s<n||a)&&(n=s,i=t,a&&(r=!0));p(e,i||t)}function Ct(e){if(!e._d){var t=U(e._i),i=void 0===t.day?t.date:t.day;e._a=h([t.year,t.month,i,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),yt(e)}}function It(e){var t=new b(lt(At(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function At(e){var t=e._i,i=e._f;return e._locale=e._locale||at(e._l),null===t||void 0===i&&""===t?v({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),w(t)?new b(lt(t)):(d(t)?e._d=t:s(i)?Tt(e):i?wt(e):St(e),_(e)||(e._d=null),e))}function St(e){var i=e._i;c(i)?e._d=new Date(t.now()):d(i)?e._d=new Date(i.valueOf()):"string"==typeof i?gt(e):s(i)?(e._a=h(i.slice(0),function(e){return parseInt(e,10)}),yt(e)):a(i)?Ct(e):u(i)?e._d=new Date(i):t.createFromInputFallback(e)}function Et(e,t,i,n,o){var r={};return t!==!0&&t!==!1||(n=t,t=void 0),i!==!0&&i!==!1||(n=i,i=void 0),(a(e)&&l(e)||s(e)&&0===e.length)&&(e=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=o,r._l=i,r._i=e,r._f=t,r._strict=n,It(r)}function xt(e,t,i,n){return Et(e,t,i,n,!1)}function Lt(e,t){var i,n;if(1===t.length&&s(t[0])&&(t=t[0]),!t.length)return xt();for(i=t[0],n=1;n<t.length;++n)t[n].isValid()&&!t[n][e](i)||(i=t[n]);return i}function Nt(){var e=[].slice.call(arguments,0);return Lt("isBefore",e)}function Ot(){var e=[].slice.call(arguments,0);return Lt("isAfter",e)}function Dt(e){var t,i,n=!1;for(t in e)if(r(e,t)&&(Ho.call(Ss,t)===-1||null!=e[t]&&isNaN(e[t])))return!1;for(i=0;i<Ss.length;++i)if(e[Ss[i]]){if(n)return!1;parseFloat(e[Ss[i]])!==X(e[Ss[i]])&&(n=!0)}return!0}function Rt(){return this._isValid}function Pt(){return ti(NaN)}function Bt(e){var t=U(e),i=t.year||0,n=t.quarter||0,o=t.month||0,s=t.week||t.isoWeek||0,a=t.day||0,r=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=Dt(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*r*60*60,this._days=+a+7*s,this._months=+o+3*n+12*i,this._data={},this._locale=at(),this._bubble()}function kt(e){return e instanceof Bt}function Ft(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function zt(e,t,i){var n,o=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),a=0;for(n=0;n<o;n++)(i&&e[n]!==t[n]||!i&&X(e[n])!==X(t[n]))&&a++;return a+s}function Ht(e,t){N(e,0,0,function(){var e=this.utcOffset(),i="+";return e<0&&(e=-e,
i="-"),i+L(~~(e/60),2)+t+L(~~e%60,2)})}function qt(e,t){var i,n,o,s=(t||"").match(e);return null===s?null:(i=s[s.length-1]||[],n=(i+"").match(Es)||["-",0,0],o=+(60*n[1])+X(n[2]),0===o?0:"+"===n[0]?o:-o)}function Wt(e,i){var n,o;return i._isUTC?(n=i.clone(),o=(w(e)||d(e)?e.valueOf():xt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+o),t.updateOffset(n,!1),n):xt(e).local()}function Ut(e){return-Math.round(e._d.getTimezoneOffset())}function Yt(e,i,n){var o,s=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(e=qt(ko,e),null===e)return this}else Math.abs(e)<16&&!n&&(e=60*e);return!this._isUTC&&i&&(o=Ut(this)),this._offset=e,this._isUTC=!0,null!=o&&this.add(o,"m"),s!==e&&(!i||this._changeInProgress?ai(this,ti(e-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?s:Ut(this)}function Gt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function jt(e){return this.utcOffset(0,e)}function Vt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ut(this),"m")),this}function Xt(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=qt(Bo,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Qt(e){return!!this.isValid()&&(e=e?xt(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function Kt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Jt(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e,t={};return y(t,this),t=At(t),t._a?(e=t._isUTC?m(t._a):xt(t._a),this._isDSTShifted=this.isValid()&&zt(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Zt(){return!!this.isValid()&&!this._isUTC}function $t(){return!!this.isValid()&&this._isUTC}function ei(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function ti(e,t){var i,n,o,s=e,a=null;return kt(e)?s={ms:e._milliseconds,d:e._days,M:e._months}:u(e)||!isNaN(+e)?(s={},t?s[t]=+e:s.milliseconds=+e):(a=xs.exec(e))?(i="-"===a[1]?-1:1,s={y:0,d:X(a[Yo])*i,h:X(a[Go])*i,m:X(a[jo])*i,s:X(a[Vo])*i,ms:X(Ft(1e3*a[Xo]))*i}):(a=Ls.exec(e))?(i="-"===a[1]?-1:1,s={y:ii(a[2],i),M:ii(a[3],i),w:ii(a[4],i),d:ii(a[5],i),h:ii(a[6],i),m:ii(a[7],i),s:ii(a[8],i)}):null==s?s={}:"object"==typeof s&&("from"in s||"to"in s)&&(o=oi(xt(s.from),xt(s.to)),s={},s.ms=o.milliseconds,s.M=o.months),n=new Bt(s),kt(e)&&r(e,"_locale")&&(n._locale=e._locale),kt(e)&&r(e,"_isValid")&&(n._isValid=e._isValid),n}function ii(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function ni(e,t){var i={};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function oi(e,t){var i;return e.isValid()&&t.isValid()?(t=Wt(t,e),e.isBefore(t)?i=ni(e,t):(i=ni(t,e),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function si(e,t){return function(i,n){var o,s;return null===n||isNaN(+n)||(C(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=i,i=n,n=s),o=ti(i,n),ai(this,o,e),this}}function ai(e,i,n,o){var s=i._milliseconds,a=Ft(i._days),r=Ft(i._months);e.isValid()&&(o=null==o||o,r&&pe(e,K(e,"Month")+r*n),a&&J(e,"Date",K(e,"Date")+a*n),s&&e._d.setTime(e._d.valueOf()+s*n),o&&t.updateOffset(e,a||r))}function ri(e){return"string"==typeof e||e instanceof String}function li(e){return w(e)||d(e)||ri(e)||u(e)||ui(e)||ci(e)||null===e||void 0===e}function ci(e){var t,i,n=a(e)&&!l(e),o=!1,s=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"];for(t=0;t<s.length;t+=1)i=s[t],o=o||r(e,i);return n&&o}function ui(e){var t=s(e),i=!1;return t&&(i=0===e.filter(function(t){return!u(t)&&ri(e)}).length),t&&i}function di(e){var t,i,n=a(e)&&!l(e),o=!1,s=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<s.length;t+=1)i=s[t],o=o||r(e,i);return n&&o}function hi(e,t){var i=e.diff(t,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function pi(e,i){1===arguments.length&&(li(arguments[0])?(e=arguments[0],i=void 0):di(arguments[0])&&(i=arguments[0],e=void 0));var n=e||xt(),o=Wt(n,this).startOf("day"),s=t.calendarFormat(this,o)||"sameElse",a=i&&(I(i[s])?i[s].call(this,n):i[s]);return this.format(a||this.localeData().calendar(s,this,xt(n)))}function mi(){return new b(this)}function fi(e,t){var i=w(e)?e:xt(e);return!(!this.isValid()||!i.isValid())&&(t=W(t)||"millisecond","millisecond"===t?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf())}function gi(e,t){var i=w(e)?e:xt(e);return!(!this.isValid()||!i.isValid())&&(t=W(t)||"millisecond","millisecond"===t?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf())}function _i(e,t,i,n){var o=w(e)?e:xt(e),s=w(t)?t:xt(t);return!!(this.isValid()&&o.isValid()&&s.isValid())&&(n=n||"()",("("===n[0]?this.isAfter(o,i):!this.isBefore(o,i))&&(")"===n[1]?this.isBefore(s,i):!this.isAfter(s,i)))}function vi(e,t){var i,n=w(e)?e:xt(e);return!(!this.isValid()||!n.isValid())&&(t=W(t)||"millisecond","millisecond"===t?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(t).valueOf()<=i&&i<=this.clone().endOf(t).valueOf()))}function yi(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function bi(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function wi(e,t,i){var n,o,s;if(!this.isValid())return NaN;if(n=Wt(e,this),!n.isValid())return NaN;switch(o=6e4*(n.utcOffset()-this.utcOffset()),t=W(t)){case"year":s=Mi(this,n)/12;break;case"month":s=Mi(this,n);break;case"quarter":s=Mi(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-o)/864e5;break;case"week":s=(this-n-o)/6048e5;break;default:s=this-n}return i?s:V(s)}function Mi(e,t){if(e.date()<t.date())return-Mi(t,e);var i,n,o=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(o,"months");return t-s<0?(i=e.clone().add(o-1,"months"),n=(t-s)/(s-i)):(i=e.clone().add(o+1,"months"),n=(t-s)/(i-s)),-(o+n)||0}function Ti(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Ci(e){if(!this.isValid())return null;var t=e!==!0,i=t?this.clone().utc():this;return i.year()<0||i.year()>9999?R(i,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):I(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",R(i,"Z")):R(i,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Ii(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,i,n,o="moment",s="";return this.isLocal()||(o=0===this.utcOffset()?"moment.utc":"moment.parseZone",s="Z"),e="["+o+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",n=s+'[")]',this.format(e+t+i+n)}function Ai(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var i=R(this,e);return this.localeData().postformat(i)}function Si(e,t){return this.isValid()&&(w(e)&&e.isValid()||xt(e).isValid())?ti({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Ei(e){return this.from(xt(),e)}function xi(e,t){return this.isValid()&&(w(e)&&e.isValid()||xt(e).isValid())?ti({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Li(e){return this.to(xt(),e)}function Ni(e){var t;return void 0===e?this._locale._abbr:(t=at(e),null!=t&&(this._locale=t),this)}function Oi(){return this._locale}function Di(e,t){return(e%t+t)%t}function Ri(e,t,i){return e<100&&e>=0?new Date(e+400,t,i)-ks:new Date(e,t,i).valueOf()}function Pi(e,t,i){return e<100&&e>=0?Date.UTC(e+400,t,i)-ks:Date.UTC(e,t,i)}function Bi(e){var i,n;if(e=W(e),void 0===e||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?Pi:Ri,e){case"year":i=n(this.year(),0,1);break;case"quarter":i=n(this.year(),this.month()-this.month()%3,1);break;case"month":i=n(this.year(),this.month(),1);break;case"week":i=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":i=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":i=n(this.year(),this.month(),this.date());break;case"hour":i=this._d.valueOf(),i-=Di(i+(this._isUTC?0:this.utcOffset()*Ps),Bs);break;case"minute":i=this._d.valueOf(),i-=Di(i,Ps);break;case"second":i=this._d.valueOf(),i-=Di(i,Rs)}return this._d.setTime(i),t.updateOffset(this,!0),this}function ki(e){var i,n;if(e=W(e),void 0===e||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?Pi:Ri,e){case"year":i=n(this.year()+1,0,1)-1;break;case"quarter":i=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":i=n(this.year(),this.month()+1,1)-1;break;case"week":i=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":i=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":i=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":i=this._d.valueOf(),i+=Bs-Di(i+(this._isUTC?0:this.utcOffset()*Ps),Bs)-1;break;case"minute":i=this._d.valueOf(),i+=Ps-Di(i,Ps)-1;break;case"second":i=this._d.valueOf(),i+=Rs-Di(i,Rs)-1}return this._d.setTime(i),t.updateOffset(this,!0),this}function Fi(){return this._d.valueOf()-6e4*(this._offset||0)}function zi(){return Math.floor(this.valueOf()/1e3)}function Hi(){return new Date(this.valueOf())}function qi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Wi(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ui(){return this.isValid()?this.toISOString():null}function Yi(){return _(this)}function Gi(){return p({},g(this))}function ji(){return g(this).overflow}function Vi(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Xi(e,i){var n,o,s,a=this._eras||at("en")._eras;for(n=0,o=a.length;n<o;++n){switch(typeof a[n].since){case"string":s=t(a[n].since).startOf("day"),a[n].since=s.valueOf()}switch(typeof a[n].until){case"undefined":a[n].until=+(1/0);break;case"string":s=t(a[n].until).startOf("day").valueOf(),a[n].until=s.valueOf()}}return a}function Qi(e,t,i){var n,o,s,a,r,l=this.eras();for(e=e.toUpperCase(),n=0,o=l.length;n<o;++n)if(s=l[n].name.toUpperCase(),a=l[n].abbr.toUpperCase(),r=l[n].narrow.toUpperCase(),i)switch(t){case"N":case"NN":case"NNN":if(a===e)return l[n];break;case"NNNN":if(s===e)return l[n];break;case"NNNNN":if(r===e)return l[n]}else if([s,a,r].indexOf(e)>=0)return l[n]}function Ki(e,i){var n=e.since<=e.until?1:-1;return void 0===i?t(e.since).year():t(e.since).year()+(i-e.offset)*n}function Ji(){var e,t,i,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(i=this.startOf("day").valueOf(),n[e].since<=i&&i<=n[e].until)return n[e].name;if(n[e].until<=i&&i<=n[e].since)return n[e].name}return""}function Zi(){var e,t,i,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(i=this.startOf("day").valueOf(),n[e].since<=i&&i<=n[e].until)return n[e].narrow;if(n[e].until<=i&&i<=n[e].since)return n[e].narrow}return""}function $i(){var e,t,i,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(i=this.startOf("day").valueOf(),n[e].since<=i&&i<=n[e].until)return n[e].abbr;if(n[e].until<=i&&i<=n[e].since)return n[e].abbr}return""}function en(){var e,i,n,o,s=this.localeData().eras();for(e=0,i=s.length;e<i;++e)if(n=s[e].since<=s[e].until?1:-1,o=this.startOf("day").valueOf(),s[e].since<=o&&o<=s[e].until||s[e].until<=o&&o<=s[e].since)return(this.year()-t(s[e].since).year())*n+s[e].offset;return this.year()}function tn(e){return r(this,"_erasNameRegex")||cn.call(this),e?this._erasNameRegex:this._erasRegex}function nn(e){return r(this,"_erasAbbrRegex")||cn.call(this),e?this._erasAbbrRegex:this._erasRegex}function on(e){return r(this,"_erasNarrowRegex")||cn.call(this),e?this._erasNarrowRegex:this._erasRegex}function sn(e,t){return t.erasAbbrRegex(e)}function an(e,t){return t.erasNameRegex(e)}function rn(e,t){return t.erasNarrowRegex(e)}function ln(e,t){return t._eraYearOrdinalRegex||Ro}function cn(){var e,t,i=[],n=[],o=[],s=[],a=this.eras();for(e=0,t=a.length;e<t;++e)n.push(ne(a[e].name)),i.push(ne(a[e].abbr)),o.push(ne(a[e].narrow)),s.push(ne(a[e].name)),s.push(ne(a[e].abbr)),s.push(ne(a[e].narrow));this._erasRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+n.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+o.join("|")+")","i")}function un(e,t){N(0,[e,e.length],0,t)}function dn(e){return _n.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function hn(e){return _n.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function pn(){return Ae(this.year(),1,4)}function mn(){return Ae(this.isoWeekYear(),1,4)}function fn(){var e=this.localeData()._week;return Ae(this.year(),e.dow,e.doy)}function gn(){var e=this.localeData()._week;return Ae(this.weekYear(),e.dow,e.doy)}function _n(e,t,i,n,o){var s;return null==e?Ie(this,n,o).year:(s=Ae(e,n,o),t>s&&(t=s),vn.call(this,e,t,i,n,o))}function vn(e,t,i,n,o){var s=Ce(e,t,i,n,o),a=Me(s.year,0,s.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function yn(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function bn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function wn(e,t){t[Xo]=X(1e3*("0."+e))}function Mn(){return this._isUTC?"UTC":""}function Tn(){return this._isUTC?"Coordinated Universal Time":""}function Cn(e){return xt(1e3*e)}function In(){return xt.apply(null,arguments).parseZone()}function An(e){return e}function Sn(e,t,i,n){var o=at(),s=m().set(n,t);return o[i](s,e)}function En(e,t,i){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return Sn(e,t,i,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Sn(e,n,i,"month");return o}function xn(e,t,i,n){"boolean"==typeof e?(u(t)&&(i=t,t=void 0),t=t||""):(t=e,i=t,e=!1,u(t)&&(i=t,t=void 0),t=t||"");var o,s=at(),a=e?s._week.dow:0,r=[];if(null!=i)return Sn(t,(i+a)%7,n,"day");for(o=0;o<7;o++)r[o]=Sn(t,(o+a)%7,n,"day");return r}function Ln(e,t){return En(e,t,"months")}function Nn(e,t){return En(e,t,"monthsShort")}function On(e,t,i){return xn(e,t,i,"weekdays")}function Dn(e,t,i){return xn(e,t,i,"weekdaysShort")}function Rn(e,t,i){return xn(e,t,i,"weekdaysMin")}function Pn(){var e=this._data;return this._milliseconds=Gs(this._milliseconds),this._days=Gs(this._days),this._months=Gs(this._months),e.milliseconds=Gs(e.milliseconds),e.seconds=Gs(e.seconds),e.minutes=Gs(e.minutes),e.hours=Gs(e.hours),e.months=Gs(e.months),e.years=Gs(e.years),this}function Bn(e,t,i,n){var o=ti(t,i);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function kn(e,t){return Bn(this,e,t,1)}function Fn(e,t){return Bn(this,e,t,-1)}function zn(e){return e<0?Math.floor(e):Math.ceil(e)}function Hn(){var e,t,i,n,o,s=this._milliseconds,a=this._days,r=this._months,l=this._data;return s>=0&&a>=0&&r>=0||s<=0&&a<=0&&r<=0||(s+=864e5*zn(Wn(r)+a),a=0,r=0),l.milliseconds=s%1e3,e=V(s/1e3),l.seconds=e%60,t=V(e/60),l.minutes=t%60,i=V(t/60),l.hours=i%24,a+=V(i/24),o=V(qn(a)),r+=o,a-=zn(Wn(o)),n=V(r/12),r%=12,l.days=a,l.months=r,l.years=n,this}function qn(e){return 4800*e/146097}function Wn(e){return 146097*e/4800}function Un(e){if(!this.isValid())return NaN;var t,i,n=this._milliseconds;if(e=W(e),"month"===e||"quarter"===e||"year"===e)switch(t=this._days+n/864e5,i=this._months+qn(t),e){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(t=this._days+Math.round(Wn(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function Yn(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*X(this._months/12):NaN}function Gn(e){return function(){return this.as(e)}}function jn(){return ti(this)}function Vn(e){return e=W(e),this.isValid()?this[e+"s"]():NaN}function Xn(e){return function(){return this.isValid()?this._data[e]:NaN}}function Qn(){return V(this.days()/7)}function Kn(e,t,i,n,o){return o.relativeTime(t||1,!!i,e,n)}function Jn(e,t,i,n){var o=ti(e).abs(),s=la(o.as("s")),a=la(o.as("m")),r=la(o.as("h")),l=la(o.as("d")),c=la(o.as("M")),u=la(o.as("w")),d=la(o.as("y")),h=s<=i.ss&&["s",s]||s<i.s&&["ss",s]||a<=1&&["m"]||a<i.m&&["mm",a]||r<=1&&["h"]||r<i.h&&["hh",r]||l<=1&&["d"]||l<i.d&&["dd",l];return null!=i.w&&(h=h||u<=1&&["w"]||u<i.w&&["ww",u]),h=h||c<=1&&["M"]||c<i.M&&["MM",c]||d<=1&&["y"]||["yy",d],h[2]=t,h[3]=+e>0,h[4]=n,Kn.apply(null,h)}function Zn(e){return void 0===e?la:"function"==typeof e&&(la=e,!0)}function $n(e,t){return void 0!==ca[e]&&(void 0===t?ca[e]:(ca[e]=t,"s"===e&&(ca.ss=t-1),!0))}function eo(e,t){if(!this.isValid())return this.localeData().invalidDate();var i,n,o=!1,s=ca;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(o=e),"object"==typeof t&&(s=Object.assign({},ca,t),null!=t.s&&null==t.ss&&(s.ss=t.s-1)),i=this.localeData(),n=Jn(this,!o,s,i),o&&(n=i.pastFuture(+this,n)),i.postformat(n)}function to(e){return(e>0)-(e<0)||+e}function io(){if(!this.isValid())return this.localeData().invalidDate();var e,t,i,n,o,s,a,r,l=ua(this._milliseconds)/1e3,c=ua(this._days),u=ua(this._months),d=this.asSeconds();return d?(e=V(l/60),t=V(e/60),l%=60,e%=60,i=V(u/12),u%=12,n=l?l.toFixed(3).replace(/\.?0+$/,""):"",o=d<0?"-":"",s=to(this._months)!==to(d)?"-":"",a=to(this._days)!==to(d)?"-":"",r=to(this._milliseconds)!==to(d)?"-":"",o+"P"+(i?s+i+"Y":"")+(u?s+u+"M":"")+(c?a+c+"D":"")+(t||e||l?"T":"")+(t?r+t+"H":"")+(e?r+e+"M":"")+(l?r+n+"S":"")):"P0D"}var no,oo;oo=Array.prototype.some?Array.prototype.some:function(e){var t,i=Object(this),n=i.length>>>0;for(t=0;t<n;t++)if(t in i&&e.call(this,i[t],t,i))return!0;return!1};var so=t.momentProperties=[],ao=!1,ro={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var lo;lo=Object.keys?Object.keys:function(e){var t,i=[];for(t in e)r(e,t)&&i.push(t);return i};var co,uo={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},ho=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,po=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,mo={},fo={},go={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},_o="Invalid date",vo="%d",yo=/\d{1,2}/,bo={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},wo={},Mo={},To=/\d/,Co=/\d\d/,Io=/\d{3}/,Ao=/\d{4}/,So=/[+-]?\d{6}/,Eo=/\d\d?/,xo=/\d\d\d\d?/,Lo=/\d\d\d\d\d\d?/,No=/\d{1,3}/,Oo=/\d{1,4}/,Do=/[+-]?\d{1,6}/,Ro=/\d+/,Po=/[+-]?\d+/,Bo=/Z|[+-]\d\d:?\d\d/gi,ko=/Z|[+-]\d\d(?::?\d\d)?/gi,Fo=/[+-]?\d+(\.\d{1,3})?/,zo=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;co={};var Ho,qo={},Wo=0,Uo=1,Yo=2,Go=3,jo=4,Vo=5,Xo=6,Qo=7,Ko=8;Ho=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},N("M",["MM",2],"Mo",function(){return this.month()+1}),N("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),N("MMMM",0,0,function(e){return this.localeData().months(this,e)}),q("month","M"),Y("month",8),ee("M",Eo),ee("MM",Eo,Co),ee("MMM",function(e,t){return t.monthsShortRegex(e)}),ee("MMMM",function(e,t){return t.monthsRegex(e)}),oe(["M","MM"],function(e,t){t[Uo]=X(e)-1}),oe(["MMM","MMMM"],function(e,t,i,n){var o=i._locale.monthsParse(e,n,i._strict);null!=o?t[Uo]=o:g(i).invalidMonth=e});var Jo="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Zo="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),$o=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,es=zo,ts=zo;N("Y",0,0,function(){var e=this.year();return e<=9999?L(e,4):"+"+e}),N(0,["YY",2],0,function(){return this.year()%100}),N(0,["YYYY",4],0,"year"),N(0,["YYYYY",5],0,"year"),N(0,["YYYYYY",6,!0],0,"year"),q("year","y"),Y("year",1),ee("Y",Po),ee("YY",Eo,Co),ee("YYYY",Oo,Ao),ee("YYYYY",Do,So),ee("YYYYYY",Do,So),oe(["YYYYY","YYYYYY"],Wo),oe("YYYY",function(e,i){i[Wo]=2===e.length?t.parseTwoDigitYear(e):X(e)}),oe("YY",function(e,i){i[Wo]=t.parseTwoDigitYear(e)}),oe("Y",function(e,t){t[Wo]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return X(e)+(X(e)>68?1900:2e3)};var is=Q("FullYear",!0);N("w",["ww",2],"wo","week"),N("W",["WW",2],"Wo","isoWeek"),q("week","w"),q("isoWeek","W"),Y("week",5),Y("isoWeek",5),ee("w",Eo),ee("ww",Eo,Co),ee("W",Eo),ee("WW",Eo,Co),se(["w","ww","W","WW"],function(e,t,i,n){t[n.substr(0,1)]=X(e)});var ns={dow:0,doy:6};N("d",0,"do","day"),N("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),N("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),N("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),N("e",0,0,"weekday"),N("E",0,0,"isoWeekday"),q("day","d"),q("weekday","e"),q("isoWeekday","E"),Y("day",11),Y("weekday",11),Y("isoWeekday",11),ee("d",Eo),ee("e",Eo),ee("E",Eo),ee("dd",function(e,t){return t.weekdaysMinRegex(e)}),ee("ddd",function(e,t){return t.weekdaysShortRegex(e)}),ee("dddd",function(e,t){return t.weekdaysRegex(e)}),se(["dd","ddd","dddd"],function(e,t,i,n){var o=i._locale.weekdaysParse(e,n,i._strict);null!=o?t.d=o:g(i).invalidWeekday=e}),se(["d","e","E"],function(e,t,i,n){t[n]=X(e)});var os="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ss="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),as="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),rs=zo,ls=zo,cs=zo;N("H",["HH",2],0,"hour"),N("h",["hh",2],0,Ve),N("k",["kk",2],0,Xe),N("hmm",0,0,function(){return""+Ve.apply(this)+L(this.minutes(),2)}),N("hmmss",0,0,function(){return""+Ve.apply(this)+L(this.minutes(),2)+L(this.seconds(),2)}),N("Hmm",0,0,function(){return""+this.hours()+L(this.minutes(),2)}),N("Hmmss",0,0,function(){return""+this.hours()+L(this.minutes(),2)+L(this.seconds(),2)}),Qe("a",!0),Qe("A",!1),q("hour","h"),Y("hour",13),ee("a",Ke),ee("A",Ke),ee("H",Eo),ee("h",Eo),ee("k",Eo),ee("HH",Eo,Co),ee("hh",Eo,Co),ee("kk",Eo,Co),ee("hmm",xo),ee("hmmss",Lo),ee("Hmm",xo),ee("Hmmss",Lo),oe(["H","HH"],Go),oe(["k","kk"],function(e,t,i){var n=X(e);t[Go]=24===n?0:n}),oe(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e}),oe(["h","hh"],function(e,t,i){t[Go]=X(e),g(i).bigHour=!0}),oe("hmm",function(e,t,i){var n=e.length-2;t[Go]=X(e.substr(0,n)),t[jo]=X(e.substr(n)),g(i).bigHour=!0}),oe("hmmss",function(e,t,i){var n=e.length-4,o=e.length-2;t[Go]=X(e.substr(0,n)),t[jo]=X(e.substr(n,2)),t[Vo]=X(e.substr(o)),g(i).bigHour=!0}),oe("Hmm",function(e,t,i){var n=e.length-2;t[Go]=X(e.substr(0,n)),t[jo]=X(e.substr(n))}),oe("Hmmss",function(e,t,i){var n=e.length-4,o=e.length-2;t[Go]=X(e.substr(0,n)),t[jo]=X(e.substr(n,2)),t[Vo]=X(e.substr(o))});var us,ds=/[ap]\.?m?\.?/i,hs=Q("Hours",!0),ps={calendar:uo,longDateFormat:go,invalidDate:_o,ordinal:vo,dayOfMonthOrdinalParse:yo,relativeTime:bo,months:Jo,monthsShort:Zo,week:ns,weekdays:os,weekdaysMin:as,weekdaysShort:ss,meridiemParse:ds},ms={},fs={},gs=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_s=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vs=/Z|[+-]\d\d(?::?\d\d)?/,ys=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],bs=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ws=/^\/?Date\((-?\d+)/i,Ms=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Ts={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};t.createFromInputFallback=T("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var Cs=T("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=xt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()}),Is=T("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=xt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:v()}),As=function(){return Date.now?Date.now():+new Date},Ss=["year","quarter","month","week","day","hour","minute","second","millisecond"];Ht("Z",":"),Ht("ZZ",""),ee("Z",ko),ee("ZZ",ko),oe(["Z","ZZ"],function(e,t,i){i._useUTC=!0,i._tzm=qt(ko,e)});var Es=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var xs=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Ls=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;ti.fn=Bt.prototype,ti.invalid=Pt;var Ns=si(1,"add"),Os=si(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Ds=T("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)}),Rs=1e3,Ps=60*Rs,Bs=60*Ps,ks=3506328*Bs;N("N",0,0,"eraAbbr"),N("NN",0,0,"eraAbbr"),N("NNN",0,0,"eraAbbr"),N("NNNN",0,0,"eraName"),N("NNNNN",0,0,"eraNarrow"),N("y",["y",1],"yo","eraYear"),N("y",["yy",2],0,"eraYear"),N("y",["yyy",3],0,"eraYear"),N("y",["yyyy",4],0,"eraYear"),ee("N",sn),ee("NN",sn),ee("NNN",sn),ee("NNNN",an),ee("NNNNN",rn),oe(["N","NN","NNN","NNNN","NNNNN"],function(e,t,i,n){var o=i._locale.erasParse(e,n,i._strict);o?g(i).era=o:g(i).invalidEra=e}),ee("y",Ro),ee("yy",Ro),ee("yyy",Ro),ee("yyyy",Ro),ee("yo",ln),oe(["y","yy","yyy","yyyy"],Wo),oe(["yo"],function(e,t,i,n){var o;i._locale._eraYearOrdinalRegex&&(o=e.match(i._locale._eraYearOrdinalRegex)),i._locale.eraYearOrdinalParse?t[Wo]=i._locale.eraYearOrdinalParse(e,o):t[Wo]=parseInt(e,10)}),N(0,["gg",2],0,function(){return this.weekYear()%100}),N(0,["GG",2],0,function(){return this.isoWeekYear()%100}),un("gggg","weekYear"),un("ggggg","weekYear"),un("GGGG","isoWeekYear"),un("GGGGG","isoWeekYear"),q("weekYear","gg"),q("isoWeekYear","GG"),Y("weekYear",1),Y("isoWeekYear",1),ee("G",Po),ee("g",Po),ee("GG",Eo,Co),ee("gg",Eo,Co),ee("GGGG",Oo,Ao),ee("gggg",Oo,Ao),ee("GGGGG",Do,So),ee("ggggg",Do,So),se(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,n){t[n.substr(0,2)]=X(e)}),se(["gg","GG"],function(e,i,n,o){i[o]=t.parseTwoDigitYear(e)}),N("Q",0,"Qo","quarter"),q("quarter","Q"),Y("quarter",7),ee("Q",To),oe("Q",function(e,t){t[Uo]=3*(X(e)-1)}),N("D",["DD",2],"Do","date"),q("date","D"),Y("date",9),ee("D",Eo),ee("DD",Eo,Co),ee("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),oe(["D","DD"],Yo),oe("Do",function(e,t){t[Yo]=X(e.match(Eo)[0])});var Fs=Q("Date",!0);N("DDD",["DDDD",3],"DDDo","dayOfYear"),q("dayOfYear","DDD"),Y("dayOfYear",4),ee("DDD",No),ee("DDDD",Io),oe(["DDD","DDDD"],function(e,t,i){i._dayOfYear=X(e)}),N("m",["mm",2],0,"minute"),q("minute","m"),Y("minute",14),ee("m",Eo),ee("mm",Eo,Co),oe(["m","mm"],jo);var zs=Q("Minutes",!1);N("s",["ss",2],0,"second"),q("second","s"),Y("second",15),ee("s",Eo),ee("ss",Eo,Co),oe(["s","ss"],Vo);var Hs=Q("Seconds",!1);N("S",0,0,function(){return~~(this.millisecond()/100)}),N(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),N(0,["SSS",3],0,"millisecond"),N(0,["SSSS",4],0,function(){return 10*this.millisecond()}),N(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),N(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),N(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),N(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),N(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),q("millisecond","ms"),Y("millisecond",16),ee("S",No,To),ee("SS",No,Co),ee("SSS",No,Io);var qs,Ws;for(qs="SSSS";qs.length<=9;qs+="S")ee(qs,Ro);for(qs="S";qs.length<=9;qs+="S")oe(qs,wn);Ws=Q("Milliseconds",!1),N("z",0,0,"zoneAbbr"),N("zz",0,0,"zoneName");var Us=b.prototype;Us.add=Ns,Us.calendar=pi,Us.clone=mi,Us.diff=wi,Us.endOf=ki,Us.format=Ai,Us.from=Si,Us.fromNow=Ei,Us.to=xi,Us.toNow=Li,Us.get=Z,Us.invalidAt=ji,Us.isAfter=fi,Us.isBefore=gi,Us.isBetween=_i,Us.isSame=vi,Us.isSameOrAfter=yi,Us.isSameOrBefore=bi,Us.isValid=Yi,Us.lang=Ds,Us.locale=Ni,Us.localeData=Oi,Us.max=Is,Us.min=Cs,Us.parsingFlags=Gi,Us.set=$,Us.startOf=Bi,Us.subtract=Os,Us.toArray=qi,Us.toObject=Wi,Us.toDate=Hi,Us.toISOString=Ci,Us.inspect=Ii,"undefined"!=typeof Symbol&&null!=Symbol["for"]&&(Us[Symbol["for"]("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Us.toJSON=Ui,Us.toString=Ti,Us.unix=zi,Us.valueOf=Fi,Us.creationData=Vi,Us.eraName=Ji,Us.eraNarrow=Zi,Us.eraAbbr=$i,Us.eraYear=en,Us.year=is,Us.isLeapYear=be,Us.weekYear=dn,Us.isoWeekYear=hn,Us.quarter=Us.quarters=yn,Us.month=me,Us.daysInMonth=fe,Us.week=Us.weeks=Le,Us.isoWeek=Us.isoWeeks=Ne,Us.weeksInYear=fn,Us.weeksInWeekYear=gn,Us.isoWeeksInYear=pn,Us.isoWeeksInISOWeekYear=mn,Us.date=Fs,Us.day=Us.days=He,Us.weekday=qe,Us.isoWeekday=We,Us.dayOfYear=bn,Us.hour=Us.hours=hs,Us.minute=Us.minutes=zs,Us.second=Us.seconds=Hs,Us.millisecond=Us.milliseconds=Ws,Us.utcOffset=Yt,Us.utc=jt,Us.local=Vt,Us.parseZone=Xt,Us.hasAlignedHourOffset=Qt,Us.isDST=Kt,Us.isLocal=Zt,Us.isUtcOffset=$t,Us.isUtc=ei,Us.isUTC=ei,Us.zoneAbbr=Mn,Us.zoneName=Tn,Us.dates=T("dates accessor is deprecated. Use date instead.",Fs),Us.months=T("months accessor is deprecated. Use month instead",me),Us.years=T("years accessor is deprecated. Use year instead",is),Us.zone=T("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Gt),Us.isDSTShifted=T("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Jt);var Ys=E.prototype;Ys.calendar=x,Ys.longDateFormat=B,Ys.invalidDate=k,Ys.ordinal=F,Ys.preparse=An,Ys.postformat=An,Ys.relativeTime=z,Ys.pastFuture=H,Ys.set=A,Ys.eras=Xi,Ys.erasParse=Qi,
Ys.erasConvertYear=Ki,Ys.erasAbbrRegex=nn,Ys.erasNameRegex=tn,Ys.erasNarrowRegex=on,Ys.months=ce,Ys.monthsShort=ue,Ys.monthsParse=he,Ys.monthsRegex=_e,Ys.monthsShortRegex=ge,Ys.week=Se,Ys.firstDayOfYear=xe,Ys.firstDayOfWeek=Ee,Ys.weekdays=Pe,Ys.weekdaysMin=ke,Ys.weekdaysShort=Be,Ys.weekdaysParse=ze,Ys.weekdaysRegex=Ue,Ys.weekdaysShortRegex=Ye,Ys.weekdaysMinRegex=Ge,Ys.isPM=Je,Ys.meridiem=Ze,nt("en",{eras:[{since:"0001-01-01",until:+(1/0),offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-(1/0),offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=1===X(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),t.lang=T("moment.lang is deprecated. Use moment.locale instead.",nt),t.langData=T("moment.langData is deprecated. Use moment.localeData instead.",at);var Gs=Math.abs,js=Gn("ms"),Vs=Gn("s"),Xs=Gn("m"),Qs=Gn("h"),Ks=Gn("d"),Js=Gn("w"),Zs=Gn("M"),$s=Gn("Q"),ea=Gn("y"),ta=Xn("milliseconds"),ia=Xn("seconds"),na=Xn("minutes"),oa=Xn("hours"),sa=Xn("days"),aa=Xn("months"),ra=Xn("years"),la=Math.round,ca={ss:44,s:45,m:45,h:22,d:26,w:null,M:11},ua=Math.abs,da=Bt.prototype;
//! moment.js
return da.isValid=Rt,da.abs=Pn,da.add=kn,da.subtract=Fn,da.as=Un,da.asMilliseconds=js,da.asSeconds=Vs,da.asMinutes=Xs,da.asHours=Qs,da.asDays=Ks,da.asWeeks=Js,da.asMonths=Zs,da.asQuarters=$s,da.asYears=ea,da.valueOf=Yn,da._bubble=Hn,da.clone=jn,da.get=Vn,da.milliseconds=ta,da.seconds=ia,da.minutes=na,da.hours=oa,da.days=sa,da.weeks=Qn,da.months=aa,da.years=ra,da.humanize=eo,da.toISOString=io,da.toString=io,da.toJSON=io,da.locale=Ni,da.localeData=Oi,da.toIsoString=T("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",io),da.lang=Ds,N("X",0,0,"unix"),N("x",0,0,"valueOf"),ee("x",Po),ee("X",Fo),oe("X",function(e,t,i){i._d=new Date(1e3*parseFloat(e))}),oe("x",function(e,t,i){i._d=new Date(X(e))}),t.version="2.26.0",o(xt),t.fn=Us,t.min=Nt,t.max=Ot,t.now=As,t.utc=m,t.unix=Cn,t.months=Ln,t.isDate=d,t.locale=nt,t.invalid=v,t.duration=ti,t.isMoment=w,t.weekdays=On,t.parseZone=In,t.localeData=at,t.isDuration=kt,t.monthsShort=Nn,t.weekdaysMin=Rn,t.defineLocale=ot,t.updateLocale=st,t.locales=rt,t.weekdaysShort=Dn,t.normalizeUnits=W,t.relativeTimeRounding=Zn,t.relativeTimeThreshold=$n,t.calendarFormat=hi,t.prototype=Us,t.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},t})}).call(t,i(34)(e))},function(e,t,i){function n(e){return i(o(e))}function o(e){return s[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var s={"./af":49,"./af.js":49,"./ar":50,"./ar-dz":51,"./ar-dz.js":51,"./ar-kw":52,"./ar-kw.js":52,"./ar-ly":53,"./ar-ly.js":53,"./ar-ma":54,"./ar-ma.js":54,"./ar-sa":55,"./ar-sa.js":55,"./ar-tn":56,"./ar-tn.js":56,"./ar.js":50,"./az":57,"./az.js":57,"./be":58,"./be.js":58,"./bg":59,"./bg.js":59,"./bm":60,"./bm.js":60,"./bn":61,"./bn.js":61,"./bo":62,"./bo.js":62,"./br":63,"./br.js":63,"./bs":64,"./bs.js":64,"./ca":65,"./ca.js":65,"./cs":66,"./cs.js":66,"./cv":67,"./cv.js":67,"./cy":68,"./cy.js":68,"./da":69,"./da.js":69,"./de":70,"./de-at":71,"./de-at.js":71,"./de-ch":72,"./de-ch.js":72,"./de.js":70,"./dv":73,"./dv.js":73,"./el":74,"./el.js":74,"./en-au":75,"./en-au.js":75,"./en-ca":76,"./en-ca.js":76,"./en-gb":77,"./en-gb.js":77,"./en-ie":78,"./en-ie.js":78,"./en-il":79,"./en-il.js":79,"./en-in":80,"./en-in.js":80,"./en-nz":81,"./en-nz.js":81,"./en-sg":82,"./en-sg.js":82,"./eo":83,"./eo.js":83,"./es":84,"./es-do":85,"./es-do.js":85,"./es-us":86,"./es-us.js":86,"./es.js":84,"./et":87,"./et.js":87,"./eu":88,"./eu.js":88,"./fa":89,"./fa.js":89,"./fi":90,"./fi.js":90,"./fil":91,"./fil.js":91,"./fo":92,"./fo.js":92,"./fr":93,"./fr-ca":94,"./fr-ca.js":94,"./fr-ch":95,"./fr-ch.js":95,"./fr.js":93,"./fy":96,"./fy.js":96,"./ga":97,"./ga.js":97,"./gd":98,"./gd.js":98,"./gl":99,"./gl.js":99,"./gom-deva":100,"./gom-deva.js":100,"./gom-latn":101,"./gom-latn.js":101,"./gu":102,"./gu.js":102,"./he":103,"./he.js":103,"./hi":104,"./hi.js":104,"./hr":105,"./hr.js":105,"./hu":106,"./hu.js":106,"./hy-am":107,"./hy-am.js":107,"./id":108,"./id.js":108,"./is":109,"./is.js":109,"./it":110,"./it-ch":111,"./it-ch.js":111,"./it.js":110,"./ja":112,"./ja.js":112,"./jv":113,"./jv.js":113,"./ka":114,"./ka.js":114,"./kk":115,"./kk.js":115,"./km":116,"./km.js":116,"./kn":117,"./kn.js":117,"./ko":118,"./ko.js":118,"./ku":119,"./ku.js":119,"./ky":120,"./ky.js":120,"./lb":121,"./lb.js":121,"./lo":122,"./lo.js":122,"./lt":123,"./lt.js":123,"./lv":124,"./lv.js":124,"./me":125,"./me.js":125,"./mi":126,"./mi.js":126,"./mk":127,"./mk.js":127,"./ml":128,"./ml.js":128,"./mn":129,"./mn.js":129,"./mr":130,"./mr.js":130,"./ms":131,"./ms-my":132,"./ms-my.js":132,"./ms.js":131,"./mt":133,"./mt.js":133,"./my":134,"./my.js":134,"./nb":135,"./nb.js":135,"./ne":136,"./ne.js":136,"./nl":137,"./nl-be":138,"./nl-be.js":138,"./nl.js":137,"./nn":139,"./nn.js":139,"./oc-lnc":140,"./oc-lnc.js":140,"./pa-in":141,"./pa-in.js":141,"./pl":142,"./pl.js":142,"./pt":143,"./pt-br":144,"./pt-br.js":144,"./pt.js":143,"./ro":145,"./ro.js":145,"./ru":146,"./ru.js":146,"./sd":147,"./sd.js":147,"./se":148,"./se.js":148,"./si":149,"./si.js":149,"./sk":150,"./sk.js":150,"./sl":151,"./sl.js":151,"./sq":152,"./sq.js":152,"./sr":153,"./sr-cyrl":154,"./sr-cyrl.js":154,"./sr.js":153,"./ss":155,"./ss.js":155,"./sv":156,"./sv.js":156,"./sw":157,"./sw.js":157,"./ta":158,"./ta.js":158,"./te":159,"./te.js":159,"./tet":160,"./tet.js":160,"./tg":161,"./tg.js":161,"./th":162,"./th.js":162,"./tl-ph":163,"./tl-ph.js":163,"./tlh":164,"./tlh.js":164,"./tr":165,"./tr.js":165,"./tzl":166,"./tzl.js":166,"./tzm":167,"./tzm-latn":168,"./tzm-latn.js":168,"./tzm.js":167,"./ug-cn":169,"./ug-cn.js":169,"./uk":170,"./uk.js":170,"./ur":171,"./ur.js":171,"./uz":172,"./uz-latn":173,"./uz-latn.js":173,"./uz.js":172,"./vi":174,"./vi.js":174,"./x-pseudo":175,"./x-pseudo.js":175,"./yo":176,"./yo.js":176,"./zh-cn":177,"./zh-cn.js":177,"./zh-hk":178,"./zh-hk.js":178,"./zh-mo":179,"./zh-mo.js":179,"./zh-tw":180,"./zh-tw.js":180};n.keys=function(){return Object.keys(s)},n.resolve=o,e.exports=n,n.id=48},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(e){return/^nm$/i.test(e)},meridiem:function(e,t,i){return e<12?i?"vm":"VM":i?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",ss:"%d sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},o={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},s=function(e){return function(t,i,s,a){var r=n(t),l=o[e][n(t)];return 2===r&&(l=l[i?0:1]),l.replace(/%d/i,t)}},a=["","","","","","","","","","","",""],r=e.defineLocale("ar",{months:a,monthsShort:a,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:s("s"),ss:s("s"),m:s("m"),mm:s("m"),h:s("h"),hh:s("h"),d:s("d"),dd:s("d"),M:s("M"),MM:s("M"),y:s("y"),yy:s("y")},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:6,doy:12}});return r})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},i={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},n=function(e){return function(n,o,s,a){var r=t(n),l=i[e][t(n)];return 2===r&&(l=l[o?0:1]),l.replace(/%d/i,n)}},o=["","","","","","","","","","","",""],s=e.defineLocale("ar-dz",{months:o,monthsShort:o,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:n("s"),ss:n("s"),m:n("m"),mm:n("m"),h:n("h"),hh:n("h"),d:n("d"),dd:n("d"),M:n("M"),MM:n("M"),y:n("y"),yy:n("y")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:0,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ar-kw",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:12}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},i=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},n={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},o=function(e){return function(t,o,s,a){var r=i(t),l=n[e][i(t)];return 2===r&&(l=l[o?0:1]),l.replace(/%d/i,t)}},s=["","","","","","","","","","","",""],a=e.defineLocale("ar-ly",{months:s,monthsShort:s,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:o("s"),ss:o("s"),m:o("m"),mm:o("m"),h:o("h"),hh:o("h"),d:o("d"),dd:o("d"),M:o("M"),MM:o("M"),y:o("y"),yy:o("y")},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:6,doy:12}});return a})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"},i=e.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniy",ss:"%d saniy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec|shr|gndz|axam/,isPM:function(e){return/^(gndz|axam)$/.test(e)},meridiem:function(e,t,i){return e<4?"gec":e<12?"shr":e<17?"gndz":"axam"},dayOfMonthOrdinalParse:/\d{1,2}-(nc|inci|nci|nc|nc|uncu)/,ordinal:function(e){if(0===e)return e+"-nc";var i=e%10,n=e%100-i,o=e>=100?100:null;return e+(t[i]||t[n]||t[o])},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t){var i=e.split("_");return t%10===1&&t%100!==11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,n){var o={ss:i?"__":"__",mm:i?"__":"__",hh:i?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===n?i?"":"":"h"===n?i?"":"":e+" "+t(o[n],+e)}var n=e.defineLocale("be",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{format:"______".split("_"),standalone:"______".split("_"),isFormat:/\[ ?[] ?(?:|)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:i,mm:i,h:i,hh:i,d:"",dd:i,M:"",MM:i,y:"",yy:i},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,i){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e%10!==2&&e%10!==3||e%100===12||e%100===13?e+"-":e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,i=e%100;return 0===e?e+"-":0===i?e+"-":i>10&&i<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("bm",{months:"Zanwuyekalo_Fewuruyekalo_Marisikalo_Awirilikalo_Mkalo_Zuwnkalo_Zuluyekalo_Utikalo_Stanburukalo_kutburukalo_Nowanburukalo_Desanburukalo".split("_"),monthsShort:"Zan_Few_Mar_Awi_M_Zuw_Zul_Uti_St_ku_Now_Des".split("_"),weekdays:"Kari_Ntnn_Tarata_Araba_Alamisa_Juma_Sibiri".split("_"),weekdaysShort:"Kar_Nt_Tar_Ara_Ala_Jum_Sib".split("_"),weekdaysMin:"Ka_Nt_Ta_Ar_Al_Ju_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM [tile] D [san] YYYY",LLL:"MMMM [tile] D [san] YYYY [lr] HH:mm",LLLL:"dddd MMMM [tile] D [san] YYYY [lr] HH:mm"},calendar:{sameDay:"[Bi lr] LT",nextDay:"[Sini lr] LT",nextWeek:"dddd [don lr] LT",lastDay:"[Kunu lr] LT",lastWeek:"dddd [tmnen lr] LT",sameElse:"L"},relativeTime:{future:"%s kn",past:"a b %s b",s:"sanga dama dama",ss:"sekondi %d",m:"miniti kelen",mm:"miniti %d",h:"lr kelen",hh:"lr %d",d:"tile kelen",dd:"tile %d",M:"kalo kelen",MM:"kalo %d",y:"san kelen",yy:"san %d"},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("bo",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShortRegex:/^(\d{1,2})/,monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i){var n={mm:"munutenn",MM:"miz",dd:"devezh"};return e+" "+o(n[i],e)}function i(e){switch(n(e)){case 1:case 3:case 4:case 5:case 9:return e+" bloaz";default:return e+" vloaz"}}function n(e){return e>9?n(e%10):e}function o(e,t){return 2===t?s(e):e}function s(e){var t={m:"v",b:"v",d:"z"};return void 0===t[e.charAt(0)]?e:t[e.charAt(0)]+e.substring(1)}var a=[/^gen/i,/^c[\']hwe/i,/^meu/i,/^ebr/i,/^mae/i,/^(mez|eve)/i,/^gou/i,/^eos/i,/^gwe/i,/^her/i,/^du/i,/^ker/i],r=/^(genver|c[\']hwevrer|meurzh|ebrel|mae|mezheven|gouere|eost|gwengolo|here|du|kerzu|gen|c[\']hwe|meu|ebr|mae|eve|gou|eos|gwe|her|du|ker)/i,l=/^(genver|c[\']hwevrer|meurzh|ebrel|mae|mezheven|gouere|eost|gwengolo|here|du|kerzu)/i,c=/^(gen|c[\']hwe|meu|ebr|mae|eve|gou|eos|gwe|her|du|ker)/i,u=[/^sul/i,/^lun/i,/^meurzh/i,/^merc[\']her/i,/^yaou/i,/^gwener/i,/^sadorn/i],d=[/^Sul/i,/^Lun/i,/^Meu/i,/^Mer/i,/^Yao/i,/^Gwe/i,/^Sad/i],h=[/^Su/i,/^Lu/i,/^Me([^r]|$)/i,/^Mer/i,/^Ya/i,/^Gw/i,/^Sa/i],p=e.defineLocale("br",{months:"Genver_Chwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_Chwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Mercher_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParse:h,fullWeekdaysParse:u,shortWeekdaysParse:d,minWeekdaysParse:h,monthsRegex:r,monthsShortRegex:r,monthsStrictRegex:l,monthsShortStrictRegex:c,monthsParse:a,longMonthsParse:a,shortMonthsParse:a,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY HH:mm",LLLL:"dddd, D [a viz] MMMM YYYY HH:mm"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warchoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dech da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s zo",s:"un nebeud segondenno",ss:"%d eilenn",m:"ur vunutenn",mm:t,h:"un eur",hh:"%d eur",d:"un devezh",dd:t,M:"ur miz",MM:t,y:"ur bloaz",yy:i},dayOfMonthOrdinalParse:/\d{1,2}(a|vet)/,ordinal:function(e){var t=1===e?"a":"vet";return e+t},week:{dow:1,doy:4},meridiemParse:/a.m.|g.m./,isPM:function(e){return"g.m."===e},meridiem:function(e,t,i){return e<12?"a.m.":"g.m."}});return p})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i){var n=e+" ";switch(i){case"ss":return n+=1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi";case"m":return t?"jedna minuta":"jedne minute";case"mm":return n+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return n+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return n+=1===e?"dan":"dana";case"MM":return n+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return n+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}var i=e.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ca",{months:{standalone:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de mar_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dt_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",ss:"%d segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(e,t){var i=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"";return"w"!==t&&"W"!==t||(i="a"),e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e){return e>1&&e<5&&1!==~~(e/10)}function i(e,i,n,o){var s=e+" ";switch(n){case"s":return i||o?"pr sekund":"pr sekundami";case"ss":return i||o?s+(t(e)?"sekundy":"sekund"):s+"sekundami";case"m":return i?"minuta":o?"minutu":"minutou";case"mm":return i||o?s+(t(e)?"minuty":"minut"):s+"minutami";case"h":return i?"hodina":o?"hodinu":"hodinou";case"hh":return i||o?s+(t(e)?"hodiny":"hodin"):s+"hodinami";case"d":return i||o?"den":"dnem";case"dd":return i||o?s+(t(e)?"dny":"dn"):s+"dny";case"M":return i||o?"msc":"mscem";case"MM":return i||o?s+(t(e)?"msce":"msc"):s+"msci";case"y":return i||o?"rok":"rokem";case"yy":return i||o?s+(t(e)?"roky":"let"):s+"lety"}}
//! moment.js locale configuration
var n="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),o="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_"),s=[/^led/i,/^no/i,/^be/i,/^dub/i,/^kv/i,/^(vn|erven$|ervna)/i,/^(vc|ervenec|ervence)/i,/^srp/i,/^z/i,/^j/i,/^lis/i,/^pro/i],a=/^(leden|nor|bezen|duben|kvten|ervenec|ervence|erven|ervna|srpen|z|jen|listopad|prosinec|led|no|be|dub|kv|vn|vc|srp|z|j|lis|pro)/i,r=e.defineLocale("cs",{months:n,monthsShort:o,monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(leden|ledna|nora|nor|bezen|bezna|duben|dubna|kvten|kvtna|ervenec|ervence|erven|ervna|srpen|srpna|z|jen|jna|listopadu|listopad|prosinec|prosince)/i,monthsShortStrictRegex:/^(led|no|be|dub|kv|vn|vc|srp|z|j|lis|pro)/i,monthsParse:s,longMonthsParse:s,shortMonthsParse:s,weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:i,ss:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return r})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(e){var t=/$/i.exec(e)?"":/$/i.exec(e)?"":"";return e+t},past:"%s ",s:"- ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-/,ordinal:"%d-",week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",ss:"%d eiliad",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(e){var t=e,i="",n=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return t>20?i=40===t||50===t||60===t||80===t||100===t?"fed":"ain":t>0&&(i=n[t]),e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"p dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",ss:"%d sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[i][0]:o[i][1]}var i=e.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[i][0]:o[i][1]}var i=e.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){var o={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?o[i][0]:o[i][1]}var i=e.defineLocale("de-ch",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=["","","","","","","","","","","",""],i=["","","","","","",""],n=e.defineLocale("dv",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"d% ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:7,doy:12}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}var i=e.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(e,t){return e?"string"==typeof t&&/D/.test(t.substring(0,t.indexOf("MMMM")))?this._monthsGenitiveEl[e.month()]:this._monthsNominativeEl[e.month()]:this._monthsNominativeEl},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(e,t,i){return e>11?i?"":"":i?"":""},isPM:function(e){return""===(e+"").toLowerCase()[0]},meridiemParse:/[]\.??\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[ ] dddd [{}] LT";default:return"[ ] dddd [{}] LT"}},sameElse:"L"},calendar:function(e,i){var n=this._calendarEl[e],o=i&&i.hours();return t(n)&&(n=n.apply(i)),n.replace("{}",o%12===1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:0,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("en-il",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("en-in",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:0,doy:6}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("en-sg",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mart_apr_maj_jun_jul_ag_sept_okt_nov_dec".split("_"),weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"[la] D[-an de] MMMM, YYYY",LLL:"[la] D[-an de] MMMM, YYYY HH:mm",LLLL:"dddd[n], [la] D[-an de] MMMM, YYYY HH:mm",llll:"ddd, [la] D[-an de] MMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(e){return"p"===e.charAt(0).toLowerCase()},meridiem:function(e,t,i){return e>11?i?"p.t.m.":"P.T.M.":i?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd[n je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasintan] dddd[n je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"anta %s",s:"kelkaj sekundoj",ss:"%d sekundoj",m:"unu minuto",mm:"%d minutoj",h:"unu horo",hh:"%d horoj",d:"unu tago",dd:"%d tagoj",M:"unu monato",MM:"%d monatoj",y:"unu jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),i="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),n=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],o=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,s=e.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4},invalidDate:"Fecha invalida"});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),i="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),n=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],o=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,s=e.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),i="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),n=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],o=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,s=e.defineLocale("es-us",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"MM/DD/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:0,doy:6}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){var o={s:["mne sekundi","mni sekund","paar sekundit"],ss:[e+"sekundi",e+"sekundit"],m:["he minuti","ks minut"],mm:[e+" minuti",e+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[e+" tunni",e+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[e+" kuu",e+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[e+" aasta",e+" aastat"]};return t?o[i][2]?o[i][2]:o[i][1]:n?o[i][0]:o[i][1]}var i=e.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:"%d peva",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",ss:"%d segundo",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/  |  /,isPM:function(e){return/  /.test(e)},meridiem:function(e,t,i){return e<12?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[-]/g,function(e){return i[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:6,doy:12}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e,t,n,o){var s="";switch(n){case"s":return o?"muutaman sekunnin":"muutama sekunti";case"ss":return o?"sekunnin":"sekuntia";case"m":return o?"minuutin":"minuutti";case"mm":s=o?"minuutin":"minuuttia";break;case"h":return o?"tunnin":"tunti";case"hh":s=o?"tunnin":"tuntia";break;case"d":return o?"pivn":"piv";case"dd":s=o?"pivn":"piv";break;case"M":return o?"kuukauden":"kuukausi";case"MM":s=o?"kuukauden":"kuukautta";break;case"y":return o?"vuoden":"vuosi";case"yy":s=o?"vuoden":"vuotta"}return s=i(e,o)+" "+s}function i(e,t){return e<10?t?o[e]:n[e]:e}
//! moment.js locale configuration
var n="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),o=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",n[7],n[8],n[9]],s=e.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("fil",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",ss:"%d sekundir",m:"ein minuttur",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnaur",MM:"%d mnair",y:"eitt r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,t){switch(t){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("fr-ch",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),i="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),n=e.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",ss:"%d sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=["Eanir","Feabhra","Mrta","Aibren","Bealtaine","Meitheamh","Iil","Lnasa","Men Fmhair","Deireadh Fmhair","Samhain","Nollaig"],i=["Ean","Feabh","Mrt","Aib","Beal","Meith","Iil","Ln","M.F.","D.F.","Samh","Noll"],n=["D Domhnaigh","D Luain","D Mirt","D Cadaoin","Dardaoin","D hAoine","D Sathairn"],o=["Domh","Luan","Mirt","Cad","Dar","Aoine","Sath"],s=["Do","Lu","M","C","D","A","Sa"],a=e.defineLocale("ga",{months:t,monthsShort:i,monthsParseExact:!0,weekdays:n,weekdaysShort:o,weekdaysMin:s,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Inniu ag] LT",nextDay:"[Amrach ag] LT",nextWeek:"dddd [ag] LT",lastDay:"[Inn ag] LT",lastWeek:"dddd [seo caite] [ag] LT",sameElse:"L"},relativeTime:{future:"i %s",past:"%s  shin",s:"cpla soicind",ss:"%d soicind",m:"nimad",mm:"%d nimad",h:"uair an chloig",hh:"%d uair an chloig",d:"l",dd:"%d l",M:"m",MM:"%d monna",y:"bliain",yy:"%d bliain"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){var t=1===e?"d":e%10===2?"na":"mh";return e+t},week:{dow:1,doy:4}});return a})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=["Am Faoilleach","An Gearran","Am Mrt","An Giblean","An Citean","An t-gmhios","An t-Iuchar","An Lnastal","An t-Sultain","An Dmhair","An t-Samhain","An Dbhlachd"],i=["Faoi","Gear","Mrt","Gibl","Cit","gmh","Iuch","Ln","Sult","Dmh","Samh","Dbh"],n=["Didmhnaich","Diluain","Dimirt","Diciadain","Diardaoin","Dihaoine","Disathairne"],o=["Did","Dil","Dim","Dic","Dia","Dih","Dis"],s=["D","Lu","M","Ci","Ar","Ha","Sa"],a=e.defineLocale("gd",{months:t,monthsShort:i,monthsParseExact:!0,weekdays:n,weekdaysShort:o,weekdaysMin:s,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-mireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-d aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",ss:"%d diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mos",MM:"%d mosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){var t=1===e?"d":e%10===2?"na":"mh";return e+t},week:{dow:1,doy:4}});return a})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuo_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xu._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mrcores_xoves_venres_sbado".split("_"),weekdaysShort:"dom._lun._mar._mr._xov._ven._sb.".split("_"),weekdaysMin:"do_lu_ma_m_xo_ve_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(e){return 0===e.indexOf("un")?"n"+e:"en "+e},past:"hai %s",s:"uns segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){var o={s:[" "," "],ss:[e+" ",e+" "],m:[" "," "],mm:[e+" ",e+" "],h:[" "," "],hh:[e+" ",e+" "],d:[" "," "],dd:[e+" ",e+" "],M:[" "," "],MM:[e+" ",e+" "],y:[" "," "],yy:[e+" ",e+" "]};return n?o[i][0]:o[i][1]}var i=e.defineLocale("gom-deva",{months:{standalone:"___________".split("_"),format:"___________".split("_"),isFormat:/MMMM(\s)+D[oD]?/},monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm []",LTS:"A h:mm:ss []",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm []",LLLL:"dddd, MMMM Do, YYYY, A h:mm []",llll:"ddd, D MMM YYYY, A h:mm []"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(e,t){switch(t){case"D":return e+"";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return e}},week:{dow:1,doy:4},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>12?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<12?"":e<16?"":e<20?"":""}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){var o={s:["thoddea sekondamni","thodde sekond"],ss:[e+" sekondamni",e+" sekond"],m:["eka mintan","ek minut"],mm:[e+" mintamni",e+" mintam"],h:["eka voran","ek vor"],hh:[e+" voramni",e+" voram"],d:["eka disan","ek dis"],dd:[e+" disamni",e+" dis"],M:["eka mhoinean","ek mhoino"],MM:[e+" mhoineamni",e+" mhoine"],y:["eka vorsan","ek voros"],yy:[e+" vorsamni",e+" vorsam"]};return n?o[i][0]:o[i][1]}var i=e.defineLocale("gom-latn",{months:{standalone:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),format:"Janerachea_Febrerachea_Marsachea_Abrilachea_Maiachea_Junachea_Julaiachea_Agostachea_Setembrachea_Otubrachea_Novembrachea_Dezembrachea".split("_"),isFormat:/MMMM(\s)+D[oD]?/},monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budhvar_Birestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Fuddlo] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fattlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(e,t){switch(t){case"D":return e+"er";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return e}},week:{dow:1,doy:4},meridiemParse:/rati|sokallim|donparam|sanje/,meridiemHour:function(e,t){return 12===e&&(e=0),"rati"===t?e<4?e:e+12:"sokallim"===t?e:"donparam"===t?e>12?e:e+12:"sanje"===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"rati":e<12?"sokallim":e<16?"donparam":e<20?"sanje":"rati"}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("gu",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:function(e){return 2===e?"":e+" "},d:"",dd:function(e){return 2===e?"":e+" "},M:"",MM:function(e){return 2===e?"":e+" "},y:"",yy:function(e){return 2===e?"":e%10===0&&10!==e?e+" ":e+" "}},meridiemParse:/"|"| | | ||/i,isPM:function(e){return/^("| |)$/.test(e)},meridiem:function(e,t,i){return e<5?" ":e<10?"":e<12?i?'"':" ":e<18?i?'"':" ":""}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i){var n=e+" ";switch(i){case"ss":return n+=1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi";case"m":return t?"jedna minuta":"jedne minute";case"mm":return n+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return n+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return n+=1===e?"dan":"dana";case"MM":return n+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return n+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}var i=e.defineLocale("hr",{months:{format:"sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"Do MMMM YYYY",LLL:"Do MMMM YYYY H:mm",LLLL:"dddd, Do MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:return"[prolu] [nedjelju] [u] LT";case 3:return"[prolu] [srijedu] [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e,t,i,n){var o=e;switch(i){case"s":return n||t?"nhny msodperc":"nhny msodperce";case"ss":return o+(n||t)?" msodperc":" msodperce";case"m":return"egy"+(n||t?" perc":" perce");case"mm":return o+(n||t?" perc":" perce");case"h":return"egy"+(n||t?" ra":" rja");case"hh":return o+(n||t?" ra":" rja");case"d":return"egy"+(n||t?" nap":" napja");case"dd":return o+(n||t?" nap":" napja");case"M":return"egy"+(n||t?" hnap":" hnapja");case"MM":return o+(n||t?" hnap":" hnapja");case"y":return"egy"+(n||t?" v":" ve");case"yy":return o+(n||t?" v":" ve")}return""}function i(e){return(e?"":"[mlt] ")+"["+n[this.day()]+"] LT[-kor]"}
//! moment.js locale configuration
var n="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" "),o=e.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(e){return"u"===e.charAt(1).toLowerCase()},meridiem:function(e,t,i){return e<12?i===!0?"de":"DE":i===!0?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return i.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return i.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return o})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("hy-am",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"DDD":case"w":case"W":case"DDDo":return 1===e?e+"-":e+"-";default:return e}},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"siang"===t?e>=11?e:e+12:"sore"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"siang":e<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",ss:"%d detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:0,doy:6}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e){return e%100===11||e%10!==1}function i(e,i,n,o){var s=e+" ";switch(n){case"s":return i||o?"nokkrar sekndur":"nokkrum sekndum";case"ss":return t(e)?s+(i||o?"sekndur":"sekndum"):s+"seknda";case"m":return i?"mnta":"mntu";case"mm":return t(e)?s+(i||o?"mntur":"mntum"):i?s+"mnta":s+"mntu";case"hh":return t(e)?s+(i||o?"klukkustundir":"klukkustundum"):s+"klukkustund";case"d":return i?"dagur":o?"dag":"degi";case"dd":return t(e)?i?s+"dagar":s+(o?"daga":"dgum"):i?s+"dagur":s+(o?"dag":"degi");case"M":return i?"mnuur":o?"mnu":"mnui";case"MM":return t(e)?i?s+"mnuir":s+(o?"mnui":"mnuum"):i?s+"mnuur":s+(o?"mnu":"mnui");case"y":return i||o?"r":"ri";case"yy":return t(e)?s+(i||o?"r":"rum"):s+(i||o?"r":"ri")}}var n=e.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:i,ss:i,m:i,mm:i,h:"klukkustund",hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:function(){return"[Oggi a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"},nextDay:function(){return"[Domani a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"},nextWeek:function(){return"dddd [a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"},lastDay:function(){return"[Ieri a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"},lastWeek:function(){switch(this.day()){case 0:return"[La scorsa] dddd [a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT";default:return"[Lo scorso] dddd [a"+(this.hours()>1?"lle ":0===this.hours()?" ":"ll'")+"]LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("it-ch",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ja",{eras:[{since:"2019-05-01",offset:1,name:"",narrow:"",abbr:"R"},{since:"1989-01-08",until:"2019-04-30",offset:1,name:"",narrow:"",abbr:"H"},{since:"1926-12-25",until:"1989-01-07",offset:1,name:"",narrow:"",abbr:"S"},{since:"1912-07-30",until:"1926-12-24",offset:1,name:"",narrow:"",abbr:"T"},{since:"1873-01-01",until:"1912-07-29",offset:6,name:"",narrow:"",abbr:"M"},{since:"0001-01-01",until:"1873-12-31",offset:1,name:"",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-(1/0),offset:1,name:"",narrow:"BC",abbr:"BC"}],eraYearOrdinalRegex:/(|\d+)/,eraYearOrdinalParse:function(e,t){return""===t[1]?1:parseInt(t[1]||e,10)},months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD(ddd) HH:mm"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:function(e){return e.week()!==this.week()?"[]dddd LT":"dddd LT"},lastDay:"[] LT",lastWeek:function(e){return this.week()!==e.week()?"[]dddd LT":"dddd LT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e,t){switch(t){case"y":return 1===e?"":e+"";case"d":case"D":case"DDD":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(e,t){return 12===e&&(e=0),"enjing"===t?e:"siyang"===t?e>=11?e:e+12:"sonten"===t||"ndalu"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"enjing":e<15?"siyang":e<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",ss:"%d detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ka",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/(|)/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(e){return e.replace(/(|||||)(|)/,function(e,t,i){return""===i?t+"":t+i+""})},past:function(e){return/(||||)/.test(e)?e.replace(/(|)$/," ")://.test(e)?e.replace(/$/," "):e},s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/0|1-|-\d{1,2}|\d{1,2}-/,ordinal:function(e){return 0===e?e:1===e?e+"-":e<20||e<=100&&e%20===0||e%100===0?"-"+e:e+"-"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"},i=e.defineLocale("kk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){var i=e%10,n=e>=100?100:null;return e+(t[e]||t[i]||t[n])},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("km",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("kn",{months:"___________".split("_"),monthsShort:"___________".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(e){return e+""},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=[" ","","","","","","","",""," "," "," "],o=e.defineLocale("ku",{months:n,monthsShort:n,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return//.test(e)},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:" ",ss:" %d",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:6,doy:12}});return o})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"},i=e.defineLocale("ky",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||)/,ordinal:function(e){var i=e%10,n=e>=100?100:null;return e+(t[e]||t[i]||t[n])},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){var o={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return t?o[i][0]:o[i][1]}function i(e){var t=e.substr(0,e.indexOf(" "));return o(t)?"a "+e:"an "+e}function n(e){var t=e.substr(0,e.indexOf(" "));return o(t)?"viru "+e:"virun "+e}function o(e){if(e=parseInt(e,10),isNaN(e))return!1;if(e<0)return!0;if(e<10)return 4<=e&&e<=7;if(e<100){var t=e%10,i=e/10;return o(0===t?i:t)}if(e<1e4){for(;e>=10;)e/=10;return o(e)}return e/=1e3,o(e)}var s=e.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:i,past:n,s:"e puer Sekonnen",ss:"%d Sekonnen",m:t,mm:"%d Minutten",h:t,hh:"%d Stonnen",d:t,dd:"%d Deeg",M:t,MM:"%d Mint",y:t,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("lo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd[] LT",lastDay:"[] LT",lastWeek:"[]dddd[] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},dayOfMonthOrdinalParse:/()\d{1,2}/,ordinal:function(e){return""+e}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e,t,i,n){return t?"kelios sekunds":n?"keli sekundi":"kelias sekundes"}function i(e,t,i,n){return t?o(i)[0]:n?o(i)[1]:o(i)[2]}function n(e){return e%10===0||e>10&&e<20}function o(e){return a[e].split("_")}function s(e,t,s,a){var r=e+" ";return 1===e?r+i(e,t,s[0],a):t?r+(n(e)?o(s)[1]:o(s)[0]):a?r+o(s)[1]:r+(n(e)?o(s)[1]:o(s)[2])}
//! moment.js locale configuration
var a={ss:"sekund_sekundi_sekundes",m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"},r=e.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadien_pirmadien_antradien_treiadien_ketvirtadien_penktadien_etadien".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:t,ss:s,m:i,mm:s,h:i,hh:s,d:i,dd:s,M:i,MM:s,y:i,yy:s},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(e){return e+"-oji"},week:{dow:1,doy:4}});return r})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e,t,i){return i?t%10===1&&t%100!==11?e[2]:e[3]:t%10===1&&t%100!==11?e[0]:e[1]}function i(e,i,n){return e+" "+t(s[n],e,i)}function n(e,i,n){return t(s[n],e,i)}function o(e,t){return t?"daas sekundes":"dam sekundm"}
//! moment.js locale configuration
var s={ss:"sekundes_sekundm_sekunde_sekundes".split("_"),m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")},a=e.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:o,ss:i,m:n,mm:i,h:n,hh:i,d:n,dd:i,M:n,MM:i,y:n,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return a})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={words:{ss:["sekund","sekunda","sekundi"],m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,n){var o=t.words[n];return 1===n.length?i?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}},i=e.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){var e=["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"];return e[this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mjesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("mi",{months:"Kohi-tte_Hui-tanguru_Pout-te-rangi_Paenga-whwh_Haratua_Pipiri_Hngoingoi_Here-turi-kk_Mahuru_Whiringa--nuku_Whiringa--rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rtapu_Mane_Trei_Wenerei_Tite_Paraire_Htarei".split("_"),weekdaysShort:"Ta_Ma_T_We_Ti_Pa_H".split("_"),weekdaysMin:"Ta_Ma_T_We_Ti_Pa_H".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hkona ruarua",ss:"%d hkona",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,i=e%100;return 0===e?e+"-":0===i?e+"-":i>10&&i<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|| ||/i,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||" "===t||""===t?e+12:e},meridiem:function(e,t,i){return e<4?"":e<12?"":e<17?" ":e<20?"":""}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){switch(i){case"s":return t?" ":" ";case"ss":return e+(t?" ":" ");case"m":case"mm":return e+(t?" ":" ");case"h":case"hh":return e+(t?" ":" ");case"d":case"dd":return e+(t?" ":" ");case"M":case"MM":return e+(t?" ":" ");case"y":case"yy":return e+(t?" ":" ");default:return e}}var i=e.defineLocale("mn",{months:" _ _ _ _ _ _ _ _ _ _  _  ".split("_"),monthsShort:"1 _2 _3 _4 _5 _6 _7 _8 _9 _10 _11 _12 ".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY  MMMM D",LLL:"YYYY  MMMM D HH:mm",LLLL:"dddd, YYYY  MMMM D HH:mm"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+" ";default:return e}}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e,t,i,n){var o="";if(t)switch(i){case"s":o=" ";break;case"ss":o="%d ";break;case"m":o=" ";break;case"mm":o="%d ";break;case"h":o=" ";break;case"hh":o="%d ";break;case"d":o=" ";break;case"dd":o="%d ";break;case"M":o=" ";break;case"MM":o="%d ";break;case"y":o=" ";break;case"yy":o="%d "}else switch(i){case"s":o=" ";break;case"ss":o="%d ";break;case"m":o=" ";break;case"mm":o="%d ";break;case"h":o=" ";break;case"hh":o="%d ";break;case"d":o=" ";break;case"dd":o="%d ";break;case"M":o=" ";break;case"MM":o="%d ";break;case"y":o=" ";break;case"yy":o="%d "}return o.replace(/%d/i,e)}
//! moment.js locale configuration
var i={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},o=e.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return i[e]})},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t?e:""===t||""===t||""===t?e>=12?e:e+12:void 0},meridiem:function(e,t,i){return e>=0&&e<6?"":e<12?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});return o})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,i){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("mt",{months:"Jannar_Frar_Marzu_April_Mejju_unju_Lulju_Awwissu_Settembru_Ottubru_Novembru_Diembru".split("_"),monthsShort:"Jan_Fra_Mar_Apr_Mej_un_Lul_Aww_Set_Ott_Nov_Di".split("_"),weekdays:"Il-add_It-Tnejn_It-Tlieta_L-Erbga_Il-amis_Il-imga_Is-Sibt".split("_"),weekdaysShort:"ad_Tne_Tli_Erb_am_im_Sib".split("_"),weekdaysMin:"a_Tn_Tl_Er_a_i_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Illum fil-]LT",nextDay:"[Gada fil-]LT",nextWeek:"dddd [fil-]LT",lastDay:"[Il-biera fil-]LT",lastWeek:"dddd [li gadda] [fil-]LT",sameElse:"L"},relativeTime:{future:"f %s",past:"%s ilu",s:"ftit sekondi",ss:"%d sekondi",m:"minuta",mm:"%d minuti",h:"siega",hh:"%d siegat",d:"urnata",dd:"%d ranet",M:"xahar",MM:"%d xhur",y:"sena",yy:"%d sni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_apr._mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",ss:"%d sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<3?"":e<12?"":e<16?"":e<20?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),i="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),n=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],o=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,s=e.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),i="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),n=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],o=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,s=e.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,n){return e?/-MMM-/.test(n)?i[e.month()]:t[e.month()]:t},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:n,longMonthsParse:n,shortMonthsParse:n,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_apr._mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"su._m._ty._on._to._fr._lau.".split("_"),weekdaysMin:"su_m_ty_on_to_fr_la".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",ss:"%d sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("oc-lnc",{months:{standalone:"genir_febrir_mar_abril_mai_junh_julhet_agost_setembre_octbre_novembre_decembre".split("_"),format:"de genir_de febrir_de mar_d'abril_de mai_de junh_de julhet_d'agost_de setembre_d'octbre_de novembre_de decembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._mai_junh_julh._ago._set._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"dimenge_diluns_dimars_dimcres_dijus_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dm._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dm_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:"[ui a] LT",nextDay:"[deman a] LT",nextWeek:"dddd [a] LT",lastDay:"[ir a] LT",lastWeek:"dddd [passat a] LT",sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"unas segondas",ss:"%d segondas",m:"una minuta",mm:"%d minutas",h:"una ora",hh:"%d oras",d:"un jorn",dd:"%d jorns",M:"un mes",MM:"%d meses",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(e,t){var i=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"";return"w"!==t&&"W"!==t||(i="a"),e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("pa-in",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e){return e%10<5&&e%10>1&&~~(e/10)%10!==1}function i(e,i,n){var o=e+" ";switch(n){case"ss":return o+(t(e)?"sekundy":"sekund");case"m":return i?"minuta":"minut";case"mm":return o+(t(e)?"minuty":"minut");case"h":return i?"godzina":"godzin";case"hh":return o+(t(e)?"godziny":"godzin");case"MM":return o+(t(e)?"miesice":"miesicy");case"yy":return o+(t(e)?"lata":"lat")}}
//! moment.js locale configuration
var n="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),o="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_"),s=e.defineLocale("pl",{months:function(e,t){return e?""===t?"("+o[e.month()]+"|"+n[e.month()]+")":/D MMMM/.test(t)?o[e.month()]:n[e.month()]:n},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:function(){switch(this.day()){case 0:return"[W niedziel o] LT";case 2:return"[We wtorek o] LT";case 3:return"[W rod o] LT";case 6:return"[W sobot o] LT";default:return"[W] dddd [o] LT"}},lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",ss:i,m:i,mm:i,h:i,hh:i,d:"1 dzie",dd:"%d dni",M:"miesic",MM:i,y:"rok",yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("pt",{months:"janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("pt-br",{months:"janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"domingo_segunda-feira_tera-feira_quarta-feira_quinta-feira_sexta-feira_sbado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sb".split("_"),weekdaysMin:"do_2_3_4_5_6_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"poucos segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d"});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i){var n={ss:"secunde",mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"},o=" ";return(e%100>=20||e>=100&&e%100===0)&&(o=" de "),e+o+n[i]}var i=e.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._feb._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",ss:t,m:"un minut",mm:t,h:"o or",hh:t,d:"o zi",dd:t,M:"o lun",MM:t,y:"un an",yy:t},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t){var i=e.split("_");return t%10===1&&t%100!==11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,n){var o={ss:i?"__":"__",mm:i?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===n?i?"":"":e+" "+t(o[n],+e)}var n=[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],o=e.defineLocale("ru",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:{format:"._._._.____._._._._.".split("_"),standalone:"._.__.____._._._._.".split("_")},weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/\[ ?[] ?(?:||)? ?] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:n,longMonthsParse:n,shortMonthsParse:n,monthsRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsShortRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsStrictRegex:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[])/i,monthsShortStrictRegex:/^(\.|?\.|[.]|\.|[]|[.]|[.]|\.|?\.|\.|?\.|\.)/i,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},calendar:{sameDay:"[, ] LT",nextDay:"[, ] LT",lastDay:"[, ] LT",nextWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:i,m:i,mm:i,h:"",hh:i,d:"",dd:i,M:"",MM:i,y:"",yy:i},meridiemParse:/|||/i,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,i){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":return e+"-";case"D":return e+"-";case"w":case"W":return e+"-";default:return e}},week:{dow:1,doy:4}});return o})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=["","","","","","","","","","","",""],i=["","","","","","",""],n=e.defineLocale("sd",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd [  ] LT",lastDay:"[] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("se",{months:"oajagemnnu_guovvamnnu_njukamnnu_cuoomnnu_miessemnnu_geassemnnu_suoidnemnnu_borgemnnu_akamnnu_golggotmnnu_skbmamnnu_juovlamnnu".split("_"),monthsShort:"oj_guov_njuk_cuo_mies_geas_suoi_borg_ak_golg_skb_juov".split("_"),weekdays:"sotnabeaivi_vuossrga_maebrga_gaskavahkku_duorastat_bearjadat_lvvardat".split("_"),weekdaysShort:"sotn_vuos_ma_gask_duor_bear_lv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geaes",past:"mait %s",s:"moadde sekunddat",ss:"%d sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mnnu",MM:"%d mnut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:" %d",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e){return e+" "},meridiemParse:/ | |.|../,isPM:function(e){return".."===e||" "===e},meridiem:function(e,t,i){return e>11?i?"..":" ":i?"..":" "}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e){return e>1&&e<5}function i(e,i,n,o){var s=e+" ";switch(n){case"s":return i||o?"pr seknd":"pr sekundami";case"ss":return i||o?s+(t(e)?"sekundy":"seknd"):s+"sekundami";case"m":return i?"minta":o?"mintu":"mintou";case"mm":return i||o?s+(t(e)?"minty":"mint"):s+"mintami";case"h":return i?"hodina":o?"hodinu":"hodinou";case"hh":return i||o?s+(t(e)?"hodiny":"hodn"):s+"hodinami";case"d":return i||o?"de":"dom";case"dd":return i||o?s+(t(e)?"dni":"dn"):s+"dami";case"M":return i||o?"mesiac":"mesiacom";case"MM":return i||o?s+(t(e)?"mesiace":"mesiacov"):s+"mesiacmi";case"y":return i||o?"rok":"rokom";case"yy":return i||o?s+(t(e)?"roky":"rokov"):s+"rokmi"}}
//! moment.js locale configuration
var n="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),o="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_"),s=e.defineLocale("sk",{months:n,monthsShort:o,weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:i,ss:i,m:i,mm:i,h:i,hh:i,d:i,dd:i,M:i,MM:i,y:i,yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t,i,n){var o=e+" ";switch(i){case"s":return t||n?"nekaj sekund":"nekaj sekundami";case"ss":return o+=1===e?t?"sekundo":"sekundi":2===e?t||n?"sekundi":"sekundah":e<5?t||n?"sekunde":"sekundah":"sekund";case"m":return t?"ena minuta":"eno minuto";case"mm":return o+=1===e?t?"minuta":"minuto":2===e?t||n?"minuti":"minutama":e<5?t||n?"minute":"minutami":t||n?"minut":"minutami";case"h":return t?"ena ura":"eno uro";case"hh":return o+=1===e?t?"ura":"uro":2===e?t||n?"uri":"urama":e<5?t||n?"ure":"urami":t||n?"ur":"urami";case"d":return t||n?"en dan":"enim dnem";case"dd":return o+=1===e?t||n?"dan":"dnem":2===e?t||n?"dni":"dnevoma":t||n?"dni":"dnevi";case"M":return t||n?"en mesec":"enim mesecem";case"MM":return o+=1===e?t||n?"mesec":"mesecem":2===e?t||n?"meseca":"mesecema":e<5?t||n?"mesece":"meseci":t||n?"mesecev":"meseci";case"y":return t||n?"eno leto":"enim letom";case"yy":return o+=1===e?t||n?"leto":"letom":2===e?t||n?"leti":"letoma":e<5?t||n?"leta":"leti":t||n?"let":"leti"}}var i=e.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(e){return"M"===e.charAt(0)},meridiem:function(e,t,i){return e<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",ss:"%d sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={words:{ss:["sekunda","sekunde","sekundi"],m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,n){var o=t.words[n];return 1===n.length?i?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}},i=e.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){var e=["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"];return e[this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={words:{ss:["","",""],m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,i,n){var o=t.words[n];return 1===n.length?i?o[0]:o[1]:e+" "+t.correctGrammaticalCase(e,o)}},i=e.defineLocale("sr-cyrl",{months:"___________".split("_"),monthsShort:"._._._.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){var e=["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"];return e[this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"",dd:t.translate,M:"",MM:t.translate,y:"",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",ss:"%d mzuzwana",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(e,t,i){return e<11?"ekuseni":e<15?"emini":e<19?"entsambama":"ebusuku"},meridiemHour:function(e,t){return 12===e&&(e=0),"ekuseni"===t?e:"emini"===t?e>=11?e:e+12:"entsambama"===t||"ebusuku"===t?0===e?0:e+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",ss:"%d sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}(\:e|\:a)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?":e":1===t?":a":2===t?":a":":e";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",ss:"sekunde %d",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"siku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},n=e.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e+""},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||||/,meridiem:function(e,t,i){return e<2?" ":e<6?" ":e<10?" ":e<14?" ":e<18?" ":e<22?" ":" "},meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<2?e:e+12:""===t||""===t?e:""===t&&e>=10?e:e+12},week:{dow:0,doy:6}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("te",{months:"___________".split("_"),monthsShort:"._.__.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juu_Jullu_Agustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sesta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sest_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Ses_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"segundu balun",ss:"segundu %d",m:"minutu ida",mm:"minutu %d",h:"oras ida",hh:"oras %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",12:"-",13:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"},i=e.defineLocale("tg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:"dddd[] [  ] LT",lastWeek:"dddd[] [  ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=11?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,i){return e<4?"":e<11?"":e<16?"":e<19?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){var i=e%10,n=e>=100?100:null;return e+(t[e]||t[i]||t[n])},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("th",{months:"___________".split("_"),monthsShort:".._.._.._.._.._.._.._.._.._.._.._..".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H:mm",LLLL:"dddd D MMMM YYYY  H:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e){var t=e;return t=e.indexOf("jaj")!==-1?t.slice(0,-3)+"leS":e.indexOf("jar")!==-1?t.slice(0,-3)+"waQ":e.indexOf("DIS")!==-1?t.slice(0,-3)+"nem":t+" pIq"}function i(e){var t=e;return t=e.indexOf("jaj")!==-1?t.slice(0,-3)+"Hu":e.indexOf("jar")!==-1?t.slice(0,-3)+"wen":e.indexOf("DIS")!==-1?t.slice(0,-3)+"ben":t+" ret"}function n(e,t,i,n){var s=o(e);switch(i){case"ss":return s+" lup";case"mm":return s+" tup";case"hh":return s+" rep";case"dd":return s+" jaj";case"MM":return s+" jar";case"yy":return s+" DIS"}}function o(e){var t=Math.floor(e%1e3/100),i=Math.floor(e%100/10),n=e%10,o="";return t>0&&(o+=s[t]+"vatlh"),i>0&&(o+=(""!==o?" ":"")+s[i]+"maH"),n>0&&(o+=(""!==o?" ":"")+s[n]),""===o?"pagh":o}
//! moment.js locale configuration
var s="pagh_wa_cha_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_"),a=e.defineLocale("tlh",{months:"tera jar wa_tera jar cha_tera jar wej_tera jar loS_tera jar vagh_tera jar jav_tera jar Soch_tera jar chorgh_tera jar Hut_tera jar wamaH_tera jar wamaH wa_tera jar wamaH cha".split("_"),monthsShort:"jar wa_jar cha_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wamaH_jar wamaH wa_jar wamaH cha".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[waleS] LT",nextWeek:"LLL",lastDay:"[waHu] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:t,past:i,s:"puS lup",ss:n,m:"wa tup",mm:n,h:"wa rep",hh:n,d:"wa jaj",dd:n,M:"wa jar",MM:n,y:"wa DIS",yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return a})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"},i=e.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),meridiem:function(e,t,i){return e<12?i?"":"":i?"s":"S"},meridiemParse:/||s|S/,isPM:function(e){return"s"===e||"S"===e},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[gelecek] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",ss:"%d saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinal:function(e,i){switch(i){case"d":case"D":case"Do":case"DD":return e;default:if(0===e)return e+"'nc";var n=e%10,o=e%100-n,s=e>=100?100:null;return e+(t[n]||t[o]||t[s])}},week:{dow:1,doy:7}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";function t(e,t,i,n){var o={s:["viensas secunds","'iensas secunds"],ss:[e+" secunds",""+e+" secunds"],m:["'n mut","'iens mut"],mm:[e+" muts",""+e+" muts"],h:["'n ora","'iensa ora"],hh:[e+" oras",""+e+" oras"],d:["'n ziua","'iensa ziua"],dd:[e+" ziuas",""+e+" ziuas"],M:["'n mes","'iens mes"],MM:[e+" mesen",""+e+" mesen"],y:["'n ar","'iens ar"],yy:[e+" ars",""+e+" ars"]};return n?o[i][0]:t?o[i][0]:o[i][1]}
//! moment.js locale configuration
var i=e.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(e){return"d'o"===e.toLowerCase()},meridiem:function(e,t,i){return e>11?i?"d'o":"D'O":i?"d'a":"D'A"},calendar:{sameDay:"[oxhi ] LT",nextDay:"[dem ] LT",nextWeek:"dddd [] LT",lastDay:"[ieiri ] LT",lastWeek:"[sr el] dddd [lasteu ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return i})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",ss:"%d imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js language configuration
var t=e.defineLocale("ug-cn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY-M-D-",LLL:"YYYY-M-D- HH:mm",LLLL:"dddd YYYY-M-D- HH:mm"},meridiemParse:/ || || |/,meridiemHour:function(e,t){return 12===e&&(e=0)," "===t||""===t||" "===t?e:" "===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,i){var n=100*e+t;return n<600?" ":n<900?"":n<1130?" ":n<1230?"":n<1800?" ":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}(-|-|-)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"-";case"w":case"W":return e+"-";default:return e}},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
function t(e,t){var i=e.split("_");return t%10===1&&t%100!==11?i[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?i[1]:i[2]}function i(e,i,n){var o={ss:i?"__":"__",mm:i?"__":"__",hh:i?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===n?i?"":"":"h"===n?i?"":"":e+" "+t(o[n],+e)}function n(e,t){var i,n={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")};return e===!0?n.nominative.slice(1,7).concat(n.nominative.slice(0,1)):e?(i=/(\[[]\]) ?dddd/.test(t)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(t)?"genitive":"nominative",n[i][e.day()]):n.nominative}function o(e){return function(){return e+""+(11===this.hours()?"":"")+"] LT"}}var s=e.defineLocale("uk",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:n,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:o("[ "),nextDay:o("[ "),lastDay:o("[ "),nextWeek:o("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return o("[] dddd [").call(this);case 1:case 2:case 4:return o("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:i,m:i,mm:i,h:"",hh:i,d:"",dd:i,M:"",MM:i,y:"",yy:i},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,i){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}});return s})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=["","","","","","","","","","","",""],i=["","","","","","",""],n=e.defineLocale("ur",{months:t,monthsShort:t,weekdays:i,weekdaysShort:i,weekdaysMin:i,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,i){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[  ] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}});return n})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",ss:"%d soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),monthsParseExact:!0,weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(e){return/^ch$/i.test(e)},meridiem:function(e,t,i){return e<12?i?"sa":"SA":i?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun trc lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",ss:"%d giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("x-pseudo",{months:"J~~r_F~br~r_~Mrc~h_p~rl_~M_~J~_Jl~_~gst~_Sp~tmb~r_~ctb~r_~vm~br_~Dc~mbr".split("_"),monthsShort:"J~_~Fb_~Mr_~pr_~M_~J_~Jl_~g_~Sp_~ct_~v_~Dc".split("_"),monthsParseExact:!0,weekdays:"S~d~_M~d~_T~sd~_Wd~sd~_T~hrs~d_~Frd~_S~tr~d".split("_"),weekdaysShort:"S~_~M_~T_~Wd_~Th_~Fr_~St".split("_"),weekdaysMin:"S~_M~_T_~W_T~h_Fr~_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~d~ t] LT",nextDay:"[T~m~rr~w t] LT",nextWeek:"dddd [t] LT",lastDay:"[~st~rd~ t] LT",lastWeek:"[L~st] dddd [t] LT",sameElse:"L"},relativeTime:{future:"~ %s",past:"%s ~g",s:" ~fw ~sc~ds",ss:"%d s~c~ds",m:" ~m~t",mm:"%d m~~ts",h:"~ h~r",hh:"%d h~rs",d:" ~d",dd:"%d d~s",M:" ~m~th",MM:"%d m~t~hs",y:" ~r",yy:"%d ~rs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("yo",{months:"Sr_Erele_rna_Igbe_Ebibi_Okudu_Agmo_Ogun_Owewe_wara_Belu_p".split("_"),monthsShort:"Sr_Erl_rn_Igb_Ebi_Oku_Ag_Ogu_Owe_wa_Bel_p".split("_"),weekdays:"Aiku_Aje_Isgun_jru_jb_ti_Abamta".split("_"),weekdaysShort:"Aik_Aje_Is_jr_jb_ti_Aba".split("_"),weekdaysMin:"Ai_Aj_Is_r_b_t_Ab".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Oni ni] LT",nextDay:"[la ni] LT",nextWeek:"dddd [s ton'b] [ni] LT",lastDay:"[Ana ni] LT",lastWeek:"dddd [s tol] [ni] LT",sameElse:"L"},relativeTime:{future:"ni %s",past:"%s kja",s:"isju aaya die",ss:"aaya %d",m:"isju kan",mm:"isju %d",h:"wakati kan",hh:"wakati %d",d:"j kan",dd:"j %d",M:"osu kan",MM:"osu %d",y:"dun kan",yy:"dun %d"},dayOfMonthOrdinalParse:/j\s\d{1,2}/,ordinal:"j %d",week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,i){var n=100*e+t;return n<600?"":n<900?"":n<1130?"":n<1230?"":n<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:function(e){return e.week()!==this.week()?"[]dddLT":"[]dddLT"},lastDay:"[]LT",lastWeek:function(e){return this.week()!==e.week()?"[]dddLT":"[]dddLT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("zh-hk",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,i){var n=100*e+t;return n<600?"":n<900?"":n<1200?"":1200===n?"":n<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("zh-mo",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"D/M/YYYY",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,i){var n=100*e+t;return n<600?"":n<900?"":n<1130?"":n<1230?"":n<1800?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}});return t})},function(e,t,i){!function(e,t){t(i(47))}(this,function(e){"use strict";
//! moment.js locale configuration
var t=e.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,i){var n=100*e+t;return n<600?"":n<900?"":n<1130?"":n<1230?"":n<1800?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}});return t})},function(e,t){e.exports={version:"2019b",zones:["Africa/Abidjan|LMT GMT|g.8 0|01|-2ldXH.Q|48e5","Africa/Accra|LMT GMT +0020|.Q 0 -k|012121212121212121212121212121212121212121212121|-26BbX.8 6tzX.8 MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE|41e5","Africa/Nairobi|LMT EAT +0230 +0245|-2r.g -30 -2u -2J|01231|-1F3Cr.g 3Dzr.g okMu MFXJ|47e5","Africa/Algiers|PMT WET WEST CET CEST|-9.l 0 -10 -10 -20|0121212121212121343431312123431213|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 DA0 Imo0 rd0 De0 9Xz0 1fb0 1ap0 16K0 2yo0 mEp0 hwL0 jxA0 11A0 dDd0 17b0 11B0 1cN0 2Dy0 1cN0 1fB0 1cL0|26e5","Africa/Lagos|LMT WAT|-d.A -10|01|-22y0d.A|17e6","Africa/Bissau|LMT -01 GMT|12.k 10 0|012|-2ldX0 2xoo0|39e4","Africa/Maputo|LMT CAT|-2a.k -20|01|-2GJea.k|26e5","Africa/Cairo|EET EEST|-20 -30|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1bIO0 vb0 1ip0 11z0 1iN0 1nz0 12p0 1pz0 10N0 1pz0 16p0 1jz0 s3d0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1WL0 rd0 1Rz0 wp0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1qL0 Xd0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1ny0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 WL0 1qN0 Rb0 1wp0 On0 1zd0 Lz0 1EN0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0|15e6","Africa/Casablanca|LMT +00 +01|u.k 0 -10|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2gMnt.E 130Lt.E rb0 Dd0 dVb0 b6p0 TX0 EoB0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4mn0 SyN0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 28M0 e00 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00 2600 gM0 2600 e00 2600 gM0 2600 e00 28M0 e00 2600 gM0|32e5","Africa/Ceuta|WET WEST CET CEST|0 -10 -10 -20|010101010101010101010232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-25KN0 11z0 drd0 18p0 3HX0 17d0 1fz0 1a10 1io0 1a00 1y7o0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4VB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|85e3","Africa/El_Aaiun|LMT -01 +00 +01|Q.M 10 0 -10|012323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1rDz7.c 1GVA7.c 6L0 AL0 1Nd0 XX0 1Cp0 pz0 1cBB0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 28M0 e00 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00 2600 e00 28M0 e00 2600 gM0 2600 e00 28M0 e00 2600 gM0 2600 e00 2600 gM0 2600 e00 28M0 e00 2600 gM0|20e4","Africa/Johannesburg|SAST SAST SAST|-1u -20 -30|012121|-2GJdu 1Ajdu 1cL0 1cN0 1cL0|84e5","Africa/Juba|LMT CAT CAST EAT|-26.s -20 -30 -30|01212121212121212121212121212121213|-1yW26.s 1zK06.s 16L0 1iN0 17b0 1jd0 17b0 1ip0 17z0 1i10 17X0 1hB0 18n0 1hd0 19b0 1gp0 19z0 1iN0 17b0 1ip0 17z0 1i10 18n0 1hd0 18L0 1gN0 19b0 1gp0 19z0 1iN0 17z0 1i10 17X0 yGd0","Africa/Khartoum|LMT CAT CAST EAT|-2a.8 -20 -30 -30|012121212121212121212121212121212131|-1yW2a.8 1zK0a.8 16L0 1iN0 17b0 1jd0 17b0 1ip0 17z0 1i10 17X0 1hB0 18n0 1hd0 19b0 1gp0 19z0 1iN0 17b0 1ip0 17z0 1i10 18n0 1hd0 18L0 1gN0 19b0 1gp0 19z0 1iN0 17z0 1i10 17X0 yGd0 HjL0|51e5","Africa/Monrovia|MMT MMT GMT|H.8 I.u 0|012|-23Lzg.Q 28G01.m|11e5","Africa/Ndjamena|LMT WAT WAST|-10.c -10 -20|0121|-2le10.c 2J3c0.c Wn0|13e5","Africa/Sao_Tome|LMT GMT WAT|A.J 0 -10|0121|-2le00 4i6N0 2q00","Africa/Tripoli|LMT CET CEST EET|-Q.I -10 -20 -20|012121213121212121212121213123123|-21JcQ.I 1hnBQ.I vx0 4iP0 xx0 4eN0 Bb0 7ip0 U0n0 A10 1db0 1cN0 1db0 1dd0 1db0 1eN0 1bb0 1e10 1cL0 1c10 1db0 1dd0 1db0 1cN0 1db0 1q10 fAn0 1ep0 1db0 AKq0 TA0 1o00|11e5","Africa/Tunis|PMT CET CEST|-9.l -10 -20|0121212121212121212121212121212121|-2nco9.l 18pa9.l 1qM0 DA0 3Tc0 11B0 1ze0 WM0 7z0 3d0 14L0 1cN0 1f90 1ar0 16J0 1gXB0 WM0 1rA0 11c0 nwo0 Ko0 1cM0 1cM0 1rA0 10M0 zuM0 10N0 1aN0 1qM0 WM0 1qM0 11A0 1o00|20e5","Africa/Windhoek|+0130 SAST SAST CAT WAT|-1u -20 -30 -20 -10|01213434343434343434343434343434343434343434343434343|-2GJdu 1Ajdu 1cL0 1SqL0 9Io0 16P0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0|32e4","America/Adak|NST NWT NPT BST BDT AHST HST HDT|b0 a0 a0 b0 a0 a0 a0 90|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AST AWT APT AHST AHDT YST AKST AKDT|a0 90 90 a0 90 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T00 8wX0 iA0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Port_of_Spain|LMT AST|46.4 40|01|-2kNvR.U|43e3","America/Araguaina|LMT -03 -02|3c.M 30 20|0121212121212121212121212121212121212121212121212121|-2glwL.c HdKL.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 ny10 Lz0|14e4","America/Argentina/Buenos_Aires|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 A4p0 uL0 1qN0 WL0","America/Argentina/Catamarca|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323132321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Cordoba|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323132323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 A4p0 uL0 1qN0 WL0","America/Argentina/Jujuy|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323121323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1ze0 TX0 1ld0 WK0 1wp0 TX0 A4p0 uL0","America/Argentina/La_Rioja|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Mendoza|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232312121321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1u20 SL0 1vd0 Tb0 1wp0 TW0 ri10 Op0 7TX0 uL0","America/Argentina/Rio_Gallegos|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Salta|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 A4p0 uL0","America/Argentina/San_Juan|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 rld0 m10 8lb0 uL0","America/Argentina/San_Luis|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323121212321212|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 XX0 1q20 SL0 AN0 vDb0 m10 8lb0 8L0 jd0 1qN0 WL0 1qN0","America/Argentina/Tucuman|CMT -04 -03 -02|4g.M 40 30 20|0121212121212121212121212121212121212121212323232313232123232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 rlB0 4N0 8BX0 uL0 1qN0 WL0","America/Argentina/Ushuaia|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 rkN0 8p0 8zb0 uL0","America/Curacao|LMT -0430 AST|4z.L 4u 40|012|-2kV7o.d 28KLS.d|15e4","America/Asuncion|AMT -04 -03|3O.E 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-1x589.k 1DKM9.k 3CL0 3Dd0 10L0 1pB0 10n0 1pB0 10n0 1pB0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1lB0 14n0 1dd0 1cL0 1fd0 WL0 1rd0 1aL0 1dB0 Xz0 1qp0 Xb0 1qN0 10L0 1rB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 WN0 1qL0 11B0 1nX0 1ip0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 TX0 1tB0 19X0 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0|28e5","America/Atikokan|CST CDT CWT CPT EST|60 50 50 50 50|0101234|-25TQ0 1in0 Rnb0 3je0 8x30 iw0|28e2","America/Bahia_Banderas|LMT MST CST PST MDT CDT|71 70 60 80 60 50|0121212131414141414141414141414141414152525252525252525252525252525252525252525252525252525252|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|84e3","America/Bahia|LMT -03 -02|2y.4 30 20|01212121212121212121212121212121212121212121212121212121212121|-2glxp.U HdLp.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 l5B0 Rb0|27e5","America/Barbados|LMT BMT AST ADT|3W.t 3W.t 40 30|01232323232|-1Q0I1.v jsM0 1ODC1.v IL0 1ip0 17b0 1ip0 17b0 1ld0 13b0|28e4","America/Belem|LMT -03 -02|3d.U 30 20|012121212121212121212121212121|-2glwK.4 HdKK.4 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0|20e5","America/Belize|LMT CST -0530 CDT|5Q.M 60 5u 50|01212121212121212121212121212121212121212121212121213131|-2kBu7.c fPA7.c Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1f0Mu qn0 lxB0 mn0|57e3","America/Blanc-Sablon|AST ADT AWT APT|40 30 30 30|010230|-25TS0 1in0 UGp0 8x50 iu0|11e2","America/Boa_Vista|LMT -04 -03|42.E 40 30|0121212121212121212121212121212121|-2glvV.k HdKV.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 smp0 WL0 1tB0 2L0|62e2","America/Bogota|BMT -05 -04|4U.g 50 40|0121|-2eb73.I 38yo3.I 2en0|90e5","America/Boise|PST PDT MST MWT MPT MDT|80 70 70 60 60 60|0101023425252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-261q0 1nX0 11B0 1nX0 8C10 JCL0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 Dd0 1Kn0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e4","America/Cambridge_Bay|-00 MST MWT MPT MDDT MDT CST CDT EST|0 70 60 60 50 60 60 50 50|0123141515151515151515151515151515151515151515678651515151515151515151515151515151515151515151515151515151515151515151515151|-21Jc0 RO90 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11A0 1nX0 2K0 WQ0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e2","America/Campo_Grande|LMT -04 -03|3C.s 40 30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2glwl.w HdLl.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0|77e4","America/Cancun|LMT CST EST EDT CDT|5L.4 60 50 40 50|0123232341414141414141414141414141414141412|-1UQG0 2q2o0 yLB0 1lb0 14p0 1lb0 14p0 Lz0 xB0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4","America/Caracas|CMT -0430 -04|4r.E 4u 40|01212|-2kV7w.k 28KM2.k 1IwOu kqo0|29e5","America/Cayenne|LMT -04 -03|3t.k 40 30|012|-2mrwu.E 2gWou.E|58e3","America/Panama|CMT EST|5j.A 50|01|-2uduE.o|15e5","America/Chicago|CST CDT EST CWT CPT|60 50 50 50 50|01010101010101010101010101010101010102010101010103401010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 1wp0 TX0 WN0 1qL0 1cN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 11B0 1Hz0 14p0 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|LMT MST CST CDT MDT|74.k 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|81e4","America/Costa_Rica|SJMT CST CDT|5A.d 60 50|0121212121|-1Xd6n.L 2lu0n.L Db0 1Kp0 Db0 pRB0 15b0 1kp0 mL0|12e5","America/Creston|MST PST|70 80|010|-29DR0 43B0|53e2","America/Cuiaba|LMT -04 -03|3I.k 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2glwf.E HdLf.E 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 4a10 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0|54e4","America/Danmarkshavn|LMT -03 -02 GMT|1e.E 30 20 0|01212121212121212121212121212121213|-2a5WJ.k 2z5fJ.k 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 DC0|8","America/Dawson_Creek|PST PDT PWT PPT MST|80 70 70 70 70|0102301010101010101010101010101010101010101010101010101014|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 ML0|12e3","America/Dawson|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 jrA0 fNd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|13e2","America/Denver|MST MDT MWT MPT|70 60 60 60|01010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 11B0 1qL0 WN0 mn0 Ord0 8x20 ix0 LCN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Detroit|LMT CST EST EWT EPT EDT|5w.b 60 50 40 40 40|012342525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2Cgir.N peqr.N 156L0 8x40 iv0 6fd0 11z0 XQp0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e5","America/Edmonton|LMT MST MDT MWT MPT|7x.Q 70 60 60 60|01212121212121341212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2yd4q.8 shdq.8 1in0 17d0 hz0 2dB0 1fz0 1a10 11z0 1qN0 WL0 1qN0 11z0 IGN0 8x20 ix0 3NB0 11z0 LFB0 1cL0 3Cp0 1cL0 66N0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|10e5","America/Eirunepe|LMT -05 -04|4D.s 50 40|0121212121212121212121212121212121|-2glvk.w HdLk.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0 yTd0 d5X0|31e3","America/El_Salvador|LMT CST CDT|5U.M 60 50|012121|-1XiG3.c 2Fvc3.c WL0 1qN0 WL0|11e5","America/Tijuana|LMT MST PST PDT PWT PPT|7M.4 70 80 70 70 70|012123245232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQE0 4PX0 8mM0 8lc0 SN0 1cL0 pHB0 83r0 zI0 5O10 1Rz0 cOO0 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 BUp0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|20e5","America/Fort_Nelson|PST PDT PWT PPT MST|80 70 70 70 70|01023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2","America/Fort_Wayne|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010101023010101010101010101040454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 QI10 Db0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 5Tz0 1o10 qLb0 1cL0 1cN0 1cL0 1qhd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Fortaleza|LMT -03 -02|2y 30 20|0121212121212121212121212121212121212121|-2glxq HdLq 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 5z0 2mN0 On0|34e5","America/Glace_Bay|LMT AST ADT AWT APT|3X.M 40 30 30 30|012134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsI0.c CwO0.c 1in0 UGp0 8x50 iu0 iq10 11z0 Jg10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|19e3","America/Godthab|LMT -03 -02|3q.U 30 20|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5Ux.4 2z5dx.4 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e3","America/Goose_Bay|NST NDT NST NDT NWT NPT AST ADT ADDT|3u.Q 2u.Q 3u 2u 2u 2u 40 30 20|010232323232323245232323232323232323232323232323232323232326767676767676767676767676767676767676767676768676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-25TSt.8 1in0 DXb0 2HbX.8 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 S10 g0u 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|76e2","America/Grand_Turk|KMT EST EDT AST|57.a 50 40 40|01212121212121212121212121212121212121212121212121212121212121212121212121232121212121212121212121212121212121212121|-2l1uQ.O 2HHBQ.O 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 5Ip0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Guatemala|LMT CST CDT|62.4 60 50|0121212121|-24KhV.U 2efXV.U An0 mtd0 Nz0 ifB0 17b0 zDB0 11z0|13e5","America/Guayaquil|QMT -05 -04|5e 50 40|0121|-1yVSK 2uILK rz0|27e5","America/Guyana|LMT -0345 -03 -04|3Q.E 3J 30 40|0123|-2dvU7.k 2r6LQ.k Bxbf|80e4","America/Halifax|LMT AST ADT AWT APT|4e.o 40 30 30 30|0121212121212121212121212121212121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsHJ.A xzzJ.A 1db0 3I30 1in0 3HX0 IL0 1E10 ML0 1yN0 Pb0 1Bd0 Mn0 1Bd0 Rz0 1w10 Xb0 1w10 LX0 1w10 Xb0 1w10 Lz0 1C10 Jz0 1E10 OL0 1yN0 Un0 1qp0 Xb0 1qp0 11X0 1w10 Lz0 1HB0 LX0 1C10 FX0 1w10 Xb0 1qp0 Xb0 1BB0 LX0 1td0 Xb0 1qp0 Xb0 Rf0 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 6i10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Havana|HMT CST CDT|5t.A 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Meuu.o 72zu.o ML0 sld0 An0 1Nd0 Db0 1Nd0 An0 6Ep0 An0 1Nd0 An0 JDd0 Mn0 1Ap0 On0 1fd0 11X0 1qN0 WL0 1wp0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 14n0 1ld0 14L0 1kN0 15b0 1kp0 1cL0 1cN0 1fz0 1a10 1fz0 1fB0 11z0 14p0 1nX0 11B0 1nX0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 1a10 1in0 1a10 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 17c0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 11A0 6i00 Rc0 1wo0 U00 1tA0 Rc0 1wo0 U00 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Hermosillo|LMT MST CST PST MDT|7n.Q 70 60 80 60|0121212131414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0|64e4","America/Indiana/Knox|CST CDT CWT CPT EST|60 50 50 50 50|0101023010101010101010101010101010101040101010101010101010101010101010101010101010101010141010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 3Cn0 8wp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 z8o0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Marengo|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010104545454545414545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 dyN0 11z0 6fd0 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1e6p0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Petersburg|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010104010101010101010101010141014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 njX0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 3Fb0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 19co0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Tell_City|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vevay|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010102304545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 kPB0 Awn0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1lnd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vincennes|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Winamac|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010101010454541054545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1za0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Inuvik|-00 PST PDDT MST MDT|0 80 60 70 60|0121343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-FnA0 tWU0 1fA0 wPe0 2pz0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|35e2","America/Iqaluit|-00 EWT EPT EST EDDT EDT CST CDT|0 40 40 50 30 40 60 50|01234353535353535353535353535353535353535353567353535353535353535353535353535353535353535353535353535353535353535353535353|-16K00 7nX0 iv0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|67e2","America/Jamaica|KMT EST EDT|57.a 50 40|0121212121212121212121|-2l1uQ.O 2uM1Q.O 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0|94e4","America/Juneau|PST PWT PPT PDT YDT YST AKST AKDT|80 70 70 70 80 90 90 80|01203030303030303030303030403030356767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cM0 1cM0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|33e3","America/Kentucky/Louisville|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101010102301010101010101010101010101454545454545414545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 3Fd0 Nb0 LPd0 11z0 RB0 8x30 iw0 Bb0 10N0 2bB0 8in0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 xz0 gso0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Kentucky/Monticello|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 SWp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/La_Paz|CMT BST -04|4w.A 3w.A 40|012|-1x37r.o 13b0|19e5","America/Lima|LMT -05 -04|58.A 50 40|0121212121212121|-2tyGP.o 1bDzP.o zX0 1aN0 1cL0 1cN0 1cL0 1PrB0 zX0 1O10 zX0 6Gp0 zX0 98p0 zX0|11e6","America/Los_Angeles|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 5Wp1 1VaX 3dA0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/Maceio|LMT -03 -02|2m.Q 30 20|012121212121212121212121212121212121212121|-2glxB.8 HdLB.8 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 8Q10 WL0 1tB0 5z0 2mN0 On0|93e4","America/Managua|MMT CST EST CDT|5J.c 60 50 50|0121313121213131|-1quie.M 1yAMe.M 4mn0 9Up0 Dz0 1K10 Dz0 s3F0 1KH0 DB0 9In0 k8p0 19X0 1o30 11y0|22e5","America/Manaus|LMT -04 -03|40.4 40 30|01212121212121212121212121212121|-2glvX.U HdKX.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0|19e5","America/Martinique|FFMT AST ADT|44.k 40 30|0121|-2mPTT.E 2LPbT.E 19X0|39e4","America/Matamoros|LMT CST CDT|6E 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|45e4","America/Mazatlan|LMT MST CST PST MDT|75.E 70 60 80 60|0121212131414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|44e4","America/Menominee|CST CDT CWT CPT EST|60 50 50 50 50|01010230101041010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 LCN0 1fz0 6410 9Jb0 1cM0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|85e2","America/Merida|LMT CST EST CDT|5W.s 60 50 50|0121313131313131313131313131313131313131313131313131313131313131313131313131313131313131|-1UQG0 2q2o0 2hz0 wu30 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|11e5","America/Metlakatla|PST PWT PPT PDT AKST AKDT|80 70 70 70 90 80|01203030303030303030303030303030304545450454545454545454545454545454545454545454|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1hU10 Rd0 1zb0 Op0 1zb0 Op0 1zb0 uM0 jB0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Mexico_City|LMT MST CST CDT CWT|6A.A 70 60 50 50|012121232324232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 gEn0 TX0 3xd0 Jb0 6zB0 SL0 e5d0 17b0 1Pff0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|20e6","America/Miquelon|LMT AST -03 -02|3I.E 40 30 20|012323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2mKkf.k 2LTAf.k gQ10 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Moncton|EST AST ADT AWT APT|50 40 30 30 30|012121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsH0 CwN0 1in0 zAo0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1K10 Lz0 1zB0 NX0 1u10 Wn0 S20 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14n1 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 ReX 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|64e3","America/Monterrey|LMT CST CDT|6F.g 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|41e5","America/Montevideo|LMT MMT -04 -03 -0330 -0230 -02 -0130|3I.P 3I.P 40 30 3u 2u 20 1u|012343434343434343434343435353636353636375363636363636363636363636363636363636363636363|-2tRUf.9 sVc0 8jcf.9 1db0 1dcu 1cLu 1dcu 1cLu ircu 11zu 1o0u 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu WLu 1fAu 1cLu 1o0u 11zu NAu 3jXu zXu Dq0u 19Xu pcu jz0 cm10 19X0 6tB0 1fbu 3o0u jX0 4vB0 xz0 3Cp0 mmu 1a10 IMu Db0 4c10 uL0 1Nd0 An0 1SN0 uL0 mp0 28L0 iPB0 un0 1SN0 xz0 1zd0 Lz0 1zd0 Rb0 1zd0 On0 1wp0 Rb0 s8p0 1fB0 1ip0 11z0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0|17e5","America/Toronto|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101012301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 11Wu 1nzu 1fD0 WJ0 1wr0 Nb0 1Ap0 On0 1zd0 On0 1wp0 TX0 1tB0 TX0 1tB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 4kM0 8x40 iv0 1o10 11z0 1nX0 11z0 1o10 11z0 1o10 1qL0 11D0 1nX0 11B0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|65e5","America/Nassau|LMT EST EDT|59.u 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2kNuO.u 26XdO.u 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|24e4","America/New_York|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 11B0 1qL0 1a10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x40 iv0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Nipigon|EST EDT EWT EPT|50 40 40 40|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 Rnb0 3je0 8x40 iv0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|16e2","America/Nome|NST NWT NPT BST BDT YST AKST AKDT|b0 a0 a0 b0 a0 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cl0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|38e2","America/Noronha|LMT -02 -01|29.E 20 10|0121212121212121212121212121212121212121|-2glxO.k HdKO.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0|30e2","America/North_Dakota/Beulah|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/Center|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/New_Salem|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Ojinaga|LMT MST CST CDT MDT|6V.E 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Pangnirtung|-00 AST AWT APT ADDT ADT EDT EST CST CDT|0 40 30 30 20 30 40 50 60 50|012314151515151515151515151515151515167676767689767676767676767676767676767676767676767676767676767676767676767676767676767|-1XiM0 PnG0 8x50 iu0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1o00 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Paramaribo|LMT PMT PMT -0330 -03|3E.E 3E.Q 3E.A 3u 30|01234|-2nDUj.k Wqo0.c qanX.I 1yVXN.o|24e4","America/Phoenix|MST MDT MWT|70 60 60|01010202010|-261r0 1nX0 11B0 1nX0 SgN0 4Al1 Ap0 1db0 SWqX 1cL0|42e5","America/Port-au-Prince|PPMT EST EDT|4N 50 40|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-28RHb 2FnMb 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14q0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 i6n0 1nX0 11B0 1nX0 d430 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 3iN0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Rio_Branco|LMT -05 -04|4v.c 50 40|01212121212121212121212121212121|-2glvs.M HdLs.M 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0 d5X0|31e4","America/Porto_Velho|LMT -04 -03|4f.A 40 30|012121212121212121212121212121|-2glvI.o HdKI.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0|37e4","America/Puerto_Rico|AST AWT APT|40 30 30|0120|-17lU0 7XT0 iu0|24e5","America/Punta_Arenas|SMT -05 -04 -03|4G.K 50 40 30|0102021212121212121232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-2q2jh.e fJAh.e 5knG.K 1Vzh.e jRAG.K 1pbh.e 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 nHX0 op0 blz0 ko0 Qeo0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0","America/Rainy_River|CST CDT CWT CPT|60 50 50 50|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TQ0 1in0 Rnb0 3je0 8x30 iw0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|842","America/Rankin_Inlet|-00 CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313131313131313131313131313131313131313131313131313131313131313131|-vDc0 keu0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e2","America/Recife|LMT -03 -02|2j.A 30 20|0121212121212121212121212121212121212121|-2glxE.o HdLE.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0|33e5","America/Regina|LMT MST MDT MWT MPT CST|6W.A 70 60 60 60 60|012121212121212121212121341212121212121212121212121215|-2AD51.o uHe1.o 1in0 s2L0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 66N0 1cL0 1cN0 19X0 1fB0 1cL0 1fB0 1cL0 1cN0 1cL0 M30 8x20 ix0 1ip0 1cL0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 3NB0 1cL0 1cN0|19e4","America/Resolute|-00 CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313431313131313131313131313131313131313131313131313131313131313131|-SnA0 GWS0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|229","America/Santarem|LMT -04 -03|3C.M 40 30|0121212121212121212121212121212|-2glwl.c HdLl.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0|21e4","America/Santiago|SMT -05 -04 -03|4G.K 50 40 30|010202121212121212321232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-2q2jh.e fJAh.e 5knG.K 1Vzh.e jRAG.K 1pbh.e 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 nHX0 op0 9Bz0 jb0 1oN0 ko0 Qeo0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0|62e5","America/Santo_Domingo|SDMT EST EDT -0430 AST|4E 50 40 4u 40|01213131313131414|-1ttjk 1lJMk Mn0 6sp0 Lbu 1Cou yLu 1RAu wLu 1QMu xzu 1Q0u xXu 1PAu 13jB0 e00|29e5","America/Sao_Paulo|LMT -03 -02|36.s 30 20|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2glwR.w HdKR.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 pTd0 PX0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0|20e6","America/Scoresbysund|LMT -02 -01 +00|1r.Q 20 10 0|0121323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2a5Ww.8 2z5ew.8 1a00 1cK0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|452","America/Sitka|PST PWT PPT PDT YST AKST AKDT|80 70 70 70 90 90 80|01203030303030303030303030303030345656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|90e2","America/St_Johns|NST NDT NST NDT NWT NPT NDDT|3u.Q 2u.Q 3u 2u 2u 2u 1u|01010101010101010101010101010101010102323232323232324523232323232323232323232323232323232323232323232323232323232323232323232323232323232326232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-28oit.8 14L0 1nB0 1in0 1gm0 Dz0 1JB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1fB0 19X0 1fB0 19X0 10O0 eKX.8 19X0 1iq0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","America/Swift_Current|LMT MST MDT MWT MPT CST|7b.k 70 60 60 60 60|012134121212121212121215|-2AD4M.E uHdM.E 1in0 UGp0 8x20 ix0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 isN0 1cL0 3Cp0 1cL0 1cN0 11z0 1qN0 WL0 pMp0|16e3","America/Tegucigalpa|LMT CST CDT|5M.Q 60 50|01212121|-1WGGb.8 2ETcb.8 WL0 1qN0 WL0 GRd0 AL0|11e5","America/Thule|LMT AST ADT|4z.8 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5To.Q 31NBo.Q 1cL0 1cN0 1cL0 1fB0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|656","America/Thunder_Bay|CST EST EWT EPT EDT|60 50 40 40 40|0123141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-2q5S0 1iaN0 8x40 iv0 XNB0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","America/Vancouver|PST PDT PWT PPT|80 70 70 70|0102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TO0 1in0 UGp0 8x10 iy0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Whitehorse|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 3NA0 vrd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Winnipeg|CST CDT CWT CPT|60 50 50 50|010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aIi0 WL0 3ND0 1in0 Jap0 Rb0 aCN0 8x30 iw0 1tB0 11z0 1ip0 11z0 1o10 11z0 1o10 11z0 1rd0 10L0 1op0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 1cL0 1cN0 11z0 6i10 WL0 6i10 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|66e4","America/Yakutat|YST YWT YPT YDT AKST AKDT|90 80 80 80 90 80|01203030303030303030303030303030304545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-17T10 8x00 iz0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cn0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|642","America/Yellowknife|-00 MST MWT MPT MDDT MDT|0 70 60 60 50 60|012314151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151|-1pdA0 hix0 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|19e3","Antarctica/Casey|-00 +08 +11|0 -80 -b0|01212121|-2q00 1DjS0 T90 40P0 KL0 blz0 3m10|10","Antarctica/Davis|-00 +07 +05|0 -70 -50|01012121|-vyo0 iXt0 alj0 1D7v0 VB0 3Wn0 KN0|70","Antarctica/DumontDUrville|-00 +10|0 -a0|0101|-U0o0 cfq0 bFm0|80","Antarctica/Macquarie|AEST AEDT -00 +11|-a0 -b0 0 -b0|0102010101010101010101010101010101010101010101010101010101010101010101010101010101010101013|-29E80 19X0 4SL0 1ayy0 Lvs0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0|1","Antarctica/Mawson|-00 +06 +05|0 -60 -50|012|-CEo0 2fyk0|60","Pacific/Auckland|NZMT NZST NZST NZDT|-bu -cu -c0 -d0|01020202020202020202020202023232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1GCVu Lz0 1tB0 11zu 1o0u 11zu 1o0u 11zu 1o0u 14nu 1lcu 14nu 1lcu 1lbu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1qLu WMu 1qLu 11Au 1n1bu IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|14e5","Antarctica/Palmer|-00 -03 -04 -02|0 30 40 20|0121212121213121212121212121212121212121212121212121212121212121212121212121212121|-cao0 nD0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 jsN0 14N0 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0|40","Antarctica/Rothera|-00 -03|0 30|01|gOo0|130","Antarctica/Syowa|-00 +03|0 -30|01|-vs00|20","Antarctica/Troll|-00 +00 +02|0 0 -20|01212121212121212121212121212121212121212121212121212121212121212121|1puo0 hd0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|40","Antarctica/Vostok|-00 +06|0 -60|01|-tjA0|25","Europe/Oslo|CET CEST|-10 -20|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2awM0 Qm0 W6o0 5pf0 WM0 1fA0 1cM0 1cM0 1cM0 1cM0 wJc0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1qM0 WM0 zpc0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|62e4","Asia/Riyadh|LMT +03|-36.Q -30|01|-TvD6.Q|57e5","Asia/Almaty|LMT +05 +06 +07|-57.M -50 -60 -70|012323232323232323232321232323232323232323232323232|-1Pc57.M eUo7.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0|15e5","Asia/Amman|LMT EET EEST|-2n.I -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1yW2n.I 1HiMn.I KL0 1oN0 11b0 1oN0 11b0 1pd0 1dz0 1cp0 11b0 1op0 11b0 fO10 1db0 1e10 1cL0 1cN0 1cL0 1cN0 1fz0 1pd0 10n0 1ld0 14n0 1hB0 15b0 1ip0 19X0 1cN0 1cL0 1cN0 17b0 1ld0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1So0 y00 1fc0 1dc0 1co0 1dc0 1cM0 1cM0 1cM0 1o00 11A0 1lc0 17c0 1cM0 1cM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|25e5","Asia/Anadyr|LMT +12 +13 +14 +11|-bN.U -c0 -d0 -e0 -b0|01232121212121212121214121212121212121212121212121212121212141|-1PcbN.U eUnN.U 23CL0 1db0 2q10 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|13e3","Asia/Aqtau|LMT +04 +05 +06|-3l.4 -40 -50 -60|012323232323232323232123232312121212121212121212|-1Pc3l.4 eUnl.4 24PX0 2pX0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|15e4","Asia/Aqtobe|LMT +04 +05 +06|-3M.E -40 -50 -60|0123232323232323232321232323232323232323232323232|-1Pc3M.E eUnM.E 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0|27e4","Asia/Ashgabat|LMT +04 +05 +06|-3R.w -40 -50 -60|0123232323232323232323212|-1Pc3R.w eUnR.w 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0|41e4","Asia/Atyrau|LMT +03 +05 +06 +04|-3r.I -30 -50 -60 -40|01232323232323232323242323232323232324242424242|-1Pc3r.I eUor.I 24PW0 2pX0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 2sp0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0","Asia/Baghdad|BMT +03 +04|-2V.A -30 -40|012121212121212121212121212121212121212121212121212121|-26BeV.A 2ACnV.A 11b0 1cp0 1dz0 1dd0 1db0 1cN0 1cp0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1de0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0|66e5","Asia/Qatar|LMT +04 +03|-3q.8 -40 -30|012|-21Jfq.8 27BXq.8|96e4","Asia/Baku|LMT +03 +04 +05|-3j.o -30 -40 -50|01232323232323232323232123232323232323232323232323232323232323232|-1Pc3j.o 1jUoj.o WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cM0 9Je0 1o00 11z0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Asia/Bangkok|BMT +07|-6G.4 -70|01|-218SG.4|15e6","Asia/Barnaul|LMT +06 +07 +08|-5z -60 -70 -80|0123232323232323232323212323232321212121212121212121212121212121212|-21S5z pCnz 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 p90 LE0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Asia/Beirut|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-21aq0 1on0 1410 1db0 19B0 1in0 1ip0 WL0 1lQp0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 q6N0 En0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1op0 11b0 dA10 17b0 1iN0 17b0 1iN0 17b0 1iN0 17b0 1vB0 SL0 1mp0 13z0 1iN0 17b0 1iN0 17b0 1jd0 12n0 1a10 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|22e5","Asia/Bishkek|LMT +05 +06 +07|-4W.o -50 -60 -70|012323232323232323232321212121212121212121212121212|-1Pc4W.o eUnW.o 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2e00 1tX0 17b0 1ip0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1cPu 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0|87e4","Asia/Brunei|LMT +0730 +08|-7D.E -7u -80|012|-1KITD.E gDc9.E|42e4","Asia/Kolkata|MMT IST +0630|-5l.a -5u -6u|012121|-2zOtl.a 1r2LP.a 1un0 HB0 7zX0|15e6","Asia/Chita|LMT +08 +09 +10|-7x.Q -80 -90 -a0|012323232323232323232321232323232323232323232323232323232323232312|-21Q7x.Q pAnx.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3re0|33e4","Asia/Choibalsan|LMT +07 +08 +10 +09|-7C -70 -80 -a0 -90|0123434343434343434343434343434343434343434343424242|-2APHC 2UkoC cKn0 1da0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 3Db0 h1f0 1cJ0 1cP0 1cJ0|38e3","Asia/Shanghai|CST CDT|-80 -90|010101010101010101010101010|-1c2w0 Rz0 11d0 1wL0 A10 8HX0 1G10 Tz0 1ip0 1jX0 1cN0 11b0 1oN0 aL0 1tU30 Rb0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0|23e6","Asia/Colombo|MMT +0530 +06 +0630|-5j.w -5u -60 -6u|01231321|-2zOtj.w 1rFbN.w 1zzu 7Apu 23dz0 11zu n3cu|22e5","Asia/Dhaka|HMT +0630 +0530 +06 +07|-5R.k -6u -5u -60 -70|0121343|-18LFR.k 1unn.k HB0 m6n0 2kxbu 1i00|16e6","Asia/Damascus|LMT EET EEST|-2p.c -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-21Jep.c Hep.c 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1xRB0 11X0 1oN0 10L0 1pB0 11b0 1oN0 10L0 1mp0 13X0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 Nb0 1AN0 Nb0 bcp0 19X0 1gp0 19X0 3ld0 1xX0 Vd0 1Bz0 Sp0 1vX0 10p0 1dz0 1cN0 1cL0 1db0 1db0 1g10 1an0 1ap0 1db0 1fd0 1db0 1cN0 1db0 1dd0 1db0 1cp0 1dz0 1c10 1dX0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 19z0 1fB0 1qL0 11B0 1on0 Wp0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0|26e5","Asia/Dili|LMT +08 +09|-8m.k -80 -90|01212|-2le8m.k 1dnXm.k 1nfA0 Xld0|19e4","Asia/Dubai|LMT +04|-3F.c -40|01|-21JfF.c|39e5","Asia/Dushanbe|LMT +05 +06 +07|-4z.c -50 -60 -70|012323232323232323232321|-1Pc4z.c eUnz.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2hB0|76e4","Asia/Famagusta|LMT EET EEST +03|-2f.M -20 -30 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212312121212121212121212121212121212121212121|-1Vc2f.M 2a3cf.M 1cL0 1qp0 Xz0 19B0 19X0 1fB0 1db0 1cp0 1cL0 1fB0 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1o30 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 15U0 2Ks0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Gaza|EET EEST IST IDT|-20 -30 -20 -30|0101010101010101010101010101010123232323232323232323232323232320101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 bXd0 gM0 8Q00 IM0 1wM0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 11z0 1o10 14o0 1lA1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 WN0 1qL0 11c0 1oo0 11c0 1rc0 Wo0 1rc0 Wo0 1rc0 11c0 1oo0 11c0 1oo0 11c0 1oo0 11c0 1rc0 Wo0 1rc0 11c0 1oo0 11c0 1oo0 11c0 1oo0 11c0 1oo0 11c0 1rc0 Wo0 1rc0 11c0 1oo0 11c0 1oo0 11c0 1oo0 11c0 1rc0|18e5","Asia/Hebron|EET EEST IST IDT|-20 -30 -20 -30|010101010101010101010101010101012323232323232323232323232323232010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 bXd0 gM0 8Q00 IM0 1wM0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 12L0 1mN0 14o0 1lc0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 WN0 1qL0 11c0 1oo0 11c0 1rc0 Wo0 1rc0 Wo0 1rc0 11c0 1oo0 11c0 1oo0 11c0 1oo0 11c0 1rc0 Wo0 1rc0 11c0 1oo0 11c0 1oo0 11c0 1oo0 11c0 1oo0 11c0 1rc0 Wo0 1rc0 11c0 1oo0 11c0 1oo0 11c0 1oo0 11c0 1rc0|25e4","Asia/Ho_Chi_Minh|LMT PLMT +07 +08 +09|-76.E -76.u -70 -80 -90|0123423232|-2yC76.E bK00.a 1h7b6.u 5lz0 18o0 3Oq0 k5b0 aW00 BAM0|90e5","Asia/Hong_Kong|LMT HKT HKST HKT JST|-7A.G -80 -90 -8u -90|0123412121212121212121212121212121212121212121212121212121212121212121|-2CFH0 1taO0 Hc0 xUu 9tBu 11z0 1tDu Rc0 1wo0 11A0 1cM0 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1nX0 U10 1tz0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 Rd0 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 17d0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1cL0 6fd0 14n0|73e5","Asia/Hovd|LMT +06 +07 +08|-66.A -60 -70 -80|012323232323232323232323232323232323232323232323232|-2APG6.A 2Uko6.A cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 kEp0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|IMT +07 +08 +09|-6V.5 -70 -80 -90|01232323232323232323232123232323232323232323232323232323232323232|-21zGV.5 pjXV.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|60e4","Europe/Istanbul|IMT EET EEST +04 +03|-1U.U -20 -30 -40 -30|012121212121212121212121212121212121212121212121212121234343434342121212121212121212121212121212121212121212121212121212121212124|-2ogNU.U dzzU.U 11b0 8tB0 1on0 1410 1db0 19B0 1in0 3Rd0 Un0 1oN0 11b0 zSp0 CL0 mN0 1Vz0 1gN0 1pz0 5Rd0 1fz0 1yp0 ML0 1kp0 17b0 1ip0 17b0 1fB0 19X0 1jB0 18L0 1ip0 17z0 qdd0 xX0 3S10 Tz0 dA10 11z0 1o10 11z0 1qN0 11z0 1ze0 11B0 WM0 1qO0 WI0 1nX0 1rB0 10L0 11B0 1in0 17d0 1in0 2pX0 19E0 1fU0 16Q0 1iI0 16Q0 1iI0 1Vd0 pb0 3Kp0 14o0 1de0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1a00 1fA0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WO0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 15w0|13e6","Asia/Jakarta|BMT +0720 +0730 +09 +08 WIB|-77.c -7k -7u -90 -80 -70|01232425|-1Q0Tk luM0 mPzO 8vWu 6kpu 4PXu xhcu|31e6","Asia/Jayapura|LMT +09 +0930 WIT|-9m.M -90 -9u -90|0123|-1uu9m.M sMMm.M L4nu|26e4","Asia/Jerusalem|JMT IST IDT IDDT|-2k.E -20 -30 -40|012121212121321212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-26Bek.E SyMk.E 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 3LB0 Em0 or0 1cn0 1dB0 16n0 10O0 1ja0 1tC0 14o0 1cM0 1a00 11A0 1Na0 An0 1MP0 AJ0 1Kp0 LC0 1oo0 Wl0 EQN0 Db0 1fB0 Rb0 bXd0 gM0 8Q00 IM0 1wM0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 1hB0 1dX0 1ep0 1aL0 1eN0 17X0 1nf0 11z0 1tB0 19W0 1e10 17b0 1ep0 1gL0 18N0 1fz0 1eN0 17b0 1gq0 1gn0 19d0 1dz0 1c10 17X0 1hB0 1gn0 19d0 1dz0 1c10 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0|81e4","Asia/Kabul|+04 +0430|-40 -4u|01|-10Qs0|46e5","Asia/Kamchatka|LMT +11 +12 +13|-ay.A -b0 -c0 -d0|012323232323232323232321232323232323232323232323232323232323212|-1SLKy.A ivXy.A 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|18e4","Asia/Karachi|LMT +0530 +0630 +05 PKT PKST|-4s.c -5u -6u -50 -50 -60|012134545454|-2xoss.c 1qOKW.c 7zX0 eup0 LqMu 1fy00 1cL0 dK10 11b0 1610 1jX0|24e6","Asia/Urumqi|LMT +06|-5O.k -60|01|-1GgtO.k|32e5","Asia/Kathmandu|LMT +0530 +0545|-5F.g -5u -5J|012|-21JhF.g 2EGMb.g|12e5","Asia/Khandyga|LMT +08 +09 +10 +11|-92.d -80 -90 -a0 -b0|0123232323232323232323212323232323232323232323232343434343434343432|-21Q92.d pAp2.d 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 qK0 yN0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0|66e2","Asia/Krasnoyarsk|LMT +06 +07 +08|-6b.q -60 -70 -80|01232323232323232323232123232323232323232323232323232323232323232|-21Hib.q prAb.q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|10e5","Asia/Kuala_Lumpur|SMT +07 +0720 +0730 +09 +08|-6T.p -70 -7k -7u -90 -80|0123435|-2Bg6T.p 17anT.p l5XE 17bO 8Fyu 1so1u|71e5","Asia/Kuching|LMT +0730 +08 +0820 +09|-7l.k -7u -80 -8k -90|0123232323232323242|-1KITl.k gDbP.k 6ynu AnE 1O0k AnE 1NAk AnE 1NAk AnE 1NAk AnE 1O0k AnE 1NAk AnE pAk 8Fz0|13e4","Asia/Macau|LMT CST +09 +10 CDT|-7y.a -80 -90 -a0 -90|012323214141414141414141414141414141414141414141414141414141414141414141|-2CFHy.a 1uqKy.a PX0 1kn0 15B0 11b0 4Qq0 1oM0 11c0 1ko0 1u00 11A0 1cM0 11c0 1o00 11A0 1o00 11A0 1oo0 1400 1o00 11A0 1o00 U00 1tA0 U00 1wo0 Rc0 1wru U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 Rd0 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 17d0 1cK0 1cO0 1cK0 1cO0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1cL0 6fd0 14n0|57e4","Asia/Magadan|LMT +10 +11 +12|-a3.c -a0 -b0 -c0|012323232323232323232321232323232323232323232323232323232323232312|-1Pca3.c eUo3.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3Cq0|95e3","Asia/Makassar|LMT MMT +08 +09 WITA|-7V.A -7V.A -80 -90 -80|01234|-21JjV.A vfc0 myLV.A 8ML0|15e5","Asia/Manila|PST PDT JST|-80 -90 -90|010201010|-1kJI0 AL0 cK10 65X0 mXB0 vX0 VK10 1db0|24e6","Asia/Nicosia|LMT EET EEST|-2d.s -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Vc2d.s 2a3cd.s 1cL0 1qp0 Xz0 19B0 19X0 1fB0 1db0 1cp0 1cL0 1fB0 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1o30 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|32e4","Asia/Novokuznetsk|LMT +06 +07 +08|-5M.M -60 -70 -80|012323232323232323232321232323232323232323232323232323232323212|-1PctM.M eULM.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|55e4","Asia/Novosibirsk|LMT +06 +07 +08|-5v.E -60 -70 -80|0123232323232323232323212323212121212121212121212121212121212121212|-21Qnv.E pAFv.E 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 ml0 Os0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 4eN0|15e5","Asia/Omsk|LMT +05 +06 +07|-4R.u -50 -60 -70|01232323232323232323232123232323232323232323232323232323232323232|-224sR.u pMLR.u 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|12e5","Asia/Oral|LMT +03 +05 +06 +04|-3p.o -30 -50 -60 -40|01232323232323232424242424242424242424242424242|-1Pc3p.o eUop.o 23CK0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 1cM0 IM0 1EM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|27e4","Asia/Pontianak|LMT PMT +0730 +09 +08 WITA WIB|-7h.k -7h.k -7u -90 -80 -80 -70|012324256|-2ua7h.k XE00 munL.k 8Rau 6kpu 4PXu xhcu Wqnu|23e4","Asia/Pyongyang|LMT KST JST KST|-8n -8u -90 -90|012313|-2um8n 97XR 1lTzu 2Onc0 6BA0|29e5","Asia/Qostanay|LMT +04 +05 +06|-4e.s -40 -50 -60|012323232323232323232123232323232323232323232323|-1Pc4e.s eUoe.s 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0","Asia/Qyzylorda|LMT +04 +05 +06|-4l.Q -40 -50 -60|01232323232323232323232323232323232323232323232|-1Pc4l.Q eUol.Q 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 3ao0 1EM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 zQl0|73e4","Asia/Rangoon|RMT +0630 +09|-6o.L -6u -90|0121|-21Jio.L SmnS.L 7j9u|48e5","Asia/Sakhalin|LMT +09 +11 +12 +10|-9u.M -90 -b0 -c0 -a0|01232323232323232323232423232323232424242424242424242424242424242|-2AGVu.M 1BoMu.M 1qFa0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 2pB0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0|58e4","Asia/Samarkand|LMT +04 +05 +06|-4r.R -40 -50 -60|01232323232323232323232|-1Pc4r.R eUor.R 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0|36e4","Asia/Seoul|LMT KST JST KST KDT KDT|-8r.Q -8u -90 -90 -9u -a0|0123141414141414135353|-2um8r.Q 97XV.Q 1m1zu kKo0 2I0u OL0 1FB0 Rb0 1qN0 TX0 1tB0 TX0 1tB0 TX0 1tB0 TX0 2ap0 12FBu 11A0 1o00 11A0|23e6","Asia/Srednekolymsk|LMT +10 +11 +12|-ae.Q -a0 -b0 -c0|01232323232323232323232123232323232323232323232323232323232323232|-1Pcae.Q eUoe.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|35e2","Asia/Taipei|CST JST CDT|-80 -90 -90|01020202020202020202020202020202020202020|-1iw80 joM0 1yo0 Tz0 1ip0 1jX0 1cN0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 10N0 1BX0 10p0 1pz0 10p0 1pz0 10p0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1BB0 ML0 1Bd0 ML0 uq10 1db0 1cN0 1db0 97B0 AL0|74e5","Asia/Tashkent|LMT +05 +06 +07|-4B.b -50 -60 -70|012323232323232323232321|-1Pc4B.b eUnB.b 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0|23e5","Asia/Tbilisi|TBMT +03 +04 +05|-2X.b -30 -40 -50|0123232323232323232323212121232323232323232323212|-1Pc2X.b 1jUnX.b WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cK0 1cL0 1cN0 1cL0 1cN0 2pz0 1cL0 1fB0 3Nz0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 An0 Os0 WM0|11e5","Asia/Tehran|LMT TMT +0330 +04 +05 +0430|-3p.I -3p.I -3u -40 -50 -4u|01234325252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2btDp.I 1d3c0 1huLT.I TXu 1pz0 sN0 vAu 1cL0 1dB0 1en0 pNB0 UL0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 64p0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Thimphu|LMT +0530 +06|-5W.A -5u -60|012|-Su5W.A 1BGMs.A|79e3","Asia/Tokyo|JST JDT|-90 -a0|010101010|-QJJ0 Rb0 1ld0 14n0 1zd0 On0 1zd0 On0|38e6","Asia/Tomsk|LMT +06 +07 +08|-5D.P -60 -70 -80|0123232323232323232323212323232323232323232323212121212121212121212|-21NhD.P pxzD.P 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 co0 1bB0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3Qp0|10e5","Asia/Ulaanbaatar|LMT +07 +08 +09|-77.w -70 -80 -90|012323232323232323232323232323232323232323232323232|-2APH7.w 2Uko7.w cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 kEp0 1cJ0 1cP0 1cJ0|12e5","Asia/Ust-Nera|LMT +08 +09 +12 +11 +10|-9w.S -80 -90 -c0 -b0 -a0|012343434343434343434345434343434343434343434343434343434343434345|-21Q9w.S pApw.S 23CL0 1d90 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0|65e2","Asia/Vladivostok|LMT +09 +10 +11|-8L.v -90 -a0 -b0|01232323232323232323232123232323232323232323232323232323232323232|-1SJIL.v itXL.v 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|60e4","Asia/Yakutsk|LMT +08 +09 +10|-8C.W -80 -90 -a0|01232323232323232323232123232323232323232323232323232323232323232|-21Q8C.W pAoC.W 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|28e4","Asia/Yekaterinburg|LMT PMT +04 +05 +06|-42.x -3J.5 -40 -50 -60|012343434343434343434343234343434343434343434343434343434343434343|-2ag42.x 7mQh.s qBvJ.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|14e5","Asia/Yerevan|LMT +03 +04 +05|-2W -30 -40 -50|0123232323232323232323212121212323232323232323232323232323232|-1Pc2W 1jUnW WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 4RX0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|13e5","Atlantic/Azores|HMT -02 -01 +00 WET|1S.w 20 10 0 0|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121232323232323232323232323232323234323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2ldW0 aPX0 Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|25e4","Atlantic/Bermuda|LMT AST ADT|4j.i 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1BnRE.G 1LTbE.G 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|65e3","Atlantic/Canary|LMT -01 WET WEST|11.A 10 0 -10|01232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UtaW.o XPAW.o 1lAK0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Atlantic/Cape_Verde|LMT -02 -01|1y.4 20 10|01212|-2ldW0 1eEo0 7zX0 1djf0|50e4","Atlantic/Faroe|LMT WET WEST|r.4 0 -10|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2uSnw.U 2Wgow.U 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|49e3","Atlantic/Madeira|FMT -01 +00 +01 WET WEST|17.A 10 0 -10 0 -10|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2ldX0 aPX0 Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e4","Atlantic/Reykjavik|LMT -01 +00 GMT|1s 10 0 0|012121212121212121212121212121212121212121212121212121212121212121213|-2uWmw mfaw 1Bd0 ML0 1LB0 Cn0 1LB0 3fX0 C10 HrX0 1cO0 LB0 1EL0 LA0 1C00 Oo0 1wo0 Rc0 1wo0 Rc0 1wo0 Rc0 1zc0 Oo0 1zc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0|12e4","Atlantic/South_Georgia|-02|20|0||30","Atlantic/Stanley|SMT -04 -03 -02|3P.o 40 30 20|012121212121212323212121212121212121212121212121212121212121212121212|-2kJw8.A 12bA8.A 19X0 1fB0 19X0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 Cn0 1Cc10 WL0 1qL0 U10 1tz0 2mN0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 U10 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qN0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 U10 1tz0 U10 1tz0 U10|21e2","Australia/Sydney|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|40e5","Australia/Adelaide|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 WM0 1qM0 Rc0 1zc0 U00 1tA0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST AEDT|-a0 -b0|01010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0|20e5","Australia/Broken_Hill|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|18e3","Australia/Currie|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|746","Australia/Darwin|ACST ACDT|-9u -au|010101010|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0|12e4","Australia/Eucla|+0845 +0945|-8J -9J|0101010101010101010|-293kI xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0|368","Australia/Hobart|AEST AEDT|-a0 -b0|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 VfB0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|21e4","Australia/Lord_Howe|AEST +1030 +1130 +11|-a0 -au -bu -b0|0121212121313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313|raC0 1zdu Rb0 1zd0 On0 1zd0 On0 1zd0 On0 1zd0 TXu 1qMu WLu 1tAu WLu 1tAu TXu 1tAu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu 11zu 1o0u 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 11Au 1nXu 1qMu 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu 11zu 1o0u WLu 1qMu 14nu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu|347","Australia/Lindeman|AEST AEDT|-a0 -b0|010101010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0|10","Australia/Melbourne|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1qM0 11A0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|39e5","Australia/Perth|AWST AWDT|-80 -90|0101010101010101010|-293jX xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0|18e5","CET|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Pacific/Easter|EMT -07 -06 -05|7h.s 70 60 50|012121212121212121212121212123232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1uSgG.w 1s4IG.w WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 2pA0 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0|30e2","CST6CDT|CST CDT CWT CPT|60 50 50 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","EET|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Dublin|DMT IST GMT BST IST|p.l -y.D 0 -10 -10|01232323232324242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242|-2ax9y.D Rc0 1fzy.D 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 g600 14o0 1wo0 17c0 1io0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","EST|EST|50|0|","EST5EDT|EST EDT EWT EPT|50 40 40 40|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 SgN0 8x40 iv0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Etc/GMT-0|GMT|0|0|","Etc/GMT-1|+01|-10|0|","Pacific/Port_Moresby|+10|-a0|0||25e4","Etc/GMT-11|+11|-b0|0|","Pacific/Tarawa|+12|-c0|0||29e3","Etc/GMT-13|+13|-d0|0|","Etc/GMT-14|+14|-e0|0|","Etc/GMT-2|+02|-20|0|","Etc/GMT-3|+03|-30|0|","Etc/GMT-4|+04|-40|0|","Etc/GMT-5|+05|-50|0|","Etc/GMT-6|+06|-60|0|","Indian/Christmas|+07|-70|0||21e2","Etc/GMT-8|+08|-80|0|","Pacific/Palau|+09|-90|0||21e3","Etc/GMT+1|-01|10|0|","Etc/GMT+10|-10|a0|0|","Etc/GMT+11|-11|b0|0|","Etc/GMT+12|-12|c0|0|","Etc/GMT+3|-03|30|0|","Etc/GMT+4|-04|40|0|","Etc/GMT+5|-05|50|0|","Etc/GMT+6|-06|60|0|","Etc/GMT+7|-07|70|0|","Etc/GMT+8|-08|80|0|","Etc/GMT+9|-09|90|0|","Etc/UTC|UTC|0|0|","Europe/Amsterdam|AMT NST +0120 +0020 CEST CET|-j.w -1j.w -1k -k -20 -10|010101010101010101010101010101010101010101012323234545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545|-2aFcj.w 11b0 1iP0 11A0 1io0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1co0 1io0 1yo0 Pc0 1a00 1fA0 1Bc0 Mo0 1tc0 Uo0 1tA0 U00 1uo0 W00 1s00 VA0 1so0 Vc0 1sM0 UM0 1wo0 Rc0 1u00 Wo0 1rA0 W00 1s00 VA0 1sM0 UM0 1w00 fV0 BCX.w 1tA0 U00 1u00 Wo0 1sm0 601k WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|16e5","Europe/Andorra|WET CET CEST|0 -10 -20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-UBA0 1xIN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|79e3","Europe/Astrakhan|LMT +03 +04 +05|-3c.c -30 -40 -50|012323232323232323212121212121212121212121212121212121212121212|-1Pcrc.c eUMc.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0|10e5","Europe/Athens|AMT EET EEST CEST CET|-1y.Q -20 -30 -20 -10|012123434121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a61x.Q CNbx.Q mn0 kU10 9b0 3Es0 Xa0 1fb0 1dd0 k3X0 Nz0 SCp0 1vc0 SO0 1cM0 1a00 1ao0 1fc0 1a10 1fG0 1cg0 1dX0 1bX0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|35e5","Europe/London|GMT BST BDST|0 -10 -20|0101010101010101010101010101010101010101010101010121212121210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|10e6","Europe/Belgrade|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19RC0 3IP0 WM0 1fA0 1cM0 1cM0 1rc0 Qo0 1vmo0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Berlin|CET CEST CEMT|-10 -20 -30|01010101010101210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 kL0 Nc0 m10 WM0 1ao0 1cp0 dX0 jz0 Dd0 1io0 17c0 1fA0 1a00 1ehA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e5","Europe/Prague|CET CEST GMT|-10 -20 0|01010101010101010201010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 1cM0 1qM0 11c0 mp0 xA0 mn0 17c0 1io0 17c0 1fc0 1ao0 1bNc0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|13e5","Europe/Brussels|WET CET CEST WEST|0 -10 -20 -10|0121212103030303030303030303030303030303030303030303212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ehc0 3zX0 11c0 1iO0 11A0 1o00 11A0 my0 Ic0 1qM0 Rc0 1EM0 UM0 1u00 10o0 1io0 1io0 17c0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a30 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 y00 5Wn0 WM0 1fA0 1cM0 16M0 1iM0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|21e5","Europe/Bucharest|BMT EET EEST|-1I.o -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1xApI.o 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Axc0 On0 1fA0 1a10 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|19e5","Europe/Budapest|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1ip0 17b0 1op0 1tb0 Q2m0 3Ne0 WM0 1fA0 1cM0 1cM0 1oJ0 1dc0 1030 1fA0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1iM0 1fA0 8Ha0 Rb0 1wN0 Rb0 1BB0 Lz0 1C20 LB0 SNX0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e5","Europe/Zurich|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19Lc0 11A0 1o00 11A0 1xG10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|38e4","Europe/Chisinau|CMT BMT EET EEST CEST CET MSK MSD|-1T -1I.o -20 -30 -20 -10 -30 -40|012323232323232323234545467676767676767676767323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-26jdT wGMa.A 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 27A0 2en0 39g0 WM0 1fA0 1cM0 V90 1t7z0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 gL0 WO0 1cM0 1cM0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11D0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|67e4","Europe/Copenhagen|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 Tz0 VuO0 60q0 WM0 1fA0 1cM0 1cM0 1cM0 S00 1HA0 Nc0 1C00 Dc0 1Nc0 Ao0 1h5A0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Gibraltar|GMT BST BDST CET CEST|0 -10 -20 -10 -20|010101010101010101010101010101010101010101010101012121212121010121010101010101010101034343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 10Jz0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|30e3","Europe/Helsinki|HMT EET EEST|-1D.N -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1WuND.N OULD.N 1dA0 1xGq0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Kaliningrad|CET CEST CET CEST MSK MSD EEST EET +03|-10 -20 -20 -30 -30 -40 -30 -20 -30|0101010101010232454545454545454546767676767676767676767676767676767676767676787|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 Am0 Lb0 1en0 op0 1pNz0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|44e4","Europe/Kiev|KMT EET MSK CEST CET MSD EEST|-22.4 -20 -30 -20 -10 -40 -30|0123434252525252525252525256161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc22.4 eUo2.4 rnz0 2Hg0 WM0 1fA0 da0 1v4m0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 Db0 3220 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|34e5","Europe/Kirov|LMT +03 +04 +05|-3i.M -30 -40 -50|01232323232323232321212121212121212121212121212121212121212121|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|48e4","Europe/Lisbon|LMT WET WEST WEMT CET CEST|A.J 0 -10 -20 -10 -20|012121212121212121212121212121212121212121212321232123212321212121212121212121212121212121212121214121212121212121212121212121212124545454212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2le00 aPX0 Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 pvy0 1cM0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e5","Europe/Luxembourg|LMT CET CEST WET WEST WEST WET|-o.A -10 -20 0 -10 -20 -10|0121212134343434343434343434343434343434343434343434565651212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2DG0o.A t6mo.A TB0 1nX0 Up0 1o20 11A0 rW0 CM0 1qP0 R90 1EO0 UK0 1u20 10m0 1ip0 1in0 17e0 19W0 1fB0 1db0 1cp0 1in0 17d0 1fz0 1a10 1in0 1a10 1in0 17f0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 vA0 60L0 WM0 1fA0 1cM0 17c0 1io0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Europe/Madrid|WET WEST WEMT CET CEST|0 -10 -20 -10 -20|010101010101010101210343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-25Td0 19B0 1cL0 1dd0 b1z0 18p0 3HX0 17d0 1fz0 1a10 1io0 1a00 1in0 17d0 iIn0 Hd0 1cL0 bb0 1200 2s20 14n0 5aL0 Mp0 1vz0 17d0 1in0 17d0 1in0 17d0 1in0 17d0 6hX0 11B0 XHX0 1a10 1fz0 1a10 19X0 1cN0 1fz0 1a10 1fC0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|62e5","Europe/Malta|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2arB0 Lz0 1cN0 1db0 1410 1on0 Wp0 1qL0 17d0 1cL0 M3B0 5M20 WM0 1fA0 1co0 17c0 1iM0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 LA0 1C00 LA0 1EM0 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1co0 1cM0 1lA0 Xc0 1qq0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1iN0 19z0 1fB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|42e4","Europe/Minsk|MMT EET MSK CEST CET MSD EEST +03|-1O -20 -30 -20 -10 -40 -30 -30|01234343252525252525252525261616161616161616161616161616161616161617|-1Pc1O eUnO qNX0 3gQ0 WM0 1fA0 1cM0 Al0 1tsn0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 3Fc0 1cN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0|19e5","Europe/Monaco|PMT WET WEST WEMT CET CEST|-9.l 0 -10 -20 -10 -20|01212121212121212121212121212121212121212121212121232323232345454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 2RV0 11z0 11B0 1ze0 WM0 1fA0 1cM0 1fa0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|38e3","Europe/Moscow|MMT MMT MST MDST MSD MSK +05 EET EEST MSK|-2u.h -2v.j -3v.j -4v.j -40 -30 -50 -20 -30 -40|012132345464575454545454545454545458754545454545454545454545454545454545454595|-2ag2u.h 2pyW.W 1bA0 11X0 GN0 1Hb0 c4v.j ik0 3DA0 dz0 15A0 c10 2q10 iM10 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|16e6","Europe/Paris|PMT WET WEST CEST CET WEMT|-9.l 0 -10 -20 -10 -20|0121212121212121212121212121212121212121212121212123434352543434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-2nco8.l cNb8.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 Ik0 5M30 WM0 1fA0 1cM0 Vx0 hB0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e6","Europe/Riga|RMT LST EET MSK CEST CET MSD EEST|-1A.y -2A.y -20 -30 -20 -10 -40 -30|010102345454536363636363636363727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272|-25TzA.y 11A0 1iM0 ko0 gWm0 yDXA.y 2bX0 3fE0 WM0 1fA0 1cM0 1cM0 4m0 1sLy0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 1o00 11A0 1o00 11A0 1qM0 3oo0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|64e4","Europe/Rome|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2arB0 Lz0 1cN0 1db0 1410 1on0 Wp0 1qL0 17d0 1cL0 M3B0 5M20 WM0 1fA0 1cM0 16M0 1iM0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 LA0 1C00 LA0 1EM0 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1C00 LA0 1zc0 Oo0 1C00 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1zc0 Oo0 1fC0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|39e5","Europe/Samara|LMT +03 +04 +05|-3k.k -30 -40 -50|0123232323232323232121232323232323232323232323232323232323212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 2y10 14m0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|12e5","Europe/Saratov|LMT +03 +04 +05|-34.i -30 -40 -50|012323232323232321212121212121212121212121212121212121212121212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1cM0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 5810","Europe/Simferopol|SMT EET MSK CEST CET MSD EEST MSK|-2g -20 -30 -20 -10 -40 -30 -40|012343432525252525252525252161616525252616161616161616161616161616161616172|-1Pc2g eUog rEn0 2qs0 WM0 1fA0 1cM0 3V0 1u0L0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 4eL0 1cL0 1cN0 1cL0 1cN0 dX0 WL0 1cN0 1cL0 1fB0 1o30 11B0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0|33e4","Europe/Sofia|EET CET CEST EEST|-20 -10 -20 -30|01212103030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030|-168L0 WM0 1fA0 1cM0 1cM0 1cN0 1mKH0 1dd0 1fb0 1ap0 1fb0 1a20 1fy0 1a30 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Stockholm|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 TB0 2yDe0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|15e5","Europe/Tallinn|TMT CET CEST EET MSK MSD EEST|-1D -10 -20 -20 -30 -40 -30|012103421212454545454545454546363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363|-26oND teD 11A0 1Ta0 4rXl KSLD 2FX0 2Jg0 WM0 1fA0 1cM0 18J0 1sTX0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o10 11A0 1qM0 5QM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e4","Europe/Tirane|LMT CET CEST|-1j.k -10 -20|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2glBj.k 14pcj.k 5LC0 WM0 4M0 1fCK0 10n0 1op0 11z0 1pd0 11z0 1qN0 WL0 1qp0 Xb0 1qp0 Xb0 1qp0 11z0 1lB0 11z0 1qN0 11z0 1iN0 16n0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|42e4","Europe/Ulyanovsk|LMT +03 +04 +05 +02|-3d.A -30 -40 -50 -20|01232323232323232321214121212121212121212121212121212121212121212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0|13e5","Europe/Uzhgorod|CET CEST MSK MSD EET EEST|-10 -20 -30 -40 -20 -30|010101023232323232323232320454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-1cqL0 6i00 WM0 1fA0 1cM0 1ml0 1Cp0 1r3W0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 1Nf0 2pw0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e4","Europe/Vienna|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 3KM0 14o0 LA00 6i00 WM0 1fA0 1cM0 1cM0 1cM0 400 2qM0 1a00 1cM0 1cM0 1io0 17c0 1gHa0 19X0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|18e5","Europe/Vilnius|WMT KMT CET EET MSK CEST MSD EEST|-1o -1z.A -10 -20 -30 -20 -40 -30|012324525254646464646464646473737373737373737352537373737373737373737373737373737373737373737373737373737373737373737373|-293do 6ILM.o 1Ooz.A zz0 Mfd0 29W0 3is0 WM0 1fA0 1cM0 LV0 1tgL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11B0 1o00 11A0 1qM0 8io0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Europe/Volgograd|LMT +03 +04 +05|-2V.E -30 -40 -50|012323232323232321212121212121212121212121212121212121212121212|-21IqV.E psLV.E 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1cM0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 9Jd0|10e5","Europe/Warsaw|WMT CET CEST EET EEST|-1o -10 -20 -20 -30|012121234312121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ctdo 1LXo 11d0 1iO0 11A0 1o00 11A0 1on0 11A0 6zy0 HWP0 5IM0 WM0 1fA0 1cM0 1dz0 1mL0 1en0 15B0 1aq0 1nA0 11A0 1io0 17c0 1fA0 1a00 iDX0 LA0 1cM0 1cM0 1C00 Oo0 1cM0 1cM0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1C00 LA0 uso0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e5","Europe/Zaporozhye|+0220 EET MSK CEST CET MSD EEST|-2k -20 -30 -20 -10 -40 -30|01234342525252525252525252526161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc2k eUok rdb0 2RE0 WM0 1fA0 8m0 1v9a0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cK0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|77e4","HST|HST|a0|0|","Indian/Chagos|LMT +05 +06|-4N.E -50 -60|012|-2xosN.E 3AGLN.E|30e2","Indian/Cocos|+0630|-6u|0||596","Indian/Kerguelen|-00 +05|0 -50|01|-MG00|130","Indian/Mahe|LMT +04|-3F.M -40|01|-2yO3F.M|79e3","Indian/Maldives|MMT +05|-4S -50|01|-olgS|35e4","Indian/Mauritius|LMT +04 +05|-3O -40 -50|012121|-2xorO 34unO 14L0 12kr0 11z0|15e4","Indian/Reunion|LMT +04|-3F.Q -40|01|-2mDDF.Q|84e4","Pacific/Kwajalein|+11 +10 +09 -12 +12|-b0 -a0 -90 c0 -c0|012034|-1kln0 akp0 6Up0 12ry0 Wan0|14e3","MET|MET MEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","MST|MST|70|0|","MST7MDT|MST MDT MWT MPT|70 60 60 60|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Chatham|+1215 +1245 +1345|-cf -cJ -dJ|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-WqAf 1adef IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|600","Pacific/Apia|LMT -1130 -11 -10 +14 +13|bq.U bu b0 a0 -e0 -d0|01232345454545454545454545454545454545454545454545454545454|-2nDMx.4 1yW03.4 2rRbu 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|37e3","Pacific/Bougainville|+10 +09 +11|-a0 -90 -b0|0102|-16Wy0 7CN0 2MQp0|18e4","Pacific/Chuuk|+10 +09|-a0 -90|01010|-2ewy0 axB0 RVX0 axd0|49e3","Pacific/Efate|LMT +11 +12|-bd.g -b0 -c0|0121212121212121212121|-2l9nd.g 2Szcd.g 1cL0 1oN0 10L0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 Lz0 1Nd0 An0|66e3","Pacific/Enderbury|-12 -11 +13|c0 b0 -d0|012|nIc0 B7X0|1","Pacific/Fakaofo|-11 +13|b0 -d0|01|1Gfn0|483","Pacific/Fiji|LMT +12 +13|-bT.I -c0 -d0|0121212121212121212121212121212121212121212121212121212121212121|-2bUzT.I 3m8NT.I LA0 1EM0 IM0 nJc0 LA0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0|88e4","Pacific/Galapagos|LMT -05 -06|5W.o 50 60|01212|-1yVS1.A 2dTz1.A gNd0 rz0|25e3","Pacific/Gambier|LMT -09|8X.M 90|01|-2jof0.c|125","Pacific/Guadalcanal|LMT +11|-aD.M -b0|01|-2joyD.M|11e4","Pacific/Guam|GST +09 GDT ChST|-a0 -90 -b0 -a0|01020202020202020203|-18jK0 6pB0 AhB0 3QL0 g2p0 3p91 WOX rX0 1zd0 Rb0 1wp0 Rb0 5xd0 rX0 5sN0 zb1 1C0X On0 ULb0|17e4","Pacific/Honolulu|HST HDT HWT HPT HST|au 9u 9u 9u a0|0102304|-1thLu 8x0 lef0 8wWu iAu 46p0|37e4","Pacific/Kiritimati|-1040 -10 +14|aE a0 -e0|012|nIaE B7Xk|51e2","Pacific/Kosrae|+11 +09 +10 +12|-b0 -90 -a0 -c0|01021030|-2ewz0 axC0 HBy0 akp0 axd0 WOK0 1bdz0|66e2","Pacific/Majuro|+11 +09 +10 +12|-b0 -90 -a0 -c0|0102103|-2ewz0 axC0 HBy0 akp0 6RB0 12um0|28e3","Pacific/Marquesas|LMT -0930|9i 9u|01|-2joeG|86e2","Pacific/Pago_Pago|LMT SST|bm.M b0|01|-2nDMB.c|37e2","Pacific/Nauru|LMT +1130 +09 +12|-b7.E -bu -90 -c0|01213|-1Xdn7.E QCnB.E 7mqu 1lnbu|10e3","Pacific/Niue|-1120 -1130 -11|bk bu b0|012|-KfME 17y0a|12e2","Pacific/Norfolk|+1112 +1130 +1230 +11|-bc -bu -cu -b0|01213|-Kgbc W01G On0 1COp0|25e4","Pacific/Noumea|LMT +11 +12|-b5.M -b0 -c0|01212121|-2l9n5.M 2EqM5.M xX0 1PB0 yn0 HeP0 Ao0|98e3","Pacific/Pitcairn|-0830 -08|8u 80|01|18Vku|56","Pacific/Pohnpei|+11 +09 +10|-b0 -90 -a0|010210|-2ewz0 axC0 HBy0 akp0 axd0|34e3","Pacific/Rarotonga|-1030 -0930 -10|au 9u a0|012121212121212121212121212|lyWu IL0 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu|13e3","Pacific/Tahiti|LMT -10|9W.g a0|01|-2joe1.I|18e4","Pacific/Tongatapu|+1220 +13 +14|-ck -d0 -e0|0121212121|-1aB0k 2n5dk 15A0 1wo0 xz0 1Q10 xz0 zWN0 s00|75e3","PST8PDT|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","WET|WET WEST|0 -10|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00"],
links:["Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|Atlantic/St_Helena","Africa/Cairo|Egypt","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|US/Alaska","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Catamarca|America/Argentina/ComodRivadavia","America/Argentina/Catamarca|America/Catamarca","America/Argentina/Cordoba|America/Cordoba","America/Argentina/Cordoba|America/Rosario","America/Argentina/Jujuy|America/Jujuy","America/Argentina/Mendoza|America/Mendoza","America/Atikokan|America/Coral_Harbour","America/Chicago|US/Central","America/Curacao|America/Aruba","America/Curacao|America/Kralendijk","America/Curacao|America/Lower_Princes","America/Denver|America/Shiprock","America/Denver|Navajo","America/Denver|US/Mountain","America/Detroit|US/Michigan","America/Edmonton|Canada/Mountain","America/Fort_Wayne|America/Indiana/Indianapolis","America/Fort_Wayne|America/Indianapolis","America/Fort_Wayne|US/East-Indiana","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/Indiana/Knox|America/Knox_IN","America/Indiana/Knox|US/Indiana-Starke","America/Jamaica|Jamaica","America/Kentucky/Louisville|America/Louisville","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Manaus|Brazil/West","America/Mazatlan|Mexico/BajaSur","America/Mexico_City|Mexico/General","America/New_York|US/Eastern","America/Noronha|Brazil/DeNoronha","America/Panama|America/Cayman","America/Phoenix|US/Arizona","America/Port_of_Spain|America/Anguilla","America/Port_of_Spain|America/Antigua","America/Port_of_Spain|America/Dominica","America/Port_of_Spain|America/Grenada","America/Port_of_Spain|America/Guadeloupe","America/Port_of_Spain|America/Marigot","America/Port_of_Spain|America/Montserrat","America/Port_of_Spain|America/St_Barthelemy","America/Port_of_Spain|America/St_Kitts","America/Port_of_Spain|America/St_Lucia","America/Port_of_Spain|America/St_Thomas","America/Port_of_Spain|America/St_Vincent","America/Port_of_Spain|America/Tortola","America/Port_of_Spain|America/Virgin","America/Regina|Canada/Saskatchewan","America/Rio_Branco|America/Porto_Acre","America/Rio_Branco|Brazil/Acre","America/Santiago|Chile/Continental","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","America/Tijuana|America/Ensenada","America/Tijuana|America/Santa_Isabel","America/Tijuana|Mexico/BajaNorte","America/Toronto|America/Montreal","America/Toronto|Canada/Eastern","America/Vancouver|Canada/Pacific","America/Whitehorse|Canada/Yukon","America/Winnipeg|Canada/Central","Asia/Ashgabat|Asia/Ashkhabad","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Vientiane","Asia/Dhaka|Asia/Dacca","Asia/Dubai|Asia/Muscat","Asia/Ho_Chi_Minh|Asia/Saigon","Asia/Hong_Kong|Hongkong","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Singapore","Asia/Macau|Asia/Macao","Asia/Makassar|Asia/Ujung_Pandang","Asia/Nicosia|Europe/Nicosia","Asia/Qatar|Asia/Bahrain","Asia/Rangoon|Asia/Yangon","Asia/Riyadh|Asia/Aden","Asia/Riyadh|Asia/Kuwait","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|PRC","Asia/Taipei|ROC","Asia/Tehran|Iran","Asia/Thimphu|Asia/Thimbu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Urumqi|Asia/Kashgar","Atlantic/Faroe|Atlantic/Faeroe","Atlantic/Reykjavik|Iceland","Atlantic/South_Georgia|Etc/GMT+2","Australia/Adelaide|Australia/South","Australia/Brisbane|Australia/Queensland","Australia/Broken_Hill|Australia/Yancowinna","Australia/Darwin|Australia/North","Australia/Hobart|Australia/Tasmania","Australia/Lord_Howe|Australia/LHI","Australia/Melbourne|Australia/Victoria","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/NSW","Etc/GMT-0|Etc/GMT","Etc/GMT-0|Etc/GMT+0","Etc/GMT-0|Etc/GMT0","Etc/GMT-0|Etc/Greenwich","Etc/GMT-0|GMT","Etc/GMT-0|GMT+0","Etc/GMT-0|GMT-0","Etc/GMT-0|GMT0","Etc/GMT-0|Greenwich","Etc/UTC|Etc/UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UCT","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Belgrade|Europe/Ljubljana","Europe/Belgrade|Europe/Podgorica","Europe/Belgrade|Europe/Sarajevo","Europe/Belgrade|Europe/Skopje","Europe/Belgrade|Europe/Zagreb","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Helsinki|Europe/Mariehamn","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Portugal","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Oslo|Arctic/Longyearbyen","Europe/Oslo|Atlantic/Jan_Mayen","Europe/Prague|Europe/Bratislava","Europe/Rome|Europe/San_Marino","Europe/Rome|Europe/Vatican","Europe/Warsaw|Poland","Europe/Zurich|Europe/Busingen","Europe/Zurich|Europe/Vaduz","Indian/Christmas|Etc/GMT-7","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Chuuk|Pacific/Truk","Pacific/Chuuk|Pacific/Yap","Pacific/Easter|Chile/EasterIsland","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kwajalein|Kwajalein","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Palau|Etc/GMT-9","Pacific/Pohnpei|Pacific/Ponape","Pacific/Port_Moresby|Etc/GMT-10","Pacific/Tarawa|Etc/GMT-12","Pacific/Tarawa|Pacific/Funafuti","Pacific/Tarawa|Pacific/Wake","Pacific/Tarawa|Pacific/Wallis"]}},function(e,t,i){var n=i(183).dimensions,o={0:"amu_id",1:"weapon_id",2:"ringl_id",3:"belt_id",4:"ringr_id",5:"boots_id",6:"hat_id",7:"cloack_id",8:"pet_id",15:"shield_id"};t.addEquippedItem=function(e,t){var i=t.inventory.equippedItems;for(var n in o){var s=i[n],a=o[n];s?s.getProperty?e[a]=s.getProperty("objectGID"):(console.error(new Error("analytics#addEquippedItem: getProperty is not a function. posId: "+n+", itemName: "+a+", objectGID: "+s.objectGID+", id: "+s.id)),e[a]=void 0):e[a]=void 0}e.comp_id=void 0;var r=t.equippedMount;t.isRiding&&r&&r.model?e.ride_id=r.model:e.ride_id=void 0},t.addCharacterInfo=function(e){if(window.gui.playerData){var t=window.gui.playerData,i=t.characterBaseInformations||{},n=t.position||{};e.server_id=window.gui.serversData.connectedServerId,e.character_id=t.id,e.character_level=i.level,e.soft_currency_balance=t.inventory.kamas,e.hard_currency_balance=t.inventory.goultines,e.map_id=n.mapId}},t.addAccountId=function(e){var t=window.gui.playerData;t&&t.identification&&(e.account_id=t.identification.accountId)},t.addResolution=function(e){e.dimensions=n.screenWidth+"_"+n.screenHeight},t.addSubscriptionInfo=function(e){e.subscription_days=window.gui.playerData.getSubscriptionDays()}},function(e,t,i){function n(){f.viewportWidth=f.viewportWidth||document.documentElement.clientWidth,f.viewportHeight=f.viewportHeight||document.documentElement.clientHeight,f.screenWidth=f.viewportWidth-(f.bodyPaddingLeft+f.bodyPaddingRight),f.screenHeight=f.viewportHeight,f.windowFullScreenWidth=f.screenWidth,f.windowFullScreenHeight=f.screenHeight,f.physicalToViewportRatio=f.viewportWidth/f.physicalScreenWidth}function o(e){var t=e/c.MAP_SCENE_HEIGHT;f.mapWidth=~~(c.MAP_SCENE_WIDTH*t),f.mapHeight=~~(c.MAP_SCENE_HEIGHT*t),f.zoom=c.PIXEL_RATIO*t,f.sideBarWidth=f.screenWidth-f.mapWidth,f.bottomBarHeight=f.screenHeight-f.mapHeight}function s(e,t){var i,n,o;"narrow"===e?(i=f.screenWidth,n=c.CHAT_BTN_MIN_WIDTH,f.mainControlBarSize=132,o=c.PING_EMOTE_BTN_NARROW_MIN_WIDTH):(i=f.screenHeight,n=c.CHAT_BTN_MIN_HEIGHT,f.mainControlBarSize=72,o=c.PING_EMOTE_BTN_WIDE_MIN_HEIGHT);var s=0;"narrow"===e?(f.posChatBtn=s,s+=n,f.pingEmoteBtnSize=o,f.posPingEmoteBtn=s,s+=o):(f.pingEmoteBtnSize=o,o=0),f.posMainControlBar=s,s+=f.mainControlBarSize;var a=window.gui.shortcutBar,r=window.gui.menuBar,l=i-f.mainControlBarSize-n,d=t?u.menubarSizeInFight:u.menubarSize,h=r.computeMinimumSize(d,e),p=~~(l-h-o),m=a.computeBestSize(p,e),g=l-m-o-h;f.menuBarSize=h+g,f.shortcutBarSize=m,f.posShortcutBar=s,s+=f.shortcutBarSize,f.posMenuBar=s,s+=f.menuBarSize,"wide"===e&&(f.posChatBtn=s,f.posPingEmoteBtn=s)}function a(e){var t;return t="narrow"===e?window.gui.playerData.isFighting?u.toolbarThicknessInFight:1:3,t*c.SHORTCUT_ICON_SIZE+c.SHORTCUT_GAUGE_SIZE+5}function r(e){var t="narrow",i=f.screenHeight-a(t),n=i/c.MAP_SCENE_HEIGHT,r=~~(c.MAP_SCENE_WIDTH*n);r>f.screenWidth&&(n=f.screenWidth/c.MAP_SCENE_WIDTH,i=~~(c.MAP_SCENE_HEIGHT*n)),o(i),f.bottomBarHeight=Math.min(f.bottomBarHeight,d),s(t,e),f.mapLeft=Math.round(f.sideBarWidth/2),f.mapTop=f.screenHeight-f.bottomBarHeight-f.mapHeight,f.mapRight=f.mapLeft+f.mapWidth,f.mapBottom=f.mapTop+f.mapHeight,f.windowFullScreenWidth=f.screenWidth,f.windowFullScreenHeight=f.mapBottom,f.screenExceptToolbar={left:0,top:0,width:f.screenWidth,height:f.screenHeight-f.bottomBarHeight}}function l(e){var t="wide",i=f.screenWidth-a(t),n=i/c.MAP_SCENE_WIDTH,r=~~(c.MAP_SCENE_HEIGHT*n);o(Math.min(r,f.screenHeight)),f.sideBarWidth=Math.min(f.sideBarWidth,h),s(t,e),f.mapLeft=f.screenWidth-f.sideBarWidth-f.mapWidth,f.mapTop=Math.round(f.bottomBarHeight/2),f.mapRight=f.mapLeft+f.mapWidth,f.mapBottom=f.mapTop+f.mapHeight,f.windowFullScreenWidth=f.screenWidth,f.windowFullScreenHeight=f.screenHeight,f.screenExceptToolbar={left:0,top:0,width:f.screenWidth-f.sideBarWidth,height:f.screenHeight}}var c=i(184),u=i(190),d=175,h=310,p=document.body,m=window.getComputedStyle(p,null),f={bodyPaddingLeft:parseInt(m.getPropertyValue("padding-left"),10),bodyPaddingRight:parseInt(m.getPropertyValue("padding-right"),10),physicalScreenWidth:Math.max(window.screen.width,window.screen.height),physicalScreenHeight:Math.min(window.screen.width,window.screen.height)};n(),t.dimensions=f,t.updateScreen=n,t.resizeWideScreen=l,t.resizeNarrowScreen=r},function(e,t,i){var n=i(185),o=i(189),s=o();t.MAP_PATH="maps/",t.IMG_PATH="gfx/world/",t.SKIN_PATH="skins/",t.BONE_PATH="bones/",t.ICON_PATH="gfx/icons/",t.ORNAMENT_PATH="gfx/ornaments/",t.EMBEDDED_PATH="ui/embedded/",t.BACKGROUND_PATH="backgrounds/",t.FOREGROUND_PATH="foregrounds/",t.BITMAP_FONTS="ui/bitmapFonts/",t.WORLDMAP_PATH="gfx/maps/",t.LOADER_PATH="ui/loader/",t.MISSING_ANIM_PATH="bones/missingAnimList.json",t.CDV_PATH="cdvfile://localhost/persistent/data/assets",t.ITEM_DIR="gfx/items/",t.SPELL_DIR="gfx/spells/",t.MAP_SCENE_WIDTH_IN_CELLS=14.5,t.MAP_SCENE_HEIGHT_IN_CELLS=20.5,t.CELL_WIDTH=86,t.CELL_HEIGHT=43,t.CELL_SIDE=Math.sqrt(2*t.CELL_HEIGHT*t.CELL_HEIGHT),t.NB_CELLS=560,t.ELEMENT_TYPE_ID={UNSPECIFIED:-1,ZAAP:16,PADDOCK:120},t.HORIZONTAL_OFFSET=53,t.VERTICAL_OFFSET=15,t.WIDTH_PADDING=20,t.HEIGHT_PADDING=-16,t.MAP_BORDER_H=30,t.MAP_BORDER_V=20,t.GRID_ALTITUDE_OFFSET=22,t.ICONBAR_CORNER_HEIGHT=19,t.ICONBAR_CORNER_WIDTH=36,t.ICONBAR_TAB_WIDTH=42,t.ICONBAR_TAB_HEIGHT=35,t.SHORTCUT_ICON_SIZE=50,t.MENU_ICON_SIZE=42,t.SHORTCUT_GAUGE_SIZE=13,t.CHAT_BTN_MIN_WIDTH=68,t.CHAT_BTN_MIN_HEIGHT=50,t.BONUS_PACK_XP=150,t.BONUS_PACK_DROP=150,t.BONUS_PACK_XPJOB=50,t.PING_EMOTE_BTN_NARROW_MIN_WIDTH=50,t.PING_EMOTE_BTN_WIDE_MIN_HEIGHT=50,t.PING_EMOTE_BTN_WIDE_MIN_WIDTH=40,t.MAP_SCENE_WIDTH=t.CELL_WIDTH*t.MAP_SCENE_WIDTH_IN_CELLS+t.WIDTH_PADDING,t.MAP_SCENE_HEIGHT=t.CELL_HEIGHT*t.MAP_SCENE_HEIGHT_IN_CELLS+t.HEIGHT_PADDING,t.PIXEL_RATIO=s.devicePixelRatio?Math.min(s.devicePixelRatio,2):1,t.CHARACTER_COLORS=5,t.FPS=60,t.TIME_UNITS_PER_SECOND=25,t.ANIM_SYMETRY=[!1,!1,!1,!0,!0,!1,!1,!0],t.ANIM_SYMBOLS=[0,1,2,1,0,5,6,5],t.ANGLE_PER_DIRECTION=[0,Math.PI/8,Math.PI/2,Math.PI-Math.PI/8,Math.PI,Math.PI+Math.PI/8,-Math.PI/2,-Math.PI/8],t.MISSING_TEXTURE_IMAGE_SRC="data:image/gif;base64,R0lGODlhAQABAIAAAOAv/wAAACwAAAAAAQABAAACAkQBADs=",t.EMPTY_IMAGE=new s.Image,t.EMPTY_IMAGE.src=t.MISSING_TEXTURE_IMAGE_SRC,t.EMPTY_JSON={},t.MAP_LAYER_BACKGROUND=-1,t.MAP_LAYER_PLAYGROUND=0,t.MAP_LAYER_FOREGROUND=1,t.MAP_LAYER_TRANSPARENT=2,t.MAP_LAYER_ICONS=3,t.MAP_LAYER_POINT_LABELS=4,t.MAP_LAYER_TAP_FEEDBACK=5,t.MAP_LAYER_TARGET_INDICATOR=6,t.TRANSPARENT_MODE_ALPHA=.725;var a=153600,r=1024e3,l=120;if(n.isPhoneGap){var c=n.capacity||536870912,u=n.isAndroid?.3:.5,d=c*u*.4;t.MAX_MUSIC_SFX_MEMORY=Math.round(.43*d/a),t.MAX_TEXTURE_MEMORY_MAP=Math.round(.25*d),t.MAX_TEXTURE_MEMORY_WORLDMAP=Math.round(.1*d),t.MAX_TEXTURE_MEMORY_CHARACTER_DISPLAY=Math.round(.05*d),t.MAX_SPRITES_BUFFER_MAP=Math.max(Math.round(.04*d/l),2e4),t.MAX_SPRITES_BUFFER_WORLDMAP=Math.max(Math.round(.005*d/l),1e4),t.MAX_SPRITES_BUFFER_CHARACTER_DISPLAY=Math.max(Math.round(.005*d/l),4e3),t.MAX_ANIMATIONS=Math.round(.12*d/r)}else t.MAX_MUSIC_SFX_MEMORY=1e3,t.MAX_TEXTURE_MEMORY_MAP=104857600,t.MAX_TEXTURE_MEMORY_WORLDMAP=52428800,t.MAX_TEXTURE_MEMORY_CHARACTER_DISPLAY=20971520,t.MAX_SPRITES_BUFFER_MAP=8e4,t.MAX_SPRITES_BUFFER_WORLDMAP=1e4,t.MAX_SPRITES_BUFFER_CHARACTER_DISPLAY=9e3,t.MAX_ANIMATIONS=30;t.MAX_ZOOM_MAP=1.1,t.PRERENDER_RATIO_MAP=t.PIXEL_RATIO,t.PRERENDER_RATIO_WORLDMAP=t.PIXEL_RATIO,t.PRERENDER_RATIO_CHARACTER_DISPLAY=2*t.PIXEL_RATIO,t.TOTAL_MAP_ASSETS_SIZE_IN_GB=2,t.TOURNAMENT_TEST_SERVERID=310,t.TOURNAMENT_PROD_SERVERID=411,t.NEXT_SERVERID=300,t.WARN_INVENTORY_YELLOW_MIN=.75,t.WARN_INVENTORY_RED_MIN=1,t.TOA_RETRY_HC_PRICE=200,t.TOA_RETRY_TIMEOUT=6e4,t.TOA_RETRY_ITEM_ID=15824,t.TOA_QUEST_ID=1496,t.NB_PLAYER_PER_LADDER_PAGE=50,t.BASE_MONSTER_LEVEL=75,t.MAX_MONSTER_LEVEL=325,t.NB_SCALE_LEVEL=100},function(e,t,i){var n=i(186),o=i(187),s=window.navigator.userAgent,a=new n(s),r=a.getOS(),l=void 0!==window.device&&"string"==typeof window.device.model;t.osName=r.name,t.isIOS="iOS"===r.name,t.isAndroid="Android"===r.name,t.isDevice=t.isIOS||t.isAndroid,t.isPhoneGap=t.isCordova=!!(window.cordova||window.PhoneGap||window.phonegap),t.isIpad2=l&&"iPad2,"===window.device.model.substr(0,6),t.os=r.name.toLowerCase(),t.isIOSApp=window.device&&window.device.platform&&"iOS"===window.device.platform,t.isAndroidApp=window.device&&window.device.platform&&"Android"===window.device.platform,t.isAndroidLessThanFive=o.isItThatModel("Android","4.1",s,window.device)||o.isItThatModel("Android","4.2",s,window.device)||o.isItThatModel("Android","4.3",s,window.device)||o.isItThatModel("Android","4.4",s,window.device),t.isIOSEight=o.isItThatModel("iOS","8",s,window.device)},function(e,t,i){var n;/*!
	 * UAParser.js v0.7.20
	 * Lightweight JavaScript-based User-Agent string parser
	 * https://github.com/faisalman/ua-parser-js
	 *
	 * Copyright  2012-2019 Faisal Salman <f@faisalman.com>
	 * Licensed under MIT License
	 */
!function(o,s){"use strict";var a="0.7.20",r="",l="?",c="function",u="undefined",d="object",h="string",p="major",m="model",f="name",g="type",_="vendor",v="version",y="architecture",b="console",w="mobile",M="tablet",T="smarttv",C="wearable",I="embedded",A={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2===0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&t.toLowerCase().indexOf(e.toLowerCase())!==-1},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===h?e.replace(/[^\d\.]/g,"").split(".")[0]:s},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},S={rgx:function(e,t){for(var i,n,o,a,r,l,u=0;u<t.length&&!r;){var h=t[u],p=t[u+1];for(i=n=0;i<h.length&&!r;)if(r=h[i++].exec(e))for(o=0;o<p.length;o++)l=r[++n],a=p[o],typeof a===d&&a.length>0?2==a.length?typeof a[1]==c?this[a[0]]=a[1].call(this,l):this[a[0]]=a[1]:3==a.length?typeof a[1]!==c||a[1].exec&&a[1].test?this[a[0]]=l?l.replace(a[1],a[2]):s:this[a[0]]=l?a[1].call(this,l,a[2]):s:4==a.length&&(this[a[0]]=l?a[3].call(this,l.replace(a[1],a[2])):s):this[a]=l?l:s;u+=2}},str:function(e,t){for(var i in t)if(typeof t[i]===d&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(A.has(t[i][n],e))return i===l?s:i}else if(A.has(t[i],e))return i===l?s:i;return e}},E={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},x={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[f,v],[/(opios)[\/\s]+([\w\.]+)/i],[[f,"Opera Mini"],v],[/\s(opr)\/([\w\.]+)/i],[[f,"Opera"],v],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[f,v],[/(konqueror)\/([\w\.]+)/i],[[f,"Konqueror"],v],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[f,"IE"],v],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[f,"Edge"],v],[/(yabrowser)\/([\w\.]+)/i],[[f,"Yandex"],v],[/(puffin)\/([\w\.]+)/i],[[f,"Puffin"],v],[/(focus)\/([\w\.]+)/i],[[f,"Firefox Focus"],v],[/(opt)\/([\w\.]+)/i],[[f,"Opera Touch"],v],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[f,"UCBrowser"],v],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],v],[/(windowswechat qbcore)\/([\w\.]+)/i],[[f,"WeChat(Win) Desktop"],v],[/(micromessenger)\/([\w\.]+)/i],[[f,"WeChat"],v],[/(brave)\/([\w\.]+)/i],[[f,"Brave"],v],[/(qqbrowserlite)\/([\w\.]+)/i],[f,v],[/(QQ)\/([\d\.]+)/i],[f,v],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[f,v],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[f,v],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[f,v],[/(MetaSr)[\/\s]?([\w\.]+)/i],[f],[/(LBBROWSER)/i],[f],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[v,[f,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[v,[f,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[f,v],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[v,[f,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[f,/(.+)/,"$1 WebView"],v],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[f,/(.+(?:g|us))(.+)/,"$1 $2"],v],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[v,[f,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[f,"Sailfish Browser"],v],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[f,v],[/(dolfin)\/([\w\.]+)/i],[[f,"Dolphin"],v],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[f,"Chrome"],v],[/(coast)\/([\w\.]+)/i],[[f,"Opera Coast"],v],[/fxios\/([\w\.-]+)/i],[v,[f,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[v,[f,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[v,f],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[f,"GSA"],v],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[f,[v,S.str,E.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[f,v],[/(navigator|netscape)\/([\w\.-]+)/i],[[f,"Netscape"],v],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[f,v]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[y,"amd64"]],[/(ia32(?=;))/i],[[y,A.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[y,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[y,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[y,/ower/,"",A.lowerize]],[/(sun4\w)[;\)]/i],[[y,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[y,A.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[m,_,[g,M]],[/applecoremedia\/[\w\.]+ \((ipad)/],[m,[_,"Apple"],[g,M]],[/(apple\s{0,1}tv)/i],[[m,"Apple TV"],[_,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[_,m,[g,M]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[m,[_,"Amazon"],[g,M]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[m,S.str,E.device.amazon.model],[_,"Amazon"],[g,w]],[/android.+aft([bms])\sbuild/i],[m,[_,"Amazon"],[g,T]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[m,_,[g,w]],[/\((ip[honed|\s\w*]+);/i],[m,[_,"Apple"],[g,w]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[_,m,[g,w]],[/\(bb10;\s(\w+)/i],[m,[_,"BlackBerry"],[g,w]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[m,[_,"Asus"],[g,M]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[_,"Sony"],[m,"Xperia Tablet"],[g,M]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[m,[_,"Sony"],[g,w]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[_,m,[g,b]],[/android.+;\s(shield)\sbuild/i],[m,[_,"Nvidia"],[g,b]],[/(playstation\s[34portablevi]+)/i],[m,[_,"Sony"],[g,b]],[/(sprint\s(\w+))/i],[[_,S.str,E.device.sprint.vendor],[m,S.str,E.device.sprint.model],[g,w]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[_,[m,/_/g," "],[g,w]],[/(nexus\s9)/i],[m,[_,"HTC"],[g,M]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[m,[_,"Huawei"],[g,w]],[/(microsoft);\s(lumia[\s\w]+)/i],[_,m,[g,w]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[m,[_,"Microsoft"],[g,b]],[/(kin\.[onetw]{3})/i],[[m,/\./g," "],[_,"Microsoft"],[g,w]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[m,[_,"Motorola"],[g,w]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[m,[_,"Motorola"],[g,M]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[_,A.trim],[m,A.trim],[g,T]],[/hbbtv.+maple;(\d+)/i],[[m,/^/,"SmartTV"],[_,"Samsung"],[g,T]],[/\(dtv[\);].+(aquos)/i],[m,[_,"Sharp"],[g,T]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[_,"Samsung"],m,[g,M]],[/smart-tv.+(samsung)/i],[_,[g,T],m],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[_,"Samsung"],m,[g,w]],[/sie-(\w*)/i],[m,[_,"Siemens"],[g,w]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[_,"Nokia"],m,[g,w]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[m,[_,"Acer"],[g,M]],[/android.+([vl]k\-?\d{3})\s+build/i],[m,[_,"LG"],[g,M]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[_,"LG"],m,[g,M]],[/(lg) netcast\.tv/i],[_,m,[g,T]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[m,[_,"LG"],[g,w]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[_,m,[g,M]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[m,[_,"Lenovo"],[g,M]],[/(lenovo)[_\s-]?([\w-]+)/i],[_,m,[g,w]],[/linux;.+((jolla));/i],[_,m,[g,w]],[/((pebble))app\/[\d\.]+\s/i],[_,m,[g,C]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[_,m,[g,w]],[/crkey/i],[[m,"Chromecast"],[_,"Google"]],[/android.+;\s(glass)\s\d/i],[m,[_,"Google"],[g,C]],[/android.+;\s(pixel c)[\s)]/i],[m,[_,"Google"],[g,M]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[m,[_,"Google"],[g,w]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[m,/_/g," "],[_,"Xiaomi"],[g,w]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[m,/_/g," "],[_,"Xiaomi"],[g,M]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[m,[_,"Meizu"],[g,w]],[/(mz)-([\w-]{2,})/i],[[_,"Meizu"],m,[g,w]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[m,[_,"OnePlus"],[g,w]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[m,[_,"RCA"],[g,M]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[m,[_,"Dell"],[g,M]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[m,[_,"Verizon"],[g,M]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[_,"Barnes & Noble"],m,[g,M]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[m,[_,"NuVision"],[g,M]],[/android.+;\s(k88)\sbuild/i],[m,[_,"ZTE"],[g,M]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[m,[_,"Swiss"],[g,w]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[m,[_,"Swiss"],[g,M]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[m,[_,"Zeki"],[g,M]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[_,"Dragon Touch"],m,[g,M]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[m,[_,"Insignia"],[g,M]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[m,[_,"NextBook"],[g,M]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[_,"Voice"],m,[g,w]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[_,"LvTel"],m,[g,w]],[/android.+;\s(PH-1)\s/i],[m,[_,"Essential"],[g,w]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[m,[_,"Envizen"],[g,M]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[_,m,[g,M]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[m,[_,"MachSpeed"],[g,M]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[_,m,[g,M]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[m,[_,"Rotor"],[g,M]],[/android.+(KS(.+))\s+build/i],[m,[_,"Amazon"],[g,M]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[_,m,[g,M]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[g,A.lowerize],_,m],[/[\s\/\(](smart-?tv)[;\)]/i],[[g,T]],[/(android[\w\.\s\-]{0,9});.+build/i],[m,[_,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[v,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[f,v],[/rv\:([\w\.]{1,9}).+(gecko)/i],[v,f]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[f,v],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[f,[v,S.str,E.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[f,"Windows"],[v,S.str,E.os.windows.version]],[/\((bb)(10);/i],[[f,"BlackBerry"],v],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[f,v],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[f,"Symbian"],v],[/\((series40);/i],[f],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[f,"Firefox OS"],v],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[f,v],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[f,"Chromium OS"],v],[/(sunos)\s?([\w\.\d]*)/i],[[f,"Solaris"],v],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[f,v],[/(haiku)\s(\w+)/i],[f,v],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[v,/_/g,"."],[f,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[f,"Mac OS"],[v,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[f,v]]},L=function(e,t){if("object"==typeof e&&(t=e,e=s),!(this instanceof L))return new L(e,t).getResult();var i=e||(o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:r),n=t?A.extend(x,t):x;return this.getBrowser=function(){var e={name:s,version:s};return S.rgx.call(e,i,n.browser),e.major=A.major(e.version),e},this.getCPU=function(){var e={architecture:s};return S.rgx.call(e,i,n.cpu),e},this.getDevice=function(){var e={vendor:s,model:s,type:s};return S.rgx.call(e,i,n.device),e},this.getEngine=function(){var e={name:s,version:s};return S.rgx.call(e,i,n.engine),e},this.getOS=function(){var e={name:s,version:s};return S.rgx.call(e,i,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};L.VERSION=a,L.BROWSER={NAME:f,MAJOR:p,VERSION:v},L.CPU={ARCHITECTURE:y},L.DEVICE={MODEL:m,VENDOR:_,TYPE:g,CONSOLE:b,MOBILE:w,SMARTTV:T,TABLET:M,WEARABLE:C,EMBEDDED:I},L.ENGINE={NAME:f,VERSION:v},L.OS={NAME:f,VERSION:v},typeof t!==u?(typeof e!==u&&e.exports&&(t=e.exports=L),t.UAParser=L):(n=function(){return L}.call(t,i,t,e),!(n!==s&&(e.exports=n)));var N=o&&(o.jQuery||o.Zepto);if(typeof N!==u&&!N.ua){var O=new L;N.ua=O.getResult(),N.ua.get=function(){return O.getUA()},N.ua.set=function(e){O.setUA(e);var t=O.getResult();for(var i in t)N.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t,i){"use strict";function n(e,t){var i=a.valid(e);return i||(i=a.valid(a.coerce(e)))?a.satisfies(i,t):(console.error("Could not validate version",e),!1)}function o(e,t,i,o){var a=e.toLowerCase(),r=new s(i),l=r.getOS(),c=l.name||"",u=c.toLowerCase()===a;if(u)return n(l.version,t);var d=o&&o.platform&&o.platform||"",h=d.toLowerCase()===a;return!!h&&n(o.version,t)}var s=i(186),a=i(188);t.isItThatModel=o},function(e,t,i){(function(i){function n(e,t){if(e instanceof a)return e;if("string"!=typeof e)return null;if(e.length>J)return null;var i=t?ee[_e]:ee[me];if(!i.test(e))return null;try{return new a(e,t)}catch(n){return null}}function o(e,t){var i=n(e,t);return i?i.version:null}function s(e,t){var i=n(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null}function a(e,t){if(e instanceof a){if(e.loose===t)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>J)throw new TypeError("version is longer than "+J+" characters");if(!(this instanceof a))return new a(e,t);K("SemVer",e,t),this.loose=t;var i=e.trim().match(t?ee[_e]:ee[me]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>Z||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Z||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Z||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<Z)return t}return e}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}function r(e,t,i,n){"string"==typeof i&&(n=i,i=void 0);try{return new a(e,i).inc(t,n).version}catch(o){return null}}function l(e,t){if(w(e,t))return null;var i=n(e),o=n(t);if(i.prerelease.length||o.prerelease.length){for(var s in i)if(("major"===s||"minor"===s||"patch"===s)&&i[s]!==o[s])return"pre"+s;return"prerelease"}for(var s in i)if(("major"===s||"minor"===s||"patch"===s)&&i[s]!==o[s])return s}function c(e,t){var i=Ye.test(e),n=Ye.test(t);return i&&n&&(e=+e,t=+t),i&&!n?-1:n&&!i?1:e<t?-1:e>t?1:0}function u(e,t){return c(t,e)}function d(e,t){return new a(e,t).major}function h(e,t){return new a(e,t).minor}function p(e,t){return new a(e,t).patch}function m(e,t,i){return new a(e,i).compare(new a(t,i))}function f(e,t){return m(e,t,!0)}function g(e,t,i){return m(t,e,i)}function _(e,i){return e.sort(function(e,n){return t.compare(e,n,i)})}function v(e,i){return e.sort(function(e,n){return t.rcompare(e,n,i)})}function y(e,t,i){return m(e,t,i)>0}function b(e,t,i){return m(e,t,i)<0}function w(e,t,i){return 0===m(e,t,i)}function M(e,t,i){return 0!==m(e,t,i)}function T(e,t,i){return m(e,t,i)>=0}function C(e,t,i){return m(e,t,i)<=0}function I(e,t,i,n){var o;switch(t){case"===":"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),o=e===i;break;case"!==":"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),o=e!==i;break;case"":case"=":case"==":o=w(e,i,n);break;case"!=":o=M(e,i,n);break;case">":o=y(e,i,n);break;case">=":o=T(e,i,n);break;case"<":o=b(e,i,n);break;case"<=":o=C(e,i,n);break;default:throw new TypeError("Invalid operator: "+t)}return o}function A(e,t){if(e instanceof A){if(e.loose===t)return e;e=e.value}return this instanceof A?(K("comparator",e,t),this.loose=t,this.parse(e),this.semver===Ge?this.value="":this.value=this.operator+this.semver.version,void K("comp",this)):new A(e,t)}function S(e,t){if(e instanceof S)return e.loose===t?e:new S(e.raw,t);if(e instanceof A)return new S(e.value,t);if(!(this instanceof S))return new S(e,t);if(this.loose=t,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function E(e,t){return new S(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})}function x(e,t){return K("comp",e),e=D(e,t),K("caret",e),e=N(e,t),K("tildes",e),e=P(e,t),K("xrange",e),e=k(e,t),K("stars",e),e}function L(e){return!e||"x"===e.toLowerCase()||"*"===e}function N(e,t){return e.trim().split(/\s+/).map(function(e){return O(e,t)}).join(" ")}function O(e,t){var i=t?ee[Le]:ee[xe];return e.replace(i,function(t,i,n,o,s){K("tilde",e,t,i,n,o,s);var a;return L(i)?a="":L(n)?a=">="+i+".0.0 <"+(+i+1)+".0.0":L(o)?a=">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0":s?(K("replaceTilde pr",s),"-"!==s.charAt(0)&&(s="-"+s),a=">="+i+"."+n+"."+o+s+" <"+i+"."+(+n+1)+".0"):a=">="+i+"."+n+"."+o+" <"+i+"."+(+n+1)+".0",K("tilde return",a),a})}function D(e,t){return e.trim().split(/\s+/).map(function(e){return R(e,t)}).join(" ")}function R(e,t){K("caret",e,t);var i=t?ee[Pe]:ee[Re];return e.replace(i,function(t,i,n,o,s){K("caret",e,t,i,n,o,s);var a;return L(i)?a="":L(n)?a=">="+i+".0.0 <"+(+i+1)+".0.0":L(o)?a="0"===i?">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0":">="+i+"."+n+".0 <"+(+i+1)+".0.0":s?(K("replaceCaret pr",s),"-"!==s.charAt(0)&&(s="-"+s),a="0"===i?"0"===n?">="+i+"."+n+"."+o+s+" <"+i+"."+n+"."+(+o+1):">="+i+"."+n+"."+o+s+" <"+i+"."+(+n+1)+".0":">="+i+"."+n+"."+o+s+" <"+(+i+1)+".0.0"):(K("no pr"),a="0"===i?"0"===n?">="+i+"."+n+"."+o+" <"+i+"."+n+"."+(+o+1):">="+i+"."+n+"."+o+" <"+i+"."+(+n+1)+".0":">="+i+"."+n+"."+o+" <"+(+i+1)+".0.0"),K("caret return",a),a})}function P(e,t){return K("replaceXRanges",e,t),e.split(/\s+/).map(function(e){return B(e,t)}).join(" ")}function B(e,t){e=e.trim();var i=t?ee[Ce]:ee[Te];return e.replace(i,function(t,i,n,o,s,a){K("xRange",e,t,i,n,o,s,a);var r=L(n),l=r||L(o),c=l||L(s),u=c;return"="===i&&u&&(i=""),r?t=">"===i||"<"===i?"<0.0.0":"*":i&&u?(l&&(o=0),c&&(s=0),">"===i?(i=">=",l?(n=+n+1,o=0,s=0):c&&(o=+o+1,s=0)):"<="===i&&(i="<",l?n=+n+1:o=+o+1),t=i+n+"."+o+"."+s):l?t=">="+n+".0.0 <"+(+n+1)+".0.0":c&&(t=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0"),K("xRange return",t),t})}function k(e,t){return K("replaceStars",e,t),e.trim().replace(ee[We],"")}function F(e,t,i,n,o,s,a,r,l,c,u,d,h){return t=L(i)?"":L(n)?">="+i+".0.0":L(o)?">="+i+"."+n+".0":">="+t,r=L(l)?"":L(c)?"<"+(+l+1)+".0.0":L(u)?"<"+l+"."+(+c+1)+".0":d?"<="+l+"."+c+"."+u+"-"+d:"<="+r,(t+" "+r).trim()}function z(e,t){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length){for(var i=0;i<e.length;i++)if(K(e[i].semver),e[i].semver!==Ge&&e[i].semver.prerelease.length>0){var n=e[i].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}function H(e,t,i){try{t=new S(t,i)}catch(n){return!1}return t.test(e)}function q(e,t,i){var n=null,o=null;try{var s=new S(t,i)}catch(r){return null}return e.forEach(function(e){s.test(e)&&(n&&o.compare(e)!==-1||(n=e,o=new a(n,i)))}),n}function W(e,t,i){var n=null,o=null;try{var s=new S(t,i)}catch(r){return null}return e.forEach(function(e){s.test(e)&&(n&&1!==o.compare(e)||(n=e,o=new a(n,i)))}),n}function U(e,t){try{return new S(e,t).range||"*"}catch(i){return null}}function Y(e,t,i){return j(e,t,"<",i)}function G(e,t,i){return j(e,t,">",i)}function j(e,t,i,n){e=new a(e,n),t=new S(t,n);var o,s,r,l,c;switch(i){case">":o=y,s=C,r=b,l=">",c=">=";break;case"<":o=b,s=T,r=y,l="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(H(e,t,n))return!1;for(var u=0;u<t.set.length;++u){var d=t.set[u],h=null,p=null;if(d.forEach(function(e){e.semver===Ge&&(e=new A(">=0.0.0")),h=h||e,p=p||e,o(e.semver,h.semver,n)?h=e:r(e.semver,p.semver,n)&&(p=e)}),h.operator===l||h.operator===c)return!1;if((!p.operator||p.operator===l)&&s(e,p.semver))return!1;if(p.operator===c&&r(e,p.semver))return!1}return!0}function V(e,t){var i=n(e,t);return i&&i.prerelease.length?i.prerelease:null}function X(e,t,i){return e=new S(e,i),t=new S(t,i),e.intersects(t)}function Q(e){if(e instanceof a)return e;if("string"!=typeof e)return null;var t=e.match(ee[Ie]);return null==t?null:n((t[1]||"0")+"."+(t[2]||"0")+"."+(t[3]||"0"))}t=e.exports=a;var K;K="object"==typeof i&&i.env&&i.env.NODE_DEBUG&&/\bsemver\b/i.test(i.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var J=256,Z=Number.MAX_SAFE_INTEGER||9007199254740991,$=16,ee=t.re=[],te=t.src=[],ie=0,ne=ie++;te[ne]="0|[1-9]\\d*";var oe=ie++;te[oe]="[0-9]+";var se=ie++;te[se]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var ae=ie++;te[ae]="("+te[ne]+")\\.("+te[ne]+")\\.("+te[ne]+")";var re=ie++;te[re]="("+te[oe]+")\\.("+te[oe]+")\\.("+te[oe]+")";var le=ie++;te[le]="(?:"+te[ne]+"|"+te[se]+")";var ce=ie++;te[ce]="(?:"+te[oe]+"|"+te[se]+")";var ue=ie++;te[ue]="(?:-("+te[le]+"(?:\\."+te[le]+")*))";var de=ie++;te[de]="(?:-?("+te[ce]+"(?:\\."+te[ce]+")*))";var he=ie++;te[he]="[0-9A-Za-z-]+";var pe=ie++;te[pe]="(?:\\+("+te[he]+"(?:\\."+te[he]+")*))";var me=ie++,fe="v?"+te[ae]+te[ue]+"?"+te[pe]+"?";te[me]="^"+fe+"$";var ge="[v=\\s]*"+te[re]+te[de]+"?"+te[pe]+"?",_e=ie++;te[_e]="^"+ge+"$";var ve=ie++;te[ve]="((?:<|>)?=?)";var ye=ie++;te[ye]=te[oe]+"|x|X|\\*";var be=ie++;te[be]=te[ne]+"|x|X|\\*";var we=ie++;te[we]="[v=\\s]*("+te[be]+")(?:\\.("+te[be]+")(?:\\.("+te[be]+")(?:"+te[ue]+")?"+te[pe]+"?)?)?";var Me=ie++;te[Me]="[v=\\s]*("+te[ye]+")(?:\\.("+te[ye]+")(?:\\.("+te[ye]+")(?:"+te[de]+")?"+te[pe]+"?)?)?";var Te=ie++;te[Te]="^"+te[ve]+"\\s*"+te[we]+"$";var Ce=ie++;te[Ce]="^"+te[ve]+"\\s*"+te[Me]+"$";var Ie=ie++;te[Ie]="(?:^|[^\\d])(\\d{1,"+$+"})(?:\\.(\\d{1,"+$+"}))?(?:\\.(\\d{1,"+$+"}))?(?:$|[^\\d])";var Ae=ie++;te[Ae]="(?:~>?)";var Se=ie++;te[Se]="(\\s*)"+te[Ae]+"\\s+",ee[Se]=new RegExp(te[Se],"g");var Ee="$1~",xe=ie++;te[xe]="^"+te[Ae]+te[we]+"$";var Le=ie++;te[Le]="^"+te[Ae]+te[Me]+"$";var Ne=ie++;te[Ne]="(?:\\^)";var Oe=ie++;te[Oe]="(\\s*)"+te[Ne]+"\\s+",ee[Oe]=new RegExp(te[Oe],"g");var De="$1^",Re=ie++;te[Re]="^"+te[Ne]+te[we]+"$";var Pe=ie++;te[Pe]="^"+te[Ne]+te[Me]+"$";var Be=ie++;te[Be]="^"+te[ve]+"\\s*("+ge+")$|^$";var ke=ie++;te[ke]="^"+te[ve]+"\\s*("+fe+")$|^$";var Fe=ie++;te[Fe]="(\\s*)"+te[ve]+"\\s*("+ge+"|"+te[we]+")",ee[Fe]=new RegExp(te[Fe],"g");var ze="$1$2$3",He=ie++;te[He]="^\\s*("+te[we]+")\\s+-\\s+("+te[we]+")\\s*$";var qe=ie++;te[qe]="^\\s*("+te[Me]+")\\s+-\\s+("+te[Me]+")\\s*$";var We=ie++;te[We]="(<|>)?=?\\s*\\*";for(var Ue=0;Ue<ie;Ue++)K(Ue,te[Ue]),ee[Ue]||(ee[Ue]=new RegExp(te[Ue]));t.parse=n,t.valid=o,t.clean=s,t.SemVer=a,a.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},a.prototype.toString=function(){return this.version},a.prototype.compare=function(e){return K("SemVer.compare",this.version,this.loose,e),e instanceof a||(e=new a(e,this.loose)),this.compareMain(e)||this.comparePre(e)},a.prototype.compareMain=function(e){return e instanceof a||(e=new a(e,this.loose)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)},a.prototype.comparePre=function(e){if(e instanceof a||(e=new a(e,this.loose)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var i=this.prerelease[t],n=e.prerelease[t];if(K("prerelease compare",t,i,n),void 0===i&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===i)return-1;if(i!==n)return c(i,n)}while(++t)},a.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=r,t.diff=l,t.compareIdentifiers=c;var Ye=/^[0-9]+$/;t.rcompareIdentifiers=u,t.major=d,t.minor=h,t.patch=p,t.compare=m,t.compareLoose=f,t.rcompare=g,t.sort=_,t.rsort=v,t.gt=y,t.lt=b,t.eq=w,t.neq=M,t.gte=T,t.lte=C,t.cmp=I,t.Comparator=A;var Ge={};A.prototype.parse=function(e){var t=this.loose?ee[Be]:ee[ke],i=e.match(t);if(!i)throw new TypeError("Invalid comparator: "+e);this.operator=i[1],"="===this.operator&&(this.operator=""),i[2]?this.semver=new a(i[2],this.loose):this.semver=Ge},A.prototype.toString=function(){return this.value},A.prototype.test=function(e){return K("Comparator.test",e,this.loose),this.semver===Ge||("string"==typeof e&&(e=new a(e,this.loose)),I(e,this.operator,this.semver,this.loose))},A.prototype.intersects=function(e,t){if(!(e instanceof A))throw new TypeError("a Comparator is required");var i;if(""===this.operator)return i=new S(e.value,t),H(this.value,i,t);if(""===e.operator)return i=new S(this.value,t),H(e.semver,i,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),r=I(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=I(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||o||s&&a||r||l},t.Range=S,S.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},S.prototype.toString=function(){return this.range},S.prototype.parseRange=function(e){var t=this.loose;e=e.trim(),K("range",e,t);var i=t?ee[qe]:ee[He];e=e.replace(i,F),K("hyphen replace",e),e=e.replace(ee[Fe],ze),K("comparator trim",e,ee[Fe]),e=e.replace(ee[Se],Ee),e=e.replace(ee[Oe],De),e=e.split(/\s+/).join(" ");var n=t?ee[Be]:ee[ke],o=e.split(" ").map(function(e){return x(e,t)}).join(" ").split(/\s+/);return this.loose&&(o=o.filter(function(e){return!!e.match(n)})),o=o.map(function(e){return new A(e,t)})},S.prototype.intersects=function(e,t){if(!(e instanceof S))throw new TypeError("a Range is required");return this.set.some(function(i){return i.every(function(i){return e.set.some(function(e){return e.every(function(e){return i.intersects(e,t)})})})})},t.toComparators=E,S.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new a(e,this.loose));for(var t=0;t<this.set.length;t++)if(z(this.set[t],e))return!0;return!1},t.satisfies=H,t.maxSatisfying=q,t.minSatisfying=W,t.validRange=U,t.ltr=Y,t.gtr=G,t.outside=j,t.prerelease=V,t.intersects=X,t.coerce=Q}).call(t,i(33))},function(e,t){e.exports=function(){return window}},function(e,t,i){function n(){s.call(this),this.optionDefs=null,this.isEmitting=null}var o=i(191).inherits,s=i(194).EventEmitter,a=i(195),r=i(196),l="option-";o(n,s),e.exports=new n,n.prototype.initialize=function(e){this.optionDefs={showAllMonsters:{init:!0},maxTitlesOrnaments:{init:1},maxActorsBeforeCreatureMode:{init:9999,onChange:window.actorManager.onMaxActorsBeforeCreatureModeChange.bind(window.actorManager)},hideDeadFighters:{init:!0},showMountsInFight:{init:!0},allowSpellEffects:{init:!0},autoGpsFlags:{init:!0},autoGpsPhoenixes:{init:!0},menubarSize:{init:e.ipadRatio?6:3},menubarSizeInFight:{init:e.ipadRatio?3:2},toolbarThicknessInFight:{init:1},censorship:{init:!0},chatTimestamp:{init:!1},tutorialTips:{init:!0},soundOnPlayerTurnStart:{init:!0},alwaysShowGrid:{init:!1},fightAlwaysShowGrid:{init:!0},spellTooltipName:{init:!0},spellTooltipApRange:{init:!0},spellTooltipCritical:{init:!1},spellTooltipEffect:{init:!1},spellTooltipDescription:{init:!0},confirmBoxWhenDragCasting:{init:r.ALWAYS},confirmBoxWhenClickCasting:{init:r.ALWAYS},confirmBoxWhenWalking:{init:!0},showSpeechBubbleInFight:{init:!0},orderFighters:{init:!1},showApMpUsed:{init:!1},offlineOptionTimestamp:{init:0},systemNotificationsEnabled:{init:!1},wantPromoNotif:{init:!0},wantPrismAttackedNotif:{init:!0},wantPrismVulnerableNotif:{init:!0},petFeedingNotifTime:{init:"19:00"}},this._loadAllOptions()},n.prototype._loadAllOptions=function(){for(var e in this.optionDefs){var t=this.optionDefs[e];this[e]=a.getValue(l+e,t.init)}},n.prototype.changeValue=function(e,t,i){var n=this[e];if(t!==n){this[e]=t,a.setValue(l+e,t);var o=this.optionDefs[e];o.onChange&&o.onChange(t,n),this.isEmitting&&console.error("GameOptions: change "+e+" is reentering change "+this.isEmitting),this.isEmitting=e,this.emit(e,t,n,i),this.isEmitting=null}}},function(e,t,i){(function(e,n){function o(e,i){var n={seen:[],stylize:a};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(i)?n.showHidden=i:i&&t._extend(n,i),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),l(n,e,n.depth);
}function s(e,t){var i=o.styles[t];return i?"["+o.colors[i][0]+"m"+e+"["+o.colors[i][1]+"m":e}function a(e,t){return e}function r(e){var t={};return e.forEach(function(e,i){t[e]=!0}),t}function l(e,i,n){if(e.customInspect&&i&&A(i.inspect)&&i.inspect!==t.inspect&&(!i.constructor||i.constructor.prototype!==i)){var o=i.inspect(n,e);return y(o)||(o=l(e,o,n)),o}var s=c(e,i);if(s)return s;var a=Object.keys(i),f=r(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(i)),I(i)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return u(i);if(0===a.length){if(A(i)){var g=i.name?": "+i.name:"";return e.stylize("[Function"+g+"]","special")}if(M(i))return e.stylize(RegExp.prototype.toString.call(i),"regexp");if(C(i))return e.stylize(Date.prototype.toString.call(i),"date");if(I(i))return u(i)}var _="",v=!1,b=["{","}"];if(m(i)&&(v=!0,b=["[","]"]),A(i)){var w=i.name?": "+i.name:"";_=" [Function"+w+"]"}if(M(i)&&(_=" "+RegExp.prototype.toString.call(i)),C(i)&&(_=" "+Date.prototype.toUTCString.call(i)),I(i)&&(_=" "+u(i)),0===a.length&&(!v||0==i.length))return b[0]+_+b[1];if(n<0)return M(i)?e.stylize(RegExp.prototype.toString.call(i),"regexp"):e.stylize("[Object]","special");e.seen.push(i);var T;return T=v?d(e,i,n,f,a):a.map(function(t){return h(e,i,n,f,t,v)}),e.seen.pop(),p(T,_,b)}function c(e,t){if(w(t))return e.stylize("undefined","undefined");if(y(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}return v(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,i,n,o){for(var s=[],a=0,r=t.length;a<r;++a)N(t,String(a))?s.push(h(e,t,i,n,String(a),!0)):s.push("");return o.forEach(function(o){o.match(/^\d+$/)||s.push(h(e,t,i,n,o,!0))}),s}function h(e,t,i,n,o,s){var a,r,c;if(c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},c.get?r=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(r=e.stylize("[Setter]","special")),N(n,o)||(a="["+o+"]"),r||(e.seen.indexOf(c.value)<0?(r=g(i)?l(e,c.value,null):l(e,c.value,i-1),r.indexOf("\n")>-1&&(r=s?r.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+r.split("\n").map(function(e){return"   "+e}).join("\n"))):r=e.stylize("[Circular]","special")),w(a)){if(s&&o.match(/^\d+$/))return r;a=JSON.stringify(""+o),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+r}function p(e,t,i){var n=0,o=e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1]:i[0]+t+" "+e.join(", ")+" "+i[1]}function m(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function g(e){return null===e}function _(e){return null==e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function w(e){return void 0===e}function M(e){return T(e)&&"[object RegExp]"===E(e)}function T(e){return"object"==typeof e&&null!==e}function C(e){return T(e)&&"[object Date]"===E(e)}function I(e){return T(e)&&("[object Error]"===E(e)||e instanceof Error)}function A(e){return"function"==typeof e}function S(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function E(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var O=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(o(arguments[i]));return t.join(" ")}for(var i=1,n=arguments,s=n.length,a=String(e).replace(O,function(e){if("%%"===e)return"%";if(i>=s)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return e}}),r=n[i];i<s;r=n[++i])a+=g(r)||!T(r)?" "+r:" "+o(r);return a},t.deprecate=function(i,o){function s(){if(!a){if(n.throwDeprecation)throw new Error(o);n.traceDeprecation?console.trace(o):console.error(o),a=!0}return i.apply(this,arguments)}if(w(e.process))return function(){return t.deprecate(i,o).apply(this,arguments)};if(n.noDeprecation===!0)return i;var a=!1;return s};var D,R={};t.debuglog=function(e){if(w(D)&&(D=n.env.NODE_DEBUG||""),e=e.toUpperCase(),!R[e])if(new RegExp("\\b"+e+"\\b","i").test(D)){var i=n.pid;R[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,i,n)}}else R[e]=function(){};return R[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=m,t.isBoolean=f,t.isNull=g,t.isNullOrUndefined=_,t.isNumber=v,t.isString=y,t.isSymbol=b,t.isUndefined=w,t.isRegExp=M,t.isObject=T,t.isDate=C,t.isError=I,t.isFunction=A,t.isPrimitive=S,t.isBuffer=i(192);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",L(),t.format.apply(t,arguments))},t.inherits=i(193),t._extend=function(e,t){if(!t||!T(t))return e;for(var i=Object.keys(t),n=i.length;n--;)e[i[n]]=t[i[n]];return e}}).call(t,function(){return this}(),i(33))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},function(e,t){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,i,o,r,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(i=this._events[e],a(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(s(i))for(r=Array.prototype.slice.call(arguments,1),c=i.slice(),o=c.length,l=0;l<o;l++)c[l].apply(this,r);return!0},i.prototype.addListener=function(e,t){var o;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error(new Error("(node) warning: possible EventEmitter memory leak detected. "+o+" listeners added for event type '"+e+"' on a "+this.constructor.name)),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function i(){this.removeListener(e,i),o||(o=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var o=!1;return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var i,o,a,r;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],a=i.length,o=-1,i===t||n(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(i)){for(r=a;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){o=r;break}if(o<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],n(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){function i(){this._hasListeners=!1,this.autosave=null,this.nextSaveTime=0,this.accountName=null,this.prefs={},this._load()}var n="dofus.1",o=180,s="all";i.prototype.close=function(){this.setAccount(null)},i.prototype._setupListeners=function(){if(!this._hasListeners){var e=this;window.gui.on("appGoBackground",function(){null!==e.accountName&&e.autosave&&e._save()}),this._hasListeners=!0}},i.prototype.setAccount=function(e){this.autosave&&this._save(),this.accountName=e,this._setupListeners()},i.prototype._load=function(){try{var e=window.localStorage.getItem(n);e&&(this.prefs=JSON.parse(e))}catch(t){console.warn("Failed to load user preferences: "+t)}},i.prototype._scheduleNextSave=function(e){var t=this;e||(e=o);var i=Date.now()+1e3*e;this.autosave&&this.nextSaveTime<=i||(this.autosave&&window.clearTimeout(this.autosave),this.nextSaveTime=i,this.autosave=window.setTimeout(function(){t.autosave=null,t._save()},1e3*e))},i.prototype._save=function(){this.autosave&&(window.clearTimeout(this.autosave),this.autosave=null);var e;try{var t=JSON.stringify(this.prefs);e=t.length,window.localStorage.setItem(n,t),console.info("Saved "+e+" char string into local storage"),e>2e4&&console.error("userPref size is "+e)}catch(i){console.error("Failed to save user preferences of size "+e+": "+i)}},i.prototype.saveNow=function(){this._save()},i.prototype.getValue=function(e,t,i){e=(this.accountName&&!i?this.accountName:s)+"#"+e;var n=this.prefs[e];return void 0===n?t:n},i.prototype.setValue=function(e,t,i,n){e=(this.accountName&&!n?this.accountName:s)+"#"+e,this.prefs[e]=t,this._scheduleNextSave(i)},i.prototype.delValue=function(e,t,i){e=(this.accountName&&!i?this.accountName:s)+"#"+e,delete this.prefs[e],this._scheduleNextSave(t)};var a=new i;e.exports=a},function(e,t){e.exports={NEVER:0,ALWAYS:1,EMPTY_ONLY:2}},function(e,t,i){function n(e){c=!1,d=e.accountId,h=e.login,p=e.nickname,o.log("Session_Info.Login",{account_session_id:h},{withResolution:!0,withSubscriptionInfo:!0})}var o=i(9),s=i(198),a=i(199),r=window.dofus.connectionManager,l=i(200)(r),c=!1,u=0,d=0,h=0,p=0;window.gui.on("disconnect",function(){o.unregister()}),window.gui.on("initialized",function(){l.initFightManager(window.gui.fightManager)}),r.on("NicknameAcceptedMessage",function(){o.log("F_T_U_E.Step0000_Chose_Nickname")}),r.on("ServersListMessage",function(e){for(var t=0,i=e.servers||[],n=0,o=i.length;n<o;n+=1){var s=i[n];t+=s.charactersCount}c=!t}),r.on("IdentificationSuccessMessage",n),r.on("IdentificationSuccessWithLoginTokenMessage",n),r.on("SelectedServerDataMessage",function(e){o.log("Session_Info.Choose_Server",{account_session_id:h}),c&&o.log("F_T_U_E.Step0100_Chose_Server",{server_id:e.serverId})}),r.on("CharacterCreationResultMessage",function(e){c&&e.result===s.OK&&o.log("F_T_U_E.Step0200_Create_First_Character")}),window.gui.playerData.on("characterSelectedSuccess",function(){u=window.gui.playerData.characterBaseInformations.level,window.dofus.send("kpiStartSession",{accountSessionId:window.gui.playerData.identification.accountSessionUid,isSubscriber:window.gui.playerData.isSubscriber()}),o.log("Session_Info.Choose_Character")}),r.on("kpiStartSessionMessage",function(e){o.register(d,e.sessionId,{login:window.gui.playerData.loginName,nickname:p})}),r.on("kpiStartSessionErrorMessage",function(){console.error("kpiStartSessionErrorMessage"),o.register(d,null,{login:window.gui.playerData.loginName,nickname:p})}),r.on("CharacterLevelUpMessage",function(e){o.log("User_Life_Cycle.Level_Up",{old_level:u}),a.trackLevelGrowth(u,e.newLevel),u=e.newLevel}),r.on("AchievementFinishedMessage",function(e){o.log("User_Life_Cycle.Achievement_Achieved",{achievement_id:e.id})}),r.on("AchievementRewardSuccessMessage",function(e){o.log("User_Life_Cycle.Achievement_Get_Reward",{achievement_id:e.achievementId})}),r.on("QuestStartedMessage",function(e){o.log("User_Life_Cycle.Quest_Start",{quest_id:e.questId})}),r.on("QuestValidatedMessage",function(e){o.log("User_Life_Cycle.Quest_End",{quest_id:e.questId})}),r.on("QuestObjectiveValidatedMessage",function(e){var t=window.gui.playerData.quests.all[e.questId]||{},i=t.stepId||0;o.log("User_Life_Cycle.Quest_Step_Objective_Success",{quest_id:e.questId,objective_id:e.objectiveId,step_id:i})}),r.on("QuestStepValidatedMessage",function(e){o.log("User_Life_Cycle.Quest_Step_Success",{quest_id:e.questId,step_id:e.stepId})}),r.on("DungeonEnteredMessage",function(e){o.log("User_Life_Cycle.Donjon_Start",{dungeon_id:e.dungeonId})}),r.on("JobLevelUpMessage",function(e){o.log("User_Life_Cycle.Profession_Level_Up",{job_id:e.jobsDescription.jobId,new_level:e.newLevel})}),r.on("GameRolePlayPlayerLifeStatusMessage",function(e){e.state>0&&o.log("User_Life_Cycle.Death")}),r.on("PartyJoinMessage",function(e){o.log("social.fight_group_join",{group_id:e.partyId})}),r.on("PartyDeletedMessage",function(e){o.log("social.fight_group_quit",{group_id:e.partyId})}),r.on("PartyLeaveMessage",function(e){o.log("social.fight_group_quit",{group_id:e.partyId})}),r.on("PartyKickedByMessage",function(e){o.log("social.fight_group_quit",{group_id:e.partyId})});var m=null;r.on("GuildMembershipMessage",function(e){m=e.guildInfo.guildId}),r.on("GuildJoinedMessage",function(e){m=e.guildInfo.guildId,o.log("social.guild_join",{guild_id:m})}),r.on("GuildLeftMessage",function(){o.log("social.guild_quit",{guild_id:m})})},function(e,t){e.exports={OK:0,ERR_NO_REASON:1,ERR_INVALID_NAME:2,ERR_NAME_ALREADY_EXISTS:3,ERR_TOO_MANY_CHARACTERS:4,ERR_NOT_ALLOWED:5,ERR_NEW_PLAYER_NOT_ALLOWED:6,ERR_RESTRICED_ZONE:7}},function(e,t){function i(){}function n(e,t){if(c){var i=new l(e);if(t){var n=t.revenue;n&&i.setRevenue(n.price,n.currency);var o=t.transactionId;o&&(o="string"==typeof o?o:o.toString(),i.setTransactionId(o))}a.trackEvent(i)}}function o(){t.trackIAPBought=function(e,t,i,o){switch(e){case"com.ankama.dofustouch.starterpack":case"com.ankama.dofustouchnext.starterpack":n("6re6in",{revenue:{price:t,currency:i},transactionId:o});break;default:n("m38gxs",{revenue:{price:t,currency:i},transactionId:o})}},t.trackLevelGrowth=function(e,t){for(var i in u){var o=~~i,s=u[i];e<o&&t>=o&&n(s)}},t.trackTutorialCompleted=function(){n("806tbe")}}function s(e,t,i,n){if(e&&t&&i&&n){a=t,r=i,l=n;var s=r[e.environment]||r.EnvironmentSandbox,u=new r(e.appToken,s);u.setLogLevel(r.LogLevelVerbose),a.create(u),o(),c=!0}}var a,r,l,c=!1,u={20:"88hxio",40:"wdo7mh",60:"lnyhd8",80:"83unje",100:"c0spae",120:"2pcpyu",140:"dyahv0",160:"2ri3xe",180:"1xfq37",200:"l96q3l"};t.initialize=s,t.trackIAPBought=i,t.trackTutorialCompleted=i,t.trackLevelGrowth=i},function(e,t,i){function n(e){var t=0;for(var i in e)t+=e[i];return t}function o(e){this._fightManager=null;var t=this;this._monsterMap={},this._isSpectator=!1,this._currentFightId=null,this._teamHPMap={0:{},1:{}},e.on("GameFightJoinMessage",function(e){return e.isSpectator?void(t._isSpectator=!0):(t._monsterMap={},t._isSpectator=!1,void(t._currentFightId=null))}),e.on("GameFightTurnReadyRequestMessage",function(){if(!t._isSpectator){var e=t._fightManager.getAvailableFighters();for(var i in e)t._updateMonsterLife(e[i])}}),e.on("messageSequence",function(e){null===t._currentFightId&&(t._currentFightId=t._fightManager.fightId);for(var i=0;i<e.sequence.length;i+=1)t._logSpellCast(e.sequence[i])}),e.on("GameActionFightSpellCastMessage",function(e){t._logSpellCast(e)}),e.on("GameActionFightCloseCombatMessage",function(e){t._logSpellCast(e)}),e.on("GameFightShowFighterMessage",function(e){if(!t._isSpectator){var i=e.informations;t._addTeamHP(i.teamId,i.contextualId,i.stats.lifePoints),t._addMonster(i)}}),e.on("GameFightRemoveTeamMemberMessage",function(e){t._isSpectator||t._removeTeamHP(e.teamId,e.charId)}),e.on("GameFightStartMessage",function(){t._isSpectator||(t._currentFightId=t._fightManager.fightId,s.log("Fight_Report.Fight_Start",{fight_id:t._currentFightId,fight_type:t._fightManager.fightType,team_0_hp:n(t._teamHPMap[0]),team_1_hp:n(t._teamHPMap[1])},{noSessionId:!0}),t._sendMonsterReport(),t._sendCharacterReport())}),e.on("GameFightEndMessage",function(e){if(!t._isSpectator){t._sendAliveMonsterReport(e);var i=t._getWinnerTeamId(e);s.log("Fight_Report.Fight_End",{nb_turns:t._fightManager.getTurnCount()+1,fight_id:t._currentFightId,time_spent_on_action:~~(e.duration/1e3),winner_team_id:i},{noSessionId:!0}),t._teamHPMap={0:{},1:{}},t._monsterMap={},t._isSpectator=!1,t._currentFightId=null}})}var s=i(9),a=i(189);e.exports=function(e){return new o(e)},o.prototype.initFightManager=function(e){this._fightManager=e},o.prototype._addMonster=function(e){if(!(e.contextualId>=0)){var t={};this._monsterMap[e.contextualId]=t,t.monster_id=e.creatureGenericId,t.monster_level=e.monsterLevel,t.monster_grade=e.creatureGrade,t.team_id=e.teamId}},o.prototype._updateMonsterLife=function(e){if(!(e.id>=0)){var t=this._monsterMap[e.id];t||(t=this._monsterMap[e.id]={});var i=e.data.stats;t.ratio_life_remaining=Math.ceil(100*i.lifePoints/i.maxLifePoints)/100,1===t.ratio_life_remaining&&i.lifePoints!==i.maxLifePoints&&(t.ratio_life_remaining=.99)}},o.prototype._sendAliveMonsterReport=function(e){for(var t=0;t<e.results.length;t+=1){var i=e.results[t];if(i.alive&&!(i.id>=0)){var n=this._monsterMap[i.id];if(!n)return;void 0===n.ratio_life_remaining&&(n.ratio_life_remaining=1),s.log("fight_report.fight_end_alive_monster_description",{fight_id:this._currentFightId,team_id:n.team_id,monster_id:n.monster_id,monster_level:n.monster_level,monster_grade:n.monster_grade,ratio_life_remaining:n.ratio_life_remaining},{noSessionId:!0})}}},o.prototype._sendMonsterReport=function(){for(var e in this._monsterMap){var t=this._monsterMap[e];s.log("Fight_Report.Fight_Monster_Description",{fight_id:this._currentFightId,team_id:t.team_id,monster_id:t.monster_id,monster_level:t.monster_level,monster_grade:t.monster_grade},{noSessionId:!0})}},o.prototype._sendCharacterReport=function(){var e=a(),t=this._fightManager.getAvailableFighters(),i=t[e.gui.playerData.id];i&&s.log("Fight_Report.Fight_Character_Description",{fight_id:this._currentFightId,is_incarnation:e.gui.playerData.isIncarnation(),team_id:i.data.teamId},{withEquipment:!0})},o.prototype._logSpellCast=function(e){if(!this._isSpectator){var t=a(),i=t.gui.playerData.id,n="GameActionFightSpellCastMessage"===e._messageType||"GameActionFightCloseCombatMessage"===e._messageType;if(n&&e.sourceId===i){var o=e.spellId?e.spellId:0,r=e.spellLevel?e.spellLevel:1;s.log("Fight_Action.Spell_Cast_By_User",{spell_id:o,spell_level:r,fight_id:this._currentFightId,breed_id:t.gui.playerData.characterBreed.id})}}},o.prototype._addTeamHP=function(e,t,i){0!==e&&1!==e||(this._teamHPMap[e][t]=i)},o.prototype._removeTeamHP=function(e,t){0!==e&&1!==e||(this._teamHPMap[e][t]=0)},o.prototype._getWinnerTeamId=function(e){for(var t=null,i=0,n=e.results.length;i<n;i+=1){var o=e.results[i];if(o.alive){t=o.id;break}}return this._teamHPMap[0][t]?0:this._teamHPMap[1][t]?1:-1}},function(e,t){t.STEP_START={1:"F_T_U_E.Step0400_Start_Tuto_Step_1_Move",2:"F_T_U_E.Step0600_Start_Tuto_Step_2_Speak_To_NPC",3:"F_T_U_E.Step0800_Start_Tuto_Step_3_Equip_Ring",4:"F_T_U_E.Step1000_Start_Tuto_Step_4_Change_Map",5:"F_T_U_E.Step1200_Start_Tuto_Step_5_Start_Fight",6:"F_T_U_E.Step1400_Start_Tuto_Step_6_Chose_Starting_Position",7:"F_T_U_E.Step1600_Start_Tuto_Step_7_Move_In_Fight",8:"F_T_U_E.Step1800_Start_Tuto_Step_8_Use_Spell",9:"F_T_U_E.Step1900_Start_Tuto_Step_9_End_Turn",10:"F_T_U_E.Step2100_Start_Tuto_Step_10_Win_Fight",11:"F_T_U_E.Step2300_Start_Tuto_Step_11_Start_Quest",12:"F_T_U_E.Step2500_Start_Tuto_Step_12_Equip_Items",13:"F_T_U_E.Step2700_Start_Tuto_Step_13_Defeat_Monster",14:"F_T_U_E.Step2900_Start_Tuto_Step_14_End_Fight",15:"F_T_U_E.Step3100_Start_Tuto_Step_15_End_Learning"},t.STEP_END={1:"F_T_U_E.Step0500_Succeed_Tuto_Step_1_Move",2:"F_T_U_E.Step0700_Succeed_Tuto_Step_2_Speak_To_NPC",3:"F_T_U_E.Step0900_Succed_Tuto_Step_3_Equip_Ring",4:"F_T_U_E.Step1100_Succeed_Tuto_Step_4_Change_Map",5:"F_T_U_E.Step1300_Succeed_Tuto_Step_5_Start_Fight",6:"F_T_U_E.Step1500_Succeed_Tuto_Step_6_Chose_Starting_Position",7:"F_T_U_E.Step1700_Succed_Tuto_Step_7_Move_In_Fight",8:"F_T_U_E.Step1890_Succeed_Tuto_Step_8_Use_Spell",9:"F_T_U_E.Step2000_Succeed_Tuto_Step_9_End_Turn",10:"F_T_U_E.Step2200_Succeed_Tuto_Step_10_Win_Fight",11:"F_T_U_E.Step2400_Succeed_Tuto_Step_11_Start_Quest",12:"F_T_U_E.Step2600_Succeed_Tuto_Step_12_Equip_Items",13:"F_T_U_E.Step2800_Succed_Tuto_Step_13_Defeat_Monster",14:"F_T_U_E.Step3000_Succed_Tuto_Step_14_End_Fight",15:"F_T_U_E.Step3200_Succeed_Tuto_Step_15_End_Learning"},t.SUB_STEP={2:{1:"F_T_U_E.Step0630_Clic_Maitre_Pifo",2:"F_T_U_E.Step0660_Answer_Maitre_Pifo"},3:{1:"F_T_U_E.Step0820_Clic_Menu_Bag",2:"F_T_U_E.Step0840_Clic_Menu_Weapons",item2:"F_T_U_E.Step0860_Equip_Ring",item4:"F_T_U_E.Step0860_Equip_Ring"},5:{1:"F_T_U_E.Step1260_Clic_Attack"},6:{1:"F_T_U_E.Step1430_Clic_Desired_Position_Square",2:"F_T_U_E.Step1460_Clic_Ready_Button"},7:{1:"F_T_U_E.Step1630_Clic_Desired_Position_Square",2:"F_T_U_E.Step1660_Clic_Validate_Move"},8:{1:"F_T_U_E.Step1820_Clic_Attack_Button",2:"F_T_U_E.Step1850_Select_Target",3:"F_T_U_E.Step1870_Validate_Attack"},9:{1:"F_T_U_E.Step1950_Clic_End_Turn_Button"},10:{1:"F_T_U_E.Step2140_Scarecrow_Figh_End"},11:{1:"F_T_U_E.Step2330_Talk_To_NPC_Maitre_Pifo",2:"F_T_U_E.Step2360_Answer_NPC_Maitre_Pifo"},12:{1:"F_T_U_E.Step2510_Clic_Bag_Menu",2:"F_T_U_E.Step2520_Clic_Weapon_Menu",item7:"F_T_U_E.Step2530_Equip_Cloak",item0:"F_T_U_E.Step2540_Equip_Amulet",item3:"F_T_U_E.Step2550_Equip_Belt",item15:"F_T_U_E.Step2560_Equip_Shield",item1:"F_T_U_E.Step2570_Equip_Sword",item5:"F_T_U_E.Step2580_Equip_Boots"},13:{1:"F_T_U_E.Step2720_Change_Map"},14:{1:"F_T_U_E.Step2910_Lupus_Minimus_Figh_End"},15:{1:"F_T_U_E.Step3130_Talk_To_NPC_Maitre_Pifo"}}},function(e,t,i){function n(){E=0}function o(e){return e.code===O||e.code===N&&e.status>499}function s(e,t,i,n){this.url=e,this.cssFormat=t,this.callback=i,this.loadBatchIndex=n}function a(e){return/^\/?ui\//.test(e)}function r(e){return!(a(e)||!window.wizAssets)}function l(e){return C*Math.pow(2,e-1)}function c(e){if(S+=1,!e)return u("emptyPath",e);if(a(e))return window.wizAssets?u(null,e,_.CDV_PATH+"/"+e):u(null,e,window.Config.uiUrl+"/"+e);if(b[e]||L[e])return console.warn('initiateAssetLoading: known missing asset "'+e+'" will be skip'),u(null,e,null);var t=window.Config.assetsUrl+"/"+e;if(!window.wizAssets)return u(null,e,t);var i=M,n=function(t){return u(null,e,t)},s=function(a){if(i-=1,/bones\/1107\/.*/.test(e))return L[e]=!0,u(a,e,null);if(i>0&&o(a)){var r=M-i,c=l(r);return window.gui.isConnected?v.setTimeout(window.wizAssets.downloadFile,c,t,e,n,s):window.setTimeout(window.wizAssets.downloadFile,c,t,e,n,s)}return u(a,e,null)};return window.wizAssets.downloadFile(t,e,n,s)}function u(e,t,i){e&&console.error("notifyAsLoaded: Could not load asset: "+t+" ("+JSON.stringify(e)+")");for(var n=I[t],o=0;o<n.length;o+=1){var s,a=n[o],r=a.callback,l=a.loadBatchIndex;s=i?a.cssFormat?y(i):i:null,r&&r(s,l)}delete I[t],S-=1,d()}function d(){for(;S<w&&A.length>0;){var e=A.pop();c(e)}}function h(e,t,i,n){e&&"/"===e.substring(0,1)&&(console.error(new Error('Starting by "/" for url '+e)),e=e.substring(1));var o=new s(e,t,i,n);I[e]?I[e].push(o):(I[e]=[o],S<w?c(e):A.push(e))}function p(e,t,i,n){function o(e,t){if(s[t]=e,r+=1,i&&i(e,t),r===a)return n&&n(s)}var s=[],a=e.length;if(0===a)return n&&n(s);for(var r=0,l=0;l<e.length;l+=1)h(e[l],t,o,l)}function m(e,t,i,o,s){0===E&&x(n,0),E<T?(E+=1,e(t,i,o,s)):x(function(){m(e,t,i,o,s)},0)}function f(e,t,i,n){if(!t)return i(_.EMPTY_IMAGE,n);var o=window.Config.imgCrossOrigin,s=new Image;o&&(s.crossOrigin=o);var a=M;s.onload=function(){return this.onload=null,this.onerror=null,i(this,n)},s.onerror=function(){return a-=1,a>0?void(this.src=t):(this.onload=null,this.onerror=null,r(e)&&(console.error("loadAndCreateImage: Image not found: "+t),window.wizAssets.deleteFile(e,function(){},function(e){console.error("loadAndCreateImage: Image could not be deleted: "+t+" with error: "+e)})),i(_.EMPTY_IMAGE,n))},s.src=t}function g(e,t,i,n){if(!t)return i(_.EMPTY_JSON,n);var o=M,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===~~s.readyState){if(200!==~~s.status&&0!==~~s.status)return o-=1,o>0?(s.open("GET",t,!0),void s.send()):(a(e)||console.error("loadAndParseJson: Failed to load json "+t+": "+s.status),i(_.EMPTY_JSON,n));var l;try{l=JSON.parse(s.response)}catch(c){return r(e)&&(console.error("loadAndParseJson: Could not parse json "+t+": "+c),window.wizAssets.deleteFile(e,function(){},function(e){console.error("loadAndParseJson: json could not be deleted: "+t+" with error: "+e)})),i(_.EMPTY_JSON,n)}return i(l,n)}},s.open("GET",t,!0),s.send()}var _=i(184),v=i(203),y=i(205).formatUrlToCssUrl,b=i(206),w=30,M=5,T=5,C=1e3,I={},A=[],S=0,E=0,x=window.setTimeout,L={},N=window.WizAssetsError&&window.WizAssetsError.HTTP_REQUEST_ERROR,O=window.WizAssetsError&&window.WizAssetsError.CONNECTIVITY_ERROR;t.preloadAsset=h,t.preloadAssets=p,t.preloadImages=function(e,t){return p(e,!0,null,t)},t.preloadImage=function(e,t){return h(e,!0,t)},t.preloadImageUrls=function(e,t){return p(e,!1,null,t)},t.preloadImageUrl=function(e,t){return h(e,!1,t)},t.loadImages=function(e,t,i){function n(e,n){if(o[n]=e,s+=1,t&&t(e,n),s===a)return i&&i(o)}var o=[],s=0,a=e.length;return 0===a?i&&i(o):void p(e,!1,function(t,i){m(f,e[i],t,n,i)},null)},t.loadImage=function(e,t){h(e,!1,function(i){m(f,e,i,t)})},t.loadJsons=function(e,t,i){p(e,!1,function(i,n){m(g,e[n],i,t,n)},i)},t.loadJson=function(e,t){h(e,!1,function(i){m(g,e,i,t)})}},function(e,t,i){function n(e,t,i){return function(){delete f[e],t.apply(this,i)}}function o(e,t,i,o){var s=m++;e===d.TYPES.TIMEOUT&&(t=n(s,t,o));var a=f[s]=new d(e,t,i,o);return p&&a.start(),s}function s(e){var t=f[e];t&&(t.clear(),delete f[e])}function a(){for(var e in f)f[e].clear();f={}}function r(){for(var e in f)f[e].start()}function l(){h=!1;for(var e in f)f[e]["continue"]()}function c(){for(var e in f)f[e].suspend();h=!0}function u(){a(),h=!1}var d=i(204),h=!1,p=!1,m=0,f={};t.initialize=function(e){e.on("connected",function(){p=!0,r()}),e.on("disconnect",function(){p=!1,u()}),e.on("appGoBackground",function(){c()}),e.on("connectedAfterAppLeaveBackground",function(){h&&l()})};var g=2;t.setTimeout=function(e,t){var i=[];if(arguments.length>g)for(var n=0;n<arguments.length-g;n++)i[n]=arguments[n+g];return o(d.TYPES.TIMEOUT,e,t,i)},t.setInterval=function(e,t){var i=[];if(arguments.length>g)for(var n=0;n<arguments.length-g;n++)i[n]=arguments[n+g];return o(d.TYPES.INTERVAL,e,t,i)},t.clearTimeout=t.clearInterval=function(e){return s(e),null}},function(e,t){function i(e,t,i,n){this._type=e,this._delay=i,this._action=t,this._arguments=n,this._startedAtTime=null,this._timeout=null,this._interval=null}function n(e){return function(){e._action.apply(this,e._arguments)}}function o(e){return function(){e._startedAtTime=Date.now(),e._action.apply(this,e._arguments)}}function s(e){return function(){e._timeout=null,e._interval=window.setInterval(o(e),e._delay),e._startedAtTime=Date.now(),e._action.apply(this,e._arguments)}}e.exports=i;var a={TIMEOUT:1,INTERVAL:2};i.TYPES=a,i.prototype.start=function(){this._startedAtTime||(this._startedAtTime=Date.now(),this._type===a.TIMEOUT?this._timeout=window.setTimeout(n(this),this._delay):this._type===a.INTERVAL&&(this._interval=window.setInterval(o(this),this._delay)))},i.prototype.suspend=function(){this._startedAtTime&&(this._type===a.TIMEOUT?this._timeout=window.clearTimeout(this._timeout):this._type===a.INTERVAL&&(this._timeout=window.clearTimeout(this._timeout),this._interval=window.clearInterval(this._interval)))},i.prototype["continue"]=function(){if(this._startedAtTime&&!this._timeout&&!this._interval){var e=Date.now()-this._startedAtTime,t=Math.max(0,this._delay-e);this._type===a.TIMEOUT?this._timeout=window.setTimeout(n(this),t):this._type===a.INTERVAL&&(this._timeout=window.setTimeout(s(this),t))}},i.prototype.clear=function(){this.suspend(),this._startedAtTime=null}},function(e,t){t.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},t.getOwnProperties=function(e){var t=[];if(e&&"object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t},t.shallowCopyProperties=function(e,t,i){if(e&&"object"==typeof e&&t&&"object"==typeof t&&Array.isArray(i))for(var n=0;n<i.length;n++){var o=i[n];t[o]=e[o]}},t.shallowCopyArray=function(e){return e.slice()},t.formatUrlToCssUrl=function(e){return'url("'+e+'")'}},function(e,t){e.exports={"bones/1/AnimAttaque0_1.json":!0,"bones/1/AnimAttaque0_1.png":!0,"bones/1/AnimAttaque0_5.json":!0,"bones/1/AnimAttaque0_5.png":!0,"bones/1/AnimAttaque101_2.json":!0,"bones/1/AnimAttaque101_2.png":!0,"bones/1/AnimAttaque101_6.json":!0,"bones/1/AnimAttaque101_6.png":!0,"bones/1/AnimAttaque1102_0.json":!0,"bones/1/AnimAttaque1102_0.png":!0,"bones/1/AnimAttaque1102_2.json":!0,"bones/1/AnimAttaque1102_2.png":!0,"bones/1/AnimAttaque1102_6.json":!0,"bones/1/AnimAttaque1102_6.png":!0,"bones/1/AnimAttaque14051_6.json":!0,"bones/1/AnimAttaque14051_6.png":!0,"bones/1/AnimAttaque140_0.json":!0,"bones/1/AnimAttaque140_0.png":!0,"bones/1/AnimAttaque140_6.json":!0,"bones/1/AnimAttaque140_6.png":!0,"bones/1/AnimAttaque15751_1.json":!0,"bones/1/AnimAttaque15751_1.png":!0,"bones/1/AnimAttaque15751_5.json":!0,"bones/1/AnimAttaque15751_5.png":!0,"bones/1/AnimAttaque15752_5.json":!0,"bones/1/AnimAttaque15752_5.png":!0,"bones/1/AnimAttaque15755_1.json":!0,"bones/1/AnimAttaque15755_1.png":!0,"bones/1/AnimAttaque15755_5.json":!0,"bones/1/AnimAttaque15755_5.png":!0,"bones/1/AnimAttaque15761_5.json":!0,"bones/1/AnimAttaque15761_5.png":!0,"bones/1/AnimAttaque15762_1.json":!0,"bones/1/AnimAttaque15762_1.png":!0,"bones/1/AnimAttaque15762_5.json":!0,"bones/1/AnimAttaque15762_5.png":!0,"bones/1/AnimAttaque1_6.json":!0,"bones/1/AnimAttaque1_6.png":!0,"bones/1/AnimAttaque301_0.json":!0,"bones/1/AnimAttaque301_0.png":!0,"bones/1/AnimAttaque301_2.json":!0,"bones/1/AnimAttaque301_2.png":!0,"bones/1/AnimAttaque4_6.json":!0,"bones/1/AnimAttaque4_6.png":!0,"bones/1/AnimAttaque5_2.json":!0,"bones/1/AnimAttaque5_2.png":!0,"bones/1/AnimAttaque5_6.json":!0,"bones/1/AnimAttaque5_6.png":!0,"bones/1/AnimAttaque6_2.json":!0,"bones/1/AnimAttaque6_2.png":!0,
"bones/1/AnimAttaque6_6.json":!0,"bones/1/AnimAttaque6_6.png":!0,"bones/1/AnimAttaque801_2.json":!0,"bones/1/AnimAttaque801_2.png":!0,"bones/1/AnimAttaque801_6.json":!0,"bones/1/AnimAttaque801_6.png":!0,"bones/1/AnimAttaque8_2.json":!0,"bones/1/AnimAttaque8_2.png":!0,"bones/1/AnimAttaque8_6.json":!0,"bones/1/AnimAttaque8_6.png":!0,"bones/1/AnimAttaque901_0.json":!0,"bones/1/AnimAttaque901_0.png":!0,"bones/1/AnimAttaque901_2.json":!0,"bones/1/AnimAttaque901_2.png":!0,"bones/1/AnimAttaque901_6.json":!0,"bones/1/AnimAttaque901_6.png":!0,"bones/1/AnimAttaque9_0.json":!0,"bones/1/AnimAttaque9_0.png":!0,"bones/1/AnimAttaque9_2.json":!0,"bones/1/AnimAttaque9_2.png":!0,"bones/1/AnimAttaque9_6.json":!0,"bones/1/AnimAttaque9_6.png":!0,"bones/1/AnimHit_0.json":!0,"bones/1/AnimHit_0.png":!0,"bones/1/AnimHit_2.json":!0,"bones/1/AnimHit_2.png":!0,"bones/1/AnimHit_6.json":!0,"bones/1/AnimHit_6.png":!0,"bones/1/AnimMort_0.json":!0,"bones/1/AnimMort_0.png":!0,"bones/1/AnimMort_2.json":!0,"bones/1/AnimMort_2.png":!0,"bones/1/AnimMort_6.json":!0,"bones/1/AnimMort_6.png":!0,"bones/1068/AnimHit_1.json":!0,"bones/1068/AnimHit_1.png":!0,"bones/1068/AnimHit_5.json":!0,"bones/1068/AnimHit_5.png":!0,"bones/1068/AnimMort_1.json":!0,"bones/1068/AnimMort_1.png":!0,"bones/1068/AnimMort_5.json":!0,"bones/1068/AnimMort_5.png":!0,"bones/1084/AnimEmoteEat_0_1.json":!0,"bones/1084/AnimEmoteEat_0_1.png":!0,"bones/1084/AnimHit_1.json":!0,"bones/1084/AnimHit_1.png":!0,"bones/1084/AnimHit_5.json":!0,"bones/1084/AnimHit_5.png":!0,"bones/1084/AnimMort_1.json":!0,"bones/1084/AnimMort_1.png":!0,"bones/1084/AnimMort_5.json":!0,"bones/1084/AnimMort_5.png":!0,"bones/1084/AnimPioche_5.json":!0,"bones/1084/AnimPioche_5.png":!0,"bones/1107/AnimCueillir0_5.json":!0,"bones/1107/AnimCueillir0_5.png":!0,"bones/1107/AnimEmoteDrink_0_1.json":!0,"bones/1107/AnimEmoteDrink_0_1.png":!0,"bones/1166/AnimAttaque1203_1.json":!0,"bones/1166/AnimAttaque1203_1.png":!0,"bones/1166/AnimAttaque1203_5.json":!0,"bones/1166/AnimAttaque1203_5.png":!0,"bones/1167/AnimAttaque1203_1.json":!0,"bones/1167/AnimAttaque1203_1.png":!0,"bones/1168/AnimAttaque1203_1.json":!0,"bones/1168/AnimAttaque1203_1.png":!0,"bones/1168/AnimAttaque1203_5.json":!0,"bones/1168/AnimAttaque1203_5.png":!0,"bones/1169/AnimAttaque1203_1.json":!0,"bones/1169/AnimAttaque1203_1.png":!0,"bones/1169/AnimAttaque1203_5.json":!0,"bones/1169/AnimAttaque1203_5.png":!0,"bones/1170/AnimAttaque1203_1.json":!0,"bones/1171/AnimAttaque1203_1.json":!0,"bones/1171/AnimAttaque1203_1.png":!0,"bones/1171/AnimAttaque1203_5.json":!0,"bones/1171/AnimAttaque1203_5.png":!0,"bones/1189/AnimAttaque1203_1.json":!0,"bones/1189/AnimAttaque1203_1.png":!0,"bones/1190/AnimAttaque1203_1.json":!0,"bones/1190/AnimAttaque1203_5.json":!0,"bones/1190/AnimAttaque1203_5.png":!0,"bones/1191/AnimAttaque1203_1.json":!0,"bones/1191/AnimAttaque1203_1.png":!0,"bones/1191/AnimAttaque1203_5.json":!0,"bones/1191/AnimAttaque1203_5.png":!0,"bones/1202/AnimPeche_1.json":!0,"bones/1202/AnimPeche_1.png":!0,"bones/1202/AnimPeche_5.json":!0,"bones/1202/AnimPeche_5.png":!0,"bones/1202/AnimPioche_1.json":!0,"bones/1202/AnimPioche_1.png":!0,"bones/1202/AnimPioche_5.json":!0,"bones/1202/AnimPioche_5.png":!0,"bones/1207/AnimAttaque1203_1.json":!0,"bones/1207/AnimAttaque1203_5.png":!0,"bones/1208/AnimAttaque1203_1.json":!0,"bones/1208/AnimAttaque1203_1.png":!0,"bones/1208/AnimAttaque1203_5.json":!0,"bones/1208/AnimAttaque1203_5.png":!0,"bones/1210/AnimAttaque1203_1.json":!0,"bones/1226/AnimAttaque1203_1.json":!0,"bones/1226/AnimAttaque1203_1.png":!0,"bones/1226/AnimAttaque1203_5.json":!0,"bones/1226/AnimAttaque1203_5.png":!0,"bones/1249/AnimAttaque1_5.json":!0,"bones/1249/AnimAttaque1_5.png":!0,"bones/1300/AnimAttaque1203_5.json":!0,"bones/1302/AnimAttaque1203_1.json":!0,"bones/1311/FX.json":!0,"bones/1311/FX.png":!0,"bones/1325/AnimAttaque1203_1.json":!0,"bones/1325/AnimAttaque1203_1.png":!0,"bones/1325/AnimAttaque1203_5.json":!0,"bones/1325/AnimAttaque1203_5.png":!0,"bones/14/AnimHitCarrying_1.json":!0,"bones/14/AnimHitCarrying_1.png":!0,"bones/14/AnimHitCarrying_5.json":!0,"bones/14/AnimHitCarrying_5.png":!0,"bones/14/carrying.json":!0,"bones/14/carrying.png":!0,"bones/1410/AnimAttaque1203_1.json":!0,"bones/1410/AnimAttaque1203_1.png":!0,"bones/1410/AnimAttaque1203_5.json":!0,"bones/1410/AnimAttaque1203_5.png":!0,"bones/1411/AnimAttaque1203_1.json":!0,"bones/1411/AnimAttaque1203_1.png":!0,"bones/1411/AnimAttaque1203_5.json":!0,"bones/1411/AnimAttaque1203_5.png":!0,"bones/1422/AnimAttaque1203_1.json":!0,"bones/1422/AnimAttaque1203_1.png":!0,"bones/1422/AnimAttaque1203_5.json":!0,"bones/1422/AnimAttaque1203_5.png":!0,"bones/1537/AnimVanish_1.json":!0,"bones/1537/AnimVanish_1.png":!0,"bones/1537/AnimVanish_5.json":!0,"bones/1537/AnimVanish_5.png":!0,"bones/1540/AnimVanish_1.json":!0,"bones/1540/AnimVanish_1.png":!0,"bones/1540/AnimVanish_5.json":!0,"bones/1540/AnimVanish_5.png":!0,"bones/1575/AnimPioche_5.json":!0,"bones/1575/AnimPioche_5.png":!0,"bones/1576/AnimAttaque14372_5.json":!0,"bones/1576/AnimAttaque14372_5.png":!0,"bones/1633/AnimEmoteEat_0_5.json":!0,"bones/1633/AnimEmoteEat_0_5.png":!0,"bones/1747/AnimVanish_1.json":!0,"bones/1747/AnimVanish_1.png":!0,"bones/1747/AnimVanish_5.json":!0,"bones/1747/AnimVanish_5.png":!0,"bones/1748/AnimVanish_1.json":!0,"bones/1748/AnimVanish_1.png":!0,"bones/1748/AnimVanish_5.json":!0,"bones/1748/AnimVanish_5.png":!0,"bones/1749/AnimThrow_1.json":!0,"bones/1749/AnimThrow_1.png":!0,"bones/1749/AnimThrow_5.json":!0,"bones/1749/AnimThrow_5.png":!0,"bones/1749/carrying.json":!0,"bones/1749/carrying.png":!0,"bones/18/AnimCueillirSol1_1.json":!0,"bones/18/AnimCueillirSol1_1.png":!0,"bones/18/AnimCueillirSol1_5.json":!0,"bones/18/AnimCueillirSol1_5.png":!0,"bones/1846/AnimVanish_1.json":!0,"bones/1846/AnimVanish_1.png":!0,"bones/1846/AnimVanish_5.json":!0,"bones/1846/AnimVanish_5.png":!0,"bones/1886/AnimCueillirSol1_1.json":!0,"bones/1886/AnimCueillirSol1_1.png":!0,"bones/195/AnimEmoteAlliance_0_5.json":!0,"bones/195/AnimEmoteAlliance_0_5.png":!0,"bones/195/AnimEmoteGuild_0_5.json":!0,"bones/195/AnimEmoteGuild_0_5.png":!0,"bones/195/AnimFaucher_1.json":!0,"bones/195/AnimFaucher_1.png":!0,"bones/195/AnimFaucher_5.json":!0,"bones/195/AnimFaucher_5.png":!0,"bones/1957/FX.json":!0,"bones/1957/FX.png":!0,"bones/1982/AnimPioche_5.json":!0,"bones/1982/AnimPioche_5.png":!0,"bones/1990/AnimEmoteAlliance_0_1.json":!0,"bones/1990/AnimEmoteAlliance_0_1.png":!0,"bones/1990/AnimEmoteDrink_0_1.json":!0,"bones/1990/AnimEmoteDrink_0_1.png":!0,"bones/1990/AnimEmoteEat_0_1.json":!0,"bones/1990/AnimEmoteEat_0_1.png":!0,"bones/1990/AnimEmoteEat_0_5.json":!0,"bones/1990/AnimEmoteEat_0_5.png":!0,"bones/1990/AnimPioche_5.json":!0,"bones/1990/AnimPioche_5.png":!0,"bones/2/AnimArme83_5.json":!0,"bones/2/AnimArme83_5.png":!0,"bones/2/AnimAttaque0_0.json":!0,"bones/2/AnimAttaque0_0.png":!0,"bones/2/AnimAttaque0_2.json":!0,"bones/2/AnimAttaque0_2.png":!0,"bones/2/AnimAttaque0_6.json":!0,"bones/2/AnimAttaque0_6.png":!0,"bones/2/AnimEmoteCard_0_1.json":!0,"bones/2/AnimEmoteCard_0_1.png":!0,"bones/2/AnimEmoteDino_0_1.json":!0,"bones/2/AnimEmoteDino_0_1.png":!0,"bones/2/AnimEmoteKowtow_0_1.json":!0,"bones/2/AnimEmoteKowtow_0_1.png":!0,"bones/2/AnimEmoteSeiza_0_1.json":!0,"bones/2/AnimEmoteSeiza_0_1.png":!0,"bones/2/AnimEmoteSeiza_0_5.json":!0,"bones/2/AnimEmoteSeiza_0_5.png":!0,"bones/2/AnimHitCarrying_1.json":!0,"bones/2/AnimHitCarrying_1.png":!0,"bones/2/AnimHitCarrying_5.json":!0,"bones/2/AnimHitCarrying_5.png":!0,"bones/2/AnimHit_0.json":!0,"bones/2/AnimHit_0.png":!0,"bones/2/AnimHit_2.json":!0,"bones/2/AnimHit_2.png":!0,"bones/2/AnimHit_6.json":!0,"bones/2/AnimHit_6.png":!0,"bones/2/AnimMort_0.json":!0,"bones/2/AnimMort_0.png":!0,"bones/2001/FX.json":!0,"bones/2001/FX.png":!0,"bones/2013/AnimEmoteDrink_0_1.json":!0,"bones/2013/AnimEmoteDrink_0_1.png":!0,"bones/2013/AnimEmoteDrink_0_5.json":!0,"bones/2013/AnimEmoteDrink_0_5.png":!0,"bones/2013/AnimEmoteEat_0_1.json":!0,"bones/2013/AnimEmoteEat_0_1.png":!0,"bones/2013/AnimEmoteEat_0_5.json":!0,"bones/2013/AnimEmoteEat_0_5.png":!0,"bones/2013/AnimEmoteGuild_0_1.json":!0,"bones/2013/AnimEmoteGuild_0_1.png":!0,"bones/2013/AnimHache_5.json":!0,"bones/2013/AnimHache_5.png":!0,"bones/2069/AnimVanish_1.json":!0,"bones/2069/AnimVanish_5.json":!0,"bones/2070/AnimAttaque4_5.json":!0,"bones/2070/AnimAttaque4_5.png":!0,"bones/23/AnimEmoteDrink_0_1.json":!0,"bones/23/AnimEmoteDrink_0_1.png":!0,"bones/23/AnimEmoteDrink_0_5.json":!0,"bones/23/AnimEmoteDrink_0_5.png":!0,"bones/2350/FX.json":!0,"bones/2350/FX.png":!0,"bones/243/AnimCueillir0_5.json":!0,"bones/243/AnimCueillir0_5.png":!0,"bones/255/AnimEmoteRest_0_1.json":!0,"bones/255/AnimEmoteRest_0_1.png":!0,"bones/255/AnimEmoteSit_0_1.json":!0,"bones/255/AnimEmoteSit_0_1.png":!0,"bones/267/AnimCueillir0_1.json":!0,"bones/267/AnimCueillir0_1.png":!0,"bones/267/AnimCueillir0_5.json":!0,"bones/267/AnimCueillir0_5.png":!0,"bones/267/AnimEmoteDrink_0_1.json":!0,"bones/267/AnimEmoteDrink_0_1.png":!0,"bones/323/AnimAttaque2_1.json":!0,"bones/323/AnimAttaque2_1.png":!0,"bones/323/AnimAttaque2_5.json":!0,"bones/323/AnimAttaque2_5.png":!0,"bones/342/AnimAttaque1203_1.json":!0,"bones/342/AnimAttaque1203_1.png":!0,"bones/342/AnimAttaque1203_5.json":!0,"bones/342/AnimAttaque1203_5.png":!0,"bones/3519/motion.json":!0,"bones/3519/motion.png":!0,"bones/357/AnimEmoteDrink_0_1.json":!0,"bones/357/AnimEmoteDrink_0_1.png":!0,"bones/40/AnimCueillirSol1_1.json":!0,"bones/40/AnimCueillirSol1_1.png":!0,"bones/40/AnimCueillirSol1_5.json":!0,"bones/40/AnimCueillirSol1_5.png":!0,"bones/401/FX.json":!0,"bones/401/FX.png":!0,"bones/4024/FX.json":!0,"bones/4024/FX.png":!0,"bones/44/AnimAttaque1210_5.json":!0,"bones/44/AnimAttaque1210_5.png":!0,"bones/44/AnimEmoteSit_0_5.json":!0,"bones/44/AnimEmoteSit_0_5.png":!0,"bones/44/AnimPeche_1.json":!0,"bones/44/AnimPeche_1.png":!0,"bones/44/AnimPeche_5.json":!0,"bones/44/AnimPeche_5.png":!0,"bones/453/AnimAttaque1203_5.json":!0,"bones/453/AnimAttaque1203_5.png":!0,"bones/453/AnimAttaque1203_1.png":!0,"bones/453/AnimAttaque1203_1.json":!0,"bones/453/AnimAttaque603_1.json":!0,"bones/453/AnimAttaque603_1.png":!0,"bones/453/AnimAttaque603_5.json":!0,"bones/453/AnimAttaque603_5.png":!0,"bones/5073/AnimVanish_1.json":!0,"bones/5073/AnimVanish_1.png":!0,"bones/5073/AnimVanish_5.json":!0,"bones/5073/AnimVanish_5.png":!0,"bones/5087/AnimEmoteDrink_0_1.json":!0,"bones/5087/AnimEmoteDrink_0_1.png":!0,"bones/5087/AnimEmoteDrink_0_5.json":!0,"bones/5087/AnimEmoteDrink_0_5.png":!0,"bones/5087/AnimEmoteEat_0_1.json":!0,"bones/5087/AnimEmoteEat_0_1.png":!0,"bones/5087/AnimEmoteEat_0_5.json":!0,"bones/5087/AnimEmoteEat_0_5.png":!0,"bones/5087/AnimLevelUpRiding_1.json":!0,"bones/5087/AnimLevelUpRiding_1.png":!0,"bones/5087/AnimVanish_1.json":!0,"bones/5087/AnimVanish_1.png":!0,"bones/5087/AnimVanish_5.json":!0,"bones/5087/AnimVanish_5.png":!0,"bones/5091/AnimEmoteDrink_0_1.json":!0,"bones/5091/AnimEmoteDrink_0_1.png":!0,"bones/5091/AnimEmoteDrink_0_5.json":!0,"bones/5091/AnimEmoteDrink_0_5.png":!0,"bones/5091/AnimEmoteEat_0_1.json":!0,"bones/5091/AnimEmoteEat_0_1.png":!0,"bones/5091/AnimEmoteEat_0_5.json":!0,"bones/5091/AnimEmoteEat_0_5.png":!0,"bones/557/AnimAttaque3_5.json":!0,"bones/557/AnimAttaque3_5.png":!0,"bones/558/AnimAttaque3_5.json":!0,"bones/558/AnimAttaque3_5.png":!0,"bones/560/AnimCueillir0_1.json":!0,"bones/560/AnimCueillir0_1.png":!0,"bones/560/AnimCueillir0_5.json":!0,"bones/560/AnimCueillir0_5.png":!0,"bones/560/AnimEmoteBeer_0_1.json":!0,"bones/560/AnimEmoteBeer_0_1.png":!0,"bones/560/AnimEmoteBeer_0_5.json":!0,"bones/560/AnimEmoteBeer_0_5.png":!0,"bones/560/AnimEmoteDrink_0_1.json":!0,"bones/560/AnimEmoteDrink_0_1.png":!0,"bones/560/AnimEmoteDrink_0_5.json":!0,"bones/560/AnimEmoteDrink_0_5.png":!0,"bones/560/AnimEmoteEat_0_1.json":!0,"bones/560/AnimEmoteEat_0_1.png":!0,"bones/560/AnimEmoteEat_0_5.json":!0,"bones/560/AnimEmoteEat_0_5.png":!0,"bones/560/AnimEmoteRest_0_1.json":!0,"bones/560/AnimEmoteRest_0_1.png":!0,"bones/560/AnimEmoteSit_0_1.json":!0,"bones/560/AnimEmoteSit_0_1.png":!0,"bones/560/AnimEmoteSit_0_5.json":!0,"bones/560/AnimEmoteSit_0_5.png":!0,"bones/560/AnimHache_1.json":!0,"bones/560/AnimHache_1.png":!0,"bones/560/AnimHache_5.json":!0,"bones/560/AnimHache_5.png":!0,"bones/560/AnimPioche_5.json":!0,"bones/560/AnimPioche_5.png":!0,"bones/570/AnimCueillir0_1.json":!0,"bones/570/AnimCueillir0_1.png":!0,"bones/570/AnimCueillir0_5.json":!0,"bones/570/AnimCueillir0_5.png":!0,"bones/570/AnimCueillirSol0_1.json":!0,"bones/570/AnimCueillirSol0_1.png":!0,"bones/570/AnimCueillirSol0_5.json":!0,"bones/570/AnimCueillirSol0_5.png":!0,"bones/570/AnimEmoteDrink_0_1.json":!0,"bones/570/AnimEmoteDrink_0_1.png":!0,"bones/639/AnimAttaque1001_1.json":!0,"bones/639/AnimAttaque1001_1.png":!0,"bones/639/AnimAttaque101_1.json":!0,"bones/639/AnimAttaque101_1.png":!0,"bones/639/AnimAttaque1102_1.json":!0,"bones/639/AnimAttaque1102_1.png":!0,"bones/639/AnimAttaque1102_5.json":!0,"bones/639/AnimAttaque1102_5.png":!0,"bones/639/AnimAttaque1103_1.json":!0,"bones/639/AnimAttaque1103_1.png":!0,"bones/639/AnimAttaque201_1.json":!0,"bones/639/AnimAttaque201_5.json":!0,"bones/639/AnimAttaque201_5.png":!0,"bones/639/AnimAttaque2_5.json":!0,"bones/639/AnimAttaque2_5.png":!0,"bones/639/AnimAttaque403_1.json":!0,"bones/639/AnimAttaque501_5.json":!0,"bones/639/AnimAttaque501_5.png":!0,"bones/639/AnimAttaque602_5.json":!0,"bones/639/AnimAttaque602_5.png":!0,"bones/639/AnimAttaque7_1.json":!0,"bones/639/AnimAttaque7_1.png":!0,"bones/639/AnimAttaque7_5.json":!0,"bones/639/AnimAttaque7_5.png":!0,"bones/639/AnimAttaque801_1.json":!0,"bones/639/AnimAttaque801_1.png":!0,"bones/639/AnimAttaque801_5.json":!0,"bones/639/AnimAttaque801_5.png":!0,"bones/639/AnimAttaque803_1.json":!0,"bones/639/AnimAttaque803_1.png":!0,"bones/639/AnimAttaque803_5.json":!0,"bones/639/AnimAttaque803_5.png":!0,"bones/639/AnimAttaque8_5.json":!0,"bones/639/AnimAttaque8_5.png":!0,"bones/639/AnimAttaque902_5.json":!0,"bones/639/AnimAttaque902_5.png":!0,"bones/639/AnimAttaque9_1.json":!0,"bones/639/AnimAttaque9_1.png":!0,"bones/639/AnimAttaque9_5.json":!0,"bones/639/AnimAttaque9_5.png":!0,"bones/639/AnimCueillir0_1.json":!0,"bones/639/AnimCueillir0_1.png":!0,"bones/639/AnimCueillir0_5.json":!0,"bones/639/AnimCueillir0_5.png":!0,"bones/639/AnimCueillirSol0_1.json":!0,"bones/639/AnimCueillirSol0_1.png":!0,"bones/639/AnimCueillirSol0_5.json":!0,"bones/639/AnimCueillirSol0_5.png":!0,"bones/639/AnimEmoteAlliance_0_1.json":!0,"bones/639/AnimEmoteAlliance_0_1.png":!0,"bones/639/AnimEmoteAlliance_0_5.json":!0,"bones/639/AnimEmoteAlliance_0_5.png":!0,"bones/639/AnimEmoteGuild_0_1.json":!0,"bones/639/AnimEmoteGuild_0_1.png":!0,"bones/639/AnimEmoteGuild_0_5.json":!0,"bones/639/AnimEmoteGuild_0_5.png":!0,"bones/639/AnimEmoteWeap_0_1.json":!0,"bones/639/AnimEmoteWeap_0_1.png":!0,"bones/639/AnimHache_1.json":!0,"bones/639/AnimHache_1.png":!0,"bones/639/AnimHache_5.json":!0,"bones/639/AnimHache_5.png":!0,"bones/639/AnimHit_0.json":!0,"bones/639/AnimHit_0.png":!0,"bones/639/AnimHit_2.json":!0,"bones/639/AnimHit_2.png":!0,"bones/639/AnimHit_6.json":!0,"bones/639/AnimHit_6.png":!0,"bones/639/AnimLevelUpRiding_1.json":!0,"bones/639/AnimLevelUpRiding_1.png":!0,"bones/639/AnimMort_0.json":!0,"bones/639/AnimMort_0.png":!0,"bones/639/AnimPickup_1.png":!0,"bones/639/AnimPioche_1.json":!0,"bones/639/AnimPioche_1.png":!0,"bones/639/AnimPioche_5.json":!0,"bones/639/AnimPioche_5.png":!0,"bones/639/AnimThrow_5.png":!0,"bones/639/AnimVanish_1.json":!0,"bones/639/AnimVanish_1.png":!0,"bones/639/AnimVanish_5.json":!0,"bones/639/AnimVanish_5.png":!0,"bones/892/AnimAttaque2_1.json":!0,"bones/892/AnimAttaque2_1.png":!0,"bones/892/AnimAttaque2_5.json":!0,"bones/892/AnimAttaque2_5.png":!0,"bones/1123/AnimAttaque1_1.json":!0,"bones/1123/AnimAttaque1_5.json":!0,"bones/1123/AnimAttaque1_1.png":!0,"bones/1123/AnimAttaque1_5.png":!0,"bones/timeline/1418/motion.json":!0,"bones/timeline/1420/motion.json":!0,"bones/timeline/1420/motion.png":!0,"bones/timeline/1421/motion.json":!0,"bones/timeline/1421/motion.png":!0,"bones/timeline/1447/motion.json":!0,"bones/timeline/1447/motion.png":!0,"bones/timeline/1909/motion.json":!0,"bones/timeline/1909/motion.png":!0,"bones/timeline/2021/motion.json":!0,"bones/timeline/2021/motion.png":!0,"bones/timeline/2022/motion.json":!0,"bones/timeline/2022/motion.png":!0,"bones/timeline/2023/motion.json":!0,"bones/timeline/2023/motion.png":!0,"bones/timeline/2024/motion.json":!0,"bones/timeline/2024/motion.png":!0,"bones/timeline/2244/motion.json":!0,"bones/timeline/2244/motion.png":!0,"bones/timeline/5039/motion.json":!0,"bones/timeline/5039/motion.png":!0,"bones/timeline/5056/motion.json":!0,"bones/timeline/5056/motion.png":!0,"bones/timeline/5077/motion.json":!0,"bones/timeline/5077/motion.png":!0,"bones/timeline/5078/motion.json":!0,"bones/timeline/5078/motion.png":!0,"gfx/monsters/1122.png":!0,"gfx/monsters/3203.png":!0,"skins/0.json":!0,"skins/0.png":!0,"skins/919.json":!0,"skins/919.png":!0}},function(e,t,i){function n(e){if(!window.Config.sessionId)return console.warn("Cannot make URL sticky (no session ID has been set):",e),e;var t=e.indexOf("?")===-1?"?":"&";return e+t+x+"="+encodeURIComponent(window.Config.sessionId)}function o(){var e=window.appInfo||{};return e.server?e.server:"https://proxyconnection.touch.dofus.com"}function s(e){for(var t=0;t<O.length;t+=1){var i=O[t];if(i.id===e)return i}}function a(e,t){var i={};e&&(i.lang=e);var n=o()+"/config.json?"+S.stringify(i);p.loadJson(n,function(e,i){return e?t(e):(i.imgCrossOrigin=i.assetsUrl.match(/^https?:\/\/.+?:.+?@.+?/)?void 0:"anonymous",void t(null,i))})}function r(e,i){h.auto({primus:function(e){return window.Primus?e():void p.loadScript(o()+"/primus/primus.js",e)},config:function(i){return window.Config?e?t.setLanguage(e,i):i():void a(e,function(e,t){return e?i(e):(window.Config=t,void i())})},syncSetup:["config",function(e,t){f.setup(window.Config),v.initialize(window.Config),t()}],getText:["syncSetup",function(e,t){y.initialize(window.Config,t)}]},i)}function l(){M.setupChannels(_.getValue("soundPreferences",{},!0)),M.playLoopSound("music","20000",.8)}function c(){M.stopAllLoopSounds(),M.release()}function u(){return window.gui.splashScreen.show(),window.setTimeout(function(){window.gui.splashScreen.hide(),window.location.reload()},3e4)}function d(e){var t={language:window.Config?window.Config.language:"en",server:e,client:E.os,appVersion:L,buildVersion:N};return t}var h=i(31),p=i(208),m=i(209).EventEmitter,f=i(210),g=i(271),_=i(195),v=i(30),y=i(29),b=i(282);i(293);var w=i(376),M=i(258),T=i(377),C=i(378),I=i(7),A=i(199),S=i(39),E=i(185);window.developmentMode&&i(379);var x="STICKER",L=window.appInfo&&window.appInfo.version,N=window.buildVersion;t=e.exports=new m,t.logger=f,t.connectionManager=g,t.sessionId=null;var O=[],D=!1;t.setLanguage=function(e,t){if(!window.Config||e&&window.Config.language===e)return t();var i=o()+"/getLanguage.json?lang="+e;p.loadJson(i,function(e,i){return e?t(e):(window.Config.language=i.language,void t())})},t.start=function(){window.gui.initialize();var e=_.getValue("lang");r(e,function(e){return e?t.reloadAppOnFatalError(e):(I.init(window.Config.analytics),A.initialize(window.Config.adjust,window.Adjust,window.AdjustConfig,window.AdjustEvent),b.backToLogin(),window.gui.initialize(window.Config),void(window.isoEngine&&window.isoEngine.initialize()))})},t.reloadAppOnFatalError=function(e,t){t=t||"Server busy",console.error("Reloading on fatal error: "+e),navigator.notification?navigator.notification.alert(t,u,"Dofus Touch","Reload"):(window.alert(t),u())};var R,P=0,B=1,k=2,F=3,z=4,H=P,q={username:null,token:null,salt:null,key:null};t.setCredentials=function(e,t){_.setValue("token",t),q.username=e,q.token=t,q.salt=null,q.key=null},t.login=function(e){if(H===k)return console.warn("Already logged in"),e();if(H===B)return console.warn("Already logging in"),t.once("loginEnd",e);H===z&&g.disconnect("SWITCHING_TO_LOGIN"),H=B,q.salt=null,q.key=null,D=!1;var i=C(g,function(i){i?(this.disconnect("LOGIN_ERROR"),H=P,t.emit("loginEnd",i)):(H=k,t.emit("loginEnd")),e(i)});i("disconnect",function(){throw D=!0,new Error("Disconnect during login")}),i("open",function(){this.send("connecting",d("login"))}),i("serverDisconnecting",function(e){D||(D=!0,i.done(e))}),i("ProtocolRequired",function(e){console.log("[Login server protocol] requiredVersion:",e.requiredVersion,"currentVersion:",e.currentVersion)}),i("HelloConnectMessage",function(e){q.salt=e.salt,q.key=e.key,this.send("login",q)}),i("IdentificationSuccessMessage","IdentificationSuccessWithLoginTokenMessage",function(e){var n=window.gui.playerData.loginName;if(n){if(/^\[GUEST]/.test(n)){if(window.Config.disabledFeatures.guest)return i.done(new Error("identification: no guests"));var o=_.getValue("guestAccount",{},!0);o.nickname=e.nickname}}else console.error("dofus.login: loginName is empty");_.setAccount(e.nickname),_.setValue("token",e.loginToken),l(),T.start(),e.wasAlreadyConnected&&t.emit("wasAlreadyConnected")}),i("ConnectionFailedMessage","IdentificationFailedMessage","IdentificationFailedForBadVersionMessage","IdentificationFailedBannedMessage",function(e){i.done(e)}),i("ServersListMessage",function(e){O=e.servers,i.done()}),g.connect(n(o()))},t.accessGameServer=function(e,i){if(H===B)return t.once("loginEnd",function(n){return n?i(n):void t.accessGameServer(e,i)});if(H===F)return e===R?(console.warn("Already accessing this game server ("+e+")"),t.once("accessGameEnd",i)):i(new Error("Already accessing game server "+R+" (while trying to access "+e+")"));if(R=e,H!==k)return t.login(function(n){return n?i(n):void t.accessGameServer(e,i)});var o,a,r,l=s(e);if(!l)return i(new Error("Unknown server: "+e));H=F;var c=C(g,function(e){e?(this.disconnect("GAME_HANDSHAKE_ERROR"),H=P,t.emit("accessGameEnd",e)):(H=z,t.emit("accessGameEnd")),R=null,i(e)});c("SelectedServerDataMessage",function(e){o=e.ticket,a=e.address,r=e.port,g.switchToGame(n(e._access))}),c("SelectedServerRefusedMessage",function(e){throw new Error("serverId "+e.serverId+" not accessible, error: "+e.error+", serverStatus: "+e.serverStatus)}),c("open",function(){this.send("connecting",d({address:a,port:r,id:e}))}),c("serverDisconnecting",function(e){c.done(e)}),c("ProtocolRequired",function(e){console.log("[Game server protocol] requiredVersion:",e.requiredVersion,"currentVersion:",e.currentVersion)}),c("HelloGameMessage",function(){this.sendMessage("AuthenticationTicketMessage",{ticket:o,lang:window.Config.language})}),c("AuthenticationTicketAcceptedMessage",function(){c.done()}),c("AuthenticationTicketRefusedMessage",function(){console.error(new Error("Server "+e+" Authentication failed")),c.done()}),g.sendMessage("ServerSelectionMessage",{serverId:e})},g.on("HelloConnectMessage",function(){window.gui.connectionSplashScreen.onStateChange("CONNECTED")}),g.on("offline",function(){window.gui.connectionSplashScreen.onStateChange("UNSTABLE")}),g.on("reconnecting",function(e,t){console.info("Reconnecting to "+t+" (attempt #"+e+")"),window.gui.connectionSplashScreen.onStateChange("RECONNECTING",e)}),g.on("open",function(e){e&&g.send("reconnecting")}),g.on("sessionReconnected",function(){return window.isoEngine.onQuickReconnection(function(){window.gui.connectionSplashScreen.onStateChange("CONNECTED")})}),g.on("sessionTimedOut",function(){console.info("Session timed out"),g.disconnect("SESSION_TIMED_OUT")}),g.on("serverDisconnecting",function(e){console.info("Server disconnecting, reason:",e.reason),g.disconnect("SOCKET_LOST")}),g.on("disconnect",function(e){H=P,e.match(/^SWITCHING_/)||(c(),T.stop(),window.gui.disconnect(e),window.isoEngine&&window.isoEngine.disconnect(),window.gui.connectionSplashScreen.onStateChange("RELOAD"===e?"RELOADING":"DISCONNECTED"))}),t.toggleTutorialListeners=function(e){e?w.setTutorialListeners(g):w.removeTutorialListeners(g)},t.send=function(e,t){g.send(e,t)},t.sendMessage=function(e,t){g.sendMessage(e,t)},t.disconnect=function(e){g.disconnect(e)},window.addEventListener("beforeunload",function(){g.disconnect("RELOAD")})},function(e,t){function i(e,t){var i=document.getElementsByTagName("head")[0],n=document.createElement("script");n.onload=function(){return this.onload=null,this.onerror=null,t()},n.onerror=function(){return this.onload=null,this.onerror=null,t(new Error("Error loading script: "+e))},n.type="text/javascript",n.src=e,i.appendChild(n)}function n(e,t){var i=new XMLHttpRequest;i.overrideMimeType("application/json"),i.onreadystatechange=function(){if(4===~~i.readyState){if(i.onreadystatechange=null,200!==~~i.status)return t(new Error("Error loading json: "+e));var n;try{n=JSON.parse(i.responseText)}catch(o){return t(o)}return t(null,n)}},i.open("GET",e,!0),i.send(null)}e.exports.loadScript=i,e.exports.loadJson=n},function(e,t){var i=function(){this.eventHandlers={}};i.EventEmitter=i,e.exports=i,i.listenerCount=function(e,t){var i=e.eventHandlers[t];return i?i.length:0},i.prototype.on=function(e,t){if("function"!=typeof t)return console.warn("Tried to register non-function",t,"as event handler for event:",e),this;this.emit("newListener",e,t);var i=this.eventHandlers,n=i[e];return void 0===n?(i[e]=[t],this):(n.push(t),this)},i.prototype.addListener=i.prototype.on,i.prototype.once=function(e,t){return t.once?t.once+=1:t.once=1,this.on(e,t)},i.prototype.setMaxListeners=function(){console.warn("Method setMaxListeners not supported, there is no limit to the number of listeners")},i.prototype.removeListener=function(e,t){var i=this.eventHandlers[e];if(void 0!==i){var n=i.indexOf(t);n!==-1&&(i.splice(n,1),this.emit("removeListener",e,t),0===i.length&&delete this.eventHandlers[e])}return this},i.prototype.removeAllListeners=function(e){return e?delete this.eventHandlers[e]:this.eventHandlers={},this},i.prototype.hasListeners=function(e){return void 0!==this.eventHandlers[e]},i.prototype.listeners=function(e){var t=this.eventHandlers[e];return void 0!==t?t.slice():[]};var n=Array.prototype.slice;i.prototype.emit=function(e){var t=this.eventHandlers[e];if(void 0===t)return!1;t=t.slice();for(var i=!1,o=n.call(arguments,1),s=0,a=t.length;s<a;s++){var r=t[s];void 0!==r&&(r.apply(this,o),i=!0,r.once&&(r.once>1?r.once--:delete r.once,this.removeListener(e,r)))}return i}},function(e,t,i){function n(e){v[e]||(v[e]=function(){v.emit(e,arguments)})}function o(){var e={};if(!window.gui.playerData)return e;var t=window.gui.playerData,i=t.identification||{},n=t.characterBaseInformations||{},o=t.position||{},s=window.gui.fightManager||{},a=window.appInfo&&window.appInfo.version,r=window.buildVersion;return e.groupFlags=h.getGroupFlags(),e.nickname=i.nickname,e.accountId=i.accountId,e.isGuiConnected=window.gui.isConnected,e.charaName=n.name,e.charaId=n.id,e.breed=n.breed,e.level=n.level,e.mapId=o.mapId,e.openWindows=m.getOpenWindows(),e.lastClosedWindow=m.getLastClosedWindow(),e.fightState=s.fightState,e.appVersion=a,e.buildVersion=r,e.appStart=w,e.lastDisconnect=M,e.lastCharaSelection=T,e.lastReceivedMessage=f.lastReceivedMessage,e}function s(){}function a(){}function r(e){var t=S[e];if(t)return t;var i=A[e];return i?(t=new i,S[e]=t,t):void y.error("Unknown writer type:",e)}function l(e){for(var t=Object.keys(_),i=0,o=t.length;i<o;i++){var s=t[i];n(s);for(var a in e){var l=e[a],c=r(a);c&&l.indexOf(s)!==-1&&c.addChannel(s)}}}function c(e){if(!u){u={};for(var t in e)if(e.hasOwnProperty(t)){if(E[t])continue;u[t]=e[t]}}}var u,d=i(209).EventEmitter,h=i(211),p=i(212),m=i(225),f=i(271),g=i(28),_={},v=new d,y=window.console,b=10,w=g.now(),M=-1,T=-1;y||(y={log:function(){},info:function(){},debug:function(){},warn:function(){},error:function(){}});var C={log:"verbose",debug:"debug",info:"info",warn:"warning",error:"error"},I={verbose:"color: #AAA",debug:"color: #0AA;",info:"color: #00A; font-weight: bold;",notice:"color: #0A0;",warning:"color: #F55;",error:"color: #A00;",critical:"color: #A00; font-weight: bold;",alert:"color: #A00; font-weight: bold; text-decoration: underline;",emergency:"background-color: #A00; font-weight: bold;"};Object.keys(C).forEach(function(e){"function"==typeof y[e]?y["_"+e]=y[e]:"object"==typeof y[e]&&(y["_"+e]=Function.prototype.bind.call(y[e],y))}),s.prototype.addChannel=function(e){var t,i=Array.prototype.slice,n="%c["+e+"]",o="background-color: transparent;",s=_[e]||0;I[e]&&(o=I[e]),s>_.warning&&(t=y._error),!t&&s>=_.warning&&(t=y._warn),!t&&y._info&&s>=_.info&&(t=y._info),!t&&y._debug&&s>=_.debug&&(t=y._debug),t||(t=y._log),v.on(e,function(e){var s=i.call(e),a=n;return y.group&&v.groups?(y.group(a,o),t.apply(y,s),void y.groupEnd()):("string"==typeof s[0]&&(a=a+" "+s.shift()),e=[a,o].concat(s),void t.apply(y,e))})},a.prototype.addChannel=function(e){var t=window.navigator||{},i=window.fetch||{},n=i.polyfill,s={userAgent:t.userAgent||"unknown",clientConfig:u,isFetchPolyfill:n};v.on(e,function(t){var i=p(t);i.data||(i.data={}),Array.isArray(i.data.error)&&i.data.error.length>b&&(i.data.error.length=b),s.characterInfo=o(),i.data.clientInfo=s;var n=window.Config&&window.Config.dataUrl||"",a={};a.Accept="application/json",a["Content-Type"]="application/json",window.fetch(n+"/logger",{method:"post",headers:a,body:JSON.stringify({channelName:e,message:i.message,data:i.data,report:i})})})};var A={console:s,server:a},S={},E={logging:!0,haapi:!0,adjust:!0,analytics:!0,serverLanguages:!0,failoverLanguage:!0,uiUrl:!0,disabledFeatures:!0,notification:!0,recaptcha:!0,dataUrl:!0,imgCrossOrigin:!0};v.setup=function(e){e=e||{};var t=e.logging||{};c(e),_=t.logLevels||{},v.groups=t.groups,l(t.config),t.disableOverride||(v.overrideConsole(),v.logUncaughtExceptions("error",!1)),window.gui.on("disconnect",function(){M=g.now()}),f.on("CharacterSelectedSuccessMessage",function(){T=g.now()})},v.overrideConsole=function(){Object.keys(C).forEach(function(e){var t=C[e];y[e]=function(){v.emit(t,arguments)}})},v.logUncaughtExceptions=function(e,t){var i=window.ErrorEvent;window.onerror&&v.debug("window.onerror was already assigned, overwriting."),window.onerror=function(n,o,s,a,r){if(i&&n instanceof i)v.emit(e,[n,r]);else if(i&&window.event instanceof i)v.emit(e,[window.event,r]);else{var l=[{message:n,url:o,lineno:s,colno:a}];r&&l.push(r),v.emit(e,l)}if(!t)return!0}},e.exports=v},function(e,t){var i,n={};t.setAccountInfo=function(e,t){n={};var o=t%10,s=!1;1===o&&(e+="1",s=!0);var a=e.indexOf("W")!==-1,r=e.indexOf("Q")!==-1;n.decoRecoResend=a||r||s,n.scrollerBoundToWrapper=a||r,n.singleTooltip=a||r,i=e},t.isFeatureOn=function(e){return void 0===i&&console.warn("isFeatureOn("+e+") called before we can tell"),!!n[e]},t.getGroupFlags=function(){return i}},function(e,t,i){function n(e,t){function i(h){if(void 0===h)return JSON.stringify("<undefined>");if(u&&h instanceof u)return JSON.stringify("[DOM Window]");if(c&&h instanceof c)return JSON.stringify("[DOM Element ("+s(h)+")]");if(l&&h instanceof l)return JSON.stringify("[DOM Node ("+h.nodeName+")]");if(r&&h instanceof r)return JSON.stringify("[RegExp ("+h.toString()+")]");if(h instanceof n){try{t.error=o.parse(h)}catch(p){"string"==typeof h.stack&&(t.error=h.stack.split("\n"))}return JSON.stringify(h.name+": "+h.message)}if(a&&h instanceof a)return t.filename=h.filename,t.lineno=e.lineno,t.colno=e.colno||e.column,h.error&&(t.error=i(h.error)),i(h.message);if(Array.isArray(h))return d.indexOf(h)!==-1?JSON.stringify("[Circular reference]"):(d.push(h),"["+h.map(i).join(",")+"]");if(h&&"object"==typeof h){if(d.indexOf(h)!==-1)return JSON.stringify("[Circular reference]");d.push(h);var m=Object.keys(h);return"{"+m.map(function(e){return JSON.stringify(e)+":"+i(h[e])}).join(",")+"}"}return JSON.stringify(h)}var n=window.Error,a=window.ErrorEvent,r=window.RegExp,l=window.Node,c=window.Element,u=window.Window,d=[];return i(e)}var o=i(213),s=i(215);e.exports=function(e){for(var t=e.length,i=new Array(t),o={},s=0;s<t;s++){var a=e[s];"string"==typeof a?i[s]=a:i[s]=n(e[s],o)}var r=i.join(" ");return 0===Object.keys(o).length&&(o=null),{message:r,data:o}}},function(e,t,i){
var n,o,s;!function(a,r){"use strict";o=[i(214)],n=r,s="function"==typeof n?n.apply(t,o):n,!(void 0!==s&&(e.exports=s))}(this,function(e){"use strict";var t=/(^|@)\S+\:\d+/,i=/^\s*at .*(\S+\:\d+|\(native\))/m,n=/^(eval@)?(\[native code\])?$/;return{parse:function(e){if("undefined"!=typeof e.stacktrace||"undefined"!=typeof e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(i))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(e.indexOf(":")===-1)return[e];var t=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,i=t.exec(e.replace(/[\(\)]/g,""));return[i[1],i[2]||void 0,i[3]||void 0]},parseV8OrIE:function(t){var n=t.stack.split("\n").filter(function(e){return!!e.match(i)},this);return n.map(function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var i=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),n=i.match(/ (\((.+):(\d+):(\d+)\)$)/);i=n?i.replace(n[0],""):i;var o=i.split(/\s+/).slice(1),s=this.extractLocation(n?n[1]:o.pop()),a=o.join(" ")||void 0,r=["eval","<anonymous>"].indexOf(s[0])>-1?void 0:s[0];return new e({functionName:a,fileName:r,lineNumber:s[1],columnNumber:s[2],source:t})},this)},parseFFOrSafari:function(t){var i=t.stack.split("\n").filter(function(e){return!e.match(n)},this);return i.map(function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),t.indexOf("@")===-1&&t.indexOf(":")===-1)return new e({functionName:t});var i=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=t.match(i),o=n&&n[1]?n[1]:void 0,s=this.extractLocation(t.replace(i,""));return new e({functionName:o,fileName:s[0],lineNumber:s[1],columnNumber:s[2],source:t})},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var i=/Line (\d+).*script (?:in )?(\S+)/i,n=t.message.split("\n"),o=[],s=2,a=n.length;s<a;s+=2){var r=i.exec(n[s]);r&&o.push(new e({fileName:r[2],lineNumber:r[1],source:n[s]}))}return o},parseOpera10:function(t){for(var i=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=t.stacktrace.split("\n"),o=[],s=0,a=n.length;s<a;s+=2){var r=i.exec(n[s]);r&&o.push(new e({functionName:r[3]||void 0,fileName:r[2],lineNumber:r[1],source:n[s]}))}return o},parseOpera11:function(i){var n=i.stack.split("\n").filter(function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this);return n.map(function(t){var i,n=t.split("@"),o=this.extractLocation(n.pop()),s=n.shift()||"",a=s.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;s.match(/\(([^\)]*)\)/)&&(i=s.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var r=void 0===i||"[arguments not available]"===i?void 0:i.split(",");return new e({functionName:a,args:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:t})},this)}}})},function(e,t,i){var n,o,s;!function(i,a){"use strict";o=[],n=a,s="function"==typeof n?n.apply(t,o):n,!(void 0!==s&&(e.exports=s))}(this,function(){"use strict";function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function i(e){return function(){return this[e]}}function n(e){if(e)for(var i=0;i<c.length;i++)void 0!==e[c[i]]&&this["set"+t(c[i])](e[c[i]])}var o=["isConstructor","isEval","isNative","isToplevel"],s=["columnNumber","lineNumber"],a=["fileName","functionName","source"],r=["args"],l=["evalOrigin"],c=o.concat(s,a,r,l);n.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof n)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new n(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",i=this.getColumnNumber()||"",n=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+i+")":"[eval]:"+t+":"+i:n?n+" ("+e+":"+t+":"+i+")":e+":"+t+":"+i}},n.fromString=function(e){var t=e.indexOf("("),i=e.lastIndexOf(")"),o=e.substring(0,t),s=e.substring(t+1,i).split(","),a=e.substring(i+1);if(0===a.indexOf("@"))var r=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(a,""),l=r[1],c=r[2],u=r[3];return new n({functionName:o,args:s||void 0,fileName:l,lineNumber:c||void 0,columnNumber:u||void 0})};for(var u=0;u<o.length;u++)n.prototype["get"+t(o[u])]=i(o[u]),n.prototype["set"+t(o[u])]=function(e){return function(t){this[e]=Boolean(t)}}(o[u]);for(var d=0;d<s.length;d++)n.prototype["get"+t(s[d])]=i(s[d]),n.prototype["set"+t(s[d])]=function(t){return function(i){if(!e(i))throw new TypeError(t+" must be a Number");this[t]=Number(i)}}(s[d]);for(var h=0;h<a.length;h++)n.prototype["get"+t(a[h])]=i(a[h]),n.prototype["set"+t(a[h])]=function(e){return function(t){this[e]=String(t)}}(a[h]);return n})},function(e,t,i){"use strict";function n(e,t,i){var n={Tag:m.getTag,NthChild:p.getNthChild,Attributes:function(e){return(0,h.getAttributes)(e,i)},Class:u.getClassSelectors,ID:c.getID};return t.reduce(function(t,i){return t[i]=n[i](e),t},{})}function o(e,t){var i=e.parentNode,n=i.querySelectorAll(t);return 1===n.length&&n[0]===e}function s(e,t){return t.find(o.bind(null,e))}function a(e,t,i){var n=(0,d.getCombinations)(t,3),o=s(e,n);return Boolean(o)?o:Boolean(i)&&(n=n.map(function(e){return i+e}),o=s(e,n),Boolean(o))?o:null}function r(e,t,i,s){var r=void 0,l=n(e,t,i);s&&s instanceof RegExp&&(l.ID=s.test(l.ID)?null:l.ID,l.Class=l.Class.filter(function(e){return!s.test(e)}));var c=!0,u=!1,d=void 0;try{for(var h,p=t[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var m=h.value,f=l.ID,g=l.Tag,_=l.Class,v=l.Attributes,y=l.NthChild;switch(m){case"ID":if(Boolean(f)&&o(e,f))return f;break;case"Tag":if(Boolean(g)&&o(e,g))return g;break;case"Class":if(Boolean(_)&&_.length&&(r=a(e,_,g)))return r;break;case"Attributes":if(Boolean(v)&&v.length&&(r=a(e,v,g)))return r;break;case"NthChild":if(Boolean(y))return y}}}catch(b){u=!0,d=b}finally{try{!c&&p["return"]&&p["return"]()}finally{if(u)throw d}}return"*"}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.selectorTypes,n=void 0===i?["ID","Class","Tag","NthChild"]:i,o=t.attributesToIgnore,s=void 0===o?["id","class","length"]:o,a=t.excludeRegex,l=void 0===a?null:a,c=[],u=(0,g.getParents)(e),d=!0,h=!1,p=void 0;try{for(var m,_=u[Symbol.iterator]();!(d=(m=_.next()).done);d=!0){var v=m.value,y=r(v,n,s,l);Boolean(y)&&c.push(y)}}catch(b){h=!0,p=b}finally{try{!d&&_["return"]&&_["return"]()}finally{if(h)throw p}}var w=[],M=!0,T=!1,C=void 0;try{for(var I,A=c[Symbol.iterator]();!(M=(I=A.next()).done);M=!0){var S=I.value;w.unshift(S);var E=w.join(" > ");if((0,f.isUnique)(e,E))return E}}catch(b){T=!0,C=b}finally{try{!M&&A["return"]&&A["return"]()}finally{if(T)throw C}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=l;var c=i(216),u=i(217),d=i(218),h=i(219),p=i(220),m=i(222),f=i(223),g=i(224)},function(e,t){"use strict";function i(e){var t=e.getAttribute("id");return null!==t&&""!==t?t.match(/^\d/)?'[id="'+t+'"]':"#"+t:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getID=i},function(e,t){"use strict";function i(e){if(!e.hasAttribute("class"))return[];try{var t=Array.prototype.slice.call(e.classList);return t.filter(function(e){return/^[a-z_-][a-z\d_-]*$/i.test(e)?e:null})}catch(i){var n=e.getAttribute("class");return n=n.trim().replace(/\s+/g," "),n.split(" ")}}function n(e){var t=i(e).filter(Boolean);return t.map(function(e){return"."+e})}Object.defineProperty(t,"__esModule",{value:!0}),t.getClasses=i,t.getClassSelectors=n},function(e,t){"use strict";function i(e,t,n,o,s,a,r){if(a===r)return void e.push(n.slice(0,a).join(""));for(var l=o;l<=s&&s-l+1>=r-a;++l)n[a]=t[l],i(e,t,n,l+1,s,a+1,r)}function n(e,t){for(var n=[],o=e.length,s=[],a=1;a<=t;++a)i(n,e,s,0,o-1,0,a);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.getCombinations=n},function(e,t){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["id","class","length"],n=e.attributes,o=[].concat(i(n));return o.reduce(function(e,i){return t.indexOf(i.nodeName)>-1||e.push("["+i.nodeName+'="'+i.value+'"]'),e},[])}Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributes=n},function(e,t,i){"use strict";function n(e){var t=0,i=void 0,n=void 0,s=e.parentNode;if(Boolean(s)){var a=s.childNodes,r=a.length;for(i=0;i<r;i++)if(n=a[i],(0,o.isElement)(n)&&(t++,n===e))return":nth-child("+t+")"}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.getNthChild=n;var o=i(221)},function(e,t){"use strict";function i(e){var t=void 0;return t="object"===("undefined"==typeof HTMLElement?"undefined":n(HTMLElement))?e instanceof HTMLElement:!!e&&"object"===("undefined"==typeof e?"undefined":n(e))&&1===e.nodeType&&"string"==typeof e.nodeName}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isElement=i},function(e,t){"use strict";function i(e){return e.tagName.toLowerCase().replace(/:/g,"\\:")}Object.defineProperty(t,"__esModule",{value:!0}),t.getTag=i},function(e,t){"use strict";function i(e,t){if(!Boolean(t))return!1;var i=e.ownerDocument.querySelectorAll(t);return 1===i.length&&i[0]===e}Object.defineProperty(t,"__esModule",{value:!0}),t.isUnique=i},function(e,t,i){"use strict";function n(e){for(var t=[],i=e;(0,o.isElement)(i);)t.push(i),i=i.parentNode;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getParents=n;var o=i(221)},function(e,t,i){function n(e,t){delete e.closingTweener,e.hide(),e.emit("closed",t),g.emit("closed",{id:e.id}),e.id.indexOf("#")!==-1&&(_[e.id].destroy(),delete _[e.id])}function o(e,t,i){i||(e.emit("opened",t),g.emit("opened",{id:e.id})),delete e.openingTweener}function s(e,t){var i=_[e];if(!i)return console.error("Invalid window: "+e);if(i.openState){i.openingTweener&&(i.openingTweener.cancel(),o(i,null,!0));var s=w.indexOf(e);w.splice(s,1),i===y&&(y=null),i.openState=!1,b=e,i.emit("close",t),g.emit("close",{id:e});var a=i.position;i.closingTweener=c.tween(i,{opacity:0,webkitTransform:"translate3d("+a.x+"px,"+a.y+"px,0) scale(0.8)"},{time:150,delay:0,easing:"ease-out"},function(){n(i,t)})}}function a(){if(v){for(var e=0,t=v.length;e<t;e+=1)s(v[e]);v=null,window.foreground.unlock("windowsManagerDialog")}}i(226);var r=i(183).dimensions,l=i(209).EventEmitter,c=i(227),u=i(228),d=i(232),h=i(29).getText,p=i(233),m=i(281),f=40,g=new l,_={},v=null,y=null,b=null,w=[];g.makeMovable=function(e,t){function i(){e.position.x=n,e.position.y=o,e.emit("positioned")}t=t||e.windowHeadWrapper,d(t);var n,o,s,a,l,c;t.on("slideStart",function(i,r){if(!e.openState)return t.cancelSlide();var u=e.rootElement.getBoundingClientRect(),d=r.left-u.left,h=r.top-u.top;l=u.width,c=r.height+h,s=i.x-r.left+d,a=i.y-r.top+h,n=e.position.x,o=e.position.y}),t.on("slideEnd",i),t.on("slideCancel",i),t.on("slide",function(t){n=t.x-s,o=t.y-a,n<0?n=0:n+l>r.windowFullScreenWidth&&(n=r.windowFullScreenWidth-l),o<0?o=0:o+c>r.windowFullScreenHeight&&(o=r.windowFullScreenHeight-c),e.setStyle("webkitTransform","translate3d("+n+"px, "+o+"px, 0)")})},g.initialize=function(e){e.on("disconnect",function(){v=null,b=null}),e.on("ExchangeLeaveMessage",a),e.on("LeaveDialogMessage",a)},g.addWindow=function(e,t,i){function n(){g.focusWindow(e)}i=i||{},_[e]=t,t.windowManager=g,t.id=e,i.group&&(t.group=i.group),t.hide(),t.openState=!1;var o=i.container||window.gui.windowsContainer;o.appendChild(t),t.allowDomEvents(),t.on("dom.touchstart",n),u(t.header),t.header.on("doubletap",function(){g.positionWindow(e)}),i.fixed||g.makeMovable(t)},g.open=function(e,t){if(t=t||{},"market"===e&&window.gui.playerData.isShopDisabled()&&!window.gui.tutorialManager.isShopTutorial())return void window.gui.openPopup({title:h("tablet.window.shop.title"),message:h("ui.popup.accessDenied.serviceUnavailable")});if("register"===e&&window.Config.disabledFeatures.guest)return window.gui.openPopup({title:h("ui.login.createAccount"),message:h("ui.popup.accessDenied.serviceUnavailable")}),console.error(new Error("windowsManager: register should not open"));var i=_[e];if(!i)return console.error("Invalid window: "+e);i.closingTweener&&(i.closingTweener.cancel(),n(i));var s=i.group;if(s)for(var a in _){var l=_[a];s===l.group&&l.openState&&e!==a&&this.close(a)}var u=i.positionInfo,d=i.position;if(u&&!d&&(i.position=d=m.buildWindowStyleFromInfo(u),i.setStyles({webkitTransform:"translate3d("+d.x+"px,"+d.y+"px,0) scale(0.8)",width:d.width+"px",height:d.height+"px",opacity:0})),u&&u.isModal||t.isModal){i.addClassNames("modal");var p=window.gui.windowsContainer.createChild("div",{className:"modalWindowOverlay"});i.once("close",function(){p.destroy()})}i.openState=!0,i.show(),this.emit("open",{id:e}),i.emit("open",t),g.focusWindow(e),d=i.position;var v=u&&u.isDefault;return v||i.initialPosition||(i.initialPosition={x:d.x,y:d.y,width:d.width,height:d.height}),d.x=Math.min(r.windowFullScreenWidth-d.width,Math.max(0,d.x)),d.y=Math.max(0,Math.min(r.windowFullScreenHeight-f,d.y)),i.openingTweener=c.tween(i,{opacity:1,webkitTransform:"translate3d("+d.x+"px,"+d.y+"px,0) scale(1)"},{time:150,delay:0,easing:"ease-out"},function(){o(i,t)}),window.gui.splashScreen.hide(),i},g.focusWindow=function(e){var t=_[e];if(t.openState&&y!==t){var i=w.indexOf(e);i!==-1&&w.splice(i,1),w.unshift(e),y=t,t.getParent().appendChild(t),t.emit("focus")}},g.positionWindow=function(e,t){var i,n=_[e];if(t)i=m.buildWindowStyleFromInfo(t);else if(n.initialPosition){var o=n.initialPosition;i={x:o.x,y:o.y,width:o.width,height:o.height}}else i=m.buildWindowStyleFromInfo(n.positionInfo);n.position=i,n.setStyles({width:i.width+"px",height:i.height+"px",webkitTransform:"translate3d("+i.x+"px,"+i.y+"px,0) scale(1)"}),t?n.emit("positioned"):n.emit("repositioned")},g.openDialog=function(e,t){if(!v){Array.isArray(e)||(e=[e]),v=e;for(var i=0,n=e.length;i<n;i+=1)g.open(e[i],t);window.foreground.lock("windowsManagerDialog")}},g.continueDialog=function(e,t){v=null,this.openDialog(e,t)},g.isDialogActive=function(){return!!v},g.getLastFocusedWindowId=function(){return w.length>0?w[0]:null},g.isModalWindow=function(e){var t=_[e];return t?t.hasClassName("modal"):null},g.close=function(e,t){var i=t&&t.keepDialog;return!i&&v&&v.indexOf(e)!==-1?(window.dofus.sendMessage("LeaveDialogRequestMessage",null),a()):void s(e,t)},g._forceClose=function(e){return v&&v.indexOf(e)!==-1?(window.gui.isConnected&&window.dofus.sendMessage("LeaveDialogRequestMessage",null),a()):void s(e)},g.closeAll=function(){for(var e in _)"popup"!==e&&_[e].openState&&this._forceClose(e)},g["switch"]=function(e,t){var i=_[e];i.openState?i===y?this.close(e):g.focusWindow(e):this.open(e,t)},g.getWindow=function(e){return _[e]},g.moveAndResizeWindow=function(e,t,i,n,o){var s=g.getWindow(e);if(s&&s.openState){var a=s.position.x,r=s.position.y,l=s.position.width,u=s.position.height;null!==t&&void 0!==t||(t=a),null!==i&&void 0!==i||(i=r),null!==n&&void 0!==n||(n=l),null!==o&&void 0!==o||(o=u);var d="translate3d("+t+"px, "+i+"px,0)";c.tween(s,{opacity:1,webkitTransform:d,width:n+"px",height:o+"px"},{time:150,delay:0,easing:"ease-out"},function(){g.positionWindow(e,{left:t,top:i,width:n,height:o})})}},g.arrangeOpeningWindow=function(e,t){var i=t.leftOf||t.rightOf,n=g.getWindow(e),o=g.getWindow(i);if(n&&o.openState){var s,a,l,c=n.position.width,u=o.position.width,d=o.position.x,h=d;t.leftOf?(s=d-c,s<0&&(s=0,h=Math.min(c,r.screenWidth-u))):t.rightOf&&(s=d+u,s+c>r.screenWidth&&(s=r.screenWidth-c,h=Math.max(0,s-u))),t.sameHeight&&(a=n.position.height,l=n.position.y),n.position.x=s,t.height&&(n.position.height=t.height),g.positionWindow(e,n.position),(h!==d||a)&&g.moveAndResizeWindow(i,h,l,null,a)}},g.arrangeOpeningWindowVertically=function(e,t){var i=t.below,n=g.getWindow(e),o=g.getWindow(i);if(n&&o.openState){var s;t.below&&(s=o.position.y+o.position.height,t.fullHeight&&(n.position.height=r.windowFullScreenHeight-s)),n.position.x=o.position.x,n.position.y=s,t.height&&(n.position.height=t.height),g.positionWindow(e,n.position)}},g.getOpenWindows=function(){var e=[];for(var t in _)"popup"!==t&&_[t].openState&&("function"==typeof _[t].getOpenedTabId?e.push(t+" > "+_[t].getOpenedTabId()):e.push(t));return e},g.getLastClosedWindow=function(){return b},g.createPanel=function(e,t,i){i=i||{};for(var n,o=1;n=e+"#"+o,_[n];o++);var s;return t instanceof p?s=t:(s=new p({className:e,title:i.title,positionInfo:{left:i.left||"c",top:i.top||"c",width:i.width||250,height:i.height||200},isModal:i.isModal,noCloseButton:i.noCloseButton}),s.windowBody.appendChild(t)),g.addWindow(n,s),g.open(n,i),s},g.getPanel=function(e,t){return _[e+"#"+t]},e.exports=g},function(e,t){},function(e,t){function i(e){return!!e._tween&&(e._tween.cancel(),e.emit("tweenCancelled"),!0)}t.tween=function(e,t,n,o){function s(){window.clearTimeout(p),u.removeEventListener("webkitTransitionEnd",m),p=null,u.style.webkitTransition=d,e._tween=null}function a(){f||g||(f=g=!0,s(),o=null)}i(e),n=n||{};var r=n.time||500,l=n.delay||0,c=n.easing||"ease-in-out",u=e.rootElement;if(!u)return void console.error(new Error("The dom is gone"));var d=u.style.webkitTransition,h="all "+r+"ms "+c;l&&(h+=" "+l+"ms");var p,m,f=!1,g=!1;return m=function(t){g||(g=!0,t&&t.stopPropagation(),s(),o&&(o.call(e,t),o=null))},window.setTimeout(function(){if(!f){u.style.webkitTransition=h;for(var e in t)u.style[e]=t[e];u.addEventListener("webkitTransitionEnd",m),p=window.setTimeout(m,l+r)}},0),e._tween={cancel:a},e._tween},t.cancelTween=i},function(e,t,i){function n(){this.setEnable(!0)}function o(){this.setEnable(!1)}function s(){this.isEnable()&&(this.emit("tapstart"),this.emit("tapend"),this.emit("tap"))}function a(e,t){function i(){var t=m.indexOf(e);return t!==-1&&(m.splice(t,1),window.clearTimeout(v),clearInterval(w),l.removeListener("dom.touchmove",f),l.removeListener("dom.touchend",_),!0)}function a(t){i()&&e.emit("tapend",t)}function d(t){w=setInterval(function(){e.emit("tap")},t)}function f(e){var t=c(e);(t.x<b.left||t.x>b.left+b.width||t.y<b.top||t.y>b.top+b.height)&&a(t)}function g(t){w=null,y=c(t),!C||y.touchCount>1||(m.push(e),b=e.rootElement.getBoundingClientRect(),e.emit("tapstart",y,b),window.clearTimeout(v),v=window.setTimeout(function(){I?d(I):e.emit("longtap",y)&&r()},h),l.on("dom.touchmove",f),l.on("dom.touchend",_),u.recordActivity())}function _(t){if(i()){var n=c(t);if(e.emit("tapend",n),!w){var o=Date.now();!I&&T&&M>=o-T?e.emit("doubletap",n):e.emit("tap",n)&&r(),T=o}}}if(!e._tapBehavior){t=t||{},e._tapBehavior=!0,e.allowDomEvents();var v,y,b,w,M=t.doubletapTimeout||p,T=0,C=!0,I=t.repeatDelay;e.enable=n,e.disable=o,e.tap=s,e.cancelTap=a,e.on("dom.touchstart",g),e.setEnable=function(t){"boolean"!=typeof t&&console.error(new Error("tapBehavior: setEnable has been called with an undefined param")),C=t,e.emit("enable",t)},e.isEnable=function(){return C}}}function r(){for(var e=m.length-1;e>=0;e--)m[e].cancelTap()}var l,c=i(229).getPosition,u=i(230),d=i(231),h=400,p=200,m=[];e.exports=a,a.initialize=function(e){l=e,d.on("handleTaken",r)}},function(e,t){var i=!1;"ontouchstart"in window&&(i=!0);var n,o={x:0,y:0};n=i?function(e){var t=e.touches||[],i=t.length;if(0===i)return{x:o.x,y:o.y,touches:[],touchCount:0};for(var n=[],s=0;s<i;s+=1)n.push({x:t[s].clientX,y:t[s].clientY});return o.x=t[0].clientX,o.y=t[0].clientY,{x:o.x,y:o.y,touches:n,touchCount:i}}:function(e){return o.x=e.clientX,o.y=e.clientY,{x:o.x,y:o.y,touchCount:"mouseup"===e.type?0:1,touches:[{x:o.x,y:o.y}]}},e.exports={canTouch:i,getPosition:n,position:o,events:{start:i?"touchstart":"mousedown",move:i?"touchmove":"mousemove",end:i?"touchend":"mouseup"}}},function(e,t,i){function n(){o.call(this),this.isListening=!1,this.isConnected=!1,this.pingInterval=null,this.activityInterval=null,this.isInactive=!1,this.hasSeenActivity=!1,this.lastActivityTime=null}var o=i(194).EventEmitter,s=i(29).getText,a=i(191).inherits,r=6e5,l=3e5,c=6e5,u=12e4,d=1e3;a(n,o),e.exports=new n,n.prototype.initialize=function(e){var t=this,i=window.dofus.connectionManager;i.on("ServersListMessage",function(){t._start()}),e.on("connected",function(){t.isConnected=!0}),e.on("disconnect",function(){t.isConnected=!1,t._stop()}),e.on("appGoBackground",function(){t._stop()}),e.on("connectedAfterAppLeaveBackground",function(){t.isListening||t._start()})},n.prototype._start=function(){this.isListening||(this.isListening=!0,this.activityInterval=window.setInterval(function(e){e._checkActivity()},u,this),this.pingInterval=window.setInterval(function(e){e._pingServer()},r,this),this.isInactive=!1,this.hasSeenActivity=!1,this.lastActivityTime=Date.now())},n.prototype._stop=function(){this.isListening&&(this.isListening=!1,window.clearInterval(this.activityInterval),window.clearInterval(this.pingInterval))},n.prototype.recordActivity=function(){this.hasSeenActivity=!0,this.lastActivityTime=Date.now(),this.isInactive&&this.isListening&&this._leaveInactiveMode()},n.prototype.isActiveSince=function(e){return this.lastActivityTime>=e},n.prototype._checkActivity=function(){var e=Date.now()-this.lastActivityTime+d;e<l||(this.isInactive?e>=c&&!window.gui.playerData.isModeratorOrMore()&&window.dofus.disconnect("INACTIVITY"):this._enterInactiveMode())},n.prototype._pingServer=function(){this.hasSeenActivity&&(this.hasSeenActivity=!1,window.dofus.sendMessage("BasicPingMessage",{quiet:!0}))},n.prototype._enterInactiveMode=function(){this.isInactive=!0,this.isConnected&&this.emit("inactive",!0),window.gui.openSimplePopup(s("ui.common.inactivityWarning"),s("ui.popup.warning"))},n.prototype._leaveInactiveMode=function(){this.isInactive=!1,this.isConnected?this.emit("inactive",!1):this._pingServer()}},function(e,t,i){var n,o,s,a,r=i(211),l=i(229),c=l.events,u=l.getPosition,d=i(209).EventEmitter,h=e.exports=new d;document.body.addEventListener(c.start,function(){o||(o=!0,n=null,a=null)},!0),document.body.addEventListener(c.start,function(){n&&h.emit("handleTaken",n)},!1),document.body.addEventListener(c.end,function(e){0===u(e).touchCount&&(n=null,a=null,o=!1)}),h.isHandleFree=function(){return null===n},h.hasHandle=function(e){return n===e},h.requestInteractionHandle=function(e,t){return n?(n!==t&&console.info(e,"interaction REFUSED: owned by",s),n===t):a&&e!==a&&r.isFeatureOn("scrollerBoundToWrapper")?void console.info(e,"interaction REFUSED: priorityBehavior is",a):(s=e,n=t,h.emit("handleTaken",n),!0)},h.abortInteraction=function(){n=null,a=null},h.setPriorityBehavior=function(e){a=e}},function(e,t,i){function n(e,t){function i(e){y="vertical"===e?"y":"x"}function n(e){N=a(e),N.x-=T.left,N.y-=T.top}function d(t){if(x=Date.now(),I=N.x,A=N.y,n(t),M){if(1!==N.touchCount)return;return E=S,S=N.x-I,e.emit("slide",N),e.slideOut=N.x<0||N.x>T.width||N.y<0||N.y>T.height,void(e.slideOut?C||(C=!0,e.emit("slideOut",N)):(e.emit("slideIn",N),C=!1))}var i=N.x-b.x,s=N.y-b.y,a=Math.sqrt(i*i+s*s);if(!(a<c)){if(Math.abs(s)>Math.abs(i)){if(y&&"y"!==y||!r.requestInteractionHandle("SLIDE",e))return void e.cancelSlide();M=!0}else{if(y&&"x"!==y||!r.requestInteractionHandle("SLIDE",e))return void e.cancelSlide();M=!0}e.isSliding=!0,e.emit("slideStart",N,T),S=E=0,o.isIOS&&(O=l.setInterval(g,100))}}function h(e){n(e),N.touchCount>0||(M&&p(),v())}function p(){e.isSliding=!1;var t,i=N.x,n=N.y;if(y){var o="x"===y?i:n,s="x"===y?I:A;t=f(o-b[y],o-s)}else t=f(i-b.x,i-I)&&"x"||f(n-b.y,n-A)&&"y";e.emit("slideEnd",t,i-b.x,n-b.y)}function m(){e.isSliding=!1,M&&e.emit("slideCancel"),v(),r.abortInteraction()}function f(e,t){var i=Math.abs(e)>D&&t/e>=0;return i}function g(){if(x!==R)return void(R=x);var e=N.x+T.left;if(!(e<s.screenWidth-u))return e+2*E>=s.screenWidth?(p(),v(),void r.abortInteraction()):Date.now()-x>5e3?m():void 0}function _(){window.gui.wBody.on("dom.touchmove",d),window.gui.wBody.on("dom.touchend",h),window.gui.wBody.on("dom.touchcancel",m)}function v(){window.gui.wBody.removeListener("dom.touchmove",d),window.gui.wBody.removeListener("dom.touchend",h),window.gui.wBody.removeListener("dom.touchcancel",m),l.clearInterval(O),w=M=!1}if(!e._slideBehavior){e._slideBehavior=!0,e.allowDomEvents();var y,b,w,M,T,C,I,A,S,E,x,L=!1,N={},O=null,D=u/2;t&&i(t),e.setSlideDirection=i,e.setSwipeMinimum=function(e){D=e},e.isSliding=!1,e.slideOut=!1,e.lockSlide=function(e){L=e},e.cancelSlide=m;var R=0;e.on("dom.touchstart",function(t){w||L||(T=e.rootElement.getBoundingClientRect(),n(t),I=N.x,A=N.y,e.slideOut=!1,w=!0,b={x:N.x,y:N.y},_())})}}var o=i(185),s=i(183).dimensions,a=i(229).getPosition,r=i(231),l=i(203),c=5,u=50;e.exports=n},function(e,t,i){function n(e){e=e||{},u.call(this,"div",{className:"window",hidden:!0}),this.addClassNames(e.className),this.exchangeType=-1,this.positionInfo=e.positionInfo,this.freeContentDelay=e.freeContentDelay,this.freeContentTimeout=null;var t=this;this.position=null,this.windowManager=null,this.openState=!1,this.isReadyForUserInteraction=!1,this.windowBorder=this.createChild("div",{className:"windowBorder"}),this.windowContent=this.createChild("div",{className:"windowContent"}),this.header=this.windowHeadWrapper=this.windowContent.createChild("div",{className:"windowHeadWrapper"}),e.noTitle||(this.windowTitle=this.windowHeadWrapper.createChild("div",{className:"windowTitle"}),this.windowTitle.setText(e.title||"")),e.plusButton&&(this.plusButton=this.windowHeadWrapper.appendChild(new d({className:"plusButton",scaleOnPress:!0})),this.plusButton.myWindow=this),e.minusButton&&(this.minusButton=this.windowHeadWrapper.appendChild(new d({className:"minusButton",scaleOnPress:!0})),this.minusButton.myWindow=this),e.noCloseButton||(this.closeButton=this.windowHeadWrapper.appendChild(new h({scaleOnPress:!0})),this.closeButton.myWindow=this,e.customClose||this.closeButton.on("tap",o)),this.openingSound=e.openingSound,this.closingSound=e.closingSound,this.windowBodyWrapper=this.windowContent.createChild("div",{className:"windowBodyWrapper"}),this.windowBody=this.windowBodyWrapper.createChild("div",{className:"windowBody"}),this.on("open",s),this.on("opened",a),this.on("close",r),this.on("resize",function(){t.position.width=t.windowWidth||0,t.position.height=t.windowHeight||0})}function o(){if(this.myWindow.exchangeType!==f.TAXCOLLECTOR)return void this.myWindow.windowManager.close(this.myWindow.id);var e=this;window.gui.openConfirmPopup({title:m("ui.popup.warning"),message:m("tablet.popup.taxCollectorExchangeLeaveConfirm"),cb:function(t){t&&e.myWindow.windowManager.close(e.myWindow.id)}})}function s(){window.clearTimeout(this.freeContentTimeout),this.openingSound&&p(this.openingSound||"WINDOW_OPEN"),this.isReadyForUserInteraction=!0,this._initWindowKPI()}function a(){this.isReadyForUserInteraction&&this.emit("contentReady")}function r(){if(this._sendWindowKPI(),"number"==typeof this.freeContentDelay||"function"==typeof this.freeContent){if("function"!=typeof this.freeContent)return console.error("missing freeContent method for",this.id);this.freeContentTimeout=window.setTimeout(this.freeContent.bind(this),this.freeContentDelay||0)}this.closingSound&&p(this.closingSound||"WINDOW_CLOSE")}function l(e,t,i,n){g.log("HUD.Display_Menu",{interface_id:e,time_spent_on_action:t,relative_soft_currency_gained:i,relative_hard_currency_gained:n})}i(234);var c=i(191).inherits,u=i(235),d=i(246),h=i(279),p=i(258).playUiSound,m=i(29).getText,f=i(280),g=i(7),_=i(28);c(n,u),e.exports=n,n.prototype.startWaitingForContent=function(){this.isReadyForUserInteraction=!1},n.prototype.finishedWaitingForContent=function(){this.isReadyForUserInteraction=!0,this.emit("contentReady")},n.prototype.setTitle=function(e){this.windowTitle.setText(e)},n.prototype.localizeEvent=function(e){var t=this;return function(){t.openState&&e.apply(this,arguments)}},n.prototype.close=function(e){this.windowManager.close(this.id,e)},n.prototype.prepareKPI=function(e,t,i,n){var o=~~((_.now()-t)/1e3),s=window.gui.playerData,a=s.inventory.kamas-i,r=s.inventory.goultines-n;l(e,o,a,r)},n.prototype._initWindowKPI=function(){if(!this.tabs){var e=window.gui.playerData;this._openedTimestamp=_.now(),this._scBalanceWhenOpen=e.inventory.kamas,this._hcBalanceWhenOpen=e.inventory.goultines}},n.prototype._sendWindowKPI=function(){this.prepareKPI(this.id,this._openedTimestamp,this._scBalanceWhenOpen,this._hcBalanceWhenOpen),this._resetWindowKPI()},n.prototype._resetWindowKPI=function(e){return e?void(this._openedTimestampTabs[e]=this._scBalanceWhenOpenTabs[e]=this._hcBalanceWhenOpenTabs[e]=0):this._openedTimestamp=this._scBalanceWhenOpen=this._hcBalanceWhenOpen=0}},function(e,t){},function(e,t,i){function n(e){return u.apply([],e).filter(Boolean)}function o(e,t){var i,n=document.createElement(e);if(t&&t.attr)for(i in t.attr)n.setAttribute(i,t.attr[i]);return n}function s(e,t){r.call(this),this._elementIsVisible=!0,this._currentTextContent=null,this.rootElement=null,this._text=null,this._name=null,this._childrenList=[],this._childrenMap={},this._contentType=c.EMPTY,this._parent=null,e&&this._assign(e,t)}var a=i(191).inherits,r=i(236).EventEmitter,l=i(237);i(238);var c={EMPTY:null,WUI:"wui",TEXT:"text",HTML:"html"},u=Array.prototype.concat;a(s,r),e.exports=s,s.prototype._assign=function(e,t){if(this.rootElement)throw new Error("WuiDom has already an element assigned");if("string"==typeof e)this.rootElement=o(e,t),t&&t.hasOwnProperty("text")&&this.setText(t.text);else{if(!(e instanceof window.Element))throw new Error("WuiDom.assign requires the given argument to be a DOM Element or tagName.");this.rootElement=e}t=t||{},t.hidden&&this.hide(),"name"in t&&(this._name=String(t.name)),"className"in t&&this.addClassNames(t.className),"style"in t&&this.setStyles(t.style||{})},s.prototype.assign=function(e,t){this._assign(e,t)},s.prototype.getWuiName=function(){return this._name},s.prototype.removeChild=function(e){var t=e instanceof s;if(!t&&(e=this._childrenMap[e],!e))throw new Error("WuiDom: Given name is not a current child");var i=this._childrenList.indexOf(e);if(i===-1)throw new Error("WuiDom: Not a current child");return this.rootElement.removeChild(e.rootElement),this._childrenList.splice(i,1),this._childrenMap.hasOwnProperty(e._name)&&delete this._childrenMap[e._name],e._parent=null,e},s.prototype._unsetParent=function(){this._parent&&this._parent.removeChild(this)},s.prototype._setParent=function(e){if(e!==this._parent){if(this._name){if(e._childrenMap[this._name])throw new Error("WuiDom: Parent already has a child with this name");e._childrenMap[this._name]=this}this._parent=e}},s.prototype.getParent=function(){return this._parent},s.prototype.appendChild=function(e){if(this._contentType&&this._contentType!==c.WUI&&this._clearLinearContent(),this===e._parent){var t=this._childrenList.indexOf(e);t!==-1&&this._childrenList.splice(t,1)}else e._unsetParent(),e._setParent(this);return this._childrenList.push(e),this.rootElement.appendChild(e.rootElement),e.rebindTouchListeners(),this._contentType=c.WUI,e},s.prototype.createChild=function(e,t){return this.appendChild(new s(e,t))},s.prototype.appendTo=function(e){e.appendChild(this)},s.prototype.insertChildBefore=function(e,t){this._contentType&&this._contentType!==c.WUI&&this._clearLinearContent();var i;if(this===e._parent){var n=this._childrenList.indexOf(e);n!==-1&&this._childrenList.splice(n,1)}else e._unsetParent();if(t){if(i=this._childrenList.indexOf(t),i===-1)throw new Error("WuiDom: Wanted sibling is not a child")}else i=this._childrenList.length;return e._setParent(this),this.rootElement.insertBefore(e.rootElement,t&&t.rootElement),
e.rebindTouchListeners(),this._childrenList.splice(i,0,e),this._contentType=c.WUI,e},s.prototype.insertBefore=function(e){if(!e._parent)throw new Error("WuiDom: sibling has no parent");return e._parent.insertChildBefore(this,e),e},s.prototype.insertAsFirstChild=function(e){var t=this._childrenList[0];return t?this.insertChildBefore(e,t):this.appendChild(e)},s.prototype.getChildren=function(){return this._childrenList.concat()},s.prototype.getChildCount=function(){return this._childrenList.length},s.prototype.getChild=function(e){return this._childrenMap[e]},s.prototype._clearLinearContent=function(){this._text=null,this._currentTextContent=null,this.rootElement.innerHTML=""},s.prototype.setHtml=function(e){this._contentType===c.WUI&&this._destroyChildren(),this._contentType===c.TEXT&&this._clearLinearContent(),this.rootElement.innerHTML=e,this._contentType=c.HTML},s.prototype.setText=function(e){this._contentType===c.WUI&&this._destroyChildren(),this._contentType===c.HTML&&this._clearLinearContent(),null!==e&&void 0!==e&&(e=e.valueOf(),this._text||(this._text=document.createTextNode(""),this.rootElement.appendChild(this._text)),e!==this._currentTextContent&&(this._currentTextContent=e,this._text.nodeValue=e),this._contentType=c.TEXT)},s.prototype.getText=function(){return this._currentTextContent},s.prototype.setStyle=function(e,t){this.rootElement.style[e]=t},s.prototype.setStyles=function(e){var t=this.rootElement.style;for(var i in e)t[i]=e[i]},s.prototype.unsetStyle=function(e){this.rootElement.style[e]=""},s.prototype.getStyle=function(e){return this.rootElement.style[e]},s.prototype.getComputedStyle=function(e){var t=window.getComputedStyle(this.rootElement);return t?t.getPropertyValue(e):null},s.prototype.getComputedStyles=function(){var e=window.getComputedStyle(this.rootElement);if(!e)return{};for(var t={},i=0,n=arguments.length;i<n;i+=1){var o=arguments[i];t[o]=e.getPropertyValue(o)}return t},s.prototype.getClassNames=function(){return n(this.rootElement.classList)},s.prototype.hasClassName=function(e){return this.rootElement.classList.contains(e)},s.prototype.setClassNames=function(){this.rootElement.className="";var e=this.rootElement.classList;e.add.apply(e,n(arguments))},s.prototype.addClassNames=function(){var e=this.rootElement.classList;e.add.apply(e,n(arguments))},s.prototype.replaceClassNames=function(e,t){var i=this.rootElement.classList;i.remove.apply(i,n(e)),i.add.apply(i,n(t))},s.prototype.delClassNames=function(){var e=this.rootElement.classList;e.remove.apply(e,n(arguments))},s.prototype.toggleClassNames=function(e,t){for(var i=0;i<e.length;i+=1)this.toggleClassName(e[i],t)},s.prototype.toggleClassName=function(e,t){return t===!0||t===!1?this.rootElement.classList.toggle(e,t):this.rootElement.classList.toggle(e)},s.prototype._removeDom=function(){var e=this.rootElement;e&&(e.remove(),this.rootElement=null)},s.prototype._destroyChildren=function(){var e=this._childrenList.concat();this._childrenList=[],this._childrenMap={};for(var t=0,i=e.length;t<i;t+=1){var n=e[t];n.emit("destroy"),n._parent=null,n._destroyChildren(),n._removeDom(),n.removeAllListeners()}},s.prototype.clearContent=function(){switch(this._contentType){case c.HTML:case c.TEXT:this._clearLinearContent();break;case c.WUI:this._destroyChildren()}this._contentType=c.EMPTY,this.emit("cleared")},s.prototype.destroy=function(){this.emit("destroy"),this._unsetParent(),this._destroyChildren(),this._removeDom(),this.removeAllListeners()},s.prototype.showMethod=function(){this.rootElement.style.display=""},s.prototype.hideMethod=function(){this.rootElement.style.display="none"},s.prototype.show=function(){this._elementIsVisible||(this._elementIsVisible=!0,this.showMethod(),this.emit("show"))},s.prototype.hide=function(){this._elementIsVisible&&(this._elementIsVisible=!1,this.hideMethod(),this.emit("hide"))},s.prototype.toggleDisplay=function(e){return void 0===e&&(e=!this._elementIsVisible),e?this.show():this.hide(),!!e},s.prototype.isVisible=function(e){return!!this._elementIsVisible&&(!e||!this._parent||this._parent.isVisible(!0))},s.prototype.rebindTouchListeners=function(){if(this.domListeners){var e=this.rootElement;for(var t in this.domListeners)if(t.match(/^touch/)){var i=this.domListeners[t];for(var n in i){var o=i[n];e.removeEventListener(n,o),e.addEventListener(n,o)}}}},s.prototype.bindToTome=function(e,t){function i(e){t(this.valueOf(),e)}var n=this;t||(t=function(e){n.setText(e)}),e.on("readable",i),t(e.valueOf()),this.on("destroy",function(){e.removeListener("readable",i)})},s.prototype.allowDomEvents=function(){this.domListeners||(this.domListeners={},this.on("newListener",l["new"]),this.on("removeListener",l.remove),this.on("destroy",l.destroy))}},function(e,t){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,i,o,r,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(i=this._events[e],a(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(s(i))for(r=Array.prototype.slice.call(arguments,1),c=i.slice(),o=c.length,l=0;l<o;l++)c[l].apply(this,r);return!0},i.prototype.addListener=function(e,t){var o;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error(new Error("(node) warning: possible EventEmitter memory leak detected. "+o+" listeners added for event type '"+e+"' on a "+this.constructor.name)),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function i(){this.removeListener(e,i),o||(o=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var o=!1;return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var i,o,a,r;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],a=i.length,o=-1,i===t||n(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(i)){for(r=a;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){o=r;break}if(o<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],n(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){function i(){s=Date.now()}function n(){s=0}function o(){return 0!==s&&Date.now()-s<a}var s=0,a=500,r="dom";t["new"]=function(e){var t=this,a=e.split(".");if(a[0]===r){var l=a[1];if(l&&!this.domListeners[l])switch(l){case"touchstart":var c=function(e){o()||1!==e.which||t.emit("dom.touchstart",e)},u=function(e){i(),t.emit("dom.touchstart",e)};this.domListeners.touchstart={mousedown:c,touchstart:u},this.rootElement.addEventListener("mousedown",c),this.rootElement.addEventListener("touchstart",u);break;case"touchmove":var d=function(e){s||1!==e.which||t.emit("dom.touchmove",e)},h=function(e){t.emit("dom.touchmove",e)};this.domListeners.touchmove={mousemove:d,touchmove:h},this.rootElement.addEventListener("mousemove",d),this.rootElement.addEventListener("touchmove",h);break;case"touchend":var p=function(e){return o()||1!==e.which?void n():void t.emit("dom.touchend",e)},m=function(e){i(),t.emit("dom.touchend",e),e.preventDefault()};this.domListeners.touchend={mouseup:p,touchend:m},this.rootElement.addEventListener("mouseup",p),this.rootElement.addEventListener("touchend",m);break;default:var f=function(i){t.emit(e,i)};this.domListeners[l]=f,this.rootElement.addEventListener(l,f)}}},t.remove=function(e){if(0===this.listeners(e).length){var t=e.split(".");if(t[0]===r){var i=t[1],n=this.domListeners[i];if(n){if(null!==n&&"object"==typeof n){for(var o in n){var s=n[o];this.rootElement.removeEventListener(o,s)}return void delete this.domListeners[i]}this.rootElement.removeEventListener(i,n),delete this.domListeners[i]}}}},t.destroy=function(){for(var e in this.domListeners){var t=this.domListeners[e];if(null===t||"object"!=typeof t)this.rootElement.removeEventListener(e,t);else for(var i in t){var n=t[i];this.rootElement.removeEventListener(i,n)}}this.domListeners={}}},function(e,t,i){i(239),i(240),i(241),i(242),i(243),i(244)},function(e,t){"HTMLDocument"in window||(window.HTMLDocument=window.Document)},function(e,t){!function(){"use strict";function e(e,t){if("string"!=typeof e)throw new TypeError('Failed to construct "CustomEvent": An event name must be provided.');var i=document.createEvent("CustomEvent"),n={bubbles:!1,cancelable:!1,detail:null};return t=t||n,i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}var t="CustomEvent"in window&&("function"==typeof window.CustomEvent||window.CustomEvent.toString().indexOf("CustomEventConstructor")>-1);t||(window.CustomEvent=e)}()},function(e,t){!function(){"use strict";var e=Element.prototype,t=e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,i="matches"in e&&t.call(document.createElement("a"),"a");i||(e.matches=function(e){var i=Array.prototype.indexOf,n=this.parentNode;return n||(n=document.createDocumentFragment(),n.appendChild(this)),t?t.call(this,e):i.call(n.querySelectorAll(e),this)>-1})}()},function(e,t){!function(){"use strict";var e=Element.prototype;"closest"in e||(e.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null})}()},function(e,t){!function(){"use strict";function e(e){return"string"==typeof e?document.createTextNode(e):e}function t(t){var i,n,o;if(t&&(o=t.length),!o)throw new Error("No node was specified (DOM Exception 8)");if(1===o)return e(t[0]);for(i=document.createDocumentFragment(),n=0;n<o;n++)i.appendChild(e(t[n]));return i}var i=Element.prototype,n=i.after&&i.append&&i.before&&i.prepend&&i.remove&&i.replace;n||(i.prepend=function(){this.insertBefore(t(arguments),this.firstChild)},i.append=function(){this.appendChild(t(arguments))},i.before=function(){var e=this.parentNode;e&&e.insertBefore(t(arguments),this)},i.after=function(){var e=this.parentNode;e&&e.insertBefore(t(arguments),this.nextSibling)},i.replace=function(){var e=this.parentNode;e&&e.replaceChild(t(arguments),this)},i.remove=function(){var e=this.parentNode;e&&e.removeChild(this)})}()},function(e,t,i){!function(){"use strict";var e,t=document.createElement("x"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=function(e){return"classList"in e&&(!e.classList.toggle("a",!1)&&!e.classList.contains("a"))};if(o(n)||(e=i(245),Object.defineProperty(Element.prototype,"classList",{get:function(){function t(){}return t.prototype=new e(this,"class"),new t}})),!o(t)){e=i(245);var s=DOMTokenList.prototype,a=function(e){return function(){var t,i=arguments.length;for(t=0;t<i;t++)e.call(this,arguments[t])}};s.add=a(s.add),s.remove=a(s.remove),s.toggle=function(t,i){return 1 in arguments&&this.contains(t)===i?i:e.prototype.toggle.call(this,t,i)}}}()},function(e,t){"use strict";function i(e,t){this._getString=function(){return e.getAttribute(t)||""},this._setString=function(i){e.setAttribute(t,i)},n(this,o(this))}function n(e,t){for(var i=t.length,n=0;n<i;n++)e[n]=t[n];delete e[i]}function o(e){var t=e._getString();return t&&""!==t?t.split(/\s+/):[]}function s(e){if(""===e||void 0===e)throw new Error("An invalid or illegal string was specified (DOM Exception 12)");if(/\s+/.test(e))throw new Error("InvalidCharacterError: String contains an invalid character (DOM Exception 5)")}i.prototype={add:function(e){for(var t,i=0,a=arguments.length,r=o(this),l=!1;i<a;i++)t=arguments[i],s(t),r.indexOf(t)<0&&(r.push(t),l=!0);l&&(this._setString(r.join(" ").trim()),n(this,r))},contains:function(e){return s(e),o(this).indexOf(e)>-1},item:function(e){return o(this)[e]||null},get length(){return o(this).length},remove:function(e){for(var t,i,a=0,r=arguments.length,l=o(this),c=!1;a<r;a++)for(i=arguments[a],s(i);(t=l.indexOf(i))>-1;)l.splice(t,1),c=!0;c&&(this._setString(l.join(" ").trim()),n(this,l))},toggle:function(e,t){var i=this.contains(e),n=i?t!==!0&&"remove":t!==!1&&"add";return n&&this[n](e),"boolean"==typeof t?t:!i},toString:function(){return this._getString()}},e.exports=i},function(e,t,i){function n(e,t){e=e||{},r.call(this,"div",e),this.addClassNames("Button"),l(this,{repeatDelay:e.repeatDelay,doubletapTimeout:1});var i=e.addIcon;if(i){if("string"==typeof i&&u.indexOf(i)<0)return console.error("Invalid addIcon option:",i);var n=new r("div",{className:"btnIcon"});"before"===i&&this.appendChild(n),e.text&&this.createChild("div",{className:"btnText",text:e.text}),"after"!==i&&i!==!0||this.appendChild(n)}(e.scaleOnPress||void 0===e.scaleOnPress)&&this.addClassNames("scaleOnPress"),e.tooltip&&s(this,e.tooltip),"function"==typeof t&&this.on("tap",t),this.on("tap",function(){c(e.sound||"GEN_BUTTON")}),this.on("tapstart",function(){this.addClassNames("pressed")}),this.on("tapend",function(){this.delClassNames("pressed")}),this.on("enable",function(e){this.toggleClassName("disabled",!e)}),e.disable&&this.disable()}function o(e,t,i){t=t||{},t.text=e,n.call(this,t,i),this.addClassNames("button")}i(247);var s=i(248).addTooltip,a=i(191).inherits,r=i(235),l=i(228),c=i(258).playUiSound,u=["before","after"];a(n,r),e.exports=n,a(o,n),n.DofusButton=o},function(e,t){},function(e,t,i){function n(e){e=e||{};var t={className:["TooltipBox",e.className],hidden:!0};e.name&&(t.name=e.name),g.call(this,"div",t),this.content=this.createChild("div",{className:"content"}),this.openState=!1,this.setStyle("opacity",0),e.content&&this._setContent(e.content)}function o(){this.delClassNames("transition")}function s(){this.delClassNames("transition"),this.hide()}function a(){u&&(u.emit("tooltipOut"),u=null),clearTimeout(h),h=null,c._closeTooltip(!1)}function r(){u&&(u.emit("tooltipOut"),u=null),clearTimeout(h),h=setTimeout(a,500)}function l(e){return Math.max(S,e/25*1e3)}i(249);var c,u,d,h,p=i(250),m=i(252),f=i(191).inherits,g=i(235),_=i(227),v=i(228),y=i(257),b=i(231),w=i(258).playUiSound,M=16,T=1,C=350,I=50,A=5;f(n,g);var t=e.exports=n;n.prototype.updateAndAppearAt=function(e,t,i){i=i||{margin:A},this._updateAndAppear(e,p.getTargetRect(t),i)},n.prototype._setContent=function(e){for(var t=this.content.getChildren(),i=0;i<t.length;i++)this.content.removeChild(t[i]);e&&this.content.appendChild(e)},n.prototype._prepareForNewContent=function(){var e=this.content.rootElement.clientWidth+M,t=this.content.rootElement.clientHeight+M;return _.cancelTween(this),this.delClassNames("transition"),this.setStyles({width:C+"px",overflow:"hidden"}),this.content.setStyles({width:null,height:null}),[e,t]},n.prototype._updateAndAppear=function(e,t,i){i=i||{};var n=this._prepareForNewContent();e&&this._setContent(e),this.show();var s,a=this.content.rootElement.clientWidth+T,r=this.content.rootElement.clientHeight,l=a+M,c=r+M,u=i.margin||0;if(i.centerOnTarget){var d=t.left+t.width/2,h=t.top+t.height/2;s=p.getCenteredTooltipPosition(l,c,d,h)}else s=p.getBestTooltipPosition(l,c,t,u);var f="translate3d("+s.x+"px,"+s.y+"px,0)";this.content.setStyles({width:a+"px",height:r+"px"}),this.openState?(this.setStyles({width:n[0]+"px",height:n[1]+"px",overflow:null}),m.forceReflow(this),this.addClassNames("transition"),_.tween(this,{width:l+"px",height:c+"px",webkitTransform:f},{time:150,easing:"ease-out"},o)):(this.openState=!0,this.setStyles({width:l+"px",height:c+"px",overflow:null,webkitTransform:f,opacity:1}),w("ROLLOVER"))},n.prototype.closeForRecomputing=function(){c._closeTooltip(!0)},n.prototype.closeTooltip=function(){this._closeTooltip(!1)},n.prototype._closeTooltip=function(e){this.openState&&(this.openState=!1,e?(this.setStyle("opacity",0),s.call(this)):_.tween(this,{opacity:0},{time:150,easing:"ease-out"},s))},t.initialiseTooltipBehavior=function(e){return c=new n,e.on("dom.touchend",function(){d&&y.stop(),d=!1,a()}),c},t.addTooltip=function(e,t,i){function n(){var i=t;return"function"==typeof t&&(i=t.call(e),i="string"==typeof i?new g("div",{text:i}):i),i}function o(){if(e._tooltipEnabled&&b.requestInteractionHandle("TOOLTIP",c)&&(clearTimeout(h),h=null,!u||u!==e)){var t=n(),i=t instanceof g;if(u&&u.emit("tooltipOut"),!i)return c._closeTooltip(!0),void c._setContent(!1);c._updateAndAppear(t,p.getTargetRect(e),{margin:I/2}),c.delClassNames("noBackground"),u=e,e.emit("tooltipOn")}}e.hasOwnProperty("_tooltipEnabled")||(e._tooltipEnabled=!0,i=i||{},t="string"==typeof t?new g("div",{text:t}):t,v(e),y(e),e.on("longtap",function(){y.start(),o(),d=!0}),e.on("touchenter",function(){d&&o()}),i.openOnTap&&e.on("tap",o),e.on("touchleave",r))},n.prototype.hideBackgroundOnce=function(){this.addClassNames("noBackground")},n.prototype.resetBackground=function(){this.delClassNames("noBackground")},n.prototype.openTooltipAt=function(e,t,i,n,o){var s=p.newTargetRect(e,t,i||I,n||I);this._updateAndAppear(o||null,s)},t.enableTooltip=function(e,t){e.hasOwnProperty("_tooltipEnabled")&&e._tooltipEnabled!==t&&(e._tooltipEnabled=t)};var S=3e3;t.computeNotificationDisplayTime=l,t.showNotification=function(e,t,i){"string"==typeof e?(i=i||l(e.length),e=c.createChild("div",{text:e})):i=i||S,c._updateAndAppear(e,p.getTargetRect(t)),clearTimeout(h),h=setTimeout(a,i)}},function(e,t){},function(e,t,i){function n(e,t){return{x:e-a.bodyPaddingLeft,y:t}}function o(e){var t=n(e.left,e.top);return{top:t.y,left:t.x,bottom:t.y+e.height,right:t.x+e.width,width:e.width,height:e.height}}function s(e,t,i,n,o){var s=i-e;s<u&&(s=n,s+e>a.screenWidth-u&&(s=Math.max(u,a.screenWidth-u-e)));var r=Math.max(o-t,u);return{x:Math.round(s),y:Math.round(r)}}var a=i(183).dimensions,r=i(251),l=r.FINGER_OFFSET,c=l/2,u=r.OFFSET_FROM_SCREEN;t.positionNextTo=function(e,t,i){e.setStyle("opacity",0),e.show();var n=o(t.rootElement.getBoundingClientRect()),s=o(e.rootElement.getBoundingClientRect()),r=0,l=0;if(i&&i.padding){var c=i.padding;s.width+=2*c,s.height+=2*c}n.left>s.width?r=n.left-s.width:a.screenWidth-n.right>s.width&&(r=n.left+n.width),l=a.screenHeight-n.bottom+n.height>s.height?n.top:n.top+n.height>s.height?n.top+n.height-s.height:a.screenHeight-s.height,e.setStyles({left:Math.round(r)+"px",top:Math.round(l)+"px"}),e.setStyle("opacity",1)},t.getElementPositionAt=function(e,t,i){var o=n(t,i);return t=o.x,i=o.y,s(e.rootElement.clientWidth,e.rootElement.clientHeight,t-c,t+c,i-c)};var d=60;t.getElementPositionCenteredAt=function(e,i,n){var o=e.rootElement.clientWidth,s=e.rootElement.clientHeight;return t.getCenteredTooltipPosition(o,s,i,n,d)},t.getCenteredTooltipPosition=function(e,t,i,o,s){var r=n(i,o);i=r.x,o=r.y;var l=i-e/2;l<u?l=u:l+e>a.screenWidth-u&&(l=a.screenWidth-u-e);var c;return s?(c=o-t-s,c<u&&(c=o+s)):c=Math.max(o-t/2,u),{x:Math.round(l),y:Math.round(c)}},t.getElementPositionAround=function(e,t){var i,n;n=e&&e.rootElement?{width:e.rootElement.clientWidth,height:e.rootElement.clientHeight}:{width:0,height:0},i=t&&t.rootElement?o(t.rootElement.getBoundingClientRect()):{width:0,height:0,left:0,top:0};var a=i.width/2,r=i.height/2,l=i.left+a,u=i.top+r;return a=a<c?c:a,r=r<c?c:r,s(n.width,n.height,l-a,l+a,u-r)},t.getTargetRect=function(e){return e.rootElement.getBoundingClientRect()},t.newTargetRect=function(e,t,i,n){return{left:e-i/2,top:t-n/2,width:i,height:n}},t.getBestTooltipPosition=function(e,t,i,n){i=o(i);var s,r,l=i.left+i.width/2,c=i.top+i.height/2;return r=i.top-n-t,r>=u?s=l-e/2:(s=l>a.screenWidth/2?i.left-n-e:l+i.width/2+n,r=c-t/2),s<u?s=u:s+e>a.screenWidth-u&&(s=a.screenWidth-u-e),r<u?r=u:r+t>a.screenHeight-u&&(r=a.screenHeight-u-t),{x:Math.round(s),y:Math.round(r)}}},function(e,t){t.FINGER_OFFSET=42,t.OFFSET_FROM_SCREEN=10},function(e,t,i){function n(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function o(e,t){if(!Array.isArray(e))return console.error(new Error("checkBidHouseCategoriesAddendumIntegrity: types is not an Array"));var i={},n=[];for(var o in t)if(t.hasOwnProperty(o))for(var s=t[o],a=0;a<s.allowedTypes.length;a+=1){var r=s.allowedTypes[a];i[r]=!0}n=Object.keys(i),n=n.map(function(e){return window.parseInt(e,10)});for(var l=0;l<n.length;l+=1){var c=n[l];e.indexOf(c)===-1&&console.error("BidHouseCategoriesAddendum have an extra type "+c)}for(var u=0;u<e.length;u+=1){var d=e[u];n.indexOf(d)===-1&&console.error("BidHouseCategoriesAddendum is missing the type "+d)}}function s(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function a(e,t,i,n){var o=t.isRiding?t.mountXpRatio||0:0,s=t.guild.getGuildMemberInfo(t.id)||{},a={level:t.characterBaseInformations.level},r=[a];if(null!==i){var l=i.getMembers();for(var c in l)l.hasOwnProperty(c)&&r.push(l[c])}var u=t.characters.mainCharacter.characteristics.wisdom,d=t.alliance.getPrismBonusPercent(t.position.subAreaId),h={level:t.characterBaseInformations.level,wisdom:u.getTotalStat(),experienceFactor:t.experienceFactor,xpRatioMount:o,xpGuildGivenPercent:s.experienceGivenPercent||0,xpAlliancePrismBonusPercent:d};return m(h,e,r,n)}function r(e,t){var i=window.gui.databases.IncarnationLevels,n=100*e+t;return i[n]}function l(e,t,i){var n=32768*e+i,o=1,s=0,a=0;do o++,a=0,a=r(t,o),a&&(s=a.requiredXp);while(s<=n&&o<51);return o--,{level:o,currentExp:n,requiredExpToNextLevel:a?a.requiredXp:0,expPreviousLevel:r(t,o).requiredXp}}var c=i(29).getText,u=i(31),d=i(28).time.dofusTimeYearLag,h=i(227),p=i(229).events,m=i(253),f=i(254);t.totalCriticalHitRate=f;var g=i(255);t.extractElementsFrom=g;var _=i(256);t.isActorVisibleToUser=_;var v=86400;t.sortObjectInArray=function(e,t,i){var n=i?1:-1,o=i?-1:1;e.sort(function(e,i){return e[t]<i[t]?n:e[t]>i[t]?o:0})},t.getObjectInArrayIndexById=function(e,t,i){if(!Array.isArray(e))return console.error("Input not an array.",e);for(var n=0;n<e.length;n+=1){var o=e[n];if(o.hasOwnProperty(t)&&o[t]===i)return n}return-1},t.getObjectInArrayById=function(t,i,n){var o=e.exports.getObjectInArrayIndexById(t,i,n);if(o>=0)return t[o]},t.removeObjectInArrayById=function(e,t,i){if(!Array.isArray(e))return console.error("Input not an array.",e);for(var n=!1,o=e.length-1;o>=0;o-=1){var s=e[o];s.hasOwnProperty(t)&&s[t]===i&&(e.splice(o,1),n=!0)}return n},t.mergeObjects=function(e){for(var t=e||arguments,i={},n=0,o=t.length;n<o;n+=1){var s=t[n];for(var a in s)s.hasOwnProperty(a)&&(i[a]=s[a])}return i};var y=/[^0-9]+/g,b=/\B(?=(\d{3})+(?!\d))/g,w=null,M=null;t.kamasToString=function(e,t){t||""===t||(t=c("ui.common.short.kama"));var i=this.intToString(e);return t?i+" "+t:i},t.stringToKamas=function(e){return Number(e.replace(y,""))},t.intToString=function(e){return isNaN(e)||null===e?"":(M=null!==M?M:c("ui.common.numberSeparator"),e.toString().replace(b,M))},t.stringToInt=function(e){return w||(M=null!==M?M:c("ui.common.numberSeparator"),w=new RegExp(n(M),"g")),Number(e.replace(w,""))},t.hardAndSoftToString=function(e,i){var n=e?t.kamasToString(e,"G")+" / ":"";return n+t.kamasToString(i,"K")},t.storeMapAndEmit=function(e,t,i,n){var o=!1;for(var s in i)t[s]!==i[s]&&(t[s]=i[s],o=!0);o&&e.emit(n)},t.storeValueAndEmit=function(e,t,i,n,o){t[i]!==n&&(t[i]=n,e.emit(o,n))},t.hexToRgb=function(e){for(var t=6-e.length,i=0;i<t;i++)e="0"+e;var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null},t.durationToString=function(e){var t=~~e%60;t<10&&(t="0"+t);var i=~~(e/60)%60;i<10&&(i="0"+i);var n=~~(e/3600);return n<10&&(n="0"+n),n+":"+i+":"+t},t.durationToHuman=function(e){var t=e/v;if(t>=1){var i=Math.floor(t/365.25);if(i>=1)return i+" "+c("ui.time.years",i);var n=Math.floor(t/30.5);return n>=1?n+" "+c("ui.time.months",n):(t=Math.floor(t),t+" "+c("ui.time.days",t))}var o=Math.floor(e/3600);if(o>=1)return o+" "+c("ui.time.hours",o);var s=Math.floor(e/60);if(s>=1)return s+" "+c("ui.time.minutes",s);var a=Math.ceil(e);return a+" "+c("ui.time.seconds",a)},t.getAlmanaxDate=function(e,t){e=e?new Date(e):new Date;var i=t?e.getFullYear():e.getUTCFullYear(),n=t?e.getMonth():e.getUTCMonth(),o=t?e.getDate():e.getUTCDate(),s=t?e.getHours():e.getUTCHours(),a=t?e.getMinutes():e.getUTCMinutes();return{year:i+d,month:n+1,day:o,monthName:window.gui.databases.Months[n].nameId,hour:s<10?"0"+s:s,minute:a<10?"0"+a:a}},t.simplifyString=function(e){if(!e)return console.error(new Error("missing word to simplify")),"";e=e.split("");for(var t=[],i=e.length,n="",o="AAAAAAaaaaaaOOOOOOOooooooEEEEeeeeeCcDIIIIiiiiUUUUuuuuNnSsYyyZz",s=0;s<i;s++)n.indexOf(e[s])!==-1?t[s]=o.substr(n.indexOf(e[s]),1):t[s]=e[s];return t=t.join(""),t.toLowerCase()},t.createFifo=function(){return u.queue(function(e,t){try{e(function(e){if(e)throw new Error(e);t()})}catch(i){return console.error(i),t(i)}})},t.getObjectInstanceName=function(e){if(!e)return null;var t=/function ([^(]+)/.exec(String(Object.getPrototypeOf(e).constructor))||[];return t[1]},t.mapToArray=function(e,t){for(var i=Object.keys(e),n=i.length,o=new Array(n),s=0;s<n;s++)o[s]=e[i[s]];if(t&&t.sortBy){var a=t.sortBy;o.sort(function(e,t){return e[a]-t[a]})}return o},t.forceReflow=function(e,t){e.rootElement.offsetWidth;t&&window.setTimeout(t,100)},t.showProgressively=function(e,i,n,o){function s(){o&&h.tween(o,{opacity:0},{time:i||250}),e&&h.tween(e,{opacity:1},{time:i||250})}e&&(e.setStyle("opacity",0),e.show(),t.forceReflow(e)),n?window.setTimeout(s,n):s()},t.allLinksOnTargetBlank=function(e){function t(e,t){e.addEventListener("click",function(e){e.preventDefault()}),e.addEventListener(p.end,function(e){t=encodeURI(t),i.openUrlInAppBrowser(t),e.preventDefault()})}for(var i=this,n=e.rootElement.getElementsByTagName("a"),o=0;o<n.length;o++)n[o].href&&t(n[o],n[o].href)},t.openUrlInDeviceBrowser=function(e){window.open(e,"_system")};var T;if(window.cordova&&window.cordova.InAppBrowser){var C,I=function A(){C.removeEventListener("exit",A),C=null};T=function(e){return C?console.error(new Error("unable to open url "+e+": in app browser is already opened")):(C=window.cordova.InAppBrowser.open(e,"_blank","closebuttoncaption="+c("tablet.common.backToGame")),void C.addEventListener("exit",I))}}else T=function(e){window.open(e,"_blank")};t.openUrlInAppBrowser=T,t.cssTransform=function(e,t){e.setStyles({transform:t,oTransform:t,msTransform:t,mozTransform:t,webkitTransform:t})},t.cssTransition=function(e,t){e.setStyles({transition:t,oTransition:t,msTransition:t,mozTransition:t,webkitTransition:t})},t.createPropertyNameCompareFunc=function(e){return function(t,i){return t[e]<i[e]?-1:t[e]>i[e]?1:0}},t.createStringCompareFunc=function(e){e=e||"nameId";var t=window.Config.language;return function(i,n){var o=i[e];return"string"!=typeof o?-1:o.localeCompare(n[e],t)}},t.jeffVersionDowngrader=function(e,i){if(i||e.meta&&e.meta.version){if(void 0!==e.x&&(e.x*=-1),void 0!==e.y&&(e.y*=-1),void 0!==e.transforms&&(e.matrices=e.transforms,delete e.transforms),void 0!==e.isAnimation&&(e.isAnim=e.isAnimation,delete e.isAnimation),e.symbols)for(var n in e.symbols)t.jeffVersionDowngrader(e.symbols[n],!0);if(e.children)for(var o in e.children)t.jeffVersionDowngrader(e.children[o],!0)}},t.checkBidHouseCategoriesAddendumIntegrity=o,t.randomIntFromInterval=s,t.getXpPreview=a,t.getIncarnationExpDetails=l},function(e,t){function i(e,t){t=t||0;var i=Math.pow(10,t),n=e*i;return parseInt(n,10)/i}function n(e){return e<=0?1:1+e/100}function o(e,t){var i=1;return"number"!=typeof e||"number"!=typeof t?(console.error("xpFormula: one of getGroupXPCoeff's params is not a number",{totalPlayerLevels:e,totalMobLevels:t}),i):(e-a>t?i=t/e:e+2*a<t&&(i=(e+2*a)/t),i)}function s(e){return r[Math.max(0,Math.min(r.length,e)-1)]}var a=5,r=[1,1.1,1.5,2.3,3.1,3.6,4.2,4.7];e.exports=function(e,t,a,r){e=e||{},r=r||0,a=a||[e],Array.isArray(a)||(a=[e]);var l=0;if("number"!=typeof e.level||"number"!=typeof e.wisdom||"number"!=typeof e.xpRatioMount||"number"!=typeof e.experienceFactor||"number"!=typeof e.xpGuildGivenPercent||"number"!=typeof e.xpAlliancePrismBonusPercent)return console.error("xpFormula: there are params in playerData that are not a number",{level:e.level,wisdom:e.wisdom,experienceFactor:e.experienceFactor,xpRatioMount:e.xpRatioMount,xpGuildGivenPercent:e.xpGuildGivenPercent,xpAlliancePrismBonusPercent:e.xpAlliancePrismBonusPercent}),0;var c=0,u=0,d=0;a.forEach(function(e){c+=e.level,e.level>u&&(u=e.level)});var h=Math.floor(u/3);a.forEach(function(e){e.level>=h&&(d+=1)});var p=0,m=0,f=0;Array.isArray(t)&&t.forEach(function(e){return"number"!=typeof e.xp||"number"!=typeof e.level?void console.error("xpFormula: mob xp or level is not a number for mob: "+e.id,{xp:e.xp,level:e.level}):(m+=e.level,e.level>p&&(p=e.level),void(f+=i(e.xp)))});var g=o(c,m),_=s(d);if(f=i(f*g),f=i(f*_),f=i(f*n(r)),f<=0)return 0;var v=i(2.5*p),y=Math.min(e.level,v);l=i(f*y/c),l=i(l*e.wisdom/100+l),l=Math.max(1,l);var b=1+e.experienceFactor/100,w=100;return w-=w*e.xpRatioMount/100,w-=w*e.xpGuildGivenPercent/100,w/=100,e.xpAlliancePrismBonusPercent>0&&(l*=1+e.xpAlliancePrismBonusPercent/100),l=i(l*w)*b,i(l)}},function(e,t){e.exports=function(e,t){var i=t.criticalHit,n=t.agility,o=i.getTotalStat(),s=n.getTotalStat();s<0&&(s=0);var a=e-o,r=parseInt(a*Math.E*1.1/Math.log(s+12),10),l=Math.min(a,r);return l<2&&(l=2),l}},function(e,t){"use strict";e.exports=function(e,t,i,n){i=i||!1,n=n||"id",e=e.map(function(e){return e.toString()});var o,s;if(o=i?{}:[],t instanceof Array){var a=t.length;for(s=0;s<a;s++)t[s]&&e.indexOf(t[s][n].toString())!==-1&&(i?o[t[s][n]]=t[s]:o.push(t[s]))}else for(s in t)t[s]&&e.indexOf(t[s][n].toString())!==-1&&(i?o[t[s][n]]=t[s]:o.push(t[s]));return o}},function(e,t,i){var n=i(189);e.exports=function(e){var t=n(),i=t.actorManager.getActor(e);if(!i)return!1;var o=i.getTeamId(),s=t.actorManager.userActor.getTeamId();return o===s||!i.isInvisible}},function(e,t,i){function n(e){var t=b(e);p=w.x=t.x,m=w.y=t.y,w.touchCount=t.touchCount}function o(){M=!0}function s(){if(M){M=!1;var e=document.elementFromPoint(p,m);if(!e)return void(M=!0);if(e===v)return void o();v=e,g=w.touchedElements=[];var t=document.createEvent("Event");t.initEvent("touching",!0,!0),e.dispatchEvent(t)}}function a(e){n(e),(Math.abs(p-T)>15||Math.abs(m-C)>15||e.timeStamp-I>50)&&(T=p,C=m,s()),I=e.timeStamp}function r(e){var t=b(e);
w.touchCount=t.touchCount,0===t.touchCount&&u()}function l(){g.push(y),_=w.topElement=g[0];for(var e=g.length-1,t=f.length-1,i=Math.max(e,t);i>=0;i-=1){var n=f[t],o=g[e];n!==o&&(n&&n.emit("touchleave",w),o&&o.emit("touchenter",w)),t-=1,e-=1}f=g,M=!0}function c(){h||(h=!0,f=[],g=[],v=null,_=null,M=!0,y.on("dom.touchmove",a),y.on("dom.touchend",r))}function u(){h&&(h=!1,y.removeListener("dom.touchend",r),y.removeListener("dom.touchmove",a))}function d(e){e._hoverBehavior||(e._hoverBehavior=!0,e.allowDomEvents(),e.on("dom.touching",function(t){return _!==e||g.length?void g.push(e):(t.stopPropagation(),o())}))}var h,p,m,f,g,_,v,y,b=i(229).getPosition,w={x:0,y:0,touchCount:0,topElement:null,touchedElements:null},M=!1,T=0,C=0,I=0;e.exports=d,d.start=c,d.stop=u,d.initialize=function(e){return window._hoverBehavior?console.error("hover behavior initialised more than one time."):(window._hoverBehavior=!0,y=e,void y.on("dom.touching",l))}},function(e,t,i){function n(e){return!!m[e]&&(console.warn('audioManager: known missing audio "'+e+'" will be skip'),!0)}function o(){window.gui.on("appGoBackground",function(){w.setMute(!0)}),window.gui.on("appLeaveBackground",function(){w.setMute(!1)}),p.on("gameContextChanged",function(){a()})}function s(){for(var e in l)w.createSoundPermanent(l[e],"ui");b=!0}function a(e){if(g&&p.isRoleplayMode)w.playLoopSound("music",g.id,g.volume/100);else if(p.isFightMode){var t=e&&v?v:_;t&&w.playLoopSound("music",t.id,t.volume/100)}y&&(p.isRoleplayMode?w.playLoopSound("ambient",y.id,y.volume/100):w.stopLoopSound("ambient"))}var r=i(259),l=i(266),c=i(184),u=i(185),d=i(267),h=i(268),p=i(269),m=i(278),f=[null,"music","ambient","fight","boss"],g=null,_=null,v=null,y=null,b=!1,w=new r(["music","ambient","sfx","ui"]);w.settings.maxUsedMemory=c.MAX_MUSIC_SFX_MEMORY,window.wizAssets?w.settings.getFileUri=function(e,t,i){return n("audio/"+t+".mp3")?i("missingAudio"+t):void window.wizAssets.downloadFile(e+t+".mp3","audio/"+t+".mp3",function(e){i(null,e)},i)}:w.settings.getFileUri=function(e,t){return n("audio/"+t+".mp3")?"":e+t+".mp3"},u.isCordova&&(w.settings.getSoundConstructor=function(e){return u.isIOSApp&&d.isAvailable()?d:u.isAndroidApp&&h.isAvailable()?"music"===e||"ambient"===e?h.LoopYanap:"sfx"===e||"ui"===e?h.SoundYanap:void 0===e?h.SoundYanap:void console.error(new Error("audioManager: unknown channelId `"+e+"`")):null});var t=e.exports=w;t.initialize=function(){w.init(),o()},t.createUiSound=function(e){w.createSoundPermanent(l[e],"ui")},t.playUiSound=function(e){if(!w.channels.ui.muted){var t=l[e];if(!t)return console.warn("Incorrect UI sound id: "+e);b||s(),w.playSound("ui",t)}},t.mapChange=function(e,t){var i={music:null,ambient:null,fight:null,boss:null};t=e.concat(t);for(var n=0;n<t.length;n++){var o=t[n],s=f[o.type_id];s&&(i[s]=o)}g=i.music||g,y=i.ambient||y,_=i.fight,v=i.boss,a()},t.createAnimSoundGroups=function(e,t){var i=void 0!==t&&w.channels[t].muted;for(var n in e){for(var o=e[n],s=[],a=0;a<o.vol.length;a++)s.push(o.vol[a]/100);w.createSoundGroup(n,{id:o.id,vol:s},i)}},t.setChannelVolume=function(e,t,i){var n=w.channels.music;"music"===e&&w.channels.ambient.setMute(0!==t),"ambient"===e&&!n.muted&&n.volume>0&&(i=!0),w.setVolume(e,t,i),"sfx"===e&&this.setChannelVolume("ambient",t)},t.setupChannels=function(e){w.setVolume("ambient",0,!0);for(var t in e)if("ambient"!==t){var i=e[t];this.setChannelVolume(t,i.volume,i.muted)}},t.getDefaultParams=function(){var e={};for(var t in w.channels)if("ambient"!==t){var i="music"===t&&u.isIpad2,n=i?0:1;e[t]={muted:i,volume:n}}return e}},function(e,t,i){function n(e){this.soundsById={},this.soundGroupsById={},this.permanentSounds={},this.freeSoundPool=[],this.soundArchive=new s(function(){return 1}),this.soundGroupArchive=new s(function(){return 1}),this.soundArchiveById={},this.soundGroupArchiveById={},this.usedMemory=0,this.channels={},this.audioContext=null,this.muted=!1,this.settings={audioPath:"",maxSoundGroup:500,maxUsedMemory:300,defaultFade:2,maxPlayLatency:1e3,crossFading:!1,getFileUri:function(e,t){return e+t+".mp3"},getSoundConstructor:function(e,t){return null}};for(var t=0;t<e.length;t++){var i=e[t];this.channels[i]=new l(i)}c.prototype.audioManager=this,r.prototype.audioManager=this,l.prototype.audioManager=this}var o=window.AudioContext||window.webkitAudioContext,s=i(260),a=i(261),r=i(263),l=i(264),c=i(262);o||(console.warn("Web Audio API is not supported on this platform. Fallback to regular HTML5 <Audio>"),a=i(265),window.Audio||(console.warn("HTML5 <Audio> is not supported on this platform. Sound features are unavailable."),a=c));var u=new c;e.exports=n,e.exports.ISound=c,n.prototype.init=function(){if(!this.audioContext&&o){this.audioContext=new o,a.prototype.audioContext=this.audioContext;for(var e in this.soundsById)this.soundsById[e].init()}},n.prototype.getEmptySound=function(e,t){var i,n=this.settings.getSoundConstructor(e,t);return n?i=new n:(this.freeSoundPool.length>0?(i=this.freeSoundPool.pop(),i.init()):i=new a,i)},n.prototype.setup=function(e){for(var t in e){var i=e[t];this.setVolume(t,i.volume,i.muted)}},n.prototype.addChannel=function(e){this.channels[e]||(this.channels[e]=new l(e))},n.prototype.setVolume=function(e,t,i){var n=this.channels[e];n&&n.setVolume(t,i)},n.prototype.setMute=function(e){void 0===e&&(e=!this.muted),this.muted=!!e;for(var t in this.channels){var i=this.channels[t];if(i.loopSound)if(e)i.loopSound.stop();else{var n=i.muted;i.muted=!0,i.setVolume(null,n)}}},n.prototype.loadSound=function(e,t){var i=this.createSound(e);return i.load(t),i},n.prototype.createSound=function(e,t){var i=this.getSound(e);return i?i:(i=this.soundsById[e]=this.getEmptySound(t,e),i.setId(e),i)},n.prototype.createSoundPermanent=function(e,t){var i=this.getSound(e);if(i)return i;var n=this.settings.getSoundConstructor(t,e)||a;return i=this.permanentSounds[e]=new n,i.setId(e),i},n.prototype.getSound=function(e){var t=this.permanentSounds[e];return t?t:(t=this.soundsById[e])?t:(t=this.soundArchiveById[e])?(this.soundArchive.removeByRef(t.poolRef),t.poolRef=null,delete this.soundArchiveById[e],this.soundsById[e]=t,t):null},n.prototype.getSoundGroup=function(e){var t=this.soundGroupsById[e];return t?t:(t=this.soundGroupArchiveById[e])?(this.soundGroupArchive.removeByRef(t.poolRef),t.poolRef=null,delete this.soundGroupArchiveById[e],t.verifySounds(),this.soundGroupsById[e]=t,t):null},n.prototype.freeSound=function(e){var t=e.id;this.soundsById[t]&&delete this.soundsById[t],this.soundArchiveById[t]&&(this.soundArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundArchiveById[t]),e.unload(),e instanceof a&&this.freeSoundPool.push(e)},n.prototype.playLoopSound=function(e,t,i,n,o,s,a){var r=this.channels[e];return r?void r.playLoopSound(t,i,n,o,s,a):console.warn('Channel id "'+e+'" does not exist.')},n.prototype.stopLoopSound=function(e){var t=this,i=this.channels[e];if(!i)return console.warn('Channel id "'+e+'" does not exist.');var n=i.loopSound;i.loopId=null,n&&n.stop(function(){t.freeSound(n),i.loopSound=null})},n.prototype.stopAllLoopSounds=function(){for(var e in this.channels)this.stopLoopSound(e)},n.prototype.release=function(){var e,t,i,n=this.settings.maxSoundGroup,o=this.settings.maxUsedMemory,s={};for(e in this.channels){var a=this.channels[e];a.loopSound&&(s[a.loopSound.id]=!0)}for(e in this.soundGroupsById)t=this.soundGroupsById[e],t.poolRef=this.soundGroupArchive.add(t),this.soundGroupArchiveById[e]=t,delete this.soundGroupsById[e];for(e in this.soundsById)s[e]||(i=this.soundsById[e],i.poolRef=this.soundArchive.add(i),this.soundArchiveById[e]=i,delete this.soundsById[e]);for(var r=this.soundGroupArchive.getCount();r>n&&(t=this.soundGroupArchive.popFirst());)t.poolRef=null,delete this.soundGroupArchiveById[t.id],r-=1;for(;this.usedMemory>o&&(i=this.soundArchive.popFirst());)i.poolRef=null,delete this.soundArchiveById[i.id],this.freeSound(i)},n.prototype.playSound=function(e,t,i,n,o){if(this.muted)return u;var s=this.channels[e];if(s.muted)return u;var a=this.getSound(t);return a||(a=this.createSound(t,e)),i=i||1,a.play(s.volume*i,n,o),a},n.prototype.playSoundGroup=function(e,t,i,n,o){if(!this.muted){var s=this.channels[e];if(s&&!s.muted){var a=this.getSoundGroup(t);if(!a)return console.warn('SoundGroup "'+t+'" does not exist.');i=i||1,a.play(i*s.volume,n,o)}}},n.prototype.createSoundGroup=function(e,t,i){if(!this.getSoundGroup(e)){var n=new r(e,t.id,t.vol,t.pitch,i);this.soundGroupsById[e]=n}},n.prototype.createSoundGroups=function(e,t){var i=void 0!==t&&this.channels[t].muted;for(var n in e)this.createSoundGroup(n,e[n],i)}},function(e,t){function i(e,t,i,n){this.object=e,this.previous=t,this.next=i,this.container=n}function n(e){this.count=0,this.first=null,this.last=null,this.cmpFunc=e}n.prototype.add=function(e){var t=new i(e,null,null,this);if(this.count+=1,null===this.first)return this.first=t,this.last=t,t;var n=this.cmpFunc(e,this.first.object);if(n<0)return t.next=this.first,this.first.previous=t,this.first=t,t;var o=this.cmpFunc(e,this.last.object);if(o>=0)return t.previous=this.last,this.last.next=t,this.last=t,t;var s;if(n+o<0){for(s=this.first.next;this.cmpFunc(e,s.object)>=0;)s=s.next;t.next=s,t.previous=s.previous,t.previous.next=t,s.previous=t}else{for(s=this.last.previous;this.cmpFunc(e,s.object)<0;)s=s.previous;t.previous=s,t.next=s.next,t.next.previous=t,s.next=t}return t},n.prototype.removeByRef=function(e){return!(!e||e.container!==this)&&(this.count-=1,null===e.previous?this.first=e.next:e.previous.next=e.next,null===e.next?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=null,e.container=null,!0)},n.prototype.moveToTheBeginning=function(e){return!(!e||e.container!==this)&&(null===e.previous||(e.previous.next=e.next,this.last===e?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=this.first,e.next.previous=e,this.first=e,!0))},n.prototype.moveToTheEnd=function(e){return!(!e||e.container!==this)&&(null===e.next||(e.next.previous=e.previous,this.first===e?this.first=e.next:e.previous.next=e.next,e.next=null,e.previous=this.last,e.previous.next=e,this.last=e,!0))},n.prototype.possess=function(e){return e&&e.container===this},n.prototype.popFirst=function(){var e=this.first;if(!e)return null;this.count-=1;var t=e.object;return this.first=e.next,null!==this.first&&(this.first.previous=null),e.next=null,e.container=null,t},n.prototype.popLast=function(){var e=this.last;if(!e)return null;this.count-=1;var t=e.object;return this.last=e.previous,null!==this.last&&(this.last.next=null),e.previous=null,e.container=null,t},n.prototype.getFirst=function(){return this.first&&this.first.object},n.prototype.getLast=function(){return this.last&&this.last.object},n.prototype.clear=function(){for(var e=this.first;e;e=e.next)e.container=null;this.count=0,this.first=null,this.last=null},n.prototype.getCount=function(){return this.count},n.prototype.forEach=function(e,t){for(var i=this.first;i;i=i.next)e(i.object,t)},n.prototype.forEachReverse=function(e,t){for(var i=this.last;i;i=i.previous)e(i.object,t)},n.prototype.reposition=function(e){if(e.container!==this)return this.add(e.object);var t=e.previous,i=e.next,n=e.object;for(null===i?this.last=t:i.previous=t,null===t?this.first=i:t.next=i;null!==t&&this.cmpFunc(n,t.object)<0;)i=t,t=t.previous;for(;null!==i&&this.cmpFunc(n,i.object)>=0;)t=i,i=i.next;return e.next=i,null===i?this.last=e:i.previous=e,e.previous=t,null===t?this.first=e:t.next=e,e},e.exports=n},function(e,t,i){function n(){s.call(this),this.buffer=null,this.source=null,this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._playPitch=0,this._fadeTimeout=null,this._onStopCallback=null,this._audioNodeReady=!1,this._loopStart=0,this._loopEnd=0,this.init()}var o=i(191).inherits,s=i(262),a=1e-6;o(n,s),e.exports=n,n.prototype._createAudioNodes=function(){if(!this._audioNodeReady&&this.audioContext){var e,t=this.audioContext,i=t.createGain();e=t.createStereoPanner?t.createStereoPanner():t.createPanner(),i.connect(e),e.connect(t.destination),i.gain.value=0,this.sourceConnector=i,this.gain=i.gain,this.panNode=e,this._audioNodeReady=!0}},n.prototype._destroyAudioNodes=function(){if(this._audioNodeReady){var e=this.audioContext,t=this.panNode,i=this.sourceConnector;i.disconnect(t),t.disconnect(e.destination),this.source&&(this.source.disconnect(i),this.source.onended=null,this.source=null),this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._audioNodeReady=!1}},n.prototype.init=function(){function e(e){i.buffer=e,i.usedMemory=e.duration,i.audioManager.usedMemory+=e.duration,i.rawAudioData=null,i._loaded&&i._playTriggered&&((i.loop||Date.now()-i._playTriggered<n)&&i._play(),i._playTriggered=0)}function t(){console.error("decode audio failed for sound ",i.id)}if(this._createAudioNodes(),this.rawAudioData){var i=this,n=this.audioManager.settings.maxPlayLatency,o=this.audioContext;o.decodeAudioData(this.rawAudioData,e,t)}},n.prototype.setVolume=function(e){if(this.volume=e,this.playing){if(!this.fade)return void(this.gain.value=e);e<=0&&(e=a);var t=this.audioContext.currentTime;this.gain.cancelScheduledValues(t),this.gain.setValueAtTime(this.gain.value||a,t),this.gain.linearRampToValueAtTime(e,t+this.fade)}},n.prototype.setPan=function(e){this.pan=e,this.panNode&&(this.panNode.pan?this.panNode.pan.value=e:this.panNode.setPosition(e,0,.2))},n.prototype.setLoop=function(e,t,i){this.loop=!!e,this._loopStart=t||0,this._loopEnd=i||0,this.source&&this.buffer&&(this.source.loop=e,this._setLoopPoints())},n.prototype._setLoopPoints=function(){this.source.loopStart=this._loopStart||0;var e=this._loopEnd;e<0&&(e=this.buffer.duration+e),e<0&&(e=0),this.source.loopEnd=e||this.buffer.duration},n.prototype.setPitch=function(e,t){this.pitch=e,this._setPlaybackRate(t)},n.prototype._updatePlayPitch=function(e){!e&&0!==e||e===this._playPitch||(this._playPitch=e,this._setPlaybackRate(0))},n.prototype._setPlaybackRate=function(e){if(this.source){var t=Math.pow(2,(this._playPitch+this.pitch)/12);if(!e)return void(this.source.playbackRate.value=t);var i=this.audioContext.currentTime;this.source.playbackRate.cancelScheduledValues(i),this.source.playbackRate.setValueAtTime(this.source.playbackRate.value||a,i),this.source.playbackRate.linearRampToValueAtTime(t,i+e)}},n.prototype._load=function(){function e(e){n._finalizeLoad(e)}function t(e){n.buffer=e,n.usedMemory=e.duration,n.audioManager.usedMemory+=e.duration,n._finalizeLoad(null)}function i(i){var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=function(){if(4===~~o.readyState)return 200!==~~o.status&&0!==~~o.status?e("xhrError:"+o.status):void(n.audioContext?n.audioContext.decodeAudioData(o.response,t,e):(n.rawAudioData=o.response,n._finalizeLoad(null)))},o.open("GET",i,!0),o.send()}var n=this;this._createAudioNodes();var o=this.audioManager.settings.getFileUri,s=this.audioManager.settings.audioPath;if(o.length>2)o(s,this.id,function(t,n){return t?e(t):void i(n)});else try{var a=o(s,this.id);if(!a)return e("emptyUri");i(a)}catch(r){e(r)}},n.prototype.unload=function(){s.prototype.unload.call(this)&&(this._fadeTimeout&&(this._onStopCallback=null,this._stopAndClear()),this.buffer=null,this.source&&(this.source.onended=null,this.source.stop(0),this.source=null),this._destroyAudioNodes())},n.prototype._play=function(e){if(!this.buffer)return void(this._playTriggered=Date.now());this.playing=!0;var t=this.audioContext.currentTime;if(this.gain.cancelScheduledValues(t),this.fade?(this.gain.setValueAtTime(this.gain.value||a,t),this.gain.linearRampToValueAtTime(this.volume||a,t+this.fade)):this.gain.value=this.volume,this._fadeTimeout)return this._onStopCallback=null,this.source.onended=null,this.stopping=!1,window.clearTimeout(this._fadeTimeout),void(this._fadeTimeout=null);this.source&&(this.source.disconnect(this.sourceConnector),this.source.onended=null);var i=this.source=this.audioContext.createBufferSource();i.connect(this.sourceConnector);var n=this;i.onended=function(){n.playing=!1,i.onended=null,n.source=null,n.onEnd&&n.onEnd()},this._playPitch=e||0,(e||this.pitch)&&this._setPlaybackRate(0),i.loop=this.loop,i.buffer=this.buffer,this._setLoopPoints(),i.start(0)},n.prototype._stopAndClear=function(){this.stopping=!1,this.source.onended=null,this.source.stop(0),this.source=null,this._fadeTimeout&&(window.clearTimeout(this._fadeTimeout),this._fadeTimeout=null),this._onStopCallback&&(this._onStopCallback(),this._onStopCallback=null)},n.prototype.stop=function(e){if(!this.playing&&!this.stopping)return e&&e();if(this._playTriggered=0,this.stopping=!0,this.playing=!1,!this.source)return e&&e();if(this._onStopCallback=e,!this._fadeTimeout){if(this.fade){var t=this,i=this.audioContext.currentTime;return this.gain.cancelScheduledValues(i),this.gain.setValueAtTime(this.gain.value||a,i),this.gain.linearRampToValueAtTime(a,i+this.fade),void(this._fadeTimeout=window.setTimeout(function(){t._fadeTimeout=null,t._stopAndClear()},1e3*this.fade))}this._stopAndClear()}}},function(e,t){function i(){this.playing=!1,this.stopping=!1,this.fade=0,this.usedMemory=0,this.poolRef=null,this.onEnd=null,this.id=null,this.volume=1,this.pan=0,this.loop=!1,this.pitch=0,this._loaded=!1,this._loading=!1,this._unloading=!1,this._playTriggered=0,this._onLoadQueuedCallback=[]}e.exports=i,i.prototype.setId=function(e){this.id=e,this._loaded=!1},i.prototype.load=function(e){return this.id?this._loaded?e&&e(null,this):(e&&this._onLoadQueuedCallback.push(e),this._loading?void 0:(this._loading=!0,this._load())):e&&e("noId")},i.prototype._finalizeLoad=function(e){var t=this.audioManager.settings.maxPlayLatency;this._loaded=!e,this._loading=!1;for(var i=0;i<this._onLoadQueuedCallback.length;i++)this._onLoadQueuedCallback[i](e,this);return this._onLoadQueuedCallback=[],this._unloading?(this._unloading=!1,void this.unload()):void(this._loaded&&this._playTriggered&&((this.loop||Date.now()-this._playTriggered<t)&&this._play(),this._playTriggered=0))},i.prototype.cancelOnLoadCallbacks=function(){this._onLoadQueuedCallback=[]},i.prototype.play=function(e,t,i){return void 0!==e&&null!==e&&this.setVolume(e),void 0!==t&&null!==t&&this.setPan(t),this._loaded?this.loop&&this.playing?void this._updatePlayPitch(i):void this._play(i):(this._playTriggered=Date.now(),void this.load())},i.prototype.init=function(){},i.prototype.setVolume=function(e){this.volume=e},i.prototype.setPan=function(e){this.pan=e},i.prototype.setLoop=function(e){this.loop=e},i.prototype.setPitch=function(e){this.pitch=e},i.prototype._updatePlayPitch=function(e){},i.prototype._play=function(e){this.playing=!0,console.log('ISound play call: "'+this.id+'"')},i.prototype.stop=function(e){return this.playing=!1,e&&e()},i.prototype._load=function(){return console.log("ISound load call: "+this.id),this._finalizeLoad(null)},i.prototype.unload=function(){return this._playTriggered=0,this.setLoop(!1),this.fade=0,this.pitch=0,this.stop(),this._loading?(this._unloading=!0,!1):(this.audioManager.usedMemory-=this.usedMemory,this.setVolume(1),this.setPan(0),this.id=null,this._loaded=!1,this.usedMemory=0,!0)}},function(e,t){function i(e,t,i,n,o){this.id=e,this.soundIds=t,this.volumes=i||[],this.pitches=n||[],this.soundIndex=0,this.volIndex=0,this.pitchIndex=0,this.poolRef=null,this._ready=!1,0===this.volumes.length&&this.volumes.push(1),0===this.pitches.length&&this.pitches.push(0),o||this._createSounds()}e.exports=i,i.prototype._createSounds=function(){for(var e=this.soundIds,t=0;t<e.length;t++)this.audioManager.loadSound(e[t]);this._ready=!0},i.prototype.play=function(e,t,i){if(0!==this.soundIds.length){this._ready||this._createSounds();var n=this.soundIds[this.soundIndex++],o=this.audioManager.getSound(n);if(!o)return console.warn("[Sound Group: "+this.id+"] sound id "+n+"  cannot be played.");e=e||1,i=i||0,e*=this.volumes[this.volIndex++],i+=this.pitches[this.pitchIndex++],o.play(e,t,i),this.soundIndex>=this.soundIds.length&&(this.soundIndex=0),this.volIndex>=this.volumes.length&&(this.volIndex=0),this.pitchIndex>=this.pitches.length&&(this.pitchIndex=0)}},i.prototype.verifySounds=function(){for(var e=0;e<this.soundIds.length;e++){var t=this.soundIds[e];this.audioManager.createSound(t)}}},function(e,t){function i(e){this.id=e,this.volume=1,this.muted=!0,this.loopSound=null,this.loopId=null,this.loopVol=0,this.nextLoop=null}e.exports=i,i.prototype.setVolume=function(e,t){var i=this.muted;this.muted=0===e||t||!1,void 0!==e&&null!==e?this.volume=e:e=this.volume,this.loopId&&(this.loopSound&&this.muted?this.loopSound.stop():this.loopSound&&this.loopSound.id===this.loopId?(this.loopSound.setVolume(Math.max(0,Math.min(1,e*this.loopVol))),i&&this.loopSound.play()):this.muted||this.audioManager.playLoopSound(this.id,this.loopId,this.loopVol))},i.prototype.setMute=function(e){this.setVolume(null,e)},i.prototype.playLoopSound=function(e,t,i,n,o,s){function a(e,t){return e?void(e.stopping||e.stop(function(){return c.freeSound(e),e=null,t&&t()})):t&&t()}function r(){var e=m.loopSound=m.nextLoop;m.nextLoop=null,e&&(e.setLoop(!0,o,s),e.fade=u,e.load(function(o){return o?(e.unload(),void(m.loopSound=null)):void e.play(t*m.volume,i,n)}))}function l(){m.loopSound=null,window.setTimeout(r,0)}var c=this.audioManager,u=c.settings.defaultFade,d=c.settings.crossFading,h=this.loopSound,p=h&&h.id;if(t=Math.max(0,Math.min(1,t||1)),this.loopId=e,this.loopVol=t,!c.muted&&!this.muted){if(e===p&&h)return h.play(t*this.volume,i,n),void(this.nextLoop&&(this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=null));if(h=null,!this.nextLoop||this.nextLoop.id!==e){var m=this;d?(this.nextLoop&&this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=c.createSound(e,this.id),this.nextLoop.load(function(e){return e?(m.nextLoop.unload(),void(m.nextLoop=null)):(a(m.loopSound),void l())})):(this.nextLoop=c.createSound(e,this.id),a(this.loopSound,l))}}}},function(e,t,i){function n(){s.call(this);var e=new Audio;e.loop=!1,e.type="audio/mpeg",this._audio=e,this._onEnd=null,this.audioContext&&(this.source=this.audioContext.createMediaElementSource(e),this.source.connect(this.audioContext.destination))}var o=i(191).inherits,s=i(262),a={playAudioWhenScreenIsLocked:!1};o(n,s),e.exports=n,n.prototype.setVolume=function(e){this.volume=this._audio.volume=e},n.prototype.setLoop=function(e){this.loop=this._audio.loop=e},n.prototype._load=function(){function e(e){o._finalizeLoad(e)}function t(){this.removeEventListener("canplaythrough",t),this.removeEventListener("error",i),o.usedMemory=this.duration,o.audioManager.usedMemory+=this.duration,o._finalizeLoad(null)}function i(n){this.removeEventListener("canplaythrough",t),this.removeEventListener("error",i),e(n)}function n(e){o._loading=!0,o._audio.addEventListener("canplaythrough",t),o._audio.addEventListener("error",i),o._audio.src=e,o._audio.load()}var o=this,s=this.audioManager.settings.getFileUri,a=this.audioManager.settings.audioPath;if(s.length>2)s(a,this.id,function(t,i){return t?e(t):void n(i)});else try{var r=s(a,this.id);if(!r)return e("emptyUri");n(r)}catch(l){e(l)}},n.prototype.unload=function(){s.prototype.unload.call(this)&&(this._audio.volume=1,this._audio.src="",this._audio.load())},n.prototype._play=function(e){if(this._audio.volume=this.volume,this._audio.pause(),this._audio.currentTime=0,this._audio.play(a),this.playing=!0,!this.loop){var t=1e3*this._audio.duration;if(!(isNaN(t)||t<=0)){var i=this;this._onEnd=window.setTimeout(function(){i._onEnd=null,i._playing=!1,i.onEnd&&i.onEnd()},t)}}},n.prototype.stop=function(e){return null!==this._onEnd&&(window.clearTimeout(this._onEnd),this._onEnd=null),this._audio.pause(),this._audio.currentTime=0,this._playTriggered=0,this.playing=!1,e&&e()}},function(e,t){e.exports={NO_ACTION:16010,LEVEL_UP:16062,OPEN_INVENTORY:16026,CLOSE_INVENTORY:16027,ITEM_IN_INVENTORY_1:16040,ITEM_IN_INVENTORY_2:16041,ITEM_IN_INVENTORY_3:16042,DROP_ITEM_1:16043,EQUIP_BOOTS:16028,EQUIP_WRISTBAND:16029,EQUIP_CLOTH_1:16030,EQUIP_CLOTH_2:16031,EQUIP_NECKLACE:16036,EQUIP_ACCESORIES:16037,EQUIP_WEAPON:16038,EQUIP_HAND:16039,EQUIP_DOFUS:16091,EQUIP_PET:16092,OPTIONS_OPEN:16023,OPTIONS_CLOSE:16024,INTRO_FIGHT:16067,OUTRO_FIGHT:16068,READY_TO_FIGHT:16070,END_TURN:16069,PLAYER_TURN:16077,NPC_TURN:16078,FIGHT_POSITION:16071,OK_BUTTON:16002,PLAY_BUTTON:16003,GEN_BUTTON:16004,SPEC_BUTTON:16005,CHECKBOX_CHECKED:16006,CHECKBOX_UNCHECKED:16007,TAB:16009,ROLLOVER:16010,SCROLL_UP:16014,SCROLL_DOWN:16015,CHARACTER_SELECTION_RIGHT:16079,CHARACTER_SELECTION_LEFT:16080,DELETE_CHARACTER:16081,POPUP_YES:16082,POPUP_NO:16083,CANCEL_BUTTON:16084,FRIENDS:16085,CHARACTER_CREATION:16086,BANNER_SPELL_TAB:16087,BANNER_EMOTE_TAB:16089,PLUS_BUTTON:16090,STORE_SELL_BUTTON:16099,STORE_BUY_BUTTON:16100,VALID_KAMA_EXCHANGE:16101,MERCHANT_REMOVE_SELL_BUTTON:16096,DRAG_START:16053,DRAG_END:16059,CHALLENGE_CHECKPOINT:16073,LITTLE_OBJECTIVE:16074,POPUP_INFO:16011,WINDOW_OPEN:16012,WINDOW_CLOSE:16013,OPEN_DOCUMENT:16102,CLOSE_DOCUMENT:16103,TURN_PAGE_DOCUMENT_1:16104,TURN_PAGE_DOCUMENT_2:16105,TURN_PAGE_DOCUMENT_3:16106,BACK_TO_BEGINNING_DOCUMENT:16108,GUILD_CHAT_MESSAGE:16109,RED_CHAT_MESSAGE:16114,MOUNT_HURT:1412506,OPEN_MOUNT_UI:1412505,OPEN_TRANSACTION_WINDOW:16093,CLOSE_TRANSACTION_WINDOW:16094,LEFT_TO_RIGHT_SWITCH:16097,RIGHT_TO_LEFT_SWITCH:16098,NEW_TIPS:16112,NEW_REWARD:16118}},function(e,t,i){function n(){return n.isAvailable()?(s.call(this),this.media=null,this.uri=null,this.errorOccured=!1,void(r||(window.Media.shouldReleaseOnMemoryWarning(!1),r=!0))):console.error(new Error("SoundCordova: cordova media plugin is not available"))}var o=i(191).inherits,s=i(259).ISound,a=i(185),r=!1,l=!1;o(n,s),e.exports=n,n.isAvailable=function(){return a.isCordova&&window.Media},n.prototype.setVolume=function(e){s.prototype.setVolume.call(this,e),this.media&&this.media.setVolume(e)},n.prototype._load=function(){function e(){}function t(e){var t=!o.errorOccured,i=a.isIOSApp&&window.navigator.userAgent.indexOf("iPad; CPU OS 8_0")!==-1;3===e.code&&i&&(l&&(t=!1),l=!0),o._loading&&o._finalizeLoad(e),o.errorOccured||o.unload(),o.errorOccured=!0,t&&console.error("SoundCordova: "+JSON.stringify(e)+", file: "+o.uri)}function i(){if(!o.usedMemory){var e=Number(o.media.getDuration());!e||e<0||(o.usedMemory=e,o.audioManager.usedMemory+=e)}}function n(n){o.uri=n,o.media=new window.Media(n,e,t,i),o._loading&&!o.errorOccured&&o._finalizeLoad(null)}var o=this;if(o.errorOccured)return this._finalizeLoad("previouslyFailed");var s=o.audioManager.settings.getFileUri,r=o.audioManager.settings.audioPath;if(s.length>2)s(r,o.id,function(e,t){return e?o._finalizeLoad(e):void n(t)});else try{var c=s(r,o.id);if(!c)return o._finalizeLoad("emptyUri");n(c)}catch(u){o._finalizeLoad(u)}},n.prototype.unload=function(){if(s.prototype.unload.call(this)){if(!this.media)return;this.media.stop(),this.media.release()}},n.prototype._play=function(){this.media&&(this.errorOccured||(this.media.setVolume(this.volume),this.loop&&this.playing||(this.media.seekTo(0),this.media.play({numberOfLoops:this.loop?0:1,playAudioWhenScreenIsLocked:!1}),this.playing=!0)))},n.prototype.stop=function(e){return this.media?(this.media.stop(),s.prototype.stop.call(this,e)):e&&e()}},function(e,t,i){function n(){return u.isAndroidApp&&window.cordova.plugins.Yanap}function o(){return n()?(c.call(this),this.audioMode=null,this.media=null,this.uri=null,void(this.errorOccured=!1)):console.error(new Error("YanapAudioInstance: Yanap plugin is not available"))}function s(){o.call(this),this.audioMode=window.cordova.plugins.Yanap.AUDIO_TYPE.LOOP}function a(){o.call(this),this.audioMode=window.cordova.plugins.Yanap.AUDIO_TYPE.MUSIC}function r(){o.call(this),this.audioMode=window.cordova.plugins.Yanap.AUDIO_TYPE.SOUND}var l=i(191).inherits,c=i(259).ISound,u=i(185),d=12e3;l(o,c),o.prototype.setVolume=function(e){c.prototype.setVolume.call(this,e),this.media&&this.media.setVolume(e,e)},o.prototype._load=function(){function e(e){var t=!n.errorOccured;n._loading&&n._finalizeLoad(e),n.errorOccured||n.unload(),n.errorOccured=!0,t&&console.error("SoundYanap: "+JSON.stringify(e)+", file: "+n.uri)}function t(t,i){if(t===window.cordova.plugins.Yanap.AUDIO_INSTANCE_STATUS.ERROR)return e(i);if(!n.usedMemory&&n.media&&n.media.fileLength){var o=~~n.media.fileLength/d;o<=0||(n.usedMemory=o,n.audioManager.usedMemory+=o)}}function i(e){n.uri=e,n.media=new window.cordova.plugins.Yanap.AudioInstance(n.audioMode,t),window.wizAssets&&!window.wizAssets.initialize&&(e=e.substr(e.indexOf("/audio/")+1)),n.media.load(e),n._finalizeLoad(null)}var n=this;if(n.errorOccured)return this._finalizeLoad("previouslyFailed");var o=n.audioManager.settings.getFileUri,s=n.audioManager.settings.audioPath;if(o.length>2)o(s,n.id,function(e,t){return e?n._finalizeLoad(e):void i(t)});else try{var a=o(s,n.id);if(!a)return n._finalizeLoad("emptyUri");i(a)}catch(r){n._finalizeLoad(r)}},o.prototype.unload=function(){if(c.prototype.unload.call(this)){if(!this.media)return;this.media.stop(),this.media.release()}},o.prototype._play=function(){this.media&&(this.errorOccured||(this.media.setVolume(this.volume,this.volume),this.media.play(),this.playing=!0))},o.prototype.stop=function(e){return this.media?(this.media.stop(),c.prototype.stop.call(this,e)):e&&e()},l(s,o),l(a,o),l(r,o),e.exports={LoopYanap:s,MusicYanap:a,SoundYanap:r,isAvailable:n}},function(e,t,i){function n(){s.call(this),this._context=a.ROLE_PLAY,this._setMode(),r.on("GameContextCreateMessage",this.changeGameContext.bind(this))}var o=i(191).inherits,s=i(194).EventEmitter,a=i(270),r=i(271);o(n,s),n.prototype.changeGameContext=function(e){this._context=e.context,this._setMode(),this.emit("gameContextChanged",this._context)},n.prototype._setMode=function(){this.isRoleplayMode=this._context===a.ROLE_PLAY,this.isFightMode=this._context===a.FIGHT},e.exports=new n},function(e,t){e.exports={ROLE_PLAY:1,FIGHT:2}},function(e,t,i){function n(e){var i=l.createMessage(e);return i._messageType?void t.emit(i._messageType,i):void console.error(new Error("emitMessage: missing message type for "+e._messageType))}function o(e){if(0!==e.length&&!g){var t=e.shift();window.setTimeout(function(){o(e),n(t)},0)}}var s=i(209).EventEmitter,a=i(211),r=i(272).monitor,l=i(273);t=e.exports=new s,t.setMaxListeners(0);var c,u,d,h,p,m,f,g,_,v=2e4,y={BasicLatencyStatsMessage:!0,BasicPingMessage:!0},b=[],w=0,M=[],T=!1;t.lockMessages=function(){T=!0},t.lastReceivedMessage=null,t.unlockMessages=function(){if(T!==!1){T=!1;var e=M.slice();o(e),M.length=0}},t.connect=function(e){if(c)return c.destroy(),c=null,setTimeout(function(){t.connect(e)},0);var i=window.Primus,o=window.Config.maxReconnectionAttempt||10;f=!1,g=!1,_=null,d=!0,u=!1,m=!0,c=new i(e,{manual:!0,strategy:"disconnect,timeout",reconnect:{max:5e3,min:500,retries:o}}),r.startListening(),c.on("open",function(){if(c!==this)return console.warn("onOpen - Ignoring event: possible missing call to Primus#destroy");if(f=!1,t.emit("open",u),u&&h&&Date.now()<p){for(var e={},i=0,n={},o=0;o<h.length;o++){var s=h[o];if("message"===s.type){try{var a=JSON.parse(s.data);if("sendMessage"!==a.call){n["call-"+a.call]=1;continue}var r=a.data.type;if(y[r])continue;i++,e[r]=1}catch(l){console.error("Message to be resent is not JSON: "+s.data.toString().substring(0,100))}c.socket.write(s.data,s.options)}else n[s.type]=1}i&&console.error("Resent "+h.length+" previously unsent messages. Types: {"+Object.keys(e).join(",")+"} Skipped: {"+Object.keys(n).join(",")+"}")}h=null,u=!0}),c.on("offline",function(){m&&(m=!1,d&&t.emit("offline"))}),c.on("online",function(){return c!==this?console.warn("onOnline - Ignoring event: possible missing call to Primus#destroy"):void(m||(m=!0,d&&(t.emit("online"),c.readyState!==i.CLOSED||c.recovery.reconnecting()||window.setTimeout(function(){c.readyState!==i.CLOSED||c.recovery.reconnecting()||c.open()},0))))}),c.on("end",function(){m&&(c=null,f?_&&t.connect(_):(d=!1,t.disconnect("SOCKET_LOST")))}),c.on("reconnect scheduled",function(i){if(h=null,a.isFeatureOn("decoRecoResend")){
var n=d&&c.socket&&c.socket.writeBuffer;n&&n.length&&(h=n,p=Date.now()+v)}t.emit("reconnecting",i.attempt,e)}),c.on("data",function(e){if(!g)if(r.receiving(),"SequenceStartMessage"===e._messageType&&(w+=1),w>0){if(b.push(e),"SequenceEndMessage"===e._messageType&&(w-=1,w<=0)){var i={_messageType:"messageSequence",sequence:b};T?M.push(i):t.emit("messageSequence",i),b=[],w=0}}else t.emit("data",e),t.lastReceivedMessage=e._messageType,T?M.push(e):n(e)}),c.on("error",function(e){t.emit("error",e)}),c.open()},t.close=function(){f=!0,d=!1,h=null,c&&(c.destroy(),c=null)},t.switchToGame=function(e){t.disconnect("SWITCHING_TO_GAME"),_=e},t.disconnect=function(e){g||(e=e||"CLIENT_CLOSING",console.info("connectionManager.disconnect: reason="+e),"SOCKET_LOST"!==e&&c&&(t.send("disconnecting",e),f=!0),"SWITCHING_TO_GAME"!==e&&(g=!0,t.close(),t.emit("disconnect",e)))},t.sendMessage=function(e,i){t.send("sendMessage",{type:e,data:i})},t.send=function(e,i){if(!c)return console.warn("Client trying to send while primus is null for call: "+e);r.sending(e,i);var n={call:e,data:i};c.write(n),t.emit("send",{call:e,data:n}),t.emit("send:"+e,n)}},function(e,t){function i(){this.lastReceivingTime=0,this.lastPingSent=0,this.isListening=!1,this.timeout=null,this.alarmLevel=r}function n(e){e.timeout=null,e._sendPing();var t=e.lastReceivingTime;window.setTimeout(function(){e.lastReceivingTime===t&&window.gui.connectionSplashScreen.onStateChange("UNSTABLE",e.alarmLevel)},s)}var o=1e3,s=300,a=1e3,r=0,l=1,c=2,u={AchievementRewardRequestMessage:l,AllianceChangeGuildRightsMessage:l,AllianceFactsRequestMessage:l,AllianceInsiderInfoRequestMessage:l,AllianceKickRequestMessage:l,BasicWhoIsRequestMessage:l,ChangeMapMessage:l,ChatClientMultiMessage:l,ChatClientPrivateMessage:l,CharacterCreationRequestMessage:c,CharacterDeletionRequestMessage:l,CharacterNameSuggestionRequestMessage:l,CharacterSelectionMessage:c,ExchangeBidHouseBuyMessage:c,ExchangeBidHouseListMessage:l,ExchangeBidHouseTypeMessage:l,ExchangeBuyMessage:c,ExchangeHandleMountStableMessage:l,ExchangeObjectMoveMessage:l,ExchangeObjectMovePricedMessage:l,ExchangePlayerRequestMessage:l,ExchangeRequestOnShopStockMessage:l,ExchangeSellMessage:c,ExchangeShowVendorTaxMessage:l,ExchangeStartAsVendorMessage:c,FriendAddRequestMessage:l,FriendDeleteRequestMessage:l,GameMapMovementRequestMessage:l,GameRolePlayArenaRegisterMessage:l,GameRolePlayArenaUnregisterMessage:l,GameRolePlayPlayerFightRequestMessage:l,GuildChangeMemberParametersMessage:l,GuildCharacsUpgradeRequestMessage:c,GuildFactsRequestMessage:l,GuildGetInformationsMessage:l,GuildHouseTeleportRequestMessage:l,GuildKickRequestMessage:l,GuildPaddockTeleportRequestMessage:l,GuildSpellUpgradeRequestMessage:c,HouseGuildRightsViewMessage:l,HouseGuildShareRequestMessage:l,HouseKickRequestMessage:l,HouseLockFromInsideRequestMessage:l,IgnoredAddRequestMessage:l,InteractiveUseRequestMessage:l,JobAllowMultiCraftRequestSetMessage:l,JobCrafterDirectoryDefineSettingsMessage:l,LeaveDialogRequestMessage:l,LockableChangeCodeMessage:l,MountFeedRequestMessage:l,MountReleaseRequestMessage:l,MountRenameRequestMessage:l,MountSetXpRatioRequestMessage:l,MountSterilizeRequestMessage:l,MountToggleRidingRequestMessage:l,NpcDialogReplyMessage:l,NpcGenericActionRequestMessage:l,ObjectSetPositionMessage:l,ObjectUseMessage:c,OrnamentSelectRequestMessage:l,PartyAbdicateThroneMessage:l,PartyAcceptInvitationMessage:l,PartyCancelInvitationMessage:l,PartyInvitationArenaRequestMessage:l,PartyInvitationRequestMessage:l,PartyKickRequestMessage:l,PartyLeaveRequestMessage:l,PrismSettingsRequestMessage:l,ServerSelectionMessage:c,SetEnableAVARequestMessage:l,SetEnablePVPRequestMessage:l,SpellUpgradeRequestMessage:c,StatsUpgradeRequestMessage:c,TitleSelectRequestMessage:l},d={socialDataRequest:l};t.monitor=new i,t.WARNING=l,t.BLOCKING=c,i.prototype.startListening=function(){this.isListening||(this.isListening=!0,window.dofus.connectionManager.on("BasicPongMessage",this._gotPong.bind(this)))},i.prototype.receiving=function(){this.lastReceivingTime=Date.now(),this.timeout&&(this.alarmLevel=r,this.timeout=window.clearTimeout(this.timeout))},i.prototype.sending=function(e,t){var i;i="sendMessage"===e?u[t.type]:d[e],i&&this._monitorCommandDelay(i)},i.prototype._monitorCommandDelay=function(e){this.alarmLevel=Math.max(e,this.alarmLevel),this.timeout||(this.timeout=window.setTimeout(n,o,this))},i.prototype._sendPing=function(){Date.now()-this.lastPingSent>=a&&(window.dofus.sendMessage("BasicPingMessage",{quiet:!0}),this.lastPingSent=Date.now())},i.prototype._gotPong=function(){this.lastPingSent=0,window.gui.connectionSplashScreen.onStateChange("CONNECTED")}},function(e,t,i){var n=i(274);t.createMessage=function(e){switch(e._messageType){case"CharacterStatsListMessage":case"FighterStatsListMessage":return e.stats=new n(e.stats),e;case"SlaveSwitchContextMessage":return e.slaveStats=new n(e.slaveStats),e;default:return e}}},function(e,t,i){function n(e){this._type="CharacterCharacteristicsInformations",this.alignmentInfos=e.alignmentInfos,this.agility=new o(e.agility),this.chance=new o(e.chance),this.intelligence=new o(e.intelligence),this.strength=new o(e.strength),this.wisdom=new o(e.wisdom),this.actionPoints=new o(e.actionPoints),this.airDamageBonus=new o(e.airDamageBonus),this.airElementReduction=new o(e.airElementReduction),this.airElementResistPercent=new o(e.airElementResistPercent),this.allDamagesBonus=new o(e.allDamagesBonus),this.criticalDamageBonus=new o(e.criticalDamageBonus),this.criticalDamageReduction=new o(e.criticalDamageReduction),this.criticalHit=new o(e.criticalHit),this.criticalHitWeapon=new o(e.criticalHitWeapon),this.criticalMiss=new o(e.criticalMiss),this.damagesBonusPercent=new o(e.damagesBonusPercent),this.dodgePALostProbability=new o(e.dodgePALostProbability),this.dodgePMLostProbability=new o(e.dodgePMLostProbability),this.earthDamageBonus=new o(e.earthDamageBonus),this.earthElementReduction=new o(e.earthElementReduction),this.earthElementResistPercent=new o(e.earthElementResistPercent),this.fireDamageBonus=new o(e.fireDamageBonus),this.fireElementReduction=new o(e.fireElementReduction),this.fireElementResistPercent=new o(e.fireElementResistPercent),this.healBonus=new o(e.healBonus),this.initiative=new o(e.initiative),this.movementPoints=new o(e.movementPoints),this.neutralDamageBonus=new o(e.neutralDamageBonus),this.neutralElementReduction=new o(e.neutralElementReduction),this.neutralElementResistPercent=new o(e.neutralElementResistPercent),this.PAAttack=new o(e.PAAttack),this.permanentDamagePercent=new o(e.permanentDamagePercent),this.PMAttack=new o(e.PMAttack),this.probationTime=new o(e.probationTime),this.prospecting=new o(e.prospecting),this.pushDamageBonus=new o(e.pushDamageBonus),this.pushDamageReduction=new o(e.pushDamageReduction),this.pvpAirElementReduction=new o(e.pvpAirElementReduction),this.pvpAirElementResistPercent=new o(e.pvpAirElementResistPercent),this.pvpEarthElementReduction=new o(e.pvpEarthElementReduction),this.pvpEarthElementResistPercent=new o(e.pvpEarthElementResistPercent),this.pvpFireElementReduction=new o(e.pvpFireElementReduction),this.pvpFireElementResistPercent=new o(e.pvpFireElementResistPercent),this.pvpNeutralElementReduction=new o(e.pvpNeutralElementReduction),this.pvpNeutralElementResistPercent=new o(e.pvpNeutralElementResistPercent),this.pvpWaterElementReduction=new o(e.pvpWaterElementReduction),this.pvpWaterElementResistPercent=new o(e.pvpWaterElementResistPercent),this.range=new o(e.range),this.reflect=new o(e.reflect),this.summonableCreaturesBoost=new o(e.summonableCreaturesBoost),this.summonableMaximumBombs=new o(e.summonableMaximumBombs),this.tackleBlock=new o(e.tackleBlock),this.tackleEvade=new o(e.tackleEvade),this.trapBonus=new o(e.trapBonus),this.trapBonusPercent=new o(e.trapBonusPercent),this.vitality=new o(e.vitality),this.waterDamageBonus=new o(e.waterDamageBonus),this.waterElementReduction=new o(e.waterElementReduction),this.waterElementResistPercent=new o(e.waterElementResistPercent),this.weaponDamagesBonusPercent=new o(e.weaponDamagesBonusPercent),this.dealtDamageMultiplierMelee=new o(e.dealtDamageMultiplierMelee),this.receivedDamageMultiplierMelee=new o(e.receivedDamageMultiplierMelee),this.dealtDamageMultiplierDistance=new o(e.dealtDamageMultiplierDistance),this.receivedDamageMultiplierDistance=new o(e.receivedDamageMultiplierDistance),this.dealtDamageMultiplierWeapon=new o(e.dealtDamageMultiplierWeapon),this.receivedDamageMultiplierWeapon=new o(e.receivedDamageMultiplierWeapon),this.dealtDamageMultiplierSpells=new o(e.dealtDamageMultiplierSpells),this.receivedDamageMultiplierSpells=new o(e.receivedDamageMultiplierSpells),this.spellModifications=[];for(var t=0;t<e.spellModifications.length;t+=1){var i=e.spellModifications[t];this.spellModifications.push(new s(i))}this.actionPointsCurrent=e.actionPointsCurrent,this.additionnalPoints=e.additionnalPoints,this.energyPoints=e.energyPoints,this.experience=e.experience,this.experienceLevelFloor=e.experienceLevelFloor,this.experienceNextLevelFloor=e.experienceNextLevelFloor,this.kamas=e.kamas,this.lifePoints=e.lifePoints,this.maxEnergyPoints=e.maxEnergyPoints,this.maxLifePoints=e.maxLifePoints,this.movementPointsCurrent=e.movementPointsCurrent,this.spellsPoints=e.spellsPoints,this.statsPoints=e.statsPoints}var o=i(275),s=i(276),a=i(207).logger,r=i(277),l=["vitality","wisdom","strength","intelligence","chance","agility"];e.exports=n,n.prototype.getRemainingAdditionalPts=function(){if(this.additionnalPoints<=0)return 0;for(var e=!1,t=0;t<l.length;t+=1){var i=l[t],n=this[i];if(n){if(n.getAdditionalPts()<r.MAX_ADDITIONNAL_PER_CARAC){e=!0;break}}else a.error("stat missing for",i)}return e?this.additionnalPoints:0}},function(e,t){function i(e){this._type="CharacterBaseCharacteristic",this._base=0,this._objectsAndMountBonus=0,this._alignGiftBonus=0,this._contextModif=0,this._additionnal=0,e&&this.setPts(e)}Object.defineProperty(i.prototype,"base",{get:function(){throw new Error('CharacterBaseCharacteristic: should not get that way for "base"')},set:function(){throw new Error('CharacterBaseCharacteristic: should not set that way for "base"')}}),Object.defineProperty(i.prototype,"objectsAndMountBonus",{get:function(){throw new Error('CharacterBaseCharacteristic: should not get that way for "objectsAndMountBonus"')},set:function(){throw new Error('CharacterBaseCharacteristic: should not set that way for "objectsAndMountBonus"')}}),Object.defineProperty(i.prototype,"alignGiftBonus",{get:function(){throw new Error('CharacterBaseCharacteristic: should not get that way for "alignGiftBonus"')},set:function(){throw new Error('CharacterBaseCharacteristic: should not set that way for "alignGiftBonus"')}}),Object.defineProperty(i.prototype,"contextModif",{get:function(){throw new Error('CharacterBaseCharacteristic: should not get that way for "contextModif"')},set:function(){throw new Error('CharacterBaseCharacteristic: should not set that way for "contextModif"')}}),Object.defineProperty(i.prototype,"additionnal",{get:function(){throw new Error('CharacterBaseCharacteristic: should not get that way for "additionnal"')},set:function(){throw new Error('CharacterBaseCharacteristic: should not set that way for "additionnal"')}}),e.exports=i,i.prototype.setPts=function(e){void 0!==e.base&&(this._base=e.base||0),void 0!==e.objectsAndMountBonus&&(this._objectsAndMountBonus=e.objectsAndMountBonus||0),void 0!==e.alignGiftBonus&&(this._alignGiftBonus=e.alignGiftBonus||0),void 0!==e.contextModif&&(this._contextModif=e.contextModif||0),void 0!==e.additionnal&&(this._additionnal=e.additionnal||0)},i.prototype.getContextModif=function(){return this._contextModif||0},i.prototype.getBasePts=function(){return(this._base||0)+(this._additionnal||0)},i.prototype.getBaseWithoutAdditionalPts=function(){return this._base||0},i.prototype.getEquipmentPts=function(){return this._objectsAndMountBonus||0},i.prototype.getAlignGiftPts=function(){return this._alignGiftBonus||0},i.prototype.getAdditionalPts=function(){return this._additionnal||0},i.prototype.getAllValues=function(){return{base:this.getBaseWithoutAdditionalPts(),objectsAndMountBonus:this.getEquipmentPts(),alignGiftBonus:this.getAlignGiftPts(),contextModif:this.getContextModif(),additionnal:this.getAdditionalPts()}},i.prototype.getBonusPts=function(){return(this._alignGiftBonus||0)+(this._contextModif||0)},i.prototype.getTotalStat=function(){return this.getBasePts()+this.getEquipmentPts()+this.getBonusPts()}},function(e,t,i){function n(e){e=e||{},this._type="CharacterSpellModification",this.spellId=e.spellId||0,this.modificationType=e.modificationType||0,this.value=new o(e.value)}var o=i(275);e.exports=n},function(e,t){e.exports={MAP_CELL_COUNT:560,MAX_LEVEL:200,MAX_GUILD_LEVEL:200,MAX_MOUNT_LEVEL:100,MAX_CHAT_LEN:512,USER_MAX_CHAT_LEN:256,MAX_SOCIALINFO_SHORT_LEN:200,MAX_SOCIALINFO_LEN:512,MIN_LOGIN_LEN:3,MAX_LOGIN_LEN:50,MIN_PLAYER_NAME_LEN:2,MAX_PLAYER_NAME_LEN:20,MIN_NICK_LEN:2,MAX_NICK_LEN:30,MIN_GUILDNAME_LEN:3,MAX_GUILDNAME_LEN:30,MIN_ALLIANCENAME_LEN:3,MAX_ALLIANCENAME_LEN:30,MIN_ALLIANCETAG_LEN:3,MAX_ALLIANCETAG_LEN:5,MAX_PLAYER_COLOR:5,MAX_ENTITY_COLOR:8,MAX_PLAYERS_PER_TEAM:8,MAX_MEMBERS_PER_PARTY:8,MAX_GUESTS_PER_PARTY:7,MAX_MEMBERS_PER_ARENA_PARTY:5,MAX_MONSTERS_IN_GROUP_ON_MAP:16,MAX_CHAT_OBJECT_REF:16,NOT_EQUIPED:63,MAX_EQUIPED:255,MAX_JOBS_PER_CHARACTER:6,MAX_CRAFT_SLOT:9,MAX_JOB_LEVEL:100,MAX_HONOR:2e4,MAX_SHORTCUT:99,MAX_ARENA_RANK:2300,CHAR_MIN_LEVEL_ARENA:50,CHAR_MIN_LEVEL_RIDE:60,MAX_DUNGEON_REGISTER:10,MIN_RIDE_NAME_LEN:0,MAX_RIDE_NAME_LEN:16,MAX_EFFECTS_COUNT:100,MAX_LOCKABLE_CODE_LEN:8,MAX_PRESET_ITEM_COUNT:24,MIN_OBJ_COUNT_BY_XFERT:1,MAX_OBJ_COUNT_BY_XFERT:1e3,MAX_OBJECT_EFFECT_STRING_LEN:30,MAX_PLAYER_OR_ACCOUNT_NAME_LEN:31,MAX_ADDITIONNAL_PER_CARAC:100,MAX_NUMBER:2e9,MAX_NUMBER_LEN:13}},function(e,t){e.exports={"audio/10001.mp3":!0,"audio/1400460.mp3":!0,"audio/1400461.mp3":!0,"audio/1400462.mp3":!0,"audio/1400463.mp3":!0,"audio/1400464.mp3":!0,"audio/1400497.mp3":!0,"audio/1400504.mp3":!0,"audio/1400537.mp3":!0,"audio/1417203.mp3":!0,"audio/14185010.mp3":!0,"audio/17999.mp3":!0,"audio/210090.mp3":!0,"audio/210091.mp3":!0,"audio/210092.mp3":!0,"audio/210093.mp3":!0,"audio/210096.mp3":!0,"audio/210097.mp3":!0,"audio/210098.mp3":!0,"audio/210099.mp3":!0,"audio/210101.mp3":!0,"audio/210102.mp3":!0,"audio/21121.mp3":!0,"audio/3001211010.mp3":!0,"audio/31000000032.mp3":!0,"audio/3100000046.mp3":!0,"audio/3101012101.mp3":!0,"audio/3101012102.mp3":!0,"audio/3101012103.mp3":!0,"audio/3101061102.mp3":!0,"audio/3101061103.mp3":!0,"audio/3101062102.mp3":!0,"audio/3101062103.mp3":!0,"audio/3101170201.mp3":!0,"audio/3101365201.mp3":!0,"audio/3101472001.mp3":!0,"audio/3101472002.mp3":!0,"audio/3101472003.mp3":!0,"audio/3101472004.mp3":!0,"audio/3101472005.mp3":!0,"audio/3101472006.mp3":!0,"audio/3101653001.mp3":!0,"audio/3101653002.mp3":!0,"audio/3101653003.mp3":!0,"audio/3101653004.mp3":!0,"audio/3101653201.mp3":!0,"audio/3101696001.mp3":!0,"audio/3101830001.mp3":!0,"audio/3101830002.mp3":!0,"audio/3101830003.mp3":!0,"audio/3101830004.mp3":!0,"audio/3101830005.mp3":!0,"audio/3101830006.mp3":!0,"audio/40001326001.mp3":!0,"audio/40001642002.mp3":!0,"audio/4000216001.mp3":!0}},function(e,t,i){function n(e,t){e=e||{};var i={className:"closeButton",sound:"CANCEL_BUTTON"};for(var n in i)void 0===e[n]&&(e[n]=i[n]);s.call(this,e,t)}var o=i(191).inherits,s=i(246);o(n,s),e.exports=n},function(e,t){e.exports={NPC_SHOP:0,PLAYER_TRADE:1,NPC_TRADE:2,CRAFT:3,DISCONNECTED_VENDOR:4,STORAGE:5,SHOP_STOCK:6,TAXCOLLECTOR:8,NPC_MODIFY_TRADE:9,BIDHOUSE_SELL:10,BIDHOUSE_BUY:11,MULTICRAFT_CRAFTER:12,MULTICRAFT_CUSTOMER:13,JOB_INDEX:14,MOUNT:15,MOUNT_STABLE:16,NPC_RESURECT_PET:17,NPC_TRADE_MOUNT:18,REALESTATE_HOUSE:19,REALESTATE_FARM:20,BANK:23,TRASHBIN:24,ALLIANCE_PRISM:25}},function(e,t,i){function n(e,t){if("number"==typeof e)return e;var i=e.length;return"%"===e[i-1]?t*e.substr(0,i-1)/100:("px"===e.substr(i-2)&&(e=e.substr(0,i-2)),e*=1)}function o(e,t,i){return e=e.substr(1),e?t+n(e,i):t}function s(e,t,i){var n=(t-i)/2;return o(e,n,t)}function a(e,t,i){switch(e[0]){case"c":return s(e,t,i);case"w":return o(e,t,t);case"h":return o(e,t,t);default:return n(e,t)}}var r=i(183).dimensions;t.buildWindowStyleFromInfo=function(e){var t=0,i=0,n=0,o=0,s=r.windowFullScreenWidth||r.screenWidth,l=r.windowFullScreenHeight||r.screenHeight;if(e.isFullScreen&&(s=r.screenWidth,l=r.screenHeight),e.mustAvoidToolbar&&(s=r.screenExceptToolbar.width,l=r.screenExceptToolbar.height),e.width){t=a(e.width,s);var c=e.maxWidth||s;t=c&&c<t?c:t}if(e.height){i=a(e.height,l);var u=Math.min(e.maxHeight||l,l);i=Math.min(i,u)}if(e.minHeight){var d=a(e.minHeight,l);i=Math.max(d,i)}if(e.minWidth){var h=a(e.minWidth,l);t=Math.max(h,t)}var p=e.hasOwnProperty("left");if((p||e.hasOwnProperty("x"))&&(n=a(p?e.left:e.x,s,t)),e.hasOwnProperty("right")){var m=a(e.right,s,t);t?n=s-m-t:t=s-m-n}var f=e.hasOwnProperty("top");if((f||e.hasOwnProperty("y"))&&(o=a(f?e.top:e.y,l,i)),e.bottom){var g=a(e.bottom,l,i);i?o=l-g-i:i=l-g-o}return n=Math.min(s-t,Math.max(0,n)),o=Math.max(0,Math.min(l-i,o)),{x:Math.round(n),y:Math.round(o),width:Math.round(t),height:Math.round(i)}}},function(e,t,i){function n(e,t,i){var n=Date.now(),o=r.getValue(e,0,!0);n-o<f||(window.gui.openSimplePopup(t,u("ui.popup.warning")),console.error("[INFO]",i,'Drop popup shown for "'+window.navigator.userAgent+'"'),r.setValue(e,n,1,!0))}function o(){n(g,u("tablet.ui.popup.drop.android"),"Android")}function s(e){if(e.reason){if(e.reason===p.INCOMPATIBLE_APP_VERSION){var t,i;return c.isAndroidApp?(t=u("tablet.ui.popup.accessDenied.incompatibleAppAndroid"),i="market://details?id=com.ankama.dofustouch"):c.isIOSApp?(t=u("tablet.ui.popup.accessDenied.incompatibleAppIOS"),i="https://itunes.apple.com/app/id1041406978"):t=u("tablet.ui.popup.accessDenied.incompatibleApp"),void window.gui.openConfirmPopup({title:u("ui.popup.accessDenied"),message:t,cb:function(e){e&&i&&window.open(i,"_system","location=no")}})}if(e.reason===p.INCOMPATIBLE_BUILD_VERSION)return t=u("tablet.ui.popup.accessDenied.incompatibleBuild"),void window.gui.openConfirmPopup({title:u("ui.popup.accessDenied"),message:t,noDisable:!0,cb:function(e){e&&window.location.reload()}});window.gui.openSimplePopup(d(e),u("ui.popup.accessDenied"))}else window.gui.openSimplePopup(u("ui.popup.connectionFailed.text")),console.warn("login error without reason:",e)}function a(e,i,n){function a(a,l){return a?(window.gui.openSimplePopup(h(a),u("ui.popup.accessDenied")),n(a)):(window.dofus.setCredentials(i.account||l.username,l.token),window.gui.playerData.setLoginName(l.username),t.connectMethod=e,void window.dofus.login(function(e){return m=!1,e?(window.dofus.disconnect(),s(e)):(c.isAndroidLessThanFive&&o(),r.delValue("lastServerId"),n())}))}if(i=i||{},n=n||function(e){if(e)return console.error(e)},window.Config.byPassToken)return void a(null,{username:i.account,token:i.password});if(i.account){var d=i.account,p=d.split("|"),f=2===p.length;f&&(d=p[0]),window.gui.playerData.setForcedAccount(f),l.login(d,i.password,i.save,a)}else l.login(a)}var r=i(195),l=i(283),c=i(185),u=i(29).getText,d=i(289),h=i(291),p=i(292),m=(i(290),!1),f=864e6,g="androidDrop4.4";t.characterId=null,t.connectMethod=null,t.startLoginProcessWithPassword=function(e,t,i,n,o){a(e,{account:t,password:i,save:n},o)},t.startLoginProcessWithoutPassword=function(e,t){a(e,{},t)},t.reconnectByCharId=function(e){t.characterId=e,m=!0,window.dofus.disconnect(),window.gui._shutDownUI(),t.startLoginProcessWithoutPassword("characterId")},t.selectServer=function(){console.error(new Error("deprecated method"))},t.backToLogin=function(){m||window.gui.loginScreen.backToLogin()},t.goBackToSelectionOf=function(e){window.gui.splashScreen.show(),window.gui.loginScreen.hide(),m=!0,window.dofus.disconnect();var i="character"===e?"lastServer":null;t.startLoginProcessWithoutPassword(i)},t.onFullReconnection=function(){window.gui.splashScreen.show(),window.gui.loginScreen.hide(),t.connectMethod="lastCharacter"}},function(e,t,i){function n(e){try{return window.localStorage.setItem("HAAPI_USERNAME",e),o=e,e}catch(t){return!1}}var o,s=i(195),a=i(284),r=i(285),l=i(286),c=new l,u=7e3;t.hasKeyFromStorage=function(){return Boolean(r.getHaapiKeyFromStorage())},t.hasKey=function(){return Boolean(r.getHaapiKey())},t.resetHaapiKey=function(){r.setHaapiKey(null,{save:!0})},t.getHaapiUsername=function(){return o?o:o=window.localStorage.getItem("HAAPI_USERNAME")},t.createGuest=function(e,t){if(window.Config.disabledFeatures.guest)return t({error:"createGuest: guest is disabled"});var i={game:window.Config.haapi.id,lang:window.Config.language,"web_params[]":"",captcha_token:e};a.open({uri:window.Config.haapi.url+"/Account/CreateGuest",requestType:"GET",timeout:u,params:i},function(e,i){var n={};if(i.content)try{n=JSON.parse(i.content)}catch(o){return t({error:"createGuest: unable to parse JSON ("+i.content+")"})}if(e)return t({error:e+" (status code: "+i.xhr.status+")",userError:i.xhr.status&&i.xhr.status>=600&&n?n.text:null});var a={login:n.login,password:i.headers&&i.headers["x-password"]};return a.login&&a.password?(s.setValue("guestAccount",a,1),t(null,a)):t({error:"createGuest: wrong credential (login:"+a.login+"/password:"+a.password+")"})})},t.validateGuest=function(e,t){return window.Config.disabledFeatures.guest?t(new Error("validateGuest: guest is disabled")):(e.lang=window.Config.language,void r.fetch("/haapi/validateGuest",e,t))},t.registerOpenRequest=function(e){var t={lang:window.Config.language};r.fetch("/haapi/registerOpenRequest",t,e)},t.createApiKey=function(e,t){r.postDirectly("/Api/CreateApiKey",e,t)},t.createToken=function(e){r.fetchDirectly("/Account/CreateToken",{game:window.Config.haapi.id},e)},t.login=function(e,i,o,s){function a(t,i){return t?s(t):(n(e),i.username=e,s(null,i))}return 1===arguments.length?(s=e,e=t.getHaapiUsername(),r.getHaapiKey()?t.createToken(a):s({reason:"NOKEY"})):(e=e.trim(),void t.createApiKey({login:e,password:i,long_life_token:o},function(e,i){if(e)return s(e);var n=new Date(i.expiration_date).getTime();return r.setHaapiKey(i.key,{save:o,timeout:n}),t.createToken(a)}))},t.getForumTopicsList=function(e){var t=window.Config.language;r.fetch("/haapi/getForumTopicsList",{lang:t},e)},t.getForumPostsList=function(e,t){var i=window.Config.language;r.fetch("/haapi/getForumPostsList",{lang:i,topicId:e},t)},t.getNewsList=function(e,t){c.cmsItems.get(r.fetchDirectly,window.Config.language,e,t)},t.getAlmanax=function(e){c.almanax.getEvent(r.fetchDirectly,window.Config.language,e)}},function(e,t,i){function n(){try{return new window.XMLHttpRequest}catch(e){}try{return new window.ActiveXObject("Msxml3.XMLHTTP")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}return null}function o(e){var t={};if(!e)return t;for(var i=e.split("\r\n"),n=0;n<i.length;n++){var o=i[n],s=o.indexOf(": ");if(s>0){var a=o.substring(0,s).toLowerCase(),r=o.substring(s+2);t[a]=r}}return t}var s=i(39),a=["POST","GET"],r=1e4;t.open=function(e,t){function i(){try{var e=this.readyState,i=this.status}catch(n){return t("caught Exception: "+n.description,{xhr:this})}if(4===e){if(i<200||i>=300)return t("there was a problem with the request",{xhr:this});var s={content:this.responseText,headers:o(this.getAllResponseHeaders()),xhr:this};return t(null,s)}}var l=function(e,i){setTimeout(t,0,e,i)};if(!e)return l("no options provided",{xhr:{}});var c=e.requestType||"GET";if(a.indexOf(c)===-1)return l('unsupported request type "'+c+'"',{xhr:{}});var u=n();if(!u)return l("unable to retrieve browser XMLHttpRequest object",{xhr:{}});var d=e.uri,h="string"==typeof e.params?e.params:s.stringify(e.params),p=e.timeout||r;"GET"===c&&h&&(d=d+"?"+h,h=null),u.timeout=p,u.onreadystatechange=i,u.open(c,d,!0),u.send(h)}},function(e,t,i){function n(e){if(e.status<400||e.status>599)return e;var t=new Error(e.statusText);throw t.response=e,t}function o(e,t){e.then(n).then(function(e){e.json().then(function(i){if(i._statusCode||e.status>599)throw i;t(null,i)})["catch"](t)})["catch"](t)}var s,a=i(207).logger,r=i(39),l=2592e6;t.setHaapiKey=function(e,t){if(t=t||{},s=e,!t.save)return e;try{if(!e)return window.localStorage.removeItem("HAAPI_KEY"),window.localStorage.removeItem("HAAPI_KEY_TIMEOUT"),e;var i=e?Date.now()+l:null;window.localStorage.setItem("HAAPI_KEY",e),window.localStorage.setItem("HAAPI_KEY_TIMEOUT",t.timeout||i)}catch(n){return a.warning("Failed to store HAAPI_KEY in local storage:",n),null}return e},t.getHaapiKeyFromStorage=function(){var e=Date.now(),i=window.localStorage.getItem("HAAPI_KEY"),n=window.localStorage.getItem("HAAPI_KEY_TIMEOUT");return!i||!n||n<e?t.setHaapiKey(null,{save:!0}):t.setHaapiKey(i,{save:!1})},t.getHaapiKey=function(){return s?s:t.getHaapiKeyFromStorage()},t.fetch=function(e,t,i){var n=window.Config.dataUrl;e=n+e;var s=r.stringify(t);o(window.fetch([e,s].join("?")),i)},t.fetchDirectly=function(e,i,n){var s=t.getHaapiKey(),a=window.Config.haapi.url;e=a+e;var l={Accept:"application/json"};s&&(l.APIKEY=s);var c=r.stringify(i);o(window.fetch([e,c].join("?"),{headers:l}),n)},t.postDirectly=function(e,i,n){var s=t.getHaapiKey(),a=window.Config.haapi.url;e=a+e;var l={Accept:"application/json"};s&&(l.apikey=s),o(window.fetch(e,{method:"post",headers:l,body:r.stringify(i)}),n)}},function(e,t,i){function n(){this.cmsItems=new o,this.almanax=new s}var o=i(287),s=i(288);e.exports=n},function(e,t){function i(e){return s.indexOf(e)===-1?a:e}function n(){}var o="/Cms/Items",s=["fr","en"],a="en",r="NEWS_ZAAP",l="DOFUS_TOUCH";e.exports=n,n.prototype.get=function(e,t,n,s){var a=o+"/Get",c=i(t),u={template_key:r,site:l,lang:c,page:1,count:n};e(a,u,s)}},function(e,t){function i(){}var n="/Almanax";e.exports=i,i.prototype.getEvent=function(e,t,i){var o=n+"/GetEvent",s={lang:t};e(o,s,i)}},function(e,t,i){function n(e){return"v"+[e.major,e.minor,e.release].join(".")}var o=i(290),s=i(29).getText;e.exports=function(e){switch(e.unitTest||e.reason===o.WRONG_CREDENTIALS||e.reason===o.BANNED||e.reason===o.IN_MAINTENANCE||e.reason===o.EMAIL_UNVALIDATED||console.error("Identification failed:",e),e.reason){case o.BAD_VERSION:return e.requiredVersion?s("ui.popup.accessDenied.badVersion",n(e.currentVersion),n(e.requiredVersion)):s("ui.popup.accessDenied.badVersion");case o.WRONG_CREDENTIALS:return s("ui.popup.accessDenied.wrongCredentials");case o.BANNED:return e.banEndDate?s("ui.popup.accessDenied.bannedWithDuration",new Date(e.banEndDate)):s("ui.popup.accessDenied.banned");case o.KICKED:return s("ui.popup.accessDenied.kicked");case o.IN_MAINTENANCE:return s("ui.popup.accessDenied.inMaintenance");case o.TOO_MANY_ON_IP:return s("ui.popup.accessDenied.toomanyonip");case o.TIME_OUT:return s("ui.popup.accessDenied.timeout");case o.BAD_IPRANGE:return s("ui.popup.accessDenied.badIpRange");case o.CREDENTIALS_RESET:return s("ui.popup.accessDenied.credentialsReset");case o.EMAIL_UNVALIDATED:return s("ui.popup.accessDenied.unvalidatedEmail");case o.SERVICE_UNAVAILABLE:return s("ui.popup.accessDenied.serviceUnavailable");default:return s("ui.popup.accessDenied.unknown")}}},function(e,t){e.exports={BAD_VERSION:1,WRONG_CREDENTIALS:2,BANNED:3,KICKED:4,IN_MAINTENANCE:5,TOO_MANY_ON_IP:6,TIME_OUT:7,BAD_IPRANGE:8,CREDENTIALS_RESET:9,EMAIL_UNVALIDATED:10,SERVICE_UNAVAILABLE:53,UNKNOWN_AUTH_ERROR:99,SPARE:100}},function(e,t,i){var n=i(29).getText;e.exports=function(e){switch(e.unitTest||"FAILED"===e.reason||"OTPTIMEFAILED"===e.reason||console.error("Haapi identification failed:",e),e.reason){case"NOTOKEN":return n("ui.popup.accessDenied.notoken");case"BAN":return n("ui.popup.accessDenied.banned");case"BLACKLIST":return n("tablet.ui.popup.accessDenied.blacklist");case"LOCKED":return n("tablet.ui.popup.accessDenied.locked");case"DELETED":return n("tablet.ui.popup.accessDenied.deleted");case"OTPTIMEFAILED":return n("tablet.ui.popup.accessDenied.otptimefailed");case"BRUTEFORCE":return n("tablet.ui.popup.accessDenied.bruteForceDetected");case"FAILED":return n("ui.popup.accessDenied.wrongCredentials");case"MAILNOVALID":return n("ui.popup.accessDenied.unvalidatedEmail");case"BETACLOSED":return n("tablet.ui.popup.accessDenied.betaClosed");default:return n("ui.popup.accessDenied.unknown")}}},function(e,t){e.exports={INCOMPATIBLE_APP_VERSION:"INCOMPATIBLEAPPVERSIONS",INCOMPATIBLE_BUILD_VERSION:"INCOMPATIBBUILDLEVERSIONS"}},function(e,t,i){i(294),i(295),i(296),i(297),i(298),i(299),i(300),i(301),i(304),i(305),i(306),i(307),i(308),i(309),i(310),i(311),i(312),i(313),i(314),i(315),i(316),i(317),i(317),i(318),i(319),i(320),i(321),i(322),i(323),i(324),i(325),i(326),i(327),i(328),i(329),i(330),i(331),i(332),i(333),i(334),i(335),i(336),i(337),i(338),i(339),i(340),i(341),i(342),i(343),i(344),i(345),i(347),i(348),i(349),i(350),i(351),i(352),i(353),i(354),i(355),i(356),i(357),i(358),i(359),i(360),i(361),i(362),i(363),i(364),i(365),i(366),i(367),i(368),i(369),i(370),i(371),i(372),i(373),i(374),i(375)},function(e,t,i){var n=i(271);n.on("_ErrorPopupMessage",function(e){window.gui.openSimplePopup(e.text,e.title)})},function(e,t,i){var n=i(271);n.on("ConsoleMessage",function(e){window.gui.transmitMessage(e)}),n.on("ConsoleCommandsListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t){},function(e,t,i){var n=i(271);n.on("IdentificationSuccessMessage",function(e){window.gui.transmitMessage(e)}),n.on("IdentificationSuccessWithLoginTokenMessage",function(e){window.gui.transmitMessage(e)}),n.on("ServersListMessage",function(e){window.gui.transmitMessage(e)}),n.on("ServerStatusUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("SelectedServerRefusedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AuthenticationTicketAcceptedMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("NicknameRegistrationMessage",function(e){window.gui.transmitMessage(e)}),n.on("NicknameRefusedMessage",function(e){window.gui.transmitMessage(e)}),n.on("NicknameAcceptedMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("AcquaintanceSearchErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n,o=i(302),s=i(303),a=i(271);a.on("DebugHighlightCellsMessage",function(e){for(var t={},i=0,a=0;a<e.cells.length;a++){var r=e.cells[a];t[r]=new o(r,i,s.fullRed)}window.background.removeGridLayer(n),n=window.background.addGridAnimation(t),window.setTimeout(function(){window.background.removeGridLayer(n)},5e3)}),a.on("DebugClearHighlightCellsMessage",function(){n&&window.background.removeGridLayer(n)}),a.on("DebugInClientMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){function i(e,t,i){this.cellId=e,this.distanceToPlayer=t,this.transformState=i}e.exports=i},function(e,t){function i(e,t,i,n,o,s){this.sx=e,this.sy=t,this.r=i,this.g=n,this.b=o,this.a=s}t.empty=new i(.1,.1,.5,.5,.5,0),t.fullRed=new i(.78,.78,.8,.12,.08,.8),t.fullGreen=new i(.78,.78,0,1,.22,.7),t.fullBlue=new i(.78,.78,0,.51,.91,.8),t.walkable=new i(.9,.9,1,.92,0,.5),t.unwalkable=new i(.9,.9,.9,0,0,.8),t.walkableLast=new i(.9,.9,1,1,0,.8),t.inSight=new i(.78,.78,0,0,1,.5),t.outSight=new i(.78,.78,.6,.6,1,.5),t.areaOfEffect=new i(.78,.78,1,0,0,.9),t.inSightEnemyTurn=new i(.78,.78,.3,.3,.3,.8),t.outSightEnemyTurn=new i(.78,.78,.5,.5,.5,.7),t.areaOfEffectEnemyTurn=new i(.78,.78,1,1,1,1),t.blueTeamStart=new i(1,1,0,0,1,.5),t.blueTeamEnd=new i(.95,1,.1,.4,.8,.45),t.redTeamStart=new i(1,1,1,0,0,.5),t.redTeamEnd=new i(.95,1,.8,.4,.1,.45),t.walkArea=new i(1,1,0,.9,.02,.3),t.walkAreaRequiresAP=new i(1,1,0,.43,.4,.4),t.walkAreaRestricted=new i(1,1,1,0,0,.4),t.enemyWalkArea=new i(1,1,.1,.9,.032,.6),t.enemyWalkAreaRequiresAP=new i(1,1,.1,.435,.4,.6),t.enemyWalkAreaRestricted=new i(.9,.9,1,0,0,.6),t.TransformState=i},function(e,t,i){
var n=i(271);n.on("AchievementListMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementDetailsMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementDetailedListMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementFinishedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementRewardSuccessMessage",function(e){window.gui.transmitMessage(e)}),n.on("AchievementRewardErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(271);n.on("GameActionFightNoSpellCastMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameActionFightPointsVariationMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameActionFightDeathMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightKillMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightLifePointsGainMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightLifePointsLostMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightLifeAndShieldPointsLostMessage",function(e){window.isoEngine.transmitMessage(e)}),n.on("GameActionFightDispellableEffectMessage",function(e){console.error("GameActionFightDispellableEffectMessage received outside of sequence:",e)}),n.on("GameActionFightSlideMessage",function(e){window.actorManager.actorMovement({actorId:e.targetId,keyMovements:[e.startCellId,e.endCellId],slide:!0})}),n.on("GameActionFightTeleportOnSameMapMessage",function(e){window.actorManager.setActorsDisposition([{id:e.targetId,cellId:e.cellId}])}),n.on("GameActionFightExchangePositionsMessage",function(e){window.actorManager.setActorsDisposition([{id:e.sourceId,cellId:e.casterCellId},{id:e.targetId,cellId:e.targetCellId}])}),n.on("GameActionFightSummonMessage",function(e){window.actorManager.addActor(e.summon)})},function(e,t,i){var n=i(271);n.on("messageSequence",function(e){window.isoEngine.transmitMessage(e),window.gui.emit("checkServerLag","fightAction","stop")})},function(e,t,i){var n=i(271);n.on("AllianceCreationStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceModificationStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceCreationResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceInvitedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceInvitationStateRecruterMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceInvitationStateRecrutedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceJoinedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceGuildLeavingMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceLeftMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceMembershipMessage",function(e){window.gui.transmitMessage(e)}),n.on("KohUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceFactsErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceFactsMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceInsiderInfoMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("AccountLoggingKickedMessage",function(){window.gui.disconnect("AccountLoggingKickedMessage"),window.isoEngine.disconnect()}),n.on("ServerSettingsMessage",function(e){window.gui.transmitMessage(e)}),n.on("ServerSessionConstantsMessage",function(e){window.gui.transmitMessage(e)}),n.on("ServerOptionalFeaturesMessage",function(e){window.gui.transmitMessage(e)}),n.on("AccountCapabilitiesMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("CompassResetMessage",function(e){window.gui.transmitMessage(e)}),n.on("CompassUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("CompassUpdatePartyMemberMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("BasicTimeMessage",function(e){window.gui.transmitMessage(e)}),n.on("BasicWhoIsNoMatchMessage",function(e){window.gui.transmitMessage(e)});var o=262,s=12,a=50;n.on("BasicLatencyStatsRequestMessage",function(){n.sendMessage("BasicLatencyStatsMessage",{latency:o,sampleCount:s,max:a})});var r=0;n.on("send:login",function(){r=0}),n.on("SequenceNumberRequestMessage",function(){r+=1,n.sendMessage("SequenceNumberMessage",{number:r})})},function(e,t,i){var n=i(271);n.on("CharacterCreationResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("CharacterNameSuggestionSuccessMessage",function(e){window.gui.transmitMessage(e)}),n.on("CharacterNameSuggestionFailureMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("CharacterDeletionErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(271);n.on("FighterStatsListMessage",function(e){window.isoEngine.sendToFightSequence(e)}),n.on("CharacterLevelUpMessage",function(e){window.gui.transmitMessage(e),window.isoEngine.playLevelUpAnimation(window.gui.playerData.id)}),n.on("CharacterLevelUpInformationMessage",function(e){var t=e.id;t!==window.gui.playerData.id&&window.isoEngine.playLevelUpAnimation(t)}),n.on("UpdateLifePointsMessage",function(e){window.gui.transmitMessage(e)}),n.on("LifePointsRegenBeginMessage",function(e){window.gui.transmitMessage(e)}),n.on("LifePointsRegenEndMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t){},function(e,t,i){var n=i(271);n.on("ChatSmileyMessage",function(e){window.gui.playerData.socialData.isIgnored(e.accountId)||window.actorManager.addSmileyOnActor(e.entityId,e.smileyId)}),n.on("MoodSmileyResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("MoodSmileyUpdateMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271),o=i(302),s=i(303);n.on("GameContextDestroyMessage",function(e){window.isoEngine.transmitMessage(e),window.actorManager.resetActors(),window.gui.transmitMessage(e)}),n.on("GameContextRemoveElementMessage",function(e){window.actorManager.removeActor(e.id)}),n.on("GameContextRemoveMultipleElementsMessage",function(e){window.actorManager.removeActors(e.id)}),n.on("GameContextRemoveElementWithEventMessage",function(e){window.actorManager.removeActor(e.id)}),n.on("GameContextRemoveMultipleElementsWithEventsMessage",function(e){window.actorManager.removeActors(e.id)}),n.on("GameContextRefreshEntityLookMessage",function(e){window.actorManager.setActorLook(e.id,e.look,{},null),window.gui.transmitMessage(e)}),n.on("GameMapNoMovementMessage",function(){window.isoEngine.noMovement()}),n.on("GameMapMovementMessage",function(e){window.actorManager.actorMovement(e)}),n.on("GameMapChangeOrientationMessage",function(e){window.actorManager.setActorsDisposition([e.orientation])}),n.on("GameMapChangeOrientationsMessage",function(e){window.actorManager.setActorsDisposition(e.orientations)}),n.on("GameEntityDispositionMessage",function(e){window.actorManager.setActorsDisposition([e.disposition])}),n.on("GameEntitiesDispositionMessage",function(e){window.actorManager.setActorsDisposition(e.dispositions,!0)}),n.on("ShowCellMessage",function(e){var t={},i=0;t[e.cellId]=new o(e.cellId,i,s.fullRed);var n=window.background.addGridAnimation(t);window.setTimeout(function(){window.background.removeGridLayer(n)},5e3)}),n.on("ShowCellSpectatorMessage",function(e){for(var t={},i=0,n=0;n<e.cells.length;n++){var a=e.cells[n];t[a]=new o(a,i,s.fullRed)}var r=window.background.addGridAnimation(t);window.setTimeout(function(){window.background.removeGridLayer(r)},5e3)})},function(e,t,i){function n(e){window.isoEngine.displayNumericalValue(e)}var o=i(271);o.on("DisplayNumericalValueMessage",n),o.on("DisplayNumericalValueWithAgeBonusMessage",n)},function(e,t){},function(e,t,i){function n(e){window.gui.transmitMessage(e),window.isoEngine.transmitMessage(e)}var o=i(271);o.on("GameFightStartingMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightJoinMessage",function(e){window.isoEngine.transmitMessage(e),window.gui.transmitMessage(e)}),o.on("GameFightPlacementPossiblePositionsMessage",function(e){window.isoEngine.displayFightPositions(e),window.gui.transmitMessage(e)}),o.on("GameFightOptionStateUpdateMessage",function(e){window.isoEngine.challengeOptionChange(e.fightId,e.teamId,e.option,e.state),window.gui.transmitMessage(e)}),o.on("GameFightUpdateTeamMessage",function(e){window.isoEngine.updateFightTeam(e),window.gui.transmitMessage(e)}),o.on("GameFightRemoveTeamMemberMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightHumanReadyStateMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightLeaveMessage",function(e){window.isoEngine.transmitMessage(e)}),o.on("GameFightStartMessage",function(e){window.gui.transmitMessage(e),window.isoEngine.transmitMessage(e)}),o.on("GameFightSpectateMessage",n),o.on("GameFightResumeMessage",n),o.on("GameFightResumeWithSlavesMessage",n),o.on("GameFightEndMessage",function(e){window.isoEngine.transmitMessage(e)}),o.on("GameFightNewRoundMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnListMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnStartMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnStartPlayingMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnResumeMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnStartSlaveMessage",function(e){window.gui.transmitMessage(e)}),o.on("GameFightTurnReadyRequestMessage",function(e){window.isoEngine.transmitMessage(e)}),o.on("GameFightSynchronizeMessage",function(e){window.isoEngine.transmitMessage(e)}),o.on("GameFightTurnEndMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("ChallengeInfoMessage",function(e){window.gui.transmitMessage(e)}),n.on("ChallengeResultMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("GameFightShowFighterMessage",function(e){window.gui.transmitMessage(e),e.informations.alive?window.actorManager.addActor(e.informations):window.actorManager.userActor.actorId===e.informations.contextualId&&window.actorManager.userActor.loadAndPlayAnimation({base:"AnimMort"},!1,function(){window.actorManager.userActor.death()})}),n.on("GameFightRefreshFighterMessage",function(e){window.gui.transmitMessage(e),window.actorManager.refreshFighter(e)}),n.on("GameFightShowFighterRandomStaticPoseMessage",function(e){window.gui.transmitMessage(e),window.actorManager.addActor(e.informations)})},function(e,t,i){function n(e){if(e._bonesId){var t={contextualId:"paddockItem:"+e.cellId,look:{bonesId:e._bonesId,scales:[100],skins:[]},disposition:{cellId:e.cellId,direction:1},name:e._nameId,durability:e.durability,_type:"PaddockObject"};window.actorManager.addActor(t)}}var o=i(271);o.on("MountEmoteIconUsedOkMessage",function(e){var t=window.actorManager.getActor(e.mountId);if(t){var i,n=e.reactionType;switch(n){case 1:i="AnimEmoteRest_Statique_0";break;case 2:i="AnimAttaque0";break;case 3:i="AnimEmoteCaresse";break;case 4:i="AnimEmoteReproductionF";break;case 5:i="AnimEmoteReproductionM";break;default:return}t.loadAndPlayAnimation({base:i})}}),window.connectionManager=o,o.on("GameDataPaddockObjectAddMessage",function(e){n(e.paddockItemDescription)}),o.on("GameDataPaddockObjectListAddMessage",function(e){for(var t=e.paddockItemDescription,i=0;i<t.length;i++)n(t[i])}),o.on("GameDataPaddockObjectRemoveMessage",function(e){window.actorManager.removeActor("paddockItem:"+e.cellId)})},function(e,t,i){var n=i(271);n.on("NotificationListMessage",function(e){window.gui.transmitMessage(e)}),n.on("NotificationByServerMessage",function(e){console.info("NotificationByServerMessage: ","id:"+e.id,e.parameters)})},function(e,t,i){function n(e){window.gui.transmitMessage(e),a===e.mapId?window.isoEngine.reloadMap(e):(o.lockMessages(),window.isoEngine.loadMap(e)),a=e.mapId}var o=i(271),s=i(258),a=null;o.on("disconnect",function(){a=null}),o.on("CurrentMapMessage",function(e){o.sendMessage("MapInformationsRequestMessage",{mapId:e.mapId}),e.mapId!==a&&(window.foreground.lock("loadMap"),window.gui.transmitMessage(e),s.release())}),o.on("TeleportOnSameMapMessage",function(e){window.actorManager.setActorsDisposition([{id:e.targetId,cellId:e.cellId}])}),o.on("MapFightCountMessage",function(e){window.gui.transmitMessage(e)}),o.on("MapRunningFightListMessage",function(e){window.gui.transmitMessage(e)}),o.on("MapRunningFightDetailsMessage",function(e){window.gui.transmitMessage(e)}),o.on("MapObstacleUpdateMessage",function(e){window.isoEngine.updateObstacles(e.obstacles)}),o.on("MapComplementaryInformationsDataMessage",n),o.on("MapComplementaryInformationsDataInHouseMessage",n),o.on("MapComplementaryInformationsWithCoordsMessage",n),o.on("MapComplementaryInformationsWithObstacleOverride",n),o.on("GameRolePlayShowActorMessage",function(e){window.actorManager.addActor(e.informations)})},function(e,t,i){var n=i(271);n.on("GameRolePlayPlayerLifeStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayGameOverMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(271);n.on("DocumentReadingBeginMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("EmoteListMessage",function(e){window.gui.transmitMessage(e)}),n.on("EmoteAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("EmoteRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("EmotePlayMessage",function(e){window.isoEngine.playEmote(e)}),n.on("EmotePlayRelookedMessage",function(e){window.isoEngine.playRelookedEmote(e)})},function(e,t,i){var n=i(271);n.on("GameRolePlayAggressionMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayPlayerFightFriendlyRequestedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayPlayerFightFriendlyAnsweredMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayShowChallengeMessage",function(e){window.isoEngine.showChallenge(e.commonsInfos)}),n.on("GameRolePlayRemoveChallengeMessage",function(e){window.gui.transmitMessage(e),window.isoEngine.removeChallenge(e.fightId)})},function(e,t,i){var n=i(271);n.on("GameRolePlayArenaRegistrationStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayArenaFightPropositionMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayArenaFighterStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlayArenaUpdatePlayerInfosMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("AccountHouseMessage",function(e){window.gui.transmitMessage(e)}),n.on("HousePropertiesMessage",function(e){window.gui.transmitMessage(e)}),n.on("HouseBuyResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("HouseSoldMessage",function(e){window.gui.transmitMessage(e)}),n.on("HouseToSellListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("HouseGuildNoneMessage",function(e){window.gui.transmitMessage(e)}),n.on("HouseGuildRightsMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("JobDescriptionMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobLevelUpMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobUnlearntMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobExperienceMultiUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobExperienceUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobAllowMultiCraftRequestMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobMultiCraftAvailableSkillsMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectoryListMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectorySettingsMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobListedUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectoryRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectoryAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("JobCrafterDirectoryEntryMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("LockableShowCodeDialogMessage",function(e){window.gui.transmitMessage(e)}),n.on("LockableCodeResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("LockableStateUpdateHouseDoorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("TaxCollectorDialogQuestionBasicMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorDialogQuestionExtendedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AllianceTaxCollectorDialogQuestionExtendedMessage",function(e){window.gui.transmitMessage(e)}),n.on("AlliancePrismDialogQuestionMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271),o=i(202),s=i(184),a=s.ITEM_DIR;n.on("ObjectGroundAddedMessage",function(e){var t={cellId:e.cellId,objectGID:e.objectGID};o.loadImage(a+e._iconId+".png",function(e){t.img=e,window.isoEngine.addObjects([t])})}),n.on("ObjectGroundListAddedMessage",function(e){for(var t=[],i=[],n=0,s=e.cells.length;n<s;n++)t.push({cellId:e.cells[n],objectGID:e.referenceIds[n]}),i.push(a+e._iconIds[n]+".png");o.loadImages(i,null,function(e){for(var i=0;i<e.length;i++)t[i].img=e[i];window.isoEngine.addObjects(t)})}),n.on("ObjectGroundRemovedMessage",function(e){window.isoEngine.removeObjects([e.cell])}),n.on("ObjectGroundRemovedMultipleMessage",function(e){window.isoEngine.removeObjects(e.cells)})},function(e,t,i){var n=i(271);n.on("PaddockPropertiesMessage",function(e){window.gui.transmitMessage(e)}),n.on("PaddockSellBuyDialogMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameDataPlayFarmObjectAnimationMessage",function(e){for(var t=0;t<e.cellId.length;t++){var i="paddockItem:"+e.cellId[t],n=window.actorManager.getActor(i);n&&n.loadAndPlayAnimation({base:"AnimHit",direction:1},!1)}}),n.on("PaddockToSellListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("PartyInvitationDetailsMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyCannotJoinErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyJoinMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyNewGuestMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyNewMemberMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyUpdateLightMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyFollowStatusUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("PartyMemberInFightMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("PurchasableDialogMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("QuestListMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestValidatedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestObjectiveValidatedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestStepValidatedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestStepStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("QuestStepInfoMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("SpellForgetUIMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpellForgottenMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpellUpgradeSuccessMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpellUpgradeFailureMessage",function(e){window.gui.transmitMessage(e)}),n.on("GameRolePlaySpellAnimMessage",function(e){window.isoEngine.playRoleplaySpellAnim(e,function(e){if(e)return console.error("GameRolePlaySpellAnimMessage error",e)})})},function(e,t,i){var n=i(271),o=i(346),s=i(29).getText;n.on("StatsUpgradeResultMessage",function(e){if(e.result!==o.SUCCESS){var t="";switch(e.result){case o.NONE:t=s("ui.popup.statboostFailed.text");break;case o.GUEST:t=s("ui.fight.guestAccount");break;case o.RESTRICTED:t=s("ui.charSel.deletionErrorUnsecureMode");break;case o.IN_FIGHT:t=s("ui.error.cantDoInFight");break;case o.NOT_ENOUGH_POINT:t=s("ui.popup.statboostFailed.notEnoughPoint")}t&&window.gui.chat.logError(t)}})},function(e,t){e.exports={NONE:-1,SUCCESS:0,RESTRICTED:1,GUEST:2,IN_FIGHT:3,NOT_ENOUGH_POINT:4}},function(e,t){},function(e,t,i){var n=i(271);n.on("LeaveDialogMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("FriendsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("IgnoredListMessage",function(e){window.gui.transmitMessage(e)}),n.on("FriendAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("FriendUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("IgnoredAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("IgnoredDeleteResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpouseStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("SpouseInformationsMessage",function(e){window.gui.transmitMessage(e)}),n.on("FriendWarnOnConnectionStateMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("GuildCreationStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildModificationStartedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildCreationResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInvitedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInvitationStateRecruterMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInvitationStateRecrutedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildJoinedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildMemberOnlineStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInformationsMembersMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildMemberWarnOnConnectionStateMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInformationsPaddocksMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildMemberLeavingMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildLeftMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildMembershipMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInfosUpgradeMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildHousesInformationMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildHouseUpdateInformationMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildHouseRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildPaddockBoughtMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildPaddockRemovedMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFactsMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildInAllianceFactsMessage",function(e){window.gui.transmitMessage(e)}),n.on("ChallengeFightJoinRefusedMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("TaxCollectorMovementMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorListMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorMovementAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorMovementRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorAttackedMessage",function(e){window.gui.transmitMessage(e)}),n.on("TaxCollectorAttackedResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFightPlayersHelpersJoinMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFightPlayersHelpersLeaveMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFightPlayersEnemiesListMessage",function(e){window.gui.transmitMessage(e)}),n.on("GuildFightPlayersEnemyRemoveMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("SetCharacterRestrictionsMessage",function(e){window.isoEngine.actorManager.userActor.updateRestrictions(e.restrictions)}),n.on("ServerExperienceModificatorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("InteractiveUseErrorMessage",function(e){window.isoEngine.onInteractiveUseErrorMessage(e)}),n.on("InteractiveUsedMessage",function(e){window.isoEngine.interactiveUseStart(e),window.gui.transmitMessage(e)}),n.on("InteractiveUseEndedMessage",function(e){window.isoEngine.interactiveUseEndedMessage(e),window.gui.transmitMessage(e)}),n.on("InteractiveMapUpdateMessage",function(e){window.isoEngine.updateInteractiveElements(e.interactiveElements)}),n.on("InteractiveElementUpdatedMessage",function(e){window.isoEngine.updateInteractiveElements([e.interactiveElement])}),n.on("StatedMapUpdateMessage",function(e){window.isoEngine.updateStatedElements(e.statedElements)}),n.on("StatedElementUpdatedMessage",function(e){window.isoEngine.updateStatedElements([e.statedElement])})},function(e,t,i){var n=i(271);n.on("TeleportDestinationsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("ZaapListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("KamasUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectAveragePricesMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("ExchangeReplayCountModifiedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeRequestedTradeMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartedWithPodsMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftSlotCountIncreasedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeIsReadyMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeLeaveMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkNpcTradeMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeOkMultiCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftResultWithObjectIdMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftResultWithObjectDescMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftResultMagicWithObjectDescMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeCraftInformationObjectMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeGuildTaxCollectorGetMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeReplyTaxVendorMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountStableErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountStableAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountPaddockAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountStableBornAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountStableRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountPaddockRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountTakenFromPaddockMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountFreeFromPaddockMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMountSterilizeFromPaddockMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeItemAutoCraftStopedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeItemAutoCraftRemainingMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkCraftWithInformationMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkMulticraftCrafterMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkMulticraftCustomerMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeStartOkJobIndexMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeGoldPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeItemPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeModifiedPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeRemovedPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeClearPaymentForCraftMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("InventoryContentMessage",function(e){window.gui.transmitMessage(e)}),n.on("SetUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectMovementMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectsAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ObjectModifiedMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryContentAndPresetMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectRemovedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectModifiedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectPutInBagMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectRemovedFromBagMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeObjectModifiedInBagMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeKamaModifiedMessage",function(e){window.gui.transmitMessage(e)}),n.on("ExchangeMultiCraftCrafterCanUseHisRessourcesMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("InventoryPresetUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetItemUpdateErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetItemUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetSaveResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetDeleteResultMessage",function(e){window.gui.transmitMessage(e)}),n.on("InventoryPresetUseResultMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("SpellListMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271),o=i(29).getText;n.on("PopupWarningMessage",function(e){window.gui.openConfirmPopup({title:o("ui.popup.information"),message:e.author+": "+e.content,noDisable:!0,timer:e.lockDuration})})},function(e,t){},function(e,t,i){var n=i(271);n.on("PrismFightDefenderAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightDefenderLeaveMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightAttackerAddMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightAttackerRemoveMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismsListUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismsInfoValidMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightAddedMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightRemovedMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismFightStateUpdateMessage",function(e){window.gui.transmitMessage(e)}),n.on("PrismSettingsErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t,i){var n=i(271);n.on("UpdateMapPlayersAgressableStatusMessage",function(e){window.gui.transmitMessage(e),window.actorManager.updateActorsAggressableStatus(e.playerIds,e.enable)}),n.on("UpdateSelfAgressableStatusMessage",function(e){window.gui.transmitMessage(e)}),n.on("AlignmentRankUpdateMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t){},function(e,t,i){var n=i(271);n.on("ContactLookMessage",function(e){window.gui.transmitMessage(e);
})},function(e,t){},function(e,t,i){var n=i(271);n.on("TitlesAndOrnamentsListMessage",function(e){window.gui.transmitMessage(e)}),n.on("TitleGainedMessage",function(e){window.gui.transmitMessage(e)}),n.on("TitleLostMessage",function(e){window.gui.transmitMessage(e)}),n.on("OrnamentGainedMessage",function(e){window.gui.transmitMessage(e)}),n.on("TitleSelectedMessage",function(e){window.gui.transmitMessage(e)}),n.on("TitleSelectErrorMessage",function(e){window.gui.transmitMessage(e)}),n.on("OrnamentSelectedMessage",function(e){window.gui.transmitMessage(e)}),n.on("OrnamentSelectErrorMessage",function(e){window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(271);n.on("TrustStatusMessage",function(e){n.sendMessage("CharactersListRequestMessage"),window.gui.transmitMessage(e)})},function(e,t){},function(e,t,i){var n=i(271);n.on("SystemMessageDisplayMessage",function(e){window.gui.openSimplePopup(e.text,e.title),e.hangUp&&(window.gui.disconnect(),window.isoEngine.disconnect())})},function(e,t){},function(e,t){},function(e,t){},function(e,t){function i(e){window.gui.transmitMessage({_messageType:"_tutorialGameMapMovementMessage",actorId:e.actorId})}function n(){window.gui.transmitMessage({_messageType:"_tutorialGameEntitiesDispositionMessage"})}t.setTutorialListeners=function(e){e.on("GameMapMovementMessage",i),e.on("GameEntitiesDispositionMessage",n)},t.removeTutorialListeners=function(e){e.removeListener("GameMapMovementMessage",i),e.removeListener("GameEntitiesDispositionMessage",n)}},function(e,t){var i=!1;t.start=function(){if(window.powerManagement)return i?console.warn("PowerManager already active"):void window.powerManagement.dim(function(){i=!0},function(e){console.warn("PowerManager failed to acquire wakelock",e)})},t.stop=function(){if(window.powerManagement)return i?void window.powerManagement.release(function(){i=!1},function(e){console.warn("PowerManager failed to release wakelock",e)}):console.warn("PowerManager was not active")}},function(e,t){function i(e,t){function i(){if(!t)throw new Error("Final callback was already called");for(var i=0;i<o.length;i+=1)e.removeListener(o[i].eventName,o[i].callback);o=null;try{t.apply(e,arguments)}catch(n){setTimeout(function(){throw n},0)}finally{t=null}}function n(){function t(){try{n.apply(e,arguments)}catch(t){i(t)}}var n=arguments[arguments.length-1];if("function"!=typeof n)throw new TypeError("Final argument must be a callback function");for(var s=0;s<arguments.length-1;s+=1){var a=arguments[s];e.on(a,t),o.push({eventName:a,callback:t})}}var o=[];return t=t||function(){},n.done=i,n}e.exports=i},function(e,t,i){var n=i(271),o={BasicAckMessage:null,BasicLatencyStatsRequestMessage:null,BasicNoOperationMessage:null,SequenceNumberRequestMessage:null},s={BasicLatencyStatsMessage:null,SequenceNumberMessage:null};n.on("data",function(e){if(null!==o[e._messageType]){var t="background-color: #BFA;";e._messageType&&e._messageType.indexOf("ErrorMessage")===-1||(t="background-color: #F00; color: #FFF;"),console.log("[DOFUS PROXY] received: %c"+e._messageType,t,e)}}),n.on("messageSequence",function(e){var t="background-color: #CB98E7;";console.log("[DOFUS PROXY] received: %cmessageSequence",t,e)}),n.on("open",function(){console.log("[DOFUS PROXY] %c Connected to remote server ","background-color: #FF0;")}),n.on("reconnecting",function(){console.log("[DOFUS PROXY] %c Reconnecting to remote server... ","background-color: #FF0;")}),n.on("reconnected",function(){console.log("[DOFUS PROXY] %c Reconnected to remote server ","background-color: #FF0;")}),n.on("error",function(e){console.error("[DOFUS PROXY] ",e)}),n.on("disconnect",function(){console.log("[DOFUS PROXY] %c disconnecting ","background-color: #FF0;")}),n.on("send",function(e){if("sendMessage"===e.call){if(s[e.data.data.type])return;return void console.log("[DOFUS PROXY]     send: %c"+e.data.data.type,"background-color: #6DF;",e.data.data.data)}console.log("[DOFUS PROXY]     send: %c"+e.call,"background-color: #6DF;",e.data)})},function(e,t,i){i(381),e.exports=i(382),i(391),i(392),i(393),i(475)},function(e,t){},function(e,t,i){function n(){function e(){t.setStyles({left:o.mapLeft+"px",top:o.mapTop+"px",width:o.mapWidth+"px",height:o.mapHeight+"px"})}d.call(this,"div",{className:"foreground",hidden:!0}),this.tapOptions={},this.fightIsUserTurn=!1,this.isTacticMode=!1,this.locked=!1,this.lockMap={},m.on("gameContextChanged",this.onGameContextChanged.bind(this));var t=this,i=window.gui;i.once("connected",function(){t._setupInfoBox(),t._createConfirmBox(),t._setupDrop(),t._setupTouchInteraction(),t._setupBorderArrow(),e(),i.timeline.setStyles({top:o.mapHeight-150+"px",left:o.mapWidth+"px"}),t._initHandlers(this),this.on("disconnect",function(){t.tapOptions={},t.fightIsUserTurn=!1,t.locked=!1,t.lockMap={},t.hideInfobox(),t.confirmBox.close(),t.minMaxSelector.hide(),t.hide()})}),i.on("resize",e)}var o=i(183).dimensions,s=i(383),a=i(190),r=i(191).inherits,l=i(386),c=i(258).playUiSound,u=i(390),d=i(235),h=i(29).getText,p=i(29).processText,m=i(269);r(n,d),e.exports=n,n.prototype._setupDrop=function(){function e(e){var i=window.gui.playerData.inventory.objects[t],n=i?i.getName():t;window.gui.openConfirmPopup({title:h("ui.common.confirm"),message:p(h("ui.common.confirmationDropItem"),e,n),cb:function(i){i&&(window.dofus.sendMessage("ObjectDropMessage",{objectUID:t,quantity:e}),c("DROP_ITEM_1"))}})}var t,i=this,n=this.minMaxSelector=window.gui.windowsContainer.appendChild(new l);n.on("confirm",e),s.setDroppable(this,["itemContextMenu","equipment"]),this.on("drop",function(o,s,a){switch(s){case"itemContextMenu":var r=i.convertScreenToCanvasCoordinate(a.x,a.y);window.isoEngine.useItem(r.x,r.y,o.item.objectUID);break;case"equipment":t=o.itemInstance.objectUID;var l=o.itemInstance.quantity;1===l?e(1):n.open({min:1,max:l,x:a.x,y:a.y})}})},n.prototype._initHandlers=function(e){function t(){o.tapOptions.mode="fight",o.tapOptions.possiblePlacements&&delete o.tapOptions.possiblePlacements}function i(){o.fightIsUserTurn&&(o.fightIsUserTurn=!1,o.confirmBox.hide(),window.isoEngine.clearUserMovementZone())}function n(t){var i=o.fightIsUserTurn=e.playerData.characters.canControlCharacterId(t.id),n=window.isoEngine;if(n.fightTurnStart(i),n.clearHighlights(),i&&a.soundOnPlayerTurnStart&&c("PLAYER_TURN"),!n.mapRenderer.isReady)return n.mapRenderer.once("ready",function(){o._displayUserZones()})}var o=this;e.on("sendAllFightEvent",function(){o._displayUserZones()}),e.on("GameFightPlacementPossiblePositionsMessage",function(e){o.tapOptions.mode="fightPlacement",e.teamNumber===u.TEAM_CHALLENGER?o.tapOptions.possiblePlacements=e.positionsForChallengers:e.teamNumber===u.TEAM_DEFENDER?o.tapOptions.possiblePlacements=e.positionsForDefenders:o.tapOptions.possiblePlacements&&delete o.tapOptions.possiblePlacements}),e.on("GameFightJoinMessage",function(e){return e.isFightStarted?t():void(o.tapOptions.mode="fightPlacement")}),e.on("GameFightStartMessage",t),e.on("GameFightResumeMessage",t),e.on("GameFightResumeWithSlavesMessage",t),e.on("GameFightTurnStartPlayingMessage",function(){o.fightIsUserTurn=!0}),e.on("GameFightTurnStartMessage",n),e.on("GameFightTurnResumeMessage",n),e.on("GameFightTurnStartSlaveMessage",n),e.on("GameFightTurnEndMessage",i),e.on("GameFightEndMessage",i),e.on("spellSlotSelected",function(e){o.selectSpell(e)}),e.on("spellSlotDeselected",function(){o.deselectSpell()}),e.playerData.on("movementPointsCurrentUpdated",function(){this.isFighting&&o.fightIsUserTurn&&(o.isSpellSelected()||window.isoEngine.displayUserMovementZone())})},n.prototype._displayUserZones=function(){var e=this.isSpellSelected();this.fightIsUserTurn?e?this._displaySpellRange():window.isoEngine.displayUserMovementZone():e&&this._displaySpellRange()},n.prototype._displaySpellRange=function(){var e=this.tapOptions,t=e.spellId,i=window.gui.playerData.characters.getControlledCharacter(),n=i.spellData.spells[t],o=n.getZoneEffectWhenCasting(),s={spellId:t,castInDiagonal:n.getProperty("castInDiagonal"),castInLine:n.getProperty("castInLine"),castTestLos:n.getProperty("castTestLos"),minRange:n.getProperty("minRange"),range:n.getProperty("range"),apCost:n.getProperty("apCost",n.level),needFreeCell:n.getProperty("needFreeCell"),needFreeTrapCell:n.getProperty("needFreeTrapCell"),needTakenCell:n.getProperty("needTakenCell"),name:n.getName(),zoneEffect:o};e.spell=n,window.isoEngine.setCurrentSpell(s),window.isoEngine.displaySpellRange()},n.prototype.refreshSpellRange=function(){this.isSpellSelected()&&this._displaySpellRange()},n.prototype.selectSpell=function(e){this.tapOptions.spellId=e,this.tapOptions.characterId=window.gui.playerData.characters.controlledCharacterId,"fight"===this.tapOptions.mode&&this._displayUserZones()},n.prototype.deselectSpell=function(){void 0!==this.tapOptions.spellId&&(this.confirmBox.close(),delete this.tapOptions.spellId),"fight"===this.tapOptions.mode&&this._displayUserZones()},n.prototype.isSpellSelected=function(){return!!this.tapOptions.spellId||0===this.tapOptions.spellId},n.prototype.lock=function(e){return e?(this.lockMap[e]=!0,this.locked=!0,void this.cancelTransform()):console.error(new Error("Foreground.lock: no reason provided"))},n.prototype.unlock=function(e){if(!e)return console.error(new Error("Foreground.unlock: no reason provided"));this.lockMap[e]=!1;for(var t=Object.keys(this.lockMap),i=0;i<t.length;i++)if(this.lockMap[t[i]])return;this.locked=!1},n.prototype.onGameContextChanged=function(){m.isRoleplayMode?this.tapOptions.mode="roleplay":(delete this.tapOptions.mode,this.hideBorderArrow())}},function(e,t,i){function n(){h=!1,b=w=null,f=g=v=null}function o(e,t){var i=1.5,n=0,o=0,s=0;void 0!==f.customScale&&null!==f.customScale&&(i=f.customScale),void 0!==f.customXOffset&&null!==f.customXOffset&&(n=f.customXOffset),void 0!==f.customYOffset&&null!==f.customYOffset&&(o=f.customYOffset),void 0!==f.customRotation&&null!==f.customRotation&&(s=f.customRotation);var a=e-C.x-p+n,r=t-C.y-m+o;f.setStyle("webkitTransform","translate3d("+a+"px, "+r+"px, 0) scale("+i+") rotateZ("+s+"deg)")}function s(e,t){a.removeListener("dragMove",o),d.isDragging=!1,y&&(y.delClassNames("dragOver","notAllowed"),y=null),I.x=e,I.y=t;var i=document.elementFromPoint(e,t);if(i){var n=document.createEvent("Event");n.initEvent("drop",!0,!0),i.dispatchEvent(n)}l.stop()}i(384);var a=i(385),r=i(209).EventEmitter,l=i(257),c=i(227),u=i(235),d=new r,h=!1;d.isDragging=!1;var p,m,f,g,_,v,y=null,b=null,w=null,M={x:0,y:0},T={left:0,top:0},C={x:0,y:0},I={x:0,y:0};d.init=function(e){_=new u("div",{className:"dragElement"}),_.icon=_.createChild("div",{className:"icon"}),e.appendChild(_),_.hide(),window.gui.wBody.on("dom.drop",function(){c.tween(f,{webkitTransform:"translate3d(0,0,0) scale(1)"},{time:100,easing:"ease-out"},function(){v.onDragClassName&&f.delClassNames(v.onDragClassName),d.isLostDrop=!0,f!==_?(g.appendChild(f),f.delClassNames("customDragElement"),f.setStyles(T),f.emit("dragEnd",I.x,I.y)):(_.hide(),b.emit("dragEnd",I.x,I.y)),d.emit("dragEnd",b,b._dragManager.source,w),_.hide(),n()})})},d.setElementSource=function(e,t){e._dragManager&&(e._dragManager.source=t)},d.isDraggable=function(e){return e._dragManager&&e._dragManager.draggable},d.setDraggable=function(e,t,i,n,r){e._dragManager=e._dragManager||{},e._dragManager.draggable||(e._dragManager.draggable=!0,e._dragManager.source=i,r=r||{},t=t||{},a.initializeListeners(e,r),e.on("_dragStart",function(i,u){if(f=r.dragElement?e:_,!h&&(!t.prepareForDrag||t.prepareForDrag(n,f,e))){h=!0,d.isDragging=!0,b=e,w=n,v=t;var y=e.rootElement.getBoundingClientRect(),I={left:y.left,top:y.top,width:r.containerWidth||y.width,height:r.containerHeight||y.height};if(M.x=I.left,M.y=I.top,r.dragElement)g=e.getParent(),window.gui.gameGuiContainer.appendChild(e),T.left=e.getStyle("left"),T.top=e.getStyle("top"),f.setStyles({left:I.left+"px",top:I.top+"px",webkitTransform:"translate3d(0,0,0)"}),f.addClassNames("customDragElement");else{T.left=T.top=0,f.setStyles({left:I.left+"px",top:I.top+"px",width:I.width+"px",height:I.height+"px",webkitTransform:"translate3d(0,0,0)"});var A=v.styles||{};A.backgroundImage=v.backgroundImage||A.backgroundImage||"none",f.icon.setStyles(A)}v.onDragClassName&&f.addClassNames(v.onDragClassName),f.show(),p=I.left+Math.floor(I.width/2)-i,m=I.top+Math.floor(I.height/2)-u,C.x=i,C.y=u,c.tween(f,{webkitTransform:"translate3d("+-p+"px,"+-m+"px,0) scale(1.5)"},{time:100,easing:"ease-out"},function(){a.on("dragMove",o),r.noHover||l.start(),e.emit("dragStart"),d.emit("dragStart",b,b._dragManager.source,w)}),a.once("dragEnd",s)}}))},d.setDragEnable=function(e,t){e._dragManager&&(e._dragManager.enable=t)},d.enableDrag=function(e){d.setDragEnable(e,!0)},d.disableDrag=function(e){d.setDragEnable(e,!1)},d.cancelDragFromSource=function(e){b&&e===b._dragManager.source&&d.cancelDrag()},d.cancelDrag=function(){v&&v.onDragClassName&&f.delClassNames(v.onDragClassName),a.cancel()},d.setDroppable=function(e,t,i){function o(){var n=b._dragManager.source;return!(i.isDropAllowed&&!i.isDropAllowed.call(e,w,f,n))&&t.indexOf(n)!==-1}e._dragManager=e._dragManager||{},e._dragManager.droppable||(e._dragManager.droppable=!0,i=i||{},l(e),e.on("touchenter",function(){d.isDragging&&o()&&(y=e,e.addClassNames("dragOver"),e.emit("dragEnter",b,b._dragManager.source,w))}),e.on("touchleave",function(){d.isDragging&&o()&&(y=null,e.delClassNames("dragOver"),e.emit("dragLeave"))}),e.on("dom.drop",function(t){if(o()){t.stopPropagation();var s,a;if(i.matchPositionOnDrop){var r=e.rootElement.getBoundingClientRect();s=r.left-C.x+Math.floor(r.width/2)-p,a=r.top-C.y+Math.floor(r.height/2)-m}else s=I.x-C.x,a=I.y-C.y;e.emit("beforeDragEnd"),c.tween(f,{webkitTransform:"translate3d("+s+"px,"+a+"px,0) scale(1)"},{time:100,easing:"ease-out"},function(){w=w||{},w.x=I.x,w.y=I.y,v.onDragClassName&&f.delClassNames(v.onDragClassName),f!==_?(g.appendChild(f),f.delClassNames("customDragElement"),f.setStyles({left:T.left,top:T.top,webkitTransform:"translate3d(0px,0px, 0)"}),f.emit("dragEnd",s,a)):b.emit("dragEnd",s,a),d.isLostDrop=!1,d.emit("dragEnd",b,b._dragManager.source,w),e.delClassNames("dragOver"),e.emit("drop",b,b._dragManager.source,w),_.hide(),n()})}}))},d.getDraggedElement=function(){return f},e.exports=d},function(e,t){},function(e,t,i){function n(){g=!1,u=null}function o(e){var t=h(e);if(!g){if(Math.abs(t.x-l)<v&&Math.abs(t.y-c)<v)return;if(!p.requestInteractionHandle("DRAG",m))return m.cancel();g=!0,u.emit("_dragStart",t.x,t.y)}u.emit("dragMove",t.x,t.y),m.emit("dragMove",t.x,t.y)}function s(){_||(_=!0,window.gui.wBody.on("dom.touchmove",o),window.gui.wBody.on("dom.touchend",r))}function a(){_&&(_=!1,window.gui.wBody.removeListener("dom.touchmove",o),window.gui.wBody.removeListener("dom.touchend",r))}function r(e){var t=h(e);a(),g&&(n(),m.emit("dragEnd",t.x,t.y))}var l,c,u,d=i(209).EventEmitter,h=i(229).getPosition,p=i(231),m=e.exports=new d,f=5,g=!1,_=!1,v=f;m.cancel=function(){a(),g&&(n(),m.emit("dragEnd",0,0),p.abortInteraction())},m.initializeListeners=function(e,t){e.allowDomEvents();var i=t.hasOwnProperty("sensitivity")?t.sensitiviy:f;e.on("dom.touchstart",function(n){if(e._dragManager.enable&&!_){v=i;var a=h(n);l=a.x,c=a.y,s(),u=e,t.dragOnTouchstart?(v=0,o(n)):t.dragInsteadOfScroll&&p.setPriorityBehavior("DRAG")}}),e._dragManager.enable=!0}},function(e,t,i){function n(){var e=this;h.call(this,"div",{className:"minMaxSelector",hidden:!0});var t=this.createChild("div",{className:"topRow"}),i=this.createChild("div",{className:"botRow"});this.decrButton=t.appendChild(new r({className:["simpleButton","arrow","decrButton"],repeatDelay:m})),this.numberInput=t.appendChild(new c({className:"numberInput"})),this.incrButton=t.appendChild(new r({className:["simpleButton","arrow","incrButton"],repeatDelay:m})),this.minButton=i.appendChild(new l(s("ui.common.minWord"),{className:"minButton"})),this.maxButton=i.appendChild(new l(s("ui.common.maxWord"),{className:"maxButton"})),this.close=i.appendChild(new r({className:["simpleButton","closeBtn"]})),this.confirm=i.appendChild(new r({className:["simpleButton","confirmBtn"]})),this.currentValue=0,this.minButton.on("tap",function(){e.currentValue=e.min,e.numberInput.setValue(e.currentValue)}),this.maxButton.on("tap",function(){e.currentValue=e.max,e.numberInput.setValue(e.currentValue)}),this.decrButton.on("tap",function(){e.currentValue<=e.min||(e.currentValue--,e.numberInput.setValue(e.currentValue))}),this.incrButton.on("tap",function(){e.currentValue>=e.max||(e.currentValue++,e.numberInput.setValue(e.currentValue))}),this.confirm.on("tap",function(){e.closeMinMax(),e.emit("confirm",e.currentValue)}),this.close.on("tap",function(){e.closeMinMax()}),this.numberInput.on("change",function(t){e.currentValue=t})}i(387);var o=i(250).getElementPositionAt,s=i(29).getText,a=i(191).inherits,r=i(246),l=r.DofusButton,c=i(388),u=i(277),d=i(227),h=i(235),p=u.MAX_NUMBER,m=100,f={opacity:0,webkitTransform:"scale(0.8)"},g={opacity:1,webkitTransform:"scale(1)"};a(n,h),e.exports=n,n.prototype.position=function(e,t){var i=o(this,e,t);this.setStyles({left:i.x+"px",top:i.y+"px"})},n.prototype.open=function(e){function t(){delete i.openTweener,i.emit("opened")}var i=this;e=e||{},this.min=e.min||0,this.max=e.max||p;var n;return n=void 0!==e.defaultValue?Math.max(this.min,Math.min(this.max,e.defaultValue)):this.min,void 0!==e.placeholder&&void 0===e.defaultValue?(this.numberInput.setPlaceholder(e.placeholder),this.currentValue=""):this.currentValue=n,this.numberInput.setValue(this.currentValue),this.numberInput.minValue=this.min,this.numberInput.maxValue=this.max,this.show(),e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&this.position(e.x,e.y),this.setStyles(f),this.openTweener?(this.openTweener.cancel(),t()):void(this.openTweener=d.tween(this,g,{time:150,delay:0,easing:"ease-out"},t))},n.prototype.openAround=function(e,t){var i=e.rootElement.getBoundingClientRect();t.x=i.left,t.y=i.top,this.open(t)},n.prototype.closeMinMax=function(){function e(){delete t.closeTweener,t.hide(),t.emit("closed"),t.numberInput.rootElement.blur()}var t=this;return this.closeTweener?(this.closeTweener.cancel(),e()):void(this.closeTweener=d.tween(this,f,{time:150,delay:0,easing:"ease-out"},e))}},function(e,t){},function(e,t,i){function n(e){e=e||{},this.title=e.title,this.minValue=void 0!==e.minValue?e.minValue:u,this.maxValue=e.maxValue||c;var t={type:"text",maxlength:d+1,placeholder:0};if(e.attr)for(var i in e.attr)t[i]=e.attr[i];e.attr=t,l.call(this,"input",e),this.addClassNames("NumberInputBox"),r(this),this.on("tap",this._tapOnNumberInputBox)}i(389);var o=i(252),s=i(191).inherits,a=i(277),r=i(228),l=i(235),c=a.MAX_NUMBER,u=1,d=a.MAX_NUMBER_LEN;s(n,l),e.exports=n,n.prototype._parseNumber=function(e){var t=o.stringToInt(e);return Math.min(Math.max(t,this.minValue),this.maxValue)},n.prototype._tapOnNumberInputBox=function(){this.emit("focus"),void 0===this.minValue&&(this.minValue=u),void 0===this.maxValue&&(this.maxValue=c),window.gui.numberInputPad.open(this,this.title,this.minValue,this.maxValue)},n.prototype.promptForValue=function(e){function t(){n=!0}if(this._tapOnNumberInputBox(),e){var i=this,n=!1;this.on("change",t),window.gui.numberInputPad.once("hide",function(){return i.removeListener("change",t),e(n)})}},n.prototype.getValue=function(){return o.stringToInt(this.rootElement.value)},n.prototype.getRawValue=function(){return this.rootElement.value},n.prototype.getFormattedValue=function(){return o.intToString(o.stringToInt(this.rootElement.value))},n.prototype.setValue=function(e,t){var i,n;"number"==typeof e?(n=e,i=o.intToString(n)):(i=e,n=this._parseNumber(i)),this.rootElement.value=i,t&&this.emit("change",n)},n.prototype.setReadonly=function(e){e===!1?this.rootElement.removeAttribute("readonly"):this.rootElement.setAttribute("readonly","readonly"),this.setEnable(!e)},n.prototype.setPlaceholder=function(e){this.rootElement.placeholder=e},n.prototype.blur=function(){},n.prototype.focus=function(){},n.prototype.disable=function(){this.setEnable(!1),this.rootElement.disabled=!0},n.prototype.enable=function(){this.setEnable(!0),this.rootElement.disabled=!1}},function(e,t){},function(e,t){e.exports={TEAM_CHALLENGER:0,TEAM_DEFENDER:1,TEAM_SPECTATOR:2}},function(e,t,i){var n=i(382),o=i(29).getText;n.prototype._setupInfoBox=function(){var e=this.infoBox=this.createChild("div",{className:"infoBox",hidden:!0});e.mp=e.createChild("div",{className:"mp"}),e.ap=e.createChild("div",{className:"ap"})},n.prototype.hideInfobox=function(){this.infoBox.hide()},n.prototype.showInfobox=function(e,t){"tackle"===e&&(this.infoBox.mp.setText(t.mp?-t.mp+" "+o("ui.stats.shortMP"):""),this.infoBox.ap.setText(t.ap?-t.ap+" "+o("ui.stats.shortAP"):"")),this.infoBox.show()}},function(e,t,i){var n=i(246),o=i(382),s=i(29).getText,a=i(250).getElementPositionCenteredAt,r=i(229).position,l=i(227);o.prototype._createConfirmBox=function(){function e(){c.hide(),c.tween=null}var t,i={x:0,y:0},o=window.gui.tutorialManager,c=this.confirmBox=window.gui.gameGuiContainer.createChild("div",{className:"fightConfirmBox",hidden:!0});c.isOpen=!0,c.allowDomEvents();var u=c.createChild("div",{className:"title"}),d=c.createChild("div",{className:"content"});d.appendChild(new n({className:"cancel",scaleOnPress:!0},function(){t(!1),c.close()}));var h=d.createChild("div",{className:"mpAndAp"}),p=h.createChild("div",{className:"mp"});p.createChild("div",{className:"logo"});var m=p.createChild("div",{className:"value"}),f=h.createChild("div",{className:"ap"});f.createChild("div",{className:"logo"});var g=f.createChild("div",{className:"value"}),_=d.appendChild(new n({className:"valid",scaleOnPress:!0},function(){_.disable(),t(!0),o.inTutorial&&o.tutorialStep.checkFightConfirmValidate(),c.close()})),v=null;c.open=function(e,n,d,h,y){return v&&h&&v===h?(d(!0),void c.close()):(o.inTutorial&&o.tutorialStep.checkSelectTarget(),v=h,_.enable(),"move"===e?(u.setText(s("ui.common.move")),p.show(),m.setText(s("ui.short.movementPoints")+s("ui.common.colon")+"-"+n.mp),n.ap>0?(g.setText(s("ui.short.actionPoints")+s("ui.common.colon")+"-"+n.ap),f.show()):f.hide()):(u.setText(n.name),p.hide(),f.show(),g.setText(s("ui.short.actionPoints")+s("ui.common.colon")+"-"+n.apCost)),c.show(),i=a(c,r.x,r.y),c.isOpen?c.setStyles({webkitTransformOrigin:r.x+"px "+r.y+"px"}):c.setStyles({webkitTransform:"scale(0) translate3d("+i.x+"px,"+i.y+"px,0)",webkitTransformOrigin:r.x+"px "+r.y+"px"}),l.tween(c,{webkitTransform:"scale(1) translate3d("+i.x+"px,"+i.y+"px,0)"},{time:100,easing:"linear"}),c.isOpen=!0,y&&c.hide(),void(t=d))},c.close=function(){c.isOpen&&(c.isOpen=!1,_.disable(),v=null,l.tween(c,{webkitTransform:"scale(0) translate3d("+i.x+"px,"+i.y+"px,0)"},{time:100,easing:"linear"},e))},c.close()}},function(e,t,i){var n=i(211),o=i(394).FIGHT_STATES,s=i(382),a=i(183).dimensions,r=i(250),l=r.getElementPositionAt,c=i(229),u=c.position,d=c.getPosition,h=i(231).requestInteractionHandle,p=i(464),m=i(466),f=i(248),g=i(227),_=i(439).Tween,v=i(467),y=i(473),b=i(235),w=i(29).getText,M=i(252),T=10;s.prototype._setupTouchInteraction=function(){function e(e){if(u.isVisible()){var t=l(u,e.x,e.y);u.setStyle("webkitTransform","translate3d("+t.x+"px, "+t.y+"px, 0)")}}function t(t){var i=d(t);if(e(i),Math.abs(s-i.x)>10||Math.abs(a-i.y)>10){if(!h("TOUCH",f))return r();s=i.x,a=i.y;var n=c.convertScreenToCanvasCoordinate(s,a);p.touchMove(n.x,n.y,this.tapOptions)}}var i,n,s,a,r,c=this,u=this.infoBox,p=window.isoEngine,m=window.gui.fightManager,f={};r=function(){n=!0,p.touchCancel(),c.removeListener("dom.touchmove",t)},this.on("dom.touchstart",function(e){if(i)return r();var l=d(e);this.locked||l.touchCount>1||(s=l.x,a=l.y,i=!0,n=!1,m.fightState===o.BATTLE&&this.on("dom.touchmove",t))}),this.on("dom.touchend",function(e){if(this.removeListener("dom.touchmove",t),this.locked||n||!i||!h("TOUCH",f))return void(i=!1);i=!1;var o=d(e),s=c.convertScreenToCanvasCoordinate(o.x,o.y);p.touchEnd(s.x,s.y,this.tapOptions)}),this._setupHighlightInteraction(),this._setupCameraInteraction()},s.prototype.handleTapAfter=function(e){var t=this;e.on("tap",function(e){var i=t.convertScreenToCanvasCoordinate(e.x,e.y);window.isoEngine.touchEnd(i.x,i.y,t.tapOptions)})},s.prototype._setupHighlightInteraction=function(){function e(){window.clearTimeout(N),N=window.setTimeout(function(){C.closeTooltip()},500)}function t(e){for(var t,i,n,o,s=e.humanoidInfo.options||[],a=0;a<s.length;a+=1){var r=s[a];"HumanOptionGuild"===r._type?n=r.guildInformations:"HumanOptionAlliance"===r._type?o=r.allianceInformations:"HumanOptionOrnament"===r._type?i=r.ornamentId:"HumanOptionTitle"===r._type&&(t=r.titleId)}var l=e.alignmentInfos.characterPower-e.actorId,c=window.gui.playerData.getLevelDiff(l);m.setAttributes({charName:e.name,titleId:t,ornamentId:i,guild:n,alliance:o,gender:e.humanoidInfo.sex,alignmentInfos:e.alignmentInfos,levelDiff:c}),m.display()}function i(){_.getChild("ornamentTooltip")&&_.removeChild("ornamentTooltip"),_.getChild("propertyInfoTooltip")&&_.removeChild("propertyInfoTooltip"),_.clearContent()}function o(e){window.clearTimeout(N);var t=e.bbox,i=O.convertSceneToCanvasCoordinate(t[0],t[2]),o=O.convertSceneToCanvasCoordinate(t[1],t[3]),s=(i.x+o.x)/2,a=(i.y+o.y)/2,r=o.x-i.x,l=o.y-i.y,c=n.isFeatureOn("singleTooltip")?_:null;C.openTooltipAt(s,a,r,l+2*T,c)}function s(t){var i=S.getFighter(t.actorId);return i?(_.appendChild(i.createStatsTooltipContent()),window.isoEngine.displayEnemyMovementZone(i),!0):(C.openState&&(e(),window.isoEngine.removeEnemyMovementZone()),!1)}function a(){x&&x.nicknameLabel&&"name"===x.nicknameLabel.getType()&&x.nicknameLabel.show()}function r(i,n){if(a(),n.name&&n.humanoidInfo){if(x=i,i.nicknameLabel){if("full"===i.nicknameLabel.getType())return C.closeTooltip(),!1;i.nicknameLabel.hide()}return t(n),C.hideBackgroundOnce(),!1}if(n.npcData&&n.npcData.nameId)_.setText(n.npcData.nameId);else if("GameRolePlayGroupMonsterInformations"===n.type){var o=window.gui.playerData.partyData.getClassicalParty(),s=o?o.getMemberCount():1,r=[],l=[n.staticInfos.mainCreatureLightInfos].concat(n.staticInfos.underlings),c=i.data.scaleLevel;if(c){var u=window.gui.playerData.ToaData.getMonsterLevelScaled(c);for(m=0;m<l.length;m+=1)l[m].staticInfos.level=u}for(var d=l.sort(function(e,t){return t.staticInfos.level-e.staticInfos.level}),h=0,m=0,f=d.length;m<f;m+=1){var g=d[m],v=g.staticInfos;g&&(h+=v.level,r.push({id:g.creatureGenericId,xp:v.xp,level:v.level}))}_.addClassNames("monsterInfoTooltip"),_.createChild("div",{className:"level",text:w("ui.common.rank",M.intToString(h))}),_.appendChild(new p(n.ageBonus));var y=M.getXpPreview(r,window.gui.playerData,null,n.ageBonus),b=M.getXpPreview(r,window.gui.playerData,o,n.ageBonus),T=_.createChild("div",{className:"xpPreview"});T.createChild("div",{text:w("ui.tooltip.monsterXpAlone",M.intToString(y))}),s>1&&T.createChild("div",{text:w("ui.tooltip.monsterXpParty",M.intToString(b))});for(var I=0,A=d.length;I<A;I+=1)g=d[I].staticInfos,g&&_.createChild("div",{text:g.nameId+" ("+g.level+")"})}else{if("PaddockObject"!==n.type)return C.openState&&e(),!1;var S=n.durability.durability+"/"+n.durability.durabilityMax;_.setText(n.name+" ("+S+")")}return!0}function l(e,t){var i=t.guildInfo,n=t._type,o=t.price,s=t.maxOutdoorMount,a=t.maxItems,r="",l="";switch(n){case"PaddockInformations":r=w("ui.mount.paddockPublic"),l=w("ui.mount.maxMount",s);break;case"PaddockAbandonnedInformations":r=w("ui.mount.paddockAbandonned"),l=w("ui.mount.maxMount",s);break;case"PaddockPrivateInformations":r=o>0?w("ui.mount.paddockToBuy",o):w("ui.mount.paddockPrivate"),l=w("ui.mount.paddockSize",s,a);break;case"PaddockBuyableInformations":r=t.locked?w("ui.social.paddockWithNoOwner"):w("ui.mount.paddockToBuy",o),l=w("ui.mount.paddockSize",s,a)}var c={guild:i,line1:r,line2:l};L=e,g.display(c)}function c(e,t){var i=A.playerData,n=t.ownerName,o=w("ui.house.homeOf",n),s=t.houseId,a=i.identification.nickname,r=i.position.currentMapHouses[s]||null,l=r&&r.guildInfo||null;"?"===n||""===n?o=w("ui.common.houseWithNoOwner"):n===a&&(o=w("ui.common.myHouse"));var c=null;r&&(r.isOnSale||r.isSaleLocked)&&(c=w(r.isSaleLocked?"ui.common.forSaleSoon":"ui.common.forSale"));var u={guild:l,line1:o,line2:c};L=e,g.display(u)}function d(){var t=h.convertScreenToCanvasCoordinate(u.x,u.y),n=I.holdAndMove(t.x,t.y);if(!n)return E=null,void(C.openState&&e());if(E!==n){E=n,C.resetBackground();var a,d,m,f,g=I.mapRenderer.isPaddock(n),v=I.mapRenderer.getPaddockProperties(),y=n.data,b=A.playerData.isFighting;if(g&&v)return i(),void l(n,v);if(y){if(i(),b){if(!s(y))return}else if(!r(n,y))return}else{if(a=D.interactiveElements[n.id],!a||b)return void(C.openState&&e());i();var w=a._houseData;if(a.ageBonus){var M=a.ageBonus;_.appendChild(new p(M))}if(a._name&&_.createChild("div",{className:"name",text:a._name}),w)return void c(n,w);var T;for(m=0,f=a.enabledSkills.length;m<f;m+=1)d=a.enabledSkills[m],T=_.createChild("div"),T.createChild("div",{className:["interaction","cursor","id"+d._cursor]}),T.createChild("div",{className:"interaction",text:d._name});for(m=0,f=a.disabledSkills.length;m<f;m+=1)d=a.disabledSkills[m],T=_.createChild("div"),T.createChild("div",{className:["interaction","cursor","id"+d._cursor,"disable"]}),T.createChild("div",{className:"interaction",text:d._name})}o(n)}}var h=this,m=new v({name:"ornamentTooltip"},{scaleFactor:.8}),g=new y({name:"propertyInfoTooltip"}),_=new b("div",{className:"sceneTooltip"});f.addTooltip(this,new b("div"));var C,I=window.isoEngine,A=window.gui,S=A.fightManager;C=n.isFeatureOn("singleTooltip")?A.tooltipBox:this.appendChild(new f({content:_}));var E,x,L,N,O=I.mapScene,D=I.mapRenderer;this.on("tooltipOn",function(){window.gui.tooltipBox.closeForRecomputing(),E=null,I.holdStart(),A.wBody.on("dom.touchmove",d),d()}),this.on("tooltipOut",function(){C.closeTooltip(),a(),A.wBody.removeListener("dom.touchmove",d),I.holdEnd()}),m.on("rendered",function(){x===E&&(_.appendChild(m),o(x))}),g.on("rendered",function(){L===E&&(_.appendChild(g),o(L))})},s.prototype._setupCameraInteraction=function(){function e(e){D[A]=e[A]-E[A],D[S]=e[S],D[A]<L.min?(D[A]=L.min,E[A]=e[A]-L.min):D[A]>L.max&&(D[A]=L.max,E[A]=e[A]-L.max),b.setStyle("webkitTransform","translate3d("+D.x+"px,"+D.y+"px,0)")}function t(e){N[S]=D[S];var t=n.convertScreenToCanvasCoordinate(N.x,N.y);if(C=r.getChangeMapCellAt(t.x,t.y,w),b.arrow.setStyle("opacity",C!==-1?1:0),e[S]<M)I=Math.abs(M-e[S]),P[S]=c.min[S];else{if(!(e[S]>T))return;I=Math.abs(T-e[S]),P[S]=c.max[S]}if(P[S]!==c[S]){R.x=c.x,R.y=c.y,c.follow(R);var i=0,o=k,s=R[S],a=P[S];Math.abs(P[S]-R[S])>i&&(i=Math.abs(P[S]-R[S]),o=k*I);var l=B[S];l.playing||l.start(!1),"x"===S?l.reset().from({x:s}).to({x:a},i/o):l.reset().from({y:s}).to({y:a},i/o)}}m(this);var i,n=this,s=window.gui,r=window.isoEngine,l=r.mapScene,c=l.camera,u=s.fightManager,d=0,h=0,p=this.createChild("div",{className:["slide","left"]});p.arrow=p.createChild("div",{className:"arrow"});var f=this.createChild("div",{className:["slide","right"]});f.arrow=f.createChild("div",{className:"arrow"});var v=this.createChild("div",{className:["slide","top"]});v.arrow=v.createChild("div",{className:"arrow"});var y=this.createChild("div",{className:["slide","bottom"]});y.arrow=y.createChild("div",{className:"arrow"});var b,w,M,T,C,I,A,S,E={x:0,y:0},x={x:80,y:60},L={max:0,min:0},N={},O=5,D={x:0,y:0},R={},P={x:0,y:0},B={x:new _(R,["x"]),y:new _(R,["y"])};this.on("transformStart",function(e,t){if(this.locked)return this.cancelTransform();if(b=null,u.fightState===o.UNDEFINED&&1===e.touchCount){var n=e.x-t[0].x,s=e.y-t[0].y;E=e;var r,l=c.zoom===c.minZoom||c.zoom===c.maxZoom;if(Math.abs(n)>Math.abs(s)){if(r=l||Math.abs(s)<O,Math.abs(c.x-c.min.x)<1&&n>0&&r)return b=p,w="left",N.x=a.mapLeft,L.min=0,L.max=x.x,M=a.mapHeight/3,T=2*M,A="x",void(S="y");if(Math.abs(c.x-c.max.x)<1&&n<0&&r)return b=f,w="right",N.x=a.mapRight,L.min=-x.x,L.max=0,M=a.mapHeight/3,T=2*M,A="x",void(S="y")}else{if(r=l||Math.abs(n)<O,Math.abs(c.y-c.min.y)<1&&s>0&&r)return b=v,w="top",N.y=0,L.min=0,L.max=x.y,M=a.mapWidth/3,
T=2*M,A="y",void(S="x");if(Math.abs(c.y-c.max.y)<1&&s<0&&r)return b=y,w="bottom",N.y=a.mapHeight,L.min=-x.y,L.max=0,M=a.mapWidth/3,T=2*M,A="y",void(S="x")}}d=h=0,this.setTranslationEnable(!0),i=Date.now()});var k=.5;this.on("transform",function(n,o,s,a,u,p){return b?(e(p),void t(p)):(r.cancelCameraMovement(),i=Date.now(),c.zoom===c.minZoom&&(s=a=0),d=.5*d+.5*-s,h=.5*h+.5*-a,void l.move(n,o,-s,-a,u))}),this.on("transformEnd",function(){if(B.x.playing&&B.x.stop(),B.y.playing&&B.y.stop(),b){var e;if(e="x"===A?"translate3d(0,"+D.y+"px,0)":"translate3d("+D.x+"px,0,0)",g.tween(b,{webkitTransform:e},{time:200,easing:"ease-out"}),b.arrow.setStyle("opacity",0),b=null,this.locked)return;if(Math.abs(D[A])===x[A]&&C!==-1){var t=n.convertScreenToCanvasCoordinate(N.x,N.y),s=l.convertCanvasToSceneCoordinate(N.x,N.y);r._tapRoleplay(s.x,s.y,r.mapRenderer.getCellId(s.x,s.y),{canvasX:t.x,canvasY:t.y,changeMapRequest:w,mode:"roleplay"})}}else this.setTranslationEnable(u.fightState!==o.BATTLE),Date.now()-i>100||c.addInertia(d,h,.8)}),u.on("fightEnterBattle",function(){n.setTranslationEnable(!1)}),u.on("fightEnd",function(){n.setTranslationEnable(!0)}),s.playerData.position.on("mapUpdate",function(){c.follow(window.isoEngine.actorManager.userActor)})},s.prototype.convertScreenToCanvasCoordinate=function(e,t){return{x:e-(a.mapLeft+a.bodyPaddingLeft),y:t-a.mapTop}},s.prototype.convertCanvasToScreenCoordinate=function(e,t){return{x:e+(a.mapLeft+a.bodyPaddingLeft),y:t+a.mapTop}},s.prototype.convertScreenToSceneCoordinate=function(e,t){return e-=a.mapLeft+a.bodyPaddingLeft,t-=a.mapTop,window.isoEngine.mapScene.convertCanvasToSceneCoordinate(e,t)},s.prototype.convertSceneToScreenCoordinate=function(e,t){var i=window.isoEngine.mapScene.convertSceneToCanvasCoordinate(e,t);return{x:i.x+(a.mapLeft+a.bodyPaddingLeft),y:i.y+a.mapTop}}},function(e,t,i){function n(e){e=void 0===e||e,this.castingSpellId=null,this.casterId=null,this.targetedCell=null,this.spell=null,this.spellRank=null,this.markId=null,this.markType=null,this.silentCast=null,this.weaponId=-1,this.isCriticalHit=null,this.isCriticalFail=null,e&&(this.castingSpellId=n.uniqueSpellId++)}function o(){r.call(this),this.turnCount=0,this.fightId=null,this.turnsList=[],this.deadTurnsList=[],this.currentFighterId=0,this._lastFighterId=0,this._fighters={},this.FIGHT_STATES=O,this.fightState=O.UNDEFINED,this.fightType=D,this.isInReconnection=!1,this.isInactive=!1,this.turnStartTime=0,this.spellCastCounts={},this.spellBuffsToIgnore=[],this.buffSkipped=[],this.fightMessagesStack=[],this.isProcessing=!1,this.asyncFightMessages={GameActionFightDispellableEffectMessage:this.addDispellableEffect,GameActionFightCloseCombatMessage:this.gameActionFightCloseCombatAndSpell,GameActionFightSpellCastMessage:this.gameActionFightCloseCombatAndSpell},a=window.gui.playerData,this._isTurnEndRequestPending=!1,this._finishFightSequenceCb=null,this.fightSecretOn=!1,this.fightHelpOn=!1}function s(e){switch(e._messageType){case"GameFightRefreshFighterMessage":case"GameFightShowFighterMessage":return e.informations;case"GameActionFightSummonMessage":return e.summon;default:return null}}var a,r=i(209).EventEmitter,l=i(29).getText,c=i(230),u=i(191).inherits,d=i(195),h=i(395),p=i(396),m=i(397),f=i(414),g=i(399),_=i(459),v=i(411),y=i(31),b=i(225),w=i(409),M=i(461),T=M.pushStep,C=i(462).SpellData.SPELL_STATUS,I=i(269),A=i(205).shallowCopyArray,S=1e4,E=1024,x=1097,L=1008,N=_.WEAPON_SPELL_ID,O={UNDEFINED:-1,PREPARATION:0,BATTLE:1},D=-1,R={isSecret:p.FIGHT_OPTION_SET_SECRET,isRestrictedToPartyOnly:p.FIGHT_OPTION_SET_TO_PARTY_ONLY,isClosed:p.FIGHT_OPTION_SET_CLOSED,isAskingForHelp:p.FIGHT_OPTION_ASK_FOR_HELP},P=[p.FIGHT_OPTION_SET_TO_PARTY_ONLY,p.FIGHT_OPTION_SET_CLOSED,p.FIGHT_OPTION_ASK_FOR_HELP,p.FIGHT_OPTION_SET_SECRET];n.uniqueSpellId=0;var B;u(o,r),e.exports=o,o.FIGHT_STATES=O,o.FIGHT_OPTION_KEY_TO_ENUM=R,o.FIGHT_OPTION_ICON_ID=P,o.prototype.INCREMENT_MODE_SOURCE=1,o.prototype.INCREMENT_MODE_TARGET=2,o.prototype.getFighters=function(){return"fightPlacement"===window.foreground.tapOptions.mode?this.getOrdonnedPreFighters():this.turnsList},o.prototype.getDeadFighters=function(){return this.deadTurnsList},o.prototype.getAvailableFighters=function(){return this._fighters},o.prototype.getFighter=function(e){return this._fighters[e]},o.prototype.getTurnCount=function(){return this.turnCount},o.prototype.getFighterSpell=function(e,t,i){var n=this.getAvailableFighters(),o=n[t];if(!o)return i(new Error("Spell "+e+" could not be found, its fighter "+t+" does not exist"));if(o.spells[e])return i(null,o.spells[e]);var s=a.characters.mainCharacter.spellData;if(s.spells[e])return o.spells[e]=s.spells[e].clone(),o.spells[e].setLevel(s.spells[e].level),i(null,o.spells[e]);for(var r in n){var l=n[r];if(l.id!==t&&l.spells[e])return o.spells[e]=l.spells[e].clone(),i(null,o.spells[e])}_.createSpells([e],function(t,n){return t?i(t):(o.spells[e]=n[e],i(null,o.spells[e]))})},o.prototype._checkInactivityOnTurnStart=function(){this.isInactive&&(c.isActiveSince(this.turnStartTime)?this.isInactive=!1:this.finishTurn()),this.turnStartTime=Date.now()},o.prototype.finishTurn=function(){window.dofus.sendMessage("GameFightTurnFinishMessage"),this._isTurnEndRequestPending=!0},o.prototype._checkInactivityOnTurnEnd=function(){!this.isInactive&&!c.isActiveSince(this.turnStartTime)&&Date.now()-this.turnStartTime>S&&(this.isInactive=!0,window.gui.openSimplePopup(l("ui.fight.inactivityMessage"),l("ui.fight.inactivityTitle")))},o.prototype.initialize=function(e){function t(){e.timeline&&e.timeline.close(),r.turnsList=[],r.deadTurnsList=[],r.fightId=null,r.currentFighterId=0,r._lastFighterId=0;for(var t in r._fighters)r.removeFighter(t);r._fighters={},r.fightState=O.UNDEFINED,r.fightType=D,r.isInReconnection=!1,r.spellCastCounts={},r.fightMessagesStack=[],r.isProcessing=!1,a.isFightLeader=!1,a.isFighting=!1,a.isSpectator=!1,a.characters.switchControlledCharacter(a.characters.mainCharacterId),a.characters.mainCharacter.currentSummonedCreature=0,a.characters.mainCharacter.currentSummonedBomb=0,a.characters.clearSlaves(),window.actorManager.removeTeamCircles(),window.actorManager.clearQueuedToCarryActors(),r._isTurnEndRequestPending=!1,r._finishFightSequenceCb=null}function i(e){var t=e.id;r.currentFighterId=t,"GameFightTurnResumeMessage"!==e._messageType&&r.decrementDuration(t),a.characters.canControlCharacterId(t)&&(r.spellCastCounts={},r._checkInactivityOnTurnStart(),window.isoEngine.displayTextBanner("tablet.fight.animation.userTurn")),r.emit("GameFightTurnStart",e.id,e.waitTime,d.getValue("turnPicture")),r._isTurnEndRequestPending=!1}function n(e){if(r.fightState===O.PREPARATION){var t=s(e);r.emit("UpdatePreFightersList",t.contextualId)}}function o(e,t){var i=r.getAvailableFighters(),n=i[e];if(!n||!n.data.alive)return console.warn("Fighter was killed previously.");T(M.fightDeathStep,[B?B.castingSpellId:-1,e,!t]);var o=n.data.stats.summoner;a.characters.canControlCharacterId(o)&&(n.isBomb?a.characters.removeSummonedBomb(o):a.characters.removeSummonedCreature(o),r.emit("updateSpellsAvailability"))}var r=this,l=window.dofus.connectionManager;e.on("GameFightStartMessage",function(){r.fightState=O.BATTLE,r.emit("fightEnterBattle"),r.prepareSpellsWithInitialCooldown(a.characters.mainCharacter);for(var e in a.characters.slaves)r.prepareSpellsWithInitialCooldown(a.characters.slaves[e]);window.isoEngine.displayTextBanner("tablet.fight.animation.fightStarts"),window.actorManager.removeReadyIcon()}),e.on("GameFightStartingMessage",function(t){r.fightType=t.fightType,r.turnCount=0,e.timeline.show(),r.emit("fightStart")}),e.on("disconnect",function(){t(),w.reset()}),e.on("GameFightEndMessage",function(e){var i=r.getAvailableFighters();e.results&&e.results.length>0&&b.open("fightEnd",{msg:e,fighters:i}),w.flush(function(e){e&&console.error(e),t(),a.isSpectator||w.send(h.FIGHT_END),w.reset()}),window.gui.playerData.evaluateRatingOpening("fightEnd",{fighters:i})}),e.on("GameFightTurnResumeMessage",function(e){i(e)}),e.on("GameFightTurnStartMessage",function(e){i(e)}),e.on("GameFightTurnStartSlaveMessage",function(e){i(e)}),e.on("GameFightHumanReadyStateMessage",function(e){e.characterId===a.id&&r.emit("playerReady",e.isReady),window.actorManager.setReadyIconOnActor(e.characterId,e.isReady)}),e.on("confirmTurnEnd",function(){if(r._lastFighterId){var e=r._lastFighterId,t=r.getFighter(e);if(!t)return console.warn("Turn confirmation failed, fighter does not exist:",e);if(t.markFinishingBuffs(),t.data.stats.actionPoints=t.data.stats.maxActionPoints,t.data.stats.movementPoints=t.data.stats.maxMovementPoints,e===a.characters.controlledCharacterId){var i=a.characters.getControlledCharacter();i.setCharacteristic("actionPointsCurrent",t.data.stats.maxActionPoints),i.setCharacteristic("movementPointsCurrent",t.data.stats.maxMovementPoints);for(var n in t.spells){var o=t.spells[n];o.newTurn()}r._checkInactivityOnTurnEnd(),window.isoEngine.displayTextBanner("tablet.fight.animation.endOfUserTurn")}r.prepareNextPlayableCharacter(),r.emit("GameFightTurnEnd",e)}}),e.on("GameFightTurnEndMessage",function(e){var t=e.id;r._lastFighterId=t;var i=r.getFighter(t);if(!i)return console.warn("Turn end failed, fighter does not exist");if(!i.data.alive&&(r.decrementDuration(t),i.markFinishingBuffs(),i.data.stats.actionPoints=i.data.stats.maxActionPoints,i.data.stats.movementPoints=i.data.stats.maxMovementPoints,r.emit("GameFightTurnEnd",t),t===a.characters.controlledCharacterId))for(var n in i.spells){var o=i.spells[n];o.newTurn()}}),e.on("GameFightShowFighterMessage",function(e){r.loadFighter(e),n(e)}),e.on("GameFightShowFighterRandomStaticPoseMessage",function(e){r.loadFighter(e)}),e.on("GameActionFightSummonMessage",function(e){n(e);var t=e.sourceId,i=e.actionId,o=e.summon;if(t===a.id&&i!==g.ACTION_SUMMON_STATIC_CREATURE){var s=r.getFighter(o.contextualId);if(!s)return console.error(new Error("Summoning failed, fighter does not exist"));i===L||s.isBomb?a.characters.addSummonedBomb():s.isCreature&&a.characters.addSummonedCreature()}T(M.fightSummonStep,[B?B.castingSpellId:-1,t,o])}),e.on("GameFightTurnListMessage",function(e){r.turnsList=e.ids,r.deadTurnsList=e.deadsIds,r.emit("FightersListUpdated")}),e.on("GameFightSynchronizeMessage",function(e){var t=e.fighters,i=r.getAvailableFighters();if(e._synchronizeBuff)for(var n in i)i[n].enableBuffs();for(var o=0;o<t.length;o++){var s=t[o];if(s.alive){var a=i[s.contextualId];if(!a)return console.error(new Error("Synchronizing failed, fighter does not exist"));a.synchronizeData(s)}}}),e.on("GameFightLeaveMessage",function(e){var t=e.charId;t===a.id&&("fightPlacement"===window.foreground.tapOptions.mode||a.isSpectator)&&r.emit("gameFightLeave",t)}),e.on("_GameActionFightLeaveMessage",function(e){o(e.targetId,!0)}),e.on("GameActionFightDeathMessage",function(e){o(e.targetId,!1)}),e.on("GameFightRefreshFighterMessage",function(e){var t=e.informations,i=t.contextualId,n=r.getFighter(i);return n?(n.data.updateData({look:t.look,disposition:t.disposition}),void("fightPlacement"===window.foreground.tapOptions.mode&&(n.updateFighterIllustration(),r.emit("UpdatePreFightersList",i)))):console.error("Refreshing fighter failed, fighter "+i+" does not exist")}),e.on("GameFightRemoveTeamMemberMessage",function(e){var t=e.charId;r.removeFighter(t),"fightPlacement"===window.foreground.tapOptions.mode&&r.emit("UpdatePreFightersList",t)}),e.on("GameFightNewRoundMessage",function(e){r.turnCount=e.roundNumber-1,r.emit("TurnCountUpdated",e.roundNumber-1)}),e.on("GameFightResumeMessage",function(e){r.gameFightResumeMessage(e)}),e.on("GameFightResumeWithSlavesMessage",function(e){r.gameFightResumeMessage(e)}),e.on("GameFightSpectateMessage",function(e){r.gameFightResumeMessage(e)}),e.on("GameActionFightChangeLookMessage",function(e){var t=e.targetId,i=r.getFighter(t);if(!i)return console.error(new Error("Changing fighter's look failed, fighter does not exist"));var n=e.entityLook;i.data.updateData({look:n}),i.updateFighterIllustration(),r.emit(h.FIGHTER_CHANGE_LOOK,[t,n],t)}),e.on("GameActionFightDispellEffectMessage",function(e){T(M.fightDispelEffectStep,[B?B.castingSpellId:-1,e.targetId,e.boostUID])}),e.on("GameActionFightDispellSpellMessage",function(e){T(M.fightDispelSpellStep,[B?B.castingSpellId:-1,e.targetId,e.spellId])}),e.on("GameActionFightDispellMessage",function(e){T(M.fightDispelStep,[B?B.castingSpellId:-1,e.targetId])}),e.on("GameActionFightNoSpellCastMessage",function(e){var t,i=e.spellLevelId,n=a.characters.getControlledCharacter();if(t=0===i?n.spellData.spells[N]:n.spellData.getSpellBySpellLevelId(e.spellLevelId),t&&r.spellCastCounts[t.id]){r.spellCastCounts[t.id]-=1;var o=t.getProperty("apCost",t.level);n.setCharacteristic("actionPointsCurrent",n.characteristics.actionPointsCurrent+o)}}),e.on("GameActionFightLifePointsGainMessage",function(e){T(M.fightLifePointsVariationStep,[B?B.castingSpellId:-1,e.targetId,e.delta,0,e.actionId,0])}),e.on("GameActionFightLifePointsLostMessage",function(e){T(M.fightLifePointsVariationStep,[B?B.castingSpellId:-1,e.targetId,-e.loss,-e.permanentDamages,e.actionId,0])}),e.on("GameActionFightLifeAndShieldPointsLostMessage",function(e){T(M.fightShieldPointsVariationStep,[B?B.castingSpellId:-1,e.targetId,-e.shieldLoss,e.actionId]),T(M.fightLifePointsVariationStep,[B?B.castingSpellId:-1,e.targetId,-e.loss,-e.permanentDamages,e.actionId,e.shieldLoss])}),e.on("GameActionFightPointsVariationMessage",function(e){var t=e.targetId,i=e.actionId,n=e.delta;i===g.ACTION_CHARACTER_ACTION_POINTS_USE||i===g.ACTION_CHARACTER_ACTION_POINTS_LOST||i===g.ACTION_CHARACTER_ACTION_POINTS_WIN?T(M.fightActionPointsVariationStep,[B?B.castingSpellId:-1,t,n,i===g.ACTION_CHARACTER_ACTION_POINTS_USE]):i!==g.ACTION_CHARACTER_MOVEMENT_POINTS_USE&&i!==g.ACTION_CHARACTER_MOVEMENT_POINTS_LOST&&i!==g.ACTION_CHARACTER_MOVEMENT_POINTS_WIN||T(M.fightMovementPointsVariationStep,[B?B.castingSpellId:-1,t,n,i===g.ACTION_CHARACTER_MOVEMENT_POINTS_USE])}),e.on("GameActionFightVanishMessage",function(e){var t=e.targetId,i=r.getFighter(t);return i?(i.setAlive(!1),i.dispel(!1,!1,!0),void r.removeLinkedBuff(t)):console.error(new Error("Vanish failed, fighter does not exist"))}),l.on("CharacterSelectedForceMessage",function(){r.isInReconnection=!0}),e.on("GameFightJoinMessage",function(e){r.fightState=e.isFightStarted?O.BATTLE:O.PREPARATION,r.fightType=e.fightType;var t=e.isSpectator;t?window.actorManager.userActor.hide():window.actorManager.userActor.show(),a.isSpectator=t,a.isFighting=!0,e.isFightStarted?(window.isoEngine.displayTextBanner("tablet.fight.animation.fightStarts"),r.emit("fightEnterBattle","PREPARATION_SKIPPED")):(window.isoEngine.displayTextBanner("tablet.fight.animation.preparationPhase"),r.emit("fightEnterPreparation",e))}),e.on("GameActionFightSpellCooldownVariationMessage",function(e){T(M.fightSpellCooldownVariationStep,[B?B.castingSpellId:-1,e.targetId,e.spellId,e.value])}),e.on("GameActionFightModifyEffectsDurationMessage",function(e){T(M.fightModifyEffectsDurationStep,[B?B.castingSpellId:-1,e.sourceId,e.targetId,e.delta])}),e.on("GameActionFightExchangePositionsMessage",function(e){T(M.fightExchangePositionsStep,[B?B.castingSpellId:-1,e.sourceId,e.casterCellId,e.targetId,e.targetCellId])}),e.on("GameActionFightSlideMessage",function(e){T(M.fightSlideStep,[B?B.castingSpellId:-1,e.targetId,e.endCellId])}),e.on("GameActionFightTeleportOnSameMapMessage",function(e){T(M.fightTeleportOnSameMapStep,[B?B.castingSpellId:-1,e.targetId,e.cellId])}),e.on("GameMapMovementMessage",function(e){var t=e.keyMovements[e.keyMovements.length-1];T(M.mapMovementStep,[B?B.castingSpellId:-1,e.actorId,t])}),e.on("GameActionFightCarryCharacterMessage",function(e){T(M.fightCarryCharacterStep,[B?B.castingSpellId:-1,e.sourceId,e.targetId])}),e.on("GameActionFightThrowCharacterMessage",function(e){T(M.fightThrowCharacterStep,[B?B.castingSpellId:-1,e.sourceId,e.targetId,e.cellId])}),e.on("GameActionFightDropCharacterMessage",function(e){T(M.fightThrowCharacterStep,[B?B.castingSpellId:-1,e.sourceId,e.targetId,e.cellId])}),e.on("sendAllFightEvent",function(){w.flush()}),e.on("GameActionFightReduceDamagesMessage",function(e){T(M.fightReduceDamages,[B?B.castingSpellId:-1,e.targetId,e.amount])}),e.on("GameActionFightDodgePointLossMessage",function(e){var t=e.actionId;t===g.ACTION_FIGHT_SPELL_DODGED_PA?T(M.fightActionPointsLossDodge,[B?B.castingSpellId:-1,e.targetId,e.amount]):t===g.ACTION_FIGHT_SPELL_DODGED_PM&&T(M.fightMovementPointsLossDodge,[B?B.castingSpellId:-1,e.targetId,e.amount])}),e.on("GameActionFightSpellImmunityMessage",function(e){T(M.fightSpellImmunity,[B?B.castingSpellId:-1,e.targetId])}),e.on("GameActionFightReflectSpellMessage",function(e){T(M.fightReflectSpellStep,[B?B.castingSpellId:-1,e.targetId])}),e.on("GameActionFightReflectDamagesMessage",function(e){T(M.fightReflectDamagesStep,[B?B.castingSpellId:-1,e.sourceId])}),e.on("GameActionFightTackledMessage",function(e){T(M.fightTackledStep,[B?B.castingSpellId:-1,e.sourceId])}),e.on("GameActionFightKillMessage",function(e){T(M.fightKillStep,[B?B.castingSpellId:-1,e.targetId,e.sourceId])}),e.on("GameActionFightInvisibilityMessage",function(e){T(M.fightInvisibilityStep,[B?B.castingSpellId:-1,e.targetId,e.state])}),e.on("GameActionFightTriggerGlyphTrapMessage",function(e){T(M.fightTriggerGlyphTrapStep,[B?B.castingSpellId:-1,e.triggeringCharacterId,e.sourceId,e._spellId])}),e.on("GameFightUpdateTeamMessage",function(e){r.fightId=e.fightId,a.isFightLeader=e.team.leaderId===a.id}),e.on("GameFightOptionStateUpdateMessage",function(e){r.fightId=e.fightId,e.option===p.FIGHT_OPTION_SET_SECRET?r.fightSecretOn=e.state:e.option===p.FIGHT_OPTION_ASK_FOR_HELP&&(r.fightHelpOn=e.state),r.emit("fightOptionUpdate",e)}),e.on("GameContextDestroyMessage",function(){I.isRoleplayMode||(r.fightState=O.UNDEFINED)})},o.prototype.getNextControllableCharacterId=function(){var e=this.turnsList,t=e.length;if(0===t)return a.characters.controlledCharacterId;for(var i=e.indexOf(this.currentFighterId),n=1;n<t;n++){var o=e[(i+n)%t],s=this.getFighter(o);if(!s)return console.error(new Error("Find next controllable character failed, fighter does not exist"));if(a.characters.canControlCharacterId(o)&&s.data.alive)return o}return a.characters.controlledCharacterId},o.prototype.prepareNextPlayableCharacter=function(){var e=this.getNextControllableCharacterId();a.characters.switchControlledCharacter(e)},o.prototype.removeFighter=function(e){var t=this.getFighter(e);return t?(t.clear(),void delete this._fighters[e]):console.warn("Removing fighter failed, it does not exist")},o.prototype.loadFighter=function(e){var t=e.actionId,i="GameFightShowFighterRandomStaticPoseMessage"===e._type||t===E||t===x,n=s(e);if(!n)return void console.warn("Fighter informations could not be extracted from this message type: "+e._messageType);var o=n.contextualId,a=this.getFighter(o);a||(a=new f(o,i),this._fighters[o]=a),a.setData(n);var r=window.actorManager.getActor(a.id);r&&r.addTeamCircle()},o.prototype.prepareSpellsWithInitialCooldown=function(e){function t(e,t){return e?console.error(e):void t.resetInitialCooldown(i.turnCount)}var i=this,n=e.spellData.getSpells(C.USABLE);for(var o in n){var s=n[o];s.isItem||0===s.spellLevel.initialCooldown||this.getFighterSpell(o,e.spellData.characterId,t)}},o.prototype.addDispellableEffect=function(e,t){function i(){function i(i,o){if(i)return console.error(i);var s=!0;if(o.hidden===!0&&(s=!1),o.timeCreationStarted=a.timeCreationStarted,o instanceof m.StateBuff&&(952===o.actionId?T(M.fightLeavingStateStep,[B?B.castingSpellId:-1,o.targetId,o.stateId,s]):T(M.fightEnteringStateStep,[B?B.castingSpellId:-1,o.targetId,o.stateId,o.effect.getDurationString(),s])),"FightTemporaryBoostEffect"===n._type){var r=e.actionId;r!==g.ACTION_CHARACTER_MAKE_INVISIBLE&&r!==g.ACTION_CHARACTER_UPDATE_BOOST&&r!==g.ACTION_CHARACTER_CHANGE_LOOK&&r!==g.ACTION_CHARACTER_CHANGE_COLOR&&r!==g.ACTION_CHARACTER_ADD_APPEARANCE&&r!==g.ACTION_FIGHT_SET_STATE&&T(M.fightTemporaryBoostStep,[B?B.castingSpellId:-1,e.effect.targetId,o.effect.description,o.effect.duration,o.effect.getDurationString(),s])}return T(M.fightDisplayBuffStep,[B?B.castingSpellId:-1,o]),delete o.timeCreationStarted,t()}var n=e.effect;m.makeBuffFromEffect(n,s,e.actionId,i)}var o=e&&e.effect&&e.effect.spellId;e.effect.effectCaller="FightManager: GameActionFightDispellableEffectMessage from spellId: "+o;var s;s=new n(e.actionId===g.ACTION_CHARACTER_UPDATE_BOOST?!1:!B),B&&(s.castingSpellId=B.castingSpellId,B.spell.id===o&&(s.spellRank=B.spellRank));var a=this;s.casterId=e.sourceId,this.getFighterSpell(o,s.casterId,function(e,n){return e?t(e):n?(s.spell=n,void i()):t(new Error("unable to find spell id "+o))})},o.prototype.gameActionFightCloseCombatAndSpell=function(e,t){var i=this,o="GameActionFightCloseCombatMessage"===e._messageType,s=0;o&&(e.spellId=N,e.spellLevel=1,s=e.weaponGenericId),this.spellCastCounts[e.spellId]&&(this.spellCastCounts[e.spellId]=this.spellCastCounts[e.spellId]-1),this.getFighterSpell(e.spellId,e.sourceId,function(r,l){if(r)return t(r);if(!l)return t(new Error("unable to find spell id "+e.spellId));B=new n,B.casterId=e.sourceId,B.spell=l,B.spellRank=o?null:l.getProperty("spellLevel",e.spellLevel),B.isCriticalFail=e.critical===v.CRITICAL_FAIL,B.isCriticalHit=e.critical===v.CRITICAL_HIT,B.silentCast=e.silentCast,o&&(B.weaponId=e.weaponGenericId),0===i.currentFighterId&&i.spellBuffsToIgnore.push(B);var c=a.characters,u=c.controlledCharacterId,d=e.sourceId===u;d&&e.critical!==v.CRITICAL_FAIL&&l.cast(i.turnCount,[e.targetId]),o&&0!==s?T(M.fightCloseCombatStep,[B?B.castingSpellId:-1,e.sourceId,s,e.critical]):T(M.fightSpellCastStep,[B?B.castingSpellId:-1,e.sourceId,e.spellId,e.critical]);var h=i.getFighter(e.sourceId),p=i.getFighter(c.controlledCharacterId),m=p&&p.data.teamId===h.data.teamId;if(!d&&m&&!B.isCriticalFail){var f=c.getControlledCharacter().spellData.getSpells(C.USABLE),g=f[e.spellId];if(g){var _=l.getProperty("globalCooldown");_===-1&&(_=g.getProperty("minCastInterval")),_&&T(M.fightSpellCooldownVariationStep,[B.castingSpellId,u,e.spellId,_])}}t()})},o.prototype._restoreSpellCooldown=function(e,t,i){if(t.cast(this.turnCount,[],!1),63===e.cooldown)return t.forceLastCastTurn(this.turnCount+e.cooldown-t.spellLevel.minCastInterval),i();var n=t.getModifiedInterval();return t.forceLastCastTurn(this.turnCount+e.cooldown-n),i()},o.prototype._restoreCooldowns=function(e,t,i){var n=this;if(!t||0===t.length)return i();var o=this.getFighter(e);return o?void y.each(t,function(t,i){if("GameFightSpellCooldown"!==t._type)return i();var s=t.spellId,a=o.spells[s];return a?n._restoreSpellCooldown(t,a,i):void n.getFighterSpell(s,e,function(e,o){return e?i(e):n._restoreSpellCooldown(t,o,i)})},function(e){i(e)}):console.error(new Error("Restoring cooldowns failed, fighter does not exist."))},o.prototype._restoreBuffs=function(e){function t(e,t,i,n){m.makeBuffFromEffect(e,t,i,function(e,t){if(e)return n(e);var i=o.getFighter(t.targetId);if(!i)return n(new Error("Restoring buffs failed, fighter does not exist"));var s=!(t instanceof m.StatBuff);return i.addBuff(t,s),n()})}function i(e,i){var a=e.effect;a.effectCaller||(a.effectCaller="restored buff spellId: "+a.spellId),s[a.targetId]||(s[a.targetId]={}),s[a.targetId][a.turnDuration]||(s[a.targetId][a.turnDuration]={});var r=s[a.targetId][a.turnDuration][a.spellId];return r?void t(a,r,e.actionId,i):(r=new n,r.casterId=e.sourceId,o.getFighterSpell(a.spellId,r.casterId,function(n,o){return n?i(n):o?(r.spell=o,s[a.targetId][a.turnDuration][a.spellId]=r,void t(a,r,e.actionId,i)):i(new Error("unable to find spell id "+a.spellId))}))}var o=this,s={};y.eachSeries(e,function(e,t){return i(e,t)},function(e){if(o.isInReconnection=!1,e)return console.error(e)})},o.prototype.gameFightResumeMessage=function(e){var t=this;if(a.characters.mainCharacter.currentSummonedCreature=e.summonCount,a.characters.mainCharacter.currentSummonedBomb=e.bombCount,this.turnCount=e.gameTurn-1,this.emit("TurnCountUpdated",e.gameTurn-1),"GameFightSpectateMessage"===e._messageType)return t._restoreBuffs(e.effects),w.flush();var i=e.slavesInfo||[];i.unshift({slaveId:a.characters.mainCharacterId,spellCooldowns:e.spellCooldowns}),y.eachSeries(i,function(e,i){return t._restoreCooldowns(e.slaveId,e.spellCooldowns,i)},function(i){return i?console.error(i):t._restoreBuffs(e.effects)})},o.prototype.getOrdonnedPreFighters=function(){var e=[],t=[],i=[],n=0,o=0,s=this.getAvailableFighters();for(var a in s){var r=s[a],l=r.data.stats;if(l){l.initiative||0===l.initiative||(console.warn("Initiative stats is not defined, it will be initialized at 0."),l.initiative=0);var c=~~(l.initiative*l.lifePoints/l.maxLifePoints);0===r.data.teamId?(i.push({fighter:a,init:c}),n+=c):(t.push({fighter:a,init:c}),o+=c)}}var u=function(e,t){return e.init===t.init?t.fighter-e.fighter:t.init-e.init};i.sort(u),t.sort(u);var d=i,h=t;(0===i.length||0===t.length||n/i.length<o/t.length)&&(d=t,h=i);var p,m=Math.min(d.length,h.length);for(p=0;p<m;p++)e.push(d[p].fighter),e.push(h[p].fighter);var f=i.length>t.length?i:t;for(m=f.length;p<m;p++)e.push(f[p].fighter);return e},o.prototype.canCastThisSpell=function(e){var t=a.characters.getControlledCharacter(),i=a.characters.controlledCharacterId,n=this.getFighter(i);if(!n)return!1;var o=n.states,s=t.spellData.getSpells(C.USABLE),r=s[e];if(!r||!r.isLoaded)return!1;var l,c=r.getProperty("apCost"),u=t.characteristics.actionPointsCurrent;if(c>u)return!1;var d=r.getProperty("canSummon");if(d&&!a.characters.canSummonCreature())return!1;var h=r.getProperty("canBomb");if(h&&!a.characters.canSummonBomb())return!1;var p=r.getProperty("statesForbidden"),m=r.getProperty("statesRequired");for(l=0;l<o.length;l++){var f=window.gui.databases.SpellStates[o[l]];if(p&&p.length>0&&p.indexOf(o[l])!==-1)return!1;if(e===N&&f&&f.preventsFight)return!1}if(m)for(l=0;l<m.length;l++)if(o.indexOf(m[l])===-1)return!1;var g=n.spells[e];if(g&&g.hasBeenCast()){var _=g.getProperty("maxCastPerTurn");if(_>0&&g.castingData.castThisTurn>=_)return!1;if(g.getCooldown()>0)return!1}return!0},o.prototype.getSpellCooldown=function(e){var t=a.characters.controlledCharacterId,i=this.getFighter(t);if(!i||!i.spells[e])return 0;var n=i.spells[e].getCooldown();return Math.max(0,n)},o.prototype.decrementDuration=function(e){this.incrementDuration(e,-1)},o.prototype.incrementDuration=function(e,t,i,n){void 0===n&&(n=this.INCREMENT_MODE_SOURCE);var o,s=this.getAvailableFighters();for(var a in s){o=[];for(var r=s[a],l=r.buffs,c=0;c<l.length;c++){var u=l[c];if(n===this.INCREMENT_MODE_SOURCE&&u.aliveSource===e||n===this.INCREMENT_MODE_TARGET&&u.targetId===e){var d=this.spellBuffsToIgnore.length;if(n===this.INCREMENT_MODE_SOURCE&&d&&this.buffSkipped.indexOf(u.id)===-1){for(var h=!1,p=0;p<d;p++){var m=this.spellBuffsToIgnore[p];if(m.castingSpellId===u.castingSpell.castingSpellId&&m.casterId===e){h=!0,this.buffSkipped.push(u.id);break}}if(h){o.map(function(e){return e.id}).indexOf(u.id)===-1&&o.push(u);continue}}var f=u.incrementDuration(t,i);u.isActive()?(o.push(u),f&&this.emit("BuffUpdate",u,r)):(u.remove(),this.emit("BuffRemove",u,r))}else o.push(u)}r.buffs=o}},o.prototype.removeLinkedBuff=function(e){var t=this.getAvailableFighters();for(var i in t)for(var n=t[i],o=A(n.buffs),s=0;s<o.length;s++){var a=o[s];a.source===e&&n.dispelUniqueBuff(a.id,!1,!0,!1),n.isBomb&&(a.aliveSource=n.data.stats.summoner)}},o.prototype.spellCastSucceeded=function(e,t){if(a.characters.controlledCharacterId===t){var i=this.spellCastCounts[e];this.spellCastCounts[e]=i?i+1:1;var n=a.characters.getControlledCharacter(),o=n.spellData.spells[e],s=o.getProperty("apCost",o.level);n.setCharacteristic("actionPointsCurrent",n.characteristics.actionPointsCurrent-s)}},o.prototype.processFightSequenceMessage=function(e){function t(e){if(e&&console.error(e),i.isProcessing=!1,i.fightMessagesStack.length)i.processFightSequenceMessage(i.fightMessagesStack.shift());else if(i._finishFightSequenceCb){var t=i._finishFightSequenceCb;i._finishFightSequenceCb=null,i.timeCreationStarted=null,t()}}if(this.timeCreationStarted=this.timeCreationStarted?this.timeCreationStarted:Date.now(),this.isProcessing)return this.fightMessagesStack.push(e);var i=this;this.isProcessing=!0;var n=this.asyncFightMessages[e._messageType];return n?(window.gui.emit(e._messageType,e),n.call(this,e,t)):(window.gui.emit(e._messageType,e),void t())},o.prototype.finishFightSequence=function(e){e&&(this._finishFightSequenceCb&&console.error("FightManager.finishFightSequence: _finishFightSequenceCb was already set"),this._finishFightSequenceCb=e),this.processFightSequenceMessage({_messageType:"sendAllFightEvent"})},o.prototype.isInBattle=function(){return this.fightState===O.BATTLE},o.prototype.isFightersTurn=function(e){return this.currentFighterId===e},o.prototype.getIsTurnEndRequestPending=function(){return this._isTurnEndRequestPending},o.prototype.isFighterOnUsersTeam=function(e){var t=this.getFighter(window.actorManager.userActor.actorId),i=this.getFighter(e);return t&&i?t.data.teamId===i.data.teamId:(console.warn("fighter not found"),!1)}},function(e,t){e.exports={UNKNOWN_FIGHT_EVENT:"unknown",FIGHTER_LIFE_GAIN:"fighterLifeGain",FIGHTER_LIFE_LOSS:"fighterLifeLoss",FIGHTER_LIFE_LOSS_AND_DEATH:"fightLifeLossAndDeath",FIGHTER_NO_CHANGE:"fighterNoChange",FIGHTER_DEATH:"fighterDeath",FIGHT_END:"fightEnd",FIGHTER_LEAVE:"fighterLeave",FIGHTER_CHANGE_LOOK:"fighterChangeLook",FIGHTER_GOT_DISPELLED:"fighterGotDispelled",FIGHTER_SPELL_DISPELLED:"fighterSpellDispelled",FIGHTER_EFFECTS_MODIFY_DURATION:"fighterEffectsModifyDuration",FIGHTER_SPELL_COOLDOWN_VARIATION:"fighterSpellCooldownVariation",FIGHTER_SPELL_IMMUNITY:"fighterSpellImmunity",FIGHTER_AP_LOSS_DODGED:"fighterDodgedAPLoss",FIGHTER_MP_LOSS_DODGED:"fighterDodgedMPLoss",FIGHTERS_POSITION_EXCHANGE:"fightersExchangedPositions",FIGHTER_VISIBILITY_CHANGED:"fighterVisibilityChanged",FIGHTER_INVISIBLE_OBSTACLE:"fighterInvisibleObstacle",FIGHTER_GOT_KILLED:"fighterGotKilled",FIGHTER_TEMPORARY_BOOSTED:"fighterTemporaryBoosted",FIGHTER_AP_USED:"fighterUsedAP",FIGHTER_AP_LOST:"fighterLostAP",FIGHTER_AP_GAINED:"fighterGainedAP",FIGHTER_MP_USED:"fighterUsedMP",FIGHTER_MP_LOST:"fighterLostMP",FIGHTER_MP_GAINED:"fighterGainedMP",FIGHTER_SHIELD_GAIN:"fighterShieldGain",FIGHTER_SHIELD_LOSS:"fighterShieldLoss",FIGHTER_REDUCED_DAMAGES:"fighterReducedDamages",FIGHTER_REFLECTED_DAMAGES:"fighterReflectedDamages",FIGHTER_REFLECTED_SPELL:"fighterReflectedSpell",FIGHTER_SLIDE:"fighterSlided",FIGHTER_CASTED_SPELL:"fighterCastedSpell",FIGHTER_CLOSE_COMBAT:"fighterCloseCombat",FIGHTER_DID_CRITICAL_HIT:"fighterDidCriticalHit",FIGHTER_DID_CRITICAL_MISS:"fighterDidCriticalMiss",FIGHTER_ENTERING_STATE:"fighterEnteredState",FIGHTER_LEAVING_STATE:"fighterLeftState",FIGHTER_STEALING_KAMAS:"fighterStoleKamas",FIGHTER_SUMMONED:"fighterSummoned",FIGHTER_GOT_TACKLED:"fighterGotTackled",FIGHTER_TELEPORTED:"fighterTeleported",FIGHTER_TRIGGERED_GLYPH:"fighterTriggeredGlyph",FIGHTER_TRIGGERED_TRAP:"fighterTriggeredTrap",FIGHTER_CARRY:"fighterCarry",FIGHTER_THROW:"fighterThrow",GLYPH_APPEARED:"glyphAppeared",GLYPH_DISAPPEARED:"glyphDisappeared",TRAP_APPEARED:"trapAppeared",TRAP_DISAPPEARED:"trapDisappeared"}},function(e,t){e.exports={FIGHT_OPTION_SET_SECRET:0,FIGHT_OPTION_SET_TO_PARTY_ONLY:1,FIGHT_OPTION_SET_CLOSED:2,FIGHT_OPTION_ASK_FOR_HELP:3}},function(e,t,i){function n(e,t,i,n){var c;switch(e._type){case"FightTemporarySpellBoostEffect":c=new s(e,t,i,n);break;case"FightTriggeredEffect":c=new l(e,t,i,n);break;case"FightTemporaryBoostWeaponDamagesEffect":c=new o(e,t,i,e.weaponTypeId,e.delta,e.weaponTypeId,n);break;case"FightTemporaryBoostStateEffect":c=new r(e,t,i,n);break;case"FightTemporarySpellImmunityEffect":c=new o(e,t,i,e.immuneSpellId,null,null,n);break;case"FightTemporaryBoostEffect":c=new a(e,t,i,n)}return c}var o=i(398),s=i(404),a=i(407),r=i(408),l=i(413);o.setStateBuff(r),t.BasicBuff=o,t.SpellBuff=s,t.StatBuff=a,t.StateBuff=r,t.TriggeredBuff=l,t.makeBuffFromEffect=n},function(e,t,i){function n(e,t,i,n,o,s,r){
if(!e)return r&&a.ensureAsync(function(){return r(new Error("No effect specified"))});this._disabled=!1,this._removed=!1,this.id=e.uid,this.uid=e.uid,this.actionId=i,this.targetId=e.targetId,this.castingSpell=t,this.hidden=!1,this._effectCaller=e.effectCaller,this._effectCaller||console.error(new Error("BB: No caller in the effect!"));for(var l=this.castingSpell.spell.spellLevel.effects,u=0;u<l.length;u++)if(i===l[u].effectId){this.hidden=l[u].hidden;break}this.duration=e.turnDuration,this.dispelable=e.dispelable,this.source=t.casterId,this.stack=null;var d=c(),h=d.gui.fightManager;h.isInReconnection||d.gui.playerData.isSpectator||0===h.currentFighterId?this.aliveSource=this.source:this.aliveSource=h.currentFighterId,this.parentBoostUid=0,this.initParam(n||0,o||0,s||0,r)}var o,s=i(399),a=i(31),r=i(400),l=i(403),c=i(189),u=i(205),d=[s.ACTION_BOOST_SPELL_RANGE,s.ACTION_BOOST_SPELL_RANGEABLE,s.ACTION_BOOST_SPELL_DMG,s.ACTION_BOOST_SPELL_HEAL,s.ACTION_BOOST_SPELL_AP_COST,s.ACTION_BOOST_SPELL_CAST_INTVL,s.ACTION_BOOST_SPELL_CC,s.ACTION_BOOST_SPELL_CASTOUTLINE,s.ACTION_BOOST_SPELL_NOLINEOFSIGHT,s.ACTION_BOOST_SPELL_MAXPERTURN,s.ACTION_BOOST_SPELL_MAXPERTARGET,s.ACTION_BOOST_SPELL_CAST_INTVL_SET,s.ACTION_BOOST_SPELL_BASE_DMG,s.ACTION_DEBOOST_SPELL_RANGE,406,787,792,793,1017,1018,1019,1035,1036,1044,1045],h=function(e){e&&console.error(e)};e.exports=n,n.prototype.getParam1=function(){return"EffectInstanceDice"===this.effect._type?this.effect.getParams()[0]:null},n.prototype.getParam2=function(){return"EffectInstanceDice"===this.effect._type?this.effect.diceSide:null},n.prototype.getParam3=function(){return"EffectInstanceInteger"===this.effect._type?this.effect.value:null},n.prototype._setParameter=function(e,t){this.effect.setParameter(e,0===t?null:t)},n.prototype.setParam1=function(e){this._setParameter(0,e)},n.prototype.setParam2=function(e){this._setParameter(1,e)},n.prototype.setParam3=function(e){this._setParameter(2,e)},n.prototype.initParam=function(e,t,i,n){n||(n=h);var o={effectId:this.actionId,duration:this.duration,trigger:this.isTrigger(),value:i,hidden:this.hidden,effectCaller:this._effectCaller};(e||t)&&(o.diceNum=e,o.diceSide=t);var s=this,a=r.createEffectInstances([o],function(e){return e?n(e):n(null,s)});this.effect=a[0]},n.prototype.updateParam=function(e,t,i){switch(this.actionId){case 788:this.setParam1(t);break;case 169:case 107:case 220:case 265:case 950:case 951:break;default:this.setParam1(e),this.setParam2(t),this.setParam3(i)}this.refreshDescription()},n.prototype.equals=function(e,t){var i=this.castingSpell.spellRank&&e.castingSpell.spellRank&&!t&&this.castingSpell.spellRank.id!==e.castingSpell.spellRank.id;if(this.targetId!==e.targetId||this.effect.effectId!==e.actionId||this.duration!==e.duration||this.effect.hasOwnProperty("delay")&&this.effect.delay!==e.effect.delay||i||!t&&this.castingSpell.spell.id!==e.castingSpell.spell.id||this.constructor!==e.constructor||this.source!==e.source||this.isTrigger())return!1;var n=this.actionId;if(788===n){if(this.getParam1()!==e.getParam1())return!1}else if(d.indexOf(n)!==-1){if(this.getParam1()!==e.getParam1())return!1}else{if(165===n)return!1;if(n===e.actionId&&(952===n||951===n||950===n)&&this instanceof o&&e instanceof o&&this.stateId!==e.stateId)return!1}return!0},n.prototype.apply=function(){this._disabled=!1,this._removed=!1},n.prototype.remove=function(){this._removed=!0,this._disabled||this.disable()},n.prototype.enable=function(){this._disabled=!1},n.prototype.disable=function(){this._disabled=!0},n.prototype.incrementDuration=function(e,t){return!(t&&!this.canBeDispell())&&(!(this.duration>=63)&&(this.duration+e>0?(this.duration+=e,this.effect.duration+=e,!0):this.duration>0&&(this.duration=0,this.effect.duration=0,!0)))},n.prototype.isActive=function(){return 0!==this.duration},n.prototype.isTrigger=function(){return!1},n.prototype.canBeDispell=function(e,t,i){if(t=void 0===t?Number.MIN_VALUE:t,t===this.id)return!0;switch(this.dispelable){case l.DISPELLABLE:return!0;case l.DISPELLABLE_BY_STRONG_DISPEL:return e;case l.DISPELLABLE_BY_DEATH:return i||e;case l.REALLY_NOT_DISPELLABLE:return t===this.id;default:return!1}},n.prototype.add=function(e){switch(this.stack||(this.stack=[],this.stack.push(this.clone())),this.stack.push(e),this.actionId){case 293:this.setParam1(e.getParam1()),this.setParam2(this.getParam2()+e.getParam2()),this.setParam3(this.getParam3()+e.getParam3());break;case 788:this.setParam1(this.getParam1()+e.getParam2());break;case 950:case 951:case 952:break;default:this.setParam1(this.getParam1()+e.getParam1()),this.setParam2(this.getParam2()+e.getParam2()),this.setParam3(this.getParam3()+e.getParam3())}this.refreshDescription()},n.prototype.isUnusableNextTurn=function(){if(this.duration>1||this.duration<0)return!1;var e=c(),t=e.gui.fightManager,i=e.gui.playerData.id,n=t.currentFighterId;if(n===i||n===this.source)return!1;var o=t.turnsList,s=o.indexOf(i),a=o.indexOf(n),r=o.indexOf(this.source);return r<a&&(r+=o.length),s<a&&(s+=o.length),!(s<r)},n.prototype.refreshDescription=function(){this.effect.forceDescriptionRefresh()},e.exports.setStateBuff=function(e){o=e},n.prototype.getDelta=function(){return console.warn("BasicBuff.prototype.getDelta should not be called directly"),0},n.prototype._copyTo=function(e){var t=u.getOwnProperties(this).filter(function(e){return"effect"!==e});u.shallowCopyProperties(this,e,t),this.effect&&(e.effect=this.effect.clone())},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t){function i(e){return s[e]?s[e][0]:null}function n(e){return!!s[e]&&s[e][1]}var o={ACTION_ENCAPSULATE_BINARY_COMMAND:993,ACTION_ENDS_TURN:-2,ACTION_INTERNAL_SEND_ACTION_BUFFER:-1,ACTION_NO_OPERATION:0,ACTION_SEQUENCE_START:83,ACTION_SEQUENCE_END:70,ACTION_CHARACTER_MOVEMENT:1,ACTION_CHARACTER_CHANGE_MAP:2,ACTION_CHARACTER_CHANGE_RESPAWN_MAP:3,ACTION_CHARACTER_TELEPORT_ON_SAME_MAP:4,ACTION_CHARACTER_PUSH:5,ACTION_CHARACTER_PULL:6,ACTION_CHARACTER_DIVORCE_WIFE_OR_HUSBAND:7,ACTION_CHARACTER_EXCHANGE_PLACES:8,ACTION_CHARACTER_DODGE_HIT:9,ACTION_CHARACTER_LEARN_EMOTICON:10,ACTION_CHARACTER_SET_DIRECTION:11,ACTION_CHARACTER_CREATE_GUILD:12,ACTION_USE_PUSHPULL_ELEMENT:14,ACTION_AREA_CHANGE_ALIGNMENT:15,ACTION_AREA_GIVE_KAMAS:16,ACTION_SCRIPT_START:17,ACTION_AREA_DUNGEON_ATTACKED:20,ACTION_GAIN_AREA_KAMAS:21,ACTION_AREA_DUNGEON_CITY_OPENED:23,ACTION_AREA_DUNGEON_HEART_OPENED:24,ACTION_AREA_DUNGEON_HEART_CLOSED:25,ACTION_AREA_CHANGE_ALIGNMENT_SUB:26,ACTION_QUEST_OBJECTIVE_VALIDATE:30,ACTION_QUEST_STEP_VALIDATE:31,ACTION_QUEST_QUEST_VALIDATE:32,ACTION_QUEST_STEP_START:33,ACTION_QUEST_START:34,ACTION_QUEST_CHECK_STARTED_OBJECTIVES:35,ACTION_QUEST_RESET:36,ACTION_START_DIALOG_WITH_NPC:40,ACTION_CARRY_CHARACTER:50,ACTION_THROW_CARRIED_CHARACTER:51,ACTION_NO_MORE_CARRIED:52,ACTION_CHARACTER_MOVEMENT_POINTS_STEAL:77,ACTION_CHARACTER_MOVEMENT_POINTS_WIN:78,ACTION_CHARACTER_MULTIPLY_RECEIVED_DAMAGE_OR_GIVE_LIFE_WITH_RATIO:79,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_PUSH:80,ACTION_CHARACTER_LIFE_POINTS_WIN_WITHOUT_ELEMENT:81,ACTION_CHARACTER_LIFE_POINTS_STEAL_WITHOUT_BOOST:82,ACTION_CHARACTER_ACTION_POINTS_STEAL:84,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_FROM_WATER:85,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_FROM_EARTH:86,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_FROM_AIR:87,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_FROM_FIRE:88,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE:89,ACTION_CHARACTER_DISPATCH_LIFE_POINTS_PERCENT:90,ACTION_CHARACTER_LIFE_POINTS_STEAL_FROM_WATER:91,ACTION_CHARACTER_LIFE_POINTS_STEAL_FROM_EARTH:92,ACTION_CHARACTER_LIFE_POINTS_STEAL_FROM_AIR:93,ACTION_CHARACTER_LIFE_POINTS_STEAL_FROM_FIRE:94,ACTION_CHARACTER_LIFE_POINTS_STEAL:95,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_WATER:96,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_EARTH:97,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_AIR:98,ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_FIRE:99,ACTION_CHARACTER_LIFE_POINTS_MALUS:1047,ACTION_CHARACTER_LIFE_POINTS_MALUS_PERCENT:1048,ACTION_CHARACTER_LIFE_POINTS_LOST:100,ACTION_CHARACTER_ACTION_POINTS_LOST:101,ACTION_CHARACTER_ACTION_POINTS_USE:102,ACTION_CHARACTER_DEATH:103,ACTION_CHARACTER_ACTION_TACKLED:104,ACTION_CHARACTER_LIFE_LOST_MODERATOR:105,ACTION_CHARACTER_LIFE_LOST_CASTER_MODERATOR:265,ACTION_CHARACTER_SPELL_REFLECTOR:106,ACTION_CHARACTER_LIFE_LOST_REFLECTOR:107,ACTION_CHARACTER_LIFE_POINTS_WIN:108,ACTION_CHARACTER_LIFE_POINTS_LOST_CASTER:109,ACTION_CHARACTER_BOOST_LIFE_POINTS:110,ACTION_CHARACTER_BOOST_ACTION_POINTS:111,ACTION_CHARACTER_BOOST_DAMAGES:112,ACTION_CHARACTER_MULTIPLY_DAMAGES:114,ACTION_CHARACTER_BOOST_CRITICAL_HIT:115,ACTION_CHARACTER_DEBOOST_RANGE:116,ACTION_CHARACTER_BOOST_RANGE:117,ACTION_CHARACTER_BOOST_STRENGTH:118,ACTION_CHARACTER_BOOST_AGILITY:119,ACTION_CHARACTER_ACTION_POINTS_WIN:120,ACTION_CHARACTER_BOOST_DAMAGES_FOR_ALL_GAME:121,ACTION_CHARACTER_BOOST_CRITICAL_MISS:122,ACTION_CHARACTER_BOOST_CHANCE:123,ACTION_CHARACTER_BOOST_WISDOM:124,ACTION_CHARACTER_BOOST_VITALITY:125,ACTION_CHARACTER_BOOST_INTELLIGENCE:126,ACTION_CHARACTER_MOVEMENT_POINTS_LOST:127,ACTION_CHARACTER_BOOST_MOVEMENT_POINTS:128,ACTION_CHARACTER_MOVEMENT_POINTS_USE:129,ACTION_CHARACTER_STEAL_GOLD:130,ACTION_CHARACTER_MANA_USE_KILL_LIFE:131,ACTION_CHARACTER_REMOVE_ALL_EFFECTS:132,ACTION_CHARACTER_ACTION_POINTS_LOST_CASTER:133,ACTION_CHARACTER_MOVEMEMT_POINTS_LOST_CASTER:134,ACTION_CHARACTER_DEBOOST_RANGE_CASTER:135,ACTION_CHARACTER_BOOST_RANGE_CASTER:136,ACTION_CHARACTER_BOOST_DAMAGES_CASTER:137,ACTION_CHARACTER_BOOST_DAMAGES_PERCENT:138,ACTION_CHARACTER_DEBOOST_DAMAGES_PERCENT:186,ACTION_CHARACTER_ENERGY_POINTS_WIN:139,ACTION_CHARACTER_PASS_NEXT_TURN:140,ACTION_CHARACTER_KILL:141,ACTION_CHARACTER_BOOST_PHYSICAL_DAMAGES:142,ACTION_CHARACTER_LIFE_POINTS_WIN_WITHOUT_BOOST:143,ACTION_CHARACTER_LIFE_POINTS_LOST_WITHOUT_BOOST:144,ACTION_CHARACTER_DEBOOST_DAMAGES:145,ACTION_CHARACTER_CURSE:146,ACTION_CHARACTER_RESURECT_ALLY_IN_FIGHT:147,ACTION_CHARACTER_ADD_FOLLOWING_CHARACTER:148,ACTION_CHARACTER_MAKE_INVISIBLE:150,ACTION_SPELL_INVISIBLE_OBSTACLE:151,ACTION_CHARACTER_CHANGE_COLOR:333,ACTION_CHARACTER_CHANGE_LOOK:149,ACTION_CHARACTER_ADD_APPEARANCE:335,ACTION_CHARACTER_DEBOOST_CHANCE:152,ACTION_CHARACTER_DEBOOST_VITALITY:153,ACTION_CHARACTER_DEBOOST_AGILITY:154,ACTION_CHARACTER_DEBOOST_INTELLIGENCE:155,ACTION_CHARACTER_DEBOOST_WISDOM:156,ACTION_CHARACTER_DEBOOST_STRENGTH:157,ACTION_CHARACTER_BOOST_MAXIMUM_WEIGHT:158,ACTION_CHARACTER_DEBOOST_MAXIMUM_WEIGHT:159,ACTION_CHARACTER_BOOST_ACTION_POINTS_LOST_DODGE:160,ACTION_CHARACTER_BOOST_MOVEMENT_POINTS_LOST_DODGE:161,ACTION_CHARACTER_DEBOOST_ACTION_POINTS_LOST_DODGE:162,ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS_LOST_DODGE:163,ACTION_CHARACTER_BOOST_DODGE:752,ACTION_CHARACTER_BOOST_TACKLE:753,ACTION_CHARACTER_DEBOOST_DODGE:754,ACTION_CHARACTER_DEBOOST_TACKLE:755,ACTION_CHARACTER_BOOST_WEAPON_DAMAGE_PERCENT:165,ACTION_CHARACTER_DEBOOST_ACTION_POINTS:168,ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS:169,ACTION_CHARACTER_LIFE_POINTS_WIN_IN_RP:170,ACTION_CHARACTER_DEBOOST_CRITICAL_HIT:171,ACTION_CHARACTER_DEBOOST_MAGICAL_REDUCTION:172,ACTION_CHARACTER_DEBOOST_PHYSICAL_REDUCTION:173,ACTION_CHARACTER_BOOST_INITIATIVE:174,ACTION_CHARACTER_DEBOOST_INITIATIVE:175,ACTION_CHARACTER_BOOST_MAGIC_FIND:176,ACTION_CHARACTER_DEBOOST_MAGIC_FIND:177,ACTION_CHARACTER_BOOST_HEAL_BONUS:178,ACTION_CHARACTER_DEBOOST_HEAL_BONUS:179,ACTION_CHARACTER_ADD_DOUBLE:180,ACTION_SUMMON_CREATURE:181,ACTION_CHARACTER_BOOST_MAXIMUM_SUMMONED_CREATURES:182,ACTION_CHARACTER_BOOST_MAGICAL_REDUCTION:183,ACTION_CHARACTER_BOOST_PHYSICAL_REDUCTION:184,ACTION_SUMMON_STATIC_CREATURE:185,ACTION_CHARACTER_ALIGNMENT_RANK_SET:187,ACTION_CHARACTER_ALIGNMENT_SIDE_SET:188,ACTION_CHARACTER_ALIGNMENT_VALUE_SET:189,ACTION_CHARACTER_ALIGNMENT_VALUE_MODIFICATION:190,ACTION_CHARACTER_INVENTORY_CLEAR:191,ACTION_CHARACTER_INVENTORY_REMOVE_ITEM:192,ACTION_CHARACTER_INVENTORY_ADD_ITEM:193,ACTION_CHARACTER_INVENTORY_ADD_ITEM_NOCHECK:209,ACTION_CHARACTER_INVENTORY_ADD_ITEM_RANDOM_NOCHECK:221,ACTION_CHARACTER_INVENTORY_ADD_ITEM_FROM_RANDOM_DROP:222,ACTION_CHARACTER_INVENTORY_GAIN_KAMAS:194,ACTION_CHARACTER_INVENTORY_LOSE_KAMAS:195,ACTION_CHARACTER_OPEN_MY_STORAGE:196,ACTION_CHARACTER_TRANSFORM:197,ACTION_CHARACTER_CLEAR_ALL_JOB:198,ACTION_CHARACTER_REPAIR_OBJECT:199,ACTION_CHARACTER_INVENTORY_ADD_ITEM_ON_RP_MAP:232,ACTION_CHARACTER_INVENTORY_REMOVE_ITEM_ON_RP_MAP:233,ACTION_DECORS_PLAY_OBJECT_ANIMATION:200,ACTION_DECORS_ADD_OBJECT:201,ACTION_DECORS_REVEAL_UNVISIBLE:202,ACTION_DECORS_OBSTACLE_CLOSE:203,ACTION_DECORS_OBSTACLE_OPEN:204,ACTION_CHARACTER_CHANGE_RESTRICTION:205,ACTION_CHARACTER_RESURRECTION:206,ACTION_COLLECT_RESOURCE:207,ACTION_DECORS_PLAY_ANIMATION:208,ACTION_DECORS_PLAY_ANIMATION_UNLIGHTED:228,ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PERCENT:210,ACTION_CHARACTER_BOOST_WATER_ELEMENT_PERCENT:211,ACTION_CHARACTER_BOOST_AIR_ELEMENT_PERCENT:212,ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PERCENT:213,ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PERCENT:214,ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_PERCENT:215,ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_PERCENT:216,ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_PERCENT:217,ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_PERCENT:218,ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_PERCENT:219,ACTION_CHARACTER_REFLECTOR_UNBOOSTED:220,ACTION_DECORS_OBSTACLE_CLOSE_RANDOM:223,ACTION_DECORS_OBSTACLE_OPEN_RANDOM:224,ACTION_CHARACTER_BOOST_TRAP:225,ACTION_CHARACTER_BOOST_TRAP_PERCENT:226,ACTION_CHARACTER_GAIN_RIDE:229,ACTION_CHARACTER_ENERGY_LOSS_BOOST:230,ACTION_CHARACTER_ENERGY_POINTS_LOOSE:231,ACTION_CHARACTER_BOOST_EARTH_ELEMENT_RESIST:240,ACTION_CHARACTER_BOOST_WATER_ELEMENT_RESIST:241,ACTION_CHARACTER_BOOST_AIR_ELEMENT_RESIST:242,ACTION_CHARACTER_BOOST_FIRE_ELEMENT_RESIST:243,ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_RESIST:244,ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_RESIST:245,ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_RESIST:246,ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_RESIST:247,ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_RESIST:248,ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_RESIST:249,ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PVP_PERCENT:250,ACTION_CHARACTER_BOOST_WATER_ELEMENT_PVP_PERCENT:251,ACTION_CHARACTER_BOOST_AIR_ELEMENT_PVP_PERCENT:252,ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PVP_PERCENT:253,ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PVP_PERCENT:254,ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_PVP_PERCENT:255,ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_PVP_PERCENT:256,ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_PVP_PERCENT:257,ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_PVP_PERCENT:258,ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_PVP_PERCENT:259,ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PVP_RESIST:260,ACTION_CHARACTER_BOOST_WATER_ELEMENT_PVP_RESIST:261,ACTION_CHARACTER_BOOST_AIR_ELEMENT_PVP_RESIST:262,ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PVP_RESIST:263,ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PVP_RESIST:264,ACTION_CHARACTER_STEAL_CHANCE:266,ACTION_CHARACTER_STEAL_VITALITY:267,ACTION_CHARACTER_STEAL_AGILITY:268,ACTION_CHARACTER_STEAL_INTELLIGENCE:269,ACTION_CHARACTER_STEAL_WISDOM:270,ACTION_CHARACTER_STEAL_STRENGTH:271,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING_FROM_WATER:275,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING_FROM_EARTH:276,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING_FROM_AIR:277,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING_FROM_FIRE:278,ACTION_CHARACTER_LIFE_POINTS_LOST_BASED_ON_CASTER_LIFE_MISSING:279,ACTION_CHARACTER_BOOST_SHIELD_BASED_ON_CASTER_LIFE:1039,ACTION_CHARACTER_BOOST_SHIELD:1040,ACTION_CHARACTER_ADD_SPELL_COOLDOWN:1035,ACTION_CHARACTER_REMOVE_SPELL_COOLDOWN:1036,ACTION_CHARACTER_UPDATE_BOOST:515,ACTION_CHARACTER_BOOST_DISPELLED:514,ACTION_BOOST_SPELL_RANGE:281,ACTION_BOOST_SPELL_RANGEABLE:282,ACTION_BOOST_SPELL_DMG:283,ACTION_BOOST_SPELL_HEAL:284,ACTION_BOOST_SPELL_AP_COST:285,ACTION_BOOST_SPELL_CAST_INTVL:286,ACTION_BOOST_SPELL_CC:287,ACTION_BOOST_SPELL_CASTOUTLINE:288,ACTION_BOOST_SPELL_NOLINEOFSIGHT:289,ACTION_BOOST_SPELL_MAXPERTURN:290,ACTION_BOOST_SPELL_MAXPERTARGET:291,ACTION_BOOST_SPELL_CAST_INTVL_SET:292,ACTION_BOOST_SPELL_BASE_DMG:293,ACTION_DEBOOST_SPELL_RANGE:294,ACTION_FIGHT_CAST_SPELL:300,ACTION_FIGHT_CAST_SPELL_CRITICAL_HIT:301,ACTION_FIGHT_CAST_SPELL_CRITICAL_MISS:302,ACTION_FIGHT_CLOSE_COMBAT:303,ACTION_FIGHT_CLOSE_COMBAT_CRITICAL_HIT:304,ACTION_FIGHT_CLOSE_COMBAT_CRITICAL_MISS:305,ACTION_FIGHT_TRIGGER_TRAP:306,ACTION_FIGHT_TRIGGER_GLYPH:307,ACTION_FIGHT_SPELL_DODGED_PA:308,ACTION_FIGHT_SPELL_DODGED_PM:309,ACTION_CHARACTER_STEAL_RANGE:320,ACTION_FIGHT_ADD_TRAP_CASTING_SPELL:400,ACTION_FIGHT_ADD_GLYPH_CASTING_SPELL:401,ACTION_FIGHT_ADD_GLYPH_CASTING_SPELL_ENDTURN:402,ACTION_FIGHT_KILL_AND_SUMMON:405,ACTION_CHARACTER_BOOST_PUSH_DAMAGE_FIXED_RESIST:416,ACTION_CHARACTER_BOOST_CRITICAL_DAMAGE_FIXED_RESIST:420,ACTION_INTERACTIVE_ELEMENT:500,ACTION_SKILL_ANIMATION:501,ACTION_EXCHANGE_CRAFT_OPEN:502,ACTION_USE_WAYPOINT:503,ACTION_DO_ELEMENT_PARAMETERIZED_OPERATION:505,ACTION_INTERACTIVE_ELEMENT_AT_HOME_INNER_DOOR:507,ACTION_SAVE_WAYPOINT:508,ACTION_CHANGE_COMPASS:509,ACTION_USE_SUBWAY:510,ACTION_EXCHANGE_JOBINDEX_OPEN:511,ACTION_USE_PRISM:512,ACTION_ADD_PRISM:513,ACTION_GOTO_WAYPOINT:600,ACTION_GOTO_MAP:601,ACTION_CHARACTER_LEARN_JOB:603,ACTION_CHARACTER_LEARN_SPELL:604,ACTION_CHARACTER_GAIN_XP:605,ACTION_CHARACTER_GAIN_WISDOM:606,ACTION_CHARACTER_GAIN_STRENGTH:607,ACTION_CHARACTER_GAIN_CHANCE:608,ACTION_CHARACTER_GAIN_AGILITY:609,ACTION_CHARACTER_GAIN_VITALITY:610,ACTION_CHARACTER_GAIN_INTELLIGENCE:611,ACTION_CHARACTER_GAIN_STATS_POINTS:612,ACTION_CHARACTER_GAIN_SPELL_POINTS:613,ACTION_CHARACTER_GAIN_JOB_XP:614,ACTION_CHARACTER_UNLEARN_JOB:615,ACTION_CHARACTER_UNBOOST_SPELL:616,ACTION_CHARACTER_GET_MARRIED:617,ACTION_CHARACTER_GET_MARRIED_ACCEPT:618,ACTION_CHARACTER_GET_MARRIED_DECLINE:619,ACTION_CHARACTER_READ_BOOK:620,ACTION_CHARACTER_SUMMON_MONSTER:621,ACTION_GOTO_HOUSE:622,ACTION_CHARACTER_SUMMON_MONSTER_GROUP:623,ACTION_CHARACTER_SUMMON_MONSTER_GROUP_SET_MAP:627,ACTION_CHARACTER_SUMMON_MONSTER_GROUP_DYNAMIC:628,ACTION_CHARACTER_UNLEARN_GUILDSPELL:624,ACTION_CHARACTER_UNBOOST_CARACS:625,ACTION_CHARACTER_UNBOOST_CARACS_TO_101:626,ACTION_CHARACTER_SEND_INFORMATION_TEXT:630,ACTION_CHARACTER_SEND_DIALOG_ACTION:631,ACTION_CHARACTER_GAIN_HONOUR:640,ACTION_CHARACTER_GAIN_DISHONOUR:641,ACTION_CHARACTER_LOOSE_HONOUR:642,ACTION_CHARACTER_LOOSE_DISHONOUR:643,ACTION_MAP_RESURECTION_ALLIES:645,ACTION_MAP_HEAL_ALLIES:646,ACTION_MAP_FORCE_ENNEMIES_GHOST:647,ACTION_FORCE_ENNEMY_GHOST:648,ACTION_FAKE_ALIGNMENT:649,ACTION_TELEPORT_NOOBY_MAP:650,ACTION_USE_ELEMENT_ACTIONS:651,ACTION_SET_STATED_ELEMENT_STATE:652,ACTION_RESET_STATED_ELEMENT:653,ACTION_HOUSE_LEAVE:654,ACTION_NOOP:666,ACTION_INCARNATION:669,ACTION_CHARACTER_REFERENCEMENT:699,ACTION_ITEM_CHANGE_EFFECT:700,ACTION_ITEM_ADD_EFFECT:701,ACTION_ITEM_ADD_DURABILITY:702,ACTION_CAPTURE_SOUL:705,ACTION_CAPTURE_RIDE:706,ACTION_CHARACTER_ADD_COST_TO_ACTION:710,ACTION_LADDER_SUPERRACE:715,ACTION_LADDER_RACE:716,ACTION_LADDER_ID:717,ACTION_PVP_LADDER:720,ACTION_VICTIM_OF:721,ACTION_GAIN_TEMP_SPELL:722,ACTION_GAIN_AURA:723,ACTION_GAIN_TITLE:724,ACTION_CHARACTER_RENAME_GUILD:725,ACTION_TELEPORT_NEAREST_PRISM:730,ACTION_AUTO_AGGRESS_ENEMY_PLAYER:731,ACTION_SHUSHU_STACK_RUNE:742,ACTION_BOOST_SOUL_CAPTURE_BONUS:750,ACTION_BOOST_RIDE_XP_BONUS:751,ACTION_REMOVE_ON_MOVE:760,ACTION_CHARACTER_SACRIFY:765,ACTION_HOURLY_CONFUSION_DEGREE:770,ACTION_HOURLY_CONFUSION_PI_2:771,ACTION_HOURLY_CONFUSION_PI_4:772,ACTION_UNHOURLY_CONFUSION_DEGREE:773,ACTION_UNHOURLY_CONFUSION_PI_2:774,ACTION_UNHOURLY_CONFUSION_PI_4:775,ACTION_CHARACTER_BOOST_PERMANENT_DAMAGE_PERCENT:776,ACTION_CHARACTER_SUMMON_DEAD_ALLY_IN_FIGHT:780,ACTION_CHARACTER_UNLUCKY:781,ACTION_CHARACTER_MAXIMIZE_ROLL:782,ACTION_CHARACTER_WALK_FOUR_DIR:785,ACTION_FIND_BOUNTY_TARGET:790,ACTION_MARK_TARGET_MERCENARY:791,ACTION_ITEM_CHANGE_PETS_LIFE:800,ACTION_ITEM_CHANGE_DURATION:805,ACTION_ITEM_PETS_SHAPE:806,ACTION_ITEM_PETS_EAT:807,ACTION_PETS_LAST_MEAL:808,ACTION_ITEM_CHANGE_DURABILITY:812,ACTION_ITEM_UPDATE_DATE:813,ACTION_ITEM_CHOOSE_IN_ITEM_LIST:820,ACTION_CLIENT_OPEN_UI:830,PARAM_CLIENT_OPEN_UI_GUILD_TELEPORT_HOUSE:1,PARAM_CLIENT_OPEN_UI_GUILD_TELEPORT_FARM:2,ACTION_CLIENT_OPEN_UI_SPELL_FORGET:831,ACTION_FIGHT_TURN_FINISHED:899,ACTION_FIGHT_CHALLENGE:900,ACTION_FIGHT_CHALLENGE_ACCEPT:901,ACTION_FIGHT_CHALLENGE_DECLINE:902,ACTION_FIGHT_CHALLENGE_JOIN:903,ACTION_FIGHT_CHALLENGE_AGAINST_MONSTER:905,ACTION_FIGHT_AGGRESSION:906,ACTION_FIGHT_AGAINST_TAXCOLLECTOR:909,ACTION_FIGHT_CHALLENGE_AGAINST_MUTANT:910,ACTION_FIGHT_CHALLENGE_MIXED_VERSUS_MONSTER:911,ACTION_FIGHT_AGAINST_PRISM:912,ACTION_TOOLTIP_ACTIVATE_TIP:915,ACTION_PNJ_REMOVE_RIDE:938,ACTION_PET_SET_POWER_BOOST:939,ACTION_FARM_WITHDRAW_ITEM:947,ACTION_FARM_PLACE_ITEM:948,ACTION_MOUNT_RIDE:949,ACTION_FIGHT_SET_STATE:950,ACTION_FIGHT_UNSET_STATE:951,ACTION_CREATED_SINCE:963,ACTION_SHOW_PLAYERNAME:964,ACTION_ID_LIVING_OBJECT_MOOD:971,ACTION_ID_LIVING_OBJECT_SKIN:972,ACTION_ID_LIVING_OBJECT_CATEGORY:973,ACTION_ID_LIVING_OBJECT_LEVEL:974,ACTION_BOOST_GLOBAL_RESISTS_BONUS:1076,ACTION_BOOST_GLOBAL_RESISTS_MALUS:1077,ACTION_CONTROL_ENTITY:2027,ACTION_CAST_STARTING_SPELL:2822,ACTION_SHIELD_EXPERIENCE:2824,ACTION_SHIELD_INTERACT_WITH_TYPE:2826},s={};s[o.ACTION_CHARACTER_BOOST_LIFE_POINTS]=["lifePoints",!0],s[o.ACTION_CHARACTER_MOVEMENT_POINTS_LOST]=["movementPoints",!1],s[o.ACTION_CHARACTER_BOOST_MOVEMENT_POINTS]=["movementPoints",!0],s[o.ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS]=["movementPoints",!1],s[o.ACTION_CHARACTER_ACTION_POINTS_LOST]=["actionPoints",!1],s[o.ACTION_CHARACTER_BOOST_ACTION_POINTS]=["actionPoints",!0],s[o.ACTION_CHARACTER_DEBOOST_ACTION_POINTS]=["actionPoints",!1],s[o.ACTION_CHARACTER_DEBOOST_DAMAGES]=["allDamagesBonus",!1],s[o.ACTION_CHARACTER_BOOST_DAMAGES]=["allDamagesBonus",!0],s[o.ACTION_CHARACTER_BOOST_PHYSICAL_DAMAGES]=["physicalDamagesBonus",!0],s[o.ACTION_CHARACTER_DEBOOST_DAMAGES_PERCENT]=["damagesBonusPercent",!1],s[o.ACTION_CHARACTER_BOOST_DAMAGES_PERCENT]=["damagesBonusPercent",!0],s[o.ACTION_CHARACTER_BOOST_MAXIMUM_SUMMONED_CREATURES]=["summonableCreaturesBoost",!0],s[o.ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_PERCENT]=["earthElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PERCENT]=["earthElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_PERCENT]=["waterElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_WATER_ELEMENT_PERCENT]=["waterElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_PERCENT]=["airElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_AIR_ELEMENT_PERCENT]=["airElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_PERCENT]=["fireElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PERCENT]=["fireElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_PERCENT]=["neutralElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PERCENT]=["neutralElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_PVP_PERCENT]=["pvpEarthElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PVP_PERCENT]=["pvpEarthElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_PVP_PERCENT]=["pvpWaterElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_WATER_ELEMENT_PVP_PERCENT]=["pvpWaterElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_PVP_PERCENT]=["pvpAirElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_AIR_ELEMENT_PVP_PERCENT]=["pvpAirElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_PVP_PERCENT]=["pvpFireElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PVP_PERCENT]=["pvpFireElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_PVP_PERCENT]=["pvpNeutralElementResistPercent",!1],s[o.ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PVP_PERCENT]=["pvpNeutralElementResistPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_RANGE]=["range",!1],s[o.ACTION_CHARACTER_BOOST_RANGE]=["range",!0],s[o.ACTION_CHARACTER_DEBOOST_STRENGTH]=["strength",!1],s[o.ACTION_CHARACTER_BOOST_STRENGTH]=["strength",!0],s[o.ACTION_CHARACTER_DEBOOST_AGILITY]=["agility",!1],s[o.ACTION_CHARACTER_BOOST_AGILITY]=["agility",!0],s[o.ACTION_CHARACTER_DEBOOST_CHANCE]=["chance",!1],s[o.ACTION_CHARACTER_BOOST_CHANCE]=["chance",!0],s[o.ACTION_CHARACTER_DEBOOST_WISDOM]=["wisdom",!1],s[o.ACTION_CHARACTER_BOOST_WISDOM]=["wisdom",!0],s[o.ACTION_CHARACTER_DEBOOST_VITALITY]=["vitality",!1],s[o.ACTION_CHARACTER_BOOST_VITALITY]=["vitality",!0],s[o.ACTION_CHARACTER_DEBOOST_INTELLIGENCE]=["intelligence",!1],s[o.ACTION_CHARACTER_BOOST_INTELLIGENCE]=["intelligence",!0],s[o.ACTION_CHARACTER_BOOST_TRAP]=["trapBonus",!0],s[o.ACTION_CHARACTER_BOOST_TRAP_PERCENT]=["trapBonusPercent",!0],s[o.ACTION_CHARACTER_DEBOOST_EARTH_ELEMENT_RESIST]=["earthElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_EARTH_ELEMENT_RESIST]=["earthElementReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_WATER_ELEMENT_RESIST]=["waterElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_WATER_ELEMENT_RESIST]=["waterElementReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_AIR_ELEMENT_RESIST]=["airElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_AIR_ELEMENT_RESIST]=["airElementReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_FIRE_ELEMENT_RESIST]=["fireElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_FIRE_ELEMENT_RESIST]=["fireElementReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_NEUTRAL_ELEMENT_RESIST]=["neutralElementReduction",!1],s[o.ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_RESIST]=["neutralElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_EARTH_ELEMENT_PVP_RESIST]=["pvpEarthElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_WATER_ELEMENT_PVP_RESIST]=["pvpWaterElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_AIR_ELEMENT_PVP_RESIST]=["pvpAirElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_FIRE_ELEMENT_PVP_RESIST]=["pvpFireElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_NEUTRAL_ELEMENT_PVP_RESIST]=["pvpNeutralElementReduction",!0],s[o.ACTION_CHARACTER_BOOST_CRITICAL_MISS]=["criticalMiss",!0],s[o.ACTION_CHARACTER_BOOST_CRITICAL_HIT]=["criticalHit",!0],s[o.ACTION_CHARACTER_DEBOOST_CRITICAL_HIT]=["criticalHit",!1],s[o.ACTION_CHARACTER_BOOST_INITIATIVE]=["initiative",!0],s[o.ACTION_CHARACTER_DEBOOST_INITIATIVE]=["initiative",!1],s[o.ACTION_CHARACTER_BOOST_MAGIC_FIND]=["prospecting",!0],s[o.ACTION_CHARACTER_DEBOOST_MAGIC_FIND]=["prospecting",!1],s[o.ACTION_CHARACTER_BOOST_HEAL_BONUS]=["healBonus",!0],s[o.ACTION_CHARACTER_BOOST_SHIELD_BASED_ON_CASTER_LIFE]=["shieldPoints",!0],s[o.ACTION_CHARACTER_BOOST_SHIELD]=["shieldPoints",!0],s[o.ACTION_CHARACTER_LIFE_POINTS_MALUS]=["lifePointsMalus",!1],s[o.ACTION_CHARACTER_LIFE_POINTS_MALUS_PERCENT]=["lifePointsMalus",!1],s[o.ACTION_CHARACTER_REFLECTOR_UNBOOSTED]=["reflectorUnboosted",!0],s[o.ACTION_CHARACTER_DEBOOST_ACTION_POINTS_LOST_DODGE]=["dodgePALostProbability",!1],s[o.ACTION_CHARACTER_BOOST_ACTION_POINTS_LOST_DODGE]=["dodgePALostProbability",!0],s[o.ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS_LOST_DODGE]=["dodgePMLostProbability",!1],s[o.ACTION_CHARACTER_BOOST_MOVEMENT_POINTS_LOST_DODGE]=["dodgePMLostProbability",!0],s[o.ACTION_CHARACTER_BOOST_DAMAGES_FOR_ALL_GAME]=["allDamagesBonus",!0],s[o.ACTION_CHARACTER_DEBOOST_MAXIMUM_WEIGHT]=["maximumWeight",!1],s[o.ACTION_CHARACTER_BOOST_MAXIMUM_WEIGHT]=["maximumWeight",!0],s[o.ACTION_CHARACTER_DEBOOST_PHYSICAL_REDUCTION]=["physicalReduction",!1],s[o.ACTION_CHARACTER_BOOST_PHYSICAL_REDUCTION]=["physicalReduction",!0],s[o.ACTION_CHARACTER_DEBOOST_MAGICAL_REDUCTION]=["magicalReduction",!1],s[o.ACTION_CHARACTER_BOOST_MAGICAL_REDUCTION]=["magicalReduction",!0],s[o.ACTION_CHARACTER_BOOST_DODGE]=["tackleEvade",!0],s[o.ACTION_CHARACTER_BOOST_TACKLE]=["tackleBlock",!0],s[o.ACTION_CHARACTER_DEBOOST_DODGE]=["tackleEvade",!1],s[o.ACTION_CHARACTER_DEBOOST_TACKLE]=["tackleBlock",!1],s[o.ACTION_CHARACTER_BOOST_PERMANENT_DAMAGE_PERCENT]=["permanentDamagePercent",!0],s[o.ACTION_BOOST_GLOBAL_RESISTS_BONUS]=["globalResistPercentBonus",!0],s[o.ACTION_BOOST_GLOBAL_RESISTS_MALUS]=["globalResistPercentMalus",!0],s[o.ACTION_CHARACTER_BOOST_PUSH_DAMAGE_FIXED_RESIST]=["pushDamageFixedResist",!0],s[o.ACTION_CHARACTER_BOOST_CRITICAL_DAMAGE_FIXED_RESIST]=["criticalDamageFixedResist",!0],o.getActionStatName=i,o.getIsABoost=n,e.exports=o},function(e,t,i){function n(e){return void 0===e||null===e}function o(e){this._effectCaller="",this._hasMissingDdInfo=!1;for(var t in e)e.hasOwnProperty(t)&&("effectCaller"===t?this._effectCaller=e[t]:this[t]=e[t]);this._effectCaller||y.error(new Error("EF: No caller!")),this._init()}function s(e){if(null!==e.effectId&&"null"!==e.effectId)return!0;var t="effectInstanceFactory: an effectId is null. ";return t+="description: "+e.description+" ",t+="type: "+e._type+" ",t+="keys: "+JSON.stringify(Object.keys(e)),y.error(new Error(t)),!1}function a(e,t){for(var i=[],n=0;n<e.length;n+=1){var o=e[n];s(o)&&i.indexOf(o.effectId)===-1&&i.push(o.effectId)}return 0===i.length?t():void _.getData("Effects",i,function(e,n){return e?t(e):void t(null,f.extractElementsFrom(i,n,!0))})}function r(e,t,i){function n(e,t,i){i||y.error("RD: the effectInstance is needed."),o[e]||(o[e]={}),o[e][t]||(o[e][t]=[]),o[e][t].push(i)}var o={};p.each(e,function(e,i){if(!e)return i();var o;return e.description||(o=e.getParams(),c(e,o,t,n)),""===e.subEffectDescription?(o=e.getParams(),u(e,o,t,n,i)):i()},function(n){return n?i(n):0===Object.keys(o).length?i(null,e):void p.each(Object.keys(o),function(e,i){var n=[];for(var s in o[e])if(o[e].hasOwnProperty(s)){var a=parseInt(s,10);n.indexOf(a)===-1&&n.push(a)}_.getData(e,n,function(s,a){if(s)return i(s);for(var r=f.extractElementsFrom(n,a,!0),l=0;l<n.length;l+=1){var c=n[l];if(!r[c]){for(var u=o[e][c],d=0;d<u.length;d+=1){var h=u[d];h.setBroken(!0);var p="id "+c+" unavailable in table "+e;p+=" caller: "+h.getCaller(),p+=" for effectId: "+h.effectId,y.error(new Error(p))}r[c]=T}}o[e]=r,t||(t={}),t[e]||(t[e]={});for(var m in r)r.hasOwnProperty(m)&&(t[e][m]=r[m]);i()})},function(n){return n?i(n):void r(e,t,i)})})}function l(e,t,i){for(var o=0,s=t.length;o<s;o+=1){var a=t[o],r=e[a];if(n(r)){var l="param "+(a+1)+" is falsy";return l+=" for effect "+i.effectId+" from "+i.getCaller(),y.error(l),!1}}return!0}function c(e,t,i,o){var s=w(),a=!0;switch(e.effectId){case 10:null===t[0]&&t[2]&&(t[0]=t[2]),i?(t[2]=i.Emoticons[t[0]].nameId,e.setDescription(t)):o("Emoticons",t[0],e);break;case 165:case 1084:if(a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[0]=i.ItemTypes[t[0]].nameId,e.setDescription(t)):o("ItemTypes",t[0],e);break;case 197:case 181:case 185:case 717:case 1008:case 1011:if(a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[0]=i.Monsters[t[0]].nameId,e.setDescription(t)):o("Monsters",t[0],e);break;case 281:case 282:case 283:case 284:case 285:case 286:case 287:case 288:case 289:case 290:case 291:case 292:case 293:case 294:case 787:case 792:case 793:case 1017:case 1018:case 1019:case 1035:case 1036:case 1044:case 1045:case 1160:case 2822:if(a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[0]=i.Spells[t[0]].nameId,e.setDescription(t)):o("Spells",t[0],e);break;case 406:if(a=l(t,[2],e),!a){e.setBroken(!0);break}i?(t[2]=i.Spells[t[2]].nameId,e.setDescription(t)):o("Spells",t[2],e);break;case 603:case 615:if(null===t[0]&&t[2]&&(t[0]=t[2]),a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[2]=i.Jobs[t[0]].nameId,e.setDescription(t)):o("Jobs",t[0],e);break;case 604:case 722:if(n(t[2])&&(t[2]=t[0]),a=l(t,[2],e),!a){e.setBroken(!0);break}i&&i.SpellLevels&&i.SpellLevels[t[2]]?i.Spells&&i.Spells[i.SpellLevels[t[2]].spellId]?(t[2]=i.Spells[i.SpellLevels[t[2]].spellId].nameId,e.setDescription(t)):o("Spells",i.SpellLevels[t[2]].spellId,e):o("SpellLevels",t[2],e);break;case 614:case 1050:if(a=l(t,[1],e),!a){e.setBroken(!0);break}t[0]=t[2],i?(t[1]=i.Jobs[t[1]].nameId,e.setDescription(t)):o("Jobs",t[1],e);break;case 616:case 624:if(n(t[0])&&!n(t[2])&&(t[0]=t[2]),a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[2]=i.Spells[t[0]].nameId,e.setDescription(t)):o("Spells",t[0],e);break;case 620:if(n(t[0])&&!n(t[2])&&(t[0]=t[2]),a=l(t,[0],e),!a){e.setBroken(!0);
break}i?(t[2]=i.Documents[t[0]].titleId,e.setDescription(t)):o("Documents",t[0],e);break;case 621:if(a=l(t,[1],e),!a){e.setBroken(!0);break}i?(t[2]=i.Monsters[t[1]].nameId,e.setDescription(t)):o("Monsters",t[1],e);break;case 623:case 628:var r=t[2];if(n(r))break;if(a=l(t,[0],e),!a){e.setBroken(!0);break}var c="",u="",d=t[0]-1;if(i){var h=e.effectId,p=i.Monsters[r];if(p===T)return u="Unknown monster",e.setDescription(["",c,u]);p||(y.error(new Error("monster "+r+" missing for effectId "+h)),p={});var f=p.grades||[],g=f[d];g||(y.error(new Error("monster "+r+" missing grade "+d+" for effectId "+h)),g={}),c=g.level,u=p.nameId,e.setDescription(["",c,u])}else o("Monsters",r,e);break;case 649:case 960:if(a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[2]=i.AlignmentSides[t[0]].titleId,e.setDescription(t)):o("AlignmentSides",t[0],e);break;case 699:if(a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[0]=i.Jobs[t[0]].nameId,e.setDescription(t)):o("Jobs",t[0],e);break;case 716:if(a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[0]=i.MonsterRaces[t[0]].nameId,e.setDescription(t)):o("MonsterRaces",t[0],e);break;case 724:if(n(t[0])&&!n(t[2])&&(t[0]=t[2]),a=l(t,[0],e),!a){e.setBroken(!0);break}if(i){var _=s.gui.playerData.characterBaseInformations||{},v=_.sex?"nameFemaleId":"nameMaleId";t[2]=i.Titles[t[0]][v],e.setDescription(t)}else o("Titles",t[0],e);break;case 726:if(n(t[0])&&!n(t[2])&&(t[0]=t[2]),a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[2]=i.Ornaments[t[0]].nameId,e.setDescription(t)):o("Ornaments",t[0],e);break;case 800:if(n(t[2])&&!n(t[0])&&(t[2]=t[0]),a=l(t,[2],e),!a){e.setBroken(!0);break}e.setDescription(t);break;case 806:t[1]>6?t[0]=m("ui.petWeight.fat",[t[1]]):t[2]>6?t[0]=m("ui.petWeight.lean",[t[2]]):"EffectInstanceInteger"===e._type&&t[0]>6?t[0]=m("ui.petWeight.lean",[t[0]]):t[0]=m("ui.petWeight.nominal"),e.setDescription(t);break;case 807:t[0]?i?(t[0]=i.Items[t[0]].nameId||"unknown",e.setDescription(t)):o("Items",t[0],e):(t[0]=m("ui.common.none"),e.setDescription(t));break;case 814:case 1151:if(a=l(t,[0],e),!a){e.setBroken(!0);break}if(i){var b=i.Items[t[0]];t[0]=b.nameId,e.setDescription(t),e.iconId=b.iconId}else o("Items",t[0],e);break;case 905:if(a=l(t,[1],e),!a){e.setBroken(!0);break}i?(t[1]=i.Monsters[t[1]].nameId,e.setDescription(t)):o("Monsters",t[1],e);break;case 939:if(n(t[0])&&!n(t[2])&&(t[0]=t[2]),a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[2]=i.Items[t[0]].nameId,e.setDescription(t)):o("Items",t[0],e);break;case 950:case 951:case 952:if(t[2]||(t[2]=t[0]),a=l(t,[2],e),!a){e.setBroken(!0);break}i?(t[2]=i.SpellStates[t[2]].nameId,e.setDescription(t)):o("SpellStates",t[2],e);break;case 961:case 962:t[2]=t[0],e.setDescription(t);break;case 988:case 987:case 985:case 996:e.setDescription(t);break;case 1111:t[2]=t[0],e.setDescription(t);break;case 1161:if(a=l(t,[0],e),!a){e.setBroken(!0);break}i?(t[0]=i.Companions[t[0]].nameId,e.setDescription(t)):o("Companions",t[0],e);break;case 1171:case 1172:t[0]||(t[0]=t[2]),e.setDescription(t);break;case 805:case 808:case 983:if(t[2]=n(t[2])?"0":t[2],"string"!=typeof t[1]||"string"!=typeof t[2])break;var M=t[0],C=t[1].substr(0,2),I=t[1].substr(2,2),A=t[2].substr(0,2),S=t[2].substr(2,2),E=s.Config.language;switch(E){case"fr":t[0]=I+"/"+C+"/"+M+" "+A+":"+S;break;default:t[0]=C+"/"+I+"/"+M+" "+A+":"+S}e.setDescription(t);break;default:e.setDescription(t)}}function u(e,i,n,o,s){if(e.requiresInvocationDescription()){var a=i[0];if(!n||!n.Monsters||!n.Monsters[a])return o("Monsters",a,e),s();var r=n.Monsters[a],l=[],c=i[1];(c<1||c>r.grades.length)&&(c=r.grades.length);var u=r.grades[c-1],d=1;window.gui.playerData.characterBaseInformations&&window.gui.playerData.characterBaseInformations.level&&(d=window.gui.playerData.characterBaseInformations.level);var h=Math.floor(u.lifePoints+u.lifePoints*d/100),p=Math.floor((u.wisdom+u.wisdom*d/100)/10);return l.push(m("ui.stats.HP")+m("ui.common.colon")+h),l.push(m("ui.stats.shortAP")+m("ui.common.colon")+u.actionPoints),l.push(m("ui.stats.shortMP")+m("ui.common.colon")+u.movementPoints),l.push(m("ui.stats.dodgeAP")+m("ui.common.colon")+(u.paDodge+p)),l.push(m("ui.stats.dodgeMP")+m("ui.common.colon")+(u.pmDodge+p)),l.push(m("ui.stats.neutralReductionPercent")+m("ui.common.colon")+u.neutralResistance),l.push(m("ui.stats.earthReductionPercent")+m("ui.common.colon")+u.earthResistance),l.push(m("ui.stats.fireReductionPercent")+m("ui.common.colon")+u.fireResistance),l.push(m("ui.stats.waterReductionPercent")+m("ui.common.colon")+u.waterResistance),l.push(m("ui.stats.airReductionPercent")+m("ui.common.colon")+u.airResistance),e.subEffectDescription=l,s()}if(e.requiresGlyphDescription()||e.requiresTrapDescription()||e.requiresBombDescription()){var f=i[0];if(e.requiresBombDescription()){var g=i[0];if(!n||!n.SpellBombs||!n.SpellBombs[g])return o("SpellBombs",g,e),s();f=n.SpellBombs[g].explodSpellId}if(!n||!n.Spells||!n.Spells[f])return o("Spells",f,e),s();var _=n.Spells[f].spellLevels[i[1]-1||0];if(!n||!n.SpellLevels||!n.SpellLevels[_])return o("SpellLevels",_,e),s();for(var v=[],y=n.SpellLevels[_],b=0;b<y.effects.length;b+=1){var w=y.effects[b];w.effectCaller="SubEffect spellLevelId: "+_+" effect#"+b,w.effectCaller+=" from parent: "+e.getCaller(),v.push(w)}return t.createEffectInstances(v,function(t,i){if(t)return s(t);for(var n=[],o=0;o<i.length;o++)if(i[o].description){if(i[o].hidden)continue;n.push(i[o].description);var a=i[o].getDurationString();a&&(n[n.length-1]+=" ("+a+")")}return e.subEffectDescription=n.length>0&&n,s()})}return e.subEffectDescription=!1,s()}function d(e,t){a(e,function(i,n){if(i)return t(i);for(var o=0;o<e.length;o++){var s=e[o],a=n&&n[s.effectId];a?s.effect=a:e[o]=null}r(e,null,t)})}function h(e,t){var i=A[t],n=S[i],o={_type:i};for(var s in n)o[s]=e[s];return o}var p=i(31),m=i(29).getText,f=i(252),g=i(29).processText,_=i(30),v=i(205),y=i(207).logger,b=i(399),w=i(189),M=i(401);t.EFFECT_SHAPES=i(402);var T="MISSING",C={effectId:0,targetId:0,targetMask:null,duration:0,delay:0,random:0,group:0,modificator:0,trigger:!1,triggers:null,hidden:!0,zoneSize:0,zoneShape:0,zoneMinSize:0,zoneEfficiencyPercent:0,zoneMaxEfficiency:0},I={ObjectEffectString:"EffectInstanceString",ObjectEffectInteger:"EffectInstanceInteger",ObjectEffectMinMax:"EffectInstanceMinMax",ObjectEffectDice:"EffectInstanceDice",ObjectEffectDate:"EffectInstanceDate",ObjectEffectDuration:"EffectInstanceDuration",ObjectEffectLadder:"EffectInstanceLadder",ObjectEffectCreature:"EffectInstanceCreature",ObjectEffectMount:"EffectInstanceMount"};t.parseZone=function(e){var i=e.substr(0,1),n=e.length>1?e.substr(1).split(","):[],o=0,s=0,a=0,r=0;switch(n.length){case 0:if("X"===i)return t.parseZone("X1");if("U"===i)return t.parseZone("U1");if("T"===i)return t.parseZone("T1");if("C"===i)return t.parseZone("C1");if("G"===i)return t.parseZone("G1");if("+"===i)return t.parseZone("+1");break;case 1:o=parseInt(n[0],10);break;case 2:o=parseInt(n[0],10),t.EFFECT_SHAPES[i].hasMinSize?s=parseInt(n[1],10):a=parseInt(n[1],10);break;case 3:o=parseInt(n[0],10),t.EFFECT_SHAPES[i].hasMinSize?(s=parseInt(n[1],10),a=parseInt(n[2],10)):(a=parseInt(n[1],10),r=parseInt(n[2],10));break;case 4:o=parseInt(n[0],10),s=parseInt(n[1],10),a=parseInt(n[2],10),r=parseInt(n[3],10)}return{zoneShape:i,zoneSize:o,zoneMinSize:s,zoneEfficiencyPercent:a,zoneMaxEfficiency:r}},t.getHumanReadableZoneInfo=function(e){if(!e)return"";var i=e.zoneShape,n=e.zoneSize;return"L"===i&&(n+=1),t.EFFECT_SHAPES[i].desc?m(t.EFFECT_SHAPES[i].desc,n):""},o.prototype._init=function(){if(this.description="",this.subEffectDescription="",this.effect=null,this._retrieveInstanceType(),this.hasOwnProperty("actionId"))if(this.duration=0,this.effectId=this.actionId,"EffectInstanceDice"===this._type&&this.effectId===b.ACTION_INCARNATION){this._type="EffectInstanceDate",this.year=this.diceNum;var e=f.getIncarnationExpDetails(this.diceSide,this.diceNum,this.diceConst);this.month=e.currentExp,this.day=e.level,this.hour=0,this.minute=0}else switch(this._type){case"EffectInstanceString":this.text=this.value,delete this.value;break;case"EffectInstanceDice":this.value=this.diceConst,delete this.diceConst;break;case"EffectInstanceDate":this.month+=1}},o.prototype.isBroken=function(){return this._hasMissingDdInfo},o.prototype.setBroken=function(e){this._hasMissingDdInfo=e},o.prototype._retrieveInstanceType=function(){return this._type?void(I[this._type]&&(this._type=I[this._type])):void(this.hasOwnProperty("diceNum")?this._type="EffectInstanceDice":this.hasOwnProperty("year")?this._type="EffectInstanceDate":this.hasOwnProperty("days")?this._type="EffectInstanceDuration":this.hasOwnProperty("min")?this._type="EffectInstanceMinMax":this.hasOwnProperty("monsterCount")?this._type="EffectInstanceLadder":this.hasOwnProperty("monsterFamilyId")?this._type="EffectInstanceCreature":this.hasOwnProperty("mountId")?this._type="EffectInstanceMount":this.hasOwnProperty("text")?this._type="EffectInstanceString":this._type="EffectInstanceInteger")},o.prototype.clone=function(){var e=new o({effectCaller:this.getCaller()}),t=v.getOwnProperties(this).filter(function(e){return"effect"!==e});v.shallowCopyProperties(this,e,t);var i=this.effect;return i&&(e.effect={},v.shallowCopyProperties(i,e.effect,v.getOwnProperties(i))),e},o.prototype.getParams=function(){switch(this._type){case"EffectInstanceString":return[null,null,null,this.text];case"EffectInstanceInteger":return[this.value];case"EffectInstanceMinMax":return[this.min,this.min!==this.max?this.max:null];case"EffectInstanceDice":var e=this.value||null,t=this.diceSide||null;return[0===this.diceNum?null:this.diceNum,t,e];case"EffectInstanceDate":var i=this.month>9?this.month:"0"+this.month,n=this.day>9?this.day:"0"+this.day,o=this.hour>9?this.hour:"0"+this.hour,s=this.minute>9?this.minute:"0"+this.minute;return[this.year,i+""+n,o+""+s,this.month,this.day];case"EffectInstanceDuration":return[this.days,this.hours,this.minutes];case"EffectInstanceLadder":return[this.monsterFamilyId,this.monsterCount];case"EffectInstanceCreature":return[this.monsterFamilyId];case"EffectInstanceMount":return[this.date,this.modelId,this.mountId];default:return[]}},o.prototype.setParameter=function(e,t){switch(this._type){case"EffectInstanceString":return void(3===e&&(this.text=t.toString()));case"EffectInstanceInteger":return void(2===e&&(this.value=t));case"EffectInstanceMinMax":return void(0===e?this.min=t:1===e&&(this.max=t));case"EffectInstanceDice":return void(0===e?this.diceNum=t:1===e?this.diceSide=t:2===e&&(this.value=t));case"EffectInstanceDate":return void(0===e?this.year=t:1===e?(this.month=t.substr(0,2),this.day=t.substr(2,2)):2===e?(this.hour=t.substr(0,2),this.minute=t.substr(2,2)):3===e?this.month=t:4===e&&(this.day=t));case"EffectInstanceDuration":return void(0===e?this.days=t:1===e?this.hours=t:2===e&&(this.minutes=t));case"EffectInstanceLadder":return void(0===e?this.monsterFamilyId=t:2===e&&(this.monsterCount=t));case"EffectInstanceCreature":return void(0===e&&(this.monsterFamilyId=t));case"EffectInstanceMount":0===e?this.date=Number(t):1===e?this.modelId=Number(t):2===e&&(this.mountId=Number(t))}},o.prototype.getValue=function(e){return this.hasOwnProperty(e)?this[e]:C[e]},o.prototype.setDescription=function(e){if(this.effect.hasOwnProperty("descriptionId")){e.unshift(this.effect.descriptionId);var t=g.apply(null,e);this.description=t||"";var i=this.getValue("modificator");0!==i&&(this.description+=" "+m("ui.effect.boosted.spell.complement",[i],"%"));var n=this.getValue("random");n>0&&(this.getValue("group")>0?this.description+=" ("+m("ui.common.random")+")":this.description+=" "+m("ui.effect.randomProbability",[n],"%")),this.trigger&&(this.description=m("ui.spell.trigger",this.description))}},o.prototype.getDurationString=function(e){return this.delay?m("ui.common.delayTurn",this.delay,this.delay<=1):!this.duration||isNaN(this.duration)?"":this.duration<0?m("ui.common.infinit"):this.duration>1?m("ui.common.turn",this.duration,!0):e?m("ui.common.lastTurn"):m("ui.common.turn",this.duration,!1)},o.prototype.isDamageEffect=function(){return this.effect&&this.effect.category===M.damage},o.prototype.getZoneEffect=function(){return this.rawZone?t.parseZone(this.rawZone):{zoneShape:this.getValue("zoneShape"),zoneSize:this.getValue("zoneSize"),zoneMinSize:this.getValue("zoneMinSize"),zoneEfficiencyPercent:this.getValue("zoneEfficiencyPercent"),zoneMaxEfficiency:this.getValue("zoneMaxEfficiency")}},o.prototype.getHumanReadableZoneInfo=function(){return t.getHumanReadableZoneInfo(this.getZoneEffect())},o.prototype.requiresInvocationDescription=function(){return 181===this.effectId||1011===this.effectId},o.prototype.requiresGlyphDescription=function(){return 401===this.effectId||402===this.effectId},o.prototype.requiresTrapDescription=function(){return 400===this.effectId},o.prototype.requiresBombDescription=function(){return 1008===this.effectId},o.prototype.getCaller=function(){return this._effectCaller},o.prototype.forceDescriptionRefresh=function(e){this.description="",this.subEffectDescription="",r([this],null,function(t){return e?e(t):void(t&&y.error(t))})},t.createEffectInstances=function(e,t){e instanceof Array||(y.error(new Error("EF: Not an Array")),e=[e]);for(var i=[],n=0;n<e.length;n++)i.push(new o(e[n]));return d(i,t),i},t.createEffectInstancesIndexed=function(e,i){var n=[];for(var o in e)e.hasOwnProperty(o)&&(n.push(e[o]),e[o]=n.length-1);t.createEffectInstances(n,function(t,n){if(t)return i(t);for(var o in e)e.hasOwnProperty(o)&&(e[o]=n[e[o]]);return i(null,e)})};var A={EffectInstanceCreature:"ObjectEffectCreature",EffectInstanceDate:"ObjectEffectDate",EffectInstanceDice:"ObjectEffectDice",EffectInstanceDuration:"ObjectEffectDuration",EffectInstanceInteger:"ObjectEffectInteger",EffectInstanceLadder:"ObjectEffectLadder",EffectInstanceMinMax:"ObjectEffectMinMax",EffectInstanceMount:"ObjectEffectMount",EffectInstanceString:"ObjectEffectString"},S={ObjectEffectInteger:{actionId:1,value:1},ObjectEffectString:{actionId:1,value:1},ObjectEffectMinMax:{actionId:1,min:1,max:1},ObjectEffectMount:{actionId:1,mountId:1,date:1,modelId:1},ObjectEffectDuration:{actionId:1,days:1,hours:1,minutes:1},ObjectEffectDice:{actionId:1,diceNum:1,diceSide:1,diceConst:1},ObjectEffectDate:{actionId:1,year:1,month:1,day:1,hour:1,minute:1},ObjectEffectCreature:{actionId:1,monsterFamilyId:1},ObjectEffectLadder:{actionId:1,monsterFamilyId:1,monsterCount:1}};o.prototype.serialize=function(){var e,t=this._type;switch(t){case"EffectInstanceDate":return 669===this.effectId?e=h(this,"EffectInstanceDice"):(e=h(this,t),e.month--),e;case"EffectInstanceString":return e=h(this,t),e.value=this.text,e;case"EffectInstanceDice":return e=h(this,t),e.diceConst=this.value,e;default:return e=h(this,t)}}},function(e,t){e.exports={undefined:-1,miscellaneous:0,resistance:1,damage:2,special:3}},function(e,t){e.exports={X:{code:88,desc:"ui.spellarea.cross",alt:"",hasMinSize:!0},L:{code:76,desc:"ui.spellarea.line",alt:"",hasMinSize:!1},T:{code:84,desc:"ui.spellarea.tarea",alt:"",hasMinSize:!1},P:{code:80,desc:"",alt:"",hasMinSize:!1},D:{code:68,desc:"ui.spellarea.chessboard",alt:"",hasMinSize:!1},C:{code:67,desc:"ui.spellarea.circle",alt:"",hasMinSize:!0},O:{code:79,desc:"ui.spellarea.ring",alt:"",hasMinSize:!1},Q:{code:81,desc:"ui.spellarea.crossVoid",alt:"",hasMinSize:!0},V:{code:86,desc:"ui.spellarea.cone",alt:"",hasMinSize:!1},W:{code:87,desc:"",alt:"",hasMinSize:!1},"+":{code:43,desc:"",alt:"plus",hasMinSize:!0},"#":{code:35,desc:"",alt:"sharp",hasMinSize:!0},"*":{code:42,desc:"",alt:"star",hasMinSize:!1},"/":{code:47,desc:"",alt:"slash",hasMinSize:!1},"-":{code:45,desc:"ui.spellarea.diagonal",alt:"minus",hasMinSize:!1},G:{code:71,desc:"ui.spellarea.square",alt:"",hasMinSize:!1},I:{code:73,desc:"",alt:"",hasMinSize:!1},U:{code:85,desc:"ui.spellarea.halfcircle",alt:"",hasMinSize:!1},A:{code:65,desc:"ui.spellarea.everyone",alt:"",hasMinSize:!1}}},function(e,t){e.exports={DISPELLABLE:1,DISPELLABLE_BY_DEATH:2,DISPELLABLE_BY_STRONG_DISPEL:3,REALLY_NOT_DISPELLABLE:4}},function(e,t,i){function n(e,t,i,n){var s=this,a=e&&e.boostedSpellId,r=e&&e.delta;o.call(this,e,t,i,a,null,r,function(e,t){return e?n&&n(e):(s.modifType=0,s.spellId=a,s._delta=r,n&&n(null,t))})}var o=i(398),s=i(399),a=i(405),r=i(191).inherits,l=i(276);r(n,o),e.exports=n,n.prototype.getDelta=function(){return this._delta},n.prototype.apply=function(){if(this.targetId===window.gui.playerData.characters.controlledCharacterId){this.modifType=a(this.actionId),this.actionId===s.ACTION_DEBOOST_SPELL_RANGE&&(this._delta*=-1);for(var e=!1,t=window.gui.playerData.characters.mainCharacter.characteristics.spellModifications,i=0;i<t.length;i++){var n=t[i];if(this.spellId===n.spellId&&n.modificationType===this.modifType){e=!0;var r=n.value.getContextModif();n.value.setPts({contextModif:r+this._delta})}}if(!e){var c=new l({spellId:this.spellId,modificationType:this.modifType,value:{contextModif:this._delta}});t.push(c)}}o.prototype.apply.call(this)},n.prototype.remove=function(){if(!this._removed&&this.targetId===window.gui.playerData.characters.controlledCharacterId)for(var e=window.gui.playerData.characters.mainCharacter.characteristics.spellModifications,t=0;t<e.length;t++){var i=e[t];if(this.spellId===i.spellId&&i.modificationType===this.modifType){var n=i.value.getContextModif();i.value.setPts({contextModif:n-this._delta})}}o.prototype.remove.call(this)},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t,i){function n(e){return a[e]}var o=i(399),s=i(406),a={};a[o.ACTION_BOOST_SPELL_RANGEABLE]=s.RANGEABLE,a[o.ACTION_BOOST_SPELL_DMG]=s.DAMAGE,a[o.ACTION_BOOST_SPELL_BASE_DMG]=s.BASE_DAMAGE,a[o.ACTION_BOOST_SPELL_HEAL]=s.HEAL_BONUS,a[o.ACTION_BOOST_SPELL_AP_COST]=s.AP_COST,a[o.ACTION_BOOST_SPELL_CAST_INTVL]=s.CAST_INTERVAL,a[o.ACTION_BOOST_SPELL_CAST_INTVL_SET]=s.CAST_INTERVAL_SET,a[o.ACTION_BOOST_SPELL_CC]=s.CRITICAL_HIT_BONUS,a[o.ACTION_BOOST_SPELL_CASTOUTLINE]=s.CAST_LINE,a[o.ACTION_BOOST_SPELL_NOLINEOFSIGHT]=s.LOS,a[o.ACTION_BOOST_SPELL_MAXPERTURN]=s.MAX_CAST_PER_TURN,a[o.ACTION_BOOST_SPELL_MAXPERTARGET]=s.MAX_CAST_PER_TARGET,a[o.ACTION_BOOST_SPELL_RANGE]=s.RANGE,a[o.ACTION_DEBOOST_SPELL_RANGE]=s.RANGE,e.exports=n},function(e,t){e.exports={INVALID_MODIFICATION:0,RANGEABLE:1,DAMAGE:2,BASE_DAMAGE:3,HEAL_BONUS:4,AP_COST:5,CAST_INTERVAL:6,CAST_INTERVAL_SET:7,CRITICAL_HIT_BONUS:8,CAST_LINE:9,LOS:10,MAX_CAST_PER_TURN:11,MAX_CAST_PER_TARGET:12,RANGE:13}},function(e,t,i){function n(e,t,i,n){var s=this,r=e&&e.delta;o.call(this,e,t,i,r,null,null,function(e,t){return e?n&&n(e):(s.statName=a.getActionStatName(i),s.isABoost=a.getIsABoost(i),n&&n(null,t))})}var o=i(398),s=i(191).inherits,a=i(399);s(n,o),e.exports=n,n.prototype.getDelta=function(){return"EffectInstanceDice"===this.effect._type?this.isABoost?this.effect.diceNum:-this.effect.diceNum:0},n.prototype.apply=function(){var e=this.getDelta();this.incrementStats(e),o.prototype.apply.call(this)},n.prototype.remove=function(){if(!this._removed&&!this.effect.effect.active){var e=this.getDelta();this.decrementStats(e)}o.prototype.remove.call(this)},n.prototype.disable=function(){if(!this._disabled&&this.effect.effect.active){var e=this.getDelta();this.decrementStats(e)}o.prototype.disable.call(this)},n.prototype.incrementStats=function(e){var t=window.gui,i=t.fightManager.getFighter(this.targetId);if(!i)return void console.error("Trying to apply a stats buff on non-existing fighter "+this.targetId);var n=i.data.stats;switch(this.statName){case"vitality":n.lifePoints+=e,n.maxLifePoints+=e;break;case"lifePointsMalus":n.lifePoints=Math.min(n.lifePoints+e,n.maxLifePoints);break;case"lifePoints":case"shieldPoints":case"dodgePALostProbability":case"dodgePMLostProbability":n[this.statName]=Math.max(n[this.statName]+e,0);break;case"agility":n.tackleEvade+=~~(e/10),n.tackleBlock+=~~(e/10);break;case"globalResistPercentMalus":case"globalResistPercentBonus":var o="globalResistPercentBonus"===this.statName?1:-1;n.neutralElementResistPercent+=e*o,n.airElementResistPercent+=e*o,n.waterElementResistPercent+=e*o,n.earthElementResistPercent+=e*o,n.fireElementResistPercent+=e*o;break;case"actionPoints":n.actionPoints+=e,n.maxActionPoints+=e;break;case"movementPoints":n.movementPoints+=e,n.maxMovementPoints+=e;break;default:n.hasOwnProperty(this.statName)&&(n[this.statName]+=e)}var s=t.playerData.characters;if(s.mainCharacterId===this.targetId||s.controlledCharacterId===this.targetId){var a;if(a=s.mainCharacterId===this.targetId?s.mainCharacter:s.getControlledCharacter(),a.timeStatsSynchronized-this.timeCreationStarted>0)return void("summonableCreaturesBoost"===this.statName?t.fightManager.emit("updateSpellsAvailability"):"range"===this.statName&&window.foreground.refreshSpellRange());var r=a.characteristics;if(r.hasOwnProperty(this.statName)){var l=r[this.statName];if(l)if("CharacterBaseCharacteristic"===l._type){var c=l.getContextModif();l.setPts({contextModif:c+e})}else console.error(new Error("StatBuff: Try to update an unknown type "+l._type+" for "+this.statName))}switch(this.statName){case"vitality":a.setCharacteristic("maxLifePoints",Math.max(0,r.maxLifePoints+e)),a.setCharacteristic("lifePoints",Math.max(0,r.lifePoints+e));break;case"lifePoints":case"lifePointsMalus":a.setCharacteristic("lifePoints",Math.max(0,r.lifePoints+e));break;case"movementPoints":a.setCharacteristic("movementPointsCurrent",r.movementPointsCurrent+e);break;case"actionPoints":a.setCharacteristic("actionPointsCurrent",r.actionPointsCurrent+e);break;case"summonableCreaturesBoost":t.fightManager.emit("updateSpellsAvailability");break;case"range":window.foreground.refreshSpellRange()}}},n.prototype.decrementStats=function(e){this.incrementStats(-e)},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t,i){function n(e,t,i,n){var s=this,r=e&&e.stateId;o.call(this,e,t,i,r,null,null,function(e,t){return e?n&&n(e):(s.statName=a.getActionStatName(i),s.stateId=r,n&&n(null,t))})}var o=i(398),s=i(191).inherits,a=i(399),r=i(409),l=i(395);s(n,o),e.exports=n,n.prototype.apply=function(){var e=window.gui.fightManager.getFighter(this.targetId);return e?(e.addState(this.stateId),window.gui.shortcutBar.updateSpellsAvailability(),void o.prototype.apply.call(this)):console.error("Applying state buff failed, fighter does not exist.")},n.prototype.remove=function(){if(!this._removed){var e=window.gui.fightManager.getFighter(this.targetId);if(!e)return console.error("Removing state buff failed, fighter does not exist.");e.removeState(this.stateId),window.gui.shortcutBar.updateSpellsAvailability();var t=this.targetId,i=!this.hidden;window.gui.fightManager.deadTurnsList.indexOf(t)===-1&&(952===this.actionId?r.push(l.FIGHTER_ENTERING_STATE,[t,this.stateId],t,-1,!1,2,i):r.push(l.FIGHTER_LEAVING_STATE,[t,this.stateId],t,-1,!1,2,i))}o.prototype.remove.call(this)},n.prototype.clone=function(){var e=new n;return this._copyTo(e),e}},function(e,t,i){function n(e){if(e)return console.error("fightEvents#default",e)}function o(e,t,i,n,o,s,a){return void 0===o&&(o=0),void 0===s&&(s=1),void 0===a&&(a=!0),{name:e,targetId:i,params:t||[],checkParams:o,castingSpellId:n,order:y.length,firstParamToCheck:s,showChatMessage:a}}function s(e,t){var i,n=g().gui.databases.TypeActions[t],o=n?n.elementId:-1;switch(o){case-1:i="multi";break;case 0:i="neutral";break;case 1:i="earth";break;case 2:i="fire";break;case 3:i="water";break;case 4:i="air"}return i?"{style:"+i+"Damage,"+e+"}":e}function a(e,t){if(e.name===c.FIGHT_END)return t(null,_("ui.fight.fightEnd"));var i,n,o=g().gui.fightManager,a=e.params,r=o.getFighter(a[0]);if(!r)return t(new Error("Fighter does not exist."));var l;if(e.name===c.FIGHTER_DEATH)i=v(_("ui.fight.isDead"),0,r.name);else{if(e.name===c.FIGHTER_TRIGGERED_GLYPH)return l=o.getFighter(a[1]),l?o.getFighterSpell(a[2],a[1],function(e,n){return e?t(e):(i=_("ui.fight.startTrap",r.name,n.getName(),l.name),t(null,i))}):t(new Error("Second fighter does not exist."));if(e.name===c.FIGHTER_ENTERING_STATE){var p=a[2]?"</b> ("+a[2]+")<b>":"";n=g().gui.databases.SpellStates[a[1]],i=_("ui.fight.enterState",r.name,n.nameId+p)}else if(e.name===c.FIGHTER_LEAVING_STATE)n=g().gui.databases.SpellStates[a[1]],i=_("ui.fight.exitState",r.name,n.nameId);else{if(e.name===c.FIGHTER_SPELL_DISPELLED)return o.getFighterSpell(a[1],a[0],function(e,n){return e?t(e):(i=_("ui.fight.dispellSpell",r.name,n.getName()),t(null,i))});if(e.name===c.FIGHTER_CASTED_SPELL)return o.getFighterSpell(a[1],a[0],function(e,n){return e?t(e):(i=_("ui.fight.launchSpell",r.name,n.getName()),a[2]===d.CRITICAL_HIT?i+=" "+_("ui.fight.criticalHit"):a[2]===d.CRITICAL_FAIL&&(i+=" "+_("ui.fight.criticalMiss")),t(null,i))});if(e.name===c.FIGHTER_CLOSE_COMBAT)return h.getData("Items",[a[1]],function(e,n){return e?t(e):(i=_("ui.fight.closeCombat",r.name,n[0].nameId),a[2]===d.CRITICAL_HIT?i+=" "+_("ui.fight.criticalHit"):a[2]===d.CRITICAL_FAIL&&(i+=" "+_("ui.fight.criticalMiss")),t(null,i))});if(e.name===c.FIGHTER_LIFE_LOSS_AND_DEATH)i=_("ui.fight.lifeLossAndDeath",r.name,s(a[1],a[2]));else if(e.name===c.FIGHTER_LIFE_LOSS)i=_("ui.fight.lifeLoss",r.name,s(a[1],a[2]));else if(e.name===c.FIGHTER_SHIELD_LOSS)i=_("ui.fight.lostShieldPoints",r.name,s(a[1],a[2]));else if(e.name===c.FIGHTER_REDUCED_DAMAGES)i=_("ui.fight.reduceDamages",r.name,a[1]);else if(e.name===c.FIGHTER_LIFE_GAIN)i=_("ui.fight.lifeGain",r.name,a[1]);else if(e.name===c.FIGHTER_AP_LOST)i=_("ui.fight.lostAP",r.name,a[1]);else if(e.name===c.FIGHTER_AP_GAINED)i=_("ui.fight.winAP",r.name,a[1]);else if(e.name===c.FIGHTER_AP_LOSS_DODGED)i=_("ui.fight.dodgeAP",r.name,a[1]);else if(e.name===c.FIGHTER_MP_LOST)i=_("ui.fight.lostMP",r.name,a[1]);else if(e.name===c.FIGHTER_MP_GAINED)i=_("ui.fight.winMP",r.name,a[1]);else if(e.name===c.FIGHTER_MP_LOSS_DODGED)i=_("ui.fight.dodgeMP",r.name,a[1]);else if(e.name===c.FIGHTER_TEMPORARY_BOOSTED){var m=~~a[2];i=_("ui.fight.effect",r.name,m?a[1]+" ("+a[3]+")":a[1])}else if(e.name===c.FIGHTER_EFFECTS_MODIFY_DURATION)i=_("ui.fight.effectsModifyDuration",r.name,a[2]);else if(e.name===c.FIGHTER_SPELL_IMMUNITY)i=_("ui.fight.noChange",r.name);else if(e.name===c.FIGHTER_NO_CHANGE)i=_("ui.fight.noChange",r.name);else if(e.name===c.FIGHTER_LEAVE)i=_("ui.fight.leave",r.name);else if(e.name===c.FIGHTER_GOT_DISPELLED)i=_("ui.fight.dispell",r.name);else if(e.name===c.FIGHTER_REFLECTED_SPELL)i=_("ui.fight.reflectSpell",r.name);else if(e.name===c.FIGHTER_REFLECTED_DAMAGES)i=_("ui.fight.reflectDamages",r.name);else if(e.name===c.FIGHTER_GOT_TACKLED)i=_("ui.fight.dodgeFailed");else if(e.name===c.FIGHTER_VISIBILITY_CHANGED){var f=a[1]===u.INVISIBLE;i=f?_("ui.fight.invisibility",r.name):_("ui.fight.visibility",r.name)}else if(e.name===c.FIGHTER_GOT_KILLED){if(l=o.getFighter(a[1]),!l)return t(new Error("Second fighter does not exist."));if(a[0]===a[1])return t();i=_("ui.fight.killed",r.name,l.name)}}}return t(null,i)}function r(e,t){if(g().gui.fightManager.emit(e.name,e.params),e.name===c.FIGHTER_LIFE_LOSS&&b[e.params[0]])e.name=c.FIGHTER_LIFE_LOSS_AND_DEATH;else if(e.name===c.FIGHTER_DEATH&&w[e.params[0]])return t();return e.showChatMessage===!1?t():a(e,t)}function l(e,t){var i=[];M=!0,t||(t=n),m.eachSeries(e,function(e,t){r(e,function(e,n){return e?t(e):(n&&i.push(n),t())})},function(e){if(M=!1,b={},w={},e)return t(e);if(i.length&&g().gui.chat.logMsg(i.join("\n"),f.PSEUDO_CHANNEL_FIGHT_LOG),T.length){var n=T.shift();l(n[0],n[1])}return t()})}var c=i(395),u=i(410),d=i(411),h=i(30),p=i(29),m=i(31),f=i(412),g=i(189),_=p.getText,v=p.processTextWithModifier,y=[],b={},w={},M=!1,T=[];t.send=function(e,t,i,n,s,a,l){var c=o(e,t,i,n,s,a,l);r(c,function(e,t){return e?console.error("fightEvents#send",e):void(t&&g().gui.chat.logMsg(t,f.PSEUDO_CHANNEL_FIGHT_LOG))})},t.push=function(e,t,i,n,s,a,r){var l=o(e,t,i,n,s,a,r);l.name===c.FIGHTER_LIFE_LOSS?w[l.params[0]]=!0:l.name===c.FIGHTER_DEATH&&(b[l.params[0]]=!0),y.push(l)},t.reset=function(){y=[],b={},w={},M=!1,T=[]},t.flush=function(e){var t=y;return y=[],M?T.push([t,e]):void l(t,e)}},function(e,t){e.exports={INVISIBLE:1,DETECTED:2,VISIBLE:3}},function(e,t){e.exports={NORMAL:1,CRITICAL_HIT:2,CRITICAL_FAIL:3}},function(e,t){e.exports={CHANNEL_GLOBAL:0,CHANNEL_TEAM:1,CHANNEL_GUILD:2,CHANNEL_ALLIANCE:3,CHANNEL_PARTY:4,CHANNEL_SALES:5,CHANNEL_SEEK:6,CHANNEL_NOOB:7,CHANNEL_ADMIN:8,CHANNEL_ADS:12,CHANNEL_ARENA:13,PSEUDO_CHANNEL_PRIVATE:9,PSEUDO_CHANNEL_INFO:10,PSEUDO_CHANNEL_FIGHT_LOG:11}},function(e,t,i){function n(e,t){switch(t){case l:case c:return!1}switch(e){case r.ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_WATER:case r.ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_EARTH:case r.ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_AIR:case r.ACTION_CHARACTER_LIFE_POINTS_LOST_FROM_FIRE:return!0;default:return!1}}function o(e,t,i,o){var a=this,r=e&&e.param1,l=e&&e.param2,c=e&&e.param3;s.call(this,e,t,i,r,l,c,function(s,u){if(s)return o&&o(s);a.delay=e.delay,a.effect.delay=e.delay;var d=a.effect.effect||{};if(d.forceMinMax){var h=t&&t.spellRank&&t.spellRank.id;n(i,h)&&a._forceMinMax(r,l,c)}return o&&o(null,u)})}var s=i(398),a=i(191).inherits,r=i(399),l=24469,c=24470;a(o,s),e.exports=o,o.prototype._forceMinMax=function(e,t,i){var n=e||0,o=t||0,s=i||0,a=s+n,r=n*o+s;a===r?(n=a,o=0,s=0):a>r?(n=r,o=a,s=0):(n=a,o=r,s=0),this.updateParam(n,o,s)},o.prototype.isActive=function(){return this.delay>0||s.prototype.isActive.call(this)},o.prototype.isTrigger=function(){return!0},o.prototype.incrementDuration=function(e,t){return this.delay>0&&!t&&(this.delay+e>=0?(this.delay--,this.effect.delay--):(e+=this.delay,this.delay=0,this.effect.delay=0)),0===e||s.prototype.incrementDuration.call(this,e,t)},o.prototype.isUnusableNextTurn=function(){return this.delay<=1&&s.prototype.isUnusableNextTurn.call(this)},o.prototype.clone=function(){var e=new o;return this._copyTo(e),e}},function(e,t,i){function n(e,t){this.data=new u,this.id=e,this.name=null,this.level=null,this.picto=null,this.isBomb=!1,this.isCreature=!1,this.isBoss=!1,this.canTackle=!0,this.buffs=[],this._finishingBuffs=[],this.states=[],this.spells={},t||(this.picto=this.createPicto(e),this.isShieldBarVisible=!1,window.gui.timeline.linkToTimeline(this))}var o=i(235),s=i(415),a=i(457),r=i(190),l=i(390),c=i(397),u=i(458),d=i(29).getText,h=40,p=30,m=7,f=50,g=0;e.exports=n,n.prototype.clear=function(){this.picto&&(this.picto.destroy(),this.picto=null)},n.prototype.createPicto=function(e){var t=new o("div",{name:e,className:"fighter"});return t.fighterTimeBar=t.createChild("div",{className:"fighterTimeBar"}),t.fighterTimeValue=t.fighterTimeBar.createChild("div",{className:"fighterTimeValue"}),t.fighterIllus=t.appendChild(new s({className:"fighterIllus",scale:"fitin"})),t.fighterIcon=t.createChild("div",{className:"fighterIcon"}),t.fighterHPBar=t.createChild("div",{className:"fighterHPBar"}),t.fighterHPValue=t.fighterHPBar.createChild("div",{className:"fighterHPValue"}),t.fighterShieldBar=t.createChild("div",{className:"fighterShieldBar",hidden:!0}),t.fighterShieldValue=t.fighterShieldBar.createChild("div",{className:"fighterShieldValue"}),t.fighterNumber=t.createChild("div",{className:"fighterNumber"}),t.fighterNumber.toggleDisplay(!!r.orderFighters),t},n.prototype.createStatsTooltipContent=function(){var e,t=new o("table",{className:"statsDetails",name:"statsDetails"});return e=t.createChild("tr"),t.fighterName=e.createChild("td",{className:"fighterName",attr:{colspan:3}}),t.level=e.createChild("td",{className:"fighterLevel",attr:{colspan:2}}),e=t.createChild("tr"),t.lifePoints=e.createChild("td",{className:["label","iconLifePoints"],attr:{colspan:2}}),t.shieldPoints=e.createChild("td",{className:["label","iconShieldPoints"]}),t.fighterUsedAP=e.createChild("td",{className:["label","iconActionPoints"]}),t.movementPoints=e.createChild("td",{className:["label","iconMovementPoints"]}),e=t.createChild("tr"),t.dodgePALostProbability=e.createChild("td",{className:["label","iconDodgeAP"]}),t.dodgePMLostProbability=e.createChild("td",{className:["label","iconDodgeMP"]}),t.tackleBlock=e.createChild("td",{className:["label","iconTackle"]
}),t.criticalDamageReduction=e.createChild("td",{className:["label","iconCriticalDamage"]}),t.pushDamageReduction=e.createChild("td",{className:["label","iconPushDamageReduction"]}),e=t.createChild("tr"),t.neutral=e.createChild("td",{className:["label","iconYinyang"]}),t.strength=e.createChild("td",{className:["label","iconStrength"]}),t.intelligence=e.createChild("td",{className:["label","iconIntelligence"]}),t.chance=e.createChild("td",{className:["label","iconChance"]}),t.agility=e.createChild("td",{className:["label","iconAgility"]}),e=t.createChild("tr"),t.neutralPercent=e.createChild("td",{className:["label","iconYinyang"]}),t.strengthPercent=e.createChild("td",{className:["label","iconStrength"]}),t.intelligencePercent=e.createChild("td",{className:["label","iconIntelligence"]}),t.chancePercent=e.createChild("td",{className:["label","iconChance"]}),t.agilityPercent=e.createChild("td",{className:["label","iconAgility"]}),this.refreshStatsTooltipContent(t),t},n.prototype.refreshStatsTooltipContent=function(e){var t=this.data.stats;e.fighterName.setText(this.name),e.level.setText(d("ui.common.short.level")+" "+this.level),e.lifePoints.setText(t.lifePoints+" / "+t.maxLifePoints),e.shieldPoints.setText(t.shieldPoints),e.fighterUsedAP.setText(t.actionPoints),e.movementPoints.setText(t.movementPoints),e.dodgePALostProbability.setText(t.dodgePALostProbability),e.dodgePMLostProbability.setText(t.dodgePMLostProbability),e.tackleBlock.setText(Math.max(g,t.tackleBlock)),e.criticalDamageReduction.setText(t.criticalDamageFixedResist),e.pushDamageReduction.setText(t.pushDamageFixedResist),e.neutral.setText(t.neutralElementReduction),e.strength.setText(t.earthElementReduction),e.intelligence.setText(t.fireElementReduction),e.chance.setText(t.waterElementReduction),e.agility.setText(t.airElementReduction),"GameFightCharacterInformations"===this.data._type?(e.neutralPercent.setText(Math.min(f,t.neutralElementResistPercent)+"%"),e.strengthPercent.setText(Math.min(f,t.earthElementResistPercent)+"%"),e.intelligencePercent.setText(Math.min(f,t.fireElementResistPercent)+"%"),e.chancePercent.setText(Math.min(f,t.waterElementResistPercent)+"%"),e.agilityPercent.setText(Math.min(f,t.airElementResistPercent)+"%")):(e.neutralPercent.setText(t.neutralElementResistPercent+"%"),e.strengthPercent.setText(t.earthElementResistPercent+"%"),e.intelligencePercent.setText(t.fireElementResistPercent+"%"),e.chancePercent.setText(t.waterElementResistPercent+"%"),e.agilityPercent.setText(t.airElementResistPercent+"%"))},n.prototype.getFinishingBuffs=function(){var e=this._finishingBuffs;return this._finishingBuffs=[],e},n.prototype.synchronizeData=function(e){this.applyFinishingBuffs(e),this.setAlive(e.alive),this.data.updateData(e),this.setHP(e.stats.lifePoints),this.setShield(e.stats.shieldPoints)},n.prototype.applyFinishingBuffs=function(e){var t=this.getFinishingBuffs();if(0!==t.length)for(var i=0;i<t.length;i++)for(var n=t[i],o=n.statName,s=0;s<this.buffs.length;s++){var a=this.buffs[s];a.id===n.id&&o&&e.stats.hasOwnProperty(o)&&a.effect.effect.active&&("actionPoints"===o&&(e.stats.maxActionPoints-=n.getDelta()),e.stats[o]-=n.getDelta())}},n.prototype.getAvailableWidth=function(){var e=this.isSummon()?p:h;return this.isShieldBarVisible?e-m:e},n.prototype.isSummon=function(){return this.data.stats.summoned},n.prototype.resizeFighterIllustration=function(){if(this.picto){var e=this.getAvailableWidth();this.picto.fighterTimeBar.setStyles({width:e+"px"}),this.picto.fighterIllus.setStyles({width:e+"px"}),this.picto.fighterIllus.resize(),this.isBoss&&(this.picto.fighterTimeBar.addClassNames("boss"),this.picto.fighterIcon.addClassNames("bossIcon"))}},n.prototype.setData=function(e){this.data.updateData(e);var t=e.alive;this.data.alive=null,this.setAlive(t),this.setHP(this.data.stats.lifePoints),this.setShield(this.data.stats.shieldPoints),this.setNameAndLevel(e),this.picto&&(e.teamId===l.TEAM_CHALLENGER&&this.picto.addClassNames("challenger"),e.stats.summoned&&this.picto.addClassNames("summoned"),this.data.look&&this.updateFighterIllustration(),this.resizeFighterIllustration())},n.prototype.setAlive=function(e,t){(this.data.alive!==e||t)&&(this.data.alive=e,e||(this.setHP(0),this.setShield(0)),this.picto&&(this.picto.toggleClassName("dead",!e),t&&this.picto.toggleDisplay(e||!r.hideDeadFighters)))},n.prototype.setHP=function(e){if(this.data.stats){e=Math.max(0,e);var t=this.data.stats;t.lifePoints=e;var i=this.id===window.gui.playerData.characters.controlledCharacterId;if(i){var n=window.gui.playerData.characters.getControlledCharacter();n.setCharacteristic("lifePoints",t.lifePoints),n.setCharacteristic("maxLifePoints",t.maxLifePoints)}this.picto&&this.picto.fighterHPValue.setStyle("height",Math.min(e/t.maxLifePoints*100,100)+"%")}},n.prototype.setShield=function(e){if(this.data.stats){e=Math.max(0,e);var t=this.data.stats;if(t.shieldPoints=e,this.picto){var i=0!==t.shieldPoints;i&&this.picto.fighterShieldValue.setStyle("height",e/t.maxLifePoints*100+"%"),this.isShieldBarVisible!==i&&(this.isShieldBarVisible=i,this.picto.fighterShieldBar.toggleDisplay(i),this.resizeFighterIllustration())}window.gui.fightManager.emit("shieldPointsUpdated",this.id,e)}},n.prototype.setNameAndLevel=function(e){switch(e._type){case"GameFightCharacterInformations":this.name=e.name,this.level=e.level;break;case"GameFightMutantInformations":this.name=e.name,this.level=e.powerLevel;break;case"GameFightMonsterInformations":case"GameFightMonsterWithAlignmentInformations":this.name=e._name,this.level=e.monsterLevel,this.isBomb=e._isBomb,this.isCreature=e._isCreature,this.isBoss=e._isBoss,this.canTackle=e._canTackle;break;case"GameFightTaxCollectorInformations":this.name=e._name,this.level=e.level;break;default:console.warn('Retrieving details of fighter type "'+e._type+'" not supported')}},n.prototype.updateFighterIllustration=function(){this.picto&&this.picto.fighterIllus.setLook(this.data.look,{riderOnly:!0,direction:a.DIRECTION_SOUTH_EAST,animation:"AnimArtwork",boneType:"timeline/",skinType:"timeline/",showSubentities:!1})},n.prototype.refreshHP=function(){this.data.alive&&this.setHP(this.data.stats.lifePoints)},n.prototype.refreshShield=function(){this.setShield(this.data.stats.shieldPoints)},n.prototype.updateNumber=function(e){if(this.picto){var t=e||"";this.picto.fighterNumber.setText(t),r.orderFighters&&window.actorManager.turnNumberOn(this.id,t)}},n.prototype.addBuff=function(e,t){t=void 0===t||t;for(var i,n=0,o=this.buffs.length;n<o;n++)if(e.equals(this.buffs[n])){i=this.buffs[n];break}if(i){var s=i.castingSpell.spellRank&&i.castingSpell.spellRank.maxStack>0,a=s&&i.stack&&i.stack.length===i.castingSpell.spellRank.maxStack;if(a)return;i.add(e)}else this.buffs.push(e);t&&e.apply(),i?window.gui.fightManager.emit("BuffUpdate",i,this):window.gui.fightManager.emit("BuffAdd",e,this)},n.prototype.updateBuff=function(e){var t=this.getBuffIndex(e.id);if(t===-1)return!1;var i=this.buffs[t];return i.remove(),i.updateParam(e.getParam1(),e.getParam2(),e.getParam3(),e.id),i.apply(),window.gui.fightManager.emit("BuffUpdate",i,this),!0},n.prototype.getBuff=function(e){for(var t=0;t<this.buffs.length;t++){var i=this.buffs[t];if(e===i.id)return i}return null},n.prototype.getBuffIndex=function(e){for(var t=0;t<this.buffs.length;t++){var i=this.buffs[t];if(e===i.id)return t;if(i.stack)for(var n=0;n<i.stack.length;n++)if(e===i.stack[n].id)return t}return-1},n.prototype.addState=function(e){this.states.push(e)},n.prototype.removeState=function(e){this.states.indexOf(e)!==-1&&this.states.splice(this.states.indexOf(e),1)},n.prototype.hasState=function(e){return this.states.indexOf(e)!==-1},n.prototype.dispel=function(e,t,i){for(var n=[],o=0;o<this.buffs.length;o++){var s=this.buffs[o];s.canBeDispell(e,Number.MIN_VALUE,i)?(window.gui.fightManager.emit("BuffRemove",s,this),s.remove()):n.push(s)}this.buffs=n},n.prototype.dispelSpell=function(e,t,i,n){var o,s=[],a=[];for(o=0;o<this.buffs.length;o++){var r=this.buffs[o];e===r.castingSpell.spell.id&&r.canBeDispell(t,Number.MIN_VALUE,n)?(r.remove(),s.push(r)):a.push(r)}for(this.buffs=a,o=0;o<s.length;o++)window.gui.fightManager.emit("BuffRemove",s[o],this)},n.prototype.dispelUniqueBuff=function(e,t,i,n){var o=this.getBuffIndex(e);if(o===-1)return console.warn("Buff id",e,"does not exist");var s=this.buffs[o],a=window.gui.fightManager;if(s.canBeDispell(t,n?e:Number.MIN_VALUE,i))if(!i&&s.stack&&s.stack.length>1){switch(s.remove(),s.actionId){case 293:s.setParam1(s.stack[0].getParam1()),s.setParam2(s.getParam2()-s.stack[0].getParam2()),s.setParam3(s.getParam3()-s.stack[0].getParam3());break;case 788:s.setParam1(s.getParam1()-s.stack[0].getParam2());break;case 950:case 951:break;default:s.setParam1(s.getParam1()-s.stack[0].getParam1()),s.setParam2(s.getParam2()-s.stack[0].getParam2()),s.setParam3(s.getParam3()-s.stack[0].getParam3())}s.stack.shift(),s.refreshDescription(),s.apply(),a.emit("BuffUpdate",s,this)}else this.buffs.splice(o,1),s.remove(),a.emit("BuffRemove",s,this),a.emit("BuffRemove",s,this)},n.prototype.markFinishingBuffs=function(){var e=window.gui.fightManager;for(var t in this.buffs){var i=this.buffs[t];if(1===i.duration){for(var n=!1,o=0,s=!1,a=0;a<e.turnsList.length;a++){var r=e.turnsList[a];r===i.aliveSource&&(s=!0),r===e.currentFighterId&&(o=1),1===o&&(s&&r!==e.currentFighterId?(o=2,n=!0):r===this.id&&r!==e.currentFighterId&&(o=2,n=!1))}if(n){if(i instanceof c.StatBuff&&this.id!==window.gui.playerData.characters.mainCharacterId&&i.statName){var l=e.getFighter(i.targetId);if(!l)return console.error("Mark finishing buffs failed, fighter does not exist");l._finishingBuffs.push(i)}i.disable()}}}},n.prototype.enableBuffs=function(){for(var e in this.buffs)this.buffs[e].enable()}},function(e,t,i){function n(){return null}function o(){return p=document.createElement("canvas"),p.id="characterDisplayCanvas",p.width=g,p.height=_,m=new d(p,g,_,u.MAX_SPRITES_BUFFER_CHARACTER_DISPLAY,u.MAX_TEXTURE_MEMORY_CHARACTER_DISPLAY,u.PRERENDER_RATIO_CHARACTER_DISPLAY,(!0)),f={renderer:m,updateList:{push:n},displayList:{add:n,removeByRef:n}}}function s(e){r.call(this,"div",e),this.addClassNames("CharacterDisplay"),e=e||{},this.canvas=this.appendChild(new l),this.ctx=this.canvas.getContext("2d"),this.entity=null,this.scale=void 0!==e.scale?e.scale:1,this._scale=1/0,this.only4Directions=!1,"fitin"===this.scale?(this.horizontalAlign=e.horizontalAlign||"left",this.verticalAlign=e.verticalAlign||"bottom"):(this.horizontalAlign=e.horizontalAlign||"none",this.verticalAlign=e.verticalAlign||"none"),this.canvasInitialized=!1,this.renderingRequired=!1;var t=this;window.setTimeout(function(){t.rootElement&&(t.canvasInitialized=!0,t.resize())},0)}i(416);var a=i(191).inherits,r=i(235),l=i(417),c=i(419),u=i(184),d=i(445),h=i(439).Delay,p=null,m=null,f=null,g=Math.ceil(512*u.PIXEL_RATIO),_=Math.ceil(512*u.PIXEL_RATIO),v=2.5;a(s,r),e.exports=s,s.prototype.setLook=function(e,t,i){var n=this;if(t=t||{},null===this.entity){this.entity=new c({scene:f||o()});var s=t.showSubentities;this.entity.showSubentities=null===s||void 0===s||s}var a=void 0!==t.direction?t.direction:1;t.keepDirection||(this.entity.direction=a),t.riderOnly&&(e=c.getLookWithoutMount(e));var r=!1,l=!1,u=new h(30,function(){l||n.rootElement&&(n.addClassNames("spinner"),r=!0)});u.start(!1),this.entity.setLook(e,t,function(){return l=!0,r&&n.rootElement&&n.delClassNames("spinner"),null!==n.entity&&n.rootElement?(1===e.bonesId&&e.skins[0]&&n.entity.animManager.addAnimationModifier("AnimStatique","AnimStatique"+e.skins[0]),n.only4Directions=n.entity.animManager.only4Directions,t.animation&&(n.entity.animSymbol.base=t.animation),n._scale=1/0,n._render(),i&&i()):i&&i()})},s.prototype.release=function(){m&&(null!==this.entity&&(this.entity.remove(),this.entity=null),this._scale=1/0,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height))},s.prototype.clear=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},s.prototype.rotateCharacter=function(e){if(this.canvasInitialized&&this.entity){var t=this.entity.direction;return this.only4Directions?(0===(1&t)&&(t+=1),t+=e?2:-2,t>7&&(t=1),t<0&&(t=7)):(t+=e?1:-1,t>7&&(t=0),t<0&&(t=7)),this.entity.direction=t,this._render(),t}},s.prototype.resize=function(){var e=this.canvas,t=parseInt(this.getComputedStyle("width"),10),i=parseInt(this.getComputedStyle("height"),10),n=e.width,o=e.height;e.width=t*u.PIXEL_RATIO,e.height=i*u.PIXEL_RATIO,e.style.width=t+"px",e.style.height=i+"px",0!==e.width&&0!==e.height&&(this.renderingRequired||e.width!==n||e.height!==o)&&this._render()},s.prototype.setScale=function(e){e!==this.scale&&(this.scale=e,this._render())},s.prototype._computeScale=function(e,t,i,n,o,s){var a;if("cover"===e)a=this._scale=Math.min(this._scale,n/Math.abs(s[0]),n/Math.abs(s[1]),o/Math.abs(s[2]),o/Math.abs(s[3]));else if("width"===e)a=this._scale=Math.min(this._scale,t/(s[1]-s[0]));else if("height"===e)a=this._scale=Math.min(this._scale,i/(s[2]-s[3]));else if("fitin"===e)a=this._scale=Math.min(this._scale,t/(s[1]-s[0]),i/(s[2]-s[3])),a=Math.min(a,v);else if("%"===e[e.length-1]){var r=parseFloat(e);isNaN(r)?r=this._scale:r*=.01;var l=t/(s[1]-s[0]),c=i/(s[2]-s[3]),u=l>c?c:l;a=this._scale=r*u,a=Math.min(a,v)}return a||this._scale},s.prototype._render=function(){if(!this.canvasInitialized)return void(this.renderingRequired=!0);if(m&&this.entity){var e=this.canvas,t=e.width,i=e.height,n=m.gl,o=this.entity,s=this.scale;if(0===t||0===i){var a=this;return void window.setTimeout(function(){if(a.resize(),0===e.width||0===e.height)return console.warn("[CharacterDisplay._render] Character display size must be greater than zero.")},0)}m.clear(),o.x=0,o.y=0,o.scaleX=u.PIXEL_RATIO,o.scaleY=-u.PIXEL_RATIO,o.updateAnimation(),o.refreshAnimation();var r=o.bbox;if(r[1]<r[0]||r[2]<r[3]){var l=o.animManager.template.id,c=o.animSymbol.base;if("761/motion"===l)return;return void console.error(new Error("Entity animation frame is empty, template:"+l+", animation:"+c))}var d=.5*t,h=.85*i;"string"==typeof s&&(s=this._computeScale(s,t,i,d,h,r)),o.scaleX*=s,o.scaleY*=s;var p=Math.floor(r[0]*s),f=Math.ceil(r[1]*s),g=-Math.floor(r[2]*s),v=-Math.ceil(r[3]*s),y=f-p,b=v-g;if(0===y||0===b)return console.warn("[CharacterDisplay._render] Character to render is of size 0.");o.x=-p,o.y=v,o.render(),o.animManager.releaseBuffer();var w=new window.Uint8Array(y*b*4);n.readPixels(0,_-b,y,b,n.RGBA,n.UNSIGNED_BYTE,w);for(var M=this.ctx.createImageData(y,b),T=M.data,C=0;C<w.length;C++)T[C]=w[C];var I,A;switch(this.horizontalAlign){case"left":I=0;break;case"center":I=(t-y)/2;break;case"right":I=t-y;break;default:I=d+p}switch(this.verticalAlign){case"top":A=0;break;case"center":A=(i-b)/2;break;case"bottom":A=i-b;break;default:A=h+g}this.ctx.clearRect(0,0,t,i),this.ctx.putImageData(M,I,A)}}},function(e,t){},function(e,t,i){function n(e){s.call(this,"canvas",e),this.addClassNames("Canvas"),this.style=this.rootElement.style}i(418);var o=i(191).inherits,s=i(235);o(n,s),e.exports=n,n.prototype.getContext=function(e){return e=e||"2d",this.rootElement.getContext(e)},Object.defineProperty(n.prototype,"width",{get:function(){return this.rootElement.width},set:function(e){this.rootElement.width=e}}),Object.defineProperty(n.prototype,"height",{get:function(){return this.rootElement.height},set:function(e){this.rootElement.height=e}})},function(e,t){},function(e,t,i){function n(e,t){s.call(this,e,t),this.direction=void 0===e.direction?1:e.direction,this.animSymbol={base:"AnimStatique",type:null,direction:this.direction},this.look=null,this.showSubentities=!0}var o=i(191).inherits,s=i(420),a=i(424),r=i(425),l=i(426),c=i(441),u=i(444);o(n,s),e.exports=n,n.prototype.updateAnimation=function(){this.animSymbol.direction=this.direction,this.animManager.assignSymbol(this.animSymbol,!1)},n.prototype.addSubentity=function(e,t,i){if(this.showSubentities){var n=e.subEntityLook;if(!n)return void console.error(new Error("Sub-entity has no look: "+Object.keys(e).join(";")));var o=n.bonesId+"/motion",s=n.skins,r=n.scales[0],u=a.parseIndexedColors(n.indexedColors),d=this;t.addToSprite=!1,l.loadCharacterAnimationManager(this,o,s,u,r,t,function(t){return d.animManager.addSubentity({animManager:t,bindingPoint:"carried_"+e.bindingPointCategory+"_"+e.bindingPointIndex,symbolModifier:c[e.bindingPointCategory],bindingPointCategory:e.bindingPointCategory}),i&&i(t)})}},n.prototype.addSubentities=function(e,t,i){function n(){if(s+=1,s===o)return i&&i()}if(!e)return i&&i();for(var o=e.length+1,s=0,a=0;a<e.length;a+=1)this.addSubentity(e[a],t,n);n()},n.prototype.setLook=function(e,t,i){function n(){return m.clear(!0),i&&i()}for(var o=this.look,s=e.scales[0],c=e.skins,u=o&&this.look.bonesId===e.bonesId&&this.look.skins.length===c.length&&this.look.scales[0]===s,d=0;u&&d<c.length;d+=1)u=u&&c[d]===this.look.skins[d];this.look=e;var h=a.parseIndexedColors(e.indexedColors);if(u)return this.animManager.setTints(h),this.animManager.cleanupAnimationsAndRemoveSubentities(),void this.addSubentities(e.subentities,t,i);if(o&&this.isDisplayed&&!t.noSmokeAnimation){var p=new r({x:this.x,y:this.y,position:this.position+1,scene:this.scene});l.loadAnimationManager(p,"bone","1165/FX",function(e){e.assignSymbol({base:"FX",direction:0},!1,function(){p.remove()})})}var m=this.animManager;l.loadLook(this,e,t,n)};var d=u.HOOK_POINT_CATEGORY_MOUNT_DRIVER,h={};h[2]=1,h[1084]=44,h[1068]=113,h[1202]=453,h[1575]=1,h[1576]=1,h[2456]=1107,n.getLookWithoutMount=function(e){var t=n.getLookOfRider(e);return t?{_type:"EntityLook",bonesId:h[t.bonesId]||t.bonesId,indexedColors:t.indexedColors,scales:t.scales,skins:t.skins,subentities:t.subentities}:e},n.getLookOfRider=function(e){if(!e)return console.error(new Error("look is missing")),null;for(var t=e.subentities||[],i=0;i<t.length;i+=1){var n=t[i];if(n.bindingPointCategory===d&&0===n.bindingPointIndex)return n.subEntityLook}return null}},function(e,t,i){function n(e,t){s.call(this,e),this.animManager=t||new a(this)}var o=i(191).inherits,s=i(421),a=i(423);o(n,s),e.exports=n,n.prototype.setAnimManager=function(e){this.animManager.switchAnimationManager(e),this.animManager=e},n.prototype.render=function(){this.renderer.save(),this.renderer.multiplyColor(this.tint[0],this.tint[1],this.tint[2],this.tint[3]),this.renderer.translate(this._x,this._y),0!==this._rotation&&this.renderer.rotate(this._rotation),this.renderer.scale(this._scaleX,this._scaleY),this.animManager.draw(this.renderer),this.renderer.restore()},n.prototype.remove=function(){return this.hide(),this.isWhiteListed===!0?this.animManager.stop():void(this._cleared!==!0&&(this._cleared=!0,this.animManager.clear()))},n.prototype.refreshAnimation=function(e){if(this.isOutdated=!1,this.isDisplayed===!1)return void 0!==e&&e.push(this.bbox),void(this.bbox=[1/0,-(1/0),1/0,-(1/0)]);var t=this.bbox,i=this.animManager.generateCurrentFrameData();if(0===this._rotation)this.bbox=[this._x+this._scaleX*(this._scaleX>0?i[0]:i[1]),this._x+this._scaleX*(this._scaleX>0?i[1]:i[0]),this._y+this._scaleY*i[2],this._y+this._scaleY*i[3]];else{var n=Math.cos(this._rotation),o=Math.sin(this._rotation),s=this._scaleX*i[0],a=this._scaleX*i[1],r=this._scaleY*i[2],l=this._scaleY*i[3],c=n*s-o*r,u=o*s+n*r,d=n*a-o*r,h=o*a+n*r,p=n*s-o*l,m=o*s+n*l,f=n*a-o*l,g=o*a+n*l;this.bbox=[this._x+Math.min(c,d,p,f),this._x+Math.max(c,d,p,f),this._y+Math.min(u,h,m,g),this._y+Math.max(u,h,m,g)]}t[0]=Math.floor(Math.min(t[0],this.bbox[0])),t[1]=Math.ceil(Math.max(t[1],this.bbox[1])),t[2]=Math.floor(Math.min(t[2],this.bbox[2])),t[3]=Math.ceil(Math.max(t[3],this.bbox[3])),void 0!==e&&e.push(t)},n.prototype._refreshAnimation=n.prototype.refreshAnimation},function(e,t,i){function n(e){a.call(this,e),this._layer=e.layer||0,this._x=e.x||0,this._y=e.y||0,this._scaleX=e.sx||1,this._scaleY=e.sy||1,this._rotation=e.rotation||0,this._spriteRef=null,this.isDisplayed=!1,this.isWhiteListed=!1,this.scene=e.scene,this.renderer=this.scene.renderer,this.updateList=this.scene.updateList,this.displayList=this.scene.displayList,this.holdsStatics&&(this.displayList=this.scene.staticElements),e.isHudElement&&(this.displayList=this.scene.hudDisplayList),this._cleared=!1,this.show()}function o(e){var t=document.createElement("canvas");t.width=l,t.height=l;var i=t.getContext("2d");return i.fillStyle="#FF0000",i.fillRect(0,0,l,l),r=e.createTexture(t,null,"nearest","permanent")}var s=i(191).inherits,a=i(422);s(n,a),e.exports=n,Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"scaleX",{get:function(){return this._scaleX},set:function(e){this._scaleX=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"scaleY",{get:function(){return this._scaleY},set:function(e){this._scaleY=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"layer",{get:function(){return this._layer},set:function(e){e!==this._layer&&(this._layer=e,this.isDisplayed&&this._show(),this.forceRefresh())}}),n.prototype.render=function(){this.renderer.save(),this.renderer.multiplyColor(this.tint[0],this.tint[1],this.tint[2],this.tint[3]),this.renderer.translate(this._x,this._y),0!==this._rotation&&this.renderer.rotate(this._rotation),this.renderer.scale(this._scaleX,this._scaleY),this.draw(this.renderer),this.renderer.restore()},n.prototype._show=function(){null===this._spriteRef?this._spriteRef=this.displayList.add(this):this._spriteRef=this.displayList.reposition(this._spriteRef)},n.prototype._hide=function(){null!==this._spriteRef&&(this.displayList.removeByRef(this._spriteRef)||console.warn("[Sprite.remove] Sprite not found in display list",this,this.displayList),this._spriteRef=null)},n.prototype.show=function(){this._show(),this.isDisplayed=!0,this.forceRefresh()},n.prototype.hide=function(){this._hide(),this.isDisplayed=!1,this.forceRefresh()},n.prototype.forceRefresh=function(){this.isOutdated===!1&&(this.updateList.push(this),this.isOutdated=!0)},n.prototype.setWhiteListedness=function(e){this.isWhiteListed=e},n.prototype.remove=function(){if(this.hide(),this.isWhiteListed===!1){if(this._cleared===!0)return;this._cleared=!0,this.clear()}},n.prototype.isWithinBounds=function(e,t){return this.bbox[0]<=e&&e<=this.bbox[1]&&this.bbox[2]<=t&&t<=this.bbox[3]},n.prototype.refreshAnimation=function(e){if(this.isOutdated=!1,this.isDisplayed===!1)return void 0!==e&&e.push(this.bbox),void(this.bbox=[1/0,-(1/0),1/0,-(1/0)]);var t=this.bbox,i=this.generateCurrentFrameData();if(0===this._rotation)this.bbox=[this._x+this._scaleX*(this._scaleX>0?i[0]:i[1]),this._x+this._scaleX*(this._scaleX>0?i[1]:i[0]),this._y+this._scaleY*i[2],this._y+this._scaleY*i[3]];else{var n=Math.cos(this._rotation),o=Math.sin(this._rotation),s=this._scaleX*i[0],a=this._scaleX*i[1],r=this._scaleY*i[2],l=this._scaleY*i[3],c=n*s-o*r,u=o*s+n*r,d=n*a-o*r,h=o*a+n*r,p=n*s-o*l,m=o*s+n*l,f=n*a-o*l,g=o*a+n*l;this.bbox=[this._x+Math.min(c,d,p,f),this._x+Math.max(c,d,p,f),this._y+Math.min(u,h,m,g),this._y+Math.max(u,h,m,g)]}t[0]=Math.floor(Math.min(t[0],this.bbox[0])),t[1]=Math.ceil(Math.max(t[1],this.bbox[1])),t[2]=Math.floor(Math.min(t[2],this.bbox[2])),t[3]=Math.ceil(Math.max(t[3],this.bbox[3])),void 0!==e&&e.push(t)};var r=null,l=32;n.prototype.draw=function(){window.isoEngine.debug&&this.renderer.drawImage(r||o(this.renderer),-l/2,-l/2,l,l)},n.prototype.generateCurrentFrameData=function(){return[-l/2,l/2,-l/2,l/2]},n.prototype.clear=n.prototype.releaseBuffer=function(){}},function(e,t){function i(e){this.sprite=e,this._red=1,this._green=1,this._blue=1,this._alpha=1}function n(e){this.id=e.id,this._position=e.position||0,this.bbox=[1/0,-(1/0),1/0,-(1/0)],this.renderer=null,this._highlight=new i(this),this._hue=e.hue||[1,1,1,1],this.tint=this.hue.slice(),this._alpha=1,this.alpha=void 0===e.alpha?1:e.alpha,this.isOutdated=!1}Object.defineProperty(i.prototype,"red",{get:function(){return this._red},set:function(e){this._red=e;var t=this.sprite;t.tint[0]=t.hue[0]*e,t.forceRefresh()}}),Object.defineProperty(i.prototype,"green",{get:function(){return this._green},set:function(e){this._green=e;var t=this.sprite;t.tint[1]=t.hue[1]*e,t.forceRefresh()}}),Object.defineProperty(i.prototype,"blue",{get:function(){return this._blue},set:function(e){this._blue=e;var t=this.sprite;t.tint[2]=t.hue[2]*e,t.forceRefresh()}}),Object.defineProperty(i.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e;var t=this.sprite;t.tint[3]=t.hue[3]*e,t.forceRefresh()}}),e.exports=n,Object.defineProperty(n.prototype,"position",{get:function(){return this._position},set:function(e){e!==this._position&&(this._position=e,this.isDisplayed&&this._show(),this.forceRefresh())}}),Object.defineProperty(n.prototype,"hue",{get:function(){return this._hue},set:function(e){e!==this._hue&&(this._hue=e,this.tint[0]=this.hue[0]*this._highlight.red,this.tint[1]=this.hue[1]*this._highlight.green,this.tint[2]=this.hue[2]*this._highlight.blue,this.tint[3]=this.hue[3]*this._highlight.alpha*this._alpha,this.isDisplayed&&this._show(),this.forceRefresh())}}),Object.defineProperty(n.prototype,"highlight",{get:function(){return this._highlight},set:function(e){this.setHighlight(e)}}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this.tint[3]=this.hue[3]*this._highlight.alpha*this._alpha,this.forceRefresh())}}),n.prototype.setHighlight=function(e){return null===e?void this.removeHighlight():(this._highlight._red=e.red,this._highlight._green=e.green,this._highlight._blue=e.blue,this._highlight._alpha=e.alpha,this.tint[0]=this.hue[0]*e.red,this.tint[1]=this.hue[1]*e.green,this.tint[2]=this.hue[2]*e.blue,this.tint[3]=this.hue[3]*e.alpha*this._alpha,void this.forceRefresh())},n.prototype.removeHighlight=function(){this.tint[0]=this.hue[0],this.tint[1]=this.hue[1],this.tint[2]=this.hue[2],this.tint[3]=this.hue[3]*this._alpha,this.forceRefresh()},n.prototype.forceRefresh=function(){}},function(e,t){function i(e){this.sprite=e,this.hasSubentities=!1,this.subentities=[],this.animationModifiers={}}function n(e){var t=document.createElement("canvas");t.width=s,t.height=s;var i=t.getContext("2d");return i.fillStyle="#FF0000",i.fillRect(0,0,s,s),o=e.createTexture(t,null,"nearest","permanent")}e.exports=i,i.prototype.isTemporary=!0,i.prototype.switchAnimationManager=function(e){e.hasSubentities=this.hasSubentities,e.subentities=this.subentities,e.animationModifiers=this.animationModifiers},i.prototype.addSubentity=function(e){this.subentities.push(e),this.hasSubentities=!0},i.prototype.removeSubentity=function(e){var t=this.subentities.indexOf(e);return t===-1?console.error("Subentity does not exist."):(e.animManager.cleanupAnimations(),this.subentities.splice(t,1),void(this.hasSubentities=this.subentities.length>0))},i.prototype.addAnimationModifier=function(e,t){this.animationModifiers[e]=t},i.prototype.removeAnimationModifier=function(e){delete this.animationModifiers[e]},i.prototype.cleanupAnimations=function(){for(var e=0;e<this.subentities.length;e++)this.subentities[e].animManager.cleanupAnimations()},i.prototype.cleanupAnimationsAndRemoveSubentities=function(){for(var e=0;e<this.subentities.length;e++)this.subentities[e].animManager.cleanupAnimations();this.subentities=[],this.hasSubentities=!1};var o=null,s=32;i.prototype.draw=function(){window.isoEngine.debug&&this.sprite.renderer.drawImage(o||n(this.sprite.renderer),-s/2,-s/2,s,s)},i.prototype.generateCurrentFrameData=function(){return[-s/2,s/2,-s/2,s/2]},i.prototype.assignSymbol=function(e,t,i){return console.warn("Attempt to call abstract method TemporaryAnimationManager.assignSymbol",e),i&&i()},i.prototype.getSymbolDuration=function(){return 0},i.prototype.clear=i.prototype.stop=i.prototype.releaseBuffer=i.prototype.addAnimation=i.prototype.applyAnimationModifier=i.prototype.setTints=i.prototype.prepareCurrentAnimationFrame=function(){}},function(e,t){function i(e,t){var i=e.toString(16).toUpperCase();if(t)for(;i.length<t;)i="0"+i;return i}function n(e){var t=i(e[0],2),n=i(e[1],2),o=i(e[2],2);return"#"+t+n+o}function o(e){return e=e.substr(1),3===e.length?[parseInt(e[0]+e[0],16)/255,parseInt(e[1]+e[1],16)/255,parseInt(e[2]+e[2],16)/255,1]:[parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,1]}function s(e){var t=e.indexOf("("),i=e.indexOf(","),n=e.indexOf(",",i+1),o=e.indexOf(",",n+1),s=e.indexOf(")",o+1);return[parseInt(e.substr(t+1,i),10)/255,parseInt(e.substr(i+1,n),10)/255,parseInt(e.substr(n+1,o),10)/255,parseFloat(e.substr(o+1,s))]}function a(e){var t=(251658240&e)>>24,i=(16711680&e)>>16,n=(65280&e)>>8,o=255&e;return{index:t,color:{r:i,g:n,b:o}}}function r(e,t){return e+(t<<24)}function l(e){for(var t=[],i=0;i<e.length;i++)t.push(r(e[i],i+1));return t}function c(e){if("string"==typeof e){if(0===e.indexOf("#"))return o(e);if(0===e.indexOf("rgba("))return s(e)}return e}function u(e){var t=null;if(e&&e.length>0){t=[null,null,null,null,null,null];for(var i=0;i<e.length;i++){var n=a(e[i]);t[n.index]=n.color}}return t}function d(e,t,i,n){var o=0;return o|=(15&e)<<24,o|=(255&t)<<16,o|=(255&i)<<8,o|=255&n}function h(e){var t=parseInt(e,16);if(6===e.length)return{r:(16711680&t)>>16,g:(65280&t)>>8,b:255&t};if(3===e.length){var i=(3840&t)>>8,n=(240&t)>>4,o=15&t;return{r:i+(i<<4),g:n+(n<<4),b:o+(o<<4)}}return console.warn("[hexToRgb] Invalid hex value"),null}t.colorArrayToHexa=n,t.hexToColorArray=o,t.rgbaToColorArray=s,t.parseIndexedColor=a,t.addIndex=r,t.addIndexes=l,t.anyToColorArray=c,t.parseIndexedColors=u,t.getIndexedColor=d,t.hexToRgb=h},function(e,t,i){function n(e){s.call(this,e,e.animManager),this.offsetY=e.offsetY||0}var o=i(191).inherits,s=i(420);o(n,s),e.exports=n,n.prototype.isFx=!0},function(e,t,i){function n(e,t,i){this.type=e,this.id=t,this.usage=i||""}function o(e,i,n,o,a,r){var l=i.subEntityLook,c=l.bonesId+"/motion",d=l.skins,h=l.scales[0],p=s.parseIndexedColors(l.indexedColors);t.loadCharacterAnimationManager(e,c,d,p,h,a,function(t){o[n]=t,i.bindingPointCategory===u&&(e.riderEntity=t),r()})}var s=i(424),a=i(427),r=i(438),l=i(441),c=i(444),u=c.HOOK_POINT_CATEGORY_MOUNT_DRIVER;t.loadCharacterAnimationManager=function(e,t,i,o,s,l,c){function u(n){var a=n[0];a.isEmpty&&(console.warn("boneTemplate isEmpty"),a=n[1]);for(var l=n.length-1,u=2;u<=l;u+=1){var d=n[u];d?a.merge(d,!0):console.error("onTemplatesLoaded: skinTemplate is missing on index",u,"of",n.length,"for skinIds",i,"and boneId",t,"stack:",g)}var h=t.split("/")[0],p=new r(e,a,s?s/100:1,h,o);return m!==!1&&e.setAnimManager(p),c&&c(p)}l=l||{};var d=[];d.push(new n("bone",t,l.boneType)),d.push(new n("bone","666/motion",l.boneType));for(var h=i.length,p=0;p<h;p+=1)d.push(new n("skin",i[p],l.skinType));var m=l.addToSprite,f=l.textureCache||e.renderer,g=new Error("stack");a.loadTemplates(d,u,f,"archivable")},t.loadAnimationManager=function(e,t,i,n){function o(t){var o="string"==typeof i?i.split("/").shift():i,s=new r(e,t,1,o);return e.setAnimManager(s),n&&n(s)}var s=e.renderer;a.loadTemplate(t,i,"",o,s,"archivable")},t.loadLook=function(e,i,n,a){function r(){if(m+=1,m===f){for(var e=0;e<h;e+=1){var t=d[e],i=u[e];p&&i.addSubentity(p),c.addSubentity({animManager:i,bindingPoint:"carried_"+t.bindingPointCategory+"_"+t.bindingPointIndex,symbolModifier:l[t.bindingPointCategory],bindingPointCategory:t.bindingPointCategory})}return a&a(c)}}n=n||{};var c=null,u=[],d=e.showSubentities?i.subentities:null,h=d?d.length:0,p=null,m=0,f=2+h,g=i.bonesId+"/motion",_=i.skins,v=s.parseIndexedColors(i.indexedColors),y=i.scales[0];t.loadCharacterAnimationManager(e,g,_,v,y,n,function(t){c=t;var i=t.sprite.parentActor;i&&(i.carriedEntity.animManager=t),e.carriedEntity&&(!e.actorManager.isCreatureModeOn&&h>0?p=e.carriedEntity:c.addSubentity(e.carriedEntity)),
r()}),n.addToSprite=!1;for(var b=0;b<h;b+=1)o(e,d[b],b,u,n,r);r()}},function(e,t,i){function n(e,t,i){this.symbols=e,this.matrices=t,this.colors=i}function o(e,t,i){if(t===a.EMPTY_JSON)return w;g.jeffVersionDowngrader(t);var o,s,r,l=!!t.symbols,c={};l?(s=new n(c,t.matrices,t.colors),r=h,o=t.symbols):(s=c,r=p,o=t);for(var u=Object.keys(o),m=0;m<u.length;m+=1){var f=u[m],_=o[f];_.isGraphic&&(c[f]=new d(_,s,i)),_.isAnim&&(c[f]=new r(_,s,i))}return b.addAndHoldElement(s,1,e)}function s(e,t,i,n){var o=!!n.element.symbols,s=o?new m(t):new f(t);return s.generateTemplate(i,n),u.createAnimSoundGroups(s.getAnimationSounds(t),"sfx"),s}var a=i(184),r=i(428),l=i(202),c=i(430),u=i(258),d=i(431),h=i(432),p=i(433),m=i(434),f=i(436),g=i(252),_=i(437),v={skin:a.SKIN_PATH,bone:a.BONE_PATH,icon:a.ICON_PATH,ornaments:a.ORNAMENT_PATH,embedded:a.EMBEDDED_PATH,loader:a.LOADER_PATH},y={skin:"mipmap",bone:"mipmap",icon:"linear",ornaments:"linear",embedded:"linear",loader:"linear"},b=new r(a.MAX_ANIMATIONS),w={element:new n({},[],[]),release:function(){}};t.loadTemplate=function(e,t,i,n,a,r){function u(i){if(m=i,T+=1,T===C){I=o(M,m,p);var a=s(e,t,p,I);return n&&n(a)}}function d(i){if(p=i,T+=1,T===C){void 0===I&&(I=o(M,m,p));var a=s(e,t,p,I);return n&&n(a)}}if(_.isMissingTemplates(t)){var h=a.getEmptyTexture();return n&&n(s(e,t,h,w))}var p,m,f=v[e]+i+t,g=f+".png",M=f+".json",T=0,C=1,I=b.holdElement(M);void 0===I&&(C+=1,l.loadJson(M,u)),c.loadTexture(g,d,a,y[e],r)},t.loadTemplates=function(e,t,i,n){function a(i,n){var a=M[n],r=u[a];if(void 0===r)h[a]=i;else{var l=f[a],c=o(l,i,r);d[a]=c;var m=e[a];p[a]=s(m.type,m.id,r,c)}if(C+=1,C===I)return t&&t(p)}function r(i,n){u[n]=i;var a,r,l=h[n];if(void 0===l)a=d[n],void 0!==a&&(r=e[n],p[n]=s(r.type,r.id,i,a));else{var c=f[n];a=o(c,l,i),r=e[n],p[n]=s(r.type,r.id,i,a)}if(C+=1,C===I)return t&&t(p)}for(var u=[],d=[],h=[],p=[],m=[],f=[],g=[],M=[],T=e.length,C=0,I=0,A=0;A<T;A+=1){var S=e[A],E=S.type,x=S.id;if(_.isMissingTemplates(x)){var L=i.getEmptyTexture();p[A]=s(E,x,L,w)}else{var N=v[E]+S.usage+x,O=N+".png",D=N+".json";m.push(O),f.push(D),I+=1;var R=b.holdElement(D);void 0===R?(g.push(D),M.push(A),I+=1):d[A]=R}}var P=y[e[0].type];c.loadTextures(m,r,null,i,P,n),l.loadJsons(g,a,null)}},function(e,t,i){function n(e,t,i,n,o){this.id=n,this.cache=e,this.element=t,this.memorySize=i,this.type=a[o],this.nLocks=0,this.reference=null,this.attachment=null}function o(e,t){this.elementsById={},this.actives=new s,this.archives=new s,this.memoryUsed=0,this.memoryAllocated=e,this.onElementRemoved=t||null,this.unidentifiedElementsCount=0,this.addCount=0,this.removeCount=0}var s=i(429),a={permanent:0,archivable:1,throwable:2};n.prototype.isPermanent=function(){return this.type===a.permanent},n.prototype._hold=function(){return this.type===a.permanent?this:(this.nLocks+=1,this.cache._holdElement(this),this)},n.prototype.release=function(){return this.type===a.permanent?this:(this.nLocks-=1,void(0===this.nLocks?this.cache._releaseElement(this):this.nLocks<0&&console.error(new Error("[ElementHandle.release] Number of locks is negative: "+this.id))))},n.prototype.isFree=function(){return 0===this.nLocks},e.exports=o,o.prototype._clean=function(){for(var e=this.archives.first;null!==e&&this.memoryUsed>this.memoryAllocated;){var t=e.object;e=e.next,t.nLocks<=0&&this._removeElement(t)}},o.prototype.log=function(){console.log("***** Cache Stats *****"),console.log("  Actives",this.actives.length),console.log("  Archives",this.archives.length),console.log("  Total",Object.keys(this.elementsById).length),console.log("  Usage (units)",this.memoryUsed),console.log("  Usage (percentage)",(100*this.memoryUsed/this.memoryAllocated).toFixed(0),"%"),console.log("  Elements",this.elementsById)},o.prototype._holdElement=function(e){e.type!==a.permanent&&(e.reference.container===this.actives?this.actives.moveToTheEnd(e.reference):(this.archives.removeByReference(e.reference),e.reference=this.actives.addBack(e)))},o.prototype._releaseElement=function(e){this._archiveElement(e)},o.prototype._archiveElement=function(e){return e.reference.container!==this.actives?void console.warn("[Cache3State.archiveElement] The element cannot be archived:",e.id):void(e.type===a.throwable?this._removeElement(e):(this.actives.removeByReference(e.reference),e.reference=this.archives.addBack(e),this._clean()))},o.prototype._addElement=function(e){this.elementsById[e.id]=e,this.memoryUsed+=e.memorySize,this._clean(),e.type!==a.permanent&&(e.reference=this.actives.addBack(e)),this.addCount+=1},o.prototype.addAndHoldElement=function(e,t,i,o,s){var r=Boolean(i);r===!1&&(i="unidentified"+String(this.unidentifiedElementsCount++)),void 0!==o&&null!==o||(o=r?"archivable":"throwable");var l=this.elementsById[i];if(void 0!==l){if(!s)return l.type!==a[o]&&console.warn("[Cache3State.addElement] Trying to change type of an exisiting element",i),l._hold();if(l.isFree()===!1)return console.warn("[Cache3State.addElement] Trying to replace a locked element",i),l._hold();this._removeElement(l)}return l=new n(this,e,t,i,o),this._addElement(l),l._hold()},o.prototype.holdElement=function(e){var t=this.elementsById[e];if(void 0!==t)return t._hold()},o.prototype.useElement=function(e){var t=this.elementsById[e];if(void 0!==t)return t},o.prototype._removeElement=function(e){delete this.elementsById[e.id],this.memoryUsed-=e.memorySize,e.type!==a.permanent&&(e.reference.container===this.actives?e.reference=this.actives.removeByReference(e.reference):e.reference=this.archives.removeByReference(e.reference)),null!==this.onElementRemoved&&this.onElementRemoved(e.element),this.removeCount+=1}},function(e,t){function i(e,t,i,n){this.object=e,this.previous=t,this.next=i,this.container=n}function n(){this.first=null,this.last=null,this.length=0}e.exports=n,n.prototype.addFront=function(e){var t=new i(e,null,this.first,this);return null===this.first?(this.first=t,this.last=t):(this.first.previous=t,this.first=t),this.length+=1,t},n.prototype.add=n.prototype.addFront,n.prototype.addBack=function(e){var t=new i(e,this.last,null,this);return null===this.first?(this.first=t,this.last=t):(this.last.next=t,this.last=t),this.length+=1,t},n.prototype.popFront=function(){var e=this.first.object;return this.removeByReference(this.first),e},n.prototype.pop=n.prototype.popFront,n.prototype.popBack=function(){var e=this.last.object;return this.removeByReference(this.last),e},n.prototype.addBefore=function(e,t){var n=new i(t,e.previous,e,this);return null!==e.previous&&(e.previous.next=n),e.previous=n,this.first===e&&(this.first=n),this.length+=1,n},n.prototype.addAfter=function(e,t){var n=new i(t,e,e.next,this);return null!==e.next&&(e.next.previous=n),e.next=n,this.last===e&&(this.last=n),this.length+=1,n},n.prototype.moveToTheBeginning=function(e){return!(!e||e.container!==this)&&(null===e.previous||(e.previous.next=e.next,this.last===e?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=this.first,e.next.previous=e,this.first=e,!0))},n.prototype.moveToTheEnd=function(e){return!(!e||e.container!==this)&&(null===e.next||(e.next.previous=e.previous,this.first===e?this.first=e.next:e.previous.next=e.next,e.next=null,e.previous=this.last,e.previous.next=e,this.last=e,!0))},n.prototype.removeByReference=function(e){return e.container!==this?(console.warn("[DoublyList.removeByReference] Trying to remove a node that does not belong to the list"),e):(null===e.next?this.last=e.previous:e.next.previous=e.previous,null===e.previous?this.first=e.next:e.previous.next=e.next,e.container=null,this.length-=1,null)},n.prototype.remove=function(e){for(var t=this.first;null!==t;t=t.next)if(t.object===e)return this.removeByReference(t),!0;return!1},n.prototype.clear=function(){for(var e=this.first;null!==e;e=e.next)e.container=null;this.first=null,this.last=null,this.length=0},n.prototype.forEach=function(e,t){for(var i=this.first;i;i=i.next)e(i.object,t)},n.prototype.toArray=function(){for(var e=[],t=this.first;null!==t;t=t.next)e.push(t.object);return e}},function(e,t,i){var n=i(184),o=i(202);t.loadTexture=function(e,t,i,s,a){var r=i.holdTexture(e);return r?void t(r):void o.loadImage(e,function(o){var r;r=o===n.EMPTY_IMAGE?i.getEmptyTexture():i.createTexture(o,e,s,a),t(r)})},t.loadTextures=function(e,t,i,s,a,r){for(var l=[],c=[],u=e.length,d=0;d<u;d+=1){var h=e[d],p=s.holdTexture(h);p?t(p,d):(l.push(h),c.push(d))}return 0===l.length?i&&i():void o.loadImages(l,function(e,i){var o,u=l[i];o=e===n.EMPTY_IMAGE?s.getEmptyTexture():s.createTexture(e,u,a,r),t(o,c[i])},i)}},function(e,t){function i(e,t,i){this.vertexPos=[e.x,e.y,e.x+e.w,e.y+e.h],this.textureCoord=[e.sx/i.element.width,e.sy/i.element.height,(e.sx+e.sw)/i.element.width,(e.sy+e.sh)/i.element.height],this.id=e.id,this.tint=e.tint,this.texture=i,this.className=e.className,this.nbFrames=1,this.animationData=t}i.prototype.isGraphic=!0,e.exports=i},function(e,t){function i(e){this.id=e.id,this.matrices=e.matrices,this.colors=e.colors,this.frames=e.frames,this.maskStart=e.maskStart||!1,this.maskEnd=e.maskEnd||!1}function n(e,t){var n=e.children;this.children=[];for(var o=0,s=0;s<n.length;s+=1){var a=n[s];this.children.push(new i(a)),o<a.frames[1]&&(o=a.frames[1])}this.id=e.id,this.duration=e.duration,this.className=e.className,this.sounds=e.sounds,this.nbFrames=o+1,this.animationData=t}n.prototype.isAnim=!0,e.exports=n},function(e,t,i){function n(e,t,i){var n=e.frames;this.frames=[];for(var s=0;s<n.length;s+=1)this.frames.push(new o(n[s].position,t,i));this.id=e.id,this.className=e.className,this.sounds=e.sounds,this.duration=e.duration,this.nbFrames=this.frames.length,this.animationData=t}var o=i(431);n.prototype.isAnim=!0,e.exports=n},function(e,t,i){function n(e){this._id=e,c.call(this,e),this.externalSymbols={},this.mergedTemplates={},this.mergedSymbols={},this.matrices=[],this.colors=[],this.only4Directions=!1}function o(e,t,i,n){this.color=n,this.texture=e,this.vertexPos=t,this.textureCoord=i}function s(e){this.id=e}function a(e){this.id=e}function r(e){this.id=e}var l=i(429),c=i(435),u=i(191).inherits;u(n,c),e.exports=n,n.prototype._updateId=function(){this.id=this._id;for(var e=Object.keys(this.mergedTemplates),t=0;t<e.length;t+=1)this.id+="#"+this.mergedTemplates[e[t]].id;for(e=Object.keys(this.parentTemplates),t=0;t<e.length;t+=1)this.parentTemplates[e[t]]._updateId()},n.prototype.clear=function(){c.prototype.clear.call(this);for(var e=Object.keys(this.mergedTemplates),t=0;t<e.length;t+=1)this.mergedTemplates[e[t]].clear()},n.prototype.merge=function(e,t){var i=e.name,n={};this.mergedSymbols[i]=n,this.mergedTemplates[i]=e,e.parentTemplates[this.name]=this;var o=e.exposedSymbols;for(var s in o){var a=o[s],r=this.externalSymbols[a.className];r||(r=new l,this.externalSymbols[a.className]=r),n[a.className]=t?r.addBack(a):r.addFront(a)}return this._updateId(),i},n.prototype.unmerge=function(e){var t=e.name,i=this.mergedSymbols[t];if(i){for(var n in i){var o=this.externalSymbols[n];o.removeByReference(i[n]),0===o.length&&delete this.externalSymbols[n]}delete e.parentTemplates[this.name],delete this.mergedTemplates[t],delete this.mergedSymbols[t],e.clear(),this._updateId()}},n.prototype.generateTemplate=function(e,t){this.animationHandle=t;var i=t.element;this.texture=e,this.symbols=i.symbols,this.matrices=i.matrices,this.colors=i.colors;for(var n=Object.keys(this.symbols),o=0;o<n.length;o+=1){var s=this.symbols[n[o]];s.className&&(this.exposedSymbols[s.className]=s)}this.isEmpty=0===n.length},n.prototype.getSymbol=function(e){var t=this.exposedSymbols[e];return t?t:(t=this.externalSymbols[e],t?t.last.object:null)},s.prototype.isMaskTag=!0,s.prototype.isMaskDef=!0,a.prototype.isMaskTag=!0,a.prototype.isMaskUse=!0,r.prototype.isMaskTag=!0,r.prototype.isMaskStop=!0,n.prototype.createSprites=function(e,t,i,n,l,c,u){if(void 0===i)return[];var d,h,p,m,f,g,_,v,y,b,w,M,T,C=i.animationData,I=C.matrices[e.matrices[t]],A=C.colors[e.colors[t]],S=I[0],E=I[1],x=I[2],L=I[3],N=I[4]*l,O=I[5]*c,D=A[0],R=A[1],P=A[2],B=A[3],k=A[4],F=A[5],z=A[6],H=A[7];if(i.className){if(u[i.className]){var q=u[i.className];q.mirrored&&(S=-S,E=-E),f=q.prepareCurrentAnimationFrame();var W=[],U=f.length;for(p=0;p<U;p+=1)m=f[p],W.push(m),m.isMaskTag||(h=m.color,m.color=[h[0]*D,h[1]*R,h[2]*P,h[3]*B,h[4]*D+k,h[5]*R+F,h[6]*P+z,h[7]*B+H],d=m.vertexPos,g=d[0],_=d[1],v=d[2],y=d[3],b=d[4],w=d[5],M=d[6],T=d[7],m.vertexPos=[S*g+x*_+N,E*g+L*_+O,S*v+x*y+N,E*v+L*y+O,S*b+x*w+N,E*b+L*w+O,S*M+x*T+N,E*M+L*T+O]);return W}var Y=this.externalSymbols[i.className];Y&&Y.length>0&&(i=Y.last.object,C=i.animationData)}if(S*=l,E*=c,x*=l,L*=c,i.isGraphic){if(h=[D,R,P,B,k,F,z,H],void 0!==i.tint){var G=n[i.tint]||{r:1,g:1,b:1};h[0]*=G.r,h[1]*=G.g,h[2]*=G.b}var j=i.vertexPos;return g=j[0],_=j[1],v=j[2],y=j[3],d=[S*g+x*_+N,E*g+L*_+O,S*v+x*_+N,E*v+L*_+O,S*g+x*y+N,E*g+L*y+O,S*v+x*y+N,E*v+L*y+O],[new o(i.texture,d,i.textureCoord,h)]}if(i.isAnim){t%=i.nbFrames;for(var V,X,Q,K,J,Z,$,ee,te=[],ie=i.children,ne=ie.length-1;ne>=0;ne-=1){var oe=ie[ne];if(!(t<oe.frames[0]||t>oe.frames[1]))if(oe.maskEnd)te.push(new r(oe.id));else{for(oe.maskStart&&te.push(new s(oe.id)),f=this.createSprites(oe,t-oe.frames[0],C.symbols[oe.id],n,1,1,u),p=0;p<f.length;p+=1)m=f[p],te.push(m),m.isMaskTag||(d=m.vertexPos,V=d[0],X=d[1],Q=d[2],K=d[3],J=d[4],Z=d[5],$=d[6],ee=d[7],d[0]=S*V+x*X+N,d[1]=E*V+L*X+O,d[2]=S*Q+x*K+N,d[3]=E*Q+L*K+O,d[4]=S*J+x*Z+N,d[5]=E*J+L*Z+O,d[6]=S*$+x*ee+N,d[7]=E*$+L*ee+O,h=m.color,h[0]*=D,h[1]*=R,h[2]*=P,h[3]*=B,h[4]=h[4]*D+k,h[5]=h[5]*R+F,h[6]=h[6]*P+z,h[7]=h[7]*B+H);oe.maskStart&&te.push(new a(oe.id))}}return te}return[]},n.prototype.prepareAnimationFrame=function(e,t,i,n,l,c){var u=this.getSymbol(e);if(!u)return console.warn("Symbol "+e+" not registered in character's template"),[];var d=u.animationData;if(u.isGraphic){var h=u.vertexPos,p=[1,1,1,1,0,0,0,0],m=h[0]*n,f=h[1]*l,g=h[2]*n,_=h[3]*l,v=[m,f,g,f,m,_,g,_];return[new o(u.texture,v,u.textureCoord,p)]}for(var y=[],b=u.children,w=b.length-1;w>=0;w-=1){var M=b[w];if(M.frames[0]<=t&&t<=M.frames[1]){if(M.maskEnd){y.push(new r(M.id));continue}var T=this.createSprites(M,t-M.frames[0],d.symbols[M.id],i,n,l,c);M.maskStart?(y.push(new s(M.id)),Array.prototype.push.apply(y,T),y.push(new a(M.id))):Array.prototype.push.apply(y,T)}}return y}},function(e,t){function i(e){this.id=e,this.name="t"+n++,this.exposedSymbols={},this.texture=null,this.animationHandle=null,this.symbols={},this.parentTemplates={},this.isEmpty=!0}var n=0;e.exports=i,i.prototype.getFullId=function(){return this.id},i.prototype.clear=function(){this.texture&&this.texture.release(),this.animationHandle&&this.animationHandle.release()},i.prototype.merge=function(){},i.prototype.unmerge=function(){},i.prototype.generateTemplate=function(){},i.prototype.getSymbol=function(e){var t=this.exposedSymbols[e];return t?t:null},i.prototype.hasAnimation=function(e){return!!this.getSymbol(e)},i.prototype.getAnimationNbFrames=function(e){var t=this.getSymbol(e);return t?t.nbFrames:(console.warn("Symbol "+e+" not registered in character's template"),0)},i.prototype.getAnimationDuration=function(e){var t=this.getSymbol(e);return t?t.duration:(console.warn("Symbol "+e+" not registered in character's template"),0)},i.prototype.getAnimationFrameSound=function(e,t){var i=this.getSymbol(e);return i?i.sounds?i.sounds[t]:null:(console.warn("Symbol "+e+" not registered in character's template"),null)},i.prototype.getAnimationSounds=function(e){var t="string"==typeof e?e.split("/").shift():e,i={};for(var n in this.exposedSymbols){var o=this.exposedSymbols[n],s=o.sounds;if(s)for(var a in s)i[t+"/"+n+":"+a]=s[a]}return i}},function(e,t,i){function n(e){s.call(this,e)}function o(e,t,i,n){this.color=n,this.texture=e,this.vertexPos=t,this.textureCoord=i}var s=i(435),a=i(191).inherits;a(n,s),e.exports=n,n.prototype.merge=function(){console.error(new Error("[AtlasAnimationTemplate.merge]It is not possible to merge a template with an atlas template"))},n.prototype.unmerge=function(){console.error(new Error("[AtlasAnimationTemplate.merge]It is not impossible to merge a template with an atlas template and therefore to unmerge"))},n.prototype.generateTemplate=function(e,t){this.animationHandle=t,this.texture=e,this.symbols=t.element;for(var i=Object.keys(this.symbols),n=0;n<i.length;n+=1){var o=this.symbols[i[n]];o.className&&(this.exposedSymbols[o.className]=o)}this.isEmpty=0===i.length},n.prototype.prepareAnimationFrame=function(e,t,i,n,s){var a=this.getSymbol(e);if(!a)return console.warn("Symbol "+e+" not registered in character's template"),[];if(a.isAnim){var r=a.frames;t>=0&&t<=r.length&&(a=r[t])}var l=a.vertexPos,c=l[0]*n,u=l[1]*s,d=l[2]*n,h=l[3]*s,p=[1,1,1,1,0,0,0,0],m=[c,u,d,u,c,h,d,h],f=new o(a.texture,m,a.textureCoord,p);return[f]}},function(e,t,i){var n=i(184),o=i(202),s={};t.loadMissingTemplatesInfo=function(){o.loadJson(n.MISSING_ANIM_PATH,function(e){for(var t=0;t<e.length;t++)s[e[t]]=!0})},t.isMissingTemplates=function(e){return s[e]||!1}},function(e,t,i){function n(){this.id="",this.sounds=null}function o(e,t,i,o,s){d.call(this,e),this.animationId=null,this.animationName="",this.template=t,this.bonesId=o,this.audioVol=1,this.scaleX=i||1,this.scaleY=i||1,this.mirrored=!1,this._frame=-1,this._prevFrame=-1,this.nbFrames=0,this.frameData=new n,this.tints=[],this.tintsString="",this._setTints(s),this.loadedAnimations={};var a=t.exposedSymbols;this.only4Directions=a&&!(a.AnimStatique_0||a.AnimStatique_4),this.isFx=this.sprite.isFx,this.tween=new r(this,["frame"]),this.tween.from({frame:0}),this._cleared=!1}function s(e){for(var t=0,i=[],n=[1/0,-(1/0),1/0,-(1/0)],o=0;o<e.length;o+=1){var s=e[o];if(s.isMaskTag){if(s.isMaskDef&&(i.push(n),n=[1/0,-(1/0),1/0,-(1/0)]),s.isMaskUse&&(i.push(n),n=[1/0,-(1/0),1/0,-(1/0)]),s.isMaskStop){var a=n,r=i.pop();n=i.pop(),n[0]=Math.min(n[0],Math.max(a[0],r[0])),n[1]=Math.max(n[1],Math.min(a[1],r[1])),n[2]=Math.min(n[2],Math.max(a[2],r[2])),n[3]=Math.max(n[3],Math.min(a[3],r[3]))}}else{var l=s.vertexPos;n[0]=Math.min(n[0],l[0],l[2],l[4],l[6]),n[1]=Math.max(n[1],l[0],l[2],l[4],l[6]),n[2]=Math.min(n[2],l[1],l[3],l[5],l[7]),n[3]=Math.max(n[3],l[1],l[3],l[5],l[7]),t+=1}}return{bbox:n,nbSprites:t,spriteBatch:e}}var a=i(191).inherits,r=i(439).Tween,l=i(184),c=i(258),u=i(427),d=i(423),h=i(437),p=l.ANIM_SYMBOLS,m=l.ANIM_SYMETRY,f=l.MAP_SCENE_WIDTH/2,g=[4,3,2,3,4,7,6,7];a(o,d),e.exports=o,Object.defineProperty(o.prototype,"frame",{get:function(){return this._frame},set:function(e){e=e<this.nbFrames?Math.floor(e):this.nbFrames-1,this._frame!==e&&(this._frame=e,this.sprite.forceRefresh())}}),o.prototype.switchAnimationManager=function(){},o.prototype.isTemporary=!1,o.prototype._computeSymbolDirection=function(e){return e.direction===-1?-1:this.isFx&&0===e.direction?0:this.only4Directions&&0===(1&e.direction)?e.direction+1:e.direction},o.prototype._getSymbolId=function(e){e=this.applyAnimationModifier(e);var t=e.type||0===e.type?e.type:"",i=e.param||0===e.param?"_"+e.param:"",n=e.base+t+i,o=this._computeSymbolDirection(e);return o!==-1&&(n+="_"+p[o]),h.isMissingTemplates(this.bonesId+"/"+n)&&"AnimTacle"===e.base&&(e.base="AnimHit",n=e.base+t+i,o!==-1&&(n+="_"+p[o])),n},o.prototype._getSymbolModelId=function(e){return this.bonesId+"/"+this._getSymbolId(e)},o.prototype.addAnimation=function(e,t){function i(){if(n+=1,n===o)return t&&t()}var n=0,o=1;if(!this.hasSubentities)return this._addAnimation(this._getSymbolModelId(e),i);for(var s=this.subentities,a=!0,r=0;r<s.length;r++){var l=s[r],c=l.symbolModifier(e);if(c.parent){var u=c.parent;o+=1,a=a&&this._addAnimation(this._getSymbolModelId(u),i)}c.child&&(o+=1,a=a&&l.animManager.addAnimation(c.child,i))}return i(),a},o.prototype._addAnimation=function(e,t){if(!this.bonesId)return console.warn("Incorrect bones id:",this.bonesId),t(),!1;if(this.loadedAnimations[e])return t(),!0;var i=this;return u.loadTemplate("bone",e,"",function(n){i.template.merge(n,!1),i.loadedAnimations[e]=n,t()},this.sprite.renderer),!0},o.prototype.applyAnimationModifier=function(e){var t=this.animationModifiers[e.base];if(!t)return e;switch(typeof t){case"string":return{base:t,type:e.type,param:e.param,direction:e.direction};case"function":return t(e);default:return console.error("Wrong animation modifier type"),e}},o.prototype.cleanupAnimations=function(){var e=this.template;for(var t in this.loadedAnimations){var i=this.loadedAnimations[t];e.unmerge(i)}this.loadedAnimations={};for(var n=0;n<this.subentities.length;n++)this.subentities[n].animManager.cleanupAnimations()},o.prototype.cleanupAnimationsAndRemoveSubentities=function(){this.cleanupAnimations(),this.subentities=[],this.hasSubentities=!1},o.prototype.clear=function(e){return this._cleared?void console.warn("[AnimationManager.clear] Trying to clear an already cleared animation manager"):(e?this.tween.fastForwardToEnd():this.stop(),this.cleanupAnimationsAndRemoveSubentities(),this.template.clear(),this.sprite.renderer.unlockBuffer(this.frameData.id),this.frameData.id="",void(this._cleared=!0))},o.prototype._setTints=function(e){e||(e=[]);for(var t,i=[],n=this.tints.length!==e.length,o=0;o<e.length;o+=1){var s=e[o];if(t=s?{r:s.r/128,g:s.g/128,b:s.b/128}:{r:1,g:1,b:1},i[o]=t,!n){var a=this.tints[o];n=a.r!==t.r||a.g!==t.g||a.b!==t.b}}if(this.tints=i,n)for(this.tintsString="#",o=0;o<i.length;o+=1)t=i[o],this.tintsString+=Math.round(255*t.r).toString(16)+Math.round(255*t.g).toString(16)+Math.round(255*t.b).toString(16);return n},o.prototype.setTints=function(e){this._setTints(e)&&this.releaseBuffer()},o.prototype.prepareCurrentAnimationFrame=function(){return this.template.prepareAnimationFrame(this.animationName,this._frame,this.tints,this.scaleX,this.scaleY,this.subentityRefs)},o.prototype.getSymbolDuration=function(e){var t=this.template.exposedSymbols[e];return t?t.duration:0},o.prototype.releaseBuffer=function(){this.sprite.renderer.releaseBuffer(this.frameData.id),this.frameData.id="",this.sprite.forceRefresh()},o.prototype.generateCurrentFrameData=function(){if(null===this.animationId)return[1/0,-(1/0),1/0,-(1/0)];var e=this.sprite.renderer,t=this.frameData.id;this.frameData.id="",this.frameData.sounds=[],this._generateCurrentFrameIdAndSounds(this.frameData);var i=e.getBufferData(this.frameData.id);void 0===i&&(i=s(this.prepareCurrentAnimationFrame()),e.prepareBatchFromSpriteList(this.frameData.id,i)),this.frameData.id!==t&&(e.unlockBuffer(t),e.lockBuffer(this.frameData.id));for(var n=this.frameData.sounds,o=Math.max(-1,Math.min(1,this.sprite._x/f-1)),a=0;a<n.length;a++)c.playSoundGroup("sfx",n[a],this.audioVol,o);return i.bbox},o.prototype._generateCurrentFrameIdAndSounds=function(e){var t=this._frame;if(e.id+=this.animationId+t.toString(),this._prevFrame!==t){this._prevFrame=t;var i=this.template.getAnimationFrameSound(this.animationName,t);i&&e.sounds.push(this.bonesId+"/"+this.animationName+":"+t)}for(var n=0;n<this.subentities.length;n+=1)this.subentities[n].animManager._generateCurrentFrameIdAndSounds(e)},o.prototype.draw=function(e){e.drawSpriteBatch(this.frameData.id)},o.prototype._setMirroring=function(e,t){e!==-1&&m[e]^t?this.scaleX>0&&(this.mirrored=!0,this.scaleX*=-1):this.scaleX<0&&(this.mirrored=!1,this.scaleX*=-1)},o.prototype.assignSymbol=function(e,t,i){if(this.subentityRefs={},this.hasSubentities){for(var n=null,o={base:"AnimStatique",direction:e.direction},s=0;s<this.subentities.length;s++){var a=this.subentities[s],r=a.animManager,l=a.symbolModifier(e);n=l.parent||n,l.child?(r.assignSymbol(l.child,t,i),i=null):r.assignSymbol(o,!1),this.subentityRefs[a.bindingPoint]=r,r.mirrored=!1}e=n||o}(this.tween.playing||this.tween.starting)&&this.tween.stop();var c=this._getSymbolId(e),u=this._computeSymbolDirection(e);if(this.template.hasAnimation(c))this._setMirroring(u);else{e=this.applyAnimationModifier(e);var d=e.type||0===e.type?e.type:"",h=e.param||0===e.param?"_"+e.param:"";if(c=e.base+d+h+"_"+g[u],this.template.hasAnimation(c))this._setMirroring(u,!0);else{for(var p=!1,m=0;m<8;m++)if(c=e.base+d+h+"_"+m,this.template.hasAnimation(c)){this._setMirroring(m),p=!0;break}if(!p)return console.warn("Could not find any Animation "+e.base+" in template",this.template.id),i&&i()}}this.animationName=c;var f=this.template.id+"#"+c;if(this.animationId=f+"#"+this.scaleY+this.tintsString+(this.mirrored?"M#":"#"),this.nbFrames=this.template.getAnimationNbFrames(c),this._prevFrame=-1,this._frame=-1,this.frame=0,0===this.nbFrames)return i&&i();if("AnimStatique"===e.base&&this.nbFrames>1&&(t=!0),"AnimStatique_to_AnimMarche"!==e.base&&"AnimStatique_to_AnimCourse"!==e.base||(t=!1),this.tween.reset().to({frame:this.nbFrames},this.nbFrames).start(t),i){if(t)return i();this.tween.onceFinish(i)}},o.prototype.stop=function(){(this.tween.playing||this.tween.starting)&&this.tween.stop()}},function(e,t,i){"use strict";function n(){this._time=0,this._duration=0,this.playing=!1,this.stopping=!1,this.starting=!1,this._iterations=0,this._onStart=null,this._onStop=null,this._onFinish=null,this._onUpdate=null,this._onceFinish=null,this.reference=null}function o(e,t){n.call(this),this._duration=e,this.onFinish(t)}function s(e,t,i,n,o,s){this.start=i,this.end=i+n,this.duration=n,this.fromObject=e,this.toObject=t,this.easing=o,this.easingParam=s}function a(e,t){n.call(this),e||(console.error(new Error("Invalid tween element: "+e)),e={}),this._element=e,this._properties=t,this._transitions=[],this._currentTransitionIndex=0,this._duration=0,this._from=null}function r(e,t){if(this instanceof r==!1)return new r(e,t);n.call(this),e||(console.error(new Error("Invalid tween element: "+e)),e={}),this._element=e,this._properties=t,this._previousValues={};for(var i=0;i<this._properties.length;i+=1)this._previousValues[this._properties[i]]=0;this._transitions=[],this._currentTransitionIndex=0,this._duration=0,this._from=null}var l=i(191).inherits,c=i(184),u=i(440),d=i(429),h=window.performance?window.performance:Date,p={tups:c.TIME_UNITS_PER_SECOND,easing:u,_startingTime:h.now(),_previousTime:h.now(),_playables:new d,_addList:[],_removeList:[],_silent:!0,_debug:!1,restart:function(){this._startingTime=h.now(),this._previousTime=h.now()},getFramesSinceStart:function(){return Math.floor((h.now()-this._startingTime)*this.tups/1e3)},update:function(){var e=h.now(),t=(e-this._previousTime)*this.tups/1e3;for(this._previousTime=e;this._addList.length>0;){var i=this._addList.pop();i.reference=this._playables.add(i)}for(var n=this._playables.first;null!==n;n=n.next)n.object.update(t);for(;this._removeList.length>0;)this._playables.removeByReference(this._removeList.pop().reference)},start:function(e){e.start(this)},_add:function(e){var t=this._addList.indexOf(e);t===-1&&(t=this._removeList.indexOf(e),t!==-1?this._removeList.splice(t,1):this._addList.push(e))},_remove:function(e){var t=this._removeList.indexOf(e);t===-1&&(t=this._addList.indexOf(e),t!==-1?this._addList.splice(t,1):this._removeList.push(e))},stop:function(){for(var e=this._playables.first;null!==e;e=e.next)e.object._stopped();this._playables.clear()},silent:function(e){this._silent=e||!1},debug:function(e){this._debug=e||!1},_warn:function(e){this._silent===!1&&console.warn(e)}};e.exports=p,n.prototype.start=function(e){return e===!0?this._iterations=1/0:this._iterations=e||1,0===this._iterations?(p._warn("[Playable.start] playable is required to run 0 times"),this):this.starting?(p._warn("[Playable.start] playable is already starting"),this):this.playing&&!this.stopping?(p._warn("[Playable.start] playable is already playing"),this):(this.starting=!0,p._add(this),this)},n.prototype.stop=function(){return this.stopping?(p._warn("[Playable.stop] playable is already stopping"),this):this.playing||this.starting?(this.stopping=!0,this.starting=!1,this._finished(),this):(p._warn("[Playable.stop] playable is not playing"),this)},n.prototype.fastForwardToEnd=function(){this._time=this._duration},n.prototype._stopped=function(){this.stopping=!1,this.playing=!1,null!==this._onStop&&this._onStop()},n.prototype._started=function(){this.starting=!1,this.playing=!0,null!==this._onStart&&this._onStart()},n.prototype._finished=function(){if(this.playing=!1,p._remove(this),null!==this._onceFinish){var e=this._onceFinish.slice();this._onceFinish=null;for(var t=0;t<e.length;t+=1)e[t]()}null!==this._onFinish&&this._onFinish()},n.prototype._reset=function(){this._time=0},n.prototype.update=function(e){if(!this.stopping||(this._stopped(),this.starting))if(this.starting)this._time=0,this._update(),this._started();else{var t=this._time+e;t>=this._duration?1===this._iterations?(this._time=this._duration,this._update(),null!==this._onUpdate&&this._onUpdate(),this._finished()):(this._time=t%this._duration,this._update(),null!==this._onUpdate&&this._onUpdate(),this._iterations-=1):(this._time=t,this._update(),null!==this._onUpdate&&this._onUpdate())}},n.prototype.onUpdate=function(e){return this._onUpdate=e||null,this},n.prototype.onStart=function(e){return this._onStart=e||null,this},n.prototype.onStop=function(e){return this._onStop=e||null,this},n.prototype.onFinish=function(e){return this._onFinish=e||null,this},n.prototype.onceFinish=function(e){return null===this._onceFinish?this._onceFinish=[e]:this._onceFinish.push(e),this},n.prototype.removeOnFinish=function(){return this._onFinish=null,this._onceFinish=null,this},n.prototype.removeOnUpdate=function(){return this._onUpdate=null,this},n.prototype.removeOnStart=function(){return this._onStart=null,this},n.prototype.removeOnStop=function(){return this._onStop=null,this},n.prototype.getElapsedTime=function(){return this._time},n.prototype.getRemainingTime=function(){return this._duration-this._time},l(o,n),p.Delay=o,o.prototype.reset=function(e,t){this._duration=e,this.removeOnFinish(),this.onFinish(t)},o.prototype._update=function(){},l(a,n),p.Tween=a,a.prototype.reset=function(){return this._from=null,this._duration=0,this._currentTransitionIndex=0,this._transitions=[],this._reset(),this},a.prototype.from=function(e){return this._from=e,this._transitions.length>0&&(this._transitions[0].from=e),this},a.prototype._setFrom=function(){this._from={};for(var e=0;e<this._properties.length;e+=1){var t=this._properties[e];this._from[t]=this._element[t]}return this._from},a.prototype._getLastTransitionEnding=function(){return this._transitions.length>0?this._transitions[this._transitions.length-1].toObject:null===this._from?this._setFrom():this._from},a.prototype.to=function(e,t,i,n){void 0===i&&(i=u.linear);var o=this._getLastTransitionEnding();return this._transitions.push(new s(o,e,this._duration,t,i,n)),this._duration+=t,this},a.prototype.wait=function(e){if(0===e)return this;var t=this._getLastTransitionEnding();return this._transitions.push(new s(t,t,this._duration,e,u.linear,null)),this._duration+=e,this},a.prototype._update=function(){for(;this._time<this._transitions[this._currentTransitionIndex].start;)this._currentTransitionIndex--;for(;this._time>this._transitions[this._currentTransitionIndex].end;)this._currentTransitionIndex++;for(var e=this._transitions[this._currentTransitionIndex],t=e.easing((this._time-e.start)/e.duration,e.easingParam),i=e.fromObject,n=e.toObject,o=0;o<this._properties.length;o++){var s=this._properties[o];this._element[s]=i[s]*(1-t)+n[s]*t}},l(r,n),p.RelativeTween=r,r.prototype.reset=function(){this._from=null,this._duration=0,this._currentTransitionIndex=0,this._transitions=[],this._reset(),this._previousValues={};for(var e=0;e<this._properties.length;e+=1)this._previousValues[this._properties[e]]=0;return this},r.prototype.from=function(e){return this._from=e,this._transitions.length>0&&(this._transitions[0].from=e),this},r.prototype._setFrom=function(){this._from={};for(var e=0;e<this._properties.length;e+=1)this._from[this._properties[e]]=0;return this._from},r.prototype._getLastTransitionEnding=function(){return this._transitions.length>0?this._setFrom():null===this._from?this._setFrom():this._from},r.prototype.to=function(e,t,i,n){void 0===i&&(i=u.linear);var o=this._getLastTransitionEnding();return this._transitions.push(new s(o,e,this._duration,t,i,n)),
this._duration+=t,this},r.prototype.wait=function(e){if(0===e)return this;var t=this._getLastTransitionEnding();return this._transitions.push(new s(t,t,this._duration,e,u.linear,null)),this._duration+=e,this},r.prototype._update=function(){for(;this._time<this._transitions[this._currentTransitionIndex].start;)this._currentTransitionIndex--;for(;this._time>this._transitions[this._currentTransitionIndex].end;)this._currentTransitionIndex++;for(var e=this._transitions[this._currentTransitionIndex],t=e.easing((this._time-e.start)/e.duration,e.easingParam),i=e.fromObject,n=e.toObject,o=0;o<this._properties.length;o++){var s=this._properties[o],a=i[s]*(1-t)+n[s]*t;this._element[s]+=a-this._previousValues[s],this._previousValues[s]=a}}},function(e,t){var i=Math.PI,n=Math.PI/2,o=2*Math.PI,s=2.718281828;t.none=function(){return 1},t.linear=function(e){return e},t.flash=function(e,t){return e+e*t-e*e*t},t.parabolic=function(e){var t=2*e-1;return 1-t*t},t.trigo=function(e,t){return.5*(1-Math.cos(o*e*t))},t.elastic=function(e,t){if(1===e)return 1;t/=t+1;var i=(1+t)*Math.log(1-e)/Math.log(t);return Math.cos(i-n)*Math.pow(t,i)},t.quadIn=function(e){return e*e},t.quadOut=function(e){return 2*e-e*e},t.quadInOut=function(e){return e<.5?2*e*e:2*(2*e-e*e)-1},t.cubicIn=function(e){return e*e*e},t.cubicOut=function(e){return 3*e-3*e*e+e*e*e},t.cubicInOut=function(e){return e<.5?4*e*e*e:4*(3*e-3*e*e+e*e*e)-3},t.quarticIn=function(e){return e*e*e*e},t.quarticOut=function(e){var t=e*e;return 4*e-6*t+4*t*e-t*t},t.quarticInOut=function(e){if(e<.5)return 8*e*e*e*e;var t=e*e;return 8*(4*e-6*t+4*t*e-t*t)-7},t.polyIn=function(e,t){return Math.pow(e,t)},t.polyOut=function(e,t){return 1-Math.pow(1-e,t)},t.polyInOut=function(e,t){return e<.5?Math.pow(2*e,t)/2:(2-Math.pow(2*(1-e),t))/2},t.sineIn=function(e){return 1-Math.cos(n*e)},t.sineOut=function(e){return Math.sin(n*e)},t.sineInOut=function(e){return e<.5?(1-Math.cos(i*e))/2:(1+Math.sin(i*(e-.5)))/2},t.expIn=function(e,t){return(1-Math.pow(s,t*e))/(1-Math.pow(s,t))},t.expOut=function(e,t){return(1-Math.pow(s,-t*e))/(1-Math.pow(s,-t))},t.expInOut=function(e,t){return e<.5?(1-Math.pow(s,2*t*e))/(1-Math.pow(s,t))/2:.5+(1-Math.pow(s,t-2*t*e))/(1-Math.pow(s,-t))/2},t.circIn=function(e){return 1-Math.sqrt(1-Math.pow(e,2))},t.circOut=function(e){return Math.sqrt(1-Math.pow(1-e,2))},t.circInOut=function(e){return e<.5?(1-Math.sqrt(1-4*e*e))/2:(1+Math.sqrt(-3+8*e-4*e*e))/2},t.elasticIn=function(e,t){if(0===e)return 0;t/=t+1;var i=(1+t)*Math.log(e)/Math.log(t);return Math.cos(i)*Math.pow(t,i)},t.elasticOut=function(e,t){if(1===e)return 1;t/=t+1;var i=(1+t)*Math.log(1-e)/Math.log(t);return 1-Math.cos(i)*Math.pow(t,i)},t.elasticInOut=function(e,t){var i;return e<.5?0===e?0:(t/=t+1,i=(1+t)*Math.log(2*e)/Math.log(t),.5*Math.cos(i)*Math.pow(t,i)):1===e?1:(t/=t+1,i=(1+t)*Math.log(2-2*e)/Math.log(t),.5+.5*(1-Math.cos(i)*Math.pow(t,i)))},t.bounceIn=function(e,t){if(0===e)return 0;t/=t+1;var i=(1+t)*Math.log(e)/Math.log(t);return Math.abs(Math.cos(i)*Math.pow(t,i))},t.bounceOut=function(e,t){if(1===e)return 1;t/=t+1;var i=(1+t)*Math.log(1-e)/Math.log(t);return 1-Math.abs(Math.cos(i)*Math.pow(t,i))},t.bounceInOut=function(e,t){var i;return e<.5?0===e?0:(t/=t+1,i=(1+t)*Math.log(2*e)/Math.log(t),Math.abs(.5*Math.cos(i)*Math.pow(t,i))):1===e?1:(t/=t+1,i=(1+t)*Math.log(2-2*e)/Math.log(t),.5+.5*(1-Math.abs(Math.cos(i)*Math.pow(t,i))))},t.backIn=function(e,t){return e*e*((t+1)*e-t)},t.backOut=function(e,t){return e-=1,e*e*((t+1)*e+t)+1},t.backInOut=function(e,t){return e<.5?(e*=2,.5*(e*e*((t+1)*e-t))):(e=2*e-2,.5*(e*e*((t+1)*e+t))+1)}},function(e,t,i){function n(e){return{parent:e,child:null}}var o=i(442),s=i(443),a=[n,s,o,n,n,n,n];e.exports=a},function(e,t,i){function n(e){return 0===e.type?{parent:e,child:null}:{parent:null,child:e}}function o(e){var t=e;return e.type&&(t={id:e.base+"0_"+u[e.direction],type:0,base:e.base,direction:e.direction}),{parent:null,child:t}}function s(e){return d[e.type]?{parent:e,child:null}:h[e.type]?{parent:e,child:e}:{parent:null,child:e}}function a(e){var t={base:"AnimCueillirSol0",direction:e.direction};return{parent:null,child:t}}function r(e){var t={base:"AnimEmoteWeap_0",direction:e.direction};return{parent:null,child:t}}function l(e){var t=e.base,i=p[t];if(!i)return console.error("No modifier for symbol base "+t),{parent:null,child:null};if("function"==typeof i)return i(e);var n={parent:null,child:null};return i.parent&&(n.parent=e),i.child&&(n.child=e),n}var c=i(184),u=c.ANIM_SYMBOLS,d={Rest_0:!0,Sit_0:!0,Oups_0:!0,Shit_0:!0},h={Appl_0:!0,Bye_0:!0,Champ_0:!0,Cross_0:!0,Drink_0:!0,Eat_0:!0,Fear_0:!0,Hi_0:!0,Kiss_0:!0,Mad_0:!0,Pfc1_0:!0,Pfc2_0:!0,Pfc3_0:!0,Pipo_0:!0,Point_0:!0},p={AnimArme:n,AnimAttaque:o,AnimEmote:s,AnimLevelUpRiding:r,AnimCueillirSol1:a,AnimConsulter:{parent:null,child:!0},AnimCueillir0:{parent:null,child:!0},AnimCueillirSol0:{parent:null,child:!0},AnimDrop:{parent:null,child:!0},AnimFaucher:{parent:null,child:!0},AnimHache:{parent:null,child:!0},AnimPeche:{parent:null,child:!0},AnimPickup:{parent:null,child:!0},AnimPioche:{parent:null,child:!0},AnimPuiser:{parent:null,child:!0},AnimThrow:{parent:null,child:!0},carrying:{parent:null,child:!0},AnimCourse:{parent:!0,child:null},AnimMarche:{parent:!0,child:null},AnimTacle:{parent:!0,child:null},AnimStatique:{parent:!0,child:!0},AnimMort:{parent:!0,child:!0},AnimHit:{parent:!0,child:!0},AnimVanish:{parent:!0,child:!0}};e.exports=l},function(e,t){e.exports=function(e){var t=e.base;return{parent:e,child:"AnimMarche"===t||"AnimCourse"===t?e:null}}},function(e,t){e.exports={HOOK_POINT_CATEGORY_UNUSED:0,HOOK_POINT_CATEGORY_PET:1,HOOK_POINT_CATEGORY_MOUNT_DRIVER:2,HOOK_POINT_CATEGORY_LIFTED_ENTITY:3,HOOK_POINT_CATEGORY_BASE_BACKGROUND:4,HOOK_POINT_CATEGORY_MERCHANT_BAG:5,HOOK_POINT_CATEGORY_BASE_FOREGROUND:6}},function(e,t,i){i(446),i(451),i(452),i(453),i(454),i(455),i(456),e.exports=i(447)},function(e,t,i){var n=i(447);n.shadersData={vertexLine:{type:"vertex",script:"attribute vec2 aPosition;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec4 vColor;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvec4 colorMul = aColorMul * cm * 2.0;\tvec4 colorAdd = aColorAdd * cm + ca;\tvColor = colorMul + colorAdd;\tvColor.rgb *= colorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},fragmentLine:{type:"fragment",script:"varying mediump vec4 vColor;void main() {\tgl_FragColor = vColor;}"},vertexBox:{type:"vertex",script:"attribute vec2 aPosition;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying mediump vec4 vColor;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvec4 colorMul = aColorMul * cm * 2.0;\tvec4 colorAdd = aColorAdd * cm + ca;\tvColor = colorMul + colorAdd;\tvColor.rgb *= colorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},fragmentBox:{type:"fragment",script:"varying mediump vec4 vColor;void main() {\tgl_FragColor = vColor;}"},vertexRegular:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec2 vTexCoord;varying   vec4 vColorMul;varying   vec4 vColorAdd;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvTexCoord = aTexCoord;\tvColorMul = aColorMul * cm * 2.0;\tvColorAdd = aColorAdd * cm + ca;\tvColorMul.rgb *= vColorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},fragmentRegular:{type:"fragment",script:"varying mediump vec2 vTexCoord;varying mediump vec4 vColorMul;varying mediump vec4 vColorAdd;uniform sampler2D uTexture;void main() {\tmediump vec4 color = texture2D(uTexture, vTexCoord);\tmediump float colorAddAlpha = vColorAdd.a * color.a;\tcolor *= vColorMul;\tcolor.rgb /= color.a;\tcolor.rgb += vColorAdd.rgb;\tcolor.a += colorAddAlpha;\tcolor.rgb *= color.a;\tif (color.a <= 0.05) { discard; }\tgl_FragColor = color;}"},vertexRelativeScale:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec2 vTexCoord;varying   vec4 vColorMul;varying   vec4 vColorAdd;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvTexCoord = aTexCoord;\tvColorMul = aColorMul * cm * 2.0;\tvColorAdd = ca;\tvColorMul.rgb *= vColorMul.a;\tfloat x = aPosition.x + tx.w * (aColorAdd.r * 127.0 + aColorAdd.g);\tfloat y = aPosition.y + ty.w * (aColorAdd.b * 127.0 + aColorAdd.a);\tgl_Position = vec4(\t\tx * tx.x + y * tx.y + tx.z,\t\tx * ty.x + y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},vertexAbsoluteScale:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec2 vTexCoord;varying   vec4 vColorMul;varying   vec4 vColorAdd;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvTexCoord = aTexCoord;\tvColorMul = aColorMul * cm * 2.0;\tvColorAdd = ca;\tvColorMul.rgb *= vColorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z + tx.w * 127.0 * aColorAdd.r * aColorAdd.b,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z - ty.w * 127.0 * aColorAdd.g * aColorAdd.a,\t\t0.0, 1.0\t);}"},vertexMask:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;uniform   vec4 uBbox;varying   vec2 vPosition;varying   vec2 vTexCoord;varying   vec4 vColorMul;varying   vec4 vColorAdd;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvec4 cm = uMatrix[2];\tvec4 ca = uMatrix[3];\tvTexCoord = aTexCoord;\tvColorMul = aColorMul * cm * 2.0;\tvColorAdd = aColorAdd * cm + ca;\tvColorMul.rgb *= vColorMul.a;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);\tvPosition = (aPosition - vec2(uBbox.x, uBbox.z)) / vec2(uBbox.y - uBbox.x, uBbox.w - uBbox.z);}"},fragmentMask:{type:"fragment",script:"varying mediump vec2 vPosition;varying mediump vec2 vTexCoord;varying mediump vec4 vColorMul;varying mediump vec4 vColorAdd;uniform sampler2D uTexture;uniform sampler2D uMask;void main() {\tmediump vec4 color = texture2D(uTexture, vTexCoord);\tmediump float colorAddAlpha = vColorAdd.a * color.a;\tcolor *= vColorMul;\tcolor.rgb /= color.a;\tcolor.rgb += vColorAdd.rgb;\tcolor.a += colorAddAlpha;\tcolor.rgb *= color.a;\tif (color.a <= 0.05) { discard; }\tmediump float mask = texture2D(uMask, vPosition).a;\tif (mask == 0.0) { discard; }\tif (mask <= 0.2) {\t\tcolor *= mask * 5.0;\t}\tgl_FragColor = color;}"},vertexOutline:{type:"vertex",script:"attribute vec2 aPosition;attribute vec2 aTexCoord;attribute vec4 aColorMul;attribute vec4 aColorAdd;uniform   mat4 uMatrix;varying   vec2 vTexCoord;varying   vec4 vColorOutline;void main() {\tvec4 tx = uMatrix[0];\tvec4 ty = uMatrix[1];\tvColorOutline = uMatrix[2] * aColorMul + aColorAdd;\tvTexCoord = aTexCoord;\tgl_Position = vec4(\t\taPosition.x * tx.x + aPosition.y * tx.y + tx.z,\t\taPosition.x * ty.x + aPosition.y * ty.y + ty.z,\t\t0.0, 1.0\t);}"},fragmentOutline:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;varying mediump vec4 vColorOutline;uniform sampler2D uTexture;void main() {\tvec4 color = texture2D(uTexture, vTexCoord);\tif (color.a == 1.0) {\t\tdiscard;\t} else {\t\tfloat gradX = texture2D(uTexture, vTexCoord + vec2(0.05, 0.0)).a - texture2D(uTexture, vTexCoord - vec2(0.05, 0.0)).a;\t\tfloat gradY = texture2D(uTexture, vTexCoord + vec2(0.0, 0.05)).a - texture2D(uTexture, vTexCoord - vec2(0.0, 0.05)).a;\t\tvec4 outlineColor = 0.5 * vColorOutline * (abs(gradX) + abs(gradY));\t\tgl_FragColor = outlineColor * outlineColor.a;\t}}"},fragmentFiltering:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;uniform float uRatio;uniform sampler2D uTexture;void main() {\tvec2 res = vec2(1267.0, 865.5);\tvec4 color  = texture2D(uTexture, vTexCoord);\tvec4 color1 = texture2D(uTexture, vTexCoord + vec2(-0.7, -0.7) / res);\tvec4 color2 = texture2D(uTexture, vTexCoord + vec2(-0.7,  0.7) / res);\tvec4 color3 = texture2D(uTexture, vTexCoord + vec2( 0.7, -0.7) / res);\tvec4 color4 = texture2D(uTexture, vTexCoord + vec2( 0.7,  0.7) / res);\tgl_FragColor = color * (1.0 + 4.0 * uRatio) - uRatio * (color1 + color2 + color3 + color4);}"},fragmentMapTransition:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;varying mediump vec4 vColorMul;uniform float uRatio;uniform sampler2D uTexture;void main() {\tvec2 offsetToCenter = vTexCoord - 0.5;\tfloat distToCenter = length(offsetToCenter);\tfloat c1 = 2.0 * (0.5 - distToCenter * pow(uRatio, 2.0) * 0.02);\tvec2 textureCoord = vec2(0.5 + c1 * offsetToCenter.x, 0.5 + c1 * offsetToCenter.y);\tvec4 color = texture2D(uTexture, textureCoord);\tfloat avg = (color.r + color.g + color.b) / 3.0;\tfloat greyRatio = uRatio * 1.0;\tvec4 greyedColor = color * (1.0 - greyRatio) + vec4(avg) * greyRatio;\tfloat blackRatio = uRatio * 0.2;\tgl_FragColor = vec4((greyedColor * (1.0 - blackRatio)).rgb, 1.0) * vColorMul;}"},fragmentPixelArt:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;uniform float uResolution;uniform sampler2D uTexture;void main() {\tvec4 color = texture2D(uTexture, floor(vTexCoord * uResolution) / uResolution);\tcolor.rgb = floor(color.rgb * 8.0) / 8.0;\tgl_FragColor = color;}"},fragmentEnteringFight:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;uniform float uRatio;uniform sampler2D uTexture;void main() {\tfloat u = 2.0 * (vTexCoord.x - 0.5);\tfloat v = 2.0 * (vTexCoord.y - 0.5);\tfloat r = uRatio * (pow(1.0 - max(abs(u), abs(v)), 2.0));\tvec2 uv = vTexCoord + vec2(u, v) * r;\tvec4 color = texture2D(uTexture, uv) + 0.8 * vec4(1.0, 1.0, 1.0, 0.0) * r;\tgl_FragColor = color;}"},fragmentColorSplit:{type:"fragment",script:"precision mediump float;varying mediump vec2 vTexCoord;uniform sampler2D uTexture;void main() {\tvec4 color = vec4(0.0, 0.0, 0.0, 1.0);\tcolor.r = texture2D(uTexture, vTexCoord + vec2(-0.007, - 0.007)).r;\tcolor.g = texture2D(uTexture, vTexCoord + vec2(0.007, - 0.007)).g;\tcolor.b = texture2D(uTexture, vTexCoord + vec2(0.0, 0.01)).b;\tgl_FragColor = color;}"}}},function(e,t,i){function n(e,t,i,s,r,l,c){this.canvas=e;var u=this.gl=n.getWebGlContext(this.canvas,!1,c);u.blendFunc(u.ONE,u.ONE_MINUS_SRC_ALPHA),u.enable(u.BLEND),u.activeTexture(u.TEXTURE0),this.resetClearColor();var d=4,h=2,p=1,m=2,f=2,g=8;this._vertexSize=d*m+h*f+p*g,this._spriteSize=6*this._vertexSize,this._lineSize=2*this._vertexSize,this._boxSize=6*this._vertexSize,this._initPrograms(),this.initBuffer(s),this.sFMPartitioner=new a(this._spriteSize,s*this._spriteSize),this._initTextureCache(r),this._programs=[],this.useProgram(this._programRegular);var _=u.getParameter(u.FRAMEBUFFER_BINDING);this._renderTarget=this._createRenderTarget(null,_,1,1),this._renderTargetStack=[this._renderTarget],this._matrixStack=this._renderTarget.matrixStack,this._width=1,this._height=1,this.resetDimension(t||0,i||0),this._maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),this.prerenderRatio=l,this.maskQuality=.5,this._drawModes={lines:u.LINES,triangles:u.TRIANGLES},this.emptyTexture=this.createTexture(o.EMPTY_IMAGE,"empty_texture","linear","permanent")}var o=i(184),s=i(428),a=i(448),r=null;e.exports=n,n.prototype.resetClearColor=function(){this.gl.clearColor(0,0,0,0)},n.prototype.setClearColor=function(e,t,i,n){this.gl.clearColor(e,t,i,n)},n.prototype._initTextureCache=function(e){function t(e){i.deleteTexture(e.binder)}var i=this.gl;this.textureCache=new s(e,t)},n.prototype.resetDimension=function(e,t){var i=this._width,n=this._height;this._width=e,this._height=t,this.gl.viewport(0,0,e,t);var o=this._renderTargetStack[0];o.width=e,o.height=t;for(var s=i/this._width,a=n/this._height,r=o.matrixStack,l=0;l<r.length;l+=1){var c=r[l];c[0]*=s,c[1]*=s,c[2]=(c[2]+1)*s-1,c[4]*=a,c[5]*=a,c[6]=(c[6]-1)*a+1}},n.prototype.getNbBytesPerSprite=function(){return this._spriteSize},n.prototype.getNbBytesPerLine=function(){return this._lineSize},n.prototype.getNbBytesPerBox=function(){return this._boxSize},n.prototype.getNbBytesPerVertex=function(){return this._vertexSize},n.prototype.enableBlending=function(){var e=this.gl;e.enable(e.BLEND)},n.prototype.disableBlending=function(){var e=this.gl;e.disable(e.BLEND)},n.prototype.drawImage=function(e,t,i,n,o){if(e){var s=this._matrixStack[0],a=s[0],r=s[4],l=s[1],c=s[5],u=s[2],d=s[6];s[2]+=a*t+l*i,s[6]+=r*t+c*i,s[0]*=n,s[4]*=n,s[1]*=o,s[5]*=o,this.gl.uniformMatrix4fv(this._currentProgram.uniforms.uMatrix,!1,s);var h=this.textureCache.useElement(e.id).element.binder;this.gl.bindTexture(this.gl.TEXTURE_2D,h),this.gl.drawArrays(this.gl.TRIANGLES,0,6),s[0]=a,s[4]=r,s[1]=l,s[5]=c,s[2]=u,s[6]=d}},n.prototype.clear=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},n.isWebGlSupported=function(){if(null!==r)return r;var e=document.createElement("canvas");return r=!!n.getWebGlContext(e,!0)},n.getWebGlContext=function(e,t,i){var n=null;try{var o={alpha:i,depth:!1,stencil:!1,antialias:!1};n=e.getContext("webgl",o)||e.getContext("experimental-webgl",o)}catch(s){if(!t)throw new Error("Could not initialise WebGL ("+s.message+")");return null}if(!n){if(!t)throw new Error("Could not initialise WebGL, sorry :-(");return null}return n}},function(e,t,i){function n(e,t){this.start=e,this.nBytes=t,this.update=0,this.prevChunk=null,this.nextChunk=null,this.id=null,this.obj=null,this.ref=null,this.nLocks=0}function o(e,t){this.memoryChunksFree=new s(function(e,t){return e.nBytes-t.nBytes}),this.memoryChunksUsed=new a(function(e,t){return e.update-t.update}),this.memoryChunksLocked=new a(function(){return 1});var i=t-e,o=new n(e,i);o.ref=this.memoryChunksFree.add(o),this.firstByte=e,this.nBytes=i,this.update=0,this.chunksById={}}var s=i(449),a=i(450);n.prototype.set=function(e,t,i){this.start=e,this.nBytes=t,this.update=i},e.exports=o,o.prototype.touch=function(e){var t=this.chunksById[e];if(void 0!==t)return 0===t.nLocks&&(t.update=this.update++,this.memoryChunksUsed.moveToTheEnd(t.ref)),t.obj},o.prototype.getChunk=function(e){return this.chunksById[e]},o.prototype.addLock=function(e){var t=this.chunksById[e];if(void 0!==t)return 0===t.nLocks&&(this.memoryChunksUsed.removeByRef(t.ref)||console.warn("[SuperFastMemoryPartitioner.lock] Trying to lock an already locked chunk",e),t.ref=this.memoryChunksLocked.add(t),t.update=1/0),t.nLocks+=1,t.obj},o.prototype.removeLock=function(e){var t=this.chunksById[e];void 0!==t&&(t.nLocks-=1,0===t.nLocks&&(this.memoryChunksLocked.removeByRef(t.ref),t.ref=this.memoryChunksUsed.add(t),t.update=this.update++),t.nLocks<0&&console.warn("[SuperFastMemoryPartitioner.unlock] Trying to unlock a non-locked chunk",e))},o.prototype.possess=function(e){return!!this.chunksById[e]},o.prototype.release=function(e){var t=this.chunksById[e];if(void 0!==t){if(t.ref.container===this.memoryChunksLocked?this.memoryChunksLocked.removeByRef(t.ref):this.memoryChunksUsed.removeByRef(t.ref),t.prevChunk&&t.prevChunk.ref.container===this.memoryChunksFree){var i=t.prevChunk;t.start=i.start,t.nBytes+=i.nBytes,t.prevChunk=i.prevChunk,i.prevChunk&&(i.prevChunk.nextChunk=t),this.memoryChunksFree.removeByReference(i.ref)}if(t.nextChunk&&t.nextChunk.ref.container===this.memoryChunksFree){var n=t.nextChunk;t.nBytes+=n.nBytes,t.nextChunk=n.nextChunk,n.nextChunk&&(n.nextChunk.prevChunk=t),this.memoryChunksFree.removeByReference(n.ref)}t.ref=this.memoryChunksFree.add(t),t.nLocks=0,t.update=0,delete this.chunksById[e]}},o.prototype.bindObject=function(e,t){var i=this.chunksById[e];return void 0!==i&&(i.obj=t,!0)},o.prototype._selectChunks=function(e){var t=this.memoryChunksFree.getSmallestAbove({nBytes:e});if(t)return[t];if(0===this.memoryChunksUsed.count)throw new Error("No available chunk can hold "+e+" Bytes.Make sure that enough space is allocated (currently "+this.nBytes+") or that locked chunks are correctly unlocked.");var i=this.memoryChunksUsed.first;if(i.object.nBytes>=e)return[i.object];for(var n,o=0,s=7,a=1/0;(o<s||a===1/0)&&null!==i;){for(var r=i.object,l=[r],c=r.nBytes,u=r.prevChunk,d=r.nextChunk,h=r.update;c<e;)null===u||null!==d&&d.update<=u.update?(h<d.update&&(h=d.update),l.push(d),c+=d.nBytes,d=d.nextChunk):(h<u.update&&(h=u.update),l.unshift(u),c+=u.nBytes,u=u.prevChunk);h<a&&(a=h,n=l),i=i.next,o+=1}if(a===1/0)throw new Error("No available chunk can hold "+e+" Bytes.Make sure that enough space is allocated (currently "+this.nBytes+") or that locked chunks are correctly unlocked.");return n},o.prototype.reserve=function(e,t){for(var i=this._selectChunks(t),o=0;o<i.length;o+=1){var s=i[o];s.ref.container===this.memoryChunksUsed?(this.memoryChunksUsed.removeByRef(s.ref),delete this.chunksById[s.id]):this.memoryChunksFree.removeByReference(s.ref)}var a=i[0],r=i[i.length-1],l=a.start,c=r.start+r.nBytes;a.set(l,t,this.update),a.ref=this.memoryChunksUsed.add(a),a.id=e,this.chunksById[e]=a;var u=c-l;if(u===t)a.nextChunk=r.nextChunk,null!==a.nextChunk&&(a.nextChunk.prevChunk=a);else{var d;if(a===r?(d=new n(l+t,u-t),d.nextChunk=r.nextChunk,null!==d.nextChunk&&(d.nextChunk.prevChunk=d)):(d=r,d.set(l+t,u-t,0)),d.prevChunk=a,a.nextChunk=d,d.nextChunk&&d.nextChunk.ref.container===this.memoryChunksFree){var h=d.nextChunk;d.nBytes+=h.nBytes,d.nextChunk=h.nextChunk,h.nextChunk&&(h.nextChunk.prevChunk=d),this.memoryChunksFree.removeByReference(h.ref)}d.ref=this.memoryChunksFree.add(d)}return this.update+=1,a},o.prototype.debug=function(){console.log("***** SFMP *****"),console.log(" FREE CHUNKS"),this.memoryChunksFree.forEach(function(e){console.log(e)}),console.log(" USED CHUNKS"),this.memoryChunksUsed.forEach(function(e){console.log(e)}),console.log(" LOCKED CHUNKS"),this.memoryChunksLocked.forEach(function(e){console.log(e)})}},function(e,t){function i(e,t){this.object=e,this.height=1,this.left=null,this.right=null,this.parent=null,this.container=t}function n(e){this.length=0,this.root=null,this.cmpFunc=e}n.prototype._addLeft=function(e,t){e.parent=t,t.left=e},n.prototype._addRight=function(e,t){e.parent=t,t.right=e},n.prototype.popSmallest=function(){for(var e=this.root;null!==e.left;)e=e.left;return this.removeByReference(e),e.object},n.prototype.popGreatest=function(){for(var e=this.root;null!==e.right;)e=e.right;return this.removeByReference(e),e.object},n.prototype.add=function(e){this.length+=1;var t=new i(e,this);if(null===this.root)return this.root=t,t;for(var n=this.root;;){var o=this.cmpFunc(e,n.object);if(o<0){if(null===n.left){this._addLeft(t,n);break}n=n.left}else if(o>0){if(null===n.right){this._addRight(t,n);break}n=n.right}else{if(null===n.left){this._addLeft(t,n);break}if(null===n.right){this._addRight(t,n);break}n=n.right.height<n.left.height?n.right:n.left}}return 1===n.height&&this._balance(t.parent,!1),t},n.prototype._balanceLeftRight=function(e){var t=e.left,i=t.right,n=t.left,o=i.left;i.left=t,e.left=i,i.parent=e,t.parent=i,t.left=n,t.right=o;var s=0;null!==n&&(s=n.height,n.parent=t);var a=0;null!==o&&(a=o.height,o.parent=t);var r=(s>a?s:a)+1;t.height=r;var l=null===i.right?0:i.right.height;i.height=(r>l?r:l)+1},n.prototype._balanceLeftLeft=function(e){var t=e.left,i=t.right,n=e.parent;e===this.root?this.root=t:n.right===e?n.right=t:n.left=t,t.right=e,t.parent=n,e.parent=t,e.left=i;var o;null===i?o=0:(i.parent=e,o=i.height);var s=null===e.right?0:e.right.height;e.height=(o>s?o:s)+1},n.prototype._balanceRightLeft=function(e){var t=e.right,i=t.left,n=t.right,o=i.right;i.right=t,e.right=i,i.parent=e,t.parent=i,t.right=n,t.left=o;var s=0;null!==n&&(s=n.height,n.parent=t);var a=0;null!==o&&(a=o.height,o.parent=t);var r=(s>a?s:a)+1;t.height=r;var l=null===i.left?0:i.left.height;i.height=(l>r?l:r)+1},n.prototype._balanceRightRight=function(e){var t=e.right,i=t.left;e===this.root?this.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,t.parent=e.parent,e.parent=t,e.right=i;var n;null===i?n=0:(i.parent=e,n=i.height);var o=null===e.left?0:e.left.height;e.height=(o>n?o:n)+1},n.prototype._balance=function(e,t){for(var i=e;null!==i;){var n=i.left,o=i.right,s=null===n?0:n.height,a=null===o?0:o.height;if(s-a>1)null!==n.right&&(null===n.left||n.left.height<n.right.height)&&this._balanceLeftRight(i),this._balanceLeftLeft(i);else if(a-s>1)null!==o.left&&(null===o.right||o.right.height<o.left.height)&&this._balanceRightLeft(i),this._balanceRightRight(i);else{var r=(s>a?s:a)+1;if(!t&&r===i.height)break;i.height=r}i=i.parent}},n.prototype.removeByReference=function(e){if(e.container!==this)return e;this.length-=1;var t=e.parent,i=e.left,n=e.right;if(null===e.right)return null!==i&&(i.parent=t),null===t?this.root=i:(t.right===e?t.right=i:t.left=i,null===i?this._balance(t,!0):i.height+3<=t.height&&this._balance(t,!0)),!0;var o=e.right;if(null===o.left)return null!==i&&(i.parent=o),o.left=i,null===t?this.root=o:t.right===e?t.right=o:t.left=o,o.parent=t,this._balance(o,!0),!0;for(o=o.left;null!==o.left;)o=o.left;null!==o.right&&(o.right.parent=o.parent),o.parent.left=o.right,null!==n&&(n.parent=o),o.right=n,null!==i&&(i.parent=o),o.left=i,null===t?this.root=o:t.right===e?t.right=o:t.left=o;var s=o.parent;return o.parent=t,this._balance(s,!0),e.left=null,e.right=null,e.parent=null,e.container=null,null},n.prototype.getSmallestAbove=function(e){if(null===this.root)return null;for(var t=null,i=this.root;null!==i;){var n=this.cmpFunc(e,i.object);if(n<0)t=i.object,i=i.left;else{if(!(n>0))return i.object;i=i.right}}return t},n.prototype.getGreatestBelow=function(e){if(null===this.root)return null;for(var t=null,i=this.root;null!==i;){var n=this.cmpFunc(e,i.object);if(n<0)i=i.left;else{if(!(n>0))return i.object;t=i.object,i=i.right}}return t},n.prototype._forEach=function(e,t,i){null!==e&&(this._forEach(e.left,t,i),t(e.object,i),this._forEach(e.right,t,i))},n.prototype.forEach=function(e,t){this._forEach(this.root,e,t)},n.prototype._forEachReverse=function(e,t,i){null!==e&&(this._forEachReverse(e.right,t,i),t(e.object,i),this._forEachReverse(e.left,t,i))},n.prototype.forEachReverse=function(e,t){this._forEachReverse(this.root,e,t)},n.prototype.clear=function(){this._clearEachNode(this.root),this.length=0,this.root=null},n.prototype._clearEachNode=function(e){null!==e&&(this._clearEachNode(e.left),this._clearEachNode(e.right),e.left=null,e.right=null,e.parent=null,e.container=null)},n.prototype._toArray=function(e,t){null!==e&&(this._toArray(e.left,t),t.push(e.object),this._toArray(e.right,t))},n.prototype.toArray=function(){var e=[];return this._toArray(this.root,e),e},e.exports=n},function(e,t){function i(e){this.count=0,this.first=null,this.last=null,this.cmpFunc=e}function n(e,t,i,n){this.object=e,this.previous=t,this.next=i,this.container=n}i.prototype.add=function(e){var t=new n(e,null,null,this);if(this.count+=1,null===this.first)return this.first=t,this.last=t,t;var i=this.cmpFunc(e,this.first.object);if(i<0)return t.next=this.first,this.first.previous=t,this.first=t,t;var o=this.cmpFunc(e,this.last.object);if(o>=0)return t.previous=this.last,this.last.next=t,this.last=t,t;var s;if(i+o<0){for(s=this.first.next;this.cmpFunc(e,s.object)>=0;)s=s.next;t.next=s,t.previous=s.previous,t.previous.next=t,s.previous=t}else{for(s=this.last.previous;this.cmpFunc(e,s.object)<0;)s=s.previous;t.previous=s,t.next=s.next,t.next.previous=t,s.next=t}return t},i.prototype.removeByRef=function(e){return!(!e||e.container!==this)&&(this.count-=1,null===e.previous?this.first=e.next:e.previous.next=e.next,null===e.next?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=null,e.container=null,!0)},i.prototype.moveToTheBeginning=function(e){return!(!e||e.container!==this)&&(null===e.previous||(e.previous.next=e.next,this.last===e?this.last=e.previous:e.next.previous=e.previous,e.previous=null,e.next=this.first,e.next.previous=e,this.first=e,!0))},i.prototype.moveToTheEnd=function(e){return!(!e||e.container!==this)&&(null===e.next||(e.next.previous=e.previous,this.first===e?this.first=e.next:e.previous.next=e.next,e.next=null,e.previous=this.last,e.previous.next=e,this.last=e,!0))},i.prototype.possess=function(e){return e&&e.container===this},i.prototype.popFirst=function(){var e=this.first;if(!e)return null;this.count-=1;var t=e.object;return this.first=e.next,null!==this.first&&(this.first.previous=null),e.next=null,e.container=null,t},i.prototype.popLast=function(){var e=this.last;if(!e)return null;this.count-=1;var t=e.object;return this.last=e.previous,null!==this.last&&(this.last.next=null),e.previous=null,e.container=null,t},i.prototype.getFirst=function(){return this.first&&this.first.object},i.prototype.getLast=function(){return this.last&&this.last.object},i.prototype.clear=function(){for(var e=this.first;e;e=e.next)e.container=null;this.count=0,this.first=null,this.last=null},i.prototype.getCount=function(){return this.count},i.prototype.toArray=function(){for(var e=[],t=this.first;t;t=t.next)e.push(t.object);return e},i.prototype.forEach=function(e,t){for(var i=this.first;i;i=i.next)e(i.object,t)},i.prototype.forEachReverse=function(e,t){for(var i=this.last;i;i=i.previous)e(i.object,t)},i.prototype.reposition=function(e){if(e.container!==this)return this.add(e.object);var t=e.previous,i=e.next,n=e.object;for(null===i?this.last=t:i.previous=t,null===t?this.first=i:t.next=i;null!==t&&this.cmpFunc(n,t.object)<0;)i=t,t=t.previous;for(;null!==i&&this.cmpFunc(n,i.object)>=0;)t=i,i=i.next;return e.next=i,null===i?this.last=e:i.previous=e,e.previous=t,null===t?this.first=e:t.next=e,e},e.exports=i},function(e,t,i){function n(e,t){this.program=e,this.data=t||null}function o(e,t,i,n,o){this.binder=null,this.vertexShaderId=t,this.fragmentShaderId=i,this.uniformIds=n,this.attributeIds=o,this.uniforms={},this.attributes={},this.lastAttributeIndex=o.length-1,this.vertexSize=e._vertexSize,this.gl=e.gl}function s(e,t,i,n,s){o.call(this,e,t,i,n,s)}var a=i(447),r={uTexture:0,uMask:1};o.prototype.setAttributes=function(){var e=4,t=2,i=1;this.gl.vertexAttribPointer(this.attributes.aPosition,2,this.gl.FLOAT,!1,this.vertexSize,0),this.gl.vertexAttribPointer(this.attributes.aColorMul,4,this.gl.BYTE,!0,this.vertexSize,2*e+2*t),this.gl.vertexAttribPointer(this.attributes.aColorAdd,4,this.gl.BYTE,!0,this.vertexSize,2*e+2*t+4*i)},s.prototype.setAttributes=function(){var e=4,t=2,i=1;this.gl.vertexAttribPointer(this.attributes.aPosition,2,this.gl.FLOAT,!1,this.vertexSize,0),this.gl.vertexAttribPointer(this.attributes.aTexCoord,2,this.gl.UNSIGNED_SHORT,!0,this.vertexSize,2*e),this.gl.vertexAttribPointer(this.attributes.aColorMul,4,this.gl.BYTE,!0,this.vertexSize,2*e+2*t),this.gl.vertexAttribPointer(this.attributes.aColorAdd,4,this.gl.BYTE,!0,this.vertexSize,2*e+2*t+4*i)},a.prototype._initPrograms=function(){this._shaders={};var e=["uMatrix"],t=["uMatrix"],i=["uMatrix","uTexture"],n=["uMatrix","uTexture","uRatio"],a=["uMatrix","uTexture","uMask","uBbox"],r=["aPosition","aColorMul","aColorAdd"];this._programLine=new o(this,"vertexLine","fragmentLine",e,r),this._programBox=new o(this,"vertexBox","fragmentBox",t,r);var l=["aPosition","aTexCoord","aColorMul","aColorAdd"];this._programMask=new s(this,"vertexMask","fragmentMask",a,l),this._programAbsoluteScale=new s(this,"vertexAbsoluteScale","fragmentRegular",i,l),this._programPixelArt=new s(this,"vertexRegular","fragmentPixelArt",n,l),this._programFiltering=new s(this,"vertexRegular","fragmentFiltering",n,l),this._programMapTransition=new s(this,"vertexRegular","fragmentMapTransition",n,l),this._programRegular=new s(this,"vertexRegular","fragmentRegular",i,l),
this._currentProgram={lastAttributeIndex:-1}},a.prototype._getShader=function(e){if(this._shaders[e])return this._shaders[e];var t,i=this.gl,n=a.shadersData[e];if("fragment"===n.type)t=i.createShader(i.FRAGMENT_SHADER);else{if("vertex"!==n.type)return null;t=i.createShader(i.VERTEX_SHADER)}if(i.shaderSource(t,n.script),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS))throw new Error(i.getShaderInfoLog(t));return this._shaders[e]=t,t},a.prototype._buildProgram=function(e){var t=this.gl,i=t.createProgram();if(t.attachShader(i,this._getShader(e.vertexShaderId)),t.attachShader(i,this._getShader(e.fragmentShaderId)),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){var n=t.getProgramInfoLog(i);throw t.deleteProgram(i),new Error("Error linking the program:"+n)}t.useProgram(i);for(var o=e.attributeIds,s=e.attributes,a=0;a<o.length;a+=1){var l=o[a];s[l]=t.getAttribLocation(i,l)}for(var c=e.uniformIds,u=e.uniforms,d=0;d<c.length;d+=1){var h=c[d],p=t.getUniformLocation(i,h);r[h]&&t.uniform1i(p,r[h]),u[h]=p}e.binder=i},a.prototype._useProgram=function(e){var t=e.program;if(t!==this._currentProgram){var i,n=this._currentProgram.lastAttributeIndex,o=t.lastAttributeIndex;if(n>o)for(i=n;i>o;i-=1)this.gl.disableVertexAttribArray(i);else if(n<o)for(i=n+1;i<=o;i+=1)this.gl.enableVertexAttribArray(i);var s=t.binder;null===s?this._buildProgram(t):this.gl.useProgram(t.binder),t.setAttributes(),this._currentProgram=t}var a=e.data;if(null!==a){var r=this.gl;void 0!==a.mask&&(r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,a.mask),r.activeTexture(r.TEXTURE0)),void 0!==a.ratio&&r.uniform1f(this._currentProgram.uniforms.uRatio,a.ratio),void 0!==a.resolution&&r.uniform1f(this._currentProgram.uniforms.uResolution,a.resolution)}},a.prototype.useProgram=function(e,t){var i=new n(e,t);this._programs.push(i),this._useProgram(i)},a.prototype.stopProgram=function(){this._programs.pop(),this._useProgram(this._programs[this._programs.length-1])}},function(e,t,i){function n(e,t,i,n){this.textureBinder=e,this.frameBufferBinder=t,this.width=i,this.height=n,this.matrixStack=[[2,0,-1,0,0,-2,1,0,1,1,1,1,0,0,0,0]],this.scissor=null,this.texture=null}var o=i(447);o.prototype._createRenderTarget=function(e,t,i,o){return new n(e,t,i,o)},o.prototype._setScissor=function(e){var t=this.gl;null===e?t.disable(t.SCISSOR_TEST):(t.enable(t.SCISSOR_TEST),t.scissor(e[0],e[1],e[2],e[3]))},o.prototype.enableScissor=function(e,t,i,n){var o=[e,t,i,n];this._renderTarget.scissor=o,this._setScissor(o)},o.prototype.disableScissor=function(){var e=null;this._renderTarget.scissor=e,this._setScissor(e)},o.prototype.startTextureUsage=function(e,t,i,o,s){var a=this.gl;i=i||this.prerenderRatio,e*i>this._maxTextureSize&&(i=this._maxTextureSize/e),t*i>this._maxTextureSize&&(i=this._maxTextureSize/t),e=Math.ceil(e*i),t=Math.ceil(t*i);var r=a.createTexture(),l=a.createFramebuffer(),c=new n(r,l,e,t);a.bindTexture(a.TEXTURE_2D,r),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,e,t,0,a.RGBA,a.UNSIGNED_BYTE,null),this._setFiltering(c,s),a.bindFramebuffer(a.FRAMEBUFFER,l),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,r,0),a.bindFramebuffer(a.FRAMEBUFFER,this._renderTarget.frameBufferBinder);var u={binder:r,width:e,height:t};return c.texture=this.textureCache.addAndHoldElement(u,4*e*t,o),c},o.prototype._setRenderTarget=function(e,t){var i=this.gl;this._renderTarget=e,i.bindFramebuffer(i.FRAMEBUFFER,e.frameBufferBinder),i.viewport(0,0,e.width,e.height),this._setScissor(e.scissor),t&&i.clear(i.COLOR_BUFFER_BIT),this._matrixStack=e.matrixStack},o.prototype.startTextureRendering=function(e,t,i,n,o,s){this._renderTargetStack.push(e),this._setRenderTarget(e,s);var a=2/Math.max(i-t,1),r=2/Math.max(o-n,1),l=this._matrixStack[0];l[0]=a,l[4]=0,l[1]=0,l[5]=r,l[2]=-t*a-1,l[6]=-n*r-1,l[8]=1,l[9]=1,l[10]=1,l[11]=1,l[12]=0,l[13]=0,l[14]=0,l[15]=0},o.prototype.stopTextureRendering=function(e){var t=this._renderTargetStack.pop();this._setRenderTarget(this._renderTargetStack[this._renderTargetStack.length-1]),e&&this.gl.deleteFramebuffer(t.frameBufferBinder)},o.prototype._debugRenderTarget=function(){var e=this._renderTargetStack[this._renderTargetStack.length-1],t=e.width,i=e.height,n=this.gl,o=new window.Uint8Array(t*i*4);n.readPixels(0,0,t,i,n.RGBA,n.UNSIGNED_BYTE,o);var s=o.length,a=document.createElement("canvas"),r=a.getContext("2d");a.width=t,a.height=i,document.body.appendChild(a),a.style.position="absolute",a.style.left="100px",a.style.top="100px";for(var l=r.getImageData(0,0,t,i),c=l.data,u=3;u<s;u+=4)c[u-3]=o[u-3],c[u-2]=o[u-2],c[u-1]=o[u-1],c[u]=o[u];r.putImageData(l,0,0),r.fillRect(t/2-5,i/2-5,10,10)}},function(e,t,i){var n=i(447);n.prototype.initBuffer=function(e){var t=this.gl,i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);var n=new window.ArrayBuffer(e*this._spriteSize),o=new window.Float32Array(n),s=new window.Uint32Array(n);o[0]=0,o[1]=0,s[2]=0,o[5]=0,o[6]=1,s[7]=4294901760,o[10]=1,o[11]=1,s[12]=4294967295,o[15]=0,o[16]=0,s[17]=0,o[20]=1,o[21]=1,s[22]=4294967295,o[25]=1,o[26]=0,s[27]=65535,s[3]=s[8]=s[13]=s[18]=s[23]=s[28]=1077952576,s[4]=s[9]=s[14]=s[19]=s[24]=s[29]=0,t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)},n.prototype.updateGPUBuffer=function(e,t){var i=this.gl;i.bufferSubData(i.ARRAY_BUFFER,e,t)},n.prototype.isInBuffer=function(e){return this.sFMPartitioner.possess(e)},n.prototype.getBufferData=function(e){return this.sFMPartitioner.touch(e)},n.prototype.lockBuffer=function(e){return this.sFMPartitioner.addLock(e)},n.prototype.releaseBuffer=function(e){return this.sFMPartitioner.release(e)},n.prototype.unlockBuffer=function(e){this.sFMPartitioner.removeLock(e)}},function(e,t,i){function n(e){return 0===(e&e-1)}var o=i(447);o.prototype._setFiltering=function(e,t,i){var o=this.gl,s=o.LINEAR,a=o.LINEAR;switch(t){case"nearest":a=o.NEAREST;break;case"mipmap":n(e.width)&&n(e.height)?(s=o.LINEAR_MIPMAP_LINEAR,o.generateMipmap(o.TEXTURE_2D)):console.warn("[WebGLRenderer._setFiltering]","Cannot build mipmap from image",i," because its dimensions are not a power of 2.")}o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,s),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,a),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE)},o.prototype.holdTexture=function(e){return this.textureCache.holdElement(e)},o.prototype.useTexture=function(e){return this.textureCache.useElement(e)},o.prototype.createTexture=function(e,t,i,n){var o=this.textureCache.holdElement(t);if(o)return o;var s=this.gl,a=s.createTexture();s.bindTexture(s.TEXTURE_2D,a),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,e),this._setFiltering(e,i,t);var r={binder:a,width:e.width,height:e.height};return this.textureCache.addAndHoldElement(r,4*e.width*e.height,t,n)},o.prototype.getEmptyTexture=function(){return this.emptyTexture}},function(e,t,i){var n=i(447);n.prototype.save=function(){this._matrixStack.unshift(this._matrixStack[0].slice())},n.prototype.restore=function(){this._matrixStack.shift()},n.prototype.setTransform=function(e,t,i,n,o,s,a,r){var l=this._matrixStack[0];a=2/(a||this._width),r=-2/(r||this._height),l[0]=e*a,l[4]=t*r,l[1]=i*a,l[5]=n*r,l[2]=o*a-1,l[6]=s*r+1},n.prototype.rotate=function(e){if(0!==e){var t=this._matrixStack[0],i=Math.cos(e),n=Math.sin(e),o=t[0],s=t[4],a=t[1],r=t[5];t[0]=o*i+a*n,t[4]=s*i+r*n,t[1]=a*i-o*n,t[5]=r*i-s*n}},n.prototype.translate=function(e,t){var i=this._matrixStack[0];i[2]+=i[0]*e+i[1]*t,i[6]+=i[4]*e+i[5]*t},n.prototype.scale=function(e,t){var i=this._matrixStack[0];i[0]*=e,i[4]*=e,i[1]*=t,i[5]*=t},n.prototype.transform=function(e,t,i,n,o,s){var a=this._matrixStack[0],r=a[0],l=a[4],c=a[1],u=a[5],d=a[2],h=a[6];a[0]=r*e+c*t,a[4]=l*e+u*t,a[1]=r*i+c*n,a[5]=l*i+u*n,a[2]=r*o+c*s+d,a[6]=l*o+u*s+h},n.prototype.getTransform=function(){var e=this._matrixStack[0];return[e[0],e[4],e[1],e[5],e[2],e[6]]},n.prototype.setTint=function(e,t,i,n,o,s,a,r){var l=this._matrixStack[0];l[8]=e,l[9]=t,l[10]=i,l[11]=n,l[12]=o/255,l[13]=s/255,l[14]=a/255,l[15]=r/255},n.prototype.tint=function(e,t,i,n,o,s,a,r){var l=this._matrixStack[0],c=l[8],u=l[9],d=l[10],h=l[11];l[8]=e*c,l[9]=t*u,l[10]=i*d,l[11]=n*h,l[12]=o/255+l[12]*e,l[13]=s/255+l[13]*t,l[14]=a/255+l[14]*i,l[15]=r/255+l[15]*n},n.prototype.setTintMult=function(e,t,i,n){var o=this._matrixStack[0];o[8]=e,o[9]=t,o[10]=i,o[11]=n},n.prototype.setTintAdd=function(e,t,i,n){var o=this._matrixStack[0];o[12]=e/255,o[13]=t/255,o[14]=i/255,o[15]=n/255},n.prototype.multiplyColor=function(e,t,i,n){var o=this._matrixStack[0];o[8]*=e,o[9]*=t,o[10]*=i,o[11]*=n},n.prototype.addColor=function(e,t,i,n){var o=this._matrixStack[0];o[12]+=e*o[8]/255,o[13]+=t*o[9]/255,o[14]+=i*o[10]/255,o[15]+=n*o[11]/255}},function(e,t,i){function n(e,t,i,n){var o=n.vertexPos,s=n.textureCoord,a=n.color;e[i+0]=o[0],e[i+1]=o[1],t[i+2]=(65535*s[0]&65535)+(4294901760*s[1]&4294901760),e[i+5]=o[4],e[i+6]=o[5],t[i+7]=(65535*s[0]&65535)+(4294901760*s[3]&4294901760),e[i+10]=o[6],e[i+11]=o[7],t[i+12]=(65535*s[2]&65535)+(4294901760*s[3]&4294901760),e[i+15]=o[0],e[i+16]=o[1],t[i+17]=(65535*s[0]&65535)+(4294901760*s[1]&4294901760),e[i+20]=o[6],e[i+21]=o[7],t[i+22]=(65535*s[2]&65535)+(4294901760*s[3]&4294901760),e[i+25]=o[2],e[i+26]=o[3],t[i+27]=(65535*s[2]&65535)+(4294901760*s[1]&4294901760);var r=Math.max(-128,Math.min(127,64*a[0])),l=Math.max(-128,Math.min(127,64*a[1])),c=Math.max(-128,Math.min(127,64*a[2])),u=Math.max(-128,Math.min(127,64*a[3])),d=Math.max(-128,Math.min(127,128*a[4])),h=Math.max(-128,Math.min(127,128*a[5])),p=Math.max(-128,Math.min(127,128*a[6])),m=Math.max(-128,Math.min(127,128*a[7])),f=(u<<24&4278190080)+(c<<16&16711680)+(l<<8&65280)+(255&r),g=(m<<24&4278190080)+(p<<16&16711680)+(h<<8&65280)+(255&d);t[i+3]=t[i+8]=t[i+13]=f,t[i+18]=t[i+23]=t[i+28]=f,t[i+4]=t[i+9]=t[i+14]=g,t[i+19]=t[i+24]=t[i+29]=g}function o(e,t,i,n){this.nBytes=t,this.drawMode=i,this.texture=n||null,this.startingByte=e}function s(e,t,i){this.bbox=t,this.prerender=i,this.spriteBatches=e}var a=i(447);a.prototype.prepareBatchFromSpriteList=function(e,t,i){i=!!i;for(var a=t.spriteBatch,r=a.length-1,l=t.nbSprites*this._spriteSize,c=this.sFMPartitioner.reserve(e,l),u=c.start,d=u,h=u,p=new window.ArrayBuffer(l),m=new window.Float32Array(p),f=new window.Uint32Array(p),g=this._spriteSize/4,_=0,v=[],y=0;y<=r;y+=1){var b=a[y];if(b.isMaskTag)i=!0,v.push(b);else{n(m,f,_*g,b),h+=this._spriteSize,_+=1;var w=a[y+1];(y===r||b.texture!==w.texture||w.isMaskTag)&&(v.push(new o(d,h-d,this._drawModes.triangles,b.texture)),d=h)}}this.updateGPUBuffer(u,m),c.obj=new s(v,t.bbox,i)},a.prototype.loadSpriteBuffer=function(e,t,i,n,o){this._loadVertexBuffer(e,t,i,n,this._drawModes.triangles,o)},a.prototype.loadLineBuffer=function(e,t,i,n){this._loadVertexBuffer(e,t,null,i,this._drawModes.lines,n)},a.prototype._loadVertexBuffer=function(e,t,i,n,a,r){var l=t.byteLength,c=this.sFMPartitioner.reserve(e,l),u=c.start,d=new o(u,l,a,i);c.obj=new s([d],n,r),this.updateGPUBuffer(u,t)},a.prototype.updateVertexBuffer=function(e,t,i,n){var o=this.sFMPartitioner.getChunk(e);if(void 0===o)return void console.warn("[WebGLRenderer.updateVertexBuffer] No buffer loaded for",e);var s=o.start;this.updateGPUBuffer(s+i,t,n)},a.prototype.drawLineBatch=function(e,t){this.useProgram(this._programLine),this.gl.lineWidth(t);var i=this.sFMPartitioner.touch(e);return void 0===i?(console.warn("[WebGLRenderer.drawLineBatch] No buffer loaded for",e),void this.stopProgram()):(this._drawBatch(i),void this.stopProgram())},a.prototype.drawBoxBatch=function(e){this.useProgram(this._programBox);var t=this.sFMPartitioner.touch(e);return void 0===t?(console.warn("[WebGLRenderer.drawBoxBatch] No buffer loaded for",e),void this.stopProgram()):(this._drawBatch(t),void this.stopProgram())},a.prototype.drawSpriteBatchAbsoluteScale=function(e,t){this.useProgram(this._programAbsoluteScale);var i=this._matrixStack[0];i[3]=t/this._renderTarget.width,i[7]=t/this._renderTarget.height,this.drawSpriteBatch(e),this.stopProgram()},a.prototype.drawSpriteBatch=function(e){var t=this.sFMPartitioner.touch(e);if(void 0===t)return void console.warn("[WebGLRenderer.drawSpriteBatch] No buffer loaded for",e);if(t.prerender){var i=this.textureCache.holdElement(e),n=t.bbox;if(void 0===i){var o=n[0],s=n[1],a=n[2],r=n[3],l=this._matrixStack[0],c=this._renderTarget.width*l[0]/2,u=this._renderTarget.width*l[4]/2,d=this._renderTarget.height*l[1]/2,h=this._renderTarget.height*l[5]/2,p=Math.sqrt(Math.max(c*c+u*u,d*d+h*h))*this.prerenderRatio,m=this.startTextureUsage(s-o,r-a,p,e,"nearest");this.startTextureRendering(m,o,s,a,r),this._drawBatch(t),this.stopTextureRendering(!0,!0),i=m.texture}this.drawImage(i,n[0],n[2],n[1]-n[0],n[3]-n[2]),i.release()}else this._drawBatch(t)},a.prototype.handleMaskTag=function(e,t,i){if(e.isMaskDef){var n=t[0],o=t[1],s=t[2],a=t[3],r=this.startTextureUsage(o-n,a-s,this.maskQuality);return this.startTextureRendering(r,n,o,s,a),void i.push(r)}var l=this.gl;return e.isMaskUse?(this.useProgram(this._programMask,{mask:this._renderTarget.textureBinder}),l.uniform4fv(this._currentProgram.uniforms.uBbox,t),void this.stopTextureRendering(!0,!0)):void(e.isMaskStop&&(i.pop().texture.release(),this.stopProgram()))},a.prototype._drawBatch=function(e){for(var t=e.spriteBatches,i=null,n=0;n<t.length;n+=1){var o=t[n];if(o.isMaskTag)null===i&&(i=[]),this.handleMaskTag(o,e.bbox,i);else{var s=o.startingByte/this._vertexSize,a=o.nBytes/this._vertexSize;this._drawSubBatch(s,a,o.texture,o.drawMode)}}},a.prototype.drawSpriteSubBatch=function(e,t,i){var n=this.sFMPartitioner.touch(e);if(void 0===n)return void console.warn("[WebGLRenderer.drawSpriteSubBatch] No buffer loaded for",e);var o=n.spriteBatches[0],s=o.startingByte/this._vertexSize+t,a=i-t;this._drawSubBatch(s,a,o.texture,o.drawMode)},a.prototype._drawSubBatch=function(e,t,i,n){if(!(t<=0)){var o=this.gl;if(null!==i){var s=this.textureCache.useElement(i.id);if(void 0===s)return void console.warn("[WebGLRenderer._drawSubBatch] Texture not loaded:",i.id);o.bindTexture(o.TEXTURE_2D,s.element.binder)}o.uniformMatrix4fv(this._currentProgram.uniforms.uMatrix,!1,this._matrixStack[0]),o.drawArrays(n,e,t)}}},function(e,t){e.exports={DIRECTION_EAST:0,DIRECTION_SOUTH_EAST:1,DIRECTION_SOUTH:2,DIRECTION_SOUTH_WEST:3,DIRECTION_WEST:4,DIRECTION_NORTH_WEST:5,DIRECTION_NORTH:6,DIRECTION_NORTH_EAST:7}},function(e,t){function i(){this._type=null,this.alive=!0,this.teamId=0,this.isCarryied=!1,this.disposition={cellId:-1,direction:0,carryingCharacterId:0},this.look=null,this.stats={actionPoints:0,airElementReduction:0,airElementResistPercent:0,baseMaxLifePoints:0,criticalDamageFixedResist:0,dodgePALostProbability:0,dodgePMLostProbability:0,earthElementReduction:0,earthElementResistPercent:0,fireElementReduction:0,fireElementResistPercent:0,invisibilityState:0,initiative:0,lifePoints:0,maxActionPoints:0,maxLifePoints:0,maxMovementPoints:0,movementPoints:0,neutralElementReduction:0,neutralElementResistPercent:0,permanentDamagePercent:0,pushDamageFixedResist:0,shieldPoints:0,summoned:!1,summoner:0,tackleBlock:0,tackleEvade:0,waterElementReduction:0,waterElementResistPercent:0}}function n(e,t){for(var i in e)void 0!==t[i]&&(e[i]=t[i])}e.exports=i,i.prototype.updateData=function(e){void 0!==e._type&&(this._type=e._type),void 0!==e.alive&&(this.alive=e.alive),void 0!==e.teamId&&(this.teamId=e.teamId),e.disposition&&n(this.disposition,e.disposition),e.look&&(this.look=e.look),e.stats&&n(this.stats,e.stats)},i.prototype.pointVariation=function(e,t){this.stats[e]+=t,this.stats[e]<0&&(this.stats[e]=0)}},function(e,t,i){function n(e){S.preloadImage("ui/SpellPlaceholder.png",function(e){t.placeHolder=e}),v([L],null,function(t,i){return t?e(t):(w=i,void e())})}function o(e,t){return e?console.error(e):void console.log("data:",t)}function s(){return++N}function a(){this._uid=s()}function r(e,t,i){var n=this;this.id=parseInt(e,10),this.ownerId=null,this.position=null,this.isItem=!1,this.level=null,this.isLoaded=!1,this.spell=null,this._tables={},v(e,t,function(e,t){return e?i(e):(n.effectInstances=t.effectInstances,delete t.effectInstances,n._tables=t,n.spell=t.spells[n.id],n.spell?(n.setLevel(n.level||1),n.isLoaded=!0,void i()):i(new Error("missing static data for spell id "+n.id)))})}function l(e,t){this.id=L,this.ownerId=null,this.position=null,this.isItem=!0,this.level=1,this.isLoaded=!1,this._item=e,this.effectInstances={};for(var i=0;i<this._item.effects.length;i++)this.effectInstances[this.getSpellLevelId()+"-effects-"+i]=this._item.effects[i];if(!e.isInitialised){var n=this;return e.once("initialised",function(){l.call(n,e,t)})}if(this.isLoaded=!0,window.gui.shortcutBar.updateSpellAvailability(this.id),t)return t()}function c(e,t){var i,n=this._getSpellLevelByLevel(t),o=window.gui.playerData.characters.getSpellModifications;switch(e){case"id":case"nameId":case"descriptionId":case"typeId":case"iconId":case"scriptParams":case"scriptParamsCritical":case"scriptId":case"scriptIdCritical":case"spellLevels":case"useParamCache":return this.spell?this.spell[e]:(console.error("Spell#getPropertyFromSpell this.spell is undefined or null #",this.id),null);case"minCastInterval":if(i=o(this.ownerId,this.id,C.CAST_INTERVAL),!i)return n[e];var s=i.value.getTotalStat();return n[e]-s;case"apCost":if(i=o(this.ownerId,this.id,C.AP_COST),!i)return n[e];var a=i.value.getTotalStat();return n[e]-a;case"maxCastPerTurn":return i=o(this.ownerId,this.id,C.MAX_CAST_PER_TURN),i?n[e]+i.value.getEquipmentPts()+i.value.getBonusPts():n[e];case"range":return i=o(this.ownerId,this.id,C.RANGE),i?n[e]+i.value.getEquipmentPts()+i.value.getBonusPts():n[e];case"maxCastPerTarget":return i=o(this.ownerId,this.id,C.MAX_CAST_PER_TARGET),i?n[e]+i.value.getEquipmentPts()+i.value.getBonusPts():n[e];case"castInLine":return i=o(this.ownerId,this.id,C.CAST_LINE),i?!!n[e]&&0===i.value.getTotalStat():n[e];case"castTestLos":return i=o(this.ownerId,this.id,C.LOS),i?!!n[e]&&0===i.value.getTotalStat():n[e];case"rangeCanBeBoosted":return i=o(this.ownerId,this.id,C.RANGEABLE),!i||n[e]?n[e]:i.value.getTotalStat()>0;case"maxStack":case"castInDiagonal":case"criticalFailureProbability":case"spellBreed":case"needFreeCell":case"needTakenCell":case"criticalFailureEndsTurn":case"globalCooldown":case"statesRequired":case"statesForbidden":case"minRange":case"minPlayerLevel":case"canSummon":case"canBomb":return n[e];case"spellLevel":return n;case"grade":return n[e]||t;case"isSpellWeapon":return this.id===L;case"isDefaultSpellWeapon":return this.id===L&&!window.gui.playerData.inventory.getCurrentWeapon();case"criticalHitProbability":return d.call(this);default:return null}}function u(e){var t=this._item.item;if(!t)return console.error(new Error("SpellFactory getPropertyFromItem: item is not ready yet")),null;switch(e){case"nameId":case"descriptionId":case"apCost":case"criticalFailureProbability":case"criticalHitProbability":case"range":case"castInLine":case"castInDiagonal":case"castTestLos":case"minRange":case"maxCastPerTurn":return t[e];case"iconId":return this._item.getProperty("iconId");case"id":case"minCastInterval":case"minPlayerLevel":case"maxStack":case"maxCastPerTarget":case"scriptId":case"scriptIdCritical":case"spellBreed":return 0;case"grade":return 1;case"typeId":return 24;case"useParamCache":case"needTakenCell":case"rangeCanBeBoosted":case"isDefaultSpellWeapon":case"needFreeCell":return!1;case"criticalFailureEndsTurn":case"isSpellWeapon":return!0;case"scriptParams":case"scriptParamsCritical":case"spellLevels":return null;default:return null}}function d(){var e=window.gui.playerData.characters.getSpellModifications,t=e(this.ownerId,this.id,C.CRITICAL_HIT_BONUS),i=this.spellLevel.criticalHitProbability;return i<=0?0:t?Math.max(i-t.value.getTotalStat(),2):i}function h(){this.castingData={lastCastTurn:0,targetsThisTurn:{},castThisTurn:0,lastInitialCooldownReset:0}}function p(e,t){e instanceof Array||(e=[e]),v(e,function(i,n){if(i)return t(i);var o={};M.each(e,function(e,t){if(o[e]=new a,~~e===L){var i=window.gui.playerData.inventory.getCurrentWeapon();if(i)return l.call(o[e],i,t)}r.call(o[e],e,n,t)},function(e){return e?t(e):void t(null,o)})})}function m(e,t,i){return t&&t.spells?i(null,I.extractElementsFrom(e,t.spells,!0)):void A.getData("Spells",e,function(t,n){return t?i(t):void i(null,I.extractElementsFrom(e,n,!0))})}function f(e,t,i){var n={};for(var o in e.spells)for(var s=e.spells[o],a=0;a<s.spellLevels.length;a++)n[s.spellLevels[a]]=!0;return n=Object.keys(n),0===n.length?i(null,{}):t&&t.spellLevels?i(null,I.extractElementsFrom(n,t.spellLevels,!0)):void A.getData("SpellLevels",n,function(e,t){return e?i(e):void i(null,I.extractElementsFrom(n,t,!0))})}function g(e,t,i){var n={};for(var o in e.spellLevels){var s,a=e.spellLevels[o];for(s=0;s<a.statesRequired.length;s++)n[a.statesRequired[s]]=!0;for(s=0;s<a.statesForbidden.length;s++)n[a.statesForbidden[s]]=!0}return n=Object.keys(n),0===n.length?i(null,{}):t&&t.spellStates?i(null,I.extractElementsFrom(n,t.spellStates,!0)):void A.getData("SpellStates",n,function(e,t){return e?i(e):void i(null,I.extractElementsFrom(n,t,!0))})}function _(e,t,i){var n,o,s={},a={},r=["effects","criticalEffect"];for(var l in e.spellLevels)if(e.spellLevels.hasOwnProperty(l))for(var c=e.spellLevels[l],u=0;u<r.length;u++){var d=r[u];for(o=0;o<c[d].length;o++)if(n=l+"-"+d+"-"+o,t&&t.effectInstances&&t.effectInstances[n])a[n]=t.effectInstances[n];else{var h=c[d][o];h.effectCaller="SpellFactory spellLevelId: "+n,s[n]=c[d][o]}}return 0===Object.keys(s).length?i(null,a):void T.createEffectInstancesIndexed(s,function(e,t){if(e)return i(e);if(0===Object.keys(a).length)return i(null,t);for(var n in a)a.hasOwnProperty(n)&&(t[n]=a[n]);i(null,t)})}function v(e,t,i){if("function"!=typeof t||i||(i=t,t=null),i=i||o,e instanceof Array||(e=[e]),e=e.filter(function(e){return!isNaN(e)}),0===e.length)return i(new Error("No valid spell id"));e.indexOf(L)!==-1&&(t||(t={}),b(t,w));var n={};m(e,t,function(e,o){return e?i(e):(n.spells=o,void f(n,t,function(e,o){return e?i(e):(n.spellLevels=o,void g(n,t,function(e,o){return e?i(e):(n.spellStates=o,void _(n,t,function(e,t){return e?i(e):(n.effectInstances=t,void i(null,n))}))}))}))})}function y(e,t,i){function n(e,i){var n=e.getProperty(t),o=i.getProperty(t);return n>o?-a:n<o?a:e.id>i.id?-a:void 0}var o=Array.isArray(e)?e:[];if(!o.length)for(var s in e)o.push(e[s]);var a=i?1:-1;return o.sort(n)}function b(e,t){for(var i in t)if(t.hasOwnProperty(i)){e[i]||(e[i]={});for(var n in t[i])t[i].hasOwnProperty(n)&&(e[i][n]=t[i][n])}}var w,M=i(31),T=i(400),C=i(406),I=i(252),A=i(30),S=i(202),E=i(184),x=i(460),L=t.WEAPON_SPELL_ID=0;t.placeHolder=E.MISSING_TEXTURE_IMAGE_SRC;var N=0;a.prototype.setLevel=function(e){return this.isItem?void(1!==e&&console.warn("Spell#setLevel called on item with level != 1",e)):(this.level=e,this.spell?!e||e<1||e>this.spell.spellLevels.length?console.error(new Error("invalid level "+e+" for spell #"+this.id)):void(this.spellLevel=this._getSpellLevelByLevel(this.level)):console.error("Spell#setLevel this.spell is undefined or null #",this.id))},a.prototype.setPosition=function(e){this.position=e},a.prototype._getSpellLevelByLevel=function(e){return this.isItem?console.error("Spell#_getSpellLevelByLevel called on item for Spell id",this.id):this.spell?this._tables.spellLevels[this.spell.spellLevels[e-1]]:console.error("Spell#_getSpellLevelByLevel this.spell is undefined or null #",this.id)},a.prototype.getSpellLevelId=function(e){return this.isItem?"weapon":(e=void 0!==e?e:this.level,this._getSpellLevelByLevel(e).id)},a.prototype.getZoneEffect=function(){for(var e,t=63,i=this.id===L&&window.gui.playerData.inventory.getCurrentWeapon(),n=i?this._item.effects:this.spellLevel.effects,o=0;o<n.length;o++){var s=this.effectInstances[this.getSpellLevelId()+"-effects-"+o].getZoneEffect();s.zoneShape&&s.zoneSize>0&&s.zoneSize<t&&(t=s.zoneSize,e=s)}return e||T.parseZone("P")},a.prototype.getZoneEffectWhenCasting=function(){for(var e,t=this.id===L&&window.gui.playerData.inventory.getCurrentWeapon(),i=t?this._item.effects:this.spellLevel.effects,n=0;n<i.length;n++){var o=this.effectInstances[this.getSpellLevelId()+"-effects-"+n].getZoneEffect();o.zoneShape&&o.zoneSize>0&&(e=o)}return e||T.parseZone("P")},a.prototype.getHumanReadableZoneInfo=function(){return T.getHumanReadableZoneInfo(this.getZoneEffect())},a.prototype.getMaxLevel=function(){return this.isItem||this.id===L?1:this.spell.spellLevels.length},a.prototype.getHumanReadableSpellType=function(){var e=this.getProperty("typeId"),t=window.gui.databases.SpellTypes[e];return t?t.longNameId:(console.error("Spell factory cannot get typeId",e,"for spellId:",this.id),"")},a.prototype.getEffectsIds=function(e){return this.isItem?Object.keys(this.effectInstances):this._getSpellLevelByLevel(e||this.level).effects},a.prototype.getCriticalEffectsIds=function(e){return this.isItem?[]:this._getSpellLevelByLevel(e||this.level).criticalEffect},a.prototype.getUpgradeCost=function(e,t){if(this.isItem)return null;void 0===t&&void 0===e?(e=this.level,t=e+1):void 0===t&&(t=e,e=this.level);for(var i=0,n=0,o=1;o<=e;o+=1)n+=o-1,i+=o-1;for(;o<=t;o+=1)i+=o-1;return i-n},a.prototype.getName=function(){var e=this.getProperty("nameId");return window.gui.playerData.isAdmin()&&(e+=" ("+this.id+")"),e},a.prototype.getProperty=function(e,t){t=t||this.level;var i=this.isItem?u.call(this,e):c.call(this,e,t);if("range"===e){var n=window.gui.playerData.characters.getControlledCharacter().characteristics;if(!n)return i;var o=n.range,s=this.isItem?u.call(this,"rangeCanBeBoosted"):c.call(this,"rangeCanBeBoosted",t);if(s){var a=this.isItem?u.call(this,"minRange"):c.call(this,"minRange",t),r=o.getTotalStat();i+r<a?i=a:i+=r}}return i},a.prototype.getIconUri=function(){var e=this.isItem?E.ITEM_DIR:E.SPELL_DIR+"sort_",t=this.getProperty("iconId");return t<0&&console.error(new Error("iconId < 0 for spellId "+this.id+": "+t)),e+this.getProperty("iconId")+".png"},a.prototype.getIconUrl=function(){return this.isItem?this._item.item&&this._item.getProperty("image"):this.spell&&this.spell.image},a.prototype.update=function(e){if(this.id!==L)return e();var t=window.gui.playerData.inventory.getCurrentWeapon();return t?l.call(this,t,e):r.call(this,0,null,e)},a.prototype.clone=function(){var e=new a;for(var t in this)this.hasOwnProperty(t)&&"_uid"!==t&&"castingData"!==t&&(e[t]=this[t]);return e.setLevel(1),e},a.prototype.cast=function(e,t,i){this.castingData||h.call(this),t=t||[],i=i!==!1,this.castingData.lastCastTurn=e;for(var n=0;n<t.length;n++){var o=t[n];this.castingData.targetsThisTurn[o]||(this.castingData.targetsThisTurn[o]=0),this.castingData.targetsThisTurn[o]++}i&&this.castingData.castThisTurn++,window.gui.shortcutBar.updateSpellAvailability(this.id)},a.prototype.newTurn=function(){this.castingData||(console.warn('You should not call "newTurn" on a spell that has not been casted'),h.call(this)),this.castingData.castThisTurn=0,this.castingData.targetsThisTurn={}},a.prototype.getModifiedInterval=function(){if(this.isItem)return 0;for(var e=new x,t=window.gui.playerData.characters.mainCharacter.characteristics.spellModifications,i=0;i<t.length;i++){var n=t[i];if(n.spellId===this.id){var o=n.modificationType;o===C.CAST_INTERVAL?e.castInterval.setPts(n.value.getAllValues()):o===C.CAST_INTERVAL_SET&&e.castIntervalSet.setPts(n.value.getAllValues())}}var s,a=e.castInterval.getTotalStat(),r=e.castIntervalSet.getTotalStat();return s=r?r-a:this.spellLevel.minCastInterval-a},a.prototype.getCooldown=function(){if(!this.castingData||this.isItem)return 0;var e=this.getModifiedInterval();if(63===e)return 63;var t;return t=0===this.spellLevel.initialCooldown||this.castingData.lastCastTurn>=this.castingData.lastInitialCooldownReset+this.spellLevel.initialCooldown?e+this.castingData.lastCastTurn-window.gui.fightManager.turnCount:this.castingData.lastInitialCooldownReset+this.spellLevel.initialCooldown-window.gui.fightManager.turnCount,t=Math.max(0,t)},a.prototype.resetInitialCooldown=function(e){this.castingData||h.call(this),this.castingData.lastInitialCooldownReset=e},a.prototype.forceCooldown=function(e){this.castingData||(console.warn('You should not call "forceCooldown" on a spell that has not been casted'),h.call(this));var t=this.isItem?0:this.getModifiedInterval();this.castingData.lastCastTurn=e+window.gui.fightManager.turnCount-t},a.prototype.forceLastCastTurn=function(e){this.castingData||(console.warn('You should not call "forceLastCastTurn" on a spell that has not been casted'),h.call(this)),this.castingData.lastCastTurn=e},a.prototype.hasBeenCast=function(){return!!this.castingData},t.initialize=n,t.createSpells=p,t.sortSpells=y},function(e,t,i){function n(){this._type="SpellModificator",this.apCost=new o,this.castInterval=new o,this.castIntervalSet=new o,this.maxCastPerTurn=new o,this.maxCastPerTarget=new o}var o=i(275);e.exports=n},function(e,t,i){function n(e,t){e.apply(null,t)}function o(e,t,i,n,o,s){void 0===o&&(o=!0);var a=window.gui.fightManager.getFighter(t);if(!a)return console.error("Movement points variation step failed, fighter does not exist");if(o&&(a.data.stats.movementPoints+=i,window.gui.playerData.characters.controlledCharacterId===t)){var r=window.gui.playerData.characters.getControlledCharacter();r.setCharacteristic("movementPointsCurrent",a.data.stats.movementPoints)}i>0?q.push(k.FIGHTER_MP_GAINED,[t,i],t,e,!1,2,s):i<0&&(n?q.push(k.FIGHTER_MP_USED,[t,Math.abs(i)],t,e,!1,2,s):q.push(k.FIGHTER_MP_LOST,[t,Math.abs(i)],t,e,!1,2,s))}function s(e,t,i,n,o,s){void 0===o&&(o=!0);var a=window.gui.fightManager.getFighter(t);if(!a)return console.error("Action points variation step failed, fighter does not exist");if(o&&(a.data.stats.actionPoints+=i,window.gui.playerData.characters.controlledCharacterId===t&&!n)){var r=window.gui.playerData.characters.getControlledCharacter();r.setCharacteristic("actionPointsCurrent",r.characteristics.actionPointsCurrent+i)}i>0?q.push(k.FIGHTER_AP_GAINED,[t,i],t,e,!1,2,s):i<0&&(n?q.push(k.FIGHTER_AP_USED,[t,Math.abs(i)],t,e,!1,2,s):q.push(k.FIGHTER_AP_LOST,[t,Math.abs(i)],t,e,!1,2,s))}function a(e,t,i,n){q.push(k.FIGHTER_LEAVING_STATE,[t,i],t,e,!1,2,n)}function r(e,t,i,n,o){q.push(k.FIGHTER_ENTERING_STATE,[t,i,n],t,e,!1,2,o)}function l(e,t,i,n,o,s){q.push(k.FIGHTER_TEMPORARY_BOOSTED,[t,i,n,o],t,e,!1,2,s)}function c(e,t){var i=window.gui.fightManager.getFighter(t.targetId);return i?t.actionId===z.ACTION_CHARACTER_UPDATE_BOOST?i.updateBuff(t):(i.addBuff(t),void(t instanceof H.StatBuff&&("movementPoints"===t.statName?o(e,t.targetId,t.getDelta(),!1,!1,!1):"actionPoints"===t.statName&&s(e,t.targetId,t.getDelta(),!1,!1,!1)))):console.error("Display buff step failed, fighter does not exist")}function u(e,t,i){var n=window.gui.fightManager;n.emit("updateSpellsAvailability");var o=i.contextualId,s=n.deadTurnsList.indexOf(o);s!==-1&&n.deadTurnsList.splice(s,1);var a=window.gui.playerData;if(o===a.id){var r=a.characters.mainCharacter;n.prepareSpellsWithInitialCooldown(r),r.setCharacteristic("lifePoints",i.stats.lifePoints)}n.emit(k.FIGHTER_SUMMONED,[t,o],o,e)}function d(e,t,i,n){var o=window.gui.fightManager,s=window.gui.playerData;t===s.characters.controlledCharacterId&&o.getFighterSpell(i,t,function(e,t){return e?console.error(e):(t.castingData||t.cast(o.turnCount,[],!1),t.forceCooldown(n),void window.gui.shortcutBar.updateSpellAvailability(i))})}function h(e,t,i,n){var o=window.gui.fightManager;o.incrementDuration(i,n,!0,o.INCREMENT_MODE_TARGET),q.push(k.FIGHTER_EFFECTS_MODIFY_DURATION,[i,t,n],i,e)}function p(e,t,i,n,o){var s=window.gui.fightManager,a=s.getFighter(t),r=s.getFighter(n);return a&&r?(a.data.disposition.cellId=i,r.data.disposition.cellId=o,void s.emit(k.FIGHTERS_POSITION_EXCHANGE,[t,n],0,e)):console.error("Exchange position step failed, fighters do not exist")}function m(e,t,i){var n=window.gui.fightManager,o=n.getFighter(t);return o?(o.data.disposition.cellId=i,void n.emit(k.FIGHTER_SLIDE,[t],t,e)):console.error("Slide step failed, fighter does not exist");
}function f(e,t,i){var n=window.gui.fightManager,o=n.getFighter(t);return o?(o.data.disposition.cellId=i,void n.emit(k.FIGHTER_TELEPORTED,[t],0,e)):console.error("Teleport step failed, fighter does not exist")}function g(e,t,i){var n=window.gui.fightManager.getFighter(t);return n?void(n.data.disposition.cellId=i):console.error("Map movement step failed, fighter does not exist")}function _(e,t,i){window.gui.fightManager.emit(k.FIGHTER_CARRY,[t,i],0,e)}function v(e,t,i,n){var o=window.gui.fightManager;if(n!==-1){var s=o.getFighter(i);if(!s)return console.error("Throw character step failed, fighter does not exist");s.data.disposition.cellId=n}o.emit(k.FIGHTER_THROW,[t,i,n],0,e)}function y(e,t,i,n){var o=window.gui.fightManager.getFighter(t);return o?void(i<0?q.push(k.FIGHTER_SHIELD_LOSS,[t,i,n],t,e):i>0?q.push(k.FIGHTER_SHIELD_GAIN,[t,i],t,e):q.push(k.FIGHTER_NO_CHANGE,[t],t,e)):console.error("Fighter "+t+" does not exist.")}function b(e,t,i,n,o,s){var a=window.gui.fightManager,r=a.getFighter(t);if(!r)return console.error("Fighter "+t+" does not exist.");var l=r.data.stats;l.maxLifePoints=Math.max(1,l.maxLifePoints+n);var c=Math.min(Math.max(0,l.lifePoints+i),l.maxLifePoints);r.setHP(c),(!s||s&&i)&&(i<=0?q.push(k.FIGHTER_LIFE_LOSS,[t,i,o],t,e,!1,2):i>0&&q.push(k.FIGHTER_LIFE_GAIN,[t,i,o],t,e,!1,2))}function w(e,t,i){q.push(k.FIGHTER_REDUCED_DAMAGES,[t,i],t,e)}function M(e,t,i){q.push(k.FIGHTER_AP_LOSS_DODGED,[t,i],t,e)}function T(e,t,i){q.push(k.FIGHTER_MP_LOSS_DODGED,[t,i],t,e)}function C(e,t){q.push(k.FIGHTER_SPELL_IMMUNITY,[t],0,e)}function I(e,t,i){var n=window.gui.fightManager.getFighter(t);return n?void n.dispelUniqueBuff(i,!0,!1,!0):console.error("Fighter "+t+" does not exist.")}function A(e,t,i){var n=window.gui.fightManager.getFighter(t);return n?(n.dispelSpell(i,!0),void q.push(k.FIGHTER_SPELL_DISPELLED,[t,i],t,e)):console.error("Fighter "+t+" does not exist.")}function S(e,t){var i=window.gui.fightManager.getFighter(t);return i?(i.dispel(),void q.push(k.FIGHTER_GOT_DISPELLED,[t],t,e)):console.error("Fighter "+t+" does not exist.")}function E(e,t){q.push(k.FIGHTER_REFLECTED_SPELL,[t],t,e)}function x(e,t){q.push(k.FIGHTER_REFLECTED_DAMAGES,[t],t,e)}function L(e,t){q.push(k.FIGHTER_GOT_TACKLED,[t],0,e)}function N(e,t,i){q.push(k.FIGHTER_GOT_KILLED,[i,t],t,e)}function O(e,t,i){var n=window.gui.fightManager.getFighter(t);if(!n)return console.error("Fighter "+t+" does not exist.");var o,s=n.data.stats.invisibilityState;i!==F.VISIBLE&&s===F.VISIBLE?o=F.INVISIBLE:i===F.VISIBLE&&s!==F.VISIBLE&&(o=F.VISIBLE),o&&q.push(k.FIGHTER_VISIBILITY_CHANGED,[t,o],t,e),n.data.stats.invisibilityState=i}function D(e,t,i,n){q.push(k.FIGHTER_TRIGGERED_GLYPH,[t,i,n],0,e)}function R(e,t,i,n){q.push(k.FIGHTER_CLOSE_COMBAT,[t,i,n],t,e)}function P(e,t,i,n){q.push(k.FIGHTER_CASTED_SPELL,[t,i,n],0,e)}function B(e,t,i){void 0===i&&(i=!0);var n=window.gui.fightManager,o=n.getFighter(t);return o?(n.deadTurnsList.push(t),o.dispel(!1,!1,!0),n.removeLinkedBuff(t),o.setAlive(!1),void q.push(i?k.FIGHTER_DEATH:k.FIGHTER_LEAVE,[t],t,e)):console.error("Fighter "+t+" does not exist.")}var k=i(395),F=i(410),z=i(399),H=i(397),q=i(409);t.pushStep=n,t.fightMovementPointsVariationStep=o,t.fightActionPointsVariationStep=s,t.fightLeavingStateStep=a,t.fightEnteringStateStep=r,t.fightTemporaryBoostStep=l,t.fightDisplayBuffStep=c,t.fightSummonStep=u,t.fightSpellCooldownVariationStep=d,t.fightModifyEffectsDurationStep=h,t.fightExchangePositionsStep=p,t.fightSlideStep=m,t.fightTeleportOnSameMapStep=f,t.mapMovementStep=g,t.fightCarryCharacterStep=_,t.fightThrowCharacterStep=v,t.fightShieldPointsVariationStep=y,t.fightLifePointsVariationStep=b,t.fightReduceDamages=w,t.fightActionPointsLossDodge=M,t.fightMovementPointsLossDodge=T,t.fightSpellImmunity=C,t.fightDispelEffectStep=I,t.fightDispelSpellStep=A,t.fightDispelStep=S,t.fightReflectSpellStep=E,t.fightReflectDamagesStep=x,t.fightTackledStep=L,t.fightKillStep=N,t.fightInvisibilityStep=O,t.fightTriggerGlyphTrapStep=D,t.fightCloseCombatStep=R,t.fightSpellCastStep=P,t.fightDeathStep=B},function(e,t,i){function n(){o.call(this),this.characteristics=null,this.spellShortcuts=[],this.spellData=new a,this.currentSummonedCreature=0,this.currentSummonedBomb=0,this.timeStatsSynchronized=0}var o=i(194).EventEmitter,s=i(191).inherits,a=i(463),r={actionPointsCurrent:!0,alignmentInfos:!0,lifePoints:!0,maxLifePoints:!0,movementPointsCurrent:!0,spellsPoints:!0};s(n,o),e.exports=n,n.prototype.disconnect=function(){this.characteristics=null,this.spellShortcuts=null,this.spellData.disconnect(),this.currentSummonedCreature=0,this.currentSummonedBomb=0},n.prototype.setCharacteristics=function(e){this.characteristics=e;var t=window.gui.playerData.characters.getControlledCharacter()===this;t&&this.emitCharacteristicsUpdate(),this.timeStatsSynchronized=Date.now()},n.prototype.emitCharacteristicsUpdate=function(){var e=window.gui.playerData;for(var t in r)void 0!==this.characteristics[t]?e.emit(t+"Updated",this.characteristics[t]):console.error(new Error("emitCharacteristicsUpdate: No characteristic named: "+t));e.emit("characteristicsUpdated")},n.prototype.setCharacteristic=function(e,t){if(void 0===this.characteristics[e])return void console.error(new Error("setCharacteristic: No characteristic named: "+e));if("CharacterBaseCharacteristic"===this.characteristics[e]._type)return void console.error(new Error("setCharacteristic: "+e+' cannot take a type "number"'));this.characteristics[e]=t;var i=window.gui.playerData.characters.getControlledCharacter()===this;i&&r[e]&&window.gui.playerData.emit(e+"Updated",t)},n.prototype.setCharacterId=function(e){this.spellData.characterId=e},n.prototype.getMaxSummonedCreature=function(){return this.characteristics.summonableCreaturesBoost.getTotalStat()},n.prototype.setSpellShortcuts=function(e){this.spellShortcuts=[];for(var t=0;t<e.length;t++)this.spellShortcuts.push(e[t])},n.prototype.updateSpellShortcut=function(e){for(var t=0;t<this.spellShortcuts.length;t++)if(this.spellShortcuts[t].slotIndex===e.slotIndex)return void(this.spellShortcuts[t]=e);this.spellShortcuts.push(e)},n.SpellData=a},function(e,t,i){function n(){}function o(){s.call(this),this.spells={},this.characterId=null,this.isLoaded=!1,this._requestsPendingCount=0,this._spellsStatus={}}var s=i(194).EventEmitter,a=i(191).inherits,r=i(459),l=i(7),c={UNAVAILABLE:0,VISIBLE:1,USABLE:2};a(o,s),e.exports=o,o.prototype.disconnect=function(){this.spells={},this.characterId=null,this.isLoaded=!1,this._requestsPendingCount=0,this._spellsStatus={}},o.prototype.weaponChanged=function(e){this.spells[r.WEAPON_SPELL_ID]&&this.spells[r.WEAPON_SPELL_ID].update(e)},o.prototype.getSpells=function(e){e=e||0;var t={};for(var i in this.spells){var n=this._spellsStatus[i]||0;n>=e&&(t[i]=this.spells[i])}return t},o.prototype._createSpells=function(e,t,i){var n=this;t=t||{},this._requestsPendingCount++,this.isLoaded=!1,this.spells[r.WEAPON_SPELL_ID]||e.indexOf(r.WEAPON_SPELL_ID)!==-1||e.indexOf(r.WEAPON_SPELL_ID.toString())!==-1||e.push(r.WEAPON_SPELL_ID.toString()),r.createSpells(e,function(e,o){if(e)return console.error(e);for(var s in o){o[s].ownerId=n.characterId,n.spells[s]=o[s];var a=t[s];a&&(void 0!==a.level&&o[s].setLevel(a.level),void 0!==a.position&&o[s].setPosition(a.position))}return n._requestsPendingCount--,0===n._requestsPendingCount&&(n.isLoaded=!0,n.emit("loaded")),i?i():void 0})},o.prototype.addSpells=function(e,t){var i=[],n={};for(var o in e){var s=e[o];this._spellsStatus[o]=s.spellStatus,this.spells[o]?void 0!==s.spellLevel&&void 0!==s.position&&(this.spells[o].setLevel(s.spellLevel),this.spells[o].setPosition(s.position)):(n[o]={level:s.spellLevel,position:s.position},i.push(o))}return 0===i.length?t&&t():void this._createSpells(i,n,t)},o.prototype.resetSpellsStatus=function(){this._spellsStatus={}},o.prototype.upgradeSpell=function(e,t,i,o){var s=-1,a=this._spellsStatus[e]||c.UNAVAILABLE,r=this.spells[e];if(o=o||n,r&&a===c.USABLE&&(s=r.level),l.log("character_progression.spell_level_change",{spell_level_before:s,spell_level_after:t,spell_id:e}),this._spellsStatus[e]=i,r)return r.setLevel(t),o();var u={};return u[e]={},u[e].level=t,this._createSpells([e],u,o)},o.prototype.getSpellBySpellLevelId=function(e){for(var t in this.spells){var i=this.spells[t];if(!i.isItem&&i.spellLevel.id===e)return i}return null},o.SPELL_STATUS=c},function(e,t,i){function n(e){var t=this;s.call(this,"div",{className:"StarCounter"}),this.stars=[];for(var i=0;i<l;i++){var n=this.createChild("div",{className:"star"});this.stars[i]=n}this.bonusContainer=this.createChild("div",{className:"bonusContainer"}),this.bonusContainer.createChild("div",{className:"bonusContainerPlus",text:"+"});for(var o=0;o<3;o++){var c=this.bonusContainer.createChild("div",{className:"bonusStar"});c.addClassNames("star"+(o+1))}this.linkToShop=this.bonusContainer.appendChild(new a({className:"linkToShop",scaleOnPress:!1})),this.linkToShop.on("tap",function(){r.open("market",{tabId:"shop",tabParams:{category:"bonuspack"}}),t.emit("shopOpened")}),void 0!==e&&this.setValue(e)}i(465);var o=i(191).inherits,s=i(235),a=i(246),r=i(225),l=5;o(n,s),e.exports=n,n.prototype.setValue=function(e){var t="level1",i="";e>100&&(t="level2",i="level1",e-=100),e/=20,e-=.5;for(var n=0;n<l;n++)this.stars[n].delClassNames(["level1","level2"]),this.stars[n].addClassNames(n<=e?t:i);window.gui.playerData.isSubscriber()?this.bonusContainer.addClassNames("bonusPackActive"):this.bonusContainer.delClassNames("bonusPackActive")}},function(e,t){},function(e,t,i){function n(e,t){function i(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function n(e,t){var n=m[0];if(!e)return!1;if(!y){var o=i(e,n),s=Date.now()-f;if(o/r+s/l>=b)return!0}if(!t)return!1;var a=m[1];a||(a=m[1]=t);var u=Math.abs(i(n,a)-i(e,t));return u>c}function u(t){var a=o(t),r=a.touches[0],l=a.touches[1];if(!r)return void console.error(new Error("touch1 is null, touchCount: "+a.touchCount+" x: "+a.x+" y: "+a.y));if(!v){if(!n(r,l))return;return void(s.requestInteractionHandle("TRANSFORM",e)?(v=!0,e.isTransforming=!0,e.emit("transformStart",a,m)):e.cancelTransform())}var c=r,u=1;if(l){c={x:(r.x+l.x)/2,y:(r.y+l.y)/2};var f=i(r,l);p&&(u=f/p),p=f}c.x-=d.left,c.y-=d.top,h=h||c;var g=y?0:c.x-h.x,_=y?0:c.y-h.y;e.emit("transform",c.x,c.y,g,_,u,a),h=c}if(!e._transformBehavior){e._transformBehavior=!0,e.allowDomEvents();var d,h,p,m,f,g=!1,_=!1,v=!1;e.on("dom.wheel",function(t){if(s.requestInteractionHandle("TRANSFORM",e)){d=e.rootElement.getBoundingClientRect();var i=t.wheelDeltaY>0?a:1/a;e.emit("transform",t.x-d.left,t.y-d.top,0,0,i)}}),e.isTransforming=!1;var y=!1;e.setTranslationEnable=function(e){y=!e};var b=2/("HIGH"===t?3:1);e.cancelTransform=function(){_&&(g=!0,h=p=null,_=!1,e.removeListener("dom.touchmove",u),e.isTransforming=!1,v&&e.emit("transformEnd"))},e.on("dom.touchstart",function(t){if(h=p=null,!_&&!g){var i=o(t);y&&2!==i.touchCount||i.touchCount>2||(d=e.rootElement.getBoundingClientRect(),_=!0,v=!1,m=i.touches,f=Date.now(),e.on("dom.touchmove",u))}}),e.on("dom.touchend",function(t){h=p=null;var i=o(t);return g||0!==i.touchCount?void(g=!1):(e.removeListener("dom.touchmove",u),_=!1,void(v&&(e.isTransforming=!1,e.emit("transformEnd",i))))})}}var o=i(229).getPosition,s=i(231),a=1.2,r=40,l=100,c=10;e.exports=n},function(e,t,i){function n(e,t){t=t||{},u.call(this,"div",e),this.addClassNames("Ornament"),this._charName=null,this._title=null,this._titleId=null,this._ornamentId=null,this._ornamentAssetId=null,this._guild=null,this._gender=null,this._alliance=null,this._alignment=null,this._scaleFactor=(t.scaleFactor||1)*p.PIXEL_RATIO,this.alignmentWingsWrapper=this.createChild("div",{className:"alignmentWingsWrapper"}),this._wingsTopCanvas=this.alignmentWingsWrapper.appendChild(new s),this._wingsTopCtx=this._wingsTopCanvas.getContext(),this.alignmentTailWrapper=this.createChild("div",{className:"alignmentTailWrapper"}),this._wingsBottomCanvas=this.alignmentTailWrapper.appendChild(new s),this._wingsBottomCtx=this._wingsBottomCanvas.getContext(),this._canvas=this.appendChild(new s),this._ctx=this._canvas.getContext(),this._width=this._canvas.width=400,this._height=this._canvas.height=400,this._guildEmblem=new a({width:40,height:40}),this._allianceEmblem=new a({width:40,height:40})}i(468);var o=i(31),s=i(417),a=i(469),r=i(191).inherits,l=i(471),c=i(30),u=i(235),d=i(472),h=i(202),p=i(184),m=160,f=40,g=16,_=16,v=19,y=g+"px Arial",b=_+"px Arial",w=v+"px Arial",M=10,T=5,C=40,I=10,A=C+I;r(n,u),e.exports=n,n.prototype.setAttributes=function(e){e=e||{},this._charName=e.hasOwnProperty("charName")?e.charName:null,this._guild=e.hasOwnProperty("guild")?e.guild:null,this._alliance=e.hasOwnProperty("alliance")?e.alliance:null,this._alignment=e.hasOwnProperty("alignmentInfos")?e.alignmentInfos:null,this._levelDiff=e.levelDiff,this._ornamentId=e.hasOwnProperty("ornamentId")?e.ornamentId:null,this._ornamentAssetId=e.hasOwnProperty("ornamentAssetId")?e.ornamentAssetId:null,this._title=e.hasOwnProperty("title")?e.title:null,this._titleId=e.hasOwnProperty("titleId")?e.titleId:null,this._gender=e.hasOwnProperty("gender")?e.gender:null},n.prototype.changeAttributes=function(e){e=e||{};for(var t in e)this.hasOwnProperty("_"+t)&&(this["_"+t]=e[t])},n.prototype.display=function(){var e=this,t=this._ctx;t.clearRect(0,0,this._width,this._height),this._preload(function(t){return t?console.error(t):(e._calculateDimension(),!e._ornamentAssetId||e._alignment&&0!==e._alignment.alignmentGrade?(e._resizeCanvas(e._textWidth,e._textHeight,0,0),e._displayText(),void e.emit("rendered")):(e._displayTextAndOrnament(),void e.emit("rendered")))})},n.prototype._loadOrnament=function(e){var t=this;o.series([function(e){return t._ornamentId?void c.getData("Ornaments",t._ornamentId,function(i,n){return i?e(i):n?(t._ornamentAssetId=n.assetId,void e()):e("staticContent.getData Ornaments - ornamentData is "+n)}):e()},function(e){return t._ornamentAssetId?void l.loadModel("ornaments","ornament_"+t._ornamentAssetId,function(i,n){t._jsonObj=i,t._image=n,e()}):e()}],e)},n.prototype._preload=function(e){var t=this;this._guildEmblem=new a({width:40,height:40}),this._allianceEmblem=new a({width:40,height:40}),o.parallel([function(e){t._loadOrnament(e)},function(e){return t._titleId?void c.getData("Titles",t._titleId,function(i,n){return i?e(i):n?(t._title=t._gender?n.nameFemaleId:n.nameMaleId,void e()):e("staticContent.getData Titles - titleData is "+n)}):e()},function(e){return t._guild&&t._guild.guildEmblem?void t._guildEmblem.setValue(t._guild.guildEmblem,!0,e):e()},function(e){return t._alliance&&t._alliance.allianceEmblem?void t._allianceEmblem.setValue(t._alliance.allianceEmblem,!0,e):e()}],e)},n.prototype._calculateDimension=function(){var e=this._ctx,t=[],i=0,n=0;if(e.font=b,this._nameWidth=e.measureText(this._charName).width,t.push(this._nameWidth),n=_,this._guild){var o=this._guild.guildName;e.font=y,this._guildNameWidth=e.measureText(o).width,t.push(this._guildNameWidth+2*A),t.push(this._nameWidth+2*A),n+=T+g}if(this._title){e.font=w;var s=this._title,a=e.measureText(s).width;t.push(a),n+=T+v}i=Math.max.apply(null,t)+2*M,n+=2*M,i=Math.round(i),n=Math.round(n),this._textWidth=Math.max(i,m),this._textHeight=Math.max(n,f),this._diffWidth=this._textWidth-m,this._diffHeight=this._textHeight-f},n.prototype._displayText=function(){var e=this,t=this._ctx,i=this._textWidth,n=this._textHeight;t.fillStyle="rgba(0, 0, 0, 0.8)";var o=5;t.beginPath(),t.moveTo(o,0),t.lineTo(i-o,0),t.quadraticCurveTo(i,0,i,o),t.lineTo(i,n-o),t.quadraticCurveTo(i,n,i-o,n),t.lineTo(o,n),t.quadraticCurveTo(0,n,0,n-o),t.lineTo(0,o),t.quadraticCurveTo(0,0,o,0),t.closePath(),t.fill(),t.textAlign="center";var s=Math.max(this._guildNameWidth||0,this._nameWidth),a=s+(this._guild?2*A:0),r=Math.round(s/2),l=Math.round((i-a)/2)+(this._guild?A:0),c=M;if(this._guild){var u=this._guild.guildName;t.font=y,t.fillStyle="#ffffff",c+=g,t.fillText(u,l+r,c),c+=T}if(this._charName&&(t.font=b,t.fillStyle="#ffffff",c+=_,t.fillText(this._charName,l+r,c),c+=T),this._title){t.font=w,t.fillStyle="#00B346";var p=this._title;c+=v,t.fillText(p,Math.round(i/2),c)}if(this._guild&&(t.drawImage(this._guildEmblem.getContext().canvas,l-A,M,40,40),t.drawImage(this._allianceEmblem.getContext().canvas,l+s+I,M,40,40)),this._alignment&&this._alignment.alignmentSide!==d.ALIGNMENT_NEUTRAL&&0!==this._alignment.alignmentGrade){var m=window.gui.playerData.alignment,f=20,C=this._levelDiff===-1?.6:1,S=1===this._levelDiff?f:0,E=this._alignment.alignmentSide===d.ALIGNMENT_ANGEL?"#ffffff":"#ff0018",x=function(e,t,i,n,o){var s=t.width+2*f,a=t.height+2*f,r=t.left-f,l=t.top;l+=o?-f:f,i.width=s,i.height=a,i.setStyles({left:r+"px",top:l+"px",width:s+"px",height:a+"px",opacity:C}),n.shadowBlur=S,n.shadowColor=E,n.drawImage(e,f,f)};m.getTopWings(this._alignment,function(t){h.loadImage(t.imagePath,function(i){x(i,t,e._wingsTopCanvas,e._wingsTopCtx,!0),e._wingsTopCanvas.show()})}),m.getBottomWings(this._alignment,function(t){t?h.loadImage(t.imagePath,function(i){x(i,t,e._wingsBottomCanvas,e._wingsBottomCtx,!1),e._wingsBottomCanvas.show()}):e._wingsBottomCanvas.hide()})}else e._wingsTopCanvas.hide(),e._wingsBottomCanvas.hide()},n.prototype._displayTextAndOrnament=function(){var e=this._ctx,t=this._diffWidth,i=this._diffHeight,n=this._jsonObj,o=this._image,s=Math.round(t/2),a=Math.round(i/2);for(var r in n.symbols){var l=n.symbols[r];if(l.className&&l.className.indexOf("ornament_")!==-1){this._resizeOrnament(l);for(var c=l.children.length-1;c>=0;c--){var u=l.children[c],d=u.id,h=n.symbols[d],p=u.matrices[0],g=n.matrices[p],_=g[0],v=g[1],y=g[2],b=g[3],w=g[4],M=g[5];switch(u.name){case"left":M+=a;break;case"right":w+=t,M+=a;break;case"picto":w+=s;break;case"top":w+=s;break;case"bottom":w+=s,M+=i}e.save(),e.transform(_,v,y,b,w,M);var T=isNaN(parseInt(h.sx,10))||isNaN(parseInt(h.sy,10))||isNaN(parseInt(h.sw,10))||isNaN(parseInt(h.sh,10))||isNaN(parseInt(h.x,10))||isNaN(parseInt(h.y,10))||isNaN(parseInt(h.w,10))||isNaN(parseInt(h.h,10));if(T);else if("bg"===u.name){this._displayText();var C=h.sw/h.w,I=h.sh/h.h,A=.5*m-h.x,S=.5*f-h.y,E=h.w+h.x-.5*m,x=h.h+h.y-.5*f;e.drawImage(o,h.sx,h.sy,A*C,S*I,h.x,h.y,A,S),e.drawImage(o,h.sx+A*C,h.sy,E*C,S*I,h.x+A+t,h.y,E,S),e.drawImage(o,h.sx,h.sy+S*I,A*C,x*I,h.x,h.y+S+i,A,x),e.drawImage(o,h.sx+A*C,h.sy+S*I,E*C,x*I,h.x+A+t,h.y+S+i,E,x),e.drawImage(o,h.sx+A*C,h.sy,1*C,S*I,h.x+A,h.y,t,S),e.drawImage(o,h.sx+A*C,h.sy+S*I,1*C,x*I,h.x+A,h.y+S+i,t,x),e.drawImage(o,h.sx,h.sy+S*I,A*C,1*I,h.x,h.y+S,A,i),e.drawImage(o,h.sx+A*C,h.sy+S*I,A*C,1*I,h.x+A+t,h.y+S,A,i)}else e.drawImage(o,h.sx,h.sy,h.sw,h.sh,h.x,h.y,h.w,h.h);e.restore()}}}},n.prototype._resizeCanvas=function(e,t,i,n){var o=this._ctx;this._width=e*this._scaleFactor,this._height=t*this._scaleFactor,this._canvas.width=this._width,this._canvas.height=this._height,this._cssWidth=this._width/p.PIXEL_RATIO,this._cssHeight=this._height/p.PIXEL_RATIO,this._canvas.setStyles({width:this._cssWidth+"px",height:this._cssHeight+"px"}),o.clearRect(0,0,this._width,this._height),o.scale(this._scaleFactor,this._scaleFactor),o.translate(i,n),this.emit("sizeChanged")},n.prototype._resizeOrnament=function(e){var t=1/0,i=1/0,n=-(1/0),o=-(1/0);if(e.children.length){for(var s=e.children.length-1;s>=0;s--){var a=e.children[s],r=a.id,l=this._jsonObj.symbols[r];if(l.isGraphic){var c=a.matrices[0],u=this._jsonObj.matrices[c],d=u[4]+l.x||0,h=u[5]+l.y||0;t=Math.min(t,h),i=Math.min(i,d),n=Math.max(n,d+l.w),o=Math.max(o,h+l.h)}}var p=Math.round(n-i+this._diffWidth),m=Math.round(o-t+this._diffHeight);this._resizeCanvas(p,m,-i,-t)}},n.prototype.getHeight=function(){return this._cssHeight},n.prototype.getCanvasOffsetWidth=function(){return this._canvas.rootElement.offsetWidth}},function(e,t){},function(e,t,i){function n(e){e=e||{},a.call(this,{className:"EmblemLogo"}),this.addClassNames(e.className);var t=this;this.width=e.width||100,this.height=e.height||100,this.images={crownImage:null,backgroundShape:null,symbolShape:null},this._isAnkamaSymbol=!1,this.symbolWidth=Math.round(this.width*p),this.symbolHeight=Math.round(this.height*p),this.symbolPosX=Math.round((this.width-this.symbolWidth)/2),this.symbolPosY=Math.round((this.height-this.symbolHeight)/2),this.crownWidth=Math.round(this.width*m),this.crownHeight=Math.round(this.height*m),this.crownPosX=0,this.crownPosY=0;var i=new a;i.width=this.width,i.height=this.height,this.tempCtx=i.getContext(),o(this,function(){if(t.isLeader)return r("ui.guild.right.leader")})}i(470);var o=i(248).addTooltip,s=i(202),a=i(417),r=i(29).getText,l=i(252),c=i(191).inherits,u=227,d=223,h=189,p=.5,m=.35,f=324;c(n,a),e.exports=n,n.prototype._generateEmblem=function(){var e=this.images;if(e.backgroundShape&&e.symbolShape){var t=this.getContext(),i=this.tempCtx;t.clearRect(0,0,this.width,this.height),t.drawImage(e.backgroundShape,0,0,this.width,this.height);var n,o=this.backgroundColor;if(o){var s=t.getImageData(0,0,this.width,this.height),a=s.data,r=o[0]/u,l=o[1]/d,c=o[2]/h;for(n=0;n<a.length;n+=4)a[n]*=r,a[n+1]*=l,a[n+2]*=c;t.putImageData(s,0,0)}i.clearRect(0,0,this.width,this.height),i.drawImage(e.symbolShape,this.symbolPosX,this.symbolPosY,this.symbolWidth,this.symbolHeight);var p=this.symbolColor;if(p&&!this._isAnkamaSymbol){var m=i.getImageData(0,0,this.width,this.height),f=m.data;for(n=0;n<f.length;n+=4)0!==f[n+3]&&(f[n]=p[0],f[n+1]=p[1],f[n+2]=p[2]);i.putImageData(m,0,0)}t.drawImage(i.canvas,0,0,this.width,this.height),this.isLeader&&t.drawImage(e.crownImage,this.crownPosX,this.crownPosY,this.crownWidth,this.crownHeight)}},n.prototype.setValue=function(e,t,i){var n=this,o=[],a=[];if(t=t||e.dec2rgb,e.hasOwnProperty("guild")&&(t=!0,this.isLeader=e.guild.allianceLeader,e=e.guild.guildEmblem),e.hasOwnProperty("backgroundColor")&&(this.backgroundColor=t?l.hexToRgb((+e.backgroundColor).toString(16)):e.backgroundColor),e.hasOwnProperty("backgroundShape")){var r="gfx/emblems/icons/"+(e.isAlliance?"backalliance":"back")+"/"+e.backgroundShape+".png";o.push(r),a.push("backgroundShape")}if(e.hasOwnProperty("symbolShape")){this._isAnkamaSymbol=e.symbolShape===f;var c="gfx/emblems/icons/up/"+e.symbolShape+".png";o.push(c),a.push("symbolShape")}e.hasOwnProperty("symbolColor")&&(this.symbolColor=t?l.hexToRgb((+e.symbolColor).toString(16)):e.symbolColor),this.isLeader&&!this.images.crownImage&&(o.push("ui/tx_crown.png"),a.push("crownImage")),s.loadImages(o,null,function(e){if(n&&n.rootElement){for(var t=0;t<a.length;t+=1)n.images[a[t]]=e[t];if(n._generateEmblem(),"function"==typeof i)return i()}else if("function"==typeof i)return i()})}},function(e,t){},function(e,t,i){var n=i(184),o=i(202),s=i(252),a={skin:n.SKIN_PATH,bone:n.BONE_PATH,icon:n.ICON_PATH,bitmapFonts:n.BITMAP_FONTS,ornaments:n.ORNAMENT_PATH,embedded:n.EMBEDDED_PATH};t.loadModel=function(e,t,i,n,r,l){function c(e){if(h=e,s.jeffVersionDowngrader(h),_+=1,_===v)return i&&i(h,d)}function u(e){if(d=n?n.createTexture(e,f,r,l):e,_+=1,_===v)return i&&i(h,d)}var d,h,p,m=a[e]+t,f=m+".png",g=m+".json",_=0,v=1;n?(d=n.holdTexture(f),d?p=!1:(p=!0,v+=1)):(p=!0,v+=1),o.loadJson(g,c),p!==!1&&o.loadImage(f,u)}},function(e,t){e.exports={ALIGNMENT_UNKNOWN:-2,ALIGNMENT_WITHOUT:-1,ALIGNMENT_NEUTRAL:0,ALIGNMENT_ANGEL:1,ALIGNMENT_EVIL:2,ALIGNMENT_MERCENARY:3}},function(e,t,i){function n(e){a.call(this,"div",e),this.addClassNames("PropertyInfo"),this._guild=null,this._guildEmblem=new o({width:40,height:40}),this._emblemContainer=this.createChild("div",{className:"emblemContainer"}),this._emblemContainer.appendChild(this._guildEmblem),this._infoContainer=this.createChild("div",{className:"infoContainer"})}i(474);var o=i(469),s=i(191).inherits,a=i(235);s(n,a),e.exports=n,n.prototype._preload=function(e){return this._guild&&this._guild.guildEmblem?this._guildEmblem.setValue(this._guild.guildEmblem,!0,e):e(null,null)},n.prototype.display=function(e){var t=this;e=e||{},this._guild=e.hasOwnProperty("guild")?e.guild:null,this._emblemContainer.hide(),this._infoContainer.clearContent(),this._preload(function(i){return i?console.error("PropertyInfo preload",i):(t._display(e.line1,e.line2),void t.emit("rendered"))})},n.prototype._display=function(e,t){this._guild&&this._guild.guildEmblem&&(this._infoContainer.createChild("div",{text:this._guild.guildName,className:"guildName"}),this._emblemContainer.show()),this._infoContainer.createChild("div",{text:e,className:"line1"}),t&&this._infoContainer.createChild("div",{text:t,className:"line2"})}},function(e,t){},function(e,t,i){var n=i(382);n.prototype._setupBorderArrow=function(){this._borderArrow=this.createChild("div",{className:"BorderArrow"})},n.prototype.showBorderArrow=function(e,t,i){switch(e){case"top":case"bottom":this._borderArrow.setStyles({left:t+"px",top:""});break;case"left":case"right":this._borderArrow.setStyles({top:i+"px",left:""})}this._borderArrow.setClassNames(["BorderArrow",e]),this._borderArrow.show()},n.prototype.hideBorderArrow=function(){this._borderArrow.hide()}},function(e,t,i){function n(){a.call(this),this.windowsContainer=null,this.playerData=new V,this.serversData=new ee,this.boxArranger=new g,this.isConnected=!1,this.wBody=Re,Re.allowDomEvents(),this.on("IdentificationSuccessMessage",this.onIdentificationSuccess),this.on("IdentificationSuccessWithLoginTokenMessage",this.onIdentificationSuccess),this.on("ServersListMessage",this.onServerListReceived),this.on("CurrentMapMessage",this.onCurrentMapMessage),P.initialize(this),this.setupAppTransition()}i(477);var o=i(31),s=i(191).inherits,a=i(209).EventEmitter,r=i(235),l=i(257),c=i(228),u=i(28),d=i(478),h=(i(642),i(185)),p=i(643),m=i(183),f=i(630),g=i(655),_=i(656),v=i(661),y=i(664),b=i(708),w=i(710),M=i(713),T=i(715),C=i(383),I=i(394),A=i(716),S=i(523),E=i(190),x=i(29),L=x.getText,N=i(720),O=i(526),D=i(726),R=i(509),P=i(230),B=i(459),k=i(728),F=i(282),z=i(738),H=i(740),q=i(746),W=i(760),U=i(763),Y=i(764),G=i(766),j=i(768),V=i(770),X=i(650),Q=i(806),K=i(809),J=i(811),Z=i(813),$=i(824),ee=i(730),te=i(825),ie=i(842),ne=i(844),oe=i(203),se=i(853),ae=i(855),re=i(718),le=i(248),ce=i(195),ue=i(860),de=i(865),he=i(866),pe=i(868),me=i(225),fe=i(482),ge=i(873),_e=i(899),ve=i(901),ye=i(805),be=i(902),we=i(1299),Me=i(1301),Te=i(1322),Ce=i(1324),Ie=i(1327),Ae=i(1329),Se=i(1331),Ee=i(1333),xe=i(1336),Le=i(1338),Ne=i(1340),Oe=i(907),De=i(1342),Re=new r(document.getElementById("dofusBody"));c.initialize(Re),h.isIOS&&!h.isPhoneGap&&i(1344),s(n,a),e.exports=n,n.prototype.setupAppTransition=function(){function e(){n.emit("appGoBackground")}function t(){n.emit("appLeaveBackground"),o&&(window.dofus.sendMessage("BasicPingMessage",{quiet:!0}),s=!0)}var i=window.dofus.connectionManager,n=this,o=!1,s=!1;i.on("open",function(){o=!0}),i.on("disconnect",function(){o=!1,s=!1}),i.on("BasicPongMessage",function(){s&&(n.emit("connectedAfterAppLeaveBackground"),s=!1)}),h.isIOSApp?(document.addEventListener("pause",e,!1),document.addEventListener("resume",t,!1)):document.addEventListener("visibilitychange",function(i){i.target.hidden?e():t()},!1)},n.prototype.transmitMessage=function(e){switch(e._messageType){case"MapComplementaryInformationsDataMessage":case"MapComplementaryInformationsWithCoordsMessage":case"MapComplementaryInformationsDataInHouseMessage":case"MapComplementaryInformationsWithObstacleOverride":this.emit("mapComplementaryInformationsData",e);break;default:this.emit(e._messageType,e)}},n.prototype.transmitFightSequenceMessage=function(e){this.fightManager.processFightSequenceMessage(e)},n.prototype.initialize=function(e){function t(){if(window.gui.isConnected){var e=me.getLastFocusedWindowId();e?me.isModalWindow(e)||me.close(e):me["switch"]("global")}else window.gui.loginScreen.isVisible()?navigator.app.exitApp():window.dofus.disconnect()}this.loginScreen||(d.initialize(Re,Re),this._createUiForLogin()),e&&(console.debug("Gui.initialize:",e),document.addEventListener("backbutton",t,!1))},n.prototype.initializeAfterLogin=function(e){if(this.initialized)return e();oe.initialize(this),this.fightManager=new I,this.tutorialManager=new ue,this.shieldTutorialManager=new de,this.playerData.initialize(this),this.serversData.initialize(this),this.fightManager.initialize(this),this.tutorialManager.initialize(this),this.shieldTutorialManager.initialize(this),this.boxArranger.initialize(),this.GPS=new N,this.pingSystem=new Z,this.gifts=new $,this.npcDialogHandler=new U,this.uiLocker=new ve,X.initialize(),O.initialize(this),f.initialize(this),u.initialize(this),S.initialize(this),he.initialize(this),w.initialize(this),v.initialize(this),ge.initialize(),Q.initialize(),_e.initialize(),ye.initialize(window.wizPurchase),p.initialize();var t=this;o.series([T.load,B.initialize,R.initialize],function(i){return i?e(i):(t._initUserInterface(),t._initAutoResize(),t.initialized=!0,t.emit("initialized"),void e())})},n.prototype.onServerListReceived=function(e){this.initialized?this.serversData.onServerList(e):this.once("initialized",function(){this.serversData.onServerList(e)})},n.prototype._createUiForLogin=function(){me.initialize(this),Re.setStyles({width:m.dimensions.screenWidth+"px",height:m.dimensions.screenHeight+"px"}),this.loginScreen=Re.appendChild(new Me),this.splashScreen=Re.appendChild(new Te),this.connectionSplashScreen=Re.appendChild(new we),this.windowsContainer=new r("div",{className:"windowsContainer"}),Re.appendChild(this.windowsContainer),me.addWindow("connectionQueue",new Le,{fixed:!0}),me.addWindow("popup",new Ne),me.addWindow("confirm",new Oe),me.addWindow("nickname",new Ce,{fixed:!0}),me.addWindow("register",new Ie,{fixed:!0}),me.addWindow("birthdayLimit",new Ae,{fixed:!0}),me.addWindow("legalAgreement",new Se),me.addWindow("preloadMap",new Ee),me.addWindow("cleanAssets",new xe),me.addWindow("recaptcha",new De),l.initialize(Re),this.dropDown=Re.appendChild(new se),this.tooltipBox=Re.appendChild(le.initialiseTooltipBehavior(Re))},n.prototype._addWindows=function(){be()},n.prototype._initUserInterface=function(){this.gameGuiContainer=new r("div",{className:"gameGuiContainer",hidden:!0}),Re.appendChild(this.gameGuiContainer),this.sidebarBackground=this.gameGuiContainer.createChild("div",{className:"blackStripe"}),this.mapBorder1=this.gameGuiContainer.createChild("div",{className:"mapBorder"}),this.mapBorder2=this.gameGuiContainer.createChild("div",{className:["mapBorder","flipped"]}),this.screenLeftover=this.gameGuiContainer.createChild("div",{className:"blackStripe"}),this.gameGuiContainer.appendChild(window.foreground),this.numberInputPad=this.gameGuiContainer.appendChild(new G),this._addWindows(),this.chat=this.gameGuiContainer.appendChild(new y),this.chatButton=this.gameGuiContainer.appendChild(new b),this.mainControls=this.gameGuiContainer.appendChild(new q),this.shortcutBar=this.gameGuiContainer.appendChild(new te),this.menuBar=this.gameGuiContainer.appendChild(new H),this.textNotification=this.gameGuiContainer.appendChild(new M),this.roleplayBuffs=this.gameGuiContainer.appendChild(new pe(this.playerData.inventory)),this.timeline=this.gameGuiContainer.appendChild(new ne),this.progressGauge=this.shortcutBar.appendChild(new K),this.compass=this.gameGuiContainer.appendChild(new ae),this.hintArrow=this.gameGuiContainer.appendChild(new re),this.kohBox=this.windowsContainer.appendChild(new k),this.party=this.gameGuiContainer.appendChild(new j),this.challengeIndicator=this.gameGuiContainer.appendChild(new _),this.rewardsIndicator=this.gameGuiContainer.appendChild(new J),this.npcDialogUi=this.gameGuiContainer.appendChild(new Y),this.notificationBar=this.gameGuiContainer.appendChild(new W),this.mapCoordinateDisplay=this.gameGuiContainer.appendChild(new z),this.houseMenuButton=this.gameGuiContainer.appendChild(new D),this.shopFloatingToolbar=this.gameGuiContainer.appendChild(new A),C.init(this.gameGuiContainer)},n.prototype.onCurrentMapMessage=function(){window.foreground.hideBorderArrow()},n.prototype.openContextualMenu=function(e,t,i){i=i||{};var n=i.x,o=i.y;if(i.isCanvasCoordinate){var s=window.foreground.convertCanvasToScreenCoordinate(n,o);n=s.x,o=s.y}d.openAt(e,n,o,t)},
n.prototype.openContextualMenuAround=function(e,t,i){d.openAround(e,t,i)},n.prototype.closeContextualMenu=function(e){d.close(e)},n.prototype.showHintArrow=function(e,t){this.hintArrow.showArrow(e,t)},n.prototype.hideHintArrow=function(){this.hintArrow.hideArrow()},n.prototype.newSpeechBubble=function(e){return new ie(e)},n.prototype.disconnect=function(e){this.isConnected=!1,"SOCKET_LOST"!==e&&"ASSET_MISSING"!==e||this.expectedDisconnectionReason||(console.warn("[Gui] disconnected:",e),this.openSimplePopup(L("ui.popup.connectionFailed.text"))),this._shutDownUI(),this.emit("disconnect",e),this.playerData.disconnectModules()},n.prototype.connectionGonnaBeClosed=function(e){this.expectedDisconnectionReason=e;var t=this;window.setTimeout(function(){t.expectedDisconnectionReason=null},6e4)},n.prototype._shutDownUI=function(){this.splashScreen.show(),F.backToLogin(),ce.close(),me.closeAll(),this.gameGuiContainer&&this.gameGuiContainer.hide(),this.houseMenuButton&&this.houseMenuButton.hide(),this.tooltipBox&&this.tooltipBox.closeTooltip(),this.kohBox&&this.kohBox.hide()},n.prototype.onIdentificationSuccess=function(){this.loginScreen.hide(),this.splashScreen.show()},n.prototype.onConnect=function(e){this.isConnected=!0,E.initialize(this),this.gameGuiContainer.show(),this._resizeUi(),this.playerData.connectModules(e,this.fightManager.isInReconnection),window.gui.emit("connected",this.fightManager.isInReconnection)},n.prototype.openPopup=function(e){me.getWindow("popup").addContent(e),me.open("popup")},n.prototype.openSimplePopup=function(e,t){this.openPopup({title:t||L("ui.common.error"),message:e})},n.prototype.openConfirmPopup=function(e,t){me.getWindow("confirm").update(e),me.open("confirm",t)},n.prototype.openCancelPopup=function(e){me.getWindow("cancel").update(e),me.open("cancel")},n.prototype._resizeUi=function(e){void 0===e&&(e=window.gui.playerData.isFighting),h.isDevice?Re.replaceClassNames(["no-touch"],["touch"]):Re.replaceClassNames(["touch"],["no-touch"]),m.updateScreen();var t=m.dimensions;Re.setStyles({width:t.screenWidth+"px",height:t.screenHeight+"px"});var i=t.screenWidth/t.screenHeight;i<=1.5?(this.ipadRatio=!0,Re.replaceClassNames(["largeRatio"],["ipadRatio"]),m.resizeNarrowScreen(e),this.sidebarBackground.setStyles({left:0,top:t.mapBottom-1+"px",width:t.screenWidth+"px",height:t.screenHeight-t.mapBottom+1+"px"}),this.mapBorder1.addClassNames("vertical"),this.mapBorder1.setStyles({left:0,top:0,width:t.mapLeft+"px",height:t.mapHeight+"px"}),this.mapBorder2.addClassNames("vertical"),this.mapBorder2.setStyles({left:t.mapRight+"px",top:0,width:t.screenWidth-t.mapRight+"px",height:t.mapHeight+"px"}),this.screenLeftover.setStyles({left:0,top:0,width:t.screenWidth+"px",height:t.mapTop+"px"})):(this.ipadRatio=!1,Re.replaceClassNames(["ipadRatio"],["largeRatio"]),m.resizeWideScreen(e),this.sidebarBackground.setStyles({left:t.mapRight+"px",top:0,width:t.screenWidth-t.mapRight+"px",height:t.screenHeight+"px"}),this.mapBorder1.delClassNames("vertical"),this.mapBorder1.setStyles({left:t.mapLeft+"px",top:0,width:t.mapWidth+"px",height:t.mapTop+"px"}),this.mapBorder2.delClassNames("vertical"),this.mapBorder2.setStyles({left:t.mapLeft+"px",top:t.mapBottom-1+"px",width:t.mapWidth+"px",height:t.screenHeight-t.mapBottom+1+"px"}),this.screenLeftover.setStyles({left:0,top:0,width:t.mapLeft+"px",height:t.screenHeight+"px"})),window.isoEngine.updateDimensions(t),this.emit("resize",t)},n.prototype._initAutoResize=function(){function e(){clearTimeout(t),t=setTimeout(function(){i._resizeUi()},250)}fe.hide(),this._resizeUi();var t,i=this;h.isDevice||(window.addEventListener("scroll",e),window.addEventListener("resize",e)),this.fightManager.on("fightEnterPreparation",function(){i._resizeUi()}),this.fightManager.on("fightEnterBattle",function(e){"PREPARATION_SKIPPED"===e&&i._resizeUi()}),this.fightManager.on("fightEnd",function(){i._resizeUi()}),E.on("menubarSize",this.resizeToolbarForRoleplay.bind(this)),E.on("menubarSizeInFight",this.resizeToolbarForFight.bind(this)),E.on("toolbarThicknessInFight",this.resizeToolbarForFight.bind(this))},n.prototype._resizeToolbar=function(e){var t=window.gui.playerData.isFighting;e===t&&this._resizeUi(t)},n.prototype.resizeToolbarForFight=function(){this._resizeToolbar(!0)},n.prototype.resizeToolbarForRoleplay=function(){this._resizeToolbar(!1)},n.prototype.showFightingToolbar=function(e){this._resizeUi(e)},n.prototype.getBuildVersion=function(){var e=window.appInfo&&window.appInfo.version,t=window.buildVersion,i=[];return e&&i.push("Client v"+e),t&&i.push("Build v"+t),i.join("/")}},function(e,t){},function(e,t,i){function n(){a=!0}function o(e){p=null,u="clickAway"===e}function s(e,t){e=e||"generic";var i=h[e];return i?t&&u?(r=null,l=c=-1,!1):(p=i,!0):(console.error('Contextual menu "'+e+'" does not exist.'),!1)}var a,r,l,c,u,d=i(229).getPosition,h={admin:i(479),emote:i(486),fightTeam:i(487),generic:i(489),interactive:i(490),item:i(495),map:i(613),merchant:i(616),monster:i(617),npc:i(619),offlinePlayer:i(620),paddockObject:i(621),partyOptions:i(622),player:i(624),preset:i(628),prism:i(629),smiley:i(632),spell:i(633),spellUpgrade:i(634),storage:i(636),taxCollector:i(637),userStatus:i(638),playersList:i(641)},p=null,m={x:0,y:0};t.getContextMenu=function(e){return h[e]},t.initialize=function(e,t){t.on("dom.touchstart",function(e){return m=d(e),p?void(a?a=!1:p.close("clickAway")):void(u=!1)});for(var i in h){var s=h[i],r=h[i]=e.appendChild(new s);r.allowDomEvents(),r.on("dom.touchstart",n),r.on("close",o)}},t.openAt=function(e,t,i,n){s(e,Math.abs(l-t)<5&&Math.abs(c-i)<5)&&(l=t,c=i,t=void 0===t?m.x:t,i=void 0===i?m.y:i,p.openAt(t,i,n))},t.openAround=function(e,t,i){s(e,t===r)&&(r=t,p.openAround(t,i))},t.close=function(e){p&&p.close(e)}},function(e,t,i){function n(){r.call(this,{className:"ContextualMenuAdmin"});var e=this;e.targetPlayer=null,e.adminData=null,e.curItems=null,e.prevItems=[],this.once("open",function(){e.container=e.entryList.appendChild(new l("div")),e._addCancel()}),this.on("open",function(t,i){e.targetPlayer=t,e.updateContent(i)}),this.on("close",function(){e.container.clearContent(),e.targetPlayer=null,e.adminData=null,e.curItems=null,e.prevItems=[]})}function o(e){if(e.status<400||e.status>599)return e;var t=new Error(e.statusText);throw t.response=e,t}function s(e){return e.json().then(function(t){if(t._statusCode||e.status>599)throw t;return t})}var a=i(191).inherits,r=i(480),l=i(235),c=i(246),u=i(225);a(n,r),e.exports=n,n.prototype.replaceSymbols=function(e){var t=window.gui.playerData.characterBaseInformations.name,i=this.targetPlayer.name,n=e.replace(/%n/gi,t);return n=n.replace(/%p/gi,i)},n.prototype._addStartup=function(e){console.debug(e)},n.prototype._addStatic=function(e){var t=this.replaceSymbols(e.label);this.container.appendChild(new l("div",{text:t,className:"contextHeader"}))},n.prototype._addMenu=function(e){function t(){e.label&&i.prevItems.push(i.curItems),i._addItems(e.item)}var i=this,n=this.replaceSymbols(e.label||"");n+=" >",this.container.appendChild(new c({text:n,className:"cmButton"},t))},n.prototype._addSendCommand=function(e){function t(){var e=u.getWindow("adminConsole");u.open("adminConsole"),e.runCommand(o),i.close()}var i=this,n=this.replaceSymbols(e.label),o=this.replaceSymbols(e.command);this.container.appendChild(new c({text:n,className:"cmButton"},t))},n.prototype._addPrepareCommand=function(e){function t(){var e=u.getWindow("adminConsole");u.open("adminConsole"),e.cmdInput.setValue(o),i.close()}var i=this,n=this.replaceSymbols(e.label),o=this.replaceSymbols(e.command);this.targetPlayer.houseId&&(o=o.replace("IDHOUSE",this.targetPlayer.houseId)),this.container.appendChild(new c({text:n,className:"cmButton"},t))},n.prototype._addBatch=function(e){function t(){var t,n=u.getWindow("adminConsole"),o=e.item;u.open("adminConsole");for(var s=0;s<o.length;s+=1)t=i.replaceSymbols(o[s].command),n.runCommand(t);i.close()}var i=this,n=e.label;this.container.appendChild(new c({text:n,className:"cmButton"},t))},n.prototype._addItem=function(e){var t=e.type;switch(t){case"startup":this._addStartup(e);break;case"static":this._addStatic(e);break;case"menu":this._addMenu(e);break;case"sendCommand":this._addSendCommand(e);break;case"prepareCommand":this._addPrepareCommand(e);break;case"batch":this._addBatch(e)}},n.prototype._addItems=function(e){var t=this;e&&!Array.isArray(e)&&(e=[e]),t.curItems=e,this.container.clearContent();for(var i,n=0;n<e.length;n+=1)i=e[n],this._addItem(i);this.prevItems.length&&this.container.appendChild(new c({text:"< Back",className:"cmButton"},function(){var e=t.prevItems.pop();t._addItems(e)})),this.scroller.refresh()},n.prototype.updateContent=function(e){var t=this,i=window.gui.playerData.adminMenu.getURL(),n=window.gui.playerData.adminMenu.getAdminMenuId();if(!i||null===n)return this.close(),e();var a=i+n+".json";window.fetch(a).then(o).then(s).then(function(i){return t.adminData=i,t._addItems(i.menu.item),e()})["catch"](function(i){return console.error(i+" when fetching menuUrl: "+a),t.close(),e()})}},function(e,t,i){function n(e){p.call(this,"div",{className:"ContextualMenu",hidden:!0}),e=e||{},this.addClassNames(e.className),this._position={},this.header=this.createChild("div",{className:"contextHeader"}),e.noHeader&&this._displayHeader(!1),this.entryContainer=this.createChild("div",{className:"entryContainer"}),this.scroller=this.entryContainer.appendChild(new u({className:"entryList"},{showHintArrows:!0})),this.entryList=this.scroller.content,this.maxHeight=s.screenHeight-2*m-(e.noHeader?0:f),this.requestedHeight=this.maxHeight,this.currentHeight=0;var t=this;l.on("show",function(e){t._refreshScroller(t.maxHeight-e)}),l.on("hide",function(){t._refreshScroller(t.maxHeight)})}i(481);var o=i(246),s=i(183).dimensions,a=i(29).getText,r=i(250),l=i(482),c=i(191).inherits,u=i(483),d=i(229).position,h=i(227),p=i(235),m=10,f=40;c(n,p),e.exports=n,n.prototype._refreshScroller=function(e){if(void 0!==e){if(this.requestedHeight=e,!this.isOpen&&!this.isOpening)return;if(this.requestedHeight===this.currentHeight)return}this.currentHeight=this.requestedHeight,this.scroller.setStyle("maxHeight",this.currentHeight+"px"),void 0===e&&this.scroller.goToTop(),this.scroller.refresh()},n.prototype._displayHeader=function(e){this.toggleClassName("noHeader",!e),this.header.toggleDisplay(e)},n.prototype._setPosition=function(e,t){this._position.x=d.x,this._position.y=d.y,this.setStyles({left:e+"px",top:t+25+"px"})},n.prototype._addEntry=function(e,t){var i=this,n=this.entryList.appendChild(new o({text:e,className:"cmButton"},t));return n.on("tap",function(){i.close()}),n},n.prototype._addCancel=function(){return this._addSeparator(),this._addEntry(a("ui.common.cancel"),function(){})},n.prototype._addSeparator=function(){this.entryList.createChild("div",{className:"separator"})},n.prototype._openingAnimation=function(e,t){function i(){n._tween1=h.tween(n,{webkitTransform:"translate3d(0,-25px,0)",opacity:1},{time:100,easing:"ease-out"},function(){n._tween1=null}),n._tween2=h.tween(n.entryList,{webkitTransform:"translate3d(0,0,0)"},{time:200,easing:"cubic-bezier(0,1,0.62,1)"},function(){this.setStyle("webkitTransform",""),n._tween2=null,n.isOpening=!1,n._tween=null,n.isOpen=!0,n.closeRequest&&(n.closeRequest=null,n.close("reopen"))})}if(!this.isOpening){if(this.isOpen)return this.close(),void(this.next={positioningMethod:e,params:t});if(e()){this.isOpening=!0,this._tween1&&this._tween1.cancel(),this._tween2&&this._tween2.cancel(),this.show(),this.entryContainer.setStyle("overflow","visible"),this.entryList.setStyle("webkitTransform","translate3d(0,-100%,0)");var n=this;this.emit("open",t,function(){n._refreshScroller();var t=e();n._setPosition(t.x,t.y),n.entryContainer.setStyle("overflow","hidden"),window.setTimeout(i,0)})}}},n.prototype.openAt=function(e,t,i){var n=this;this._openingAnimation(function(){return r.getElementPositionAt(n,e,t)},i)},n.prototype.openAround=function(e,t){var i=this;this._openingAnimation(function(){return i.rootElement&&e.rootElement?r.getElementPositionAround(i,e):null},t)},n.prototype.close=function(e){if(this.isOpening)return void(this.closeRequest=!0);if(!this.isClosing&&this.isOpen){this.isClosing=!0,this._tween1&&this._tween1.cancel(),this._tween2&&this._tween2.cancel();var t=this;this.emit("close",e),this._tween1=h.tween(this.entryList,{webkitTransform:"translate3d(0,-100%,0)"},{time:200,easing:"ease-out"},function(){t._tween1=null,t.isClosing=!1,t.isOpen=!1,t.next&&(t._openingAnimation(t.next.positioningMethod,t.next.params),t.next=null)}),this._tween2=h.tween(this,{webkitTransform:"translate3d(0,0,0)",opacity:0},{delay:100,time:100,easing:"ease-out"},function(){t.hide(),t._tween2=null})}}},function(e,t){},function(e,t,i){function n(){window.navigationbar&&window.navigationbar.hideNavigationBar()}var o=i(185),s=i(209),a=window.cordova,r=i(229),l=r.events,c=new s;e.exports=c;var u=!0;c.show=function(){o.isPhoneGap&&a.plugins.Keyboard.show()},c.hide=function(){"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),o.isPhoneGap&&a.plugins.Keyboard.close(),n()},c.disableScroll=function(e){o.isPhoneGap&&a.plugins.Keyboard.disableScroll(e)},c.hideKeyboardAccessoryBar=function(e){o.isPhoneGap&&a.plugins.Keyboard.hideKeyboardAccessoryBar(e)},c.setAutomaticHide=function(e){u=!!e},document.body.addEventListener(l.end,function(e){"INPUT"===document.activeElement.tagName&&"INPUT"!==e.target.tagName&&u&&c.hide()},!1),o.isPhoneGap&&(window.addEventListener("native.keyboardshow",function(e){c.emit("show",e.keyboardHeight)}),window.addEventListener("native.keyboardhide",function(){var e="INPUT"===document.activeElement.tagName&&document.activeElement;setTimeout(function(){n();var t="INPUT"===document.activeElement.tagName;t&&e!==document.activeElement||(c.emit("hide"),e&&document.activeElement.blur())},0)}))},function(e,t,i){function n(e,t){m.call(this,"div",e),this.addClassNames("Scroller"),t=t||{};var i=!!t.isHorizontal,n=i?["scrollerContent","horizontal"]:"scrollerContent",o=u.isFeatureOn("scrollerBoundToWrapper");this.content=this.createChild("div",{className:n});var s;o&&(s=i?"vertical":"horizontal"),this.iScroll=new h(this.rootElement,{bindToWrapper:o,scrollbars:"custom",fadeScrollbars:!1,bounce:t.bounce,maxSpeed:t.maxSpeed,eventPassthrough:s,scrollX:i,scrollY:!i,mouseWheel:!0,preventDefault:!1,directionLockThreshold:f,disablePointer:!0}),this.iScroll.myScroller=this,this.on("destroy",this._destroyHandler),t.showHintArrows&&(this.scrollUpHint=this.createChild("div",{className:"scrollUpHint"}),this.scrollDownHint=this.createChild("div",{className:"scrollDownHint"}),this.notifyInterval=null,this.notifyCount=0),this.isEnable=!0,this._isListeningToLostHandle=!1,this._onLostHandle=null;var a=this;window.setTimeout(function(){a.refresh()},y),this._setupEventListeners()}function o(){var e=this.myScroller;return d.requestInteractionHandle("SCROLL",e)?(e.scrollUpHint&&(e.scrollUpHint.hide(),e.scrollDownHint.hide()),void e.emit("scrollStart")):e.cancel()}function s(){var e=this.myScroller;e._refreshHints(),e.emit("scrollEnd")}function a(){this.myScroller.emit("scrollCancel")}function r(e){e!==this&&this.cancel()}function l(){this.requestRefresh&&this.refresh(!0),this._isListeningToLostHandle||(this._isListeningToLostHandle=!0,this._onLostHandle=this._onLostHandle||r.bind(this),d.once("handleTaken",this._onLostHandle))}function c(){d.removeListener("handleTaken",this._onLostHandle),this._isListeningToLostHandle=!1,this.isEnable&&this.iScroll.enable()}i(484);var u=i(211),d=i(231),h=i(485),p=i(191).inherits,m=i(235),f=10,g=17,_=200,v=8,y=200;p(n,m),n.ease=h.utils.ease,n.prototype._destroyHandler=function(){window.clearInterval(this.notifyInterval),this.iScroll.destroy()},n.prototype._setupEventListeners=function(){this.allowDomEvents(),this.on("dom.touchstart",l),this.on("dom.touchend",c),this.iScroll.on("scrollStart",o),this.iScroll.on("scrollEnd",s),this.iScroll.on("scrollCancel",a)},n.prototype._refreshHints=function(){this.scrollUpHint&&(this.scrollUpHint.toggleDisplay(this.canScrollUp(g)),this.scrollDownHint.toggleDisplay(this.canScrollDown(g)))},n.prototype.cancel=function(){return u.isFeatureOn("scrollerBoundToWrapper")?void this.iScroll.cancel():void this.iScroll.disable()},n.prototype.refresh=function(e){if(this.rootElement){if(!e&&0===this.rootElement.clientHeight)return void(this.requestRefresh=!0);this.iScroll.refresh(),this.toggleClassName("scrollBgVisible",this.iScroll.hasVerticalScroll||this.iScroll.hasHorizontalScroll),this._refreshHints(),this.requestRefresh=!1}},n.prototype.notify=function(){if(this.scrollUpHint&&this.canScrollDown()&&(this.notifyCount=v,!this.notifyInterval)){var e=this;this.notifyInterval=window.setInterval(function(){e.scrollDownHint.toggleDisplay(),e.notifyCount--,e.notifyCount>0||(window.clearInterval(e.notifyInterval),e.notifyInterval=null,e._refreshHints())},_)}},n.prototype.scrollToElement=function(e,t,i,n,o){this.iScroll.scrollToElement(e.rootElement,t,i,n,o),t||this._refreshHints()},n.prototype.showElement=function(e,t,i){var n=this.iScroll,o=e.rootElement;o=o.nodeType?o:n.scroller.querySelector(o);var s=h.utils.offset(o);s.left-=n.wrapperOffset.left,s.top-=n.wrapperOffset.top;var a=o.offsetHeight,r=o.offsetWidth;s.top<n.y&&a<=n.wrapperHeight&&(s.top=Math.min(s.top-a+n.wrapperHeight,n.y)),s.left<n.x&&r<=n.wrapperWidth&&(s.left=Math.min(s.left-r+n.wrapperWidth,n.x)),s.left=Math.min(0,Math.max(n.maxScrollX,s.left)),s.top=Math.min(0,Math.max(n.maxScrollY,s.top)),s.left===n.x&&s.top===n.y||(t=void 0===t||null===t||"auto"===t?Math.max(Math.abs(n.x-s.left),Math.abs(n.y-s.top)):t,this.scrollTo(s.left,s.top,t,i))},n.prototype.scrollTo=function(e,t,i,n){this.iScroll.scrollTo(e,t,i,n),i||this._refreshHints()},n.prototype.scrollBy=function(e,t,i,n){this.iScroll.scrollBy(e,t,i,n),i||this._refreshHints()},n.prototype.setEnable=function(e){e?this.iScroll.enable():this.iScroll.disable(),this.isEnable=e},n.prototype.canScrollUp=function(e){return e=e||1,this.iScroll.options.scrollY?this.iScroll.y<=-e:this.iScroll.x<=-e},n.prototype.canScrollDown=function(e){return e=e||1,this.iScroll.options.scrollY?this.iScroll.maxScrollY-this.iScroll.y<=-e:this.iScroll.maxScrollX-this.iScroll.x<=-e},n.prototype.goToTop=function(e,t){return this.iScroll.options.scrollY?this.scrollTo(this.iScroll.x,0,e,t):void this.scrollTo(0,this.iScroll.y,e,t)},n.prototype.goToBottom=function(e,t){return this.iScroll.options.scrollY?this.scrollTo(this.iScroll.x,this.iScroll.maxScrollY,e,t):void this.scrollTo(this.iScroll.maxScrollX,this.iScroll.y,e,t)},n.prototype.getScrollPosition=function(){return{x:this.iScroll.x,y:this.iScroll.y}},e.exports=n},function(e,t){},function(e,t){/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
!function(t,i,n){function o(e,t){this.wrapper="string"==typeof e?i.querySelector(e):e,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var n in t)this.options[n]=t[n];this.translateZ=this.options.HWCompositing&&l.hasPerspective?" translateZ(0)":"",this.options.useTransition=l.hasTransition&&this.options.useTransition,this.options.useTransform=l.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"!=this.options.eventPassthrough&&this.options.scrollY,this.options.scrollX="horizontal"!=this.options.eventPassthrough&&this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?l.ease[this.options.bounceEasing]||l.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function s(e,t,n){var o=i.createElement("div"),s=i.createElement("div");return n===!0&&(o.style.cssText="position:absolute;z-index:9999",s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),s.className="iScrollIndicator","h"==e?(n===!0&&(o.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",s.style.height="100%"),o.className="iScrollHorizontalScrollbar"):(n===!0&&(o.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",s.style.width="100%"),o.className="iScrollVerticalScrollbar"),o.style.cssText+=";overflow:hidden",t||(o.style.pointerEvents="none"),o.appendChild(s),o}function a(e,n){this.wrapper="string"==typeof n.el?i.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=e,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var o in n)this.options[o]=n[o];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(l.addEvent(this.indicator,"touchstart",this),l.addEvent(t,"touchend",this)),this.options.disablePointer||(l.addEvent(this.indicator,l.prefixPointerEvent("pointerdown"),this),l.addEvent(t,l.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(l.addEvent(this.indicator,"mousedown",this),l.addEvent(t,"mouseup",this))),this.options.fade&&(this.wrapperStyle[l.style.transform]=this.scroller.translateZ,this.wrapperStyle[l.style.transitionDuration]=l.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var r=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)},l=function(){function e(e){return a!==!1&&(""===a?e:a+e.charAt(0).toUpperCase()+e.substr(1))}var o={},s=i.createElement("div").style,a=function(){for(var e,t=["t","webkitT","MozT","msT","OT"],i=0,n=t.length;i<n;i++)if(e=t[i]+"ransform",e in s)return t[i].substr(0,t[i].length-1);return!1}();o.getTime=Date.now||function(){return(new Date).getTime()},o.extend=function(e,t){for(var i in t)e[i]=t[i]},o.addEvent=function(e,t,i,n){e.addEventListener(t,i,!!n)},o.removeEvent=function(e,t,i,n){e.removeEventListener(t,i,!!n)},o.prefixPointerEvent=function(e){return t.MSPointerEvent?"MSPointer"+e.charAt(9).toUpperCase()+e.substr(10):e},o.momentum=function(e,t,i,o,s,a,r){var l,c,u=e-t,d=n.abs(u)/i;return r&&d>r&&(d=r),a=void 0===a?6e-4:a,l=e+d*d/(2*a)*(u<0?-1:1),c=d/a,l<o?(l=s?o-s/2.5*(d/8):o,u=n.abs(l-e),c=u/d):l>0&&(l=s?s/2.5*(d/8):0,u=n.abs(e)+l,c=u/d),{destination:n.round(l),duration:c}};var r=e("transform");return o.extend(o,{hasTransform:r!==!1,hasPerspective:e("perspective")in s,hasTouch:"ontouchstart"in t,hasPointer:t.PointerEvent||t.MSPointerEvent,hasTransition:e("transition")in s}),o.isBadAndroid=/Android /.test(t.navigator.appVersion)&&!/Chrome\/\d/.test(t.navigator.appVersion),o.extend(o.style={},{transform:r,transitionTimingFunction:e("transitionTimingFunction"),transitionDuration:e("transitionDuration"),transitionDelay:e("transitionDelay"),transformOrigin:e("transformOrigin")}),o.hasClass=function(e,t){var i=new RegExp("(^|\\s)"+t+"(\\s|$)");return i.test(e.className)},o.addClass=function(e,t){if(!o.hasClass(e,t)){var i=e.className.split(" ");i.push(t),e.className=i.join(" ")}},o.removeClass=function(e,t){if(o.hasClass(e,t)){var i=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(i," ")}},o.offset=function(e){for(var t=-e.offsetLeft,i=-e.offsetTop;e=e.offsetParent;)t-=e.offsetLeft,i-=e.offsetTop;return{left:t,top:i}},o.preventDefaultException=function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1},o.extend(o.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),o.extend(o.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return n.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e-=1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}},elastic:{style:"",fn:function(e){var t=.22,i=.4;return 0===e?0:1==e?1:i*n.pow(2,-10*e)*n.sin((e-t/4)*(2*n.PI)/t)+1}}}),o.tap=function(e,t){var n=i.createEvent("Event");n.initEvent(t,!0,!0),n.pageX=e.pageX,n.pageY=e.pageY,e.target.dispatchEvent(n)},o.click=function(e){var t,n=e.target;/(SELECT|INPUT|TEXTAREA)/i.test(n.tagName)||(t=i.createEvent("MouseEvents"),t.initMouseEvent("click",!0,!0,e.view,1,n.screenX,n.screenY,n.clientX,n.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),t._constructed=!0,n.dispatchEvent(t))},o}();o.prototype={version:"5.1.3",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){e.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(e){if((1==l.eventType[e.type]||0===e.button)&&this.enabled&&(!this.initiated||l.eventType[e.type]===this.initiated)){!this.options.preventDefault||l.isBadAndroid||l.preventDefaultException(e.target,this.options.preventDefaultException)||e.preventDefault();var t,i=e.touches?e.touches[0]:e;this.initiated=l.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=l.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,t=this.getComputedPosition(),this._translate(n.round(t.x),n.round(t.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=i.pageX,this.pointY=i.pageY,this._execEvent("beforeScrollStart")}},_move:function(e){if(this.enabled&&l.eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault();var t,i,o,s,a=e.touches?e.touches[0]:e,r=a.pageX-this.pointX,c=a.pageY-this.pointY,u=l.getTime();if(this.pointX=a.pageX,this.pointY=a.pageY,this.distX+=r,this.distY+=c,o=n.abs(this.distX),s=n.abs(this.distY),!(u-this.endTime>300&&o<10&&s<10)){if(this.directionLocked||this.options.freeScroll||(o>s+this.options.directionLockThreshold?this.directionLocked="h":s>=o+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)e.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);c=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)e.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);r=0}r=this.hasHorizontalScroll?r:0,c=this.hasVerticalScroll?c:0,t=this.x+r,i=this.y+c,(t>0||t<this.maxScrollX)&&(t=this.options.bounce?this.x+r/3:t>0?0:this.maxScrollX),(i>0||i<this.maxScrollY)&&(i=this.options.bounce?this.y+c/3:i>0?0:this.maxScrollY),this.directionX=r>0?-1:r<0?1:0,this.directionY=c>0?-1:c<0?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(t,i),u-this.startTime>300&&(this.startTime=u,this.startX=this.x,this.startY=this.y)}}},_end:function(e){if(this.enabled&&l.eventType[e.type]===this.initiated){this.options.preventDefault&&!l.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var t,i,o=(e.changedTouches?e.changedTouches[0]:e,l.getTime()-this.startTime),s=n.round(this.x),a=n.round(this.y),r=n.abs(s-this.startX),c=n.abs(a-this.startY),u=0,d="";if(this.isInTransition=0,this.initiated=0,this.endTime=l.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(s,a),!this.moved)return this.options.tap&&l.tap(e,this.options.tap),this.options.click&&l.click(e),void this._execEvent("scrollCancel");if(this._events.flick&&o<200&&r<100&&c<100)return void this._execEvent("flick");if(this.options.momentum&&o<300&&(t=this.hasHorizontalScroll?l.momentum(this.x,this.startX,o,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration,this.options.maxSpeed):{destination:s,duration:0},i=this.hasVerticalScroll?l.momentum(this.y,this.startY,o,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration,this.options.maxSpeed):{destination:a,duration:0},s=t.destination,a=i.destination,u=n.max(t.duration,i.duration),this.isInTransition=1),this.options.snap){var h=this._nearestSnap(s,a);this.currentPage=h,u=this.options.snapSpeed||n.max(n.max(n.min(n.abs(s-h.x),1e3),n.min(n.abs(a-h.y),1e3)),300),s=h.x,a=h.y,this.directionX=0,this.directionY=0,d=this.options.bounceEasing}return s!=this.x||a!=this.y?((s>0||s<this.maxScrollX||a>0||a<this.maxScrollY)&&(d=l.ease.quadratic),void this.scrollTo(s,a,u,d)):void this._execEvent("scrollEnd")}}},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(e){var t=this.x,i=this.y;return e=e||0,!this.hasHorizontalScroll||this.x>0?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),(t!=this.x||i!=this.y)&&(this.scrollTo(t,i,e,this.options.bounceEasing),!0)},cancel:function(){this.enabled=!1,this.initiated=!1},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=l.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},off:function(e,t){if(this._events[e]){var i=this._events[e].indexOf(t);i>-1&&this._events[e].splice(i,1)}},_execEvent:function(e){if(this._events[e]){var t=0,i=this._events[e].length;if(i)for(;t<i;t++)this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,i,n){e=this.x+e,t=this.y+t,i=i||0,this.scrollTo(e,t,i,n)},scrollTo:function(e,t,i,n){n=n||l.ease.circular,this.isInTransition=this.options.useTransition&&i>0,!i||this.options.useTransition&&n.style?(this._transitionTimingFunction(n.style),this._transitionTime(i),this._translate(e,t)):this._animate(e,t,i,n.fn)},scrollToElement:function(e,t,i,o,s){if(e=e.nodeType?e:this.scroller.querySelector(e)){var a=l.offset(e);a.left-=this.wrapperOffset.left,a.top-=this.wrapperOffset.top,i===!0&&(i=n.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)),o===!0&&(o=n.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)),a.left-=i||0,a.top-=o||0,a.left=a.left>0?0:a.left<this.maxScrollX?this.maxScrollX:a.left,a.top=a.top>0?0:a.top<this.maxScrollY?this.maxScrollY:a.top,t=void 0===t||null===t||"auto"===t?n.max(n.abs(this.x-a.left),n.abs(this.y-a.top)):t,this.scrollTo(a.left,a.top,t,s)}},_transitionTime:function(e){if(e=e||0,this.scrollerStyle[l.style.transitionDuration]=e+"ms",!e&&l.isBadAndroid&&(this.scrollerStyle[l.style.transitionDuration]="0.001s"),this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTime(e)},_transitionTimingFunction:function(e){if(this.scrollerStyle[l.style.transitionTimingFunction]=e,this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTimingFunction(e)},_translate:function(e,t){if(this.options.useTransform?this.scrollerStyle[l.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ:(e=n.round(e),t=n.round(t),this.scrollerStyle.left=e+"px",this.scrollerStyle.top=t+"px"),this.x=e,this.y=t,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].updatePosition()},_initEvents:function(e){var i=e?l.removeEvent:l.addEvent,n=this.options.bindToWrapper?this.wrapper:t;i(t,"orientationchange",this),i(t,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(n,"mousemove",this),i(n,"mousecancel",this),i(n,"mouseup",this)),l.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,l.prefixPointerEvent("pointerdown"),this),i(n,l.prefixPointerEvent("pointermove"),this),i(n,l.prefixPointerEvent("pointercancel"),this),i(n,l.prefixPointerEvent("pointerup"),this)),l.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(n,"touchmove",this),i(n,"touchcancel",this),i(n,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var e,i,n=t.getComputedStyle(this.scroller,null);return this.options.useTransform?(n=n[l.style.transform].split(")")[0].split(", "),e=+(n[12]||n[4]),i=+(n[13]||n[5])):(e=+n.left.replace(/[^-\d.]/g,""),i=+n.top.replace(/[^-\d.]/g,"")),{x:e,y:i}},_initIndicators:function(){function e(e){for(var t=r.indicators.length;t--;)e.call(r.indicators[t])}var t,i=this.options.interactiveScrollbars,n="string"!=typeof this.options.scrollbars,o=[],r=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(t={el:s("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(t.el),o.push(t)),this.options.scrollX&&(t={el:s("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(t.el),o.push(t))),this.options.indicators&&(o=o.concat(this.options.indicators));for(var l=o.length;l--;)this.indicators.push(new a(this,o[l]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){e(function(){this.fade()})}),this.on("scrollCancel",function(){e(function(){this.fade()})}),this.on("scrollStart",function(){e(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){e(function(){this.fade(1,!0)})})),this.on("refresh",function(){e(function(){this.refresh()})}),this.on("destroy",function(){e(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){l.addEvent(this.wrapper,"wheel",this),l.addEvent(this.wrapper,"mousewheel",this),l.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){l.removeEvent(this.wrapper,"wheel",this),l.removeEvent(this.wrapper,"mousewheel",this),l.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(this.enabled){e.preventDefault(),e.stopPropagation();var t,i,o,s,a=this;if(void 0===this.wheelTimeout&&a._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){a._execEvent("scrollEnd"),a.wheelTimeout=void 0},400),"deltaX"in e)1===e.deltaMode?(t=-e.deltaX*this.options.mouseWheelSpeed,i=-e.deltaY*this.options.mouseWheelSpeed):(t=-e.deltaX,i=-e.deltaY);else if("wheelDeltaX"in e)t=e.wheelDeltaX/120*this.options.mouseWheelSpeed,i=e.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in e)t=i=e.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in e))return;t=i=-e.detail/3*this.options.mouseWheelSpeed}if(t*=this.options.invertWheelDirection,i*=this.options.invertWheelDirection,this.hasVerticalScroll||(t=i,i=0),this.options.snap)return o=this.currentPage.pageX,s=this.currentPage.pageY,t>0?o--:t<0&&o++,i>0?s--:i<0&&s++,void this.goToPage(o,s);o=this.x+n.round(this.hasHorizontalScroll?t:0),s=this.y+n.round(this.hasVerticalScroll?i:0),o>0?o=0:o<this.maxScrollX&&(o=this.maxScrollX),s>0?s=0:s<this.maxScrollY&&(s=this.maxScrollY),this.scrollTo(o,s,0)}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var e,t,i,o,s,a,r=0,l=0,c=0,u=this.options.snapStepX||this.wrapperWidth,d=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(i=n.round(u/2),o=n.round(d/2);c>-this.scrollerWidth;){for(this.pages[r]=[],e=0,s=0;s>-this.scrollerHeight;)this.pages[r][e]={x:n.max(c,this.maxScrollX),y:n.max(s,this.maxScrollY),width:u,height:d,cx:c-i,cy:s-o},s-=d,e++;c-=u,r++}else for(a=this.options.snap,e=a.length,t=-1;r<e;r++)(0===r||a[r].offsetLeft<=a[r-1].offsetLeft)&&(l=0,t++),this.pages[l]||(this.pages[l]=[]),c=n.max(-a[r].offsetLeft,this.maxScrollX),s=n.max(-a[r].offsetTop,this.maxScrollY),i=c-n.round(a[r].offsetWidth/2),o=s-n.round(a[r].offsetHeight/2),this.pages[l][t]={x:c,y:s,width:a[r].offsetWidth,height:a[r].offsetHeight,cx:i,cy:o},c>this.maxScrollX&&l++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=n.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=n.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var e=this.options.snapSpeed||n.max(n.max(n.min(n.abs(this.x-this.startX),1e3),n.min(n.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(e,t){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var i=0,o=this.pages.length,s=0;if(n.abs(e-this.absStartX)<this.snapThresholdX&&n.abs(t-this.absStartY)<this.snapThresholdY)return this.currentPage;for(e>0?e=0:e<this.maxScrollX&&(e=this.maxScrollX),t>0?t=0:t<this.maxScrollY&&(t=this.maxScrollY);i<o;i++)if(e>=this.pages[i][0].cx){e=this.pages[i][0].x;break}for(o=this.pages[i].length;s<o;s++)if(t>=this.pages[0][s].cy){t=this.pages[0][s].y;break}return i==this.currentPage.pageX&&(i+=this.directionX,i<0?i=0:i>=this.pages.length&&(i=this.pages.length-1),e=this.pages[i][0].x),s==this.currentPage.pageY&&(s+=this.directionY,s<0?s=0:s>=this.pages[0].length&&(s=this.pages[0].length-1),t=this.pages[0][s].y),{x:e,y:t,pageX:i,pageY:s}},goToPage:function(e,t,i,o){o=o||this.options.bounceEasing,e>=this.pages.length?e=this.pages.length-1:e<0&&(e=0),t>=this.pages[e].length?t=this.pages[e].length-1:t<0&&(t=0);var s=this.pages[e][t].x,a=this.pages[e][t].y;i=void 0===i?this.options.snapSpeed||n.max(n.max(n.min(n.abs(s-this.x),1e3),n.min(n.abs(a-this.y),1e3)),300):i,this.currentPage={x:s,y:a,pageX:e,pageY:t},this.scrollTo(s,a,i,o)},next:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,n++),this.goToPage(i,n,e,t)},prev:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;i--,i<0&&this.hasVerticalScroll&&(i=0,n--),this.goToPage(i,n,e,t)},_initKeys:function(e){var i,n={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(i in this.options.keyBindings)"string"==typeof this.options.keyBindings[i]&&(this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(i in n)this.options.keyBindings[i]=this.options.keyBindings[i]||n[i];l.addEvent(t,"keydown",this),this.on("destroy",function(){l.removeEvent(t,"keydown",this)})},_key:function(e){if(this.enabled){var t,i=this.options.snap,o=i?this.currentPage.pageX:this.x,s=i?this.currentPage.pageY:this.y,a=l.getTime(),r=this.keyTime||0,c=.25;switch(this.options.useTransition&&this.isInTransition&&(t=this.getComputedPosition(),this._translate(n.round(t.x),n.round(t.y)),this.isInTransition=!1),this.keyAcceleration=a-r<200?n.min(this.keyAcceleration+c,50):0,e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?o+=i?1:this.wrapperWidth:s+=i?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?o-=i?1:this.wrapperWidth:s-=i?1:this.wrapperHeight;break;case this.options.keyBindings.end:o=i?this.pages.length-1:this.maxScrollX,s=i?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:o=0,s=0;break;case this.options.keyBindings.left:o+=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:s+=i?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:o-=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:s-=i?1:5+this.keyAcceleration>>0;break;default:return}if(i)return void this.goToPage(o,s);o>0?(o=0,this.keyAcceleration=0):o<this.maxScrollX&&(o=this.maxScrollX,this.keyAcceleration=0),s>0?(s=0,this.keyAcceleration=0):s<this.maxScrollY&&(s=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(o,s,0),this.keyTime=a}},_animate:function(e,t,i,n){function o(){var h,p,m,f=l.getTime();return f>=d?(s.isAnimating=!1,s._translate(e,t),void(s.resetPosition(s.options.bounceTime)||s._execEvent("scrollEnd"))):(f=(f-u)/i,m=n(f),h=(e-a)*m+a,p=(t-c)*m+c,s._translate(h,p),void(s.isAnimating&&r(o)))}var s=this,a=this.x,c=this.y,u=l.getTime(),d=u+i;this.isAnimating=!0,o()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":e._constructed||(e.preventDefault(),e.stopPropagation())}}},a.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(l.removeEvent(this.indicator,"touchstart",this),l.removeEvent(this.indicator,l.prefixPointerEvent("pointerdown"),this),l.removeEvent(this.indicator,"mousedown",this),l.removeEvent(t,"touchmove",this),l.removeEvent(t,l.prefixPointerEvent("pointermove"),this),l.removeEvent(t,"mousemove",this),l.removeEvent(t,"touchend",this),l.removeEvent(t,l.prefixPointerEvent("pointerup"),this),l.removeEvent(t,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var i=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=l.getTime(),this.options.disableTouch||l.addEvent(t,"touchmove",this),this.options.disablePointer||l.addEvent(t,l.prefixPointerEvent("pointermove"),this),this.options.disableMouse||l.addEvent(t,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(e){var t,i,n,o,s=e.touches?e.touches[0]:e;l.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,t=s.pageX-this.lastPointX,this.lastPointX=s.pageX,i=s.pageY-this.lastPointY,this.lastPointY=s.pageY,n=this.x+t,o=this.y+i,this._pos(n,o),e.preventDefault(),e.stopPropagation()},_end:function(e){if(this.initiated){if(this.initiated=!1,e.preventDefault(),e.stopPropagation(),l.removeEvent(t,"touchmove",this),l.removeEvent(t,l.prefixPointerEvent("pointermove"),this),l.removeEvent(t,"mousemove",this),this.scroller.options.snap){var i=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),o=this.options.snapSpeed||n.max(n.max(n.min(n.abs(this.scroller.x-i.x),1e3),n.min(n.abs(this.scroller.y-i.y),1e3)),300);this.scroller.x==i.x&&this.scroller.y==i.y||(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=i,this.scroller.scrollTo(i.x,i.y,o,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(e){e=e||0,this.indicatorStyle[l.style.transitionDuration]=e+"ms",!e&&l.isBadAndroid&&(this.indicatorStyle[l.style.transitionDuration]="0.001s")},transitionTimingFunction:function(e){this.indicatorStyle[l.style.transitionTimingFunction]=e},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(l.addClass(this.wrapper,"iScrollBothScrollbars"),l.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(l.removeClass(this.wrapper,"iScrollBothScrollbars"),l.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=n.max(n.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=n.max(n.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var e=this.options.listenX&&n.round(this.sizeRatioX*this.scroller.x)||0,t=this.options.listenY&&n.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(e<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=n.max(this.indicatorWidth+e,8),this.indicatorStyle.width=this.width+"px"),e=this.minBoundaryX):e>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=n.max(this.indicatorWidth-(e-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",e=this.maxPosX+this.indicatorWidth-this.width):e=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),t<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=n.max(this.indicatorHeight+3*t,8),this.indicatorStyle.height=this.height+"px"),t=this.minBoundaryY):t>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=n.max(this.indicatorHeight-3*(t-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",t=this.maxPosY+this.indicatorHeight-this.height):t=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=e,this.y=t,this.scroller.options.useTransform?this.indicatorStyle[l.style.transform]="translate("+e+"px,"+t+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=e+"px",this.indicatorStyle.top=t+"px")},_pos:function(e,t){e<0?e=0:e>this.maxPosX&&(e=this.maxPosX),t<0?t=0:t>this.maxPosY&&(t=this.maxPosY),e=this.options.listenX?n.round(e/this.sizeRatioX):this.scroller.x,t=this.options.listenY?n.round(t/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(e,t)},fade:function(e,t){if(!t||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=e?250:500,n=e?0:300;e=e?"1":"0",this.wrapperStyle[l.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(e){this.wrapperStyle.opacity=e,this.visible=+e}.bind(this,e),n)}}},o.utils=l,
"undefined"!=typeof e&&e.exports?e.exports=o:t.IScroll=o}(window,document,Math)},function(e,t,i){function n(){function e(){i&&(i.unset(),i.delClassNames("unavailable")),r="remove"}function t(){window.dofus.sendMessage("EmotePlayRequestMessage",{emoteId:n});var e=window.gui.pingSystem.getChatIcons();e.openPanel&&e.closePanels(),r="use"}s.call(this,{noHeader:!0});var i,n,o,r,l={};this.once("open",function(){l.useEmote=this._addEntry(a("ui.common.use"),t),l.remove=this._addEntry(a("ui.common.remove"),e),this._addCancel()}),this.on("open",function(e,t){e=e||{},i=e.slot,o=e.onClose,n=e.emoteId,r="",l.remove.toggleDisplay(!!e.canRemove),l.useEmote.toggleDisplay(!!e.hasOwnProperty("emoteId")),t()}),this.on("close",function(){o&&o(r)})}var o=i(191).inherits,s=i(480),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){s.call(this,{className:"ContextualMenuFightTeam"}),this.leaderId=0,this.fightId=0,this.once("open",this._setupDom),this.on("open",this._setContent)}i(488);var o=i(191).inherits,s=i(480),a=i(30),r=i(29).getText,l=i(225);o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this,t=this.entryList.createChild("div");this.teamMemberList=t.createChild("div",{className:"teamMemberList"}),this.actionsContainer=t.createChild("div"),this.buttonJoin=this._addEntry(r("ui.common.join"),function(){return e.isAlliancePrismFight?void l.open("social",{tabId:"alliance",tabParams:{tabId:"attacks"}}):e.isTaxCollectorFight?void l.open("social",{tabId:"guild",tabParams:{tabId:"perceptors"}}):void window.dofus.sendMessage("GameFightJoinRequestMessage",{fighterId:e.leaderId,fightId:e.fightId})}),this._addCancel()},n.prototype._setContent=function(e,t){var i=this;this.isAlliancePrismFight=!1,this.isTaxCollectorFight=!1,this.leaderId=e.leaderId,this.fightId=e.fightId,this.teamMemberList.clearContent();for(var n=e.teamMembers,o=[],s=0;s<n.length;s++){var l=n[s];switch(l._type){case"FightTeamMemberMonsterInformations":o.push(l.monsterId);break;case"FightTeamMemberCharacterInformations":case"FightTeamMemberWithAllianceCharacterInformations":case"FightTeamMemberTaxCollectorInformations":}}a.getDataMap("Monsters",o,function(e,o){if(e)return console.error(e);for(var s=0,a=r("ui.common.short.level")+" ",l=0;l<n.length;l++){var c=n[l],u=i.teamMemberList.createChild("div",{className:"teamMember"});switch(c._type){case"FightTeamMemberMonsterInformations":var d=c.grade,h=o[c.monsterId],p=h.grades[d-1].level;s+=p,u.setText(h.nameId+" ("+a+p+")"),3451===h.id&&(i.isAlliancePrismFight=!0);break;case"FightTeamMemberCharacterInformations":case"FightTeamMemberWithAllianceCharacterInformations":s+=c.level,u.setText(c.name+" ("+a+c.level+")");break;case"FightTeamMemberTaxCollectorInformations":i.isTaxCollectorFight=!0}}i.header.setText(r("ui.common.rank",s)),t()})}},function(e,t){},function(e,t,i){function n(){s.call(this),this._cancelButton=null,this.once("open",function(){this.buttonsContainer=this.entryList.createChild("div"),this._cancelButton=this._addCancel()}),this.on("open",function(e,t){this._update(e),t()})}var o=i(191).inherits,s=i(480),a=i(246),r=i(29).getText;o(n,s),e.exports=n,n.prototype._update=function(e){function t(){i.close();var e=this.action;e.cb&&e.cb(e),i.emit("action",e)}var i=this;e=e||{};var n=e.actions||[];this.header.setText(e.title||""),this._displayHeader(!!e.title),this.buttonsContainer.clearContent();for(var o=0,s=n.length;o<s;o++){var r=n[o];if(!r.hidden){var l=this.buttonsContainer.appendChild(new a({className:"cmButton"},t));if(r.caption&&l.setText(r.caption),r.wuiDomChild&&l.appendChild(r.wuiDomChild),r.line)l.addClassNames("line");else{var c="";r.isTitle&&(c="title"),r.disabled?l.addClassNames(c,"disabled"):(r.ticked&&l.addClassNames(c,"ticked"),r.addClassNames&&l.addClassNames(r.addClassNames),l.addClassNames(c),l.action=r)}}}},n.prototype.forceUpdateCancelButton=function(){this._cancelButton&&this._cancelButton.setText(r("ui.common.cancel"))},n.sortMenuActions=function(e){e.sort(function(e,t){return e.caption.localeCompare(t.caption)})}},function(e,t,i){function n(){function e(){var e=window.isoEngine,i=e.mapRenderer.interactiveElements,n=i[this.elementId],o=this.skill;e.lastContextualMenuSkillId=o.skillId,e.actionQueue.enqueueInteractive(n.elementId,n.elementTypeId,function(){e.queueUseInteractive(n.elementId,o.skillInstanceUid)}),t.close()}a.call(this);var t=this;this.once("open",function(){this._setupDom()}),this.on("open",function(t,i){function n(t,i){var n=t._name||"skill "+t.skillId,o=a.actionsContainer.appendChild(new c({text:n,className:"cmButton"},e));return i?void o.disable():(o.elementId=r.elementId,void(o.skill=t))}var s,a=this,r=t||{};if(r.ageBonus?(this.starCounter.setValue(r.ageBonus),this.starCounter.show()):this.starCounter.hide(),r._houseData){d.getWindow("houseBuySell").prepareDialog(r._houseData);var u=r._houseData.houseId;if(s=window.gui.playerData.position.getHousePropertiesById(u)){var m=s.ownerName;m="?"===m||""===m?l("ui.common.houseWithNoOwner"):m!==window.gui.playerData.identification.nickname?l("ui.house.homeOf",m):l("ui.common.myHouse"),this.banner.setContent({house:{houseOwner:m,houseName:s._name,houseId:s.houseId,forSale:s.isOnSale},guild:s.guildInfo}),this._displayHeader(!0)}else this._displayHeader(!1)}else r._name?(this.banner.setContent({name:r._name}),this._displayHeader(!0)):this._displayHeader(!1);if(this.actionsContainer.clearContent(),r.elementTypeId===o.ELEMENT_TYPE_ID.PADDOCK){var f=window.isoEngine.mapRenderer.getPaddockProperties();if(f.locked)return this.actionsContainer.createChild("div",{className:"cmButton",text:l("ui.social.paddockWithNoOwner")}),i()}var g,_;for(g=0,_=r.enabledSkills.length;g<_;g++)n(r.enabledSkills[g]);for(g=0,_=r.disabledSkills.length;g<_;g++)n(r.disabledSkills[g],!0);0===r.enabledSkills.length&&r.disabledSkills.length>0&&p(r.elementTypeId,r.disabledSkills);var v=window.gui.playerData,y=v.hasRight(h.JUMP_HOUSE),b=v.adminMenu.getAdminMenuId();y&&null!==b&&s&&"?"!==s.ownerName&&(a.admin=a.actionsContainer.appendChild(new c({text:"Admin",className:"cmButton"},function(){var e={name:"*"+s.ownerName,houseId:s.houseId};window.gui.closeContextualMenu(),window.gui.openContextualMenuAround("admin",a.admin,e),a.emit("close")}))),i()})}var o=i(184),s=i(191).inherits,a=i(480),r=i(491),l=i(29).getText,c=i(246),u=i(464),d=i(225),h=i(493),p=i(494).displayNotification;s(n,a),e.exports=n,n.prototype._setupDom=function(){this.banner=this.header.appendChild(new r);var e=this.entryList;this.starCounter=e.appendChild(new u),this.actionsContainer=e.createChild("div"),this._addCancel()}},function(e,t,i){function n(){o.call(this,"div",{className:"EntityBanner"}),this._guildEmblem=this.appendChild(new s({width:40,height:40}));var e=this.createChild("div",{className:"nameBox"});this._allianceEmblem=this.appendChild(new s({width:40,height:40})),this._guildName=e.createChild("div",{className:"guildName"}),this._name=e.createChild("div",{className:"name"}),this._houseName=e.createChild("div",{className:"houseName"}),this._houseOwner=e.createChild("div",{className:"houseOwner"}),this._forSale=e.createChild("div",{className:"forSale",text:a("ui.common.forSale")})}i(492);var o=i(235),s=i(469),a=i(29).getText,r=i(191).inherits;r(n,o),n.prototype.setContent=function(e){e=e||{},this._name.setText(e.name||""),this._name.toggleDisplay(!!e.name);var t,i=e.guild;i?(this._guildName.setText(i.guildName),this._guildName.show(),t=i.guildEmblem,t&&this._guildEmblem.setValue(t,!0),this._guildEmblem.show()):(this._guildName.hide(),this._guildEmblem.hide());var n=e.alliance;n?(this.addClassNames("alliance"),i?this._guildName.setText(i.guildName+" - ["+n.allianceTag+"]"):(this._guildName.setText(n.allianceName),this._guildName.show()),t=n.allianceEmblem,t&&(t.isAlliance=!0,this._allianceEmblem.setValue(t,!0),this._allianceEmblem.show())):(this.delClassNames("alliance"),this._allianceEmblem.hide());var o=e.house||{};this._houseOwner.setText(o.houseOwner||""),this._houseOwner.toggleDisplay(!!o.houseOwner),o.houseName&&(o.houseName+=window.gui.playerData.isModeratorOrMore()?" ("+o.houseId+")":"",this._houseName.setText(o.houseName)),this._houseName.toggleDisplay(!!o.houseName),this._forSale.toggleDisplay(!!o.forSale)},e.exports=n},function(e,t){},function(e,t){e.exports={SHOW_ADMIN_CONSOLE_BUTTON:403,JUMP_HOUSE:246,RIGHT_IS_ADMIN:2,IS_COMMUNITY_HELPER:417}},function(e,t,i){function n(e){for(var t="",i=0;i<e.length;i+=1)i>0&&(t+=", "),t+=e[i];return t+"."}function o(e){var t=window.gui.playerData.position.isInIncarnam(),i=t?h:p,o=t?m:f,s=window.gui.playerData.jobs.getJobNpcNameById(i),a=[];return a.push(d("ui.skill.jobNotKnown",n(e.jobNameList))),a.push(d("ui.npc.learnJobs",s,"{mapWithFlag,"+o[0]+","+o[1]+","+window.gui.playerData.position.worldmapId+"}")),a}function s(e){var t=e.jobNameList,i=e.jobLevelList,n=e.levelMinList,o=[];o.push(d("ui.skill.levelLow"));for(var s=0;s<t.length;s+=1)o.push(d("ui.skill.levelLowJob",t[s],n[s],i[s]));return o}function a(e){var t=[],i=d("ui.common.colon")+n(e.jobNameList);return t.push(d("ui.skill.toolNeeded",i)),t}function r(e){var t=[];for(var i in e){var n=e[i],o=g[n.type](n);t.push(o)}return t}function l(e,t){if(!e)return"jobNotKnown";if(e.experience.jobLevel<t._levelMin)return"levelLow";var i=window.gui.playerData.inventory.getCurrentWeapon()||{};return i.item&&e.info.toolIds.indexOf(i.item.id)!==-1?void 0:"toolNeeded"}function c(e,t){var i={type:"",jobNameList:[],jobLevelList:[],levelMinList:[]};return i.type=l(e,t),i.type&&(i.jobNameList.push(t._parentJobName),"levelLow"===i.type&&(i.jobLevelList.push(e.experience.jobLevel),i.levelMinList.push(t._levelMin))),i}function u(e){for(var t=window.gui.playerData.jobs.list,i={},n=[],o=0;o<e.length;o+=1){var s=e[o],a=s._parentJobId,r=c(t[a],s),l=r.type;if(l&&n.indexOf(a)===-1){if(i[l]){var u=i[l];u.jobNameList=u.jobNameList.concat(r.jobNameList),u.jobLevelList=u.jobLevelList.concat(r.jobLevelList),u.levelMinList=u.levelMinList.concat(r.levelMinList)}else i[l]=r;n.push(a)}}return i}var d=i(29).getText,h=849,p=601,m=[4,3],f=[1,-20],g={jobNotKnown:o,levelLow:s,toolNeeded:a};t.displayNotification=function(e,t){var i=t.filter(function(e){return e._parentJobId&&1!==e._parentJobId}),n=u(i),o=Object.keys(n).length;if(0!==o){o>1&&n.jobNotKnown&&delete n.jobNotKnown;var s=[];s=r(n);for(var a=0;a<s.length;a++)for(var l=0;l<s[a].length;l++)window.gui.chat.logError(s[a][l])}}},function(e,t,i){function n(){l.call(this);var e,t={},i={};this.once("open",function(){this._setupDom(t,i)}),this.on("open",function(n,o){this._params=n;var s=this._item=n.item;this._action=null,e=n.onClose;var a=s.objectUID?s:null,l=this._dbItem=a?a.item:s;this.header.setText(l.nameId||""),i.backgroundImage=l.image;for(var c in t)t[c].hide();var u=window.gui.tutorialManager.inTutorial,h=!n.hasOwnProperty("enableSet")||n.enableSet,m=!n.hasOwnProperty("enableBestiary")||n.enableBestiary,f=!n.hasOwnProperty("enableRecipe")||n.enableRecipe,g=!n.hasOwnProperty("enableInsertRecipe")||n.enableInsertRecipe,_=!!n.enableDestroy,v=!!n.enableSell,y=!n.hasOwnProperty("enableCertificate")||n.enableCertificate,b=!!l&&!u,w=!!a&&d.isItemInstanceWithMountInfo(a);if(t.itemSet.toggleDisplay(h&&"ItemSetsWindow"!==n.location&&!!l.itemSetId&&l.itemSetId!==-1&&!u),t.recipes.toggleDisplay(f&&b),t.insertItemStats.toggleDisplay(g&&b),t.insertRecipe.toggleDisplay(g&&b),t.findInBestiary.toggleDisplay(m&&!!s.getProperty("dropMonsterIds").length),t.bidHouseSell.toggleDisplay(!!a&&v),t.remove.toggleDisplay(!!n.remove&&!u),t.mount.toggleDisplay(y&&w),a&&n.enableActions){t.feed.toggleDisplay(!!l.foodTypes&&!u),t.multiUse.toggleDisplay(!!l.usable&&s.quantity>1&&!!s.isOkForMultiUse&&!u),t.use.toggleDisplay(!!l.usable),t.target.toggleDisplay(p.isRoleplayMode&&!!l.targetable&&!l.nonUsableOnAnother&&!u);var M=l.isEquippable();t.equip.toggleDisplay(M&&!r(s.position)),t.unequip.toggleDisplay(M&&r(s.position)),t.mount.toggleDisplay(w),t.manage.toggleDisplay(!!s.livingObjectCategory&&!u),t.freeMimicry.toggleDisplay(a.isMimicryHost()),t.manageShield.toggleDisplay(a.isShieldManageable())}_&&a&&void 0!==s.position&&t.destroy.toggleDisplay(s.quantity>0&&!u),o()}),this.on("close",function(){e&&e(this._action)})}var o=i(496),s=i(383),a=i(191).inherits,r=i(509).isEquipped,l=i(480),c=i(29).getText,u=i(386),d=i(596),h=i(225),p=i(269),m=40;a(n,l),e.exports=n,n.prototype._setupDom=function(e,t){function i(e,t,i){n=e,l.open({min:t,max:i,x:a._position.x,y:a._position.y})}var n,a=this,r=window.gui.playerData.inventory,l=this._minMaxSelector=window.gui.windowsContainer.appendChild(new u);e.equip=this._addEntry(c("ui.common.equip"),function(){r.equipItem(a._item.objectUID)}),e.unequip=this._addEntry(c("tablet.common.unequip"),function(){r.unEquipItem(a._item.objectUID)});var d=e.target=this._addEntry(c("ui.common.target"),function(){return window.gui.openSimplePopup(c("tablet.ui.item.targetInfo"))});s.setDraggable(d,t,"itemContextMenu",null,{containerWidth:m,containerHeight:m}),d.on("dragStart",function(){this.item=a._item,h.closeAll(),a.close()}),e.feed=this._addEntry(c("ui.common.feed"),function(){var e=a._item.item,t=h.getWindow("feed");return t.feedingBox.possessFeedItemForPet(a._item)?void h.open("feed",{mode:"pet",item:a._item}):window.gui.openSimplePopup(c("ui.item.errorNoFoodLivingItem",e.nameId))}),e.use=this._addEntry(c("ui.common.use"),function(){var e=a._item;return e.item.type.needUseConfirm?void window.gui.openConfirmPopup({title:c("ui.common.confirm"),message:c("ui.common.confirmationUseItem",e.item.nameId),cb:function(t){t&&window.dofus.sendMessage("ObjectUseMessage",{objectUID:e.objectUID})}}):void window.dofus.sendMessage("ObjectUseMessage",{objectUID:e.objectUID})}),e.multiUse=this._addEntry(c("ui.common.multipleUse"),function(){i("use",1,a._item.quantity)}),e.insertItemStats=this._addEntry(c("ui.craft.displayChatItem"),function(){window.gui.chat.insertLink("itemStats",a._item)}),e.insertRecipe=this._addEntry(c("ui.craft.displayChatRecipe"),function(){window.gui.chat.insertLink("recipe",a._item)}),e.bidHouseSell=this._addEntry(c("tablet.itemSellInBidHouse"),function(){o.openBidHouse(!0,null,a._item)}),e.findInBestiary=this._addEntry(c("ui.common.bestiary"),function(){h.open("grimoire",{tabId:"bestiary",tabParams:{monsterIds:a._item.getProperty("dropMonsterIds"),label:a._item.getRawName()}})}),e.recipes=this._addEntry(c("ui.craft.associateReceipts"),function(){h.open("itemRecipes",{itemData:a._item||a._dbItem})}),e.itemSet=this._addEntry(c("ui.common.set"),function(){h.open("itemSets",a._item)}),e.manage=this._addEntry(c("ui.item.manageItem"),function(){h.open("itemManage",{itemInstance:a._item})}),e.manageShield=this._addEntry(c("ui.item.manageShield"),function(){h.open("shieldWindow",{itemInstance:a._item})}),this.getEntryManageShield=function(){return e.manageShield},e.freeMimicry=this._addEntry(c("ui.mimicry.free"),function(){var e=a._item;window.gui.openConfirmPopup({message:c("ui.mimicry.confirmFreePopup",e.getName()),cb:function(t){t&&window.dofus.sendMessage("MimicryObjectEraseRequestMessage",{hostUID:e.objectUID,hostPos:e.position})}})}),e.mount=this._addEntry(c("ui.mount.viewMountDetails"),function(){h.getWindow("mount").showCertificateMount(a._item)}),e.destroy=this._addEntry(c("ui.common.destroyThisItem"),function(){var e=a._item;return 1===e.quantity?void window.gui.playerData.inventory.confirmDestroyItem(e,1):void i("destroy",1,e.quantity)}),e.remove=this._addEntry(c("ui.common.remove"),function(){a._action="remove"}),l.on("confirm",function(e){var t=a._item;switch(n){case"use":window.dofus.sendMessage("ObjectUseMultipleMessage",{objectUID:t.objectUID,quantity:e});break;case"destroy":window.gui.playerData.inventory.confirmDestroyItem(t,e);break;default:console.warn("[ContextualMenuItem] unknow mode.")}}),this._addCancel()}},function(e,t,i){function n(){C.call(this,{className:"BidHouseShopWindow",freeContentDelay:x,positionInfo:{left:"0",bottom:"0",width:N,height:"100%"},title:v("ui.bidhouse.bigStoreItemList")}),this.openOnItem=null,this.backBtn=null,this.history=null,this.searchBox=null,this.isListening=!1,this.sortedAllowedTypes={},this.currentSearchText=null,this.currentSearchItemTypeMap=null,this.currentItemTypeElt=null,this.liveItemTypeId=null,this.liveItems=null,this._categoryToDisplay=null,this._categoryToDisplayItems=null,this._requestedCategories=[],this.on("open",this._onOpen),this.on("close",this._onClose)}function o(e,t,i){var n=I.getWindow(e);return n.openState?i&&i!==n.mode?(n.openOnItem=t,D):(I.focusWindow(e),t&&n.navigateToItem(t)?P:R):(n.openOnItem=t,D)}function s(){this.myWindow._goBackInHistory()}function a(e,t){var i=this.myWindow;i._selectItemType(e,t)}function r(e){I.getWindow("tradeItem").displayItem("buy-bidHouse",e),I.focusWindow("tradeItem")}function l(){var e=this.myWindow;e.shopViewer.refresh()}function c(e,t){return e.text.localeCompare(t.text)}function u(e){var t=this.myWindow;return t._sortAllowedTypes(e.info)}function d(e,t){var i=e.myDrilldownList.myWindow,n=i._sortAllowedTypes(e.info);return!!i.currentSearchItemTypeMap[n[t].id]}function h(e){for(var t=e.myDrilldownList.myWindow,i=t._sortAllowedTypes(e.info),n=0;n<i.length;n++)if(t.currentSearchItemTypeMap[i[n].id])return!0;return!1}function p(){this.searchBox.setValue(""),this._cancelSearch()}i(497);var m=i(246),f=i(271),g=i(498),_=i(506),v=i(29).getText,y=i(252),b=i(508),w=i(191).inherits,M=i(509),T=i(576),C=i(233),I=i(225),A=i(235),S=i(580),E=i(30),x=5e3,L=30,N=300,O=30;w(n,C),e.exports=n,n.minWidth=N;var D=0,R=1,P=2;n.openBidHouse=function(e,t,i){var n=o("tradeStorage",i,"modify-bidHouse"),s=o("bidHouseShop",i);if(n!==D||s!==D){if(n===P)return;if(s===P)return;if(e&&n)return;if(!e&&s)return}window.dofus.sendMessage("NpcGenericActionRequestMessage",{npcId:t||0,npcActionId:e?5:6,npcMapId:window.gui.playerData.position.mapId})},n.switchBuySellMode=function(e,t,i){var o=I.getWindow("tradeItem");if(!i){var s=o.getCurrentItem();s&&(i=s.getItemInstance()?s:s.getProperty("id"))}I.close("tradeItem"),window.dofus.sendMessage("LeaveDialogRequestMessage"),window.gui.once("ExchangeLeaveMessage",function(){n.openBidHouse(e,t,i)})},n.prototype._onOpen=function(e){I.arrangeOpeningWindowVertically(this.id,{below:"wallet",fullHeight:!0}),this.npcId=e.buyerDescriptor.npcContextualId,this.searchBox||(this._createContent(),this.isListening||this._setupEventListeners()),this.switchToSellModeBtn.enable(),this._showBlankUi(),this.openOnItem&&this.navigateToItem(this.openOnItem)},n.prototype._onClose=function(){I.close("tradeItem"),this.liveItemTypeId=null,this.liveItems=null},n.prototype._createContent=function(){this.history||(this.history=new b(O)),this._createBackButton(),this._createSearchBox(),this._createSwitchToSellModeButton(),this._createBidHouseCatList(),this._createViewer(),this._resetSearchBox()},n.prototype.freeContent=function(){this.windowBody.clearContent(),this.searchBox=this.bidHouseCatList=this.shopViewer=null,this.currentItemTypeElt=null,this._categoryToDisplayItems=null,this.sortedAllowedTypes={}},n.prototype._resetCategoryFilter=function(){this.currentItemTypeElt=null,this._categoryToDisplayItems=null,this.bidHouseCatList.reset()},n.prototype._showBlankUi=function(){this._resetSearchBox(),this._resetCategoryFilter(),this._refreshDisplayedItems()},n.prototype._searchAgainFromTop=function(){this._resetCategoryFilter(),this._refreshDisplayedItems()},n.prototype._sortAllowedTypes=function(e){if(this.sortedAllowedTypes[e])return this.sortedAllowedTypes[e];for(var t=window.gui.databases.BidHouseCategories[e].allowedTypes,i=window.gui.databases.ItemTypes,n=[],o=0;o<t.length;o++){var s=t[o];n.push({text:i[s].nameId,id:s})}return n.sort(c),this.sortedAllowedTypes[e]=n,n},n.prototype._selectItemType=function(e,t){this.currentItemTypeElt=e,t?this.bidHouseCatList.selectAndShowSubitem(e):this._pushHistory(),this._requestAndDisplayItemAvailability(e.data.id)},n.prototype._createBackButton=function(){if(!this.backBtn){var e=this.backBtn=new m({className:"backButton",hidden:!0},s);e.insertBefore(this.windowTitle),e.myWindow=this}},n.prototype._createSwitchToSellModeButton=function(){var e=this;this.switchToSellModeBtn=this.headerRow.appendChild(new m({addIcon:!0,className:["sellModeBtn","greenButton"],tooltip:v("ui.bidhouse.bigStoreModeSell")},function(){n.switchBuySellMode(!0,e.npcId),this.disable()}))},n.prototype._createSearchBox=function(){this.headerRow=this.windowBody.createChild("div",{className:"headerRow"});var e=this.searchBox=this.headerRow.appendChild(new S({maxLength:L}));e.on("search",this._search.bind(this))},n.prototype._createBidHouseCatList=function(){var e=this.bidHouseCatList=new g;e.myWindow=this,e.setSubitemsGetter(u),e.setFilter(h,d);var t=window.gui.databases.BidHouseCategories,i=[];for(var n in t)i.push({text:t[~~n].description,id:~~n});i.sort(c);for(var o=0;o<i.length;o++)e.addItem(i[o].text,i[o].id);e.getDom(this.windowBody).addClassNames("bidHouseCategories"),e.on("subitemSelected",a),e.on("resized",l)},n.prototype._refreshFilter=function(){this._categoryToDisplayItems&&this._refreshDisplayedItems();var e=this.bidHouseCatList.refreshFilter();0===e.itemCount?(this.bidHouseCatList.toggleBreadcrumb(!1),this.bidHouseCatList.setPlaceholder(v("tablet.bidHouse.noCatHasMatchingItem",this.currentSearchText)),this.shopViewer.setPlaceholder(v("tablet.bidHouse.noMatchingItem",this.currentSearchText)),this._resetShopViewerHeader()):this.bidHouseCatList.setPlaceholder(null)},n.prototype._pushHistory=function(){0===this.history.getCurrentSize()&&this.backBtn.show();var e={bookmark:this.bidHouseCatList.getSubitemBookmark(this.currentItemTypeElt),search:this.currentSearchText};this.history.push(e)},n.prototype._goBackInHistory=function(){(this.currentItemTypeElt||this.currentSearchText)&&this.history.pop();var e=this.history.getLast();if(!e)return this.backBtn.hide(),this._showBlankUi();this.bidHouseCatList.toggleBreadcrumb(!1),this._search(e.search,!0);var t=this.bidHouseCatList.getSubitemByBookmark(e.bookmark);t?this._selectItemType(t,!0):this.bidHouseCatList.collapseAll()},n.prototype.navigateToItem=function(e,t){this.openOnItem=null;var i;i="number"==typeof e?M.items[e]:e.getItem();var n={};return n[i.typeId]=!0,this.currentSearchItemTypeMap=n,this.currentSearchText=i.getNameForSearch(),this.searchBox.setValue(i.nameId),this._resetCategoryFilter(),this._refreshFilter(),t||this._pushHistory(),!0},n.prototype._search=function(e,t){if(null===e||""===e)return this._cancelSearch(t);var i=y.simplifyString(e);i!==this.currentSearchText&&(this.searchBox.searchInput.blur(),this.currentSearchText=i,this.bidHouseCatList.inBreadcrumbMode()||this._searchAgainFromTop(),t?this.searchBox.setValue(e):this._pushHistory(),this._searchItemsByName())},n.prototype._cancelSearch=function(e){this.searchBox.searchInput.blur(),this.currentSearchText&&(this.currentSearchText=null,this.bidHouseCatList.removeFilter(),this.bidHouseCatList.toggleBreadcrumb(!1),this.currentItemTypeElt&&this.bidHouseCatList.selectAndShowSubitem(this.currentItemTypeElt),this._categoryToDisplayItems&&this._refreshDisplayedItems(),e?this.searchBox.clear():this.currentItemTypeElt&&this._pushHistory())},n.prototype._resetSearchBox=function(){this.searchBox.clear(),this.currentSearchText=null},n.prototype._createViewer=function(){function e(e,t){var i=e.level-t.level;return 0!==i?i:e.nameId.localeCompare(t.nameId)}var t=[{id:"icon",format:function(e){var t=new A("div",{className:"slot"}),i=t.createChild("div",{className:"icon"});return i.setStyle("backgroundImage",e.image),t},sort:e,defaultSorter:!0},{id:"name",header:"",format:function(e){var t=new A("div",{className:"name",text:e.nameId});return e.etheral?t.addClassNames("etheral"):e.itemSetId&&t.addClassNames("itemSet"),t},getContent:function(e){return e.nameId},sort:!0}];this.shopViewer=this.windowBody.appendChild(new T(t,"id",{manualFiltering:!0})),this.shopViewer.on("itemSelected",r),this.shopViewer.myWindow=this;var i=new A("div",{className:"filterHeader"});this.shopViewerHeaderLabel=i.createChild("div",{className:"label",text:v("tablet.bidHouse.nowOnSale")}),this.shopViewerHeaderButton=i.appendChild(new _("",p.bind(this))),this.shopViewerHeaderButton.hide(),this.shopViewer.setHeader(i)},n.prototype._setupEventListeners=function(){this.isListening=!0;var e=this;f.on("ExchangeTypesExchangerDescriptionForUserMessage",function(t){e._requestedCategories.shift(),e._storeItemAvailability(t.typeDescription,!0)}),f.on("ExchangeBidHouseGenericItemAddedMessage",function(t){e._storeItemAvailability(t.objGenericId)}),f.on("ExchangeBidHouseGenericItemRemovedMessage",function(t){e._storeNonAvailableItem(t.objGenericId)})},n.prototype._shouldItemBeDisplayed=function(e){return e.typeId===this._categoryToDisplay&&(!this.currentSearchText||e.getNameForSearch().indexOf(this.currentSearchText)>=0)},n.prototype._refreshDisplayedItems=function(){var e=this._categoryToDisplayItems||[],t=!!e.length;if(e.length&&this.currentSearchText){for(var i=[],n=0;n<e.length;n++){var o=e[n];this._shouldItemBeDisplayed(o)&&i.push(o)}e=i}if(e.length>0&&this.bidHouseCatList.toggleBreadcrumb(!0),t&&this.currentSearchText){var s=v("tablet.common.filterHeader",this._categoryToDisplayItems.length-e.length);this._setShopViewerHeader(s,this.currentSearchText)}else this._resetShopViewerHeader();if(!e.length){this.shopViewer.clearContent();var a;if(this._categoryToDisplayItems){var r=window.gui.databases.ItemTypes[this._categoryToDisplay].nameId;a=t?v("tablet.bidHouse.noMatchInCat",this.currentSearchText,r):v("tablet.bidHouse.nothingInCat",r)}else a=v("tablet.bidHouse.searchOrSelect");this.shopViewer.setPlaceholder(a)}this.shopViewer.setItemList(e)},n.prototype._setShopViewerHeader=function(e,t){this.shopViewerHeaderLabel.setText(e),this.shopViewerHeaderButton.setLabel(t),this.shopViewerHeaderButton.show(),this.shopViewer.table.setSortingHintVisible("name",!0)},n.prototype._resetShopViewerHeader=function(){this.shopViewerHeaderLabel.setText(v("tablet.bidHouse.nowOnSale")),this.shopViewerHeaderButton.hide(),this.shopViewer.table.setSortingHintVisible("name",!1)},n.prototype._requestAndDisplayItemAvailability=function(e){return e===this.liveItemTypeId?(this._categoryToDisplayItems=this.liveItems,this._refreshDisplayedItems()):(I.close("tradeItem"),this._categoryToDisplay=e,void(this._requestedCategories.indexOf(e)===-1&&(this._requestedCategories.push(e),this.liveItemTypeId=e,this.liveItems=null,this.shopViewer.setPlaceholder(" "),this.shopViewer.table.placeholder.frame.addClassNames("spinner"),window.dofus.sendMessage("ExchangeBidHouseTypeMessage",{type:e}))))},n.prototype._searchItemsByName=function(){this.searchBox.showAsSearching(!0);var e=this;E.searchDataMap("Items",{match:this.currentSearchText},function(t,i){if(t)return console.error(t),e.shopViewer.setPlaceholder(v("tablet.searchError"));var n={};for(var o in i){var s=i[~~o];n[s.typeId]=!0}e.currentSearchItemTypeMap=n,e._refreshFilter(),e.searchBox.showAsSearching(!1)})},n.prototype._storeItemAvailability=function(e,t){var i=e instanceof Array,n=i?e:[e],o=this;M.getItems(n,function(e,i){if(e)return console.error(e);if(o.openState&&(t||o.liveItems)){o.shopViewer.table.placeholder.frame.delClassNames("spinner");var n=o._categoryToDisplayItems===o.liveItems;o.liveItems=t?i:o.liveItems.concat(i),(n||t)&&(o._categoryToDisplayItems=o.liveItems,o._refreshDisplayedItems())}})},n.prototype._storeNonAvailableItem=function(e){if(this.openState&&this.liveItems){for(var t=this.liveItems.length-1;t>=0;t--)if(this.liveItems[t].id===e){this.liveItems.splice(t,1);break}var i=this._categoryToDisplayItems===this.liveItems;i&&this.shopViewer.removeItems([e])}}},function(e,t){},function(e,t,i){function n(){c.call(this),this._init()}function o(e){var t=this.myDrilldownList;e.isSelected=!1;var i=e===t.currentDeployedItem;t.deployItem(e,!i)}function s(){var e=this.myTopItem.myDrilldownList;return this===e.currentSubitem?e.toggleBreadcrumb(!0):void e._selectSubitem(this)}function a(){var e=this.myDrilldownList;e.toggleBreadcrumb(!1)}function r(e,t){e.toggleClassName("selected",t),e.subitemList.toggleDisplay(t)}i(499);var l=i(246),c=i(194).EventEmitter,u=i(191).inherits,d=i(500),h=i(235);u(n,c),e.exports=n,n.prototype._init=function(){this.parentElt=null,this.elt=null,this.items=[],this.infos=[],this.breadcrumb=null,this.list=null,this.currentDeployedItem=null,this.currentSubitem=null,this.isFilterOn=!1,this.itemFilterFunc=null,this.subitemFilterFunc=null,this.singleItem=null,this.singleSubitem=null},n.prototype.clearContent=function(){this.elt&&(this.elt.clearContent(),this._init())},n.prototype.reset=function(){if(this.elt){var e=this.currentDeployedItem;e&&this.deployItem(e,!1),this.refresh(!0),this._selectSubitem(null),this.removeFilter()}},n.prototype.setBreadcrumbText=function(e){this.breadcrumbText.setText(e)},n.prototype.inBreadcrumbMode=function(){return this.breadcrumb.isVisible()},n.prototype.toggleBreadcrumb=function(e){this.elt.toggleClassName("onlyBreadcrumb",e),this.breadcrumb.toggleDisplay(e),this.list.toggleDisplay(!e),this.emit("resized"),e||(this.list.refresh(),this.currentSubitem&&this.list.showElement(this.currentSubitem))},n.prototype.setSubitemsGetter=function(e){this.getSubitemsFunc=e},n.prototype.colorItems=function(){for(var e=!0,t=0;t<this.items.length;t++){var i=this.list.getItem(t);i.isVisible()&&(i.toggleClassName("odd",e),e=!e)}},n.prototype.getDom=function(e){if(this.elt)return this.elt;if(!this.items.length)return console.warn("Empty DrillDownList");this.parentElt=e;var t=this.elt=e.createChild("div",{className:"drillDownList"}),i=this.breadcrumb=t.appendChild(new l({className:"breadcrumb",hidden:!0,addIcon:"before",text:"_"},a));i.myDrilldownList=this,this.breadcrumbText=i.getChildren()[1],this.list=t.appendChild(new d({className:"tree"})),this.list.myDrilldownList=this;for(var n=0;n<this.items.length;n++){var s=new h("div",{className:"sublistHeader"});s.createChild("div",{className:"arrow"}),s.createChild("div",{className:"text",text:this.items[n]});var r=this.list.addItem({id:n,element:s},{noRefresh:!0});r.info=this.infos[n],r.myDrilldownList=this}return this.colorItems(),this.list.setStyle("max-height",e.rootElement.clientHeight+"px"),this.list.refresh(),this.list.on("selected",o),this.elt=t,t},n.prototype._createSubitemList=function(e){for(var t=this.getSubitemsFunc(e),i=e.subitemList=e.appendChild(new h("div",{className:"subitemList",hidden:!0})),n=0;n<t.length;n++){var o=t[n],a=void 0!==o.id?o.id:n,r=i.appendChild(new l({text:o.text,className:"subitem",name:a},s));r.data=o,r.myTopItem=e}},n.prototype.addItem=function(e,t){this.items.push(e),this.infos.push(void 0!==t?t:this.infos.length)},n.prototype.getItemCount=function(){return this.list.getItemCount()},n.prototype.getItem=function(e){return this.items[e]},n.prototype.getItemElt=function(e){return this.list.getItem(e)},n.prototype.getSubitemBookmark=function(e){return e?[e.myTopItem.id,e.getWuiName()]:null},n.prototype.getSubitemByBookmark=function(e){if(!e)return null;var t=this.list.getItem(e[0]);return t?(t.subitemList||this._createSubitemList(t),t.subitemList.getChild(e[1])):null},n.prototype.selectAndShowSubitem=function(e){this._selectSubitem(e,!1,!0),this.list.isVisible()&&(this.deployItem(e.myTopItem,!0),this.list.showElement(e))},n.prototype.collapseAll=function(){this.currentSubitem&&this.deselectSubitem(),this.currentDeployedItem&&this.deployItem(this.currentDeployedItem,!1)},n.prototype.deselectSubitem=function(){this._selectSubitem(null)},n.prototype._selectSubitem=function(e,t,i){var n=this.currentSubitem;return n&&n.delClassNames("selected"),this.currentSubitem=e,e?(this.setBreadcrumbText(this.items[e.myTopItem.id]+" > "+e.data.text),e.addClassNames("selected"),void(i||this.emit("subitemSelected",e,t))):this.toggleBreadcrumb(!1)},n.prototype.getSelectedSubitem=function(){return this.currentSubitem},n.prototype.setPlaceholder=function(e){this.list.setPlaceholderText(e)},n.prototype.refresh=function(e){this.colorItems(),this.list.refresh(),e&&this.list.goToTop();
},n.prototype.setFilter=function(e,t){this.itemFilterFunc=e,this.subitemFilterFunc=t},n.prototype._filterOneItemSubitems=function(e){if(!this.isFilterOn)return this._resetFilterOnSubitems(e);for(var t,i=0,n=e.subitemList.getChildren(),o=0;o<n.length;o++){var s=n[o];this.subitemFilterFunc(e,o,s)?(i++,1===i&&(t=s),s.show()):s.hide()}return 1===i&&(this.singleSubitem=t),i},n.prototype.isItemDeployed=function(e){return e.subitemList&&e.subitemList.isVisible()},n.prototype.deployItem=function(e,t){if(t===this.isItemDeployed(e))return 0;t&&!e.subitemList&&this._createSubitemList(e);var i=this.currentDeployedItem;i&&e!==i&&r(i,!1),r(e,t),this.currentDeployedItem=t?e:null;var n=0;return t&&(this.subitemFilterFunc?n=this._filterOneItemSubitems(e):(n=e.subitemList.getChildCount(),1===n&&(this.singleSubitem=e.subitemList.getChildren()[0]))),this.list.refresh(),this.list.showElement(e),n},n.prototype.refreshFilter=function(){this.isFilterOn=!0;for(var e,t=0,i=this.list.getItems(),n=i.length-1;n>=0;n--){var o=i[n];this.itemFilterFunc(o)?(t++,1===t&&(e=o),this.isItemDeployed(o)&&this.subitemFilterFunc&&this._filterOneItemSubitems(o),o.show()):o.hide()}var s=0;return 1===t&&(this.singleItem=e,s=this.deployItem(e,!0),1===s&&this._selectSubitem(this.singleSubitem,!0)),this.refresh(),{itemCount:t,subitemCount:s}},n.prototype._resetFilterOnSubitems=function(e){if(e.subitemList)for(var t=e.subitemList.getChildren(),i=0;i<t.length;i++)t[i].show()},n.prototype.removeFilter=function(){if(this.isFilterOn){this.isFilterOn=!1;for(var e=this.list.getItems(),t=e.length-1;t>=0;t--){var i=e[t];i.show(),this._resetFilterOnSubitems(i)}this.refresh(),this.currentSubitem&&(this.list.showElement(this.currentSubitem),this.emit("subitemSelected",this.currentSubitem,!0))}}},function(e,t){},function(e,t,i){i(501);var n=i(502),o=i(505);n.SingleSelectionList=o,e.exports=n},function(e,t){},function(e,t,i){function n(e,t){r.call(this,e),this.addClassNames("ListV2"),this.options=t||{},this.placeholder=null}var o=i(191).inherits,s=i(503),a=i(258).playUiSound,r=i(483),l=i(228);o(n,r),e.exports=n,n.prototype._createItem=function(e){e=e||{};var t=e.id,i=e.element;if(!t&&0!==t)return console.error("List: Invalid Id");var n=this.content.createChild("div",{name:t,className:"listItem"});return n.myList=this,n.id=t,n.data=e.data,"object"==typeof i?n.appendChild(i):n.setText(i),l(n),n.on("tap",this._tapHandler),n},n.prototype.addItem=function(e,t){t=t||{};var i=this._createItem(e);return t.noRefresh||this.refresh(),i},n.prototype.addItems=function(e,t){t=t||{};for(var i,n=0;n<e.length;n+=1)i=e[n],this._createItem(i);return t.noRefresh||this.refresh(),this.getItems()},n.prototype.removeItem=function(e){var t=this.getItem(e);t&&t.destroy()},n.prototype.selectItem=function(e,t){t=t||{};var i=this.getItem(e);i&&(i.isSelected=!0,i.addClassNames("selected"),t.noEvent||this.emit("selected",i),t.noSound||a("GEN_BUTTON"),t.scrollToElement&&this.scrollToElement(i))},n.prototype.deselectItem=function(e,t){t=t||{};var i=this.getItem(e);i&&(i.isSelected=!1,i.delClassNames("selected"),t.noEvent||this.emit("deselected",i),t.noSound||a("GEN_BUTTON"))},n.prototype.deselectAll=function(){for(var e=this.getItems(),t=0;t<e.length;t+=1){var i=e[t];i.isSelected&&this.deselectItem(i.getWuiName(),{noSound:!0})}},n.prototype.getItemCount=function(){return this.content.getChildCount()},n.prototype.getItem=function(e){return this.content.getChild(e)},n.prototype.getItems=function(){return this.content.getChildren()},n.prototype.getContentElement=function(){return this.content},n.prototype.clearContent=function(){this.content.clearContent()},n.prototype.setPlaceholderText=function(e){this.placeholder||(this.placeholder=new s(this)),this.placeholder.setText(e)},n.prototype._tapHandler=function(){var e=this.myList,t=this.getWuiName();return this.isSelected?void(e.options.disableSelectionToggle||e.deselectItem(t)):e.selectItem(t)}},function(e,t,i){function n(e,t){this.parent=e,this.options=t||{},this.frame=null,this.text=null}i(504);var o=i(483);e.exports=n,n.prototype.setText=function(e){return e?(this.frame||(this.frame=this.parent.createChild("div",{className:"placeholderFrame"}),this.options.headerElement&&this.frame.addClassNames("withHeader"),this.text=this.frame.createChild("div",{className:"placeholderText"})),this.options.noHeight||this._computeHeight(),this.text.setText(e),void this.frame.show()):this.frame&&this.frame.hide()},n.prototype._computeHeight=function(){var e=this.parent;e instanceof o&&(e=e.getParent());var t=e.rootElement.offsetHeight;0===t&&console.error("Placeholder computing a 0 height"),this.options.headerElement&&(t-=this.options.headerElement.rootElement.offsetHeight),this.frame.setStyle("minHeight",t+"px")},n.prototype.toggleDisplay=function(e){this.frame&&this.frame.toggleDisplay(!!e)},n.prototype.refresh=function(){this.frame&&this.frame.isVisible()&&this.setText(this.text.getText())}},function(e,t){},function(e,t,i){function n(e,t){s.call(this,e,t),this.addClassNames("SingleSelectionList"),this.currentSelected=null}var o=i(191).inherits,s=i(502);o(n,s),e.exports=n,n.prototype.removeItem=function(e){var t=this.getItem(e);t&&(this.currentSelected=null),s.prototype.removeItem.call(this,e)},n.prototype.selectItem=function(e,t){this.currentSelected&&this.deselectItem(this.currentSelected.getWuiName(),{noSound:!0}),s.prototype.selectItem.call(this,e,t);var i=this.getItem(e);i&&(this.currentSelected=i)},n.prototype.deselectItem=function(e,t){var i=this.getItem(e);i&&i.isSelected&&(this.currentSelected=null,s.prototype.deselectItem.call(this,e,t))},n.prototype.deselectAll=function(){this.currentSelected&&this.deselectItem(this.currentSelected.getWuiName(),{noSound:!0})},n.prototype._tapHandler=function(){var e=this.myList,t=this.getWuiName(),i=e.currentSelected;i?i===this?(i.tappedOnMe=!0,e.options.disableSelectionToggle||e.deselectItem(i.getWuiName(),{noSound:!0}),i.tappedOnMe=!1):(e.deselectItem(e.currentSelected.getWuiName(),{noSound:!0}),e.selectItem(t)):e.selectItem(t)}},function(e,t,i){function n(e,t,i,n){n=n||{},o.call(this,{className:"filterTagButton",tooltip:n.tooltip},t),this.tapHandler=t,this.filterName=i;var s=this.createChild("div",{className:"btnBackground"});n.withIcon&&(s.createChild("div",{className:"btnIcon"}),s.addClassNames("withIcon")),this._labelElement=s.createChild("div",{className:"btnText",text:e}),s.createChild("div",{className:"cross",text:"x"})}i(507);var o=i(246),s=i(191).inherits;s(n,o),e.exports=n,n.prototype.setLabel=function(e){this._labelElement.setText(e)}},function(e,t){},function(e,t){function i(e){this.maxSize=e,this.clear()}e.exports=i,i.prototype.clear=function(){this.buf=new Array(this.maxSize),this.first=0,this.last=0,this.empty=!0},i.prototype.isEmpty=function(){return this.empty},i.prototype.isFull=function(){return this.last===(this.first+this.maxSize-1)%this.maxSize},i.prototype.getCurrentSize=function(){return this.empty?0:(this.last-this.first+this.maxSize)%this.maxSize+1},i.prototype.push=function(e){var t;if(this.empty)this.buf[this.last]=e,this.empty=!1;else{var i=(this.last+1)%this.maxSize;i===this.first&&(t=this.buf[i],this.first=(i+1)%this.maxSize),this.buf[i]=e,this.last=i}return t},i.prototype.pop=function(){if(!this.empty){var e=this.buf[this.last];return this.buf[this.last]=void 0,this.first===this.last?this.empty=!0:this.last=(this.last+this.maxSize-1)%this.maxSize,e}},i.prototype.getFirst=function(){if(!this.empty)return this.buf[this.first]},i.prototype.getLast=function(){if(!this.empty)return this.buf[this.last]}},function(e,t,i){function n(e,t){this.price=e,this.timestamp=t}function o(e){var t=T[e];return t?t.price:-1}function s(e){var t=T[e];return!!t&&Date.now()-t.timestamp<6e4*C}function a(e,t){T[e]=new n(t,Date.now()),y[e]&&(y[e].averagePrice=t)}function r(e){a(e.genericId,e.averagePrice),e.genericId===I&&A(e.averagePrice)}function l(e,t){function i(){for(var t=[],i=0,n=e.length;i<n;i++){var o=y[e[i]];o&&t.push(o)}return t}function n(e){f.getDataMap("Items",r,function(t,i){if(t)return e(t);for(var n=0,o=r.length;n<o;n++){var s=r[n],a=i[s];if(a)c.push(new p(a)),l.push("gfx/items/"+a.iconId+".png");else{var u=w[s];delete w[s],u.emit("loaded")}}return e()})}function o(e){g.preloadImages(l,function(t){for(var i=0,n=t.length;i<n;i++){var o=c[i];y[o.id]=o,o.image=t[i];var s=w[o.id];delete w[o.id],s.loaded=!0,s.emit("loaded")}return e()})}function s(e){return d.length?void u.each(d,function(e,t){return e.loaded?t():e.once("loaded",t)},e):e()}function a(e){return r.length?void u.series([n,o],function(t){return t?e(t):void p.initializeList(c,e)}):e()}for(var r=[],l=[],c=[],d=[],h=0,m=e.length;h<m;h++){var v=e[h];if(!y[v])if(w[v])d.push(w[v]);else{r.push(v);var b=w[v]=new _;b.loaded=!1}}return d.length||r.length?void u.parallel([a,s],function(e){return e?t(e):t(null,i())}):t(null,i())}function c(e,t,i){"function"==typeof t&&(i=t,t=null),Array.isArray(e)||(e=[e]);var n,o,s={},a=[];for(n=0,o=e.length;n<o;n+=1){var r=e[n];s[r.objectGID]=!0,a.push(new m(r))}return l(Object.keys(s),function(e){if(e)return console.warn(e),i(e);var s={};for(n=0,o=a.length;n<o;n+=1){var r=a[n],l=y[r.objectGID];l||(l=y[M],console.error('ItemManager: Player got a "Picfail Puree" instead of the itemId',r.objectGID)),r.setItem(l),s[r.objectUID]=r}m.initializeList(a,t,function(e){i(e,{map:s,array:a})})}),a}var u=i(31),d=i(510),h=i(512),p=i(513),m=i(574),f=i(30),g=i(202),_=i(209).EventEmitter,v=i(269);t.Item=p,t.ItemInstance=m;var y=t.items={},b=null,w={},M=t.FALLBACK_DB_ITEM_ID=666,T={},C=60,I=-1,A=null;t.getAveragePrice=o,t.getFreshAveragePrice=function(e,t){var i=o(e);return s(e)?t(i):(I=e,A=t,window.dofus.sendMessage("ExchangeBidHousePriceMessage",{genId:e}),void(T[e]=new n(i,Date.now())))},t.getItems=l,t.initialize=function(e){var t=window.dofus.connectionManager;b=window.gui.databases.ItemTypes;for(var i in b){var n=b[i];n.category=h.getCategory(n.superTypeId),n.possiblePositions=h.getTypePositions(n.superTypeId)}l([M],e);var o=function(){v.isFightMode||(v.removeListener("gameContextChanged",o),window.dofus.sendMessage("ObjectAveragePricesGetMessage"))};v.on("gameContextChanged",o),window.gui.on("ObjectAveragePricesMessage",function(e){for(var t=0,i=e.ids.length;t<i;t+=1)a(e.ids[t],e.avgPrices[t])}),t.on("ExchangeBidPriceMessage",r)},t.getItemTypeMap=function(){return b?b:void console.error(new Error("Fatal error: item types not loaded"))},t.createItemInstances=c,t.getCategoryName=h.getCategoryName,t.isEquippable=h.isEquippable,t.isEquipped=h.isEquipped,t.unlinkedItemsFilter=h.unlinkedItemsFilter,t.positions=d.positions,t.categories=d.categories},function(e,t,i){var n=i(511),o={amulet:0,weapon:1,ringLeft:2,belt:3,ringRight:4,boots:5,hat:6,cape:7,pets:8,dofus1:9,dofus2:10,dofus3:11,dofus4:12,dofus5:13,dofus6:14,shield:15,mount:16,mutation:20,boostFood:21,firstBonus:22,secondBonus:23,firstMalus:24,secondMalus:25,roleplayBuffer:26,follower:27,cosmeticHat:28,cosmeticCape:29,cosmeticPets:30,cosmeticShield:31,cosmeticWeapon:32,notEquipped:63};e.exports.positions=o;var s={shield:82,fullSoulStone:85,cosmeticHat:181,cosmeticCape:182,cosmeticWeapon:183,cosmeticShield:184,cosmeticPet:185,cosmeticMount:190};e.exports.types=s,t.superTypeNotEquippable=[n.RESOURCE,n.QUEST_OBJECT,n.MUTATION,n.BOOST_FOOD,n.BLESSING,n.CURSE,n.USABLE_OBJECT,n.ROLEPLAY_BUFF,n.MOUNT,n.FOLLOWER,n.CAPTURING_OBJECT,n.LIVING_OBJECT];var a=[!1,!0,!0,!0,!0,!0,!1,!0,!0,!1,!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!1,!0,!0,!0];e.exports.filterEquipment=a;var r=[!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];e.exports.filterConsumables=r;var l=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];e.exports.filterRessources=l;var c=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];e.exports.filterQuest=c;var u={inventoryFull:1,cannotEquipTwice:2,notTradable:3,cannotDrop:4,cannotDropNoPlace:5,cannotDestroy:6,levelTooLow:7,livingObjectRefusedFood:8,cannotUnequip:9,cannotEquipHere:10,criterions:11,mimicryObjectError:12};e.exports.objectErrors=u;var d={equipment:0,consumables:1,resources:2,quest:3,preset:4};e.exports.categories=d;var h=[[],[o.amulet],[o.weapon],[o.ringLeft,o.ringRight],[o.belt],[o.boots],[],[o.shield],[o.weapon],[],[o.hat],[o.cape],[o.pets],[o.dofus1,o.dofus2,o.dofus3,o.dofus4,o.dofus5,o.dofus6],[],[o.mutation],[o.boostFood],[o.firstBonus,o.secondBonus],[o.firstMalus,o.secondMalus],[o.roleplayBuffer],[o.follower],[o.mount],[],[o.cosmeticWeapon],[o.cosmeticShield],[],[o.cosmeticHat],[o.cosmeticCape],[o.cosmeticPets]];e.exports.itemTypePositions=h},function(e,t){e.exports={AMULET:1,WEAPON:2,RING:3,BELT:4,BOOTS:5,USABLE_OBJECT:6,SHIELD:7,CAPTURING_OBJECT:8,RESOURCE:9,HAT:10,CAPE:11,PET:12,DOFUS_OR_TROPHY:13,QUEST_OBJECT:14,MUTATION:15,BOOST_FOOD:16,BLESSING:17,CURSE:18,ROLEPLAY_BUFF:19,FOLLOWER:20,MOUNT:21,LIVING_OBJECT:22,COSMETIC_WEAPON:23,COSMETIC_SHIELD:24,COSMETIC_HAT:26,COSMETIC_CAPE:27,COSMETIC_PETS:28}},function(e,t,i){function n(e){return c.itemTypePositions[e]||[]}function o(e){var t=c.categories;switch(e){case t.equipment:return"equipment";case t.consumables:return"consumables";case t.resources:return"resources";case t.quest:return"quest";case t.preset:return"preset";default:return null}}function s(e){var t=c.categories;return c.filterEquipment[e]?t.equipment:c.filterConsumables[e]?t.consumables:c.filterRessources[e]?t.resources:c.filterQuest[e]?t.quest:t.preset}function a(e){return c.superTypeNotEquippable.indexOf(e)===-1}function r(e){return e!==c.positions.notEquipped}function l(e){return!e.isLinkedCharacter()}var c=i(510);e.exports.getTypePositions=n,e.exports.getCategoryName=o,e.exports.getCategory=s,e.exports.isEquippable=a,e.exports.isEquipped=r,e.exports.unlinkedItemsFilter=l},function(e,t,i){function n(e){for(var t in e)e[t]!==_[t]&&null!==e[t]&&(this[t]=e[t]);this.isWeapon="Weapon"===e._type,this.averagePrice=-1,this.etheral&&(this.descriptionId=c("ui.common.etherealWeaponDescription")),this.type=d.getItemTypeMap()[this.typeId],this.type||m.error("Item #"+this.id+" has invalid typeId #"+this.typeId),this.averagePrice=d.getAveragePrice(this.id)}function o(e,t,i){e.initialize(function(e){e&&m.error("criterion initialize: error for item:",t.id,"criteria:",t.criteria),i()})}function s(e,t){var i=[];if(!e||!e.criterions.length)return i;t=t||"";for(var n=e.criterions,o="",s=!0,a=e.operator&&"|"===e.operator.token,l=0;l<n.length;l++){a||(s=!0);var c=n[l];if(c.criterions){var u=c.criterions;o=[];for(var d=u.length,h=0;h<d;h++){var p=u[h],m=t+(0===h?"(":c.getOperatorText()+" ")+p.getText()+(h===d-1?")":"");o.push(m)}}else{var f="";a&&0!==l&&(f+=" "+e.operator.text+" "),f+=t,0!==l&&c.operator===r.groupOperators.or&&(f+=c.getOperatorText()+" "),f+=c.getText(),a?o+=f:o=f}""!==o&&(s=!c.isRespected()&&s,a||i.push({text:o,isMalus:s}))}return a&&i.push({text:o,isMalus:s}),i}var a=i(31),r=i(514),l=i(400),c=i(29).getText,u=i(252),d=i(509),h=i(30),p=i(511),m=i(207).logger,f=i(510),g=i(399),_={id:null,nameId:null,typeId:null,descriptionId:null,iconId:null,level:null,realWeight:null,cursed:!1,useAnimationId:-1,usable:!1,targetable:!1,exchangeable:!1,price:null,twoHanded:!1,etheral:!1,itemSetId:-1,criteria:"null",criteriaTarget:"null",enhanceable:!1,nonUsableOnAnother:!1,appearanceId:null,secretRecipe:!1,recipeSlots:null,recipeIds:null,dropMonsterIds:null,bonusIsSecret:!1,hideEffects:!1,possibleEffects:null,favoriteSubAreas:null,favoriteSubAreasBonus:null};e.exports=n,n.initializeList=function(e,t){a.parallel([function(t){a.each(e,function(e,t){return e.criteria?(e.conditions=r.createGroupCriterion(e.criteria,e),void o(e.conditions,e,t)):t()},t)},function(t){a.each(e,function(e,t){return e.criteriaTarget?(e.targetConditions=r.createGroupCriterion(e.criteriaTarget,e),void o(e.targetConditions,e,t)):t()},t)},function(t){for(var i=[],n=0;n<e.length;n+=1){var o=e[n];if(o.possibleEffects)for(var s=0;s<o.possibleEffects.length;s+=1){var a=o.possibleEffects[s];o.isShield&&a.effectId===g.ACTION_ID_SHIELD_LEVEL&&(a.diceNum=1),a.effectCaller="Item id "+o.id,i.push(a)}}l.createEffectInstances(i,function(i,n){if(i)return t(i);for(var o=0;o<e.length;o++){var s=e[o];if(s.possibleEffects){var a=s.possibleEffects.length,r=a>0?n.splice(0,a):[];r=r.filter(function(e){return e&&e.effect}),s.possibleEffectsMap={},s.possibleEffects=r;for(var l=0;l<r.length;l++)s.possibleEffectsMap[r[l].effectId]=r[l]}}t()})},function(t){a.each(e,function(e,t){return e.type.superTypeId!==p.PET?t():(e.foodItems=[],e.foodTypes=[],void h.getData("Pets",e.id,function(i,n){return i||!n?t():(e.foodItems=n.foodItems,e.foodTypes=n.foodTypes,t())}))},t)},function(t){for(var i=[],n=[],o=0;o<e.length;o++){var s=e[o],a=s.itemSetId;a&&(i.push(a),n.push(s))}return i.length?void h.getDataMap("ItemSets",i,function(e,i){if(e)return t(e);for(var o=0;o<n.length;o++){var s=n[o],a=i[s.itemSetId];a?s.itemSetName=a.nameId:(m.error(new Error("ItemSet id "+s.itemSetId+" for item id "+s.id+" does not exist.")),s.itemSetName=null)}return t()}):t()}],t)},n.prototype.initialize=function(e){n.initializeList([this],e)},n.prototype.getRawName=function(){return this.nameId},n.prototype.getName=function(){var e=window.gui.playerData.isModeratorOrMore(),t=this.getRawName();return e&&(t+=" ("+this.id+")"),t},n.prototype.getNameForSearch=function(){return this._simplifiedName?this._simplifiedName:(this._simplifiedName=u.simplifyString(this.nameId),this._simplifiedName)},n.prototype._getStatsFormatted=function(){var e=[];if(!this.isWeapon)return m.error(new Error("getProperty('statsFormatted') should never be called on non-weapon Item")),e;var t=c("ui.stats.shortAP")+c("ui.common.colon")+this.apCost;this.maxCastPerTurn&&(t+=" ("+c("ui.item.usePerTurn",this.maxCastPerTurn)+")"),e.push(t);var i=c("ui.common.range")+c("ui.common.colon");if(i+=this.range===this.minRange?this.range:this.minRange+" - "+this.range,e.push(i),this.criticalFailureProbability||this.criticalHitProbability){var n="";if(this.criticalHitProbability){0!==this.criticalHitBonus&&e.push(c("ui.item.critical.bonus",this.criticalHitBonus)),n+=c("ui.common.short.CriticalHit")+c("ui.common.colon")+"1/"+this.criticalHitProbability;var o=window.gui.playerData.characters.mainCharacter.characteristics;if(o){var s=u.totalCriticalHitRate(this.criticalHitProbability,o);e.push(c("ui.itemtooltip.itemCriticalReal","1/"+s))}}this.criticalFailureProbability&&(n+=(this.criticalHitProbability?" - ":"")+c("ui.common.short.CriticalFailure")+c("ui.common.colon")+"1/"+this.criticalFailureProbability),e.push(n)}return this.castInLine&&this.range>1&&e.push(c("ui.spellInfo.castInLine")),!this.castTestLos&&this.range>1&&e.push(c("ui.spellInfo.castWithoutLos")),e},n.prototype._getConditionsFormatted=function(){return s(this.conditions)},n.prototype._getTargetConditionsFormatted=function(){var e="("+c("ui.item.target")+") ";return s(this.targetConditions,e)},n.prototype.getSuperTypeId=function(){return this.type.superTypeId},n.prototype.isEquippable=function(){return d.isEquippable(this.type.superTypeId)},n.prototype.isCosmetic=function(){return this.typeId===f.types.cosmeticHat||this.typeId===f.types.cosmeticCape||this.typeId===f.types.cosmeticShield||this.typeId===f.types.cosmeticWeapon||this.typeId===f.types.cosmeticPet||this.typeId===f.types.cosmeticMount},n.prototype.isShield=function(){return this.typeId===f.types.shield},n.prototype.isShieldManageable=function(){return!1},n.prototype.isFullSoulStone=function(){return this.typeId===f.types.fullSoulStone},n.prototype.getShieldLevel=function(e,t){for(var i=0;i<t.length;i+=1)if(t[i]<e)return i;return t.length};var v=[p.WEAPON,p.SHIELD,p.HAT,p.CAPE,p.PET,p.FOLLOWER,p.MOUNT,p.LIVING_OBJECT,p.SIDEKICK];n.prototype.isChangingCharacterLookWhenEquipped=function(){return v.indexOf(this.type.superTypeId)!==-1},n.prototype.getItem=function(){return this},n.prototype.getItemInstance=function(){return null},n.prototype.getProperty=function(e){return"nameId"===e?this.getName():"conditionsFormatted"===e?this._getConditionsFormatted():"targetConditionsFormatted"===e?this._getTargetConditionsFormatted():"statsFormatted"===e?this._getStatsFormatted():("weight"===e&&(e="realWeight"),this.hasOwnProperty(e)?this[e]:_[e])}},function(e,t,i){var n=i(515),o=i(516),s=i(518),a=i(519),r=i(520),l=i(521),c=i(534),u=i(535),d=i(537),h=i(538),p=i(539),m=i(540),f=i(541),g=i(542),_=i(543),v=i(544),y=i(545),b=i(546),w=i(547),M=i(548),T=i(549),C=i(550),I=i(551),A=i(552),S=i(553),E=i(554),x=i(555),L=i(556),N=i(557),O=i(558),D=i(559),R=i(560),P=i(561),B=i(562),k=i(563),F=i(564),z=i(565),H=i(566),q=i(567),W=i(568),U=i(569),Y=i(570),G=i(571),j=i(572),V=i(573),X={Ca:N,CA:N,ca:N,Cc:N,CC:N,cc:N,Ce:N,CE:N,CD:N,CH:N,Ci:N,ci:N,CI:N,CL:N,CM:N,CP:N,Cs:N,CS:N,cs:N,Cv:N,CV:N,cv:N,Cw:N,CW:N,cw:N,Ct:N,CT:N,OA:s,PX:o,Ps:a,Pa:r,Oz:l,Ow:c,Ox:u,Po:d,PU:h,PG:p,Sy:m,Sd:f,PE:g,Pb:_,Pg:v,Pw:y,Py:b,Px:w,PJ:M,Pj:M,PK:T,PL:C,MK:I,PR:A,PQ:S,SG:E,PN:x,PO:L,Pp:O,PP:O,Qa:D,Qc:D,Qf:D,Pq:R,Pz:P,Pf:B,SI:k,PS:F,PA:z,Pr:H,PB:U,PT:q,Sc:W,PZ:Y,BI:G,PW:j,Pn:V,Oo:V};t.createCriterion=function(e,t){var i=e.substring(0,2);return X[i]?new X[i](e,t):void console.warn("unknown criterion: "+i)},t.createGroupCriterion=function(e,t){return e=e.replace(/[\s+]/g,""),new n(e,this,t)},t.groupOperators=n.operators},function(e,t,i){function n(){c.or={token:"|",isRespectedFn:function(e){for(var t=0,i=e.length;t<i;t+=1)if(e[t].isRespected())return!0;return!1},text:l("ui.common.or")},c.and={token:"&",isRespectedFn:function(e){for(var t=0,i=e.length;t<i;t+=1)if(!e[t].isRespected())return!1;return!0},text:l("ui.common.and")}}function o(e,t,i){c.or||n(),this.criterions=[];for(var o="",a=!1,r=-1,l=!1,u=0,d=e.length;u<d;u+=1){var h=e[u];u===d-1?(o+=h,s(this.criterions,l,o,t,i)):a?")"===h?0===r?a=!1:(r-=1,o+=h):o+=h:"("===h?(r+=1,a=!0,l=!0):"&"===h||"|"===h?(s(this.criterions,l,o,t,i),r=-1,l=!1,this.operator="&"===h?c.and:c.or,o=""):o+=h}}function s(e,t,i,n,s){if(t)e.push(new o(i,n,s));else{var a=n.createCriterion(i,s);a&&e.push(a)}}function a(e,t){e.initialize(t)}var r=i(31),l=i(29).getText,c={};o.prototype.initialize=function(e){r.each(this.criterions,a,e)},o.prototype.isRespected=function(){return!this.criterions.length||(1===this.criterions.length?this.criterions[0].isRespected():this.operator.isRespectedFn(this.criterions))},o.prototype.getOperatorText=function(){return this.operator?this.operator.text:""},o.prototype.getText=function(){for(var e=[],t=0,i=this.criterions.length;t<i;t+=1){var n=this.criterions[t];n.criterions?e.push("("+n.getText()+")"):e.push(n.getText())}return e.join(" "+this.operator.text+" ")},e.exports=o,e.exports.operators=c},function(e,t,i){function n(e){o.call(this,e),window.gui.playerData.identification.hasRights?this._text=s("ui.social.guildHouseRights")+" "+this.getOperatorText()+" "+this.getValueText():this._text=""}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return this._text},e.exports=n},function(e,t){function i(e){for(var t in n){var i=n[t].token;if(e.indexOf(i)!==-1){this.operator=n[t];var o=e.split(i);return this.key=o[0],this.rawValue=o[1],void(this.value=parseInt(this.rawValue,10))}}this.key=e.substring(0,2);var s=e.substring(2,3);this.operator={token:s,text:s,compareFn:function(){return!0}},this.rawValue=e.substring(3),this.value=parseInt(this.rawValue,10)}var n={superior:{token:">",compareFn:function(e,t){return e>=t},text:" > "},inferior:{token:"<",compareFn:function(e,t){return e<t},text:" < "},equal:{token:"=",compareFn:function(e,t){return e===t},text:": "},different:{token:"!",compareFn:function(e,t){return e!==t},text:"! "}};i.prototype.initialize=function(e){e()},i.prototype.getOperatorText=function(){return this.operator?this.operator.text:""},i.prototype.getKeyText=function(){return this.key},i.prototype.getValueText=function(){return this.value},i.prototype.isRespected=function(){if(!this.operator)return!0;var e=this.operator.compareFn;return!!e&&e(this.getCriterion(),this.value)},i.prototype.getText=function(){return this.getKeyText()+" "+this.getOperatorText()+" "+this.getValueText()},i.prototype.getCriterion=function(){return 0},e.exports=i,e.exports.operators=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(30),r=i(191).inherits;r(n,o),n.prototype.initialize=function(e){var t=this;a.getData("Achievements",this.value,function(i,n){return i?e(i):(t._valueText=" '"+n.nameId+"'",t._keyText=s("ui.tooltip.unlockAchievement",[t._valueText]),void e())})},n.prototype.isRespected=function(){var e=window.gui.playerData.achievements.finishedAchievementsIds;return e.indexOf(this.value)!==-1},n.prototype.getKeyText=function(){return this._keyText},n.prototype.getOperatorText=function(){return this.operator===o.operators.different?s("ui.tooltip.dontUnlockAchievement",[this._valueText]):o.prototype.getOperatorText.call(this)},n.prototype.getValueText=function(){return this._valueText},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.common.alignment")},n.prototype.getOperatorText=function(){return this.operator===o.operators.different?" "+s("ui.common.differentFrom")+s("ui.common.colon"):o.prototype.getOperatorText.call(this)},n.prototype.getValueText=function(){return window.gui.databases.AlignmentSides[this.value].nameId},n.prototype.getCriterion=function(){return window.gui.playerData.characters.mainCharacter.characteristics.alignmentInfos.alignmentSide},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._text=s("ui.tooltip.AlignmentLevel")+" "+this.getOperatorText()+" "+this.value}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return this._text},n.prototype.getCriterion=function(){var e=window.gui.playerData;return e.characters.mainCharacter.characteristics.alignmentInfos.characterPower-e.id},e.exports=n},function(e,t,i){function n(e){a.call(this,e),this.operator===a.operators.equal?this._text=r("ui.criterion.allianceAvA"):this._text=""}var o=i(522),s=i(523),a=i(517),r=i(29).getText,l=i(533),c=i(191).inherits;c(n,a),n.prototype.getText=function(){return this._text},n.prototype.isRespected=function(){if(this.operator!==a.operators.equal)return!1;var e=window.gui.playerData,t=e.characters.mainCharacter.characteristics.alignmentInfos.aggressable;if(t!==o.AvA_ENABLED_AGGRESSABLE&&t!==o.AvA_PREQUALIFIED_AGGRESSABLE)return!1;var i=s.entities.prism[e.position.subAreaId];return!(!i||i.mapId===-1)&&i.state===l.PRISM_STATE_VULNERABLE},e.exports=n},function(e,t){e.exports={NON_AGGRESSABLE:0,PvP_ENABLED_AGGRESSABLE:10,PvP_ENABLED_NON_AGGRESSABLE:11,AvA_ENABLED_AGGRESSABLE:20,AvA_ENABLED_NON_AGGRESSABLE:21,AvA_DISQUALIFIED:22,AvA_PREQUALIFIED_AGGRESSABLE:23}},function(e,t,i){function n(e,t,i){i=i||{};var n=s[e][t]||{},a=o[e][t]={id:t,type:e,fighters:{},state:n.fightState,waitingForHelpInfo:n.waitingForHelpInfo};return a.fighters[f.allies]=i.allyCharactersInformations||[],a.fighters[f.enemies]=i.enemyCharactersInformations||[],h.emit("fightStarted",e,a),i.state===m.fighting&&h.emit("fighting",e,a),a}var o,s,a=i(194),r=i(29).getText,l=i(524),c=l.TaxCollector,u=i(532),d=u.Prism,h=e.exports=new a,p=i(525),m=h.fightState=p.fightState,f=h.fightingSide=p.fightingSide,g=h.entityType=p.entityType;h._reset=function(){o=h.fights={},o[g.taxCollector]={},o[g.prism]={},s=h.entities={},s[g.taxCollector]={},s[g.prism]={}},h.isPlayerDefending=function(e,t){if(!g[e])return console.log("unknown entity type",e);var i=h.fights[e];for(var n in i){var o=i[n];if(o.state===m.waitingForHelp&&h.isPlayerFightingFor(t,e,n,f.allies))return parseInt(n,10)}return null},h.getAttackedEntity=function(e){return e.type&&e.hasOwnProperty("id")&&g[e.type]?h.entities[e.type][e.id]:console.log("wrong fight object")},h.isPlayerFightingFor=function(e,t,i,n){if(!g[t])return console.log("unknown entity type",t);var s=o[t][i];if(!s)return!1;for(var a=s.fighters[n],r=0,l=a.length;r<l;r+=1)if(a[r].id===e)return!0;return!1};var _=null;h.playerAutoKick=function(e,t){if(!g[e])return console.log("unknown entity type",e);var i=window.gui.playerData.id;e===g.taxCollector?window.dofus.sendMessage("GuildFightLeaveRequestMessage",{taxCollectorId:t,characterId:i}):window.dofus.sendMessage("PrismFightJoinLeaveRequestMessage",{subAreaId:t,join:!1}),_={type:e,fightId:t,playerId:i}},h.initialize=function(e){function t(e,t){o[e][t]&&(delete o[e][t],h.emit("fightEnded",e,t))}function i(e,t,i,n){var s=o[e][t];if(s){var a=s.fighters[i];a.push(n),h.emit("fighterJoined",e,t,i,n,a.length-1)}}function a(e,t,i,s){var a=o[e][t];a||(a=n(e,t)),a.fighters[i]=s,h.emit("fighterList",e,t,i,s)}function u(e,t,i,n){var s=o[e][t];if(s){for(var a=s.fighters[i],r=0,l=a.length;r<l;r+=1){var c=a[r].id;if(c===n)return a.splice(r,1),void h.emit("fighterLeft",e,t,i,n,r)}return console.error("unknown fighter id",n)}}h._reset(),e.on("disconnect",function(){h._reset()}),l.setupEvents(),e.on("TaxCollectorListMessage",function(e){var t,i=e.informations,o=s.taxCollector;for(t=0;t<i.length;t+=1){var a=new c(i[t]);o[a.id]=a}h.emit("taxCollectorList",g.taxCollector,i,e.nbcollectorMax);var r=e.fightersInformations;for(t=0;t<r.length;t+=1){var l=r[t];n(g.taxCollector,l.collectorId,l)}}),e.on("TaxCollectorMovementAddMessage",function(e){var i=new c(e.informations),a=s.taxCollector,r=!a.hasOwnProperty(i.id);if(a[i.id]=i,r)return void h.emit("entityAdded",g.taxCollector,i);if(h.emit("entityUpdated",g.taxCollector,i),i.fightState===m.noFight)t(g.taxCollector,i.id);else{var l=o[g.taxCollector][i.id];if(!l)return n(g.taxCollector,i.id);l.state=i.fightState,l.waitingForHelpInfo=i.waitingForHelpInfo,l.state===m.fighting&&h.emit("fighting",g.taxCollector,l)}}),e.on("TaxCollectorMovementRemoveMessage",function(e){var t=e.collectorId,i=s.taxCollector;i[t]&&(delete i[t],h.emit("entityRemoved",g.taxCollector,t))}),e.on("PrismsListMessage",function(e){for(var t=s.prism,i=e.prisms,n=0,o=i.length;n<o;n+=1){var a=new d(i[n]);t[a.id]=a}h.emit("prismList",g.prism,i)}),e.on("PrismsListUpdateMessage",function(e){for(var t=s.prism,i=e.prisms,n=0,o=i.length;n<o;n+=1){var a=i[n],r=t[a.subAreaId];r?(r.updateInfo(a),h.emit("entityUpdated",g.prism,r)):(r=new d(a),t[r.id]=r,h.emit("entityAdded",g.prism,r))}}),e.on("PrismsInfoValidMessage",function(e){for(var t=e.fights,i=s.prism,o=0,a=t.length;o<a;o+=1){var r=t[o],l=i[r.subAreaId];if(l){var c=r.allyCharactersInformations[0];c&&"3451"===c.name&&(l.look=c.entityLook,l.level=c.level,r.allyCharactersInformations.splice(0,1)),l.fightState=m.waitingForHelp,n(g.prism,r.subAreaId,r)}else console.warn("unknown prism",r.subAreaId)}}),e.on("PrismFightAddedMessage",function(e){var t=e.fight,i=s.prism[t.subAreaId];return i?void n(g.prism,t.subAreaId,t):console.warn("unknown prism",t.subAreaId)}),e.on("PrismFightRemovedMessage",function(e){t(g.prism,e.subAreaId)}),e.on("GuildFightPlayersHelpersJoinMessage",function(e){i(g.taxCollector,e.fightId,f.allies,e.playerInfo)}),e.on("PrismFightDefenderAddMessage",function(e){var t=e.defender;if("3451"===t.name){var n=s.prism[e.subAreaId];n.look=t.entityLook,n.level=t.level,h.emit("fightTarget",g.prism,e.subAreaId,n)}else i(g.prism,e.subAreaId,f.allies,t)}),e.on("PrismFightAttackerAddMessage",function(e){i(g.prism,e.subAreaId,f.enemies,e.attacker)}),e.on("GuildFightPlayersEnemiesListMessage",function(e){a(g.taxCollector,e.fightId,f.enemies,e.playerInfo)}),e.on("GuildFightPlayersEnemyRemoveMessage",function(e){u(g.taxCollector,e.fightId,f.enemies,e.playerId)}),e.on("GuildFightPlayersHelpersLeaveMessage",function(e){_&&_.type===g.taxCollector&&_.fightId===e.fightId&&_.playerId===e.playerId&&(window.gui.chat.logMsg(r("ui.social.guild.autoFightLeave")),_=null),u(g.taxCollector,e.fightId,f.allies,e.playerId)}),e.on("PrismFightDefenderLeaveMessage",function(e){_&&_.type===g.prism&&_.fightId===e.subAreaId&&_.playerId===e.fighterToRemoveId&&(window.gui.chat.logMsg(r("ui.prism.AutoDisjoin")),_=null),u(g.prism,e.subAreaId,f.allies,e.fighterToRemoveId);
}),e.on("PrismFightAttackerRemoveMessage",function(e){u(g.prism,e.subAreaId,f.enemies,e.fighterToRemoveId)})}},function(e,t,i){function n(e){switch(e){case u.WAITING_FOR_HELP:return r.waitingForHelp;case u.FIGHTING:return r.fighting;default:return r.noFight}}function o(e){this.id=e.uniqueId,this.level=0,this.updateInfo(e)}var s=i(525),a=i(526),r=s.fightState,l=i(29).getText,c=i(252),u={NORMAL:0,WAITING_FOR_HELP:1,FIGHTING:2},d=i(531),h=i(412);t.TaxCollector=o,o.prototype.updateInfo=function(e){for(var t in e)this[t]=e[t];this.fightState=n(e.state);var i=c.getObjectInArrayById(e.complements,"_type","TaxCollectorWaitingForHelpInformations");i&&(this.waitingForHelpInfo=i.waitingForHelpInfo);var o=c.getObjectInArrayById(e.complements,"_type","TaxCollectorGuildInformations");o&&(this.guildId=o.guild.guildId,this.level=a.guilds[this.guildId].guildLevel)},o.prototype.getGuild=function(){return a.guilds[this.guildId]},o.prototype.getName=function(){return this.enrichData.firstName+" "+this.enrichData.lastName},o.prototype.getPosition=function(){return this.worldX+","+this.worldY},t.setupEvents=function(){var e=window.gui;e.on("TaxCollectorMovementMessage",function(e){var t=e.basicInfos,i=t.enrichData||{},n=i.firstName+" "+i.lastName,o=t.worldX+","+t.worldY,s="";s=e.hireOrFire?l("ui.social.TaxCollectorAdded",n,o,e.playerName):l("ui.social.TaxCollectorRemoved",n,o,e.playerName),window.gui.chat.logMsg(s,h.CHANNEL_GUILD)}),e.on("TaxCollectorAttackedMessage",function(e){var t=e.enrichData,i=t.firstName+" "+t.lastName,n=e.worldX+","+e.worldY;window.gui.chat.logMsg(l("ui.social.TaxCollectorAttacked",i,n),h.CHANNEL_GUILD)}),e.on("TaxCollectorErrorMessage",function(e){var t;switch(e.reason){case d.TAX_COLLECTOR_ALREADY_ONE:t=l("ui.social.alreadyTaxCollectorOnMap");break;case d.TAX_COLLECTOR_CANT_HIRE_HERE:t=l("ui.social.cantHireTaxCollecotrHere");break;case d.TAX_COLLECTOR_CANT_HIRE_YET:t=l("ui.social.cantHireTaxcollectorTooTired");break;case d.TAX_COLLECTOR_ERROR_UNKNOWN:t=l("ui.social.unknownErrorTaxCollector");break;case d.TAX_COLLECTOR_MAX_REACHED:t=l("ui.social.cantHireMaxTaxCollector");break;case d.TAX_COLLECTOR_NO_RIGHTS:t=l("ui.social.taxCollectorNoRights");break;case d.TAX_COLLECTOR_NOT_ENOUGH_KAMAS:t=l("ui.social.notEnougthRichToHireTaxCollector");break;case d.TAX_COLLECTOR_NOT_OWNED:t=l("ui.social.notYourTaxcollector")}if(t){var i=window.gui.chat;i.logError(t)}}),e.on("TaxCollectorAttackedResultMessage",function(e){var t,i=e.basicInfos,n=i.enrichData||{},o=n.firstName+" "+n.lastName,s=i.worldX+","+i.worldY;t=e.deadOrAlive?l("ui.social.TaxCollectorDied",o,s):l("ui.social.TaxCollectorSurvived",o,s),window.gui.chat.logMsg(t,h.CHANNEL_GUILD)}),e.on("ExchangeGuildTaxCollectorGetMessage",function(e){for(var t=e.objectsInfos||[],i="",n=0;n<t.length;n+=1){i&&(i+=", ");var o=t[n],s=o.enrichData||{};i+=o.quantity+"x"+s.itemName}var a="";a=i?l("ui.social.thingsTaxCollectorGet",i,e.experience):l("ui.social.xpTaxCollectorGet",e.experience);var r=e.enrichData||{},c=l("ui.social.taxcollectorRecolted",r.firstName+" "+r.lastName,"("+e.worldX+", "+e.worldY+")",e.userName,a);window.gui.chat.logMsg(c,h.CHANNEL_GUILD)})}},function(e,t){t.fightState={noFight:0,waitingForHelp:1,fighting:2},t.fightingSide={allies:"allies",enemies:"enemies"},t.entityType={taxCollector:"taxCollector",prism:"prism"}},function(e,t,i){var n=i(29).getText,o=i(527),s=i(529),a=i(225);t.Emblem=i(528),t.GuildRightsBitEnum=i(530);var r=t.guilds={};t.createGuild=function(e){var t=new o(e);return r[t.guildId]=t,t},t.initialize=function(e){function t(e){a.getWindow("guildCard").display(e)}e.on("GuildCreationResultMessage",function(e){switch(e.result){case s.SOCIAL_GROUP_CREATE_ERROR_ALREADY_IN_GROUP:return window.gui.openSimplePopup(n("ui.guild.alreadyInGuild"));case s.SOCIAL_GROUP_CREATE_ERROR_EMBLEM_ALREADY_EXISTS:return window.gui.openSimplePopup(n("ui.guild.AlreadyUseEmblem"));case s.SOCIAL_GROUP_CREATE_ERROR_NAME_ALREADY_EXISTS:return window.gui.openSimplePopup(n("ui.guild.AlreadyUseName"));case s.SOCIAL_GROUP_CREATE_ERROR_NAME_INVALID:return window.gui.openSimplePopup(n("ui.guild.invalidName"));case s.SOCIAL_GROUP_CREATE_ERROR_REQUIREMENT_UNMET:return window.gui.openSimplePopup(n("ui.guild.requirementUnmet"));case s.SOCIAL_GROUP_CREATE_OK:return a.close("socialGroupCreation");case s.SOCIAL_GROUP_CREATE_ERROR_EMBLEM_INVALID:case s.SOCIAL_GROUP_CREATE_ERROR_UNKNOWN:return window.gui.openSimplePopup(n("ui.common.unknownFail"))}}),e.on("GuildInAllianceFactsMessage",t),e.on("GuildFactsMessage",t),window.dofus.connectionManager.on("GuildFactsErrorMessage",function(){e.chat.logMsg(n("ui.guild.doesntExistAnymore"))})},t.openGuildCard=function(e){window.dofus.sendMessage("GuildFactsRequestMessage",{guildId:e})}},function(e,t,i){function n(e){this.guildId=0,this.guildName="",this.guildEmblem=new s,this.guildLevel=0,this.creationDate=0,this.leaderId=0,this.leaderName="",this.nbMembers=0,this.nbConnectedMembers=0,this.nbTaxCollectors=0,this.averageMemberLevel=0,this.lastActivity=0,this.enabled=!1,this.allianceId=0,this.allianceName="",this.allianceLeader=!1,this.experiencePercentage=0,this.members=[],this.update(e)}function o(e,t,i){i.hasOwnProperty(t)&&void 0!==i[t]&&e.hasOwnProperty(t)&&(e[t]=i[t])}var s=i(528),a=i(29).getText,r=i(252);n.prototype.update=function(e){for(var t in e)o(this,t,e);"#NONAME#"===this.guildName&&(this.guildName=a("ui.guild.noName")),"#NONAME#"===this.allianceName&&(this.allianceName=a("ui.guild.noName"))},n.prototype.getHoursSinceLastConnection=function(){if(!this.lastActivity)return 0;var e=new Date;return Math.floor((e.time-1e3*this.lastActivity)/36e5)},n.prototype.getMembersByRank=function(){var e=window.gui.databases.RankNames,t=this.members,i=[];for(var n in t){var o=t[n];o.rankOrder=e[o.rank].order,i.push(o)}return r.sortObjectInArray(i,"rankOrder"),i},e.exports=n},function(e,t){function i(e){e=e||{},this.symbolShape=e.symbolShape||0,this.symbolColor=e.symbolColor||0,this.backgroundShape=e.backgroundShape||0,this.backgroundColor=e.backgroundColor||0}e.exports=i},function(e,t){e.exports={SOCIAL_GROUP_CREATE_OK:1,SOCIAL_GROUP_CREATE_ERROR_NAME_INVALID:2,SOCIAL_GROUP_CREATE_ERROR_ALREADY_IN_GROUP:3,SOCIAL_GROUP_CREATE_ERROR_NAME_ALREADY_EXISTS:4,SOCIAL_GROUP_CREATE_ERROR_EMBLEM_ALREADY_EXISTS:5,SOCIAL_GROUP_CREATE_ERROR_LEAVE:6,SOCIAL_GROUP_CREATE_ERROR_CANCEL:7,SOCIAL_GROUP_CREATE_ERROR_REQUIREMENT_UNMET:8,SOCIAL_GROUP_CREATE_ERROR_EMBLEM_INVALID:9,SOCIAL_GROUP_CREATE_ERROR_TAG_INVALID:10,SOCIAL_GROUP_CREATE_ERROR_TAG_ALREADY_EXISTS:11,SOCIAL_GROUP_CREATE_ERROR_NEEDS_SUBGROUP:12,SOCIAL_GROUP_CREATE_ERROR_UNKNOWN:99}},function(e,t){e.exports={GUILD_RIGHT_NONE:0,GUILD_RIGHT_BOSS:4,GUILD_RIGHT_MANAGE_GUILD_BOOSTS:2,GUILD_RIGHT_MANAGE_RIGHTS:1024,GUILD_RIGHT_INVITE_NEW_MEMBERS:8,GUILD_RIGHT_BAN_MEMBERS:16,GUILD_RIGHT_MANAGE_XP_CONTRIBUTION:32,GUILD_RIGHT_MANAGE_RANKS:64,GUILD_RIGHT_HIRE_TAX_COLLECTOR:128,GUILD_RIGHT_MANAGE_MY_XP_CONTRIBUTION:256,GUILD_RIGHT_COLLECT:512,GUILD_RIGHT_USE_PADDOCKS:4096,GUILD_RIGHT_ORGANIZE_PADDOCKS:8192,GUILD_RIGHT_TAKE_OTHERS_MOUNTS_IN_PADDOCKS:16384,GUILD_RIGHT_DEFENSE_PRIORITY:32768,GUILD_RIGHT_COLLECT_MY_TAX_COLLECTOR:65536,GUILD_RIGHT_SET_ALLIANCE_PRISM:131072,GUILD_RIGHT_TALK_IN_ALLIANCE_CHAN:262144}},function(e,t){e.exports={TAX_COLLECTOR_ERROR_UNKNOWN:0,TAX_COLLECTOR_NOT_FOUND:1,TAX_COLLECTOR_NOT_OWNED:2,TAX_COLLECTOR_NO_RIGHTS:3,TAX_COLLECTOR_MAX_REACHED:4,TAX_COLLECTOR_ALREADY_ONE:5,TAX_COLLECTOR_CANT_HIRE_YET:6,TAX_COLLECTOR_CANT_HIRE_HERE:7,TAX_COLLECTOR_NOT_ENOUGH_KAMAS:8}},function(e,t,i){function n(e){switch(e){case l.PRISM_STATE_ATTACKED:return a.waitingForHelp;case l.PRISM_STATE_FIGHTING:return a.fighting;default:return a.noFight}}function o(e){for(var t in e)this[t]=e[t];this.id=e.subAreaId,this.fightState=e.prism?n(e.prism.state):a.noFight}var s=i(525),a=s.fightState,r=i(29).getText,l=i(533),c=i(412),u=i(28);t.Prism=o,o.prototype.updateInfo=function(e){for(var t in e)this[t]=e[t];if(!e.prism)return void delete this.prism;var i=n(e.prism.state);if(i===a.waitingForHelp&&this.fightState!==a.waitingForHelp){var o=e.enrichData.subAreaName+" ("+e.enrichData.areaName+")";window.gui.chat.logMsg(r("ui.prism.attacked",o,this.getPosition()),c.CHANNEL_ALLIANCE)}var s=this.getAlliance();s.allianceEmblem.isAlliance=!0,this.fightState=i},o.prototype.getPlacementDate=function(){return new u.DofusDate(this.prism.placementDate).getServerDate().toString().date},o.prototype.getName=function(){var e=window.gui.playerData.alliance.current;return r("ui.zaap.prism")+" "+e.allianceName},o.prototype.getPosition=function(){return this.worldX+","+this.worldY},o.prototype.getAlliance=function(){if(this.prism)return"AllianceInsiderPrismInformation"===this.prism._type?window.gui.playerData.alliance.current:this.prism.alliance}},function(e,t){e.exports={PRISM_STATE_INVULNERABLE:0,PRISM_STATE_NORMAL:1,PRISM_STATE_ATTACKED:2,PRISM_STATE_FIGHTING:3,PRISM_STATE_WEAKENED:4,PRISM_STATE_VULNERABLE:5,PRISM_STATE_DEFEATED:6}},function(e,t,i){function n(e){o.call(this,e),0===this.value?this._text=s("ui.criterion.noAlliance"):1===this.value?this._text=s("ui.criterion.hasAlliance"):this._text=s("ui.criterion.hasValidAlliance")}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return this._text},n.prototype.getCriterion=function(){var e=window.gui.playerData.alliance;return e.hasAlliance()?e.current.enabled?2:1:0},e.exports=n},function(e,t,i){function n(e){switch(e){case r.ALLIANCE_RIGHT_BOSS:return a("ui.guild.right.leader");case r.ALLIANCE_RIGHT_KICK_GUILDS:return a("ui.social.guildRightsBann");case r.ALLIANCE_RIGHT_MANAGE_PRISMS:return a("ui.social.guildRightsSetAlliancePrism");case r.ALLIANCE_RIGHT_MANAGE_RIGHTS:return a("ui.social.guildManageRights");case r.ALLIANCE_RIGHT_RECRUIT_GUILDS:return a("ui.social.guildRightsInvit");case r.ALLIANCE_RIGHT_TALK_IN_CHAN:return a("ui.social.guildRightsTalkInAllianceChannel");default:return""}}function o(e){s.call(this,e);var t=n(this.value);this.operator===s.operators.equal?this._text=a("ui.criterion.allianceRights",[t]):this._text=a("ui.criterion.notAllianceRights",[t])}var s=i(517),a=i(29).getText,r=i(536),l=i(191).inherits;r.ALLIANCE_RIGHT_MANAGE_PRISMS=2,r.ALLIANCE_RIGHT_TALK_IN_CHAN=4,r.ALLIANCE_RIGHT_RECRUIT_GUILDS=8,r.ALLIANCE_RIGHT_KICK_GUILDS=16,r.ALLIANCE_RIGHT_MANAGE_RIGHTS=32,l(o,s),o.prototype.getText=function(){return this._text},o.prototype.isRespected=function(){var e=window.gui.playerData.alliance;if(!e.hasAlliance())return this.operator===s.operators.equal;var t=this.value!==r.ALLIANCE_RIGHT_BOSS||e.isBoss();return this.operator===s.operators.equal?t:this.operator===s.operators.equal&&!t},e.exports=o},function(e,t){e.exports={ALLIANCE_RIGHT_NONE:0,ALLIANCE_RIGHT_BOSS:1}},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){var e=window.gui.playerData.position.area.nameId;return this.operator===o.operators.equal?s("ui.tooltip.beInArea",[e]):s("ui.tooltip.dontBeInArea",[e])},n.prototype.getCriterion=function(){return window.gui.playerData.position.area.id},e.exports=n},function(e,t,i){function n(e){o.call(this,e),0===this.value&&"B"===this.key?this._text=s("ui.criterion.initialBones"):this._text=s("ui.criterion.bones")+" "+this.getOperatorText()+" "+this.value}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return this._text},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.entityLook.bonesId},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=window.gui.databases.Breeds[this.value].shortNameId;this.operator===o.operators.equal?this._text=s("ui.tooltip.beABreed",[t]):this._text=s("ui.tooltip.dontBeABreed",[t])}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return this._text},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.breed},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._communityId=window.gui.playerData.identification.communityId}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.initialize=function(e){var t=this,i=window.gui.serversData;i.syncServerStaticData(function(n){return n?(console.error("ServerDetails setServer error",n),e(n)):(t._communityName=i.staticContent.communities[t._communityId],void e())})},n.prototype.getText=function(){return this.operator===o.operators.equal?s("ui.criterion.community",[this._communityName]):s("ui.criterion.notCommunity",[this._communityName])},n.prototype.getCriterion=function(){return this._communityId},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.time.days",1)},n.prototype.getCriterion=function(){var e=new Date;return e.getDate()},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(30),r=i(191).inherits,l={};r(n,o),n.prototype.initialize=function(e){var t=this.value,i=l[t];if(i)return this._emoticonData=i,e();if(i=window.gui.playerData.emoteData.list[t])return this._emoticonData=i,e();var n=this;a.getData("Emoticons",this.value,function(t,i){return t?e(t):(l[i.id]=i,n._emoticonData=i,void e())})},n.prototype.isRespected=function(){return window.gui.playerData.emoteData.list.hasOwnProperty(this.value)},n.prototype.getText=function(){var e=s(this.operator===o.operators.different?"ui.tooltip.dontPossessEmote":"ui.tooltip.possessEmote");return e+" '"+this._emoticonData.nameId+"'"},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191);a.inherits(n,o),n.prototype.getKeyText=function(){return s("ui.tooltip.playerInFriendlist")},n.prototype.getCriterion=function(){return Object.keys(window.gui.playerData.socialData.friendsList).length},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=this.key.split(",");t.length>1?(this._giftId=parseInt(t[0],10),this._giftLevel=parseInt(t[1],10)):(this._giftId=parseInt(this.value,10),this._giftLevel=-1)}var o=i(517),s=i(29).getText,a=i(191);a.inherits(n,o),n.prototype.getText=function(){var e=window.gui.databases.AlignmentGift,t=e[this._giftId]?e[this._giftId].nameId:"";return this.operator===o.operators.superior?s("ui.pvp.giftRequired",[t+" > "+this._giftLevel]):s("ui.pvp.giftRequired",[t])},n.prototype.isRespected=function(){var e=window.gui.playerData.alignmentRank,t=window.gui.databases.AlignmentRankJntGift[e];if(!t||!t.gifts)return!1;for(var i=0,n=t.gifts.length;i<n;i+=1)if(t.gifts[i]===this._giftId)return!this._giftLevel||t.levels[i]>this._giftLevel;return!1},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return s(0===this.value?"ui.criterion.noguild":1===this.value?"ui.criterion.hasGuild":"ui.criterion.hasValidGuild")},n.prototype.getCriterion=function(){var e=window.gui.playerData.guild;return e.hasGuild()?e.current.enabled?2:1:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.guild.guildLevel")},n.prototype.getCriterion=function(){var e=window.gui.playerData.guild;return e.hasGuild()?e.current.guildLevel:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(526).GuildRightsBitEnum,r=i(191).inherits;r(n,o),n.prototype.getText=function(){var e;switch(this.value){case a.GUILD_RIGHT_BOSS:e=s("ui.guild.right.leader");break;case a.GUILD_RIGHT_BAN_MEMBERS:e=s("ui.social.guildRightsBann");break;case a.GUILD_RIGHT_COLLECT:e=s("ui.social.guildRightsCollect");break;case a.GUILD_RIGHT_COLLECT_MY_TAX_COLLECTOR:e=s("ui.social.guildRightsCollectMy");break;case a.GUILD_RIGHT_DEFENSE_PRIORITY:e=s("ui.social.guildRightsPrioritizeMe");break;case a.GUILD_RIGHT_HIRE_TAX_COLLECTOR:e=s("ui.social.guildRightsHiretax");break;case a.GUILD_RIGHT_INVITE_NEW_MEMBERS:e=s("ui.social.guildRightsInvit");break;case a.GUILD_RIGHT_MANAGE_GUILD_BOOSTS:e=s("ui.social.guildRightsBoost");break;case a.GUILD_RIGHT_MANAGE_MY_XP_CONTRIBUTION:e=s("ui.social.guildRightManageOwnXP");break;case a.GUILD_RIGHT_MANAGE_RANKS:e=s("ui.social.guildRightsRank");break;case a.GUILD_RIGHT_MANAGE_RIGHTS:e=s("ui.social.guildManageRights");break;case a.GUILD_RIGHT_MANAGE_XP_CONTRIBUTION:e=s("ui.social.guildRightsPercentXP");break;case a.GUILD_RIGHT_ORGANIZE_PADDOCKS:e=s("ui.social.guildRightsMountParkArrange");break;case a.GUILD_RIGHT_SET_ALLIANCE_PRISM:e=s("ui.social.guildRightsSetAlliancePrism");break;case a.GUILD_RIGHT_TALK_IN_ALLIANCE_CHAN:e=s("ui.social.guildRightsTalkInAllianceChannel");break;case a.GUILD_RIGHT_TAKE_OTHERS_MOUNTS_IN_PADDOCKS:e=s("ui.social.guildRightsManageOtherMount");break;case a.GUILD_RIGHT_USE_PADDOCKS:e=s("ui.social.guildRightsMountParkUse");break;default:e=""}return this.operator===o.operators.equal?s("ui.criterion.guildRights",[e]):s("ui.criterion.notGuildRights",[e])},n.prototype.isRespected=function(){var e=window.gui.playerData.guild;if(!e.hasGuild())return this.operator===o.operators.different;var t=e.hasRight(this.value);return this.operator===o.operators.equal?t:!t},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=this.rawValue.split(",");t.length>1?(this._jobId=parseInt(t[0],10),this._jobLevel=parseInt(t[1],10)):(this._jobId=parseInt(this.value,10),this._jobLevel=-1)}var o=i(517),s=i(29).getText,a=i(30),r=i(191);r.inherits(n,o),n.prototype.initialize=function(e){var t=this;a.getData("Jobs",this._jobId,function(i,n){return i?e(i):(t._jobName=n&&n.nameId,void e())})},n.prototype.getText=function(){if(!this._jobName)return"";var e=this._jobName,t="";switch(this._jobLevel>=0&&(t=" "+s("ui.common.short.level")+" "+this._jobLevel),this.operator){case o.operators.equal:return e+t;case o.operators.different:return s("ui.common.dontBe")+e+t;case o.operators.superior:return e+" >"+t;case o.operators.inferior:return e+" <"+t;default:return""}},n.prototype.isRespected=function(){var e=window.gui.playerData.jobs.list;if(this._jobLevel===-1)return e.hasOwnProperty(this._jobId);var t=e[this._jobId];if(!t||!t.experience)return!1;var i=this.operator.compareFn;return!!i&&i(t.experience.jobLevel,this._jobLevel)},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191);a.inherits(n,o),n.prototype.getKeyText=function(){return s("ui.common.kamas")},n.prototype.getCriterion=function(){return window.gui.playerData.inventory.kamas},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191);a.inherits(n,o),n.prototype.getKeyText=function(){return s("ui.common.level")},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.level},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=this.rawValue.split(",");t.length>1?(this._mapId=parseInt(t[0],10),this.value=parseInt(t[1],10)):this._mapId=window.gui.playerData.position.mapId}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.criterion.MK",[this._mapId])},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.level},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return s(this.operator===o.operators.equal&&1===this.value||this.operator===o.operators.different&&2===this.value?"ui.tooltip.beMaried":"ui.tooltip.beSingle")},n.prototype.getCriterion=function(){return null!==window.gui.playerData.socialData.spouse?1:2},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191);a.inherits(n,o),n.prototype.getCriterion=function(){return window.gui.playerData.partyData.arenaStats.bestDailyRank},n.prototype.getText=function(){var e;return e=this.operator===o.operators.different?s("ui.common.differentFrom")+" >":">",s("ui.common.pvpMaxRank")+" "+e+" "+this.value},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191);a.inherits(n,o),n.prototype.getKeyText=function(){return s("ui.time.months")},n.prototype.getCriterion=function(){var e=new Date;return e.getMonth()},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191);a.inherits(n,o),n.prototype.getText=function(){var e;switch(this.operator.token){case"!":case"=":e=this.operator.token+" "+this.rawValue;break;case"~":e="= "+this.rawValue;break;case"S":case"s":e=s("ui.criterion.startWith",[this.rawValue]);break;case"E":case"e":e=s("ui.criterion.endWith",[this.rawValue]);break;case"v":e=s("ui.criterion.valid");break;case"i":e=s("ui.criterion.invalid");break;default:e=""}return s("ui.common.name")+" "+e},n.prototype.isRespected=function(){var e=window.gui.playerData.characterBaseInformations.name;switch(this.operator.token){case"=":return e===this.rawValue;case"!":return e!==this.rawValue;case"~":return e.toLowerCase()===this.rawValue.toLowerCase();case"S":return 0===e.toLowerCase().indexOf(this.rawValue.toLowerCase());case"s":return 0===e.indexOf(this.rawValue);case"E":return e.toLowerCase().indexOf(this.rawValue.toLowerCase())===e.length-this.rawValue.length;case"e":return e.indexOf(this.rawValue)===e.length-this.rawValue.length;default:case"v":case"i":return!1}},e.exports=n},function(e,t,i){function n(e,t){o.call(this,e),this._objectName=t.nameId}var o=i(517),s=i(29).getText,a=i(191).inherits,r=i(30);a(n,o),n.prototype.initialize=function(e){var t=this.value;if(!t&&0!==t)return e();var i=this;r.getDataMap("Items",[t],function(n,o){if(n)return e(n);var s=o[t];return s?(i._objectName=s.nameId,void e()):e("ObjectItemCriterion: unable to find item id "+t)})},n.prototype.isRespected=function(){var e=window.gui.playerData.inventory.objects,t=this.operator===o.operators.equal;for(var i in e){var n=e[i];if(n.objectGID===this.value)return t}return!t},n.prototype.getText=function(){return this.operator===o.operators.different?s("ui.common.doNotPossess",[this._objectName]):s("ui.common.doPossess",[this._objectName])},e.exports=n},function(e,t,i){function n(){u={CM:p("ui.stats.shortMP"),CP:p("ui.stats.shortAP"),CH:p("ui.pvp.honourPoints"),CD:p("ui.pvp.disgracePoints"),CT:p("ui.stats.takleBlock"),Ct:p("ui.stats.takleEvade")},d=p("ui.item.characteristics").split(",")}function o(e,t,i){for(var n=i.length,o=e,s=0,a=t.length;s<a;s+=1)o=o.split(t[s]).join(i[s%n]);return o}function s(e){return u[e]?u[e]:o(e,["CS","Cs","CV","Cv","CA","Ca","CI","Ci","CW","Cw","CC","Cc","CA","PG","PJ","Pj","PM","PA","PN","PE","<NO>","PS","PR","PL","PK","Pg","Pr","Ps","Pa","PP","PZ","CM","Qa","<NO>","<NO>","ca","cc","ci","cs","cv","cw"],d)}function a(e){h.call(this,e),u||n(),this._keyText=s(this.key)}function r(e){return function(t){return t[e].getBasePts()}}function l(e){return function(t){return t[e].getAdditionalPts()}}function c(e){return function(t){var i=t[e];return i.getTotalStat()}}var u,d,h=i(517),p=i(29).getText,m=i(191).inherits;m(a,h),a.prototype.getKeyText=function(){return this._keyText};var f={Ca:r("agility"),CA:c("agility"),ca:l("agility"),Cc:r("chance"),CC:c("chance"),cc:l("chance"),Ce:function(e){return e.energyPoints},CE:function(e){return e.maxEnergyPoints},CH:function(e){return e.alignmentInfos.honor},Ci:r("intelligence"),CI:c("intelligence"),ci:l("intelligence"),CL:function(e){return e.lifePoints},CM:c("movementPoints"),CP:c("actionPoints"),Cs:r("strength"),CS:c("strength"),cs:l("strength"),Cv:r("vitality"),CV:c("vitality"),cv:l("vitality"),Cw:r("wisdom"),CW:c("wisdom"),cw:l("wisdom"),Ct:c("tackleEvade"),CT:c("tackleBlock")};a.prototype.getCriterion=function(){var e=window.gui.playerData.characters.mainCharacter.characteristics;return f[this.key]?parseInt(f[this.key](e),10):(console.error("unknown criterion key: "+this.key),0)},e.exports=a},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.pvp.rank")},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._quest=null}var o=i(517),s=i(29).getText,a=i(191),r=i(30),l=i(207).logger;a.inherits(n,o),n.prototype.initialize=function(e){var t=this;r.getDataMap("Quests",[this.value],function(i,n){return i?e("QuestItemCriterion#initialize",i):(n[t.value]?t._quest=n[t.value]:l.error("QuestItemCriterion#initialize: cannot get questId",t.value),void e())})},n.prototype.getText=function(){if(!this._quest)return"";switch(this.key){case"Qa":return s("ui.grimoire.quest.active",[this._quest.nameId]);case"Qc":return s("ui.grimoire.quest.startable",[this._quest.nameId]);case"Qf":return s("ui.grimoire.quest.done",[this._quest.nameId]);default:return""}},n.prototype.isRespected=function(){var e=window.gui.playerData.quests.all[this.value];if(!e)return"";switch(this.key){case"Qa":return window.gui.playerData.quests.active.hasOwnProperty(this.value);case"Qc":return!0;case"Qf":return window.gui.playerData.quests.finished.hasOwnProperty(this.value);default:return""}},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.common.pvpRank")},n.prototype.getOperatorText=function(){return this.operator===o.operators.different?s("ui.common.differentFrom")+" >":">"},n.prototype.getCriterion=function(){return window.gui.playerData.partyData.arenaStats.rank},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.common.level")},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.level},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return this.operator===o.operators.equal&&1===this.value||this.operator===o.operators.different&&0===this.value?s("ui.tooltip.mountEquiped"):this.operator===o.operators.equal&&1===this.value||this.operator===o.operators.different&&0===this.value?s("ui.tooltip.mountNonEquiped"):""},n.prototype.getCriterion=function(){return window.gui.playerData.isRiding?1:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._keyText=s("ui.header.server")}var o=i(517),s=i(29).getText,a=i(191).inherits,r=i(30);a(n,o),n.prototype.initialize=function(e){var t=this;this._serverName="",r.getData("Servers",this.value,function(i,n){return i?e(i):(t._serverName=n.nameId,void e())})},n.prototype.getKeyText=function(){return this._keyText},n.prototype.getValueText=function(){return this._serverName},n.prototype.getCriterion=function(){return window.gui.serversData.connectedServerId},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return s(1===this.value?"ui.tooltip.beFemale":"ui.tooltip.beMale")},n.prototype.getCriterion=function(){return window.gui.playerData.characterBaseInformations.sex?1:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits,r=i(30),l=[7010,10417,10418];a(n,o),n.prototype.initialize=function(e){var t,i=this.key.split(",");i.length>1?(t=parseInt(i[0],10),this._quantityMonster=parseInt(i[1],10)):(t=parseInt(this.value,10),this._quantityMonster=1),this._monsterName="";var n=this;r.getData("Monsters",t,function(t,i){return t?e(t):(n._monsterName=i.nameId,void e())})},n.prototype.isRespected=function(){for(var e=window.gui.playerData.inventory,t=0;t<l.length;t+=1)if(e.quantityList[[l]])return!0;return!1},n.prototype.getText=function(){return s("ui.tooltip.possessSoulStone",[this._quantityMonster,this._monsterName])},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(191).inherits;s(n,o),n.prototype.getCriterion=function(){return window.gui.playerData.characters.mainCharacter.characteristics.alignmentInfos.alignmentGrade},e.exports=n},function(e,t,i){function n(e){o.call(this,e);var t=this.rawValue.split(",");t.length>1?console.error(new Error("SpellItemCriterion: too much parameters: "+t)):this._spellId=this.value}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){var e=window.gui.playerData.characters.mainCharacter.spellData.spells[this._spellId];if(!e)return"";switch(this.operator){case o.operators.equal:return s("ui.criterion.gotSpell",[e.nameId]);case o.operators.different:return s("ui.criterion.doesntGotSpell",[e.nameId]);default:return""}},n.prototype.isRespected=function(){var e=window.gui.playerData.characters.mainCharacter.spellData.spells.hasOwnProperty(this._spellId);return e&&this.operator===o.operators.equal||!e&&this.operator===o.operators.different},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(191).inherits;s(n,o),n.prototype.isRespected=function(){return!0},n.prototype.getText=function(){return""},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits,r=i(30);a(n,o),n.prototype.initialize=function(e){var t=this;this._name="",r.getObject("SubAreas",this.value,function(i,n){return i?e(i):(t._name=n.nameId,void e())})},n.prototype.getText=function(){if(!this._name)return"";switch(this.operator){case o.operators.equal:return s("ui.tooltip.beInSubarea",[this._name]);case o.operators.different:return s("ui.tooltip.dontBeInSubarea",[this._name]);default:return""}},n.prototype.getCriterion=function(){return window.gui.playerData.position.subAreaId},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){return s(this.operator===o.operators.equal&&1===this.value||this.operator===o.operators.different&&0===this.value?"ui.tooltip.beSubscirber":"ui.tooltip.dontBeSubscriber")},n.prototype.getCriterion=function(){var e=window.gui.playerData.identification;return e.subscriptionEndDate>0||e.hasRights?1:0},e.exports=n},function(e,t,i){function n(e){o.call(this,e),this._text=s("ui.criterion.unusableItem")}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.isRespected=function(){return!0},n.prototype.getText=function(){return this._text},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getKeyText=function(){return s("ui.common.weight")},n.prototype.getCriterion=function(){return window.gui.playerData.inventory.weight},e.exports=n},function(e,t,i){function n(e){o.call(this,e)}var o=i(517),s=i(29).getText,a=i(191).inherits;a(n,o),n.prototype.getText=function(){switch(this.key){case"Oo":var e=window.gui.databases.ItemTypes[this.value].nameId;return s("ui.criterion.cosmeticItemSlotType",e);case"Pn":switch(this.value){case 1:return s("ui.criterion.cosmeticItemSlot",s("ui.common.inventoryType2"));case 6:return s("ui.criterion.cosmeticItemSlot",s("ui.common.inventoryType10"));case 7:return s("ui.criterion.cosmeticItemSlot",s("ui.common.inventoryType11"));case 8:return s("ui.criterion.cosmeticItemSlot",s("ui.common.inventoryType8"));case 15:return s("ui.criterion.cosmeticItemSlot",s("ui.common.inventoryType7"));default:return""}default:return""}},n.prototype.getCriterion=function(){var e=window.gui.playerData.inventory.equippedItems;switch(this.key){case"Oo":for(var t=window.gui.databases.ItemTypes[this.value].possiblePositions,i=0;i<t.length;i++)if(e[t[i]]){if(e[t[i]].item)return e[t[i]].item.typeId;console.error("Equipped items not initialized yet to set criterion `"+this.key+"`")}return null;case"Pn":return window.gui.playerData.inventory.equippedItems[this.value]?this.value:null;default:return""}},e.exports=n},function(e,t,i){function n(e){u.call(this),this.isItemInstance=!0,this.exchangeAllowed=!0,this.isInitialised=!1,this.effectsMap={},this.shortName="";for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}function o(e){for(var t=0;t<y.length;t+=1)if(y[t]>e)return t;
return y.length}function s(e){for(var t=0;t<e.length;t+=1){var i=e[t],n=i.effects;if(n.length){var s=0,a=0,r=i.item;if(r&&r.isWeapon)switch(r.typeId){case 7:s="X",a=1;break;case 4:s="T",a=1;break;case 8:s="L",a=1}for(var l=0;l<n.length;l+=1){var c=n[l];if(c&&c.effect){switch(i.effectsMap[c.effectId]=c,s&&c.isDamageEffect()&&(c.zoneShape=s,c.zoneSize=a),c.effectId){case g.ACTION_PETS_LAST_MEAL:i.livingObjectFoodDate=c.description;break;case b:i.livingObjectId=c.value,c.isLivingProperty=!0;break;case g.ACTION_ID_LIVING_OBJECT_MOOD:i.livingObjectMood=c.value,c.isLivingProperty=!0;break;case g.ACTION_ID_LIVING_OBJECT_SKIN:i.livingObjectSkin=c.value,c.isLivingProperty=!0;break;case g.ACTION_ID_LIVING_OBJECT_CATEGORY:i.livingObjectCategory=c.value,c.isLivingProperty=!0;break;case g.ACTION_ID_LIVING_OBJECT_LEVEL:var u=o(c.value),d=c.value-y[u-1],h=y[u]-y[u-1]||0;i.livingObjectLevel=u,i.livingObjectXp=d,i.livingObjectMaxXp=h,c.isLivingProperty=!0;break;case g.ACTION_SHIELD_EXPERIENCE:var p=i.item.shieldModelId,m=1e4*c.diceSide+c.value,f=window.gui.databases.ShieldModelsLevels||{},_=f[p];_||(console.warn(new Error("shieldModelId "+p+" unknown from DB for item "+i.id)),_={});for(var v=_.requiredXpLevels||[],w=100,M=0;M<v.length;M++)if(m<v[M]){w=M;break}c.diceNum=w,c.forceDescriptionRefresh()}139!==c.effectId&&110!==c.effectId||(i.isOkForMultiUse=!0),983===c.effectId&&(i.exchangeAllowed=!1),c.effectId!==C&&c.effectId!==I||(i.exchangeable=!1)}}}}}function a(e,t){var i=[];c.series([function(t){for(var n=[],o={},s=0;s<e.length;s++){var a=e[s];if(a.livingObjectCategory){var r=a.livingObjectId||a.objectGID;n.push(r),o[s]=r}}return n.length?void p.getDataMap("LivingObjectSkinJntMood",n,function(n,s){if(n)return t(n);for(var a=0;a<e.length;a++)if(void 0!==o[a]){var r=e[a],l=s[o[a]].moods;r.iconId=l[r.livingObjectMood][r.livingObjectSkin-1],i.push(r)}t()}):t()},function(t){for(var n=0;n<e.length;n++){var o=e[n];o.effectsMap[A]&&(o.iconId=o.effectsMap[A].iconId,i.push(o))}t()},function(e){if(!i.length)return e();var t=5;c.eachLimit(i,t,function(e,t){e._loadDifferentImage(t)},e)}],t)}function r(e,t,i){for(var n=t&&t.monstersCache,o={},s={},a=!1,r=0;r<e.length;r++){var l=e[r];switch(l.effectsMap&&l.effectsMap[1081]&&(l.weight+=l.effectsMap[1081].getParams()[0]),l.item.id){case w:case T:case M:l.shortName="";break;default:l.shortName=l.item.getRawName(),l._initializationDone();continue}for(var c=[],u=0;u<l.effects.length;u+=1){var d=l.effects[u].getParams(),h=d[2];h&&(c.push({monsterId:h,monsterGrade:d[0]-1}),n&&n[h]||(o[h]=!0))}s[r]=c,a=!0}return a?(o=Object.keys(o),void p.getDataMap("Monsters",o,function(t,o){if(t)return i(t);for(var a,r,l="",c={regularSoulStone:function(e,t){var i=e.grades[t];i&&i.level>a&&(a=i.level,l=e.nameId)},bossAndMiniBoss:function(e){(e.isBoss||e.isMiniBoss)&&(l?l+=", "+e.nameId:l=e.nameId)}},u=0;u<e.length;u++)if(s[u]){var d=e[u];switch(a=0,l="",r=null,d.item.id){case w:r=c.regularSoulStone;break;case T:case M:r=c.bossAndMiniBoss}for(var h=0;h<s[u].length;h++){var p,m=s[u][h].monsterId,f=s[u][h].monsterGrade;if(n){if(p=n[m],!p){if(!o[m])continue;p=o[m],n[m]=o[m]}}else{if(!o[m])continue;p=o[m]}r(p,f)}d.shortName=l,d._initializationDone()}i()})):i()}function l(e,t){return t=t||"(The souls are gone...)",f(e)+f("ui.common.colon")+t}var c=i(31),u=i(209).EventEmitter,d=i(400),h=i(191).inherits,p=i(30),m=i(202),f=i(29).getText,g=i(399),_=i(575),v=i(189),y=[0,10,21,33,46,60,75,91,108,126,145,165,186,208,231,255,280,306,333,361],b=970,w=7010,M=10417,T=10418,C=981,I=982,A=1151;h(n,u),e.exports=n,n.prototype.setItem=function(e){this.exchangeable=e.exchangeable,this.isOkForMultiUse=!1,this.weight=e.realWeight,this.item=e,this.id=e.id},n.prototype.isLinked=function(){return!this.exchangeable||!this.exchangeAllowed},n.prototype.isLinkedCharacter=function(){return!!this.effectsMap[C]},n.prototype.isMimicryHost=function(){return!!this.effectsMap[A]},n.prototype.isStarvingPet=function(){return 18===this.item.typeId},n.prototype.isCosmetic=function(){return!!this.item&&this.item.isCosmetic()},n.prototype.isShield=function(){return!!this.item&&this.item.isShield()},n.prototype.isShieldManageable=function(){return!!this.item&&(this.isShield()&&this.item.shieldModelId>0&&window.gui.playerData.inventory.objects[this.objectUID]&&this.effectsMap[g.ACTION_SHIELD_EXPERIENCE]||this.item.id===_.fakeShieldId&&window.gui.playerData.isOnShieldTutorial())},n.prototype.isFullSoulStone=function(){return!!this.item&&this.item.isFullSoulStone()},n.prototype._loadDifferentImage=function(e){var t=this;m.preloadImage("gfx/items/"+this.iconId+".png",function(i){t.image=i,e()})},n.prototype._initializationDone=function(){this.isInitialised=!0,this.emit("initialised")},n.prototype.initialize=function(e){console.error("ItemInstance.initialized called"),n.initializeList([this],null,e)},n.initializeList=function(e,t,i){for(var n=[],o=0;o<e.length;o+=1)for(var l=e[o],c=0;c<l.effects.length;c+=1){var u=l.effects[c];u.effectCaller="ItemInstance id "+l.id,n.push(u)}d.createEffectInstances(n,function(n,o){if(n)return i(n);for(var l=0;l<e.length;l++){var c=e[l],u=c.effects.length;c.effects=u>0?o.splice(0,u):[]}s(e),a(e,function(n){return n?i(n):void r(e,t,i)})})},n.prototype.getRawName=function(){if(!this.isInitialised)return"";var e;return e=this.objectGID===w?l("ui.item.soul",this.shortName):this.objectGID===T?l("ui.item.miniboss",this.shortName):this.objectGID===M?l("ui.item.boss",this.shortName):this.shortName},n.prototype.doDefaultAction=function(){if(this.isInitialised){var e=this.getProperty("objectUID");if(this.getProperty("usable")){if(!this.getProperty("type").needUseConfirm)return void window.dofus.sendMessage("ObjectUseMessage",{objectUID:e});window.gui.openConfirmPopup({title:f("ui.common.confirm"),message:f("ui.common.confirmationUseItem",this.getProperty("nameId")),cb:function(t){t&&window.dofus.sendMessage("ObjectUseMessage",{objectUID:e})}})}else this.item.isEquippable()&&window.gui.playerData.inventory.equipItem(e)}},n.prototype.getName=function(){if(!this.isInitialised)return"";var e=v(),t=this.getRawName();return e.gui.playerData.isModeratorOrMore()&&(t+=" ("+this.objectGID+")"),t},n.prototype.getItem=function(){return this.item},n.prototype.getItemInstance=function(){return this},n.prototype.getProperty=function(e){if(!this.isInitialised)return null;switch(e){case"nameId":return this.getName();default:return this.hasOwnProperty(e)?this[e]:this.item.getProperty(e)}}},function(e,t){t.questFilterId=3,t.fakeShieldId=17128,t.fakeRune={_type:"ObjectItem",position:63,objectGID:17130,effects:[{_type:"ObjectEffectDice",actionId:2826,diceNum:0,diceSide:0,diceConst:2500}],objectUID:1,quantity:1}},function(e,t,i){function n(){return this.tooltipContent||(this.tooltipContent=new u(this.rowContent)),this.tooltipContent}function o(e,t,i){m.call(this,"div",{className:"ShopViewer"}),i=i||{},this.itemTypes={},this._totalPrice=0,this._createDom(e,t,i)}function s(e,t){return e.objectGID===t}i(577);var a=i(248).addTooltip,r=i(252),l=i(191).inherits,c=i(578),u=i(588),d=i(509),h=i(258).playUiSound,p=i(593),m=i(235);l(o,m),e.exports=o,o.prototype._createDom=function(e,t,i){var o=this;i.manualFiltering||(this.itemFilter=this.appendChild(new c({noSorting:!0}))),this.table=this.appendChild(new p(e,t,i.tableOption)),this.table.on("rowSlidedLeft",function(e,t){h("RIGHT_TO_LEFT_SWITCH"),o.emit("rowSlidedLeft",e,t)}),this.table.on("rowSlidedRight",function(e,t){h("LEFT_TO_RIGHT_SWITCH"),o.emit("rowSlidedRight",e,t)}),this.table.on("rowAdded",function(e,t,i){i.tooltipContent=null,a(i,n)}),this.table.on("rowTap",function(e,t){h("GEN_BUTTON"),o.emit("itemSelected",t)}),this.itemFilter&&this._setupFiltering()},o.prototype.setHeader=function(e){this.table.setColumnHeader("name",e)},o.prototype._setupFiltering=function(){var e,t,i,n,o,s=d.getItemTypeMap(),a=this;this.itemFilter.on("filter",function(s,l,u){e=s,t=s!==c.filters.all,i=l,n=l!==c.subFilters.all,o=u?r.simplifyString(u):null,a.table.filter()}),this.table.addFilter(function(a){var l=a.getItem(),c=s[l.typeId].category;if(t&&c!==e)return!1;if(n&&l.typeId!==i)return!1;if(o&&a.isFullSoulStone())for(var u=0;u<a.effects.length;u++)if(a.effects[u]&&r.simplifyString(a.effects[u].description).indexOf(o)!==-1)return!0;return!o||l.getNameForSearch().indexOf(o)!==-1})},o.prototype.filter=function(e){this.table.filter(e)},o.prototype._unregisterItemType=function(e){var t=this.table.getRow(e);if(t){var i=t.rowContent,n=i.getItem().typeId;this.itemTypes[n]&&(this.itemTypes[n]--,0===this.itemTypes[n]&&delete this.itemTypes[n])}},o.prototype._registerItemType=function(e){var t=e.getItem().typeId;return this.itemTypes[t]?(this.itemTypes[t]++,!1):(this.itemTypes[t]=1,!0)},o.prototype._collectItemTypesAndIncrementTotalPrice=function(e,t){if(this.itemFilter){for(var i=!1,n=0;n<e.length;n++){t&&this._incrementTotalPrice(e[n].objectPrice);var o=this.table.getIdFn(e[n]);this.table.hasRow(o)||(i|=this._registerItemType(e[n]))}t&&this.emit("totalPriceUpdated",this._totalPrice),i&&this.itemFilter.updateSubFilters(Object.keys(this.itemTypes))}},o.prototype.removeItems=function(e,t){for(var i=0;i<e.length;i++)t&&this._decrementTotalPrice(this.getItem(e[i]).objectPrice),this._unregisterItemType(e[i]);this.table.delRows(e,!0),t&&this.emit("totalPriceUpdated",this._totalPrice)},o.prototype.getItemCount=function(){return this.table.getRowCount()},o.prototype.selectItem=function(e){this.table.selectRow(e)},o.prototype.getItem=function(e){var t=this.table.getRow(e);return t?t.rowContent:null},o.prototype.findItemByGID=function(e){return this.table.findRow(s,e)},o.prototype.selectFilter=function(e){this.itemFilter.selectSubfilter(e)},o.prototype.clearContent=function(){this.itemTypes={},this._totalPrice=0,this.table.clearContent()},o.prototype._incrementTotalPrice=function(e){this._totalPrice+=e},o.prototype._decrementTotalPrice=function(e){this._totalPrice-=e},o.prototype.setItemList=function(e,t){this.clearContent(),this.itemFilter&&(this._collectItemTypesAndIncrementTotalPrice(e,t),e.length||this.itemFilter.updateSubFilters([]),this.itemFilter.reset()),this.table.addList(e,!0)},o.prototype.addItems=function(e,t){this._collectItemTypesAndIncrementTotalPrice(e,t),this.table.addList(e,!0,!0)},o.prototype.addItemsAndHighlightThem=function(e,t){this._collectItemTypesAndIncrementTotalPrice(e,t),this.selectFilter(e[0].getProperty("typeId")),this.table.addList(e,!0,!0),this.selectItem(e[0].objectUID)},o.prototype.setPlaceholder=function(e){this.table.setPlaceholderText(e)},o.prototype.refresh=function(){this.table.placeholder&&this.table.placeholder.refresh(),this.table.scroller.refresh()}},function(e,t){},function(e,t,i){function n(e){h.call(this,"div",{className:"ItemFilters"}),e=e||{},this._withAllCategoriesBtn=!e.noAllCategory,this._withSorting=!e.noSorting,this._withTagBar=!!e.withTagBar,this._selectedFilter=null,this._selectedSubFilter=null,this._sortOrderMap={},this._currentSorting=g,this._currentText="",this._filterButtonList={},this._selectList={},this._subFiltersSelect=[],this._createDom(),this._switchFilterInput("category"),this._refreshSortOrder()}function o(){this.myItemFilters._tapOnMainCategory(this.filter)}function s(){var e=this.itemFilters;switch(e._delFilterButton(this.filterName),this.filterName){case"CAT":return e._updateFilterDisplay(y);case"SUBCAT":return e._updateFilterDisplay(e._selectedFilter,y);case"TEXT":return e._textChangedHandler("");case"SORTING":return e._resetSortOrder();default:console.error("Invalid filter "+this.filterName)}}i(579);var a=i(248).addTooltip,r=i(506),l=i(29).getText,c=i(191).inherits,u=i(509),d=i(246),h=i(235),p=i(580),m=i(586),f=i(575),g="none",_="DESC",v="*",y=-1,b={all:y};for(var w in u.categories)b[w]=u.categories[w];var M,T,C,I={all:y},A=[b.all,b.equipment,b.consumables,b.resources,b.quest,b.preset],S=["category","search","sort"];c(n,h),e.exports=n,n.filters=b,n.subFilters=I,n.prototype._createDom=function(){M||(M=[l("ui.common.all"),l("ui.common.equipement"),l("ui.common.usableItems"),l("ui.common.ressources"),l("ui.common.quest.objects"),l("ui.common.presets")]);var e=this.createChild("div",{className:"filters"});this._filterBtnMap={},this._subFiltersBox=this.createChild("div",{className:"subFiltersBox"}),this._switchFilteringBtn=this._subFiltersBox.appendChild(new d({className:"switchBtn",addIcon:!0,tooltip:l("ui.common.sortOrSearch")},this._switchFilterInput.bind(this,"NEXT"))),this._categoryBox=this._subFiltersBox.createChild("div",{className:"categories"});for(var t=e.createChild("div",{className:"content"}),i=this._itemTypeChangeHandler.bind(this),n=0,s=A.length;n<s;n++){var r=A[n],c=["filter",u.getCategoryName(r)||"all"],h=t.appendChild(new d({className:c},o));this._filterButtonList[r]=h,this._filterBtnMap[r]=h,a(h,M[n]),h.filter=r,h.myItemFilters=this,h.createChild("div",{className:"icon"});var f=this._categoryBox.appendChild(new m({className:"subFilterSelect"}));this._subFiltersSelect.push(f),f.on("change",i),f.hide(),this._selectList[r]={wdSelect:f}}if(this._searchBox=this._subFiltersBox.appendChild(new p({isLiveSearch:!0})),this._searchBox.on("search",this._textChangedHandler.bind(this)),this._searchBox.setPlaceholder(l("tablet.common.filter")),this._sortBox=this._subFiltersBox.createChild("div",{className:"sortBox"}),this._sortSelector=this._sortBox.appendChild(this._createSortSelector()),this._sortSelector.on("change",this._sortChangeHandler.bind(this)),this._sortOrderBtn=new d({className:"sortOrderBtn",addIcon:!0},this._switchSortOrder.bind(this)),this._sortBox.appendChild(this._sortOrderBtn),this._withTagBar){var g=this.createChild("div",{className:"tagZone"});this._tagBar=g.createChild("div",{className:"tagBar"}),this._tagButtons=[]}},n.prototype._itemTypeChangeHandler=function(e){this._updateFilterDisplay(this._selectedFilter,parseInt(e,10))},n.prototype._sortChangeHandler=function(e){this._currentSorting=e,this._refreshSortOrder(),this._requestSort()},n.prototype._switchSortOrder=function(){var e=this._sortOrderMap[this._currentSorting],t="ASC"===e?"DESC":"ASC";this._sortOrderMap[this._currentSorting]=t,this._refreshSortOrder(),this._requestSort()},n.prototype._resetSortOrder=function(){this._currentSorting=g,this._sortOrderMap[g]=_,this._sortSelector.selectFirst(),this._refreshSortOrder(),this._requestSort()},n.prototype.getCurrentSorting=function(){var e=this._sortOrderMap[this._currentSorting];return{by:this._currentSorting,order:e}},n.prototype._refreshSortOrder=function(){var e=this._sortOrderMap[this._currentSorting];this._sortOrderBtn.toggleClassName("ascending","ASC"===e),this._sortOrderBtn.toggleClassName("descending","DESC"===e),this._updateSortingTag()},n.prototype._updateSortingTag=function(){if(this._withTagBar){this._delFilterButton("SORTING");var e=this._sortOrderMap[this._currentSorting];if(this._currentSorting!==g||e!==_){var t=T[C[this._currentSorting]].labels,i=t["ASC"===e?0:1];this._addFilterButton("SORTING",i).addClassNames("sorting")}}},n.prototype._requestSort=function(){this.emit("sort",[this._currentSorting],this._sortOrderMap[this._currentSorting])},n.prototype._createSortSelector=function(){var e="A..Z",t="Z..A",i=l("ui.common.category"),n=l("ui.common.quantity"),o=l("tablet.filter.light"),s=l("tablet.filter.heavy"),a=l("tablet.filter.cheap"),r=l("tablet.filter.costly");T=[{value:g,defOrder:_,text:l("tablet.sortBy.default"),labels:[l("tablet.filter.older"),"new"]},{value:"name",defOrder:"ASC",text:l("tablet.sortBy.name"),labels:[e,t]},{value:"weight",defOrder:"DESC",text:l("tablet.sortBy.weight"),labels:[o,s]},{value:"totalWeight",defOrder:"DESC",text:l("tablet.sortBy.weight.lot"),labels:[v+o,v+s]},{value:"quantity",defOrder:"DESC",text:l("tablet.sortBy.quantity"),labels:["1..999 "+n,"999..1 "+n]},{value:"averagePrice",defOrder:"DESC",text:l("tablet.sortBy.averageprice"),labels:[a,r]},{value:"totalAveragePrice",defOrder:"DESC",text:l("tablet.sortBy.averageprice.lot"),labels:[v+a,v+r]},{value:"level",defOrder:"DESC",text:l("tablet.sortBy.level"),labels:[l("tablet.filter.lowLevel"),l("tablet.filter.highLevel")]},{value:"category",defOrder:"ASC",text:l("tablet.sortBy.category"),labels:[e+" "+i,t+" "+i]}];var c=new m({className:"sortSelector",removeWords:l("tablet.sortBy.removeWords")});C={};for(var u=0;u<T.length;u++){var d=T[u];c.addOption(d.text,d.value),this._sortOrderMap[d.value]=d.defOrder,C[d.value]=u}return c},n.prototype._switchFilterInput=function(e){var t=this._filterDisplayed;if("NEXT"===e){var i=S.indexOf(this._filterDisplayed),n=this._withSorting?S.length:S.length-1;i=(i+1)%n,this._filterDisplayed=S[i]}else this._filterDisplayed=e;this._switchFilteringBtn.replaceClassNames([t],[this._filterDisplayed]),this._categoryBox.toggleDisplay("category"===this._filterDisplayed),this._searchBox.toggleDisplay("search"===this._filterDisplayed),this._sortBox.toggleDisplay("sort"===this._filterDisplayed)},n.prototype._setCategoryFilter=function(e,t){var i=!1;if(e!==this._selectedFilter){if(this._filterButtonList[this._selectedFilter]&&(this._filterButtonList[this._selectedFilter].delClassNames("selected"),this._selectList[this._selectedFilter].wdSelect.hide()),this._selectedFilter=e,this._filterButtonList[e].addClassNames("selected"),e===b.preset)return this._subFiltersBox.hide(),this._withTagBar&&this._tagBar.hide(),!0;this._subFiltersBox.show(),this._withTagBar&&(this._tagBar.show(),this._delFilterButton("CAT"),e!==y&&this._addFilterButton("CAT",M[e+1]));var n=this._selectList[e].wdSelect;n.show(),i=!0}return!(!i&&void 0===t)&&(void 0===t&&(t=this._selectedSubFilter),this._setSubCategoryFilter(t)|i)},n.prototype._setSubCategoryFilter=function(e){var t=this._selectList[this._selectedFilter].wdSelect;return t.hasValue(e)?t.select(e,!0):(e=t.selectFirst(!0),void 0===e&&(e=y)),e!==this._selectedSubFilter&&(this._selectedSubFilter=e,this._withTagBar&&(this._delFilterButton("SUBCAT"),e!==y&&this._addFilterButton("SUBCAT",t.getCurrentText())),!0)},n.prototype._setTextFilter=function(e){return e!==this._currentText&&(this._searchBox.setValue(e),this._currentText=e,this._withTagBar&&(this._delFilterButton("TEXT"),e&&this._addFilterButton("TEXT",'"'+e+'"')),!0)},n.prototype._textChangedHandler=function(e){this._setTextFilter(e)&&this._requestFilter()},n.prototype._updateFilterDisplay=function(e,t){this._setCategoryFilter(e,t)&&this._requestFilter()},n.prototype._requestFilter=function(){this.emit("filter",this._selectedFilter,this._selectedSubFilter,this._searchBox.getValue())},n.prototype._tapOnMainCategory=function(e){this._updateFilterDisplay(e)},n.prototype.selectCategory=function(e){this._switchFilterInput("category"),this._updateFilterDisplay(e,y)},n.prototype.toggleCategoryDisplay=function(e,t){this._filterBtnMap[e].toggleDisplay(t)},n.prototype.selectSubfilter=function(e){var t=this._selectedFilter,i=this._selectList[t].wdSelect;return!!i.hasValue(e)&&(i.select(e,!0),this._updateFilterDisplay(t,e),!0)},n.prototype.updateSubFilters=function(e){var t=u.getItemTypeMap(),i=e.sort(function(e,i){return t[e].nameId.localeCompare(t[i].nameId)});for(var n in this._selectList)this._selectList[n].wdSelect.clearContent(),this._withAllCategoriesBtn&&this._selectList[n].wdSelect.addOption(l("ui.common.allTypesForObject"),I.all);for(var o=this._selectList[b.all],s=0,a=i.length;s<a;s+=1){var r=t[i[s]],c=this._selectList[r.category];c.wdSelect.addOption(r.nameId,r.id),o.wdSelect.addOption(r.nameId,r.id)}},n.prototype.reset=function(e){var t=this._setCategoryFilter(y,y),i=this._setTextFilter("");(!e&&t||i)&&this._requestFilter()};var E=0;n.prototype.getEquipmentButton=function(){return this._filterBtnMap[E]},n.prototype.getQuestButton=function(){return this._filterBtnMap[f.questFilterId]};var x={equipment:!0,consumables:!0,resources:!0,quest:!1,preset:!1};n.prototype.setAvailableCategories=function(e){for(var t in u.categories){var i=!(!e||!e[t])||x[t];this.toggleCategoryDisplay(u.categories[t],i),this._selectedFilter!==u.categories[t]||i||this.selectCategory(y)}},n.prototype._addFilterButton=function(e,t){var i={};t[0]===v?(t=t.substr(1),i.withIcon=!0,i.tooltip=t+" ("+l("tablet.lot")+")"):i.tooltip=t;var n=new r(t,s,e,i);return n.itemFilters=this,this._tagButtons.push(n),this._tagBar.appendChild(n),this._tagBar.show(),n},n.prototype._delFilterButton=function(e){for(var t=0;t<this._tagButtons.length;t++){var i=this._tagButtons[t];if(i.filterName===e)return this._tagBar.removeChild(i),void this._tagButtons.splice(t,1)}}},function(e,t){},function(e,t,i){function n(e){h.call(this,"div",{className:"searchBox"}),e=e||{},this.isLiveSearch=!!e.isLiveSearch,this.maxLength=e.maxLength||50,this._createContent(e.label),e.placeholder&&this.setPlaceholder(e.placeholder)}function o(){var e=this.mySearchBox;if(e.isLiveSearch){var t=e.searchInput.getValue();e.emit("search",t),e.cancelBtn.toggleDisplay(!!t)}else e.cancelBtn.show()}function s(){var e=this.mySearchBox,t=e.searchInput.getValue();return 0===t.length?a.call(e.cancelBtn):!e.isLiveSearch&&t.length<p?d.showNotification(l("ui.common.searchFilterTooltip"),e):void(t!==e.lastEmittedValue&&(e.lastEmittedValue=t,e.searchInput.blur(),e.emit("search",t)))}function a(){var e=this.mySearchBox;e.cancelBtn.hide(),e.clear(),e.searchInput.blur(),e.emit("search","")}i(581);var r=i(246),l=i(29).getText,c=i(191).inherits,u=i(582),d=i(584),h=i(235),p=3;c(n,h),e.exports=n,n.prototype.clear=function(){this.lastEmittedValue=null,this.searchInput.setValue(""),this.cancelBtn.hide()},n.prototype.setValue=function(e){this.searchInput.setValue(e),this.cancelBtn.toggleDisplay("string"==typeof e&&""!==e)},n.prototype.getValue=function(){return this.searchInput.getValue()},n.prototype.setPlaceholder=function(e){this.searchInput.setPlaceholder(e)},n.prototype._createContent=function(e){e&&this.createChild("div",{className:"label",text:e});var t=this.createChild("div",{className:"inputFrame"}),i=this.searchInput=t.appendChild(new u({attr:{maxLength:this.maxLength}}));i.mySearchBox=this,i.on("change",o),i.on("validate",s);var n=this.cancelBtn=t.appendChild(new r({className:"cancelBtn",addIcon:!0,hidden:!0},a));if(n.mySearchBox=this,!this.isLiveSearch){var l=this.appendChild(new r({className:"searchBtn",addIcon:!0},s));l.mySearchBox=this}},n.prototype.showAsSearching=function(e){this.toggleClassName("spinner",e),this.searchInput.setEnable(!e)},n.prototype.setEnable=function(e){this.searchInput.setEnable(e)}},function(e,t){},function(e,t,i){function n(e,t){e=e||{};var i={type:"text",spellcheck:"false",autocapitalize:"off",autocorrect:"off",autocomplete:"off"};for(var n in e.attr)i[n]=e.attr[n];e.attr=i,s.call(this,"input",e),this.addClassNames("InputBox",i.type),this.allowDomEvents(),this.on("dom.input",function(){this.emit("change",this.rootElement.value)}),this.on("dom.blur",function(){this.emit("blur")}),this.on("dom.touchend",function(){r.isIOS?document.activeElement!==this.rootElement&&this.focus():this.focus()}),this.on("dom.keypress",function(e){13===e.which&&(t&&t(this),this.emit("validate"))})}i(583);var o=i(191).inherits,s=i(235),a=i(482),r=i(185);o(n,s),e.exports=n,n.prototype.setValue=function(e,t){this.rootElement.value=e,t&&this.emit("change",e)},n.prototype.setPlaceholder=function(e){this.rootElement.placeholder=e},n.prototype.getValue=function(){return this.rootElement.value},n.prototype.setReadonly=function(e){e===!1?this.rootElement.removeAttribute("readonly"):this.rootElement.setAttribute("readonly","readonly")},n.prototype.blur=function(){this.rootElement.blur(),a.hide()},n.prototype.focus=function(){this.rootElement.focus()},n.prototype.disable=function(){this.rootElement.disabled=!0},n.prototype.enable=function(){this.rootElement.disabled=!1},n.prototype.setEnable=function(e){this.rootElement.disabled=!e},n.prototype.setCaretPosition=function(e){this.rootElement.setSelectionRange(e,e)}},function(e,t){},function(e,t,i){function n(){r=window.gui.wBody.appendChild(new a({className:"notification"})),r.appendChild(new s({className:"closeButton",scaleOnPress:!0},function(){t.closeNotifications()}))}function o(){t.closeNotifications()}i(585);var s=i(246),a=i(248),r=null,l=!1;t.showClosableNotification=function(e,t,i){return r||n(),l||(window.gui.wBody.on("dom.touchend",o),l=!0),i&&i.centerOnTarget?r.updateAndAppearAt(e,t,{centerOnTarget:!0}):r.updateAndAppearAt(e,t),r},t.closeNotifications=function(){l&&(window.gui.wBody.removeListener("dom.touchend",o),l=!1),r&&r.closeTooltip()},t.showNotification=function(e,t,i){a.showNotification(e,t,i)}},function(e,t){},function(e,t,i){function n(e){function t(e){i._setValue(e,!1)}e=e||{},l.call(this,"div",{className:"Selector"}),this.addClassNames(e.className),this.removeWords=e.removeWords?e.removeWords.split("|"):null;var i=this;this._valuePairs=[],this._currentValue=null,this._isEnabled=!0,this._dropDownSelector=this.appendChild(new c({className:["selectorContent"],scaleOnPress:!1,text:""})),a(this._dropDownSelector,o),this.buttonOpen=this.createChild("div",{className:"buttonOpen"}),this._dropDownSelector.on("tap",function(){if(null!==i._currentValue){var e=i._getValueIndex(i._currentValue);window.gui.dropDown.setupDropDown(this,i._valuePairs,e,t)}})}function o(){return this._tooltipText}function s(e,t){return e.text.localeCompare(t.text)}i(587);var a=i(248).addTooltip,r=i(191).inherits,l=i(235),c=i(246);r(n,l),e.exports=n,n.prototype._getValueIndex=function(e){for(var t=this._valuePairs,i=0;i<t.length;i++)if(t[i].value===e)return i;return-1},n.prototype.addOption=function(e,t){t||0===t||(t=""),null===this._currentValue&&(this._currentValue=t,this._setCurrentText(e,0),this.setEnable(!0)),this._valuePairs.push({text:e,value:t})},n.prototype.insertOptionAtTop=function(e,t){t||0===t||(t=""),this._valuePairs.unshift({text:e,value:t})},n.prototype.sortValues=function(){this._valuePairs.sort(s)},n.prototype.setEnable=function(e){e=!!e&&null!==this._currentValue,e!==this._isEnabled&&(this._isEnabled=e,this._dropDownSelector.setEnable(e),this.toggleClassName("disabled",!e))},n.prototype.hasValue=function(e){return this._getValueIndex(e)!==-1},n.prototype.select=function(e,t){this._setValue(e,t)},n.prototype.selectFirst=function(e){if(this._valuePairs.length){var t=this._valuePairs[0].value;return this._setValue(t,e),t}},n.prototype._setValue=function(e,t){var i=this._getValueIndex(e);if(i===-1)return console.error("Selecting invalid value:",e);var n=this._currentValue;this._currentValue=e,window.gui.dropDown.select(i);var o=this._valuePairs[i],s=this._setCurrentText(o.text,i);t||this.emit("change",e,n,s)},n.prototype._setCurrentText=function(e,t){if(this._dropDownSelector._tooltipText=e,this.removeWords&&0!==t){for(var i=0;i<this.removeWords.length;i++)e=e.replace(this.removeWords[i],"");e=e[0].toLocaleUpperCase()+e.substr(1)}return this._dropDownSelector.setText(e),e},n.prototype.getCurrentText=function(){return this._dropDownSelector.getText()},n.prototype.setValue=function(e){this._setValue(e,!0)},n.prototype.clearContent=function(){this._valuePairs=[],this._currentValue=null,this._dropDownSelector.setText(""),window.gui.dropDown.clearContent(),this.setEnable(!1)},n.prototype.toggleOption=function(e,t){if(e||0===e){var i=this._valuePairs[e];i&&(t=void 0===t?i.disabled:t,i.disabled=!t)}},n.prototype.setOptionHidden=function(e,t){var i=this._valuePairs[e];return i?void(i.hidden=!!t):console.warn("Invalid selector option",e)}},function(e,t){},function(e,t,i){function n(e,t){return e.setText(t.getProperty("descriptionId")),!0}function o(e,t){if(!t.getProperty("exchangeable"))return!1;var i=M("ui.common.averagePrice")+M("ui.common.colon"),n=t.getProperty("averagePrice");return i+=n===-1?M("ui.item.averageprice.unavailable"):_.kamasToString(n),e.setText(i),!0}function s(e,t){var i=window.gui.playerData.belongings.getItemCounts(t.getProperty("id")),n=i[I],o=i[A],s=i[S],r=window.gui.playerData.characterBaseInformations.level;return e.clearContent(),n&&0!==n&&a(e,M("ui.common.inventory"),n,!1),void 0!==o&&0!==o&&a(e,M("tablet.bank"),o,!0),r>=C.CHAR_MIN_LEVEL_RIDE&&void 0!==s&&0!==s&&a(e,M("ui.common.ride"),s,!0),!0}function a(e,t,i,n){if(null!==i){var o=t+M("ui.common.colon")+i;n&&(o+=" ("+M("tablet.estimation")+")"),e.createChild("div",{text:o})}else{var s=e.createChild("div");s.createChild("span",{text:t+M("ui.common.colon")}),s.createChild("span",{text:"?",className:"unknown"})}}function r(e,t){return e.setEffectsFromItem(t),!0}function l(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=n.text,s=t.createChild("div",{className:"singleTab"});if("string"==typeof o)s.setHtml(E+" "+o);else for(var a=0;a<o.length;a++){var r=o[a];s.createChild("div",{text:r})}n.isMalus&&s.addClassNames("malus")}}function c(e,t){var i=t.getProperty("targetConditionsFormatted"),n=t.getProperty("conditionsFormatted");return!(!i.length&&!n.length)&&(e.clearContent(),e.createChild("div",{className:"conditionsTitle",text:M("ui.common.conditions")+M("ui.common.colon")}),l(n,e),l(i,e),!0)}function u(e,t){var i,n="",o=e.getProperty("criticalHitBonus");o>0?i="+":o<0&&(i="-"),n+=M("ui.common.short.CriticalHit")+M("ui.common.colon")+"1/";var s=e.getProperty("criticalHitProbability");return n+=t?_.totalCriticalHitRate(s,t):s,i&&(n+=" ("+i+o+M("ui.common.damageShort")+")"),n}function d(e,t){var i=e.getProperty("criticalFailureProbability");if(t){var n=t.criticalMiss;i+=n.getTotalStat()}return(e.getProperty("criticalHitProbability")?" - ":"")+M("ui.common.short.CriticalFailure")+M("ui.common.colon")+"1/"+i+" "}function h(e,t){e.setText(t.getProperty("itemSetName"))}function p(e,t){var i=t.getItemInstance();if(i){var n=i.effectsMap[x];n&&e.createChild("div",{className:"extra",text:n.description})}}function m(e,t,i){if(e.name.setText(t.getProperty("nameId")),e.name.toggleClassName("etheral",!!t.getProperty("etheral")),i.showCategory===!1)e.category.hide();else{var n=t.getProperty("typeId"),o=y.getItemTypeMap();e.category.setText(M("ui.common.category")+M("ui.common.colon")+o[n].nameId),e.category.show()}i.showWeight===!1?e.weight.hide():(e.weight.setText(M("ui.common.short.weight",t.getProperty("weight"))),e.weight.show()),e.level.setText(M("ui.common.short.level")+" "+t.getProperty("level"));var s=e.extra;s.clearContent();var a=t.getProperty("itemSetId");if(t.getProperty("isWeapon")){e.points.ap.setText(M("ui.common.ap")+" : "+t.getProperty("apCost"));var r=t.getProperty("range"),l=t.getProperty("minRange");e.points.ra.setText(M("ui.common.ra")+" : "+l),e.points.range.setText(r!==l?" - "+r:""),e.points.show(),a&&a!==-1&&h(s.createChild("div",{className:"extra"}),t),t.getProperty("twoHanded")&&s.createChild("div",{className:"extra",text:M("ui.common.twoHandsWeapon")});var c=t.getProperty("maxCastPerTurn");if(c){var m=M("ui.item.maxUsePerTurn")+M("ui.common.colon")+c;s.createChild("div",{className:"extra",text:m})}t.getProperty("castInLine")&&r>1&&s.createChild("div",{className:"extra",text:M("ui.spellInfo.castInLine")}),!t.getProperty("castTestLos")&&r>1&&s.createChild("div",{className:"extra",text:M("ui.spellInfo.castWithoutLos")}),p(s,t);var f=t.getProperty("criticalFailureProbability"),g=t.getProperty("criticalHitProbability");if(i.showCritical&&(f||g)){var _="",v=window.gui.playerData.characters.mainCharacter.characteristics;g&&(_+=u(t,v)),f&&(_+=d(t,v)),s.createChild("div",{className:"extra",text:_})}}else e.points.hide(),a&&a!==-1&&h(s.createChild("div",{className:"extra"}),t),p(s,t);return!0}function f(e,t){T.call(this,"div",{className:"ItemDescription"}),this._buildDomElements(t),e&&this.updateUI(e,t)}i(589);var g=i(590),_=i(252),v=i(191).inherits,y=i(509),b=y.Item,w=y.ItemInstance,M=i(29).getText,T=i(235),C=i(277),I=0,A=1,S=2,E="&#149;",x=812,L={description:n,averagePrice:o,effects:r,conditions:c,remoteQuantity:s,header:m};v(f,T),e.exports=f,f.prototype._buildDomElements=function(e){var t=this._domElements={};t.header=this.createChild("div",{className:"header"});var i=t.header.createChild("div",{className:"nameAndLevel"});t.header.name=i.createChild("div",{className:"name"}),t.header.level=i.createChild("div",{className:"right"
});var n=t.header.createChild("div",{className:"categoryAndWeight"});t.header.category=n.createChild("div"),t.header.weight=n.createChild("div",{className:"right"});var o=t.header.points=t.header.createChild("div",{className:"pointsLine"});o.ap=o.createChild("span",{className:"ap"}),o.ra=o.createChild("span",{className:"ra"}),o.range=o.createChild("span"),t.header.extra=t.header.createChild("div",{className:"extra"}),t.effects=this.appendChild(new g(e)),t.conditions=this.createChild("div",{className:"topSpacing"}),t.description=this.createChild("div",{className:["topSpacing","description"]}),t.averagePrice=this.createChild("div",{className:"topSpacing"}),t.remoteQuantity=this.createChild("div",{className:["topSpacing","quantities"]})},f.prototype.updateUI=function(e,t){if(!(e instanceof b||e instanceof w))return console.error(new Error("ItemDescription: item is not Item nor ItemInstance"));if(this.currentItem=e,e.isItemInstance&&!e.isInitialised){var i=this;return e.once("initialised",function(){i.currentItem===e&&i.updateUI(e,t)})}t=t||{};for(var n in L){var o=this._domElements[n];t[n]!==!1&&L[n](o,e,t)?o.show():o.hide()}}},function(e,t){},function(e,t,i){function n(e){d.call(this,"div",e),this.addClassNames("EffectDescription")}function o(e){return e.requiresGlyphDescription()||e.requiresTrapDescription()||e.requiresBombDescription()}function s(e){if(!e.requiresInvocationDescription()||!e.subEffectDescription)return null;for(var t,i,n=new d("div"),o=Math.ceil(e.subEffectDescription.length/2),s=0;s<o;s++)t=n.createChild("div",{className:"monsterLine"}),i=t.createChild("div",{className:"column1"}),i.setHtml(h+" "+e.subEffectDescription[s]),e.subEffectDescription[o+s]&&(i=t.createChild("div",{className:"column2"}),i.setHtml(h+" "+e.subEffectDescription[o+s]));return n}function a(e){if(!o(e)||!e.subEffectDescription)return null;for(var t=new d("div"),i=0;i<e.subEffectDescription.length;i++){var n=t.createChild("div",{className:"singleTab"});n.setHtml(h+" "+e.subEffectDescription[i])}return t}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i],o=e.createChild("div",{className:"singleTab"});n.dbEffect.bonusType===-1?o.addClassNames("malus"):1===n.dbEffect.bonusType&&o.addClassNames("bonus"),n.isExotic&&o.addClassNames("exotic"),"string"==typeof n.description?o.setHtml(h+" "+n.description):o.appendChild(n.description)}}i(591);var l=i(592),c=i(29).getText,u=i(191).inherits,d=i(235),h="&#149;";u(n,d),e.exports=n,n.prototype._renderDamageAndEffects=function(e,t){for(var i=[],n=[],l=0,u=e.length;l<u;l++){var d=e[l];if(d){var h=d.description;if(h&&!d.hidden){var p=d.getDurationString();p&&(h+=" ("+p+")");var m=d.monsterCount;m&&(h+=m);var f=d.isDamageEffect()?i:n;f.push({dbEffect:d.effect,description:h,isExotic:d.isExotic}),d.requiresInvocationDescription()&&d.subEffectDescription&&f.push({dbEffect:d.effect,description:s(d)}),o(d)&&d.subEffectDescription&&f.push({dbEffect:d.effect,description:a(d)})}}}var g;i.length>0&&(g=t?c("ui.common.criticalDamages",1):c("ui.stats.damagesBonus",i.length),this.createChild("div",{className:"effectTitle",text:g+c("ui.common.colon")}),r(this,i)),n.length>0&&(g=t?c("ui.common.criticalEffects",1):c("ui.common.effects",n.length),this.createChild("div",{className:"effectTitle",text:g+c("ui.common.colon")}),r(this,n))},n.prototype.setEffectsFromItem=function(e,t){var i;t=t||{},this.clearContent();var n,o=e.getItemInstance();n=t.showPossibleEffects||!o?e.getItem():o,i=l.getSortedEffectInstances(n),this._renderDamageAndEffects(i)},n.prototype.setEffectsFromSpell=function(e,t){this.clearContent();var i,n,o,s=e.getSpellLevelId();for(i=[],n=0,o=e.getEffectsIds(t).length;n<o;n++)i.push(e.effectInstances[s+"-effects-"+n]);for(this._renderDamageAndEffects(i),i=[],n=0,o=e.getCriticalEffectsIds(t).length;n<o;n++)i.push(e.effectInstances[s+"-criticalEffect-"+n]);this._renderDamageAndEffects(i,!0)},n.prototype.setEffects=function(e){this.clearContent(),this._renderDamageAndEffects(e)}},function(e,t){},function(e,t,i){function n(){this.exoticEffects={}}function o(e,t){var i,n,o,s,a=[],r=e.favoriteSubAreas||[],l=window.gui.playerData.position.subAreaId,c=t.effects||[];if(r.indexOf(l)===-1)return a;for(var u=0;u<c.length;u+=1)i=c[u],n=i.effect.bonusType,1===n&&(o=Math.floor(i.value*e.favoriteSubAreasBonus/100),o&&(s=i.clone(),s.setParameter(2,o),s.forceDescriptionRefresh(),a.push(s)));return a}var s=i(509).ItemInstance,a=i(401);n.prototype._getEffectInstances=function(e,t){var i=t&&t.effects,n=e.possibleEffects,s=i&&i.length>0,a=n&&n.length>0;if(s||a){var r,l;if(t)r=i.concat(o(e,t)),l=!t.objectUID;else{if(!a)return;r=n,l=!0}if(r=r.filter(function(e){return e&&e.effect&&!e.isLivingProperty}),this.exoticEffects={},!l&&!e.hideEffects&&e.enhanceable)for(var c=0;c<r.length;c+=1){var u=r[c].effect;if(u&&u.showInSet&&n){for(var d=!0,h=0;h<n.length;h+=1)if(u.id===n[h].effectId){d=!1;break}this.exoticEffects[u.id]=d}}return r}},n.prototype.sortEffects=function(e){function t(e,t){var i=e.effect,n=t.effect;return s.exoticEffects[i.id]?-1:s.exoticEffects[n.id]?1:i.effectPriority-n.effectPriority}var i,n,o,s=this,r=e.sort(t),l=[a.damage,a.miscellaneous,a.resistance,a.special],c={};for(i=0;i<r.length;i+=1)if(o=r[i].effect,o.category!==a.undefined&&812!==o.id){s.exoticEffects[o.id]&&(r[i].isExotic=!0);var u=o.showInSet?o.category:a.special;c[u]||(c[u]=[]),c[u].push(r[i])}var d=[];for(i=0;i<l.length;i+=1){var h=c[l[i]];if(h)for(n=0;n<h.length;n+=1){var p=h[n];d.push(p)}}return d},n.prototype.getSortedEffectInstances=function(e){var t=e instanceof s?e:null,i=t&&t.item||e,n=this._getEffectInstances(i,t);return n?this.sortEffects(n):[]},e.exports=new n},function(e,t,i){function n(e,t){return e.localeCompare?e.localeCompare(t):e>t?1:t>e?-1:0}function o(e){return e[this.id]}function s(e){return e}function a(e,t,i){if(m.call(this,"div",{className:"TableV2"}),i=i||{},t)"function"==typeof t?this.getIdFn=t:this.getIdFn=function(e){return e[t]};else{var a=0;this.getIdFn=function(){return a++}}this.cols=e,this._selectedRow=null,this.colIndex={};for(var r=0,l=e.length;r<l;r+=1){var c=e[r];this.colIndex[c.id]=r,c.format=c.format||c.getContent||o,c.sort&&("function"==typeof c.sort?c.getContent=c.getContent||s:(c.sort=n,c.getContent=c.getContent||o),c.order=c.order||"ascending",c.defaultSorter&&(this.defaultSorter=c,this.defaultOrder=c.order,this.sortBy=c))}this._clickable=i.clickable!==!1,i.noHeader||this._addHeader(),i.sorter&&this.setSorter(i.sorter),this._onRowCreation=i.onRowCreation,this.scroller=this.appendChild(new v({className:"tableScroller"})),this.rows=this.scroller.content,this.rows.addClassNames("tableContent"),this._slidable=i.slidable,this._slidable&&this._createSlideBackElement(),this.filters=[],this.placeholder=null,this.spinner=new y(this),this.isSorting=!1}function r(){this.myTable._tapOnSortBtn(this)}function l(){return this.content&&"function"==typeof this.content.getText?this.content.getText():null}function c(e){this.toggleClassName("disabled",!e)}function u(e,t){var i=e[t.id];i.clearContent();var n=t.format(e.rowContent,e);n instanceof m?(i.content=n,i.appendChild(n)):(i.content=i,i.setText(n))}i(594);var d=i(248).addTooltip,h=i(246),p=i(503),m=i(235),f=i(228),g=i(232),_=i(191).inherits,v=i(483),y=i(595),b=i(227),w=26,M=40,T=100;_(a,m),e.exports=a,a.prototype._createSlideBackElement=function(){var e=this._slideBack=new m("div",{className:"slideBackElement"});e.setStyle("opacity",0),e.appendChild(this._slidable),e.rowId=null,e.side="left",this.scroller.appendChild(e)},a.prototype.setColumnHeader=function(e,t){var i=this.header.row.getChild(e);return i?("string"==typeof t?i.content.setText(t):(i.content.clearContent(),i.content.appendChild(t)),void i.sorter.toggleClassName("noText",!t)):console.error("setColumnHeader: invalid colId:",e)},a.prototype.setSortingHintVisible=function(e,t){var i=this.header.row.getChild(e);return i?void i.sorter.toggleClassName("noTriangle",!!t):console.error("setSortingHintVisible: invalid colId:",e)},a.prototype._addHeader=function(){this.header=this.createChild("div",{className:"tableHeader"});for(var e=this.header.row=this.header.createChild("div",{className:"row"}),t=0,i=this.cols.length;t<i;t+=1){var n,o=this.cols[t];o.sort?(n=e.appendChild(new h({className:["col",o.id],name:o.id},r)),n.myTable=this):n=e.createChild("div",{className:["col",o.id]}),d(n,o.tooltip?o.tooltip:l),e[o.id]=n,(o.header||o.sort)&&(n.content=n.createChild("div",{className:"headerContent"}),o.header instanceof m?n.content.appendChild(o.header):n.content.setText(o.header||""),o.sort&&(n.addClassNames(o.order),n.sorter=n.createChild("div",{className:"sortBtn"}),this._toggleTriangle(n,!!o.defaultSorter),n.sortBy=o,o.header||n.sorter.addClassNames("noText")))}},a.prototype.setContentLoading=function(e){e?this.spinner.addSpinner("content"):this.spinner.removeSpinner("content")},a.prototype.setPlaceholderText=function(e){if(!this.placeholder){if(!e)return;this.placeholder=new p(this,{headerElement:this.header})}this.placeholder.setText(e)},a.prototype._toggleTriangle=function(e,t){e.toggleClassName("showingTriangle",t)},a.prototype._hideCurrentTriangle=function(){var e=this.sortBy;e&&e.id&&this._toggleTriangle(this.header.row[e.id],!1)},a.prototype.setSorter=function(e,t){this._hideCurrentTriangle(),this.sortBy={order:t||"ascending",sort:e,getContent:s}},a.prototype._updateSortButton=function(e,t){this._hideCurrentTriangle(),this._toggleTriangle(e,!0),e.sortBy.order=t,e.toggleClassName("descending","descending"===t)},a.prototype._tapOnSortBtn=function(e){if(!this.isSorting){this.isSorting=!0;var t;t=e.sortBy===this.sortBy?"ascending"===e.sortBy.order?"descending":"ascending":e.sortBy.order,this.spinner.addSpinner("sorting"),this._updateSortButton(e,t),window.setTimeout(this._sortByColumn.bind(this,e,t))}},a.prototype.sortByColumnId=function(e,t){var i=this.header.row[e];this._updateSortButton(i,t),this._sortByColumn(i,t)},a.prototype._sortByColumn=function(e,t){this.sortBy=e.sortBy,e.sortBy.order=t,this.scroller.removeChild(this.rows),this.sort(),this.scroller.appendChild(this.rows),this.spinner.removeSpinner("sorting"),this.isSorting=!1},a.prototype.resetSort=function(){if(this.defaultSorter){var e=this.header.row[this.defaultSorter.id];this._updateSortButton(e,this.defaultOrder),this._sortByColumn(e,this.defaultOrder)}},a.prototype.sort=function(e,t){if(e&&this.setSorter(e,t),this.sortBy){var i=this.sortBy,n="ascending"===i.order?1:-1;e=function(e,t){return i.sort(i.getContent(e.rowContent),i.getContent(t.rowContent))*n}}var o=this.rows.getChildren();e&&o.sort(e);for(var s=!0,a=0,r=o.length;a<r;a+=1){var l=o[a];e&&this.rows.appendChild(l),l.isVisible()&&(l.toggleClassName("odd",s),s=!s)}},a.prototype._insertRowInRightPosition=function(e){var t,i,n,o=this.sortBy;o&&(t=o.sort,i="ascending"===o.order?1:-1),t&&(n=o.getContent(e.rowContent));for(var s=!1,a=!1,r=!0,l=this.rows.getChildren(),c=0,u=l.length;c<u;c+=1){var d=l[c];if(d===e){if(t)continue;s=!0}!a&&t&&t(n,o.getContent(d.rowContent))*i<0&&(e.insertBefore(d),a=!0,e.isVisible()&&(e.toggleClassName("odd",r),r=!r)),d.isVisible()&&(d.toggleClassName("odd",r),r=!r)}a||s||(this.rows.appendChild(e),e.toggleClassName("odd",r))},a.prototype.findRow=function(e,t){for(var i=this.rows.getChildren(),n=0,o=i.length;n<o;n+=1){var s=i[n];if(e.call(this,s.rowContent,t))return s.rowId}return null},a.prototype.filter=function(e){var t=this.rows.getChildren(),i=!0;e=e||this._shouldDisplayRow;for(var n=0,o=t.length;n<o;n+=1){var s=t[n],a=e.call(this,s.rowContent);s.toggleDisplay(a),a&&(b.cancelTween(s)&&s.setStyle("webkitTransform",null),s.toggleClassName("odd",i),i=!i)}this.scroller.refresh()},a.prototype.addFilter=function(e){this.filters.push(e)},a.prototype.removeFilter=function(e){var t=this.filters.indexOf(e);t!==-1&&this.filters.splice(t,1)},a.prototype._shouldDisplayRow=function(e){for(var t=0,i=this.filters.length;t<i;t+=1)if(!this.filters[t].call(this,e))return!1;return!0},a.prototype.hasRow=function(e){return!!this.rows.getChild(e)},a.prototype.unSelectRow=function(){this._selectedRow&&this._selectedRow.delClassNames("selected"),this._selectedRow=null},a.prototype.selectRow=function(e,t){var i=this.rows.getChild(e);return this._selectedRow!==i&&(this.unSelectRow(),i.addClassNames("selected"),this._selectedRow=i),t||this.emit("rowTap",i,i.rowContent),i},a.prototype.scrollToSelectedRow=function(){this._selectedRow&&this.scroller.scrollToElement(this._selectedRow)},a.prototype.selectFirstRow=function(e){var t=this.rows.getChildren()[0];t&&this.selectRow(t.rowId,e)},a.prototype.endSlide=function(e){this._slideBack.rowId===e&&(this._slideBack.setStyle("opacity",0),this._slideBack.row.slideBack())},a.prototype.setSlideEnable=function(e){this._slideLock=!e},a.prototype._addSlideBehavior=function(e){g(e,"x");var t,i,n,o=this,s=this._slideBack,a=e.rootElement;e.on("slideStart",function(i,r){o._slideLock||(null!==s.rowId&&o.endSlide(s.rowId),s.rowId=e.rowId,s.row=e,s.setStyles({height:r.height+"px",webkitTransform:"translate3d(0,"+(a.offsetTop+o.scroller.iScroll.y)+"px,0)"}),t=i.x,n=r.width/2,e.setSwipeMinimum(n))}),e.on("slide",function(e){o._slideLock||(i=e.x-t,i>n?i=n:i<-n&&(i=-n),s.setStyle("opacity",Math.abs(i)/n),this.setStyle("webkitTransform","translate3d("+i+"px,0,0)"))}),e.slideBack=function(t){s.rowId=null,b.tween(e,{webkitTransform:"translate3d(0,0,0)"},{time:100,easing:"ease-out"},function(){if(s.setStyle("opacity",0),s.delClassNames("spinner",s.side),t)return t()})},e.on("slideEnd",function(t,i){o._slideLock||(t?i>0?(s.side="left",s.addClassNames("spinner","left"),o.emit("rowSlidedLeft",e,e.rowContent)):(s.side="right",s.addClassNames("spinner","right"),o.emit("rowSlidedRight",e,e.rowContent)):e.slideBack())})},a.prototype._createRow=function(e,t,i){t=void 0===t?this.getIdFn(e):t;var n=this;if(this.rows.getChild(t))throw new Error('THROW createRow: Already have a child named "'+t+'"');var o=this.rows.appendChild(new m("div",{className:"row",name:t}));this._slidable&&this._addSlideBehavior(o),i&&o.setStyle("webkitTransform","translate3d(100%,0,0)"),o.rowId=t,o.rowContent=e,o.myTable=this;for(var s=0,a=this.cols.length;s<a;s+=1){var r=this.cols[s];o[r.id]=o.createChild("div",{className:["col",r.id]}),u(o,r)}return this._clickable&&(f(o),o.on("enable",c),o.on("tap",function(){n.selectRow(t)})),this._onRowCreation&&this._onRowCreation(o,e),o.toggleDisplay(this._shouldDisplayRow(e)),this.emit("rowAdded",t,e,o),o},a.prototype.addRow=function(e,t,i){var n=this._createRow(e,t,i);return this._insertRowInRightPosition(n),this.scroller.refresh(),i?(this.scroller.scrollToElement(n),b.tween(n,{webkitTransform:"translate3d(0,0,0)"},{time:T,easing:"ease-out"})):n.setStyle("webkitTransform",null),n},a.prototype._playAnimationForNewRows=function(e){for(var t,i=this.rows.getChildren(),n=0,o=w/2,s=0;s<i.length;s++){var a=i[s];if(e[a.rowId])if(n>=w||!a.isVisible())a.setStyle("webkitTransform",null);else{0===n&&(t=a);var r=(o-Math.abs(n-o))*M;n++,b.tween(a,{webkitTransform:"translate3d(0,0,0)"},{time:T,easing:"ease-out",delay:r})}}t&&this.scroller.scrollToElement(t)},a.prototype.addList=function(e,t,i){if(this.scroller.removeChild(this.rows),e.length&&this.setPlaceholderText(""),i)for(var n=0;n<e.length;n++){var o=this.getIdFn(e[n]);this.hasRow(o)&&this.delRow(o,!1)}var s,a,r,l={};for(a=0,r=e.length;a<r;a+=1)s=this._createRow(e[a],void 0,t),t&&(l[s.rowId]=s);this.sort(),this.scroller.appendChild(this.rows),this.scroller.refresh(),t&&this._playAnimationForNewRows(l)},a.prototype.addMap=function(e,t){this.scroller.removeChild(this.rows);var i={};for(var n in e){var o=this._createRow(e[n],n,t);i[o.rowId]=o}this.sort(),this.scroller.appendChild(this.rows),this.scroller.refresh(),t&&this._playAnimationForNewRows(i)},a.prototype._updateRow=function(e,t){t=void 0!==t?t:this.getIdFn(e);var i=this.rows.getChild(t);if(!i)return this.addRow(e,t);i.rowContent=e;for(var n=0,o=this.cols.length;n<o;n+=1)u(i,this.cols[n]);return i.toggleDisplay(this._shouldDisplayRow(e)),i},a.prototype.refreshRows=function(){for(var e=this.rows.getChildren(),t=0;t<e.length;t++){var i=e[t];this._updateRow(i.rowContent,i.rowId)}},a.prototype.updateRows=function(e){for(var t=0,i=e.length;t<i;t+=1)this._updateRow(e[t]);this.sort()},a.prototype.updateRow=function(e,t){var i=this._updateRow(e,t);return this._insertRowInRightPosition(i),i},a.prototype.getRow=function(e){return this.rows.getChild(e)},a.prototype.updateCell=function(e,t,i){var n=this.rows.getChild(e);if(!n)return console.error(new Error("Row id unknown: "+e));var o=n[t];if(!o)return console.error(new Error("Column id unknown: "+t));var s=this.cols[this.colIndex[t]];return n.rowContent=i,u(n,s),n.toggleDisplay(this._shouldDisplayRow(i)),this.sortBy===s&&this._insertRowInRightPosition(n),n},a.prototype.getCell=function(e,t){var i=this.rows.getChild(e);if(!i)return console.error(new Error("Row id unknown "+e));var n=i[t];return n?n.content:console.error(new Error("Column id unknown "+t))},a.prototype._delRow=function(e){var t=this.rows.getChild(e);t&&(this._selectedRow===t&&(this._selectedRow=null),this.emit("rowDeleted",e,t.rowContent,t),t.destroy())},a.prototype.delRow=function(e,t){function i(){o._delRow(e),o._updateRowColor(),o.scroller.refresh()}var n=this.rows.getChild(e);if(n){var o=this;return t?void b.tween(n,{webkitTransform:"translate3d(-100%,0,0)"},{time:T,easing:"ease-out"},i):i()}},a.prototype.delRows=function(e,t,i){function n(){for(var t=0,n=e.length;t<n;t+=1)o._delRow(e[t]);o._updateRowColor(),o.scroller.refresh(),i&&i.call(o)}var o=this;if(!e.length||!t)return n();for(var s=0,a=e.length;s<a;s+=1){var r=this.rows.getChild(e[s]);if(r){var l=s===a-1?n:null;b.tween(r,{webkitTransform:"translate3d(-100%,0,0)"},{time:T,easing:"ease-out",delay:s*M},l)}}},a.prototype.clearContent=function(){this.rows.clearContent(),this._selectedRow=null,this.scroller.refresh()},a.prototype.getRowCount=function(){return this.rows.getChildCount()},a.prototype._updateRowColor=function(){for(var e=!0,t=this.rows.getChildren(),i=0,n=t.length;i<n;i+=1){var o=t[i];o.isVisible()&&(o.toggleClassName("odd",e),e=!e)}}},function(e,t){},function(e,t){function i(e,t){this.element=e,this.isAddingClasses=t,this.locks={}}e.exports=i,i.prototype.addSpinner=function(e){var t=this.locks[e];return t?console.warn("Spinner already set for "+e):(this.locks[e]=!0,this.element.addClassNames("spinner"),void(this.isAddingClasses&&this.element.addClassNames(e)))},i.prototype.removeSpinner=function(e){var t=this.locks[e];if(t){this.locks[e]=!1,this.isAddingClasses&&this.element.delClassNames(e);for(var i in this.locks)if(this.locks[i])return;this.element.delClassNames("spinner")}},i.prototype.clearSpinner=function(){for(var e in this.locks)this.locks[e]&&this.removeSpinner(e);this.locks={}},i.prototype.isActive=function(){for(var e in this.locks)if(this.locks[e])return!0;return!1}},function(e,t,i){function n(){w.call(this,"div",{className:"MountDetails"}),this.mountData={},this.boostMap={1:{property:"energy",update:this._setEnergy},2:{property:"serenity",update:this._setSerenity},3:{property:"stamina",update:this._setStamina},4:{property:"love",update:this._setLove},5:{property:"maturity",update:this._setMaturity},6:{property:"boostLimiter",update:this._setTiredness}},this._givenXP=0,this._name="",this.shouldResetTab=!0,this.hasDomAndListeners=!1,this.on("destroy",function(){this.hasDomAndListeners&&(this._setEventListeners(!1),this.hasDomAndListeners=!1)})}function o(){return this.tooltipText}i(597);var s=i(202),a=i(246),r=i(400),l=i(598),c=i(599),u=i(29).getText,d=i(191).inherits,h=i(386),p=i(602),m=i(603),f=i(605),g=i(607),_=i(609),v=i(611),y=i(248),b=i(225),w=i(235),M=33,T=0,C=1,I=2;d(n,w),e.exports=n,n.EFFECT_MOUNT=995,n.EFFECT_INVALID_CERTIF=994,n.isItemInstanceWithMountInfo=function(e){return!!e.effectsMap[n.EFFECT_MOUNT]},n.getMountInfoFromCertificate=function(e){return e.effectsMap[n.EFFECT_MOUNT]},n.prototype.getIllustrationElement=function(){return this.hasDomAndListeners||this._setupDomAndListeners(),this._mountIllus},n.prototype._createProgressBar=function(e,t,i,n){var o=u("ui.common.colon"),s=e.createChild("div",{className:t});return s.createChild("div",{className:"label",text:i+o}),s.appendChild(new f({className:["mountBar",n],tooltip:i}))},n.prototype._getActionOnMount=function(e){var t=this.mountData.mountLocation;return t?l[this.mountData.mountLocation][e]:null},n.prototype._exchangeAction=function(e){var t=this._getActionOnMount(e);if(!t)return console.error(new Error("Invalid action "+e));var i=this;window.dofus.sendMessage("ExchangeHandleMountStableMessage",{actionType:t,rideId:i.mountData.id})},n.prototype._setSex=function(e){e?this._sexIcon.replaceClassNames(["male"],["female"]):this._sexIcon.replaceClassNames(["female"],["male"])},n.prototype._setupDomAndListeners=function(){this.mustResize=!0,this._createMinMaxBox(),this._createMainInformation(),this._createPanels(),this._createButtons(),this._setEventListeners(!0),this.hasDomAndListeners=!0},n.prototype._createMainInformation=function(){var e=this,t=this.createChild("div",{className:"mainContainer"}),i=t.createChild("div",{className:"mainInfosTop"}),n=i.createChild("div",{className:"leftColumn"});this._mountIllus=n.createChild("div",{className:"mountIllus"}),this._sexIcon=this._mountIllus.createChild("div",{className:"sexIcon"}),y.addTooltip(this._mountIllus,o);var s=i.createChild("div",{className:"rightColumn"});this._mountName=s.createChild("div",{className:"mountName"}),this._renameButton=s.appendChild(new a({className:["simpleButton","tinyBtn","renameBtn"],tooltip:u("ui.mount.renameTooltip")},function(){b.open("mountRename",{name:e.mountData.name,mountId:e.mountData.id,inputBox:e._mountName})}));var r=s.createChild("div",{className:"typeAndLevel"});this._mountType=r.appendChild(new m),this._level=r.createChild("div",{className:"level"});var l=t.createChild("div",{className:"mainInfosBottom"}),c=this.abilityDiv=l.createChild("div",{className:"abilityDiv"});this.abilities=[];for(var d=0;d<I;d++){var h=this.abilities[d]=c.createChild("div",{className:"ability"});y.addTooltip(h,o)}var p=l.createChild("div",{className:"statusIcons"});this.fertileIcon=p.appendChild(new _("fertile",{tooltip:""})),this.domesticIcon=p.appendChild(new _("domestic",{tooltip:u("tablet.mount.domestic")})),this.mountableIcon=p.appendChild(new _("mountable",{tooltip:u("ui.common.mountable")})),this._rideButtonDiv=p.createChild("div",{className:"rideBtnDiv"}),this._rideButton=this._rideButtonDiv.appendChild(new a({className:["greenButton","rideButton"],addIcon:!0,tooltip:u("ui.mount.rideTooltip")},function(){window.dofus.sendMessage("MountToggleRidingRequestMessage")}))},n.prototype._createPanels=function(){var e=this._tabs=this.appendChild(new v({className:"tabs"}));e.addTab(u("tablet.mount.breeding"),this._createBreedingPanel()),e.addTab(u("ui.common.short.caracteristic"),this._createStatPanel())},n.prototype._createBreedingPanel=function(){var e=new w("div",{className:"panel"}),t=e.createChild("div",{className:"breedingPanel"}),i=u("ui.common.colon");this._tirednessValue=this._createProgressBar(t,["progressBar2col","tired"],u("ui.common.tire"),"orange");var n=t.createChild("div",{className:"iconGaugeBar"});this._staminaGauge=n.appendChild(new c("stamina",u("ui.common.stamina"))),this._maturityGauge=n.appendChild(new c("maturity",u("ui.common.maturity"))),this._loveGauge=n.appendChild(new c("love",u("ui.common.love"))),this._serenityGauge=t.appendChild(new g);var o=this._fertilityDiv=t.createChild("div",{className:["textInfo","mating"]});return o.createChild("div",{className:"label",text:u("ui.common.reproductions")+i}),this._fertilityValue=o.createChild("div",{className:"value"}),this._fecondationState=t.createChild("div",{className:"fecondationState"}),e},n.prototype._createStatPanel=function(){var e=new w("div",{className:"panel"}),t=e.createChild("div",{className:"statPanel"});return this._energyGauge=t.appendChild(new c("energy",u("ui.common.energy"),{size:M})),this._experienceValue=this._createProgressBar(t,["progressBar2col","xp"],u("ui.common.experiment"),"blue"),this._createGivenXp(t),t.createChild("div",{className:"effectLabel",text:u("ui.effects")}),this._effectsContent=t.createChild("div",{className:"effectsContent"}),e},n.prototype._createGivenXp=function(e){var t=this,i=this._givenXpDiv=e.createChild("div",{className:"givenXp"}),n=u("ui.common.giveXP")+u("ui.common.colon");i.createChild("div",{className:"label",text:n});var o=i.createChild("div",{className:"valueAndButton"});this._xpValue=o.createChild("div",{className:"value"}),o.appendChild(new a({className:["simpleButton","tinyBtn","xpButton"],tooltip:u("ui.mount.xpPercentTooltip")},function(){t.minMaxSelector.open({min:0,max:90,defaultValue:t._givenXP})}))},n.prototype._feedMount=function(){var e=b.getWindow("feed");if(!e.feedingBox.possessFeedItemForMount())return window.gui.openSimplePopup(u("ui.item.errorNoFoodMount"));var t="shed"===this.mountData.mountLocation?p.LOCATION_STABLED:p.LOCATION_EQUIPED;b.open("feed",{mode:"mount",mountUid:this.mountData.id,mountLocation:t})},n.prototype._neuterMount=function(){var e=this;window.gui.openConfirmPopup({title:u("ui.popup.warning"),message:u("ui.mount.doUCastrateYourMount"),cb:function(t){t&&(e.inBreeding?e._exchangeAction("sterilize"):window.dofus.sendMessage("MountSterilizeRequestMessage"))}})},n.prototype._releaseMount=function(){var e=this;window.gui.openConfirmPopup({title:u("ui.popup.warning"),message:u("ui.mount.doUKillYourMount"),cb:function(t){t&&(e.inBreeding?e._exchangeAction("free"):window.dofus.sendMessage("MountReleaseRequestMessage"))}})},n.prototype._createButtons=function(){var e=this,t=this.createChild("div",{className:"buttons"});this._feedButton=t.appendChild(new a({className:["simpleButton","mountButton","feedButton"],tooltip:u("ui.mount.feed")},this._feedMount.bind(this))),this._feedButton.disable(),this._inventoryButton=t.appendChild(new a({className:["simpleButton","mountButton","inventoryButton"],tooltip:u("ui.mount.inventoryAccess")},function(){window.dofus.sendMessage("ExchangeRequestOnMountStockMessage")})),this._genealogyButton=t.appendChild(new a({className:["simpleButton","mountButton","genealogyButton"],tooltip:u("ui.mount.ancestorTooltip")},function(){b.open("familyTree",e.mountData)})),this._cutButton=t.appendChild(new a({className:["simpleButton","mountButton","cutButton"],tooltip:u("ui.mount.castrateTooltip")},this._neuterMount.bind(this))),this._releaseButton=t.appendChild(new a({className:["simpleButton","mountButton","releaseButton"],tooltip:u("ui.mount.killTooltip")},this._releaseMount.bind(this)))},n.prototype._createMinMaxBox=function(){var e=this.minMaxSelector=this.appendChild(new h);e.setStyles({left:"-12px",top:"249px"});var t=this;e.on("confirm",function(e){e!==t._givenXP&&window.dofus.sendMessage("MountSetXpRatioRequestMessage",{xpRatio:e})})},n.prototype._processMountRenamed=function(e){e.mountId===this.mountData.id&&(this._setName(e.name),this.emit("renameMount",this._name))},n.prototype._processMountSterilized=function(e){e.mountId===this.mountData.id&&(this.mountData.reproductionCount=-1,this._setFertilityState())},n.prototype._processMountRiding=function(e){var t=window.gui.playerData;t.equippedMount.id===this.mountData.id&&this._setRideButton(e)},n.prototype._processMountReleased=function(e){e.mountId===this.mountData.id&&this.emit("freeMount",e.mountId)},n.prototype._processUpdateMountBoost=function(e){e.rideId===this.mountData.id&&this._updateBoost(e.boostToUpdateList)},n.prototype._setEventListeners=function(e){var t=window.gui.playerData,i=window.dofus.connectionManager;e?(this.mountRenamedHandler||(this.mountRenamedHandler=this._processMountRenamed.bind(this),this.mountSterilizedHandler=this._processMountSterilized.bind(this),this.mountReleasedHandler=this._processMountReleased.bind(this),this.updateMountBoostHandler=this._processUpdateMountBoost.bind(this),this.setRatioHandler=this._setXpRatio.bind(this),this.mountRidingHandler=this._processMountRiding.bind(this)),i.on("MountRenamedMessage",this.mountRenamedHandler),i.on("MountSterilizedMessage",this.mountSterilizedHandler),i.on("MountReleasedMessage",this.mountReleasedHandler),i.on("UpdateMountBoostMessage",this.updateMountBoostHandler),t.on("setMountRatio",this.setRatioHandler),t.on("mountRiding",this.mountRidingHandler)):(i.removeListener("MountRenamedMessage",this.mountRenamedHandler),i.removeListener("MountSterilizedMessage",this.mountSterilizedHandler),i.removeListener("MountReleasedMessage",this.mountReleasedHandler),i.removeListener("UpdateMountBoostMessage",this.updateMountBoostHandler),t.removeListener("setMountRatio",this.setRatioHandler),t.removeListener("mountRiding",this.mountRidingHandler))},n.prototype._updateBoost=function(e){for(var t=this.mountData,i=0;i<e.length;i+=1){var n=e[i],o=this.boostMap[n.type].property;t[o]=n.value,this.boostMap[n.type].update.call(this,n.value)}},n.prototype._setSpecificBehaviors=function(e){if(this.abilityDiv.toggleClassName("withoutAbilities",0===e.length),e.length)for(var t=window.gui.databases.MountBehaviors,i=0;i<this.abilities.length;i++){var n=this.abilities[i],o=e[i];o&&(n.setText(t[o].nameId),n.tooltipText=t[o].descriptionId),n.toggleDisplay(!!o)}},n.prototype._setName=function(e){this._name=this.mountData.name=e,this._name||(this._name=u("ui.common.noName")),this._mountName.setText(this._name);var t=u(this.mountData.sex?"ui.common.animalFemale":"ui.common.animalMale");this._mountIllus.tooltipText=this._name+" ("+t+")"},n.prototype.getName=function(){return this._name},n.prototype._setXpRatio=function(e){this._givenXP=e,this._xpValue.setText(e+"%")},n.prototype._setRideButton=function(e){this._rideButton.toggleClassName("isRiding",!!e)},n.prototype._setLove=function(e){this._loveGauge.setValue(e,this.mountData.loveMax)},n.prototype._setTiredness=function(e){this._tirednessValue.setValue(e,this.mountData.boostMax)},n.prototype._setEnergy=function(e){this._energyGauge.setValue(e,this.mountData.energyMax)},n.prototype._setStamina=function(e){this._staminaGauge.setValue(e,this.mountData.staminaMax)},n.prototype._setMaturity=function(e){this._maturityGauge.setValue(e,this.mountData.maturityForAdult)},n.prototype._setSerenity=function(e){this._serenityGauge.setValue(e)},n.getFertilityState=function(e){var t=e.reproductionCount,i=e.reproductionCountMax,n=t>=0&&t<i,o=t<0,s={canReproduce:n,isNeutered:o,isFecondationReady:e.isFecondationReady,fecondationTime:e.fecondationTime};return n&&(s.reproCount=t,s.reproMax=i),e.isNewborn&&(s.isNewborn=!0),s},n.prototype._setFertilityState=function(){var e=n.getFertilityState(this.mountData),t=!!e.canReproduce;t&&this._fertilityValue.setText(e.reproCount+"/"+e.reproMax),this._fertilityDiv.toggleDisplay(t),this._cutButton.setEnable(t&&!!this._getActionOnMount("sterilize")),this.fertileIcon.setFertileIcon(e,!0)},n.prototype._setFecondationState=function(){var e=this.mountData.isFecondationReady,t=this.mountData.fecondationTime,i=!e&&t>-1;this._fecondationState.toggleDisplay(i),i&&this._fecondationState.setText(u("ui.mount.pregnantSince",t))},n.prototype._setExperience=function(e,t,i){i===-1&&(i=e);var n=(e-t)/(i-t);this._experienceValue.setValue(e,i,n)},n.prototype._resize=function(){return this.isVisible()&&this.rootElement.clientWidth?(this.mustResize=!1,void this._serenityGauge.resize()):this.once("show",this._resize.bind(this))},n.prototype.setMount=function(e,t){var i=this,n=window.gui.playerData;e=e||{},t=t||{};var o=this.inBreeding="breeding"===t.context;this.hasDomAndListeners||this._setupDomAndListeners(),this.shouldResetTab&&(this.shouldResetTab=!1,this._tabs.openTab(o?T:C)),this.mustResize&&this._resize(),this.mountData=e;var a=e.mountLocation;a||console.error("Mount",e.id,"does not have a location."),this._givenXpDiv.toggleDisplay("equip"===a),this._setXpRatio(e.xpRatio),this.domesticIcon.setEnabled(!e.isWild);var l="equipped"===t.context;this._rideButtonDiv.toggleDisplay(l),this.mountableIcon.toggleDisplay(!l),
l?(this._rideButton.setEnable(e.isRideable),this._setRideButton(n.isRiding)):this.mountableIcon.setEnabled(e.isRideable),this._setName(e.name),this._setSpecificBehaviors(e.behaviors),this._releaseButton.setEnable(!!this._getActionOnMount("free")),this._renameButton.setEnable("equip"===e.mountLocation||"shed"===e.mountLocation),this._feedButton.setEnable(e.maturity===e.maturityForAdult&&("shed"===this.mountData.mountLocation||"equip"===this.mountData.mountLocation)&&"fight"!==window.foreground.tapOptions.mode),this._inventoryButton.setEnable(e.maxPods>0&&"equip"===e.mountLocation&&!o),this._level.setText(u("ui.common.short.level")+" "+e.level),this._setExperience(e.experience,e.experienceForLevel,e.experienceForNextLevel),this._setFecondationState(),this._setFertilityState(),this._setSex(e.sex),this._setEnergy(e.energy),this._setLove(e.love),this._setTiredness(e.boostLimiter),this._setStamina(e.stamina),this._setMaturity(e.maturity),this._setSerenity(e.serenity),this._mountType.setModel(e.model),s.preloadImage("gfx/mounts/"+e.model+".png",function(e){i._mountIllus.setStyle("backgroundImage",e)});for(var c=0,d=e.effectList.length;c<d;c+=1){var h=e.effectList[c];h.effectCaller||(h.effectCaller="mount "+e.model+" from location "+e.mountLocation)}r.createEffectInstances(e.effectList,function(e,t){var n="<ul>",o="<li>"+u("ui.common.lowerNone",0)+"</li>";if(e)return n+=o+"</ul>",i._effectsContent.setHtml(o),console.error(e);if(t.length<=0)return n+=o+"</ul>",i._effectsContent.setHtml(o);for(var s=0,a=t.length;s<a;s+=1){var r=t[s];n+="<li>"+r.description+"</li>"}n+="</ul>",i._effectsContent.setHtml(n)})}},function(e,t){},function(e,t){e.exports={shed:{equip:2,free:3,certificate:4,paddock:6,sterilize:17},paddock:{shed:7,free:8,equip:10,certificate:14,sterilize:19},equip:{shed:1,paddock:9,free:11,certificate:13,sterilize:18},certificate:{shed:5,paddock:16,equip:15}}},function(e,t,i){function n(e,t,i){r.call(this,"div",{className:["gaugeIcon",e]}),i=i||{},this.name=e,this.createChild("div",{className:"icon"});var n=i.size||l,o=i.thickness||(n<l?u:c);this.progressCircle=this.appendChild(new a({size:n,thickness:o,color:h[e],bgColor:d,tooltip:t})),this.valueElement=i.withoutLabel?null:this.createChild("div",{className:"value",text:""})}i(600);var o=i(252),s=i(191).inherits,a=i(601),r=i(235),l=40,c=2.5,u=2,d="#222",h={energy:"#ffcc00",stamina:"#ebae23",maturity:"#0099ff",love:"#ff1e1e"},p={stamina:.75,maturity:1,love:.75},m=.001;s(n,r),e.exports=n,n.prototype.setValue=function(e,t,i){i=i||p[this.name]||m,this.valueElement&&this.valueElement.setText(o.intToString(e));var n=!t||!i||e>=t*i;this.toggleClassName("enabled",n),this.progressCircle.setValue(e,t)},n.prototype.setLabel=function(e){this.valueElement.setText(e)}},function(e,t){},function(e,t,i){function n(e){e=e||{},r.call(this,"div",{className:"ProgressCircle"}),this.addClassNames(e.className),this.size=e.size||l,this.thickness=e.thickness||Math.round(.15*this.size),this.bgThickness=e.bgThickness||this.thickness+2,this.color=e.color||"#EEE",this.bgColor=e.bgColor,e.tooltip&&(this.tooltipText=e.tooltip,a.addTooltip(this,this._tooltipHandler.bind(this))),this.radius=(this.size-this.bgThickness)/2,this.center=this.size/2;var t=this.createChild("canvas",{className:"canvas"}).rootElement;t.width=this.size,t.height=this.size,t.style.width=this.size+"px",t.style.height=this.size+"px",this._ctx=t.getContext("2d")}var o=i(29).getText,s=i(191).inherits,a=i(248),r=i(235),l=50;s(n,r),e.exports=n,n.prototype.setValue=function(e,t){var i;t?(this.value=e,i=e/t):(this.value=e,i=e),this.maxValue=t;var n=this._ctx;this._ctx.clearRect(0,0,n.canvas.width,n.canvas.height),this.bgColor&&this._drawArc(this.bgThickness,this.bgColor,1),this._drawArc(this.thickness,this.color,i)},n.prototype._drawArc=function(e,t,i){i<.01&&0!==i&&(i=.01),i>.99&&1!==i&&(i=.99);var n=this._ctx;n.lineWidth=e,n.strokeStyle=t,n.beginPath(),n.arc(this.center,this.center,this.radius,-.5*Math.PI,(2*i-.5)*Math.PI,!1),n.stroke()},n.prototype._tooltipHandler=function(){var e=this.tooltipText+o("ui.common.colon");return this.maxValue?e+this.value+" / "+this.maxValue:e+this.value+"%"}},function(e,t){e.exports={LOCATION_EQUIPED:1,LOCATION_INVENTORY:2,LOCATION_STABLED:3,LOCATION_MAP:4}},function(e,t,i){function n(){l.call(this,"div",{className:"mountType"});var e=this;this._hasBeenDestroyed=!1,this.color1=this.createChild("div",{className:"color"}),this.color2=this.createChild("div",{className:["color","color2"]}),r.addTooltip(this,o),this.on("destroy",function(){e._hasBeenDestroyed=!0})}function o(){return this.tooltipText}i(604);var s=i(191).inherits,a=i(30),r=i(248),l=i(235),c=["#656d61","#d1d6d0"],u=["#656d61","#d1d6d0"],d=["#ffd700","#841b2d"];s(n,l),e.exports=n,n.ARMOURED_MOUNT_ID=88,n.FEATHERY_MOUNT_ID=89,n.ROYAL_MOUNT_ID=90,n.BARBARIAN_MOUNT_ID=91,n.parseColorsFromLook=function(e,t){if(e===n.ARMOURED_MOUNT_ID)return c;if(e===n.BARBARIAN_MOUNT_ID)return u;if(e===n.ROYAL_MOUNT_ID)return d;var i=t.split("|")[2];if(!i)return c;for(var o=i.split(","),s=[],a=0;a<3;a++){var r=o[a].split("="),l=parseInt(r[0],10)-1,h=parseInt(r[1],10);isNaN(h)?console.error("MountType: Color is not a number for mountId: "+e+", index: "+l):s[l]="#"+h.toString(16)}return s},n.isSingleColor=function(e){return e[0]===e[1]||e[0]===e[2]},n.prototype.setModel=function(e){var t=this;a.getData("Mounts",e,function(i,o){if(i)return console.error("Failed loading Mounts with id=",e,"error:",i);if(!t._hasBeenDestroyed){var s=n.parseColorsFromLook(e,o.look);t.color1.setStyle("backgroundColor",s[0]),t.color2.setStyle("backgroundColor",s[1]),t.color2.toggleDisplay(!n.isSingleColor(s)),t.tooltipText=o.nameId}})}},function(e,t){},function(e,t,i){function n(e){e=e||{},r.call(this,"div",{className:"ProgressBar",name:e.name}),this.addClassNames(e.className),this.barBg=this.createChild("div",{className:"barBg"}),this.barFill=this.createChild("div",{className:"barFill"}),this.barColor=this.barFill.createChild("div",{className:"barColor"}),this.vertical=e.vertical||!1,this.barFill.toggleClassName("vertical",this.vertical),e.tooltip&&(this.tooltipText=e.tooltip,a.addTooltip(this,this._tooltipHandler.bind(this))),this.epsilon=void 0===e.epsilon?5:e.epsilon,this.setValue(e.value||0)}i(606);var o=i(29).getText,s=i(191).inherits,a=i(248),r=i(235);s(n,r),e.exports=n,n.prototype.setValue=function(e,t,i){this.maxValue=t,t?(this.humanValue=e,void 0!==i?e=i:e/=t):this.humanValue=Math.round(100*e),e*=100;var n=this.epsilon;e<n&&e>0&&(e=n),e>100-n&&e<100&&(e=100-n),e=Math.round(e);var o=e?e+"%":"1px";this.barFill.setStyle("-webkit-mask-size",this.vertical?"100% "+o:o+" 100%"),this.barFill.setStyle("-webkit-mask-position",this.vertical?"0 100%":"0 0")},n.prototype.setRange=function(e,t){var i=t-e,n=i?Math.round(100*i)+"%":"1px",o=e?Math.round(100*e)+"%":"1px";this.barFill.setStyle("-webkit-mask-size",this.vertical?"100% "+n:n+" 100%"),this.barFill.setStyle("-webkit-mask-position",this.vertical?"100% "+o:o+" 100%")},n.prototype._tooltipHandler=function(){var e=this.tooltipText+o("ui.common.colon");return this.maxValue?e+this.humanValue+" / "+this.maxValue:e+this.humanValue+"%"}},function(e,t){},function(e,t,i){function n(e){r.call(this,"div",{className:"serenityGauge"}),e=e||{};var t=this.isMini=e.isMini;t&&this.addClassNames("mini"),t||this.createChild("div",{className:["bigIcon","bigIcon_mad"]});var i=this.createChild("div",{className:"barWrapper"}),n=this._serenityBar=i.createChild("div",{className:"serenityBar"});this.zones=[],this._createColorZone("stamina",l,c,o("ui.mount.viewerTooltipZone1")),this._createColorZone("maturity",c,u,o("ui.mount.viewerToolTipZone2")),this._createColorZone("love",u,d,o("ui.mount.viewerTooltipZone3")),this._serenityBarCursor=n.createChild("div",{className:"cursor"}),t||(this._serenityValue=this._serenityBarCursor.createChild("div",{className:"value"})),i.createChild("div",{className:"background"}),t||this.createChild("div",{className:["bigIcon","bigIcon_happy"]})}i(608);var o=i(29).getText,s=i(191).inherits,a=i(248),r=i(235),l=-1e4,c=-1999,u=1999,d=1e4,h=73,p=50;s(n,r),e.exports=n,n.SERENITY_MIN=l,n.SERENITY_MAX=d,n.GOOD_SERENITY_MIN=c,n.GOOD_SERENITY_MAX=u,n.prototype._createColorZone=function(e,t,i,n){var s=this._serenityBar.createChild("div",{className:["colorZone",e]});this.isMini||(s.createChild("div",{className:"icon"}),a.addTooltip(s,o("tablet.mount.serenityZoneTooltip",t,i,n))),s.name=e,s.min=t,s.max=i,this.zones.push(s),this._serenityBar[e]=s},n.prototype.resize=function(){this.isMini?(this.serenityBarWidth=h,this.serenityCursorOffset=-p/2):(this.serenityBarWidth=this._serenityBar.rootElement.clientWidth,this.serenityCursorOffset=-this._serenityBarCursor.rootElement.clientWidth/2);for(var e=d-l,t=this._serenityBar.maturity,i=(t.max-t.min)/e*this.serenityBarWidth/2,n=0,o=this.zones,s=0;s<o.length;s++){var a=o[s],r=(a.max-a.min)/e,c=r*this.serenityBarWidth;"maturity"!==a.name&&(c+=i),"stamina"!==a.name&&(n-=i),a.setStyle("left",n+"px"),a.setStyle("width",c+"px"),n+=c}this._serenityBar.maturity.setStyles({borderBottomLeftRadius:i+"px",borderTopRightRadius:i+"px"}),void 0!==this._currentSerenity&&this.setValue(this._currentSerenity)},n.prototype.setValue=function(e){if(this._currentSerenity=e,this.serenityBarWidth){this.isMini||this._serenityValue.setText(e);var t=(e-l)/(d-l),i=t*this.serenityBarWidth+this.serenityCursorOffset;this._serenityBarCursor.setStyle("left",i+"px"),this._serenityBar.stamina.toggleClassName("disabled",e>0),this._serenityBar.maturity.toggleClassName("disabled",e<c||e>u),this._serenityBar.love.toggleClassName("disabled",e<0)}}},function(e,t){},function(e,t,i){function n(e,t){l.call(this,"div",{className:["statusIcon",e]}),t=t||{},this.isEnabled=!1,this.tooltipText=t.tooltip,void 0!==t.tooltip&&r.addTooltip(this,o)}function o(){return this.isEnabled===!1?new l("div",{className:"disabledTooltipFeature",text:this.tooltipText}):this.tooltipText}i(610);var s=i(29).getText,a=i(191).inherits,r=i(248),l=i(235);a(n,l),e.exports=n,n.prototype.setEnabled=function(e){this.isEnabled=e,this.toggleClassName("disabled",!e)},n.prototype.setFertileIcon=function(e,t){var i=!1;if(e.isNewborn)this.replaceClassNames(["disabled","fertile","pregnant","sterile"],["newborn"]),this.tooltipText=s("ui.mount.filterBorn");else if(e.fecondationTime>=0)this.replaceClassNames(["disabled","fertile","neutered","newborn","sterile"],["pregnant"]),this.tooltipText=s("ui.mount.pregnantSince",e.fecondationTime);else if(e.canReproduce){if(!e.isFecondationReady&&!t)return void this.hide();this.replaceClassNames(["pregnant","neutered","newborn","sterile"],["fertile"]),i=!!t&&!e.isFecondationReady,this.toggleClassName("disabled",i),this.tooltipText=s("ui.mount.fecondable")}else{this.replaceClassNames(["disabled","fertile","pregnant","newborn"],["sterile"]);var n=e.isNeutered;this.toggleClassName("neutered",n),this.tooltipText=s(n?"ui.mount.castrated":"ui.mount.sterilized")}this.show(),this.isEnabled=!i}},function(e,t){},function(e,t,i){function n(e){l.call(this,"div",{className:"SwipingTabs"}),e=e||{},e.className&&this.addClassNames(e.className),this.tabClassName=e.tabClassName||"swipeTabBtn",this.tabList=[],this.tabMap={},this.index=null,this.currentTab=null,this.leftTab=null,this.rightTab=null,this.isCyclingAllowed=!e.noCycling,e.noHeader||(this.header=this.createChild("div",{className:"swipeHeader"})),this.content=this.createChild("div",{className:"swipeContent"}),this.tabContainer=this.content.createChild("div",{className:"tabContainer"}),a(this.content),this.setSwipeDirection(e.direction||"horizontal");var t,i,n=this,o=!1;this.tabContainer.on("tweenCancelled",function(){o=!0}),this.content.on("slideStart",function(e){o&&(o=!0,n._positionTabs()),i=e[n._axis],n.tabContainer.setStyle("webkitTransition",""),n.currentTab.content.emit("slideStart"),n.emit("slideStart")}),this.content.on("slideCancel",function(){n.currentTab.content.emit("slideEnd"),n.emit("slideEnd"),n.tabContainer.setStyles({webkitTransform:"translate"+n._axis+"(0)",webkitTransition:"-webkit-transform 200ms ease-out"})}),this.content.on("slide",function(e){this.slideOut||(t=i-e[n._axis],(t>0&&!n._canRightSlide||t<0&&!n._canLeftSlide)&&(t=0,i=e[n._axis]),n.tabContainer.setStyle("webkitTransform","translate"+n._axis+"("+-t+"px)"))}),this.content.on("slideEnd",function(e){if(n.currentTab.content.emit("slideEnd"),n.emit("slideEnd"),e){var i=n.index;t>0&&n._canRightSlide&&(i=n.rightTab.index),t<0&&n._canLeftSlide&&(i=n.leftTab.index),n._openTabWithTransition(i)}else n.tabContainer.setStyles({webkitTransform:"translate"+n._axis+"(0)",webkitTransition:"-webkit-transform 200ms ease-out"})})}i(612);var o=i(246),s=i(191).inherits,a=i(232),r=i(227),l=i(235);s(n,l),n.prototype.setSwipeDirection=function(e){this._direction=e,this.content.setSlideDirection(e),this._axis="vertical"===e?"y":"x",null!==this.index&&this._positionTabs()},n.prototype.addTab=function(e,t,i){var n=this,s=this.tabList.length;t.addClassNames("swipeTabContent");var a=this.tabMap[i]={id:i,index:this.tabList.length,content:t,position:0,enable:!0};return this.header&&(a.tabBtn=this.header.appendChild(new o({className:this.tabClassName,text:e},function(){n.openTab(s)})),a.tabBtn.addClassNames("tab"+s)),this.tabList.push(a),this.tabContainer.appendChild(t),t.hide(),s},n.prototype.getTabContent=function(e){var t=isNaN(e)?this.tabMap[e]:this.tabList[e];return t&&t.content},n.prototype.swipeNegative=function(){this.leftTab&&this._openTabWithTransition(this.leftTab.index)},n.prototype.swipePositive=function(){this.rightTab&&this._openTabWithTransition(this.rightTab.index)},n.prototype._openTabWithTransition=function(e,t){var i=this.tabList[e],n=this.tabList[this.index];this.header&&n.tabBtn.delClassNames("on"),n.content.emit("close"),i.content.emit("open",t);var o=this;r.tween(this.tabContainer,{webkitTransform:"translate"+this._axis+"("+-i.position+"%)"},{time:200,easing:"ease-out"},function(){o._positionTabs(),i.content.emit("opened",t),o.emit("openTab",i.id)}),this.index=i.index,this.header&&i.tabBtn.addClassNames("on")},n.prototype.reopen=function(){var e=this.tabList[0];this.index=e.index,this.leftTab=null,this.rightTab=null;for(var t=this._getNextAvailableRightTab(),i=this._getNextAvailableLeftTab(),n=0;n<this.tabList.length;n++){var o=this.tabList[n],s=o===e||o===i||o===t;o.content.toggleDisplay(s)}this._positionTabs()},n.prototype.openTab=function(e,t,i){i=i||{};var n=isNaN(e)?this.tabMap[e]:this.tabList[e];if(n&&(i.forceOpen||this.index!==n.index)){if(null!==this.index){if(n===this.leftTab||n===this.rightTab)return this._openTabWithTransition(n.index,t);var o=this.tabList[this.index];this.header&&o.tabBtn.delClassNames("on"),o.content.emit("close"),o.content.hide()}n.content.emit("open",t),this.index=n.index,this.header&&n.tabBtn.addClassNames("on"),n.content.show(),this._positionTabs(),n.content.emit("opened",t),this.emit("openTab",n.id)}},n.prototype.close=function(){this.tabList[this.index].content.emit("close")},n.prototype._getNextAvailableRightTab=function(){var e,t,i;for(e=this.index+1,t=this.tabList.length;e<t;e+=1)if(i=this.tabList[e],i.enable)return i;if(!this.isCyclingAllowed)return null;for(e=0,t=this.index;e<t;e+=1)if(i=this.tabList[e],i.enable)return i;return null},n.prototype._getNextAvailableLeftTab=function(){var e,t;for(e=this.index-1;e>=0;e-=1)if(t=this.tabList[e],t.enable)return t;if(!this.isCyclingAllowed)return null;for(e=this.tabList.length-1;e>this.index;e-=1)if(t=this.tabList[e],t.enable)return t;return null},n.prototype._positionTabs=function(){var e=this.currentTab=this.tabList[this.index];e.content.setStyle("webkitTransform","translate"+this._axis+"(0)"),e.position=0,this.tabContainer.setStyles({webkitTransform:"translate"+this._axis+"(0)",webkitTransition:""}),this.leftTab&&this.leftTab!==e&&this.leftTab.content.hide(),this.rightTab&&this.rightTab!==e&&this.rightTab.content.hide(),this.leftTab=this.rightTab=null;var t=this._getNextAvailableRightTab(),i=this._getNextAvailableLeftTab();t&&t===i?this.index<i.index?(this._canRightSlide=!0,this._canLeftSlide=!1,this.rightTab=t,t.position=100,t.content.show(),t.content.setStyle("webkitTransform","translate"+this._axis+"(100%)")):(this._canRightSlide=!1,this._canLeftSlide=!0,this.leftTab=i,i.position=-100,i.content.show(),i.content.setStyle("webkitTransform","translate"+this._axis+"(-100%)")):(t?(this._canRightSlide=!0,this.rightTab=t,t.position=100,t.content.show(),t.content.setStyle("webkitTransform","translate"+this._axis+"(100%)")):this._canRightSlide=!1,i?(this._canLeftSlide=!0,this.leftTab=i,i.position=-100,i.content.show(),i.content.setStyle("webkitTransform","translate"+this._axis+"(-100%)")):this._canLeftSlide=!1)},n.prototype.toggleTabAvailability=function(e,t){var i=isNaN(e)?this.tabMap[e]:this.tabList[e];i&&(arguments.length<2&&(console.error(new Error("toggleTabAvailability missing param")),t=!i.enable),t=!!t,t!==i.enable&&(i.enable=t,this.header&&(t?i.tabBtn.enable():i.tabBtn.disable()),null!==this.index&&this._positionTabs()))},n.prototype.toggleTabNotification=function(e,t){var i=isNaN(e)?this.tabMap[e]:this.tabList[e];i&&this.header&&i.tabBtn.toggleClassName("notification",t)},e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this);var e,t,i,n,o,c,u,d;this.worldMapTooltip=new l,this.once("open",function(){this.header.setText(a("ui.cartography.title"));var s=r.getWindow("worldMap"),l=window.gui.GPS;this.worldMapTooltip.addClassNames("worldMapTooltip"),this.entryList.appendChild(this.worldMapTooltip),this._addSeparator(),e=this._addEntry(a("ui.common.teleport"),function(){window.dofus.sendMessage("AdminQuietCommandMessage",{content:"move * "+d.i+","+d.j}),s.isFullScreen&&r.close("worldMap")}),o=this._addEntry(a("ui.map.flag"),function(){l.addCustomFlag(d.i,d.j)}),c=this._addEntry(a("ui.common.remove"),function(){l.removeCustomFlag(d.i,d.j)}),t=this._addEntry(a("ui.common.remove")+" ["+a("ui.zaap.zaap")+"]",function(){l.removePOI(this.flagId)}),i=this._addEntry(a("ui.common.remove")+" ["+a("ui.common.quests")+"]",function(){l.removePOI(this.flagId)}),n=this._addEntry(a("ui.common.remove")+" ["+a("ui.map.flagDefaultName")+"]",function(){l.removePOI(this.flagId)}),u=this._addEntry(a("ui.common.remove")+" ["+a("tablet.ui.map.estate")+"]",function(){l.removePOI(this.flagId)}),this._addCancel()}),this.on("open",function(s,a){d=s,o.show(),c.hide(),i.hide(),t.hide(),n.hide(),u.hide();var r=s.icons;if(r)for(var l=0,h=r.length;l<h;l+=1){var p=r[l];"customFlag"===p.categoryId?(c.show(),o.hide()):"questObjective"===p.categoryId?(i.flagId=p.id,i.show()):"zaap"===p.categoryId?(t.flagId=p.id,t.show()):"hint"===p.categoryId?(n.flagId=p.id,n.show()):"estate"===p.categoryId&&(u.flagId=p.id,u.show())}e.toggleDisplay(window.gui.playerData.isModeratorOrMore()||window.gui.playerData.isForcedAccount),a()})}i(614);var o=i(191).inherits,s=i(480),a=i(29).getText,r=i(225),l=i(615);o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(e,t){l.call(this,"div",{className:"WorldMapIcon"});var i=e.dimensions,n=Math.min(i.h,30),o=Math.floor(i.w*n/i.h),s=this.createChild("canvas",{className:"icon"});s.rootElement.width=o,s.rootElement.height=n,s.setStyle("minWidth",o+"px");var a=s.rootElement.getContext("2d");a.drawImage(t,i.sx,i.sy,i.sw,i.sh,0,0,o,n),e.infoData.nameIdOverRideFunc?this.createChild("div",{className:"description",text:e.infoData.nameIdOverRideFunc()}):this.createChild("div",{className:"description",text:e.infoData.nameId.replace("\\n ","\n")})}function o(){l.call(this,"div",{className:"WorldMapTooltip"}),this.coordinates=this.createChild("div"),this.subAreaName=this.createChild("div"),this.subArea=this.createChild("div",{className:"subArea"}),this.level=this.subArea.createChild("div"),this.alliance=this.subArea.createChild("div",{className:"alliance"}),this.allianceEmblem=this.alliance.appendChild(new s({width:28,height:28})),this.allianceName=this.alliance.createChild("div"),this.icons=this.createChild("div",{className:"icons"})}var s=i(469),a=i(29).getText,r=i(191).inherits,l=i(235);r(n,l),r(o,l),e.exports=o,o.prototype.setCoordinates=function(e,t){this.coordinates.setText(a("ui.common.coordinatesSmall")+" "+e+","+t)},o.prototype.displayIcons=function(){this.icons.show(),this.subArea.hide()},o.prototype.setIcons=function(e,t){this._icons=e,this.icons.clearContent();for(var i=0,o=e.length;i<o;i+=1)this.icons.appendChild(new n(e[i],t))},o.prototype.unsetAlliance=function(){this.alliance.hide()},o.prototype.setAlliance=function(e){this.allianceName.setText(e.allianceName+" ["+e.allianceTag+"]"),this.allianceEmblem.setValue(e.allianceEmblem,!0),this.alliance.show()},o.prototype.unsetSubArea=function(){this.subAreaName.hide()},o.prototype.displayCoordinates=function(){this.subAreaName.hide(),this.icons.hide(),this.subArea.hide()},o.prototype.setSubArea=function(e){this.subAreaName.setText(e.nameId),this.level.setText(a("ui.common.averageLevel")+" "+e.level),this.subAreaName.show()},o.prototype.displaySubArea=function(){this.icons.hide(),this.subArea.show()}},function(e,t,i){function n(){s.call(this),this.once("open",function(){this.buttonsContainer=this.entryList.createChild("div"),this._addCancel()}),this.on("open",function(e,t){this._update(e),t()})}var o=i(191).inherits,s=i(480),a=i(246),r=i(29).getText;o(n,s),e.exports=n,n.prototype._update=function(e){var t=this;e=e||{};var i=e.id,n=e.name,o=e.cellId,s=r("ui.humanVendor.playerShop",n);this.header.setText(s),this.buttonsContainer.clearContent(),this.buyButton=this.buttonsContainer.appendChild(new a({text:r("ui.common.buy"),className:"cmButton"},function(){window.dofus.sendMessage("ExchangeOnHumanVendorRequestMessage",{humanVendorId:i,humanVendorCell:o}),window.gui.closeContextualMenu(),t.emit("close")}));var l=window.gui.playerData,c=l.adminMenu.getAdminMenuId();l.isModeratorOrMore()&&null!==c&&(this.adminButton=this.buttonsContainer.appendChild(new a({text:"Admin",className:"cmButton"},function(){window.gui.closeContextualMenu(),window.gui.openContextualMenuAround("admin",this,e),t.emit("close")})))}},function(e,t,i){function n(){var e=this;s.call(this,{className:"ContextualMenuMonster"}),this.monsterId=null,this.attack=null,this.once("open",function(){this._setupDom()}),this.on("open",function(t,i){var n=window.gui.tutorialManager;n.inTutorial&&n.tutorialStep.checkClickedMonster(),this.monsterId=t.contextualId,this.starCounter.setValue(t.ageBonus),this.monstersList.clearContent();var o=this.monstersList.createChild("div",{className:"willFightContainer"}),s=this.monstersList.createChild("div",{className:"willNotFightContainer"}),a=[t.staticInfos.mainCreatureLightInfos].concat(t.staticInfos.underlings);for(e._monsterIds=[],c=0;c<a.length;c+=1)e._monsterIds.push(a[c].creatureGenericId);var c,u=t.staticInfos.alternatives,d=null,h=[],p=window.gui.playerData.partyData.getClassicalParty(),m=p?p.getMemberCount():1;if(u){for(var f=0;u[f]&&u[f].playerCount<=m;)d=u[f],f+=1;for(c=0;c<d.monsters.length;c+=1)h.push(d.monsters[c].creatureGenericId)}var g=t.scaleLevel;if(g){var _=window.gui.playerData.ToaData.getMonsterLevelScaled(g);for(c=0;c<a.length;c+=1)a[c].staticInfos.level=_}var v=a.sort(function(e,t){return t.staticInfos.level-e.staticInfos.level}),y=[],b=0;for(c=0;c<v.length;c+=1){var w=v[c],M=w.staticInfos,T=w.creatureGenericId,C=!0;if(u){C=!1;var I=h.indexOf(T);I!==-1&&(C=!0,h.splice(I,1))}C&&(b+=M.level);var A=M.nameId+" ("+M.level+")",S=C?o:s,E="monsterName";if(M.isMiniBoss)E=["monsterName","miniBoss"],S.createChild("div",{className:E,text:A});else if(M.isBoss){E=["monsterName","boss"];var x=S.createChild("div",{className:E,text:A});x.createChild("div",{className:"bossIcon"}),x.createChild("div",{className:"bossName",text:A})}else S.createChild("div",{className:E,text:A});y.push({id:w.creatureGenericId,xp:M.xp,level:M.level})}e.level.setText(l("ui.common.rank",b)),e.attack.setEnable(!window.gui.playerData.getRestrictions().cantAttackMonster);var L=r.getXpPreview(y,window.gui.playerData,null,t.ageBonus),N=r.getXpPreview(y,window.gui.playerData,p,t.ageBonus);e.xp.setText(l("ui.tooltip.monsterXpAlone",r.intToString(L))),m>1&&e.xpGroup.setText(l("ui.tooltip.monsterXpParty",r.intToString(N))),e.xpGroup.toggleDisplay(m>1),i()})}i(618);var o=i(191).inherits,s=i(480),a=i(464),r=i(252),l=i(29).getText,c=i(225);o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this,t=this.header.createChild("div",{className:"monsterInfosContainer"});this.level=t.createChild("div",{className:"level"}),this.starCounter=t.appendChild(new a),this.starCounter.on("shopOpened",function(){e.close()}),this.xp=t.createChild("div",{className:"xp"}),this.xpGroup=t.createChild("div",{className:"xp"}),this.monstersList=this.entryList.createChild("div",{className:"monstersList"}),this.attack=this._addEntry(l("ui.common.attack"),function(){e.monsterId&&window.isoEngine.attackActor(e.monsterId),e.close()}),this.bestiary=this._addEntry(l("ui.common.bestiary"),function(){c.open("grimoire",{tabId:"bestiary",tabParams:{monsterIds:e._monsterIds}})}),this._addCancel()}},function(e,t){},function(e,t,i){function n(e,t,i,n){switch(n){case 2:case 4:case 7:case 8:l.getWindow("tradeWithNPC").prepareExchange(e.nameId);break;case 3:window.gui.npcDialogHandler.prepareDialog(e)}if(window.foreground.lock("npcActionRequest"),window.dofus.sendMessage("NpcGenericActionRequestMessage",{npcId:t,npcActionId:n,npcMapId:i}),9===n||10===n){var o=window.foreground,s=window.gui,a=9===n?"HouseToSellListMessage":"PaddockToSellListMessage",r=setTimeout(function(){console.error(new Error(a+" not received: timeout triggered to unlock the character")),o.unlock("npcActionRequest"),s.removeListener(a,c)},5e3),c=function(){o.unlock("npcActionRequest"),clearTimeout(r)};window.gui.once(a,c)}}function o(){a.call(this);var e=this;this.once("open",function(){this._setupDom()}),this.on("open",function(t,i){function o(){n(s,a,l,this.npcActionId),e.close()}var s=t.npcData,a=t.actorId,l=t.mapId;this.header.setText(s.nameId),this.actionsContainer.clearContent();for(var c=window.gui.playerData.isAlive(),u=0,d=s.actions.length;u<d;u++){var h=this.actionsContainer.appendChild(new r({text:s.actionsName[u],className:"cmButton",disable:!c},o));h.npcActionId=s.actions[u]}i()})}var s=i(191).inherits,a=i(480),r=i(246),l=i(225);s(o,a),e.exports=o,o.npcActionRequest=n,o.prototype._setupDom=function(){var e=this.entryList.createChild("div");this.actionsContainer=e.createChild("div"),this._addCancel()}},function(e,t,i){function n(){o.call(this);var e;this.once("open",function(){e=this.header.appendChild(new s);var t=this._addEntry(a("ui.common.ankaboxMessage"),function(){});t.disable(),this._addCancel()}),this.on("open",function(t,i){if(void 0===t.hoursSinceLastConnection)e.setContent({name:t.playerName});else{var n=Math.floor(t.hoursSinceLastConnection),o=Math.floor(n/720),s=Math.floor((n-720*o)/24),r="";r=o>0?s>0?a("ui.social.monthsAndDaysSinceLastConnection",o,s):a("ui.social.monthsSinceLastConnection",o):s>0?a("ui.social.daysSinceLastConnection",s):n>0?a("tablet.ui.social.hoursSinceLastConnection",n):a("tablet.ui.social.lessThanOneHour"),e.setContent({name:t.playerName+"\n"+a("ui.social.lastConnection",r)})}i()})}var o=i(480),s=i(491),a=i(29).getText,r=i(191).inherits;r(n,o),e.exports=n},function(e,t,i){function n(){s.call(this);var e=this;this.data=null,this.on("open",function(e,t){this.data=e,this.header.setText(e.paddockObjectName),t()}),this.once("open",function(){this._addEntry(a("ui.common.remove"),function(){window.dofus.sendMessage("PaddockRemoveItemRequestMessage",{cellId:e.data.cellId})}),this._addCancel()})}var o=i(191).inherits,s=i(480),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){s.call(this),this.partyId=!1,this.isLoyal=!1,this.once("open",function(){this._setupDom()}),this.on("open",function(e,t){this.partyId=e.partyId,this.isLoyal=e.isLoyal,this.loyalMsg.toggleClassName("ticked",e.isLoyal),e.partyType===r.PARTY_TYPE_ARENA?this.restrictedMsg.hide():(this.restrictedMsg.show(),this.restrictedMsg.setEnable(e.isLeader),this.restrictedMsg.toggleClassName("ticked",e.isRestricted)),t()})}var o=i(191).inherits,s=i(480),a=i(29).getText,r=i(623),l=i(396);o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this;this.header.setText(a("ui.common.options")),this.restrictedMsg=this._addEntry(a("ui.party.lockFight"),function(){window.dofus.sendMessage("GameFightOptionToggleMessage",{option:l.FIGHT_OPTION_SET_TO_PARTY_ONLY})}),this.loyalMsg=this._addEntry(a("ui.party.refuseOtherInvitations"),function(){window.dofus.sendMessage("PartyPledgeLoyaltyRequestMessage",{partyId:e.partyId,loyal:!e.isLoyal})}),this._addCancel()}},function(e,t){e.exports={PARTY_TYPE_UNDEFINED:0,PARTY_TYPE_CLASSICAL:1,PARTY_TYPE_DUNGEON:2,PARTY_TYPE_ARENA:3}},function(e,t,i){function n(){a.call(this);var e,t;this.once("open",function(){var i=this,n=this.header.appendChild(new o);e=this.entryList.appendChild(new r(n)),e.on("close",function(){i.close()}),t=this.entryList.appendChild(new l(n)),t.on("close",function(){i.close()}),this._addCancel()}),this.on("open",function(i,n){var o=i.playerId===window.gui.playerData.id;o?t.updateContent(i):e.updateContent(i),t.toggleDisplay(o),e.toggleDisplay(!o),n()})}var o=i(491),s=i(191).inherits,a=i(480),r=i(625),l=i(626);s(n,a),e.exports=n},function(e,t,i){function n(e){T.call(this,"div",{className:"ContextualMenuPlayerContent"});var t=this.createChild("div");this.banner=e,this._setupGroup1(t),this._setupGroup2(t),this._setupGroup3(t),this._setupGroup4(t),this._setupGroup5(t),this._setupGroup6(t),this._setupHelper(t),this._setupAdmin(t)}function o(e){return e===M.AvA_ENABLED_AGGRESSABLE||e===M.AvA_PREQUALIFIED_AGGRESSABLE}function s(e){return e?0!==(e.capabilities&B):(console.warn("isAggressionAllowedOnMap called before we know mapPosition"),!1)}function a(e,t,i){var n=window.gui.playerData;if(!s(n.position.mapPosition))return D;if(n.isMutant())return n.getRestrictions().cantAttack||i?R:P;if(i)return P;var a=1===window.gui.serversData.settings.serverGameType,r=n.alliance.current,l=A.entities.prism[n.position.subAreaId],c=l&&l.prism,u=c&&c.mapId!==-1,d=n.characters.mainCharacter.characteristics.alignmentInfos,p=o(d.aggressable),m=!1;if(u){var g=c.state===w.PRISM_STATE_VULNERABLE;if(a){if(r&&!p&&(c.alliance.allianceId!==r.allianceId||d.aggressable!==M.AvA_ENABLED_NON_AGGRESSABLE))return D}else if(g){if(r&&(!p||!t))return D}else m=!0;if(!m){if(!r)return D;if(t&&(a||g)){if(t.aggressable===M.AvA_DISQUALIFIED)return R;if(!o(t.aggressable)||r.allianceId===t.allianceInformations.allianceId||a&&c.alliance.allianceId===t.allianceInformations.allianceId&&!g)return D}}f=!0}if(a){if(!u){if(r&&t){if(r.allianceId===t.allianceInformations.allianceId||!p||!o(t.aggressable))return D}else if(!r||p)return D;f=!0}}else if(!u||m){if(!d||!e||d.aggressable!==M.PvP_ENABLED_AGGRESSABLE||e.alignmentSide<=I.ALIGNMENT_NEUTRAL||0===e.alignmentGrade||d.alignmentSide!==I.ALIGNMENT_MERCENARY&&d.alignmentSide===e.alignmentSide||d.alignmentSide===I.ALIGNMENT_NEUTRAL)return D;f=!1}var _=n.characterBaseInformations.level;if(a&&_<50)return R;var v=f?100:50;return _+v<e.characterPower-h?D:P}var r,l,c,u,d,h,p,m,f,g=i(191).inherits,_=i(29).getText,v=i(246),y=i(526).GuildRightsBitEnum,b=i(280),w=i(533),M=i(522),T=i(235),C=i(225),I=i(472),A=i(523),S=i(269),E=i(28),x=E.DofusDate,L=i(412),N=i(394).FIGHT_STATES,O=!1,D=-1,R=0,P=1,B=2;g(n,T),e.exports=n,n.prototype.updateContent=function(e){function t(e){switch(e._type){case"HumanOptionAlliance":s=e;break;case"HumanOptionGuild":o=e.guildInformations}}d=e.accountId,h=e.playerId,p=e.playerName,m=e.cellId;var i=e.humanoidInfoOptions,n=e.alignmentInfos;this.admin.hide(),this.muteLong.hide(),this.muteShort.hide();var o=null,s=null;if(this.targetPlayer={id:h,name:p},i)for(var a=0,f=i.length;a<f;a+=1)t(i[a]);var g={name:p,guild:o};null!==s&&(g.alliance=s.allianceInformations),this.banner.setContent(g);var _=window.gui.playerData.partyData;r=_.getClassicalParty(),l=_.getArenaParty(),c=r?r.getPartyId():null,u=l?l.getPartyId():null,this.toggleButtonsAvailability(e,n,o,s);
var v=window.gui.playerData.adminMenu.getAdminMenuId();window.gui.playerData.isModeratorOrMore()&&null!==v&&this.admin.show(),window.gui.playerData.isCommunityHelper()&&parseInt(e.channel,10)===L.CHANNEL_NOOB&&(this.muteLong.show(),this.muteShort.show())},n.prototype.hideButtons=function(){this.kickFighter.hide(),this.challenge.hide(),this.assault.hide(),this.exchangeProp.hide(),this.inviteParty.hide(),this.inviteArena.hide(),this.inviteGuild.hide(),this.inviteAlliance.hide(),this.addFriend.hide(),this.addEnemy.hide(),this.ignoreSession.hide(),this.stopIgnoreSession.hide(),this.partyTitle.hide(),this.follow.hide(),this.stopFollowing.hide(),this.kickPlayer.hide(),this.appointLeader.hide(),this.kickArenaPlayer.hide(),this.appointArenaLeader.hide(),this.allFollow.hide(),this.allStopFollow.hide(),this.cancelPartyInvitation.hide(),this.leaveParty.hide(),this.arenaTitle.hide(),this.cancelArenaInvitation.hide(),this.leaveArena.hide(),this.kickOutFromHome.hide(),this.guildInformations.hide(),this.allianceInformations.hide()},n.prototype.toggleButtonsAvailability=function(e,t,i,n){e=e||{};var o=window.gui.playerData,s=o.partyData,c=o.jobs,u=o.socialData,p=!o.isAlive(),m=e.isMutant;if(this.hideButtons(),window.gui.fightManager.fightState===N.PREPARATION&&o.isFightLeader&&o.id!==h&&this.kickFighter.show(),r&&r.getGuest(h)?(this.partyTitle.show(),this.cancelPartyInvitation.show()):r&&r.getMember(h)||this.inviteParty.show(),l&&l.getGuest(h)?(this.arenaTitle.show(),this.cancelArenaInvitation.show()):l&&l.getMember(h)||this.inviteArena.show(),d&&(u.friendsList[d]||u.enemiesList[d])||(this.addFriend.show(),this.addEnemy.show()),u.isIgnored(d)?this.stopIgnoreSession.show():this.ignoreSession.show(),r&&r.getMember(h)&&(this.partyTitle.show(),s.getFollowedCharacterId()===h?this.stopFollowing.show():this.follow.show(),r.getLeaderId()===o.id&&(this.kickPlayer.show(),this.appointLeader.show(),O?this.allStopFollow.show():this.allFollow.show())),this.kickOutFromHome.toggleDisplay(!!window.gui.playerData.position.isInMyHouse),l&&l.getMember(h)&&l.getLeaderId()===o.id&&(this.arenaTitle.show(),this.kickArenaPlayer.show(),this.appointArenaLeader.show()),this.join.toggleDisplay(S.isRoleplayMode&&o.position.isInIncarnam()),S.isRoleplayMode){var f=o.getRestrictions();if(f.cantExchange||(p?this.exchangeProp.disable():this.exchangeProp.enable(),this.exchangeProp.show()),t){f.cantChallenge||(p?this.challenge.disable():this.challenge.enable(),this.challenge.show());var g=a(t,n,m,h);g!==R&&g!==P||(g===R||p?this.assault.disable():this.assault.enable(),this.assault.show())}}var _=o.guild;!e.hasGuild&&!i&&_.current&&_.hasRight(y.GUILD_RIGHT_INVITE_NEW_MEMBERS)&&this.inviteGuild.show();var v=o.alliance;!e.hasGuild&&h&&i&&!n&&v.current&&v.isBoss()&&this.inviteAlliance.show(),i&&(this.guildId=i.guildId,this.guildInformations.show()),n&&(this.allianceId=n.allianceInformations.allianceId,this.allianceInformations.show()),this._updateMultiCraftMenu(e,o,c)},n.prototype._setupGroup1=function(e){var t=this,i=e.createChild("div",{className:"group"});this.kickFighter=i.appendChild(new v({text:_("ui.fight.kick"),className:"cmButton"},function(){window.dofus.sendMessage("GameContextKickMessage",{targetId:h}),t.emit("close")}))},n.prototype._setupGroup2=function(e){var t=this,i=e.createChild("div",{className:"group"});this.privateMessage=i.appendChild(new v({text:_("ui.common.wisperMessage"),className:"cmButton"},function(){window.gui.chat.startPrivateMessage(p),t.emit("close")})),i.appendChild(new v({text:_("ui.common.ankaboxMessage"),className:["cmButton","disabled"]},function(){})),this.challenge=i.appendChild(new v({text:_("ui.common.challenge"),className:"cmButton"},function(){window.gui.playerData.fightRequests.requestChallenge({targetId:h,targetName:p,targetCellId:m}),t.emit("close")})),this.assault=i.appendChild(new v({text:_("ui.pvp.assault"),className:"cmButton"},function(){window.gui.playerData.fightRequests.requestAssault({targetId:h,targetName:p,targetCellId:m},f),t.emit("close")})),this.join=i.appendChild(new v({text:_("ui.common.join"),className:"cmButton"},function(){window.dofus.sendMessage("FriendJoinRequestMessage",{name:p}),t.emit("close")})),this.kickOutFromHome=i.appendChild(new v({text:_("ui.common.kickOff"),className:"cmButton"},function(){window.dofus.sendMessage("HouseKickRequestMessage",{id:h}),t.emit("close")})),i.appendChild(new v({text:_("ui.common.informations"),className:["cmButton"]},function(){var e=new x(E.now()/1e3).getServerDate(!1).toString(!1),i=e.date+" - "+e.time;window.gui.chat.logMsg(i),window.dofus.sendMessage("BasicWhoIsRequestMessage",{search:p,verbose:!0}),t.emit("close")})),this.guildInformations=i.appendChild(new v({text:_("ui.guild.guildInformations"),className:"cmButton"},function(){window.dofus.sendMessage("GuildFactsRequestMessage",{guildId:t.guildId}),t.emit("close")})),this.allianceInformations=i.appendChild(new v({text:_("ui.alliance.allianceInformations"),className:"cmButton"},function(){window.dofus.sendMessage("AllianceFactsRequestMessage",{allianceId:t.allianceId}),t.emit("close")}))},n.prototype._setupGroup3=function(e){var t=this,i=e.createChild("div",{className:"group"});this.exchangeProp=i.appendChild(new v({text:_("ui.common.exchangeProp"),className:"cmButton"},function(){t.emit("close"),C.getWindow("tradeWithPlayer").prepareMakeExchange({targetId:h,targetName:p}),window.dofus.sendMessage("ExchangePlayerRequestMessage",{exchangeType:1,target:h})})),this.inviteParty=i.appendChild(new v({text:_("ui.party.addToParty"),className:"cmButton"},function(){window.dofus.sendMessage("PartyInvitationRequestMessage",{name:p}),t.emit("close")})),this.inviteArena=i.appendChild(new v({text:_("ui.party.addToArena"),className:"cmButton"},function(){window.dofus.sendMessage("PartyInvitationArenaRequestMessage",{name:p}),t.emit("close")})),this.inviteGuild=i.appendChild(new v({text:_("ui.social.inviteInGuild"),className:"cmButton"},function(){h?window.dofus.sendMessage("GuildInvitationMessage",{targetId:h}):window.dofus.sendMessage("GuildInvitationByNameMessage",{name:p}),t.emit("close")})),this.inviteAlliance=i.appendChild(new v({text:_("ui.social.inviteInAlliance"),className:"cmButton"},function(){window.dofus.sendMessage("AllianceInvitationMessage",{targetId:h}),t.emit("close")})),this._multiCraftMenu=i.createChild("div",{className:"multiCraftMenu"})},n.prototype._setupGroup4=function(e){var t=this,i=e.createChild("div");this.addFriend=i.appendChild(new v({text:_("ui.social.addToFriends"),className:"cmButton"},function(){t.emit("close"),window.gui.openConfirmPopup({title:_("ui.popup.warning"),message:_("ui.social.confirmAddFriend",p),cb:function(e){e&&window.dofus.sendMessage("FriendAddRequestMessage",{name:p})}})})),this.addEnemy=i.appendChild(new v({text:_("ui.social.addToEnemy"),className:"cmButton"},function(){t.emit("close"),window.gui.openConfirmPopup({title:_("ui.popup.warning"),message:_("ui.social.confirmAddEnemy",p),cb:function(e){e&&window.dofus.sendMessage("IgnoredAddRequestMessage",{name:p,session:!1})}})})),this.ignoreSession=i.appendChild(new v({text:_("ui.social.blackListTemporarly"),className:"cmButton"},function(){window.dofus.sendMessage("IgnoredAddRequestMessage",{name:p,session:!0}),t.emit("close")})),this.stopIgnoreSession=i.appendChild(new v({text:_("ui.social.blackListRemove"),className:"cmButton"},function(){window.dofus.sendMessage("IgnoredDeleteRequestMessage",{accountId:d,session:!0}),t.emit("close")}))},n.prototype._setupGroup5=function(e){var t=this,i=e.createChild("div");this.partyTitle=i.createChild("div",{text:_("ui.common.party"),className:"title"}),this.follow=i.appendChild(new v({text:_("ui.common.follow"),className:"cmButton"},function(){window.dofus.sendMessage("PartyFollowMemberRequestMessage",{partyId:c,playerId:h}),t.emit("close")})),this.stopFollowing=i.appendChild(new v({text:_("ui.party.stopFollowing"),className:"cmButton"},function(){window.dofus.sendMessage("PartyStopFollowRequestMessage",{partyId:c}),t.emit("close")})),this.kickPlayer=i.appendChild(new v({text:_("ui.party.kickPlayer"),className:"cmButton"},function(){window.dofus.sendMessage("PartyKickRequestMessage",{partyId:c,playerId:h}),t.emit("close")})),this.appointLeader=i.appendChild(new v({text:_("ui.party.promotePartyLeader"),className:"cmButton"},function(){window.dofus.sendMessage("PartyAbdicateThroneMessage",{partyId:c,playerId:h}),t.emit("close")})),this.allFollow=i.appendChild(new v({text:_("ui.party.followHimAll"),className:"cmButton"},function(){window.dofus.sendMessage("PartyFollowThisMemberRequestMessage",{partyId:c,playerId:h,enabled:!0}),O=!0,t.emit("close")})),this.allStopFollow=i.appendChild(new v({text:_("ui.party.stopAllFollowingHim"),className:"cmButton"},function(){window.dofus.sendMessage("PartyFollowThisMemberRequestMessage",{partyId:c,playerId:h,enabled:!1}),O=!1,t.emit("close")})),this.cancelPartyInvitation=i.appendChild(new v({text:_("ui.party.cancelInvitation"),className:"cmButton"},function(){window.dofus.sendMessage("PartyCancelInvitationMessage",{partyId:c,guestId:h}),t.emit("close")})),this.leaveParty=i.appendChild(new v({text:_("ui.party.leaveParty"),className:"cmButton"},function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:c}),t.emit("close")}))},n.prototype._setupGroup6=function(e){var t=this,i=e.createChild("div",{className:"group"});this.arenaTitle=i.createChild("div",{text:_("ui.common.koliseum"),className:"title"}),this.cancelArenaInvitation=i.appendChild(new v({text:_("ui.party.cancelInvitation"),className:"cmButton"},function(){window.dofus.sendMessage("PartyCancelInvitationMessage",{partyId:u,guestId:h}),t.emit("close")})),this.kickArenaPlayer=i.appendChild(new v({text:_("ui.party.kickPlayer"),className:"cmButton"},function(){window.dofus.sendMessage("PartyKickRequestMessage",{partyId:u,playerId:h}),t.emit("close")})),this.appointArenaLeader=i.appendChild(new v({text:_("ui.party.promotePartyLeader"),className:"cmButton"},function(){window.dofus.sendMessage("PartyAbdicateThroneMessage",{partyId:u,playerId:h}),t.emit("close")})),this.leaveArena=i.appendChild(new v({text:_("ui.party.arenaQuit"),className:"cmButton"},function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:u}),t.emit("close")}))},n.prototype._updateMultiCraftMenu=function(e,t,i){function n(e,t,i){var n=o.appendChild(new v({text:e,className:"cmButton"},function(){window.dofus.sendMessage("ExchangePlayerMultiCraftRequestMessage",{exchangeType:t,target:h,skillId:i}),s.emit("close")}));r?n.disable():n.enable()}var o=this._multiCraftMenu;if(o.clearContent(),!S.isFightMode){var s=this,a=t.id,r=!t.isAlive();if(e.isInteractiveRequired&&a!==e.playerId){var l,c=window.isoEngine.mapRenderer.interactiveElements,u=i.getUsableSkillsInMap(a,c),d=_("ui.common.inviteTo");for(var p in u){var m=u[p];l=d+" "+m.nameId,n(l,b.MULTICRAFT_CRAFTER,m.id)}var f=i.getUsableSkillsInMap(h,c),g=_("ui.common.askTo");for(var y in f){var w=f[y];l=g+" "+w.nameId,n(l,b.MULTICRAFT_CUSTOMER,w.id)}}}},n.prototype._setupHelper=function(e){var t=this;t.muteShort=e.appendChild(new v({text:_("tablet.chat.mute.short"),className:"cmButton"},function(){window.dofus.sendMessage("AdminQuietCommandMessage",{content:"mutenoob "+t.targetPlayer.name+" short"}),t.emit("close")})),t.muteLong=e.appendChild(new v({text:_("tablet.chat.mute.long"),className:"cmButton"},function(){window.dofus.sendMessage("AdminQuietCommandMessage",{content:"mutenoob "+t.targetPlayer.name+" long"}),t.emit("close")}))},n.prototype._setupAdmin=function(e){var t=this;t.admin=e.appendChild(new v({text:"Admin",className:"cmButton"},function(){window.gui.closeContextualMenu(),window.gui.openContextualMenuAround("admin",t.admin,t.targetPlayer),t.emit("close")}))}},function(e,t,i){function n(e){u.call(this,"div",{className:"ContextualMenuUserContent"}),this.banner=e,this._createDom()}var o,s,a,r=i(191).inherits,l=i(29).getText,c=i(246),u=i(235),d=i(627),h=i(269);r(n,u),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.createChild("div"),i=window.gui.playerData;this.freeSoul=t.appendChild(new c({text:l("ui.common.freeSoul"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("GameRolePlayFreeSoulRequestMessage"),e.emit("close")})),this.slapHimself=t.appendChild(new c({text:l("ui.dialog.slapHimself"),className:"cmButton"},function(){window.dofus.sendMessage("ChatClientMultiMessage",{content:l("ui.dialog.slapSentence"),channel:0}),e.emit("close")})),this.organizeShop=t.appendChild(new c({text:l("ui.humanVendor.organizeShop"),className:"cmButton"},function(){window.dofus.sendMessage("ExchangeRequestOnShopStockMessage"),e.emit("close")})),this.switchToMerchantMode=t.appendChild(new c({text:l("ui.humanVendor.switchToMerchantMode"),className:"cmButton"},function(){window.dofus.sendMessage("ExchangeShowVendorTaxMessage"),e.emit("close")})),this.orientCharacter=t.appendChild(new c({text:l("ui.orientCharacter"),className:["cmButton","disabled"]},function(){})),this.partyTitle=t.createChild("div",{text:l("ui.common.party"),className:"title",hidden:!0}),this.leaveParty=t.appendChild(new c({text:l("ui.party.leaveParty"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:o}),e.emit("close")})),this.followMe=t.appendChild(new c({text:l("ui.party.followMeAll"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("PartyFollowThisMemberRequestMessage",{partyId:o,playerId:i.id,enabled:!0}),a=!0,e.emit("close")})),this.stopFollowMe=t.appendChild(new c({text:l("ui.party.stopAllFollowingMe"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("PartyFollowThisMemberRequestMessage",{partyId:o,playerId:i.id,enabled:!1}),a=!1,e.emit("close")}));var n=t.createChild("div",{className:"group"});this.arenaTitle=n.createChild("div",{text:l("ui.common.koliseum"),className:"title",hidden:!0}),this.leaveArena=n.appendChild(new c({text:l("ui.party.arenaQuit"),className:"cmButton",hidden:!0},function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:s}),e.emit("close")})),this.fightReady=t.appendChild(new c({text:l("ui.banner.ready"),className:"cmButton"},function(){window.gui.timeline.fightControlButtons.toggleReadyForFight(),e.emit("close")})),this.admin=t.appendChild(new c({text:"Admin",className:"cmButton"},function(){var t={id:i.id,name:i.characterBaseInformations.name};window.gui.closeContextualMenu(),window.gui.openContextualMenuAround("admin",e.admin,t),e.emit("close")}))},n.prototype.updateContent=function(){var e=window.gui.playerData,t=e.partyData.getClassicalParty(),i=e.partyData.getArenaParty();if(this.banner.setContent({name:e.characterBaseInformations.name}),o=t?t.getPartyId():null,s=i?i.getPartyId():null,this.freeSoul.hide(),this.slapHimself.hide(),this.organizeShop.hide(),this.switchToMerchantMode.hide(),this.orientCharacter.hide(),this.partyTitle.hide(),this.leaveParty.hide(),this.arenaTitle.hide(),this.leaveArena.hide(),this.followMe.hide(),this.stopFollowMe.hide(),this.fightReady.hide(),this.admin.hide(),e.state===d.STATUS_TOMBSTONE?this.freeSoul.show():h.isRoleplayMode&&(this.slapHimself.show(),window.gui.uiLocker.isFeatureAvailable("myShop")&&(this.organizeShop.show(),this.switchToMerchantMode.show()),this.orientCharacter.show()),o&&(this.partyTitle.show(),this.leaveParty.show(),t.getLeaderId()===e.id)){if(a)return this.followMe.hide(),void this.stopFollowMe.show();this.followMe.show(),this.stopFollowMe.hide()}s&&(this.arenaTitle.show(),this.leaveArena.show()),window.gui.timeline.fightControlButtons.isReadyForFightButtonVisible()&&this.fightReady.show();var n=e.adminMenu.getAdminMenuId();e.isModeratorOrMore()&&null!==n&&this.admin.show()}},function(e,t){e.exports={STATUS_ALIVE_AND_KICKING:0,STATUS_TOMBSTONE:1,STATUS_PHANTOM:2}},function(e,t,i){function n(){function e(){i&&(i.unset(),i.delClassNames("unavailable")),r="remove"}function t(){window.dofus.sendMessage("InventoryPresetUseMessage",{presetId:n}),r="equip"}s.call(this,{noHeader:!0});var i,n,o,r,l={};this.once("open",function(){l.equipSet=this._addEntry(a("ui.common.equip"),t),l.remove=this._addEntry(a("ui.common.remove"),e),this._addCancel()}),this.on("open",function(e,t){e=e||{},i=e.slot,o=e.onClose,n=e.presetId,r="",l.remove.toggleDisplay(!!e.canRemove),l.equipSet.toggleDisplay(!!e.hasOwnProperty("presetId")),t()}),this.on("close",function(){o&&o(r)})}var o=i(191).inherits,s=i(480),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){s.call(this);var e,t,i,n,c,p,m,f;this.once("open",function(){e=this.header.appendChild(new a),this._addEntry(r("ui.common.talk"),function(){m.prepareDialog(c.npcData),window.dofus.sendMessage("NpcGenericActionRequestMessage",{npcId:c.contextualId,npcActionId:3,npcMapId:window.gui.playerData.position.mapId})}),p=this._addEntry(r("ui.common.teleport"),function(){window.dofus.sendMessage("PrismUseRequestMessage")}),i=this._addEntry(r("ui.common.attack"),function(){window.gui.openConfirmPopup({title:r("ui.popup.warning"),message:r("tablet.popup.prismAttackConfirm"),cb:function(e){e&&window.dofus.sendMessage("PrismAttackRequestMessage")}})}),n=this._addEntry(r("ui.common.modify"),function(){h.open("social",{tabId:"alliance",tabParams:{tabId:"conquests"}})}),this._addCancel(),window.gui.on("AlliancePrismDialogQuestionMessage",function(){var e=new d(t.nextVulnerabilityDate).getServerDate().toString(),i=[f,o.prismState[t.state],e.date+" "+e.time,0];m.nextQuestionAsync(15428,[],i)})}),this.on("open",function(o,s){c=o,m=window.gui.npcDialogHandler;var a,r=window.gui.playerData;t=o.prism,"AlliancePrismInformation"===t._type?(a=o.prism.alliance,f=a.allianceName,e.setContent({alliance:a}),r.alliance.hasAlliance()&&r.alliance.current.allianceId===a.allianceId?(i.hide(),n.toggleDisplay(r.guild.hasRight(l.GUILD_RIGHT_SET_ALLIANCE_PRISM))):(i.show(),r.isAlive()&&t.state===u.PRISM_STATE_NORMAL?i.enable():i.disable(),n.hide()),p.hide()):(a=window.gui.playerData.alliance.current,f=a.allianceName,e.setContent({alliance:a}),i.hide(),p.toggleDisplay(t.hasTeleporterModule),r.guild.hasRight(l.GUILD_RIGHT_SET_ALLIANCE_PRISM)?n.show():n.hide()),s()})}var o=i(630),s=i(480),a=i(491),r=i(29).getText,l=i(526).GuildRightsBitEnum,c=i(191).inherits,u=i(533),d=i(28).DofusDate,h=i(225);c(n,s),e.exports=n},function(e,t,i){var n=i(631),o=i(29).getText,s=i(529),a=i(225);t.alliances={},t.createAlliance=function(e){var i=new n(e);return t.alliances[i.allianceId]=i,i},t.initialize=function(e){e.on("disconnect",function(){t.alliances={}}),e.on("PrismSettingsErrorMessage",function(){e.chat.logMsg(o("ui.error.cantModifiedPrismVulnerabiltyHour"))}),e.on("AllianceCreationResultMessage",function(e){switch(e.result){case s.SOCIAL_GROUP_CREATE_ERROR_ALREADY_IN_GROUP:return window.gui.openSimplePopup(o("ui.alliance.alreadyInAlliance"));case s.SOCIAL_GROUP_CREATE_OK:return a.close("socialGroupCreation");case s.SOCIAL_GROUP_CREATE_ERROR_NAME_ALREADY_EXISTS:return window.gui.openSimplePopup(o("ui.alliance.alreadyUseName"));case s.SOCIAL_GROUP_CREATE_ERROR_NAME_INVALID:return window.gui.openSimplePopup(o("ui.alliance.invalidName"));case s.SOCIAL_GROUP_CREATE_ERROR_TAG_ALREADY_EXISTS:return window.gui.openSimplePopup(o("ui.alliance.alreadyUseTag"));case s.SOCIAL_GROUP_CREATE_ERROR_TAG_INVALID:return window.gui.openSimplePopup(o("ui.alliance.invalidTag"));case s.SOCIAL_GROUP_CREATE_ERROR_EMBLEM_ALREADY_EXISTS:return window.gui.openSimplePopup(o("ui.guild.AlreadyUseEmblem"));case s.SOCIAL_GROUP_CREATE_ERROR_REQUIREMENT_UNMET:return window.gui.openSimplePopup(o("ui.guild.requirementUnmet"));case s.SOCIAL_GROUP_CREATE_ERROR_EMBLEM_INVALID:case s.SOCIAL_GROUP_CREATE_ERROR_UNKNOWN:return window.gui.openSimplePopup(o("ui.common.unknownFail"))}}),e.on("AllianceFactsMessage",function(e){a.getWindow("allianceCard").display(e)}),e.on("AllianceFactsErrorMessage",function(){e.chat.logMsg(o("ui.alliance.doesntExistAnymore"))}),t.prismState={0:o("ui.prism.state0"),1:o("ui.prism.state1"),2:o("ui.prism.state2"),3:o("ui.prism.state3"),4:o("ui.prism.state4"),5:o("ui.prism.state5"),6:o("ui.prism.state6")},t.getPrismStateInfo=function(e,t){switch(e){case 0:return o("ui.prism.stateInfos0");case 1:return o("ui.prism.stateInfos1");case 2:return o("ui.prism.stateInfos2");case 3:return o("ui.prism.stateInfos3");case 4:return o("ui.prism.stateInfos4",t);case 5:return o("ui.prism.stateInfos5");case 6:return o("ui.prism.stateInfos6")}}},t.openAllianceCard=function(e){window.dofus.sendMessage("AllianceFactsRequestMessage",{allianceId:e})}},function(e,t,i){function n(e){this.enabled=!1,this.allianceId=0,this.allianceTag="",this.allianceName="",this.creationDate=0,this.allianceEmblem=new l,this.nbMembers=0,this.prisms=[],this.guilds=[],this.guildCount=0,this.setInfo(e)}function o(e,t){t.hasOwnProperty(e)&&void 0!==t[e]&&this.hasOwnProperty(e)&&(this[e]=t[e])}function s(e){var t=0,i=e.guilds.map(function(i){var n=a.createGuild(i);return n.allianceId=e.allianceId,n.allianceName=e.allianceName,t+=n.nbMembers,n});return i[0].allianceLeader=!0,{memberCount:t,guilds:i}}var a=i(526),r=i(29).getText,l=a.Emblem;n.prototype.setInfo=function(e){for(var t in e)o.call(this,t,e);if(e.guilds){var i=s(e);this.nbMembers=i.memberCount,this.guilds=i.guilds,this.guildCount=this.guilds.length}var n=e.prisms;if(n){this.prisms={};for(var a=0,l=n.length;a<l;a+=1){var c=n[a];this.prisms[c.subAreaId]=c}}"#NONAME#"===this.allianceName&&(this.allianceName=r("ui.guild.noName")),"#TAG#"===this.allianceTag&&(this.allianceTag=r("ui.alliance.noTag")),this.allianceEmblem.isAlliance=!0},e.exports=n},function(e,t,i){function n(){function e(){i&&(i.unset(),i.delClassNames("unavailable")),r="remove"}function t(){window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:n});var e=window.gui.pingSystem.getChatIcons();e.openPanel&&e.closePanels(),r="use"}s.call(this,{noHeader:!0});var i,n,o,r,l={};this.once("open",function(){l.useSmiley=this._addEntry(a("ui.common.use"),t),l.remove=this._addEntry(a("ui.common.remove"),e),this._addCancel()}),this.on("open",function(e,t){e=e||{},i=e.slot,o=e.onClose,n=e.smileyId,r="",l.remove.toggleDisplay(!!e.canRemove),l.useSmiley.toggleDisplay(!!e.hasOwnProperty("smileyId")),t()}),this.on("close",function(){o&&o(r)})}var o=i(191).inherits,s=i(480),a=i(29).getText;o(n,s),e.exports=n},function(e,t,i){function n(){function e(){r.open("grimoire",{tabId:"spells",tabParams:{spellId:i._spellId}})}function t(){n&&n.unset(),l="remove"}s.call(this);var i=this;this._spellId=0;var n,o,l,c={};this.once("open",function(){c.showSpellUi=this._addEntry(a("ui.spell.openUI"),e),c.remove=this._addEntry(a("ui.common.remove"),t),this._addCancel()}),this.on("open",function(e,t){e=e||{},i._spellId=e.spell.id,n=e.slot,o=e.onClose,this.header.setText(e.spell.getName()),l="",c.remove.toggleDisplay(!!e.canRemove),t()}),this.on("close",function(){o&&o(l)})}var o=i(191).inherits,s=i(480),a=i(29).getText,r=i(225);o(n,s),e.exports=n},function(e,t,i){function n(){function e(){var e=this;this.menu.close(),window.gui.openConfirmPopup({title:s("ui.grimoire.spellLevel.increase"),message:s("ui.grimoire.popup.confirmation",this.upgradeCost,a,this.spellLevel),cb:function(t){t&&window.dofus.sendMessage("SpellUpgradeRequestMessage",{spellId:n,spellLevel:e.spellLevel})}})}function t(t){var i=new r("li");return i.menu=t,l(i),i.on("tap",e),i}o.call(this,{className:"ContextualMenuSpellUpgrade"});var i,n,a,c=[];this.once("open",function(){this.header.setText(s("ui.grimoire.spellLevel.increase")),i=this.entryList.createChild("ul"),this._addCancel()}),this.on("open",function(e,o){var r=e.spell;n=r.id,a=r.getName();for(var l=r.getProperty("spellLevels"),u=0,d=Math.max(l.length,c.length);u<d;u+=1){var h=u+1,p=c[u];if(p){if(!l[u]){p.hide();break}}else p=c[u]=i.appendChild(t(this));p.show();var m=!1,f=!1,g=r.getUpgradeCost(h),_=r.getProperty("minPlayerLevel",h),v=s("ui.common.level")+" "+h;h<=r.level?f=!0:window.gui.playerData.characterBaseInformations.level<_?v+=" ("+s("ui.spell.requiredLevelShort",_)+")":e.remainingPoints<g?v+=" ("+s("ui.spell.requiredPoints",g)+")":(m=!0,v+=" ("+g+" "+s("ui.common.points")+")"),p.setText(v),p.toggleClassName("disabled",!m),p.toggleClassName("checked",f),p.setEnable(m),p.spellLevel=h,p.upgradeCost=g}o()})}i(635);var o=i(480),s=i(29).getText,a=i(191).inherits,r=i(235),l=i(228);a(n,o),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(){n?l("ExchangeObjectTransfertAllToInvMessage",{}):l("ExchangeObjectTransfertAllFromInvMessage",{})}function t(){var e=o.getDisplayedItemsUIDs();!e||e.length<r.MIN_OBJ_COUNT_BY_XFERT||(e.length>r.MAX_OBJ_COUNT_BY_XFERT&&(e=e.slice(0,r.MAX_OBJ_COUNT_BY_XFERT),window.gui.chat.logMsg(a("ui.exchange.partialTransfert"))),n?l("ExchangeObjectTransfertListToInvMessage",{ids:e}):l("ExchangeObjectTransfertListFromInvMessage",{ids:e}))}function i(){n?l("ExchangeObjectTransfertExistingToInvMessage",{}):l("ExchangeObjectTransfertExistingFromInvMessage",{})}s.call(this,{noHeader:!0});var n,o,l=window.dofus.sendMessage;this.once("open",function(){this._addEntry(a("ui.storage.getAll"),e),this._addEntry(a("ui.storage.getVisible"),t),this._addEntry(a("ui.storage.getExisting"),i),this._addCancel()}),this.on("open",function(e,t){n=e.toInventory,o=e.viewer,t()})}var o=i(191).inherits,s=i(480),a=i(29).getText,r=i(277);o(n,s),e.exports=n},function(e,t,i){function n(e,t,i){var n=h[e],o=n.cached[t];return o?i(o):void c.getData(n.dbName,t,function(e,s){return e?(console.warn("ContextualMenuTaxCollector",e),i("")):(o=n.cached[t]=s[n.attribute],void i(o))})}function o(){function e(){3===this.actionId&&h.prepareDialog(s.npcData),window.dofus.sendMessage("NpcGenericActionRequestMessage",{npcId:s.contextualId,npcActionId:this.actionId,npcMapId:s.mapId})}a.call(this);var t,i,o,s,c,h,m=window.gui.playerData.guild;this.once("open",function(n){function a(e){var t=[e.guildInfo.guildName];e.maxPods&&(t.push(e.maxPods),t.push(e.prospecting),t.push(e.wisdom),t.push(e.taxCollectorsCount),t.push(l(e.kamas)),t.push(l(e.experience)),t.push(l(e.pods)),t.push(l(e.itemsValue)));var i=e.alliance;return i&&(t.push("#NONAME#"!==i.allianceName?i.allianceName:r("ui.guild.noName")),t.push("["+("#TAG#"!==i.allianceTag?i.allianceTag:r("ui.alliance.noTag"))+"]")),t}h=window.gui.npcDialogHandler,o=this.header.appendChild(new u);for(var c=n.npcData,d=0,m=c.actions.length;d<m;d+=1){var f=this._addEntry(c.actionsName[d],e);f.actionId=c.actions[d]}i=this._addEntry(r("ui.social.CollectTaxCollector"),function(){window.dofus.sendMessage("ExchangeRequestOnTaxCollectorMessage",{taxCollectorId:s.contextualId})}),t=this._addEntry(r("ui.common.attack"),function(){window.gui.openConfirmPopup({title:r("ui.popup.warning"),message:r("tablet.popup.taxCollectorAttackConfirm"),cb:function(e){e&&window.dofus.sendMessage("GameRolePlayTaxCollectorFightRequestMessage",{taxCollectorId:s.contextualId})}})}),this._addCancel(),window.gui.on("TaxCollectorDialogQuestionExtendedMessage",function(e){h.nextQuestionAsync(p.guild,[],a(e))}),window.gui.on("TaxCollectorDialogQuestionBasicMessage",function(e){h.nextQuestionAsync(p.basic,[],a(e))}),window.gui.on("AllianceTaxCollectorDialogQuestionExtendedMessage",function(e){h.nextQuestionAsync(p.alliance,[],a(e))})}),this.on("open",function(e,a){if(s=e,m.hasGuild()&&e.guild.guildId===m.current.guildId){i.show();var r=m.hasRight(d.GUILD_RIGHT_COLLECT),l=m.hasRight(d.GUILD_RIGHT_COLLECT_MY_TAX_COLLECTOR);r||l?i.enable():i.disable(),t.hide()}else i.hide(),t.show(),0!==e.taxCollectorAttack?t.disable():t.enable();n("firstName",e.taxCollector.firstNameId,function(t){n("lastName",e.taxCollector.lastNameId,function(i){c=t+" "+i,s.npcData.nameId=c,o.setContent({name:c,guild:e.guild}),a()})})})}var s=i(191).inherits,a=i(480),r=i(29).getText,l=i(252).intToString,c=i(30),u=i(491),d=i(526).GuildRightsBitEnum,h={firstName:{dbName:"TaxCollectorFirstnames",attribute:"firstnameId",cached:{}},lastName:{dbName:"TaxCollectorNames",attribute:"nameId",cached:{}}},p={guild:1,basic:2,alliance:15427};s(o,a),e.exports=o},function(e,t,i){function n(e,t,i,n){var o=new l("li",{className:t,text:e});return u(o),o.on("tap",function(){window.dofus.sendMessage("PlayerStatusUpdateRequestMessage",{status:{statusId:i}}),n.close()}),o}function o(){s.call(this,{className:"ContextualMenuUserStatus"}),this.once("open",function(){this.header.setText(a("ui.chat.status.title"));for(var e=[{label:a("ui.chat.status.availiable"),className:"available",id:c.PLAYER_STATUS_AVAILABLE},{label:a("ui.chat.status.away"),className:"away",id:c.PLAYER_STATUS_AFK},{label:a("ui.chat.status.private"),className:"private",id:c.PLAYER_STATUS_PRIVATE},{label:a("ui.chat.status.solo"),className:"solo",id:c.PLAYER_STATUS_SOLO}],t=this.entryList.createChild("ul"),i=0,o=e.length;i<o;i+=1){var s=e[i];t.appendChild(n(s.label,s.className,s.id,this))}this._addCancel()}),this.on("open",function(e,t){t()})}i(639);var s=i(480),a=i(29).getText,r=i(191).inherits,l=i(235),c=i(640),u=i(228);r(o,s),e.exports=o},function(e,t){},function(e,t){e.exports={PLAYER_STATUS_OFFLINE:0,PLAYER_STATUS_UNKNOWN:1,PLAYER_STATUS_AVAILABLE:10,PLAYER_STATUS_IDLE:20,PLAYER_STATUS_AFK:21,PLAYER_STATUS_PRIVATE:30,PLAYER_STATUS_SOLO:40}},function(e,t,i){function n(){s.call(this,{className:"ContextualMenuPlayersList"}),this.once("open",this._setupDom),this.on("open",this._setContent)}var o=i(191).inherits,s=i(480),a=i(246),r=i(29).getText;o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this.entryList.createChild("div");this.playersList=e.createChild("div",{className:"playersList"}),this._addCancel()},n.prototype._setContent=function(e,t){function i(e){u.close(),e.openPlayerContextualMenu(h)}function n(e){u.close(),e.openNpcContextualMenu(h)}function o(e){u.close(),e.openMerchantContextualMenu(h)}function s(e){u.close(),window.gui.openContextualMenu("monster",e,h)}function l(e){u.close(),window.gui.openContextualMenu("prism",e,h)}function c(e){u.close(),e.mapId=window.isoEngine.mapRenderer.map.id,window.gui.openContextualMenu("taxCollector",e,h)}var u=this;this.playersList.clearContent();var d=e.actors,h=e.coordinates,p=e.npc,m=e.monster,f=e.merchant;if(p)switch(p.data.type){case"GameRolePlayPrismInformations":this.playersList.appendChild(new a({text:p.data.npcData.nameId+" ["+p.data.prism.alliance.allianceTag+"]",className:"cmButton"},l.bind(null,p.data)));break;case"GameRolePlayTaxCollectorInformations":this.playersList.appendChild(new a({text:r("ui.common.taxCollector"),className:"cmButton"},c.bind(null,p.data)));break;case"GameRolePlayNpcInformations":case"GameRolePlayNpcWithQuestInformations":this.playersList.appendChild(new a({text:r("tablet.npc.cell",p.data.npcData.nameId),className:"cmButton"},n.bind(null,p)));break;default:return}if(f&&this.playersList.appendChild(new a({text:r("tablet.merchant.cell",f.data.name),className:"cmButton"},o.bind(null,f))),m){var g=m.data||{},_=g.staticInfos||{},v=_.mainCreatureLightInfos||{};v.staticInfos?this.playersList.appendChild(new a({text:r("tablet.monster.cell",v.staticInfos.nameId),className:"cmButton"},s.bind(null,g))):console.error(new Error("Not a monster, type "+g.type))}for(var y=0;y<d.length;y+=1){var b=d[y];b.data&&b.data.playerId?this.playersList.appendChild(new a({text:b.data.name,className:"cmButton"},i.bind(null,b))):console.warn("ContextualMenuPlayersList: skipped actor:",b.actorId)}t()}},function(e,t){},function(e,t,i){function n(){c=new s;for(var e=0;e<r.length;e++)l.push(new a(r[e],c))}function o(){l.forEach(function(e){e.terminate()}),l=[],c=null}var s=i(644),a=i(645),r=[i(646),i(649),i(654)],l=[],c=null;t.initialize=function(){window.gui.on("connected",n),window.gui.on("disconnect",o)}},function(e,t){function i(){this._lastPopupTime=0}e.exports=i,i.prototype.rememberPopupTime=function(){this._lastPopupTime=Date.now()},i.prototype.getLastPopupTime=function(){return this._lastPopupTime}},function(e,t,i){function n(e,t){if("function"!=typeof e.prototype.checkAndShowSuggestion||!e.configName)throw new Error("Invalid class "+e.name);this._name=e.configName,
this._coordinator=t,this._sugTimeout=null,this._maxFrequency=u,this._averageDelay=d,this._delayDelta=h,this._suggestion=new e(this)}function o(e,t){var i=t-e;return e+Math.random()*i}var s=i(7),a=i(29).getText,r=i(203),l=i(195),c=6e4,u=60*c*24*30,d=3*c,h=.5*c,p=5*c,m="sugTriggerTime-",f="sugProposedTime-";e.exports=n,n.prototype.terminate=function(){r.clearTimeout(this._sugTimeout),this._suggestion.terminate()},n.prototype.setOptions=function(e){e.maxFrequencyMs&&(this._maxFrequency=e.maxFrequencyMs),e.averageDelayMs&&(this._averageDelay=e.averageDelayMs)},n.prototype.takeNoteOfTriggeringEvent=function(){l.setValue(m+this._name,Date.now())},n.prototype.takeNoteOfPlayerChoice=function(e){l.setValue(f+this._name,Date.now()),e&&s.log("Suggestion."+this._name,{answer:e},{wizAnalyticsOnly:!0})},n.prototype.getLastProposedTime=function(){return l.getValue(f+this._name)||0},n.prototype._canSuggestionBeProposed=function(){var e=l.getValue(m+this._name);if(!e)return!1;var t=l.getValue(f+this._name)||0;return!(t>e)&&!(Date.now()-t<this._maxFrequency)},n.prototype.scheduleCheck=function(){this._sugTimeout&&r.clearTimeout(this._sugTimeout);var e=Math.max(0,this._averageDelay-this._delayDelta),t=this._averageDelay+this._delayDelta,i=o(e,t);this._sugTimeout=r.setTimeout(this._doCheckOrReschedule.bind(this),i)},n.prototype._doCheckOrReschedule=function(){return this._sugTimeout=null,window.gui.playerData.isFighting||window.gui.tutorialManager.inTutorial?this.scheduleCheck():Date.now()-this._coordinator.getLastPopupTime()<p?this.scheduleCheck():void(this._canSuggestionBeProposed()&&this._suggestion.checkAndShowSuggestion())},n.prototype.showPopup=function(e,t){this._coordinator.rememberPopupTime();var i=this;window.gui.openConfirmPopup({title:a("tablet.suggestion"),buttonNoLabel:a("ui.connection.notNow"),message:e,cb:function(e){i.takeNoteOfPlayerChoice(e?"Y":"N"),e&&t()}})}},function(e,t,i){function n(e){this._controller=e,this._controller.setOptions({maxFrequencyMs:3*h,averageDelayMs:5*d}),this._eventListener=new a,this._initializeOnConnect()}function o(){r.changeValue("systemNotificationsEnabled",!0),u.open("options",{tab:"notification"})}var s=i(185),a=i(647),r=i(190),l=i(29).getText,c=i(648),u=i(225),d=6e4,h=60*d*24*30;e.exports=n,n.configName="AllNotif",n.prototype._initializeOnConnect=function(){r.systemNotificationsEnabled?this._controller.takeNoteOfPlayerChoice():(this._controller.takeNoteOfTriggeringEvent(),this._controller.scheduleCheck())},n.prototype.terminate=function(){this._eventListener.stopListening()},n.prototype.checkAndShowSuggestion=function(){c.isAvailable()&&(r.systemNotificationsEnabled||(s.isAndroid&&!this._controller.getLastProposedTime()?(this._controller.takeNoteOfPlayerChoice("F"),r.changeValue("systemNotificationsEnabled",!0)):this._controller.showPopup(l("tablet.proposeAllNotif"),o)))}},function(e,t){function i(){this._handlerMap={}}e.exports=i,i.prototype.listenTo=function(e,t,i){return this._handlerMap[t]?console.error("dupe listener: "+e.constructor.name+" on "+t):(this._handlerMap[t]=[e,i],void e.on(t,i))},i.prototype.stopListening=function(){for(var e in this._handlerMap){var t=this._handlerMap[e];t[0].removeListener(e,t[1])}this._handlerMap={}}},function(e,t,i){function n(e){var t=e.notification,i=t.message;window.gui.openSimplePopup(i,s("ui.common.notification"))}var o=window.plugins&&window.plugins.pushNotification,s=i(29).getText,a=!1;t.isAvailable=function(){return!!o},t.enable=function(e){if(!o||a)return e();var t=window.Config.notification;if(!t)return e("No notification config");a=!0,document.addEventListener("push-notification",n,!1);var i=t.push;o.onDeviceReady({appid:i.appId,projectid:i.projectId,serviceName:""}),o.setUserId(""+window.gui.playerData.accountCapabilities.accountId),o.registerDevice(function(t){console.info("Registered device for push notifications: ",t.pushToken),e()},function(t){e("Error registering push notifications: "+t)})},t.disable=function(e){return o&&a?(a=!1,document.removeEventListener("push-notification",n,!1),void o.unregisterDevice(function(){console.info("Unregistered push notifications"),e()},function(t){e("Error unregistering push notifications: "+t.error)})):e()},t.setCustomTags=function(e){o&&a&&o.setTags(e,function(){console.info("setTags success for: ",Object.keys(e))},function(t){console.error("setTags failed for "+Object.keys(e).join(",")+": "+t)})}},function(e,t,i){function n(e){this._controller=e,this._eventListener=new a,this._initializeOnConnect()}function o(){return!!c.isAvailable()&&(!!r.systemNotificationsEnabled&&(!r.wantPrismAttackedNotif&&!r.wantPrismVulnerableNotif))}function s(){r.changeValue("systemNotificationsEnabled",!0),r.changeValue("wantPrismAttackedNotif",!0),r.changeValue("wantPrismVulnerableNotif",!0),h.open("options",{tab:"notification"})}var a=i(647),r=i(190),l=i(29).getText,c=i(648),u=i(523),d=i(650),h=i(225);e.exports=n,n.configName="Prism",n.prototype._initializeOnConnect=function(){this._controller.scheduleCheck(),this._eventListener.listenTo(d,"receivedServerFlag",this._onReceivedServerFlag.bind(this)),this._eventListener.listenTo(u,"entityUpdated",this._onEntityUpdate.bind(this))},n.prototype.terminate=function(){this._eventListener.stopListening()},n.prototype._onReceivedServerFlag=function(e){"MISSED_PRISM_NOTIF"===e&&o()&&(this._controller.takeNoteOfTriggeringEvent(),this._controller.scheduleCheck())},n.prototype._onEntityUpdate=function(e){e===u.entityType.prism&&o()&&(this._controller.takeNoteOfTriggeringEvent(),this._controller.scheduleCheck())},n.prototype.checkAndShowSuggestion=function(){this._controller.showPopup(l("tablet.proposePrismNotif"),s)}},function(e,t,i){function n(){m(),o(v[I])}function o(e){e?s():r()}function s(){g=!0,w.enable(function(e){return e?a(e):(d(),void b.enable(function(e){if(e)return a(e)}))})}function a(e){console.error("Failed to enable systemNotifications: "+e),window.gui.openSimplePopup(y("tablet.notification.cannotEnable")),v.changeValue(I,!1,C),r();var t=M.getWindow("options");t.openState&&t.refreshUi()}function r(){g=!1,w.disable(function(e){e&&console.error("Trouble while disabling pushNotifications: "+e)}),b.disable(function(e){e&&console.error("Trouble while disabling localNotifications: "+e)})}function l(){var e=window.dofus.connectionManager;window.gui.on("connected",n),e.on("OfflineOptionsMessage",function(e){f(e.options)}),v.on(I,c),v.on("wantPromoNotif",u),v.on("wantPrismAttackedNotif",h),v.on("wantPrismVulnerableNotif",h)}function c(e,t,i){o(e),"OptionsWindow"===i&&M.getWindow("options").refreshUi(),h(e,t,i)}function u(e,t,i){g&&d(),h(e,t,i)}function d(){w.setCustomTags({"Wants Promo":v.wantPromoNotif})}function h(e,t,i){i!==C&&(T.clearTimeout(S),S=T.setTimeout(p,A))}function p(){v.changeValue("offlineOptionTimestamp",Date.now(),C),m()}function m(){var e=[];v[I]||e.push(L),v.wantPrismAttackedNotif&&e.push(N),v.wantPrismVulnerableNotif&&e.push(O);var t=x+","+v.offlineOptionTimestamp+","+e.join("+");window.dofus.sendMessage("OfflineOptionsUpdateRequestMessage",{options:t})}function f(e){var t=e.split(",");if(t[0]!==x||t.length<3)return console.error("Invalid offline options: "+e);var i=parseInt(t[1],10);v.changeValue("offlineOptionTimestamp",i,C);var n=t[2].split("+");v.changeValue(I,n.indexOf(L)===-1,C),v.changeValue("wantPrismAttackedNotif",n.indexOf(N)!==-1,C),v.changeValue("wantPrismVulnerableNotif",n.indexOf(O)!==-1,C),n.indexOf(D)!==-1&&(E.emit("receivedServerFlag","MISSED_PRISM_NOTIF"),p())}var g,_=i(194).EventEmitter,v=i(190),y=i(29).getText,b=i(651),w=i(648),M=i(225),T=i(203),C="systemNotifications",I="systemNotificationsEnabled",A=5e3,S=null,E=new _;e.exports=E,E.initialize=function(){l()},E.isAvailable=function(){return w.isAvailable()||b.isAvailable()},E.isEnabled=function(){return g};var x="1",L="NON",N="PAN",O="PVN",D="_PN"},function(e,t,i){function n(){if(!window.cordova)return!1;var e=window.cordova.plugins;return d=e&&e.notification&&e.notification.local,!!d}function o(){y=!0;var e=window.gui,t=e.playerData.inventory,i=new m(t,function(e){return e.isStarvingPet()});i.on("itemsCleared",function(){b=0}),i.on("itemAdded",function(e){u(e.quantity)}),i.on("itemRemoved",function(e){u(-e.quantity)}),i.on("itemQuantityChanged",function(e,t){u(e.quantity-t)}),h.on("wantPetFeedingNotif",function(e){e?c():l()}),h.on("petFeedingNotifTime",function(){c()}),d.on("trigger",s)}function s(e){window.gui.openSimplePopup(e.text,e.title)}function a(){var e=window.gui.playerData.identification.subscriptionEndDate;if(e){var t=new Date(e-_),i=Math.round(_/g*10)/10,n=i+" "+p("ui.time.days",i);d.schedule({id:f.subscriptionEnd,title:p("tablet.notification.bonusPackEndTitle"),text:p("tablet.notification.bonusPackEnd",n),at:t})}}function r(e){var t=h.petFeedingNotifTime.split(":"),i=new Date;i.setHours(t[0]),i.setMinutes(t[1]),i.setSeconds(0),i<Date.now()&&i.setTime(i.getTime()+g),w=e,d.schedule({id:f.petFeeding,title:p("tablet.notification.petFeedingTimeTitle"),text:p("tablet.notification.petFeedingTime",e),every:"day",at:i})}function l(){w&&(w=0,d.cancel(f.petFeeding))}function c(){l(),h.wantPetFeedingNotif&&h.petFeedingNotifTime&&0!==b&&r(b)}function u(e){b+=e,b!==w&&(b>1&&w>1||c())}var d,h=i(190),p=i(29).getText,m=i(652),f=i(653),g=864e5,_=1*g,v=!1,y=!1,b=0,w=0;t.isAvailable=function(){return!!d||n()},t.enable=function(e){return!n()||v?e():(v=!0,void d.hasPermission(function(t){if(t){y||o();var i=null;try{a(),c(),console.info("Registered for local notifications")}catch(n){i=n}return e(i)}return e("NO_PERMISSION")}))},t.disable=function(e){return n()&&v?(v=!1,d.cancelAll(),console.info("Unregistered local notifications"),void e()):e()}},function(e,t,i){function n(e,t){this.inventory=e,this.filterFunc=t,this._startListening()}var o=i(194).EventEmitter,s=i(191).inherits;s(n,o),e.exports=n,n.prototype._startListening=function(){this.inventory.on("listUpdate",this._onReset.bind(this)),this.inventory.on("itemsAdded",this._onMapOfItemAdded.bind(this)),this.inventory.on("itemAdded",this._onItemAdded.bind(this)),this.inventory.on("itemDeleted",this._onItemRemoved.bind(this)),this.inventory.on("itemsDeleted",this._onMapOfItemRemoved.bind(this)),this.inventory.on("itemQuantity",this._onQuantityChanged.bind(this)),this.inventory.on("itemsQuantity",this._onMapOfQuantityChanged.bind(this)),this.inventory.on("itemModified",this._onItemChanged.bind(this))},n.prototype._onReset=function(e){this.emit("itemsCleared"),this._onMapOfItemAdded(e)},n.prototype._onItemAdded=function(e){this.filterFunc&&!this.filterFunc(e)||this.emit("itemAdded",e)},n.prototype._onMapOfItemAdded=function(e){for(var t in e)this._onItemAdded(e[t])},n.prototype._onItemRemoved=function(e,t){this.filterFunc&&!this.filterFunc(t)||this.emit("itemRemoved",t)},n.prototype._onMapOfItemRemoved=function(e,t){for(var i in t)this._onItemRemoved(i,t[i])},n.prototype._onQuantityChanged=function(e,t,i){var n=this.inventory.objects[e];if(!this.filterFunc||this.filterFunc(n))return!t||!i||i<0?console.error("invalid quantity change from "+i+" to "+t):void this.emit("itemQuantityChanged",n,i)},n.prototype._onMapOfQuantityChanged=function(e,t){for(var i in e)this._onQuantityChanged(i,e[i],t[i])},n.prototype._onItemChanged=function(e){this.filterFunc&&!this.filterFunc(e)||this.emit("itemChanged",e)}},function(e,t){e.exports={subscriptionEnd:1,petFeeding:2}},function(e,t,i){function n(e){this._controller=e,this._eventListener=new s,this._initializeOnConnect()}function o(){a.changeValue("wantPromoNotif",!0),a.changeValue("systemNotificationsEnabled",!0),c.open("options",{tab:"notification"})}var s=i(647),a=i(190),r=i(29).getText,l=i(648),c=i(225);e.exports=n,n.configName="Promo",n.prototype._initializeOnConnect=function(){var e=window.dofus.connectionManager,t=this;this._controller.scheduleCheck(),this._eventListener.listenTo(e,"shopBuySuccess",function(){t._controller.takeNoteOfTriggeringEvent()}),this._eventListener.listenTo(c,"close",function(e){"market"===e.id&&t._controller.scheduleCheck()})},n.prototype.terminate=function(){this._eventListener.stopListening()},n.prototype.checkAndShowSuggestion=function(){l.isAvailable()&&(a.systemNotificationsEnabled&&a.wantPromoNotif||this._controller.showPopup(r("tablet.proposePromoNotif"),o))}},function(e,t){function i(){this._setDimensions(0,0,0,0),this.clear(),this.lastUpdateTime=0}function n(e,t,i,n,o,s){this.x=e,this.y=t,this.width=i,this.height=n,this.boxType=o,this.actorId=s,this.priority=h[o],this.angle=null}function o(e){var t=e.bbox;if(t[0]<=t[1])return t;var i=window.isoEngine.mapRenderer.getCellSceneCoordinate(e.cellId);return[i.x-20,i.x+20,i.y-90,i.y+10]}var s=5,a=5,r=0,l=1,c=2,u=3,d=4,h={};h[r]=1,h[l]=10,h[c]=20,h[u]=30;var p={};p[c]=50,p[u]=200,p[l]=400,e.exports=i,i.prototype.initialize=function(e,t,i,n){this._setDimensions(e,t,i,n),this.clear();var o=this;window.gui.on("resize",function(e){o._setDimensions(e.mapLeft,e.mapTop,e.mapWidth,e.mapHeight)}),window.isoEngine.on("mapLoaded",function(e){e&&e.isReload||o.clear()})},i.prototype.clear=function(){this.boxes=[]},i.prototype._setDimensions=function(e,t,i,n){this.originX=e,this.originY=t,this.width=i,this.height=n},n.prototype.intersectingSurface=function(e){if(e.x+e.width<=this.x||e.x>=this.x+this.width)return 0;if(e.y+e.height<=this.y||e.y>=this.y+this.height)return 0;var t=Math.min(this.x+this.width,e.x+e.width)-Math.max(this.x,e.x),i=Math.min(this.y+this.height,e.y+e.height)-Math.max(this.y,e.y);return t*i},n.prototype.setAsSubboxOf=function(e){this.priority=p[e.boxType];var t=this.x+this.width/2,i=this.y+this.height/2,n=e.x+e.width/2,o=e.y+e.height/2;this.angle=Math.atan2(o-i,n-t)},n.prototype.getCenter=function(){return[this.x+this.width/2,this.y+this.height/2]};var m=4,f=10;i.prototype._moveBoxAround=function(e,t,i){var n,o;switch(i){case 0:n=t.x+t.width-f,o=t.y-e.height;break;case 1:n=t.x-e.width+f,o=t.y-e.height;break;case 2:n=t.x-e.width+f,o=t.y+t.height;break;case 3:n=t.x+t.width-f,o=t.y+t.height;break;default:return console.error(new Error("invalid _moveBoxAround index"+i))}e.x=Math.round(n),e.y=Math.round(o)},i.prototype._computeWeight=function(e,t,i){if(e.x<this.originX+s||e.y<this.originY+s)return 1/0;if(e.x+e.width>this.originX+this.width-s||e.y+e.height>this.originY+this.height-s)return 1/0;for(var n=0,o=this.boxes.length-1;o>=0;o--){var a=this.boxes[o];if(a!==t){var r=e.intersectingSurface(a);if(r){if(!a.priority)return 1/0;if(n+=r/a.priority,n>=i)return n}}}return n},i.prototype._addBoxNextToTarget=function(e,t,i){for(var o=new n(0,0,t,i,d),s=1/0,r=0,l=0;l<m;l++){this._moveBoxAround(o,e,l);var c=this._computeWeight(o,e,s);if(c<s&&(s=c,r=l,0===c))break}return 0!==s&&this._moveBoxAround(o,e,r),o.x+=2*a*(Math.random()-.5),o.y+=2*a*(Math.random()-.5),o.setAsSubboxOf(e),this.boxes.push(o),o},i.prototype._newActorBox=function(e,t){var i=window.foreground,s=o(e),a=i.convertSceneToScreenCoordinate(s[0],s[2]),r=i.convertSceneToScreenCoordinate(s[1],s[3]),l=r.x-a.x,c=r.y-a.y,u=new n(a.x,a.y,l,c,t,e.actorId);return this.boxes.push(u),u},i.prototype.addBoxNextToActor=function(e,t){this._updateActors();var i=this._getActorBox(e);i||(i=this._newActorBox(e,u));var n=t.rootElement;return this._addBoxNextToTarget(i,n.clientWidth,n.clientHeight)},i.prototype.addObstacle=function(e,t,i,o){var s=new n(e,t,i,o,r);return this.boxes.push(s),s},i.prototype.removeBox=function(e){var t=this.boxes.indexOf(e);t<0||this.boxes.splice(t,1)},i.prototype._removeActors=function(){for(var e=[],t=this.boxes.length-1;t>=0;t--){var i=this.boxes[t];i.actorId||e.push(i)}this.boxes=e},i.prototype._updateActors=function(){this.lastUpdateTime=Date.now(),this._removeActors(),this._newActorBox(window.actorManager.userActor,l);var e=window.actorManager.actors;for(var t in e){var i=e[t],n=i.data;n&&!n.staticInfos&&this._newActorBox(i,i.isNPC()?c:u)}},i.prototype._getActorBox=function(e){for(var t=e.actorId,i=this.boxes.length-1;i>=0;i--){var n=this.boxes[i];if(n.actorId===t)return n}return null}},function(e,t,i){function n(){a.call(this,"div",{className:"ChallengeIndicator",hidden:!0}),r(this),this.firstTimeDisplayed=!0,this.challengeSlot=this.createChild("div",{className:"challengeSlot"}),this.iconDetailsListByChallengeId={},this.challengesResult={},this._hookupEvents(window.gui)}i(657);var o=i(183).dimensions,s=i(191).inherits,a=i(235),r=i(658),l=i(29).getText,c=i(248).addTooltip,u=i(202),d=i(660).highlightCells,h=i(271);s(n,a),e.exports=n,n.prototype._hookupEvents=function(e){var t=this;e.on("ChallengeInfoMessage",function(e){t.setChallenge(e)}),e.on("ChallengeResultMessage",function(e){return t.iconDetailsListByChallengeId[e.challengeId]?void t.setChallengeResult(e):void(t.challengesResult[e.challengeId]=e)}),h.on("ChallengeTargetsListMessage",function(e){d(e)}),e.on("GameFightEndMessage",function(){t.hide(),t.reset()}),e.on("GameFightJoinMessage",function(){}),e.on("disconnect",function(){t.hide(),t.reset()})},n.prototype.updateDescriptionWithFighter=function(e,t){var i=e.name+" ("+l("ui.common.level")+" "+e.level+")",n=t._description.replace("%1",i);return n},n.prototype.setChallenge=function(e){var t,i=this,n=window.gui.fightManager.getFighter(e.targetId);t=n?this.updateDescriptionWithFighter(n,e):e._description;var o="none",s=e.challengeId;u.preloadImage("gfx/challenges/"+s+".png",function(a){o=a;var r=i.setupIconGUI(e._name,t||e._description,e.dropBonus,e.xpBonus,s,e._points,o);i.iconDetailsListByChallengeId[s]={icon:r.icon,details:r.details,iconUrl:o,success:e.success,name:e._name,description:t,dropBonus:e.dropBonus,xpBonus:e.xpBonus,targetFighter:n,points:e._points};var l=i.challengesResult[s];l&&i.setChallengeResult(l)})},n.prototype.setupIconGUI=function(e,t,i,n,s,r,u){function d(){var e=[805,815],t=window.gui.playerData.position.subArea,i=t&&t.id,n=e.indexOf(i)!==-1;return r&&n}var h=this.challengeSlot.createChild("div",{className:"challengeIcon"});h.challengeState=h.createChild("div",{className:"challengeState"});var p=new a("div",{className:"challengeDetails",name:"challengeDetails"});return p.challengeName=p.createChild("div",{className:"challengeName",text:e}),p.challengeDesc=p.createChild("div",{className:"challengeDesc",text:t}),p.challengeLoot=p.createChild("div",{className:"challengeLoot",text:l("ui.common.loot")+" +"+i+"%"}),p.challengeXp=p.createChild("div",{className:"challengeXp",text:l("ui.common.xp")+" +"+n+"%"}),d()&&(p.challengePoints=p.createChild("div",{className:"challengePoints",text:r+" "+l("ui.common.point",r)})),p.challengeStatus=p.createChild("div",{className:"challengeStatus",text:l("ui.fight.challenge.inProgress")}),c(h,p),h.on("tap",function(){window.dofus.sendMessage("ChallengeTargetsListRequestMessage",{challengeId:s})}),h.setStyle("backgroundImage",u),this.show(),this.firstTimeDisplayed&&(this.firstTimeDisplayed=!1,this.setStyle("left",o.mapLeft+"px")),{icon:h,details:p}},n.prototype.setChallengeResult=function(e){var t=this.iconDetailsListByChallengeId[e.challengeId];e.success?(t.icon.challengeState.addClassNames("success"),t.details.challengeStatus.addClassNames("success"),t.details.challengeStatus.setText(l("ui.fight.challenge.complete"))):(t.icon.challengeState.addClassNames("fail"),t.details.challengeStatus.addClassNames("fail"),t.details.challengeStatus.setText(l("ui.fight.challenge.failed"))),t.success=e.success},n.prototype.reset=function(){for(var e in this.iconDetailsListByChallengeId)this.iconDetailsListByChallengeId[e].icon.destroy(),this.iconDetailsListByChallengeId[e].details.destroy(),delete this.iconDetailsListByChallengeId[e];this.challengesResult={}}},function(e,t){},function(e,t,i){function n(e,t){function i(){t.isFullScreen?(p=0,f=0,m=o.screenWidth,g=o.screenHeight):(p=o.mapLeft,f=o.mapTop,m=o.mapRight,g=o.mapBottom),h()}function n(){M>C?M=C:M<A&&(M=A),T>I?T=I:T<S&&(T=S),r()}function r(){E=M===A,x=T===S,L=M===C,N=T===I,e.toggleClassName("magnetLeft",E),e.toggleClassName("magnetTop",x),e.toggleClassName("magnetRight",L),e.toggleClassName("magnetBottom",N),e.toggleClassName("magnetFloating",!(E||x||L||N))}function l(){E&&(M=A),x&&(T=S),L&&(M=C),N&&(T=I)}function c(){e.setStyles({webkitTransform:"",left:M+"px",top:T+"px",right:"initial",bottom:"initial"}),r()}function u(){var t=e.rootElement.clientWidth,i=e.rootElement.clientHeight;return!(!t||!i)&&(M=e.rootElement.offsetLeft,T=e.rootElement.offsetTop,t<=o.mapWidth?(A=p,C=m-t):(A=0,C=o.screenWidth-t),C<A&&(C=A),i<=o.mapHeight?(S=f,I=g-i):(S=0,I=o.screenHeight-i),I<S&&(I=S),!0)}function d(){c(),e.delClassNames("dragging"),e.emit("dragEnd")}function h(){O=!1,u()&&(n(),l(),c())}t=t||{};var p,m,f,g,_=t.grip||e.createChild("div",{className:"gripHandler"});s(_);var v,y,b,w,M,T,C,I,A,S,E,x,L,N;_.on("slideStart",function(t){v=t.x,y=t.y,u(),b=M,w=T,e.addClassNames("dragging"),e.emit("dragStart")}),_.on("slide",function(t){M=b+t.x-v,T=w+t.y-y,n();var i=M-b,o=T-w;e.setStyle("webkitTransform","translate3d("+i+"px, "+o+"px, 0)")}),_.on("slideEnd",d),_.on("slideCancel",d);var O=!1;i(),window.gui.on("resize",i),e.on("destroy",function(){window.gui.removeListener("resize",i)}),t.isCollapsable&&(_.createChild("div",{className:"collapseBtn"}),a(_),_.on("tap",function(){e.collapse(!e.isCollapsed)}),e.isCollapsed=!1,e.collapse=function(t,i){e.isCollapsed=t,e.toggleClassName("collapsed",t),O=!0,i||e.emit("collapse",t),O&&h()}),e.on("resized",h)}i(659);var o=i(183).dimensions,s=i(232),a=i(228);e.exports=n},function(e,t){},function(e,t){t.highlightCells=function(e){for(var t in window.gui.challengeIndicator.iconDetailsListByChallengeId)switch(t){case"3":case"4":case"32":case"34":case"35":var i=e.targetCells[0];window.gui.pingSystem.addPingPicto(i,"attack")}}},function(e,t,i){function n(e){for(var t=0,i=0;i<e.length;i++)t+=e.charCodeAt(i)%16;return(t%16).toString(16).toUpperCase()}function o(){var e=Math.ceil(100*Math.random());return e<=40?String.fromCharCode(Math.floor(26*Math.random())+65):e<=80?String.fromCharCode(Math.floor(26*Math.random())+97):String.fromCharCode(Math.floor(10*Math.random())+48)}function s(){for(var e="",t=0;t<20;t++)e+=o();return e+n(e)}function a(){x=!0,window.gui.openSimplePopup(y("ui.common.cantSelectThisCharacter"),y("ui.popup.impossible_action")),_||window.dofus.sendMessage("CharactersListRequestMessage")}function r(e){return g=e,L=e.characters,0===L.length?(w.closeAll(),w.open("characterCreation")):E?(E=!1,window.gui.playerData.accountCapabilities.tutorialAvailable?void window.dofus.sendMessage("CharacterFirstSelectionMessage",{id:L[0].id,doTutorial:window.gui.tutorialManager.isTutorialRequired()}):t.selectCharacter(L[0].id)):x?w.open("characterSelection",L):"characterId"===b.connectMethod?b.characterId?t.selectCharacter(b.characterId):(console.error(new Error("characterId is missing!")),void w.open("characterSelection",L)):"lastCharacter"===b.connectMethod?t.selectCharacter(L[0].id):void w.open("characterSelection",L)}function l(){E=!1,x=!1,L=[]}function c(e){var t={rebreed:!1,recolor:!1,relook:!1,rename:!1,regender:!1};return(e&M.CHARACTER_REMODELING_BREED)>0&&(t.rebreed=!0),(e&M.CHARACTER_REMODELING_COLORS)>0&&(t.recolor=!0),(e&M.CHARACTER_REMODELING_COSMETIC)>0&&(t.relook=!0),(e&M.CHARACTER_REMODELING_NAME)>0&&(t.rename=!0),(e&M.CHARACTER_REMODELING_GENDER)>0&&(t.regender=!0),t}function u(e,t){return e?T.MANDATORY:t?T.POSSIBLE:T.IMPOSSIBLE}function d(e,t){for(var i={},n=!1,o=t.charactersToRemodel,s=0;s<o.length;s+=1)if(o[s].id===e){i.characterToRemodel=o[s];var a=c(o[s].mandatoryChangeMask),r=c(o[s].possibleChangeMask);i.canRebreed=u(a.rebreed,r.rebreed),i.canRecolor=u(a.recolor,r.recolor),i.canReface=u(a.relook,r.relook),i.canRename=u(a.rename,r.rename),i.canRegender=u(a.regender,r.regender),n=!0;break}return n?i:null}function h(e){if(_=null,"CharactersListWithRemodelingMessage"!==g._messageType)return!1;var t=d(e,g);return!!t&&(w.getWindow("characterSelection").hide(),w.open("characterCreation",{relookingParams:t}),_=t,!0)}function p(e){for(var t=[e],i=0;i<L.length;i+=1){var n=L[i];n.id!==e.id&&t.push(n)}L=t}function m(e){_.canRename&&(e.infos.name=v.name),_.canRebreed&&(e.infos.entityLook=v.remodelingInformation.entityLook),_.canRecolor&&(e.infos.entityLook.indexedColors=v.colors),_.canReface&&(e.infos.entityLook.skins[1]=v.headSkin)}function f(e){x=!1,w.close("characterSelection"),_&&v&&(w.close("characterCreation"),m(e)),window.gui.onConnect(e.infos),window.actorManager.setUserCharacterData(e.infos),p(e.infos),window.dofus.sendMessage("ClientKeyMessage",{key:N}),window.dofus.sendMessage("GameContextCreateRequestMessage");var t=window.gui.serversData,i="appleShibaPromotion1",n=t.connectedServerId===A.NEXT_SERVERID?new Date("2019-03-08T03:00:00"):new Date("2019-03-20T17:00:00"),o=t.connectedServerId===A.NEXT_SERVERID?new Date("2019-03-12T11:00:00"):new Date("2019-04-05T05:00:00"),s=I.getValue(i,0,!0),a=S.now();C.isIOS&&0===s&&a>=n&&a<o&&(I.setValue(i,a,1,!0),w.open("PromotionPopupWindow",{}))}var g,_,v,y=i(29).getText,b=i(282),w=i(225),M=i(662),T=i(663),C=i(185),I=i(195),A=i(184),S=i(28),E=!1,x=!1,L=[],N=s();t.confirmNewCharacterCreation=function(){E=!0},t.confirmCharacterRelooking=function(e){var t=_.characterToRemodel.id;v=e,window.dofus.sendMessage("CharacterSelectionWithRemodelMessage",{id:t,remodel:v.remodelingInformation})},t.selectCharacter=function(e){if(!h(e))return e<1?void console.error(new Error("characterSelection: characterId should be positive")):void window.dofus.sendMessage("CharacterSelectionMessage",{id:e})},t.backToSelection=function(){return w.closeAll(),0===L.length?w.open("serverSelection"):void w.open("characterSelection",L)},t.initialize=function(e){var t=window.dofus.connectionManager;t.on("CharacterSelectedForceMessage",function(){window.dofus.sendMessage("CharacterSelectedForceReadyMessage")}),t.on("CharactersListMessage",r),t.on("CharactersListWithRemodelingMessage",r),t.on("CharacterSelectedSuccessMessage",f),t.on("CharacterSelectedErrorMessage",a),e.on("disconnect",l)},t.getCharacterList=function(){return L}},function(e,t){e.exports={CHARACTER_REMODELING_NOT_APPLICABLE:0,CHARACTER_REMODELING_NAME:1,CHARACTER_REMODELING_COLORS:2,CHARACTER_REMODELING_COSMETIC:4,CHARACTER_REMODELING_BREED:8,CHARACTER_REMODELING_GENDER:16}},function(e,t){e.exports={IMPOSSIBLE:0,MANDATORY:1,POSSIBLE:2}},function(e,t,i){function n(){D.call(this,"div",{className:"chat"}),this.displayMode=K.ROLEPLAY,this.keyboardHeight=.6*f.screenHeight,this.linkHelper=new I,this.p2p=new A,this.censor=new k,this.presets=null,this.channelMap=window.gui.databases.ChatChannels,this.numPresetsListeningToChannel=null,this.historyBuffers={},this.historyBuffers[U]=new w(Z);for(var e in this.channelMap)this.historyBuffers[~~e]=new w(Z);this._initializeElements(),this._setMessageHandlers()}function o(e){var t=this.chat;t._toggleChannel(t.activePreset,~~this.id,e)}function s(){var e=this.chat,t=this.presetId;t===e.activePreset?e._togglePresetChannels(t):e._setActivePreset(t)}function a(e,t){t.sort(function(e,t){return e.start-t.start});for(var i=[],n=0,o=0;o<t.length;o+=1){var s=t[o],a=e.substring(n,s.start),r=e.substring(s.start,s.end);n=s.end;var l='<a href="'+r+'">'+r+"</a>";i.push(a,l)}var c=e.substring(n,e.length);return i.push(c),i.join("")}function r(e){e.urls&&e.urls.length>0&&(e.content=a(e.content,e.urls))}i(665);var l=i(246),c=i(666),u=i(412),d=i(667),h=i(675),p=i(676),m=i(185),f=i(183).dimensions,g=l.DofusButton,_=i(28).DofusDate,v=i(395),y=i(250).getElementPositionAround,b=i(29).getText,w=i(508),M=i(678),T=i(191).inherits,C=i(482),I=i(700),A=i(701),S=i(483),E=i(228),x=i(227),L=i(195),N=i(279),O=i(225),D=i(235),R=i(703),P=i(705),B=i(190),k=i(707),F=i(194).EventEmitter,z=450,H=240,q=u.CHANNEL_GLOBAL,W=u.PSEUDO_CHANNEL_PRIVATE,U=c.RED_CHANNEL,Y=1,G=0,j=1,V=2,X=3,Q={};Q[u.PSEUDO_CHANNEL_FIGHT_LOG]=!0;var K={ROLEPLAY:"roleplay",FIGHT:"fight"},J="chatIncomingPreset_",Z=50;T(F,D),T(n,F),e.exports=n,n.prototype._initializeAtConnection=function(){this.setDisplayMode(K.ROLEPLAY),this.chatInput.initializeAtConnection(),this._clearChatHistory()},n.prototype._initializeEnabledChannels=function(e,t){this.chatInput.initializeEnabledChannels(e,t),this._loadPresetConfig(),this._setActivePreset(G)},n.prototype._clearChatHistory=function(){this._logChat.clearContent();for(var e in this.historyBuffers)this.historyBuffers[~~e].clear();this.chatInput.clearSentMessageHistory()},n.prototype._initializeElements=function(){var e=this;this.logWrapper=this.createChild("div",{className:"logWrapper"}),this.fightControls=this.logWrapper.createChild("div",{className:"fightControls"}),this.timelineBox=this.fightControls.createChild("div",{className:"timelineBox"});var t=this.fightControls.createChild("div",{className:"fightButtons"}),i=new g("",{className:"yourTurnButton",hidden:!0},function(){e.deactivate()}),n=this.createChild("div",{className:"yourTurnText"});n.setText(b("tablet.chat.yourTurnButton")),i.appendChild(n),this.yourTurnButton=t.appendChild(i),this.logScroller=this.logWrapper.appendChild(new S({className:"log"},{showHintArrows:!0})),this._logChat=this.logScroller.content,this._logChat.addClassNames("showChannel666"),this.chatInput=new d(this.logWrapper,this.linkHelper),this.chatInput.on("sentChatMsg",function(){e.logScroller.goToBottom()}),this.logWrapper.appendChild(new N({className:["simpleButton","chatCloseButton"]},function(){e.deactivate()})),P(this.logWrapper,{minWidth:z,minHeight:H}),this.logWrapper.on("resize",function(){e.displayMode===K.FIGHT?L.setValue("ChatHeightForFight",e.logWrapper.windowHeight):L.setValue("ChatForRP",{width:e.logWrapper.windowWidth,height:e.logWrapper.windowHeight}),L.saveNow(),e._refreshScroller()}),this._toggleChatTimestampDisplay(L.getValue("option-chatTimestamp",!1))},n.prototype._updateChannelListenerCount=function(e,t){var i=this.numPresetsListeningToChannel[e],n=Math.max(i+t,0);this.numPresetsListeningToChannel[e]=n,Q[e]||(0===i&&n>0?window.dofus.sendMessage("ChannelEnablingMessage",{channel:e,enable:!0}):i>0&&0===n&&window.dofus.sendMessage("ChannelEnablingMessage",{channel:e,enable:!1}))},n.prototype._toggleChannel=function(e,t,i){this._setChannelInPreset(e,t,i),this._updateChannelListenerCount(t,i?1:-1)},n.prototype._addPreset=function(e){var t=this.presetButtons.createChild("div",{className:"presetButton"});t.createChild("div",{className:["presetIcon",e.className]}),t.chat=this,t.presetId=this.presets.length,E(t),t.on("tap",s);for(var i,n=[],a=0;a<e.channels.length;a++)i=e.channels[a],n.push(i);var r={element:t,channels:n,channelsList:this.channelsLists.createChild("div",{className:"channelsList"})};this.presets.push(r);for(var l in this.channelMap){i=~~l;var c=r.channelsList.appendChild(new p(this.channelMap[i].nameId));c.id=i,c.chat=this,c.addClassNames("channel"+c.id),c.on("change",o)}},n.prototype._createPresets=function(e){this.presets=[],this.activePreset=null,this.presetButtons=this.logWrapper.createChild("div",{className:"presetButtons"}),this.channelsLists=this.logWrapper.createChild("div",{className:"channelsLists"});for(var t=0;t<e.length;t++)this._addPreset(e[t])},n.prototype._setChannelInPreset=function(e,t,i){var n=this.presets[e].channels,o=!1,s=n.indexOf(t);s===-1||i?s===-1&&i&&(n.push(t),o=!0):(n.splice(s,1),o=!0),o&&(e===this.activePreset&&this._updateLogFilter(),L.setValue(J+e,n))},n.prototype._updatePresets=function(e){var t=this.numPresetsListeningToChannel={};for(var i in this.channelMap)t[~~i]=0;for(var n,o,s=e.length-1;s>=0;s--){var a=this.presets[s];o=a.channelsList.getChildren();var r=0;for(i in this.channelMap){n=~~i;var l=this.chatInput.isChannelEnabledForSending(n),c=a.channels.indexOf(n)>=0,u=o[r];r++,this.chatInput.isChannelAllowedForSending(n)?(Q[n]||(!l||c||0!==s||t[n]||(this._setChannelInPreset(s,n,!0),c=!0),!l&&c&&(this._setChannelInPreset(s,n,!1),c=!1)),c?(u.activate(!0),t[n]++):u.deactivate(!0)):u.hide()}}},n.prototype._loadPresetConfig=function(){var e=[];e.push({className:"preset1",channels:L.getValue(J+G,[u.CHANNEL_GLOBAL,u.CHANNEL_TEAM,u.CHANNEL_GUILD,u.CHANNEL_ALLIANCE,u.CHANNEL_PARTY,u.CHANNEL_NOOB,u.PSEUDO_CHANNEL_PRIVATE,u.PSEUDO_CHANNEL_INFO,u.PSEUDO_CHANNEL_FIGHT_LOG,u.CHANNEL_ADS,u.CHANNEL_ARENA])
}),e.push({className:"preset2",channels:L.getValue(J+j,[u.PSEUDO_CHANNEL_FIGHT_LOG])}),e.push({className:"preset3",channels:L.getValue(J+V,[u.PSEUDO_CHANNEL_PRIVATE])}),e.push({className:"preset4",channels:L.getValue(J+X,[u.CHANNEL_GUILD,u.CHANNEL_SALES,u.CHANNEL_SEEK])}),this.presets||this._createPresets(e),this._updatePresets(e)},n.prototype._showMsgAsBubble=function(e,t){if(e.channel===W)return!1;if("ChatAdminServerMessage"===e._messageType)return!1;if(window.gui.playerData.isFighting&&!B.showSpeechBubbleInFight)return!1;var i=window.actorManager.getActor(e.senderId);if(!i)return!1;window.gui.newSpeechBubble({actor:i,msg:e.content,objectItems:e.objects,channel:e.channel,decodeAllPages:t,senderId:e.senderId,senderName:e.senderName});var n=O.getOpenWindows();return!(n.length>=2)&&(1!==n.length||"worldMap"===n[0]&&!O.getWindow("worldMap").isMaximized())},n.prototype._createMessageContent=function(e,t,i,n){var o=new D("div",{className:"message"}),s="ChatAdminServerMessage"===e._messageType;o.addClassNames("channel"+e.channel);var a=e.content,l="{player,"+(t?e.receiverName:e.senderName)+","+(t?e.receiverId:e.senderId)+",channel:"+e.channel+"}",c=e.content.match(/\/([a-zA-Z]+),message:([^\\}]*)/),u=!0;if(c&&(a=c[2],"me"===c[1]?(u=!1,o.addClassNames("meText")):"think"===c[1]&&(o.addClassNames("thinkText"),l=b("ui.chat.console.think",l))),s?o.addClassNames("mod"):r(e),e.channel!==q&&e.channel!==W&&o.createChild("span",{text:"("+this.channelMap[e.channel].nameId+") "}),e.tag===h.CHAT_TAG_COMMUNITY_HELPER&&o.createChild("span",{text:"(Helper) ",className:"link"}),e.channel===W){var d=b(t?"ui.chat.to":"ui.chat.from");o.createChild("span",{text:d+" "})}if(!n){var p=new _(e.timestamp).getServerDate(),m=p.minute,f=m<10?"0"+m:m;o.createChild("span",{className:"chatTimestamp",text:"["+p.hour+":"+f+"] "})}var g=u?b("ui.common.colon")+" ":" ",v=M.process(l+g);return o.appendChild(v),o.appendChild(M.process(a,{objectItems:e.objects,channel:e.channel,decodeAllPages:i,senderId:e.senderId,senderName:e.senderName})),o},n.prototype._createMessageContentFromText=function(e,t,i,n){var o=new D("div",{className:"message"});return n===Y&&o.addClassNames("mod"),o.addClassNames("channel"+t),o.appendChild(M.process(e,{isNonChat:!0,channel:t,parentClassName:i})),o},n.prototype._addMsgToChat=function(e,t){var i=this._logChat.appendChild(e),n=this.historyBuffers[t].push(i);n&&this._logChat.removeChild(n),this._refreshScroller(!0)},n.prototype._logNewMessage=function(e,t){var i=window.gui.playerData.socialData.isIgnored(e.senderAccountId);if(!("ChatAdminServerMessage"!==e._messageType&&e.channel!==W&&i||this.p2p.processMsg(e,t))){var n=t||c.isChannelSelective(e.channel,e.senderId);e.content=this.censor.filterCensoredWords(e.content);var o=e.content.match(/\/([a-zA-Z]+),message:([^\\}]*)/),s=this._createMessageContent(e,t,n);if(this._addMsgToChat(s,e.channel),!o&&this.isChannelEnabledInPreset(e.channel)&&!this._showMsgAsBubble(e,n)){var a=this._createMessageContent(e,t,n,!0);window.gui.textNotification.add(a,{channel:e.channel})}}},n.prototype._logServerMsgWithObject=function(e,t){e.content=this.linkHelper.replaceLinksReceived(e.content,e.objects),this._logNewMessage(e,t)},n.prototype._logServerText=function(e,t){t=t||{};var i=void 0!==t.channel?t.channel:u.PSEUDO_CHANNEL_INFO,n=t.parentClassName,o=this._createMessageContentFromText(e,i,n,t.important),s=this._createMessageContentFromText(e,i,n,t.important);this._addMsgToChat(o,i),window.gui.textNotification.add(s,{channel:i})},n.prototype.logMsg=function(e,t,i,n){if(void 0===t&&(t=u.PSEUDO_CHANNEL_INFO),!this.isChannelEnabledInPreset(t)){var o=this._createMessageContentFromText(e,t,i);return this._addMsgToChat(o,t)}this._logServerText(e,{channel:t,parentClassName:i,important:n})},n.prototype.logError=function(e,t){this._logServerText(e,{channel:U,important:t})},n.prototype.insertLink=function(e,t){this.chatInput.insertLink(e,t)},n.prototype._refreshScroller=function(e){var t=!this.logScroller.canScrollDown();return this.logScroller.refresh(),e&&!t?this.logScroller.notify():void this.logScroller.goToBottom()},n.prototype._togglePresetChannels=function(e){if(this.channelsLists.toggleDisplay(),!this.channelsLists.isVisible())return this._refreshScroller();var t=this.presets[e],i=y(t.channelsList,t.element);t.channelsList.setStyles({left:i.x+"px",top:i.y+"px"})},n.prototype._setActivePreset=function(e){this.activePreset=e,this.channelsLists.hide();for(var t=0;t<this.presets.length;t++){var i=this.presets[t];i.element.toggleClassName("on",t===e),i.channelsList.toggleDisplay(t===e)}this._updateLogFilter(),this._refreshScroller()},n.prototype.isChannelEnabledInPreset=function(e){if(!this.presets)return!0;var t=this.presets[this.activePreset].channels;return t.indexOf(e)!==-1},n.prototype._updateLogFilter=function(){for(var e=this.presets[this.activePreset].channels,t=Object.keys(u).length,i=0;i<=t;i++)this._logChat.toggleClassName("showChannel"+i,e.indexOf(i)!==-1)},n.prototype._toggleChatTimestampDisplay=function(e){e?this.delClassNames("hiddenChatTimestamp"):this.addClassNames("hiddenChatTimestamp")},n.prototype._setMessageHandlers=function(){function e(e){var t=n.playerData.characters.canControlCharacterId(e.id);i.yourTurnButton.toggleDisplay(t)}function t(){i.yourTurnButton.hide()}var i=this,n=window.gui,o=window.dofus.connectionManager;n.on("connected",function(){i._initializeAtConnection()}),n.on("gameOptionChanged",function(e){"chatTimestamp"===e.gameOptionId&&i._toggleChatTimestampDisplay(e.value)}),o.on("EnabledChannelsMessage",function(e){i._initializeEnabledChannels(e.channels,e.disallowed)}),o.on("ChatServerWithObjectMessage",function(e){i._logServerMsgWithObject(e,!1)}),o.on("ChatServerCopyWithObjectMessage",function(e){i._logServerMsgWithObject(e,!0)}),o.on("ChatServerMessage",function(e){i._logNewMessage(e,!1)}),o.on("ChatTaggedServerMessage",function(e){i._logNewMessage(e,!1)}),o.on("EntityTalkMessage",function(e){var t=window.actorManager.getActorFromNpcId(e.entityId);window.gui.newSpeechBubble({actor:t,msg:e.text,isNonChat:!0})}),o.on("ChatAdminServerMessage",function(e){i._logNewMessage(e,!1)}),o.on("ChatServerCopyMessage",function(e){i._logNewMessage(e,!0)}),o.on("BasicWhoIsMessage",function(e){e.verbose&&i._logServerText(R(e))}),o.on("BasicWhoIsNoMatchMessage",function(e){i._logServerText(b("ui.common.playerNotFound",e.search))}),o.on("HelpersOnlineMessage",function(e){if(e.playerIds&&e.playerIds.length>0){i._logServerText(b("tablet.chat.helpers.connected",e.playerIds.length));for(var t=0,n=e.playerIds.length;t<n;t++)i._logServerText("{player,"+e.playerNames[t]+","+e.playerIds[t]+"}")}else i._logServerText(b("tablet.chat.helpers.none"))}),o.on("CharacterExperienceGainMessage",function(e){e.experienceCharacter&&i.logMsg(b("ui.stats.xpgain.mine",e.experienceCharacter)),e.experienceGuild&&i.logMsg(b("ui.stats.xpgain.guild",e.experienceGuild)),e.experienceIncarnation&&i.logMsg(b("ui.stats.xpgain.incarnation",e.experienceIncarnation)),e.experienceMount&&i.logMsg(b("ui.stats.xpgain.mount",e.experienceMount))}),n.fightManager.on("fightEnterPreparation",function(){i.deactivate()}),n.fightManager.on("fightStart",function(){i.yourTurnButton.hide(),i.setDisplayMode(K.FIGHT)}),n.fightManager.on(v.FIGHT_END,function(){t(),i.setDisplayMode(K.ROLEPLAY)}),n.on("GameFightTurnStartMessage",e),n.on("GameFightTurnResumeMessage",e),n.on("GameFightTurnStartSlaveMessage",e),n.on("GameFightTurnEndMessage",t),n.on("resize",function(){i._resize()}),n.on("disconnect",function(){i.deactivate()}),C.on("show",function(e){e&&!isNaN(e)||(console.error("Chat: the keyboardHeight is wrong:",e),e=.6*f.screenHeight),i.keyboardHeight=e,i.setDimensions()})},n.prototype.setDisplayMode=function(e){if(this.displayMode!==e){if(!this.active)return void(this.displayMode=e);this.removeDisplayMode(),this.displayMode=e,this.addDisplayMode(),this.setDimensions()}},n.prototype.removeDisplayMode=function(){switch(this.displayMode){case K.FIGHT:window.gui.timeline.restoreFighterList(),this.delClassNames("fightMode")}},n.prototype.addDisplayMode=function(){this.displayMode===K.FIGHT&&(this.addClassNames("fightMode"),window.gui.timeline.appendFighterListTo(this.timelineBox))},n.prototype.setDimensions=function(){switch(this.displayMode){case K.FIGHT:this.logWrapper.windowWidth=f.screenWidth;var e=f.physicalScreenHeight-this.keyboardHeight,t=e*f.physicalToViewportRatio;this.logWrapper.windowHeight=L.getValue("ChatHeightForFight",t),this.logWrapper.setWidthLock(!0);break;default:var i=Math.max(z,Math.round(.45*f.mapWidth)),n=Math.max(H,Math.round(.45*f.mapHeight)),o=L.getValue("ChatForRP",{width:i,height:n});this.logWrapper.windowWidth=o.width,this.logWrapper.windowHeight=o.height,this.logWrapper.setWidthLock(!1)}this.logWrapper.setStyles({width:this.logWrapper.windowWidth+"px",height:this.logWrapper.windowHeight+"px"}),this._refreshScroller()},n.prototype.startPrivateMessage=function(e,t){this.chatInput.startPrivateMessage(e,t),this.activate()},n.prototype.activate=function(){var e=this;C.disableScroll(!0),this.addClassNames("open"),this.active=!0,m.isPhoneGap||this.setDimensions(),this.addDisplayMode(),this._refreshScroller(),window.gui.textNotification&&window.gui.textNotification.hide(),x.tween(this,{webkitTransform:"translate3d(0, 0, 0)"},{time:200,delay:0,easing:"ease-out"},function(){e.chatInput.focus()}),C.setAutomaticHide(!1)},n.prototype.deactivate=function(){if(this.active){this.active=!1,this.chatInput.blur(),C.disableScroll(!1);var e=this;x.tween(this,{webkitTransform:"translate3d(0, -"+this.logWrapper.windowHeight+"px, 0)"},{time:200,delay:0,easing:"ease-out"},function(){e.removeDisplayMode(),e.delClassNames("open")}),window.gui.textNotification&&window.gui.textNotification.show(),this.channelsLists&&this.channelsLists.hide(),this.emit("closed"),C.setAutomaticHide(!0)}},n.prototype._resize=function(){var e=!this.logWrapper.windowHeight;this.setDimensions(),e&&this.deactivate()}},function(e,t){},function(e,t,i){var n=i(412),o=666;t.RED_CHANNEL=o,t.isChannelSelective=function(e,t){switch(e){case n.CHANNEL_ALLIANCE:case n.CHANNEL_GUILD:case n.CHANNEL_PARTY:return!0;case n.PSEUDO_CHANNEL_PRIVATE:var i,o=window.gui.playerData.socialData;return i="string"==typeof t?o.searchOnlineFriendByName(t):o.searchOnlineFriendById(t),!!i&&o.isMutualFriend(i);default:return!1}},t.isChannelSafe=function(e){switch(e){case o:case n.CHANNEL_ADMIN:case n.CHANNEL_ADS:case n.PSEUDO_CHANNEL_INFO:case n.PSEUDO_CHANNEL_FIGHT_LOG:return!0;default:return!1}},t.isHumanChannel=function(e){switch(e){case o:case n.PSEUDO_CHANNEL_INFO:case n.PSEUDO_CHANNEL_FIGHT_LOG:return!1;default:return!0}}},function(e,t,i){function n(e,t){u.call(this),this.linkHelper=t,this.channelMap=window.gui.databases.ChatChannels,this.outgoingChannel=C,this.outgoingChannelMenu=null,this.sendingEnabledChannels=null,this.sendingDisallowedChannels=null,this.previousInput="",this.previousPrivateReceiver="",this.sentMessageHistory=new v,this._createElements(e),this._setMessageHandlers()}function o(e,t){var i=e.getValue(),n=i.substr(0,t.length);n===t&&e.setValue(i.substr(t.length))}function s(e,t){var i=e.getValue();i.substr(0,t.length)!==t&&e.setValue(t+i)}var a=i(246),r=i(412),l=i(668),c=i(669),u=i(194).EventEmitter,d=i(29).getText,h=i(230),p=i(191).inherits,m=i(582),f=i(666),g=i(670),_=i(277),v=i(672),y=i(673),b=i(674),w=i(248),M=i(482),T=[r.CHANNEL_GLOBAL,r.CHANNEL_TEAM,r.CHANNEL_GUILD,r.CHANNEL_ALLIANCE,r.CHANNEL_PARTY,r.CHANNEL_NOOB,r.CHANNEL_ADMIN,r.PSEUDO_CHANNEL_PRIVATE,r.CHANNEL_ARENA,r.CHANNEL_SALES,r.CHANNEL_SEEK],C=r.CHANNEL_GLOBAL,I=r.PSEUDO_CHANNEL_PRIVATE,A=/^\/([A-Za-z]+)/,S={s:C,w:I,t:r.CHANNEL_TEAM,g:r.CHANNEL_GUILD,a:r.CHANNEL_ALLIANCE,p:r.CHANNEL_PARTY,i:r.CHANNEL_NOOB,q:r.CHANNEL_ADMIN,k:r.CHANNEL_ARENA,b:r.CHANNEL_SALES,r:r.CHANNEL_SEEK};p(n,u),e.exports=n,n.prototype.initializeAtConnection=function(){this.statusIndicator.initialize(),this.previousInput="",this.previousPrivateReceiver="",this._selectOutgoingChannel(C,!0),this.sendingEnabledChannels=T.concat(),this.sendingDisallowedChannels=[]},n.prototype.initializeEnabledChannels=function(e,t){this.sendingEnabledChannels=e,this.sendingDisallowedChannels=t,this._initOutgoingChannelMenu()},n.prototype.clearSentMessageHistory=function(){this.sentMessageHistory.reset()},n.prototype._createElements=function(e){function t(){var e=n.sentMessageHistory.getCurrentEntry();n._setInput(e.message),n.linkHelper.linksToReplace=e.links}var i=e.createChild("div",{className:"formChat"});this.statusIndicator=new b(i),this._createChannelSelector(i),this.inputChat=i.appendChild(new m({className:"inputChat",attr:{maxlength:_.USER_MAX_CHAT_LEN}}));var n=this;this.inputChat.on("validate",function(){return""===n.inputChat.getValue()?M.hide():void n._submit()});var o=i.appendChild(new a({className:"historyUp",scaleOnPress:!0,hidden:!0},function(){n.sentMessageHistory.goBack(),t()})),s=i.appendChild(new a({className:"historyDown",scaleOnPress:!0,hidden:!0},function(){n.sentMessageHistory.goForward(),t()}));i.appendChild(new a({className:"historyButton",scaleOnPress:!0},function(){o.toggleDisplay(),s.toggleDisplay()})),i.appendChild(new a({className:["sendButton","greenButton"],addIcon:!0},function(){n._submit()}))},n.prototype._createChannelSelector=function(e){function t(){i._selectOutgoingChannel(this.id),i.inputChat.focus()}for(var i=this,n=this.outgoingChannelMenu=[],o=0;o<T.length;o++){var s=this.channelMap[T[o]];n.push({id:s.id,caption:s.nameId+" ("+s.shortcut+")",cb:t,ticked:s.id===this.outgoingChannel})}this.outgoingChannelButtonBg=e.createChild("div",{className:"buttonBackground"}),this.outgoingChannelButton=e.createChild("div",{className:"outgoingChannelButton"});var a=this.buttonTouchZone=e.createChild("div",{className:"buttonTouchZone"});w.addTooltip(a,d("ui.option.chat")),a.on("tap",function(){var e=this.rootElement.getBoundingClientRect();window.gui.openContextualMenu("generic",{title:d("ui.option.currentChannel"),actions:i.outgoingChannelMenu},{x:e.left+e.width,y:e.top})})},n.prototype._showNotification=function(e){w.showNotification(e,this.inputChat)},n.prototype.showNotification=n.prototype._showNotification,n.prototype._initOutgoingChannelMenu=function(){for(var e=this.outgoingChannelMenu,t=0;t<e.length;t++){var i=e[t];i.hidden=this.sendingEnabledChannels.indexOf(i.id)<0,i.ticked=i.id===this.outgoingChannel}},n.prototype._getOutgoingChannelMenuOption=function(e){for(var t=this.outgoingChannelMenu,i=0;i<t.length;i++)if(t[i].id===e)return t[i]},n.prototype._setChannelEnabled=function(e,t){var i=this._getOutgoingChannelMenuOption(e);i&&(i.hidden=!t);var n=this.channelMap[e].nameId,o=this.sendingEnabledChannels,s=o.indexOf(e);if(s!==-1){if(this._showNotification(d("tablet.chat.disablingChannel",n)),t)return console.warn("Chat channel already enabled");o.splice(s,1)}else{if(this._showNotification(d("tablet.chat.enablingChannel",n)),!t)return console.warn("Chat channel already disabled");o.push(e)}},n.prototype.isChannelEnabledForSending=function(e){return this.sendingEnabledChannels.indexOf(e)!==-1},n.prototype.isChannelAllowedForSending=function(e){return this.sendingDisallowedChannels.indexOf(e)===-1},n.prototype._selectOutgoingChannel=function(e,t){var i=this.outgoingChannel;(e!==i||t)&&(t&&e!==I&&this.inputChat.setValue(""),i===I&&o(this.inputChat,this.previousPrivateReceiver+" "),e===I&&this.previousPrivateReceiver&&s(this.inputChat,this.previousPrivateReceiver+" "),this.inputChat.setClassNames(["inputChat","inputBox","channel"+e]),this.outgoingChannelButtonBg.setClassNames(["buttonBackground","outgoingChannel"+e]),e===I&&(this.previousPrivateReceiver?this._showNotification(d("tablet.chat.enteringPrivateChannel",this.previousPrivateReceiver)):this._showNotification(d("tablet.chat.privateReceiverHelp"))),this._getOutgoingChannelMenuOption(i).ticked=!1,this._getOutgoingChannelMenuOption(e).ticked=!0,this.outgoingChannel=e)},n.prototype._setMessageHandlers=function(){var e=this,t=window.dofus.connectionManager;t.on("ChannelEnablingChangeMessage",function(t){e._setChannelEnabled(t.channel,t.enable)}),t.on("ChatErrorMessage",function(t){e._showNotification(t.reason),e._setInput(e.previousInput,!0),e.sentMessageHistory.removeMessage()})},n.prototype.insertLink=function(e,t){var i=this.linkHelper.newLinkForSending(e,t);this.inputChat.setValue(this.inputChat.getValue()+" "+i+" ")},n.prototype.focus=function(){this.inputChat.focus()},n.prototype.blur=function(){this.inputChat.blur()},n.prototype._submit=function(){h.recordActivity();var e=this.inputChat.getValue().trim(),t=this.outgoingChannel,i=null,n=A.exec(e);if(n){n=n[1].toLowerCase();var o=e.split(" ").slice(1),s=y(n,o);if(s)return void this._setInput("");if(t=S[n],void 0===t&&"me"!==n&&"think"!==n)return this._showNotification(d("ui.console.notfound",e.substr(1).split(" ")[0]));e=e.substr(n.length+2)}if(t===I){var a=e.indexOf(" ");if(i=e.substr(0,a),e=e.substr(a),!i||!e||i.length<_.MIN_NICK_LEN||i.length>_.MAX_NICK_LEN)return this._showNotification(d("tablet.chat.privateReceiverHelp"));this.previousPrivateReceiver=i}if(e=e.trim()){this.previousInput=e;var r={allPagesAllowed:f.isChannelSelective(t,i)},u=l.getUnsendableCharacters(e,r);if(u.length){var p=u[0]+" ("+u[0].codePointAt().toString(16)+")";return this._showNotification(d("tablet.chat.unsendableChars",p))}e=l.encode(e,r),e=g(e);var m=[];e=this.linkHelper.prepareForSending(e,m),"me"!==n&&"think"!==n||(e="/"+n+",message:"+e);var v=c.sendMessage(e,t,i,m);if(v)return this._showNotification(v);this.sentMessageHistory.addMessage(this.previousInput,this.linkHelper.previousLinks),this._setInput(""),this.emit("sentChatMsg")}},n.prototype._setInput=function(e,t){this.outgoingChannel===I&&this.previousPrivateReceiver?(this.inputChat.setValue(this.previousPrivateReceiver+" "+e),t&&this.inputChat.setCaretPosition(this.previousPrivateReceiver.length)):this.inputChat.setValue(e),t&&this.linkHelper.undoPrepareForSending()},n.prototype.startPrivateMessage=function(e,t){t&&(e="*"+e),this.outgoingChannel===I&&e!==this.previousPrivateReceiver&&o(this.inputChat,this.previousPrivateReceiver+" "),this.previousPrivateReceiver=e,this._selectOutgoingChannel(I,!0)}},function(e,t){function i(e,t,i){for(var n=t;n<=i;n++)e[n]=!0}function n(e,t){var i=e.indexOf(l,t+1);return i<0?e.substring(t):e.substring(t,i+1)}function o(e){if(h&&e>255)return!0;var t=f[e>>16];if(void 0===t)return!1;var i=t[e>>8&255];if(i===!0)return!0;if(void 0===i)return!1;for(var n=0;n<i.length;n++){var o=i[n];if(e<o[0])break;if(e<=o[1])return!0}return!1}function s(e){return e>u||!o(e)}function a(e){return c.indexOf(e)!==-1}function r(e){var t=e.length;if(t<3||e[0]!==l||e[t-1]!==l)return e;var i=parseInt(e.substr(1,d),16);if(i.toString(16)!==e.substr(1,t-2))return e;var n=String.fromCodePoint(i);return(i<=255?a(n):o(i))?n:e}var l="~",c=l+"{}$",u=65535,d=6,h=!1,p=[],m=[],f=[p,m],g=65532;p[0]=[[10,10],[32,126],[160,255]],p[1]=!0,p[2]=[[512,591]],p[255]=[[g,g]],p[4]=!0,p[5]=[[1280,1327]],p[32]=[[8217,8217],[8221,8221]];var _=240,v=246,y=249,b=249;i(m,_,v),i(m,y,b),t.getUnsendableCharacters=function(e,t){h=t&&t.allPagesAllowed;for(var i=[],n=0;n<e.length;n++){var s=e.codePointAt(n);s>65535&&n++,o(s)||i.push(String.fromCodePoint(s))}return i},t.encode=function(e,t){h=t&&t.allPagesAllowed;for(var i="",n=0;n<e.length;n++){var o=e[n];if(o.charCodeAt()>255){var r=e.substr(n,2),c=r.codePointAt();c>65535&&n++,i+=s(c)?l+c.toString(16)+l:o}else i+=a(o)?l+o.charCodeAt().toString(16)+l:o}return i},t.decode=function(e,t){h=t&&t.allPagesAllowed;for(var i="",s=0;s<e.length;s++){var a=e[s];if(a!==l){var c=a.charCodeAt();i+=o(c)?a:""}else{var u=n(e,s);s+=u.length-1,i+=r(u)}}return i}},function(e,t,i){var n=i(29).getText,o=i(277);t.sendMessage=function(e,t,i,s){var a=e.length-o.USER_MAX_CHAT_LEN;if(a>0)return n("tablet.chat.messageTooLong",a);var r,l={content:e};return s&&s.length>0?(r=i?"ChatClientPrivateWithObjectMessage":"ChatClientMultiWithObjectMessage",l.objects=s):r=i?"ChatClientPrivateMessage":"ChatClientMultiMessage",i?l.receiver=i:l.channel=t,window.dofus.sendMessage(r,l),""}},function(e,t,i){function n(e){return new RegExp(a("ui.chat.variable."+e).replace(/,/g,"|").replace(/ /g,""),"g")}function o(){c={},c.experience=n("experience"),c.level=n("level"),c.life=n("life"),c.maxlife=n("maxlife"),c.lifepercent=n("lifepercent"),c.myself=n("myself"),c.stats=n("stats"),c.area=n("area"),c.subarea=n("subarea"),c.position=n("position"),c.guild=n("guild"),c.achievement=n("achievement")}function s(e){var t=window.gui.playerData.characters.mainCharacter.characteristics,i=t[e];if(!i)return"?";var n=i.getBonusPts()+i.getEquipmentPts(),o=n>0?"+":"";return i.getBasePts()+" ("+o+n+")"}var a=i(29).getText,r=i(252),l=i(671),c=null,u=669;e.exports=function(e){c||o();var t=window.gui.playerData,i=t.characters.mainCharacter,n=i.characteristics;if(!n)return e;var d=0,h=0;if(t.isIncarnation()){var p=window.gui.playerData.inventory.equippedItems[l.ACCESSORY_POSITION_WEAPON].effectsMap[u],m=r.getIncarnationExpDetails(p.diceSide,p.diceNum,p.diceConst);d=m.currentExp-m.expPreviousLevel,h=m.requiredExpToNextLevel-m.expPreviousLevel}else d=n.experience-n.experienceLevelFloor,h=n.experienceNextLevelFloor-n.experienceLevelFloor;var f=Math.floor(d/(h/100))+"%";e=e.replace(c.experience,f);var g=t.characterBaseInformations.level||0;e=e.replace(c.level,g);var _=n.lifePoints||0;e=e.replace(c.life,_);var v=n.maxLifePoints||0;e=e.replace(c.maxlife,v);var y=Math.min(100,Math.max(0,Math.round(_/v*100)))+"%";e=e.replace(c.lifepercent,y);var b=t.characterBaseInformations.name||"";e=e.replace(c.myself,b);var w=a("ui.chat.variable.statsresult",s("vitality"),s("wisdom"),s("strength"),s("intelligence"),s("chance"),s("agility"),s("initiative"),s("actionPoints"),s("movementPoints"));if(e=e.replace(c.stats,w),t.position.area){var M=t.position.area.nameId;e=e.replace(c.area,M)}if(t.position.subArea){var T=t.position.subArea.nameId;e=e.replace(c.subarea,T)}if(t.position.mapPosition){var C="{mapWithFlag,"+t.position.coordinates.posX+","+t.position.coordinates.posY+","+window.gui.playerData.position.worldmapId+"}";e=e.replace(c.position,C)}var I=t.guild.current&&t.guild.current.guildName,A=I||a("ui.chat.variable.guilderror");e=e.replace(c.guild,A);var S=a("ui.chat.variable.achievementResult",t.achievements.points,t.achievements.getAchievementPercent());return e=e.replace(c.achievement,S)}},function(e,t){e.exports={ACCESSORY_POSITION_HAT:6,ACCESSORY_POSITION_CAPE:7,ACCESSORY_POSITION_BELT:3,ACCESSORY_POSITION_BOOTS:5,ACCESSORY_POSITION_AMULET:0,ACCESSORY_POSITION_SHIELD:15,ACCESSORY_POSITION_WEAPON:1,ACCESSORY_POSITION_PETS:8,INVENTORY_POSITION_RING_LEFT:2,INVENTORY_POSITION_RING_RIGHT:4,INVENTORY_POSITION_DOFUS_1:9,INVENTORY_POSITION_DOFUS_2:10,INVENTORY_POSITION_DOFUS_3:11,INVENTORY_POSITION_DOFUS_4:12,INVENTORY_POSITION_DOFUS_5:13,INVENTORY_POSITION_DOFUS_6:14,INVENTORY_POSITION_MOUNT:16,INVENTORY_POSITION_MUTATION:20,INVENTORY_POSITION_BOOST_FOOD:21,INVENTORY_POSITION_FIRST_BONUS:22,INVENTORY_POSITION_SECOND_BONUS:23,INVENTORY_POSITION_FIRST_MALUS:24,INVENTORY_POSITION_SECOND_MALUS:25,INVENTORY_POSITION_ROLEPLAY_BUFFER:26,INVENTORY_POSITION_FOLLOWER:27,INVENTORY_POSITION_NOT_EQUIPED:63}},function(e,t){function i(){this.reset()}var n=50,o={message:"",links:[]};i.prototype.reset=function(){this._buffer=[],this._currentIndex=0},i.prototype.addMessage=function(e,t){this._buffer.unshift({message:e,links:t}),this._buffer.length>n&&this._buffer.pop(),this._currentIndex=0},i.prototype.removeMessage=function(){this._buffer.shift()},i.prototype.goBack=function(){this._currentIndex++},i.prototype.goForward=function(){this._currentIndex=Math.max(this._currentIndex-1,0)},i.prototype._getIndexInRange=function(){return this._currentIndex%(this._buffer.length+1)},i.prototype.getCurrentEntry=function(){var e=this._getIndexInRange();return 0===e?o:this._buffer[e-1]},e.exports=i},function(e,t,i){var n=i(277),o=i(29).getText,s=i(28),a=s.DofusDate;e.exports=function(e,t){function i(){t=t||[];var e=t.join("").trim();return!(0===e.length||e.length>n.MAX_PLAYER_OR_ACCOUNT_NAME_LEN)&&(window.dofus.sendMessage("BasicWhoIsRequestMessage",{search:e,verbose:!0}),!0)}if(e=e.toLowerCase(),"whois"===e)i();else{if("whoami"===e)return window.dofus.sendMessage("BasicWhoAmIRequestMessage",{verbose:!0}),!0;if("mapid"===e){var r=window.isoEngine.mapRenderer.mapId,l=o("ui.chat.console.currentMap",null,r);return window.gui.chat.logMsg(l),!0}}if("time"===e||"whois"===e){var c=new a(s.now()/1e3).getServerDate().toString(!1),u=c.date+" - "+c.time;return window.gui.chat.logMsg(u),!0}return"helper"===e&&("on"===t[0]||"off"===t[0]?window.dofus.sendMessage("HelpersVisibilityRequestMessage",{visibility:"on"===t[0]}):window.dofus.sendMessage("HelpersOnlineRequestMessage"),!0)}},function(e,t,i){function n(e){this.currentStatus=l.PLAYER_STATUS_AVAILABLE,this._createContent(e),this._setListeners()}function o(e){switch(e){case l.PLAYER_STATUS_AVAILABLE:return"available";case l.PLAYER_STATUS_IDLE:return"away";case l.PLAYER_STATUS_AFK:return"away";case l.PLAYER_STATUS_PRIVATE:return"private";case l.PLAYER_STATUS_SOLO:return"solo";default:return console.error("getClassNameFromStatus got invalid state",e),"available"}}var s=i(271),a=i(29).getText,r=i(230),l=i(640),c=i(248),u={};u[l.PLAYER_STATUS_AFK]="ui.chat.status.away",u[l.PLAYER_STATUS_IDLE]="ui.chat.status.idle",u[l.PLAYER_STATUS_PRIVATE]="ui.chat.status.private",u[l.PLAYER_STATUS_SOLO]="ui.chat.status.solo",u[l.PLAYER_STATUS_AVAILABLE]="ui.chat.status.availiable",e.exports=n,n.prototype.initialize=function(){this.currentStatus=l.PLAYER_STATUS_AVAILABLE},n.prototype._createContent=function(e){this.statusButton=e.createChild("div",{className:["statusButton","available"]});var t=this;c.addTooltip(this.statusButton,function(){return a(u[t.currentStatus])}),this.statusButton.on("tap",function(){var e=this.rootElement.getBoundingClientRect();window.gui.openContextualMenu("userStatus",null,{x:e.left+e.width,y:e.top})})},n.prototype._setCurrentStatus=function(e){e!==l.PLAYER_STATUS_IDLE&&(this.currentStatus=e),this.statusButton.replaceClassNames(["available","away","private","solo"],[o(e)])},n.prototype._setListeners=function(){var e=this;s.on("PlayerStatusUpdateMessage",function(t){t.playerId===window.gui.playerData.characterBaseInformations.id&&e._setCurrentStatus(t.status.statusId)}),r.on("inactive",function(t){var i=t?l.PLAYER_STATUS_IDLE:e.currentStatus;window.dofus.sendMessage("PlayerStatusUpdateRequestMessage",{status:{statusId:i}})})}},function(e,t){e.exports={CHAT_NO_TAG:0,CHAT_TAG_COMMUNITY_HELPER:1,CHAT_TAG_ADMIN:2}},function(e,t,i){function n(e,t){var i=this;s.call(this,"div",{className:"CheckboxLabel",text:e}),t?(this._active=!0,this.addClassNames("on")):this._active=!1,a(this),this.on("tap",function(){this._active?(this.deactivate(),r("CHECKBOX_UNCHECKED")):(this.activate(),r("CHECKBOX_CHECKED"))}),this.on("enable",function(e){i.toggleClassName("disabled",!e)})}i(677);var o=i(191).inherits,s=i(235),a=i(228),r=i(258).playUiSound;o(n,s),e.exports=n,n.prototype.activate=function(e){this._active=!0,this.addClassNames("on"),e||(this.emit("activate"),this.emit("change",!0))},n.prototype.deactivate=function(e){this._active=!1,this.delClassNames("on"),e||(this.emit("deactivate"),this.emit("change",!1))},n.prototype.toggleActivation=function(e,t){void 0===e&&(e=!this._active),e?this.activate(t):this.deactivate(t)},n.prototype.isActivate=function(){return this._active}},function(e,t){},function(e,t,i){function n(e){for(var t="",i=0;i<e.length;i+=1){var n=Number(e.charCodeAt(i)).toString(16);t+=n.length<2?"0"+n:n}return t}function o(e){var t=x.createHmac("md5",">:fIZ?vfU0sDM_9j");return t.update(e),t.digest("hex")}function s(e,t,i){var s=window.gui.playerData,a=s.identification.accountId,r=s.characterBaseInformations.name,l=window.Config.haapi.id,c=window.gui.serversData.connectedServerId,u=/^https?:\/\//;u.test(e)||(e="http://"+e);var d=e+a+t+r+i+l+c,h=o(d),p={url:e,click_account:a,from_account:t,click_name:r,from_name:i,game:l,server:c,hmac:h};return n(JSON.stringify(p))}function a(e,t,i){var n=window.Config,o="https://go.ankama.lan/"+n.language+"/check";"com"===n.haapi.hostname.split(".").pop()&&(o=b("ui.link.checklink"));var a=s(e,t,i);return o+"?s="+a}function r(e,t,i){i=i||{};var n=i.senderId,o=i.senderName,s=t||"",r=new I("span",{className:"externalLink",text:s});return r.addClassNames(i.className||"link"),i.html&&r.setHtml(i.html),i.isMsgSafe||n?i.isMsgSafe||o?(A(r),r.on("tap",function(){i.isMsgSafe?E.openUrlInAppBrowser(e):E.openUrlInAppBrowser(a(e,n,o))}),r):(console.error(new Error("HTML hyperlink: senderName is null")),r):(console.error(new Error("HTML hyperlink: senderId is null")),r)}function l(e,t,i,n){P.indexOf(e)===-1&&P.push(e),k.push(i),B.push(new RegExp(t)),F.push(!!n)}function c(e,t,i){l(e,t,i,!0)}function u(e,t,i,n){var o=n&&n.className||"link";if(!i)return t=t||e,void 0===i&&console.warn("Skipped not handled hyperlink: "+e),new I("span",{text:t,className:"deadLink"});var s=new I("span",{text:t,className:o});return A(s),s.on("tap",i),s}function d(e,t,i,n){var o=n&&n.className||"link",s=new I("span",{className:o});return T.getObject(e,t,function(n,a){if(s.rootElement){if(n)return s.replaceClassNames([o],["deadLink"]),s.setText("[???]"),console.error("Failed getting link data: "+e+" #"+t,n);var r=i(a);if(s.setText(r[0]),!r[1])return void s.replaceClassNames([o],["deadLink"]);A(s),s.on("tap",r[1])}}),s}function h(e,t,i){return function(){C.open(e,{tabId:t,tabParams:i})}}function p(e){return d("Items",e.objectGID,function(t){var i=e.objectItem?"["+t.nameId+"]":t.nameId;return[i,function(){C.open("itemBox",e)}]},e.objectItem?{className:"insertedLink"}:null)}function m(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.objectUID===t)return n}}function f(e){var t=H.exec(e),i=t?t[2]:e;return u(e,i)}var g=i(666),_=i(412),v=i(668),y=i(679),b=i(29).getText,w=i(680),M=i(509),T=i(30),C=i(225),I=i(235),A=i(228),S=i(496),E=i(252),x=i(681),L=_.CHANNEL_TEAM,N=5e3,O="\\$[a-zA-Z]+[0-9]+",D="\\{[a-zA-Z]+[^\\}]*\\}",R="<a href=[^>]+>.*?</a>",P=[],B=[],k=[],F=[];l(D,"\\{player,([^,]+),([0-9]+)(?:,channel:([0-9]+))?\\}",function(e){var t=e[1];return u(e[0],t,function(){var i=e[2],n=e[3];window.gui.openContextualMenu("player",{playerId:i,playerName:t,channel:n,isInteractiveRequired:!0})})}),l(D,"\\{item,([0-9]+),([0-9]+)\\}",function(e){return p({objectGID:parseInt(e[1],10),objectUID:parseInt(e[2],10)})}),c(D,"\\{itemStats,([0-9]+),([0-9]+)\\}",function(e,t){var i=parseInt(e[2],10);return p({objectGID:parseInt(e[1],10),objectUID:i,objectItem:t.objectItems?m(t.objectItems,i):null})}),c(D,"\\{recipe,([0-9]+)\\}",function(e){return d("Items",parseInt(e[1],10),function(e){var t="["+b("ui.common.recipes",1)+b("ui.common.colon")+e.nameId+"]";return[t,function(){M.getItems([e.id],function(t,i){return t?console.error("Broken link item:",e):void C.open("itemRecipes",{itemData:i[0]})})}]},{className:"insertedLink"})}),l(D,"\\{npc,([-0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],function(){window.isoEngine.addArrowOnNpc(parseInt(e[1],10),N)})}),l(D,"\\{monster,([-0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],function(){window.isoEngine.addArrowOnMonster(parseInt(e[1],10),N)})}),l(D,"\\{chattitle,([-0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],h("grimoire","ornaments",{titleId:e[1]}))}),l(D,"\\{chatachievement,([-0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],h("grimoire","achievements",{achievementId:e[1]}))}),l(D,"\\{guild,([-0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],function(){window.dofus.sendMessage("GuildFactsRequestMessage",{guildId:e[1]})})}),l(D,"\\{alliance,([0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],function(){window.dofus.sendMessage("AllianceFactsRequestMessage",{allianceId:e[1]})})}),c(D,"\\{pingsystem,([0-9]+),([a-zA-Z]+)::([^\\}]*)\\}",function(e,t){if(t.channel!==L)return null;var i=window.gui.pingSystem,n=e[0],o=e[1],s=e[2]||"",a=e[3]||"";return i.addPingPicto(o,s),
u(n,a,function(){i.addPingPicto(o,s)})});var z={"banner,btn_items,1":function(){w.pointToMenuIcon("Bag")},"storage,slot_2,2":function(){w.pointToCharacterItem(2)},"storage,grid":function(){w.pointToStorageFirstSlotBox()}};l(D,"\\{ui,([a-zA-Z_,0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],z[e[1]])}),l(D,"\\{openSocial,([0-9]+),([0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[3],h("social",parseInt(e[1],10),{tabId:parseInt(e[2],10)}))}),l(O,"\\$item([0-9]+)",function(e){return p({objectGID:parseInt(e[1],10)})}),l(O,"\\$job([0-9]+)",function(e){return d("Jobs",e[1],function(e){return[e.nameId,h("grimoire","jobs",{jobId:e.id})]})}),l(O,"\\$quest([0-9]+)",function(e){return d("Quests",e[1],function(e){return[e.nameId,h("grimoire","quests",{questId:e.id,categoryId:e.categoryId})]})}),l(O,"\\$area([0-9]+)",function(e){return d("Areas",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$subarea([0-9]+)",function(e){return d("SubAreas",e[1],function(e){return[e.nameId,function(){C.open("worldMap",{subareaConquest:e.id})}]})}),l(O,"\\$map([0-9]+)",function(e){return d("MapPositions",e[1],function(e){return[e.nameId||"["+e.posX+","+e.posY+"]",function(){window.gui.emit("CompassUpdateMessage",{type:y.COMPASS_TYPE_SIMPLE,worldX:e.posX,worldY:e.posY})}]})}),l(D,"\\{map,(-?[0-9]+),(-?[0-9]+)::([^\\}]*)\\}",function(e){var t=parseInt(e[1],10),i=parseInt(e[2],10),n=e[3]||"["+t+","+i+"]";return u(e[0],n,function(){C.open("worldMap",{x:t,y:i})})}),c(D,"\\{mapWithFlag,(-?[0-9]+),(-?[0-9]+),(-?[0-9]+)\\}",function(e,t){var i=parseInt(e[1],10),n=parseInt(e[2],10),o=parseInt(e[3],10),s="["+i+","+n+"]";return u(e[0],s,function(){o===window.gui.playerData.position.worldmapId&&(C.open("worldMap",{x:i,y:n}),window.gui.GPS.addPOI({id:"flag_srv"+y.COMPASS_TYPE_SIMPLE,x:i,y:n,categoryId:"hint",nameId:"("+i+","+n+")",color:{r:255,g:134,b:0,a:1},isDestination:!1}))},t.cameViaChat?{className:"insertedLink"}:null)}),l(O,"\\$itemType([0-9]+)",function(e){return d("ItemTypes",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$achievement([0-9]+)",function(e){return d("Achievements",e[1],function(t){return[t.nameId,h("grimoire","achievements",{achievementId:e[1]})]})}),l(O,"\\$title([0-9]+)",function(e){return d("Titles",e[1],function(t){var i=window.gui.playerData.characterBaseInformations.sex?t.nameFemaleId:t.nameMaleId;return[i,h("grimoire","ornaments",{titleId:e[1]})]})}),l(O,"\\$ornament([0-9]+)",function(e){return d("Ornaments",e[1],function(t){return[t.nameId,h("grimoire","ornaments",{ornamentId:e[1]})]})}),l(O,"\\$spell([0-9]+)",function(e){return d("Spells",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$spellState([0-9]+)",function(e){return d("SpellStates",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$breed([0-9]+)",function(e){return d("Breeds",e[1],function(e){return[e.shortNameId,null]})}),l(O,"\\$emote([0-9]+)",function(e){return d("Emoticons",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$monster([0-9]+)",function(e){return d("Monsters",e[1],function(t){return[t.nameId,h("grimoire","bestiary",{monsterIds:[e[1]],label:t.nameId})]})}),l(O,"\\$monsterRace([0-9]+)",function(e){return d("MonsterRaces",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$monsterSuperRace([0-9]+)",function(e){return d("MonsterSuperRaces",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$alignment([0-9]+)",function(e){return d("AlignmentSides",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$stat([0-9]+)",function(e){var t=b("ui.item.characteristics").split(",");return u(e[0],t[e[1]],null)}),l(O,"\\$dungeon([0-9]+)",function(e){return d("Dungeons",e[1],function(e){return[e.nameId,null]})}),l(O,"\\$challenge([0-9]+)",function(e){return d("Challenge",e[1],function(e){return[e.nameId,null]})}),c(R,"<a href=([^>]+)>(.*?)</a>",function(e,t){var i=e[1],n=e[2];return'"'!==i[0]&&"'"!==i[0]||(i=i.slice(1,-1)),r(i,null,{html:n,isMsgSafe:t.isMsgSafe,senderId:t.senderId,senderName:t.senderName})}),l(D,"\\{style:([a-zA-Z]+),([^\\}]*)\\}",function(e){return new I("span",{text:e[2],className:e[1]})}),l(D,"\\{myShop::([^\\}]*)\\}",function(e){return u(e[0],e[1],function(){window.dofus.sendMessage("ExchangeRequestOnShopStockMessage")})}),l(D,"\\{windowTab,([a-zA-Z_,0-9]+),([a-zA-Z_,0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[3],function(){C.open(e[1],{tabId:e[2]})})}),l(D,"\\{window,([a-zA-Z_,0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],function(){return"bidHouseShop"===e[1]?S.openBidHouse(!1):void C.open(e[1])})}),l(D,"\\{guild,([a-zA-Z_,0-9]+)::([^\\}]*)\\}",function(e){return u(e[0],e[2],h("social","guild",{tabId:e[1]}))});var H=/\{([a-zA-Z_,0-9-]+)::([^}]*)\}/,q=new RegExp(P.join("|"));t.process=function(e,t){t=t||{};var i=t.channel,n=void 0!==i&&!t.isNonChat&&g.isHumanChannel(i),o=!n||g.isChannelSafe(i),s={allPagesAllowed:t.decodeAllPages},a={cameViaChat:n,channel:i,objectItems:t.objectItems,senderId:t.senderId,senderName:t.senderName,isMsgSafe:o,parentClassName:t.parentClassName},r=new I("span");for(a.parentClassName&&r.setClassNames(a.parentClassName);;){var l=q.exec(e);if(!l)break;for(var c,u=l[0],d=e.indexOf(u),h=e.substr(0,d),p=e.substr(d+u.length),m=null,_=0;_<k.length;_++)if((o||F[_])&&(c=B[_].exec(u))){m=k[_](c,a);break}m||(m=f(u)),h&&(n&&(h=v.decode(h,s)),r.createChild("span").setHtml(h)),r.appendChild(m),e=p}return e&&(n&&(e=v.decode(e,s)),r.createChild("span").setHtml(e)),r}},function(e,t){e.exports={COMPASS_TYPE_SIMPLE:0,COMPASS_TYPE_SPOUSE:1,COMPASS_TYPE_PARTY:2,COMPASS_TYPE_PVP_SEEK:3,COMPASS_TYPE_QUEST:4}},function(e,t,i){function n(e,t,i,n){if(!e)return console.error(new Error("Tutorial hint: no wuidom"));var o=e.rootElement;if(!o)return console.error(new Error("Tutorial hint issue"));var s=o.getBoundingClientRect(),a=Math.round(s.left+s.width*(i||.5)),r=Math.round(s.top+s.height*(n||.5));window.gui.hintArrow.showArrow(a,r,t)}var o=i(225),s=i(478),a=300;t.pointToChatButton=function(){n(window.gui.chatButton,"downLeft")},t.pointToChatChannelButton=function(){n(window.gui.chat.chatInput.outgoingChannelButton,"upRight")},t.pointToWindowCloseButton=function(e){var t=o.getWindow(e);t.openState&&n(t.closeButton,"upRight")},t.pointToMenuIcon=function(e){var t=window.gui.menuBar.getIconForTuto(e);n(t,"downRight")},t.pointToNpcAnswer=function(e){var t=window.gui.npcDialogUi.getNpcReplyButtonForTuto(e);t&&n(t,"downRight",.3,.3)},t.pointToTimelineButton=function(e){var t=window.gui.timeline.fightControlButtons.getButtonForTuto(e);t&&n(t,"upLeft",.5,.3)},t.pointToFirstSkillShortcut=function(){var e=window.gui.shortcutBar;e.openPanel("spell"),n(e.getSlotForTuto("spell",0),"downRight")},t.pointToEquipFilterIcon=function(){var e=o.getWindow("equipment");e.openState&&n(e.storageView.getEquipmentFilterButtonForTuto(),"upLeft")},t.pointToQuestFilterIcon=function(){var e=o.getWindow("equipment");e.openState&&n(e.storageView.getQuestFilterButtonForTuto(),"upLeft")},t.pointToActionButton=function(){var e=o.getWindow("equipment");e.openState&&n(e.drawer._getItemBoxActionButton(),"downRight")},t.pointToEntryManageShield=function(){var e=s.getContextMenu("item");e&&n(e.getEntryManageShield(),"upLeft")},t.pointToCharacterItem=function(e){var t=o.getWindow("equipment");if(t.openState){var i=t.getEquipmentSlotsForTuto();n(i[e],"upLeft")}},t.pointToShieldSpellSlot=function(){var e=o.getWindow("shieldWindow");e.openState&&n(e.getShieldSpellSlot(),"upLeft")},t.pointToShieldValidateButton=function(){var e=o.getWindow("shieldWindow");e.openState&&n(e.feedingBox.confirmBtn,"downRight")},t.pointToShieldStorageFirstSlotBox=function(){var e=o.getWindow("shieldWindow");e.openState&&setTimeout(function(){n(e.feedingBox.storageViewer.getStorageFirstSlotForTuto(),"downRight")},a)},t.pointToStorageFirstSlotBox=function(){var e=o.getWindow("equipment");e.openState&&setTimeout(function(){n(e.storageView.getStorageFirstSlotForTuto(),"downRight")},a)}},function(e,t,i){(function(e){function n(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function o(e,t){for(var i in e)t(e[i],i)}var s=i(686);t.createHash=i(688),t.createHmac=i(697),t.randomBytes=function(t,i){if(!i||!i.call)return new e(s(t));try{i.call(this,void 0,new e(s(t)))}catch(n){i(n)}},t.getHashes=function(){return["sha1","sha256","sha512","md5","rmd160"]};var a=i(698)(t);t.pbkdf2=a.pbkdf2,t.pbkdf2Sync=a.pbkdf2Sync,o(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman"],function(e){t[e]=function(){n("sorry,",e,"is not implemented yet")}})}).call(t,i(682).Buffer)},function(e,t,i){(function(e,n){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <http://feross.org>
	 * @license  MIT
	 */
"use strict";function o(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function s(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,i){if(s()<i)throw new RangeError("Invalid typed array length");return e.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(i),t.__proto__=e.prototype):(null===t&&(t=new e(i)),t.length=i),t}function e(t,i,n){if(!(e.TYPED_ARRAY_SUPPORT||this instanceof e))return new e(t,i,n);if("number"==typeof t){if("string"==typeof i)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return r(this,t,i,n)}function r(e,t,i,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?p(e,t,i,n):"string"==typeof t?d(e,t,i):m(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t,i,n){return l(t),t<=0?a(e,t):void 0!==i?"string"==typeof n?a(e,t).fill(i,n):a(e,t).fill(i):a(e,t)}function u(t,i){if(l(i),t=a(t,i<0?0:0|f(i)),!e.TYPED_ARRAY_SUPPORT)for(var n=0;n<i;++n)t[n]=0;return t}function d(t,i,n){if("string"==typeof n&&""!==n||(n="utf8"),!e.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|_(i,n);t=a(t,o);var s=t.write(i,n);return s!==o&&(t=t.slice(0,s)),t}function h(e,t){var i=t.length<0?0:0|f(t.length);e=a(e,i);for(var n=0;n<i;n+=1)e[n]=255&t[n];return e}function p(t,i,n,o){if(i.byteLength,n<0||i.byteLength<n)throw new RangeError("'offset' is out of bounds");if(i.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");return i=void 0===n&&void 0===o?new Uint8Array(i):void 0===o?new Uint8Array(i,n):new Uint8Array(i,n,o),e.TYPED_ARRAY_SUPPORT?(t=i,t.__proto__=e.prototype):t=h(t,i),t}function m(t,i){if(e.isBuffer(i)){var n=0|f(i.length);return t=a(t,n),0===t.length?t:(i.copy(t,0,0,n),t)}if(i){if("undefined"!=typeof ArrayBuffer&&i.buffer instanceof ArrayBuffer||"length"in i)return"number"!=typeof i.length||K(i.length)?a(t,0):h(t,i);if("Buffer"===i.type&&$(i.data))return h(t,i.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function g(t){return+t!=t&&(t=0),e.alloc(+t)}function _(t,i){if(e.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var o=!1;;)switch(i){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(t).length;default:if(o)return G(t).length;i=(""+i).toLowerCase(),o=!0}}function v(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if(i>>>=0,t>>>=0,i<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return D(this,t,i);case"utf8":case"utf-8":return x(this,t,i);case"ascii":return N(this,t,i);case"latin1":case"binary":return O(this,t,i);case"base64":return E(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function b(t,i,n,o,s){if(0===t.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=s?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(s)return-1;n=t.length-1}else if(n<0){if(!s)return-1;n=0}if("string"==typeof i&&(i=e.from(i,o)),e.isBuffer(i))return 0===i.length?-1:w(t,i,n,o,s);if("number"==typeof i)return i=255&i,e.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,i,n):Uint8Array.prototype.lastIndexOf.call(t,i,n):w(t,[i],n,o,s);throw new TypeError("val must be string, number or Buffer")}function w(e,t,i,n,o){function s(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,r=e.length,l=t.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,r/=2,l/=2,i/=2}var c;if(o){var u=-1;for(c=i;c<r;c++)if(s(e,c)===s(t,u===-1?0:c-u)){if(u===-1&&(u=c),c-u+1===l)return u*a}else u!==-1&&(c-=c-u),u=-1}else for(i+l>r&&(i=r-l),c=i;c>=0;c--){for(var d=!0,h=0;h<l;h++)if(s(e,c+h)!==s(t,h)){d=!1;break}if(d)return c}return-1}function M(e,t,i,n){i=Number(i)||0;var o=e.length-i;n?(n=Number(n),n>o&&(n=o)):n=o;var s=t.length;if(s%2!==0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var a=0;a<n;++a){var r=parseInt(t.substr(2*a,2),16);if(isNaN(r))return a;e[i+a]=r}return a}function T(e,t,i,n){return Q(G(t,e.length-i),e,i,n)}function C(e,t,i,n){return Q(j(t),e,i,n)}function I(e,t,i,n){return C(e,t,i,n)}function A(e,t,i,n){return Q(X(t),e,i,n)}function S(e,t,i,n){return Q(V(t,e.length-i),e,i,n)}function E(e,t,i){return 0===t&&i===e.length?J.fromByteArray(e):J.fromByteArray(e.slice(t,i))}function x(e,t,i){i=Math.min(e.length,i);for(var n=[],o=t;o<i;){var s=e[o],a=null,r=s>239?4:s>223?3:s>191?2:1;if(o+r<=i){var l,c,u,d;switch(r){case 1:s<128&&(a=s);break;case 2:l=e[o+1],128===(192&l)&&(d=(31&s)<<6|63&l,d>127&&(a=d));break;case 3:l=e[o+1],c=e[o+2],128===(192&l)&&128===(192&c)&&(d=(15&s)<<12|(63&l)<<6|63&c,d>2047&&(d<55296||d>57343)&&(a=d));break;case 4:l=e[o+1],c=e[o+2],u=e[o+3],128===(192&l)&&128===(192&c)&&128===(192&u)&&(d=(15&s)<<18|(63&l)<<12|(63&c)<<6|63&u,d>65535&&d<1114112&&(a=d))}}null===a?(a=65533,r=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),o+=r}return L(n)}function L(e){var t=e.length;if(t<=ee)return String.fromCharCode.apply(String,e);for(var i="",n=0;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=ee));return i}function N(e,t,i){var n="";i=Math.min(e.length,i);for(var o=t;o<i;++o)n+=String.fromCharCode(127&e[o]);return n}function O(e,t,i){var n="";i=Math.min(e.length,i);for(var o=t;o<i;++o)n+=String.fromCharCode(e[o]);return n}function D(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);for(var o="",s=t;s<i;++s)o+=Y(e[s]);return o}function R(e,t,i){for(var n=e.slice(t,i),o="",s=0;s<n.length;s+=2)o+=String.fromCharCode(n[s]+256*n[s+1]);return o}function P(e,t,i){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function B(t,i,n,o,s,a){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i>s||i<a)throw new RangeError('"value" argument is out of bounds');if(n+o>t.length)throw new RangeError("Index out of range")}function k(e,t,i,n){t<0&&(t=65535+t+1);for(var o=0,s=Math.min(e.length-i,2);o<s;++o)e[i+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function F(e,t,i,n){t<0&&(t=4294967295+t+1);for(var o=0,s=Math.min(e.length-i,4);o<s;++o)e[i+o]=t>>>8*(n?o:3-o)&255}function z(e,t,i,n,o,s){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function H(e,t,i,n,o){return o||z(e,t,i,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,i,n,23,4),i+4}function q(e,t,i,n,o){return o||z(e,t,i,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,i,n,52,8),i+8}function W(e){if(e=U(e).replace(te,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function U(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Y(e){return e<16?"0"+e.toString(16):e.toString(16)}function G(e,t){t=t||1/0;for(var i,n=e.length,o=null,s=[],a=0;a<n;++a){if(i=e.charCodeAt(a),i>55295&&i<57344){if(!o){if(i>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}o=i;continue}if(i<56320){(t-=3)>-1&&s.push(239,191,189),o=i;continue}i=(o-55296<<10|i-56320)+65536}else o&&(t-=3)>-1&&s.push(239,191,189);if(o=null,i<128){if((t-=1)<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function j(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}function V(e,t){for(var i,n,o,s=[],a=0;a<e.length&&!((t-=2)<0);++a)i=e.charCodeAt(a),n=i>>8,o=i%256,s.push(o),s.push(n);return s}function X(e){return J.toByteArray(W(e))}function Q(e,t,i,n){for(var o=0;o<n&&!(o+i>=t.length||o>=e.length);++o)t[o+i]=e[o];return o}function K(e){return e!==e}var J=i(683),Z=i(684),$=i(685);t.Buffer=e,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50,e.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:o(),t.kMaxLength=s(),e.poolSize=8192,e._augment=function(t){return t.__proto__=e.prototype,t},e.from=function(e,t,i){return r(null,e,t,i)},e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0})),e.alloc=function(e,t,i){return c(null,e,t,i)},e.allocUnsafe=function(e){return u(null,e)},e.allocUnsafeSlow=function(e){return u(null,e)},e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,i){if(!e.isBuffer(t)||!e.isBuffer(i))throw new TypeError("Arguments must be Buffers");if(t===i)return 0;for(var n=t.length,o=i.length,s=0,a=Math.min(n,o);s<a;++s)if(t[s]!==i[s]){n=t[s],o=i[s];break}return n<o?-1:o<n?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,i){if(!$(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var n;if(void 0===i)for(i=0,n=0;n<t.length;++n)i+=t[n].length;var o=e.allocUnsafe(i),s=0;for(n=0;n<t.length;++n){var a=t[n];if(!e.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(o,s),s+=a.length}return o},e.byteLength=_,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):v.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t,i,n,o,s){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===i&&(i=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===s&&(s=this.length),i<0||n>t.length||o<0||s>this.length)throw new RangeError("out of range index");if(o>=s&&i>=n)return 0;if(o>=s)return-1;if(i>=n)return 1;if(i>>>=0,n>>>=0,o>>>=0,s>>>=0,this===t)return 0;for(var a=s-o,r=n-i,l=Math.min(a,r),c=this.slice(o,s),u=t.slice(i,n),d=0;d<l;++d)if(c[d]!==u[d]){a=c[d],r=u[d];break}return a<r?-1:r<a?1:0},e.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1},e.prototype.indexOf=function(e,t,i){return b(this,e,t,i,!0)},e.prototype.lastIndexOf=function(e,t,i){return b(this,e,t,i,!1)},e.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t=0|t,isFinite(i)?(i=0|i,void 0===n&&(n="utf8")):(n=i,i=void 0)}var o=this.length-t;if((void 0===i||i>o)&&(i=o),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return M(this,e,t,i);case"utf8":case"utf-8":return T(this,e,t,i);case"ascii":return C(this,e,t,i);case"latin1":case"binary":return I(this,e,t,i);case"base64":return A(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;e.prototype.slice=function(t,i){var n=this.length;t=~~t,i=void 0===i?n:~~i,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),i<0?(i+=n,i<0&&(i=0)):i>n&&(i=n),i<t&&(i=t);var o;if(e.TYPED_ARRAY_SUPPORT)o=this.subarray(t,i),o.__proto__=e.prototype;else{var s=i-t;o=new e(s,(void 0));for(var a=0;a<s;++a)o[a]=this[a+t]}return o},e.prototype.readUIntLE=function(e,t,i){e=0|e,t=0|t,i||P(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return n},e.prototype.readUIntBE=function(e,t,i){e=0|e,t=0|t,i||P(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},e.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,i){e=0|e,t=0|t,i||P(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},e.prototype.readIntBE=function(e,t,i){e=0|e,t=0|t,i||P(e,t,this.length);for(var n=t,o=1,s=this[e+--n];n>0&&(o*=256);)s+=this[e+--n]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*t)),s},e.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},e.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},e.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},e.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),Z.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),Z.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),Z.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),Z.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=0|t,i=0|i,!n){var o=Math.pow(2,8*i)-1;B(this,e,t,i,o,0)}var s=1,a=0;for(this[t]=255&e;++a<i&&(s*=256);)this[t+a]=e/s&255;return t+i},e.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=0|t,i=0|i,!n){var o=Math.pow(2,8*i)-1;B(this,e,t,i,o,0)}var s=i-1,a=1;for(this[t+s]=255&e;--s>=0&&(a*=256);)this[t+s]=e/a&255;return t+i},e.prototype.writeUInt8=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[i]=255&t,i+1},e.prototype.writeUInt16LE=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8):k(this,t,i,!0),i+2},e.prototype.writeUInt16BE=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[i]=t>>>8,this[i+1]=255&t):k(this,t,i,!1),i+2},e.prototype.writeUInt32LE=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[i+3]=t>>>24,this[i+2]=t>>>16,this[i+1]=t>>>8,this[i]=255&t):F(this,t,i,!0),i+4},e.prototype.writeUInt32BE=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[i]=t>>>24,this[i+1]=t>>>16,this[i+2]=t>>>8,this[i+3]=255&t):F(this,t,i,!1),i+4},e.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=0|t,!n){var o=Math.pow(2,8*i-1);B(this,e,t,i,o-1,-o)}var s=0,a=1,r=0;for(this[t]=255&e;++s<i&&(a*=256);)e<0&&0===r&&0!==this[t+s-1]&&(r=1),this[t+s]=(e/a>>0)-r&255;return t+i},e.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=0|t,!n){var o=Math.pow(2,8*i-1);B(this,e,t,i,o-1,-o)}var s=i-1,a=1,r=0;for(this[t+s]=255&e;--s>=0&&(a*=256);)e<0&&0===r&&0!==this[t+s+1]&&(r=1),this[t+s]=(e/a>>0)-r&255;return t+i},e.prototype.writeInt8=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[i]=255&t,i+1},e.prototype.writeInt16LE=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8):k(this,t,i,!0),i+2},e.prototype.writeInt16BE=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[i]=t>>>8,this[i+1]=255&t):k(this,t,i,!1),i+2},e.prototype.writeInt32LE=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8,this[i+2]=t>>>16,this[i+3]=t>>>24):F(this,t,i,!0),i+4},e.prototype.writeInt32BE=function(t,i,n){return t=+t,i=0|i,n||B(this,t,i,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[i]=t>>>24,this[i+1]=t>>>16,this[i+2]=t>>>8,this[i+3]=255&t):F(this,t,i,!1),i+4},e.prototype.writeFloatLE=function(e,t,i){return H(this,e,t,!0,i)},e.prototype.writeFloatBE=function(e,t,i){return H(this,e,t,!1,i)},e.prototype.writeDoubleLE=function(e,t,i){return q(this,e,t,!0,i)},e.prototype.writeDoubleBE=function(e,t,i){return q(this,e,t,!1,i)},e.prototype.copy=function(t,i,n,o){if(n||(n=0),o||0===o||(o=this.length),i>=t.length&&(i=t.length),i||(i=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-i<o-n&&(o=t.length-i+n);var s,a=o-n;if(this===t&&n<i&&i<o)for(s=a-1;s>=0;--s)t[s+i]=this[s+n];else if(a<1e3||!e.TYPED_ARRAY_SUPPORT)for(s=0;s<a;++s)t[s+i]=this[s+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),i);return a},e.prototype.fill=function(t,i,n,o){if("string"==typeof t){if("string"==typeof i?(o=i,i=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1===t.length){var s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!e.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof t&&(t=255&t);if(i<0||this.length<i||this.length<n)throw new RangeError("Out of range index");if(n<=i)return this;i>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var a;if("number"==typeof t)for(a=i;a<n;++a)this[a]=t;else{var r=e.isBuffer(t)?t:G(new e(t,o).toString()),l=r.length;for(a=0;a<n-i;++a)this[a+i]=r[a%l]}return this};var te=/[^+\/0-9A-Za-z-_]/g}).call(t,i(682).Buffer,function(){return this}())},function(e,t){"use strict";function i(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");i===-1&&(i=t);var n=i===t?0:4-i%4;return[i,n]}function n(e){var t=i(e),n=t[0],o=t[1];return 3*(n+o)/4-o}function o(e,t,i){return 3*(t+i)/4-i}function s(e){var t,n,s=i(e),a=s[0],r=s[1],l=new d(o(e,a,r)),c=0,h=r>0?a-4:a;for(n=0;n<h;n+=4)t=u[e.charCodeAt(n)]<<18|u[e.charCodeAt(n+1)]<<12|u[e.charCodeAt(n+2)]<<6|u[e.charCodeAt(n+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;return 2===r&&(t=u[e.charCodeAt(n)]<<2|u[e.charCodeAt(n+1)]>>4,l[c++]=255&t),1===r&&(t=u[e.charCodeAt(n)]<<10|u[e.charCodeAt(n+1)]<<4|u[e.charCodeAt(n+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t),l}function a(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function r(e,t,i){for(var n,o=[],s=t;s<i;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(a(n));return o.join("")}function l(e){for(var t,i=e.length,n=i%3,o=[],s=16383,a=0,l=i-n;a<l;a+=s)o.push(r(e,a,a+s>l?l:a+s));return 1===n?(t=e[i-1],o.push(c[t>>2]+c[t<<4&63]+"==")):2===n&&(t=(e[i-2]<<8)+e[i-1],o.push(c[t>>10]+c[t>>4&63]+c[t<<2&63]+"=")),o.join("")}t.byteLength=n,t.toByteArray=s,t.fromByteArray=l;for(var c=[],u=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,m=h.length;p<m;++p)c[p]=h[p],u[h.charCodeAt(p)]=p;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,i,n,o){var s,a,r=8*o-n-1,l=(1<<r)-1,c=l>>1,u=-7,d=i?o-1:0,h=i?-1:1,p=e[t+d];for(d+=h,s=p&(1<<-u)-1,p>>=-u,u+=r;u>0;s=256*s+e[t+d],d+=h,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=n;u>0;a=256*a+e[t+d],d+=h,u-=8);if(0===s)s=1-c;else{if(s===l)return a?NaN:(p?-1:1)*(1/0);a+=Math.pow(2,n),s-=c}return(p?-1:1)*a*Math.pow(2,s-n)},t.write=function(e,t,i,n,o,s){var a,r,l,c=8*s-o-1,u=(1<<c)-1,d=u>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,m=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(r=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),t+=a+d>=1?h/l:h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(r=0,a=u):a+d>=1?(r=(t*l-1)*Math.pow(2,o),a+=d):(r=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[i+p]=255&r,p+=m,r/=256,o-=8);for(a=a<<o|r,c+=o;c>0;e[i+p]=255&a,p+=m,a/=256,c-=8);e[i+p-m]|=128*f}},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t,i){(function(t,n){!function(){var o=("undefined"==typeof window?t:window)||{};_crypto=o.crypto||o.msCrypto||i(687),e.exports=function(e){if(_crypto.getRandomValues){var t=new n(e);return _crypto.getRandomValues(t),t}if(_crypto.randomBytes)return _crypto.randomBytes(e);throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}}()}).call(t,function(){return this}(),i(682).Buffer)},function(e,t){},function(e,t,i){(function(t){function n(e){return function(){var i=[],n={update:function(e,n){return t.isBuffer(e)||(e=new t(e,n)),i.push(e),this},digest:function(n){var o=t.concat(i),s=e(o);return i=null,n?s.toString(n):s}};return n}}var o=i(689),s=n(i(694)),a=n(i(696));e.exports=function(e){return"md5"===e?new s:"rmd160"===e?new a:o(e)}}).call(t,i(682).Buffer)},function(e,t,i){var t=e.exports=function(e){var i=t[e];if(!i)throw new Error(e+" is not supported (we accept pull requests)");return new i},n=i(682).Buffer,o=i(690)(n);t.sha1=i(691)(n,o),t.sha256=i(692)(n,o),t.sha512=i(693)(n,o)},function(e,t){e.exports=function(e){function t(t,i){this._block=new e(t),this._finalSize=i,this._blockSize=t,this._len=0,this._s=0}return t.prototype.init=function(){this._s=0,this._len=0},t.prototype.update=function(t,i){"string"==typeof t&&(i=i||"utf8",t=new e(t,i));for(var n=this._len+=t.length,o=this._s=this._s||0,s=0,a=this._block;o<n;){for(var r=Math.min(t.length,s+this._blockSize-o%this._blockSize),l=r-s,c=0;c<l;c++)a[o%this._blockSize+c]=t[c+s];o+=l,s+=l,o%this._blockSize===0&&this._update(a)}return this._s=o,this},t.prototype.digest=function(e){var t=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),t%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(t,this._blockSize-4);var i=this._update(this._block)||this._hash();return e?i.toString(e):i},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t}},function(e,t,i){var n=i(191).inherits;e.exports=function(e,t){function i(){return m.length?m.pop().init():this instanceof i?(this._w=p,t.call(this,64,56),this._h=null,void this.init()):new i}function o(e,t,i,n){return e<20?t&i|~t&n:e<40?t^i^n:e<60?t&i|t&n|i&n:t^i^n}function s(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function a(e,t){return e+t|0}function r(e,t){return e<<t|e>>>32-t}var l=0,c=4,u=8,d=12,h=16,p=new("undefined"==typeof Int32Array?Array:Int32Array)(80),m=[];return n(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,t.prototype.init.call(this),this},i.prototype._POOL=m,i.prototype._update=function(e){var t,i,n,l,c,u,d,h,p,m;t=u=this._a,i=d=this._b,n=h=this._c,l=p=this._d,c=m=this._e;for(var f=this._w,g=0;g<80;g++){var _=f[g]=g<16?e.readInt32BE(4*g):r(f[g-3]^f[g-8]^f[g-14]^f[g-16],1),v=a(a(r(t,5),o(g,i,n,l)),a(a(c,_),s(g)));c=l,l=n,n=r(i,30),i=t,t=v}this._a=a(t,u),this._b=a(i,d),this._c=a(n,h),this._d=a(l,p),this._e=a(c,m)},i.prototype._hash=function(){m.length<100&&m.push(this);var t=new e(20);return t.writeInt32BE(0|this._a,l),t.writeInt32BE(0|this._b,c),t.writeInt32BE(0|this._c,u),t.writeInt32BE(0|this._d,d),t.writeInt32BE(0|this._e,h),t},i}},function(e,t,i){var n=i(191).inherits;e.exports=function(e,t){function i(){this.init(),this._w=p,t.call(this,64,56)}function o(e,t){return e>>>t|e<<32-t}function s(e,t){return e>>>t}function a(e,t,i){return e&t^~e&i}function r(e,t,i){return e&t^e&i^t&i}function l(e){return o(e,2)^o(e,13)^o(e,22)}function c(e){return o(e,6)^o(e,11)^o(e,25)}function u(e){return o(e,7)^o(e,18)^s(e,3)}function d(e){return o(e,17)^o(e,19)^s(e,10)}var h=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=new Array(64);return n(i,t),i.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._len=this._s=0,this},i.prototype._update=function(e){var t,i,n,o,s,p,m,f,g,_,v=this._w;t=0|this._a,i=0|this._b,n=0|this._c,o=0|this._d,s=0|this._e,p=0|this._f,m=0|this._g,f=0|this._h;for(var y=0;y<64;y++){var b=v[y]=y<16?e.readInt32BE(4*y):d(v[y-2])+v[y-7]+u(v[y-15])+v[y-16];g=f+c(s)+a(s,p,m)+h[y]+b,_=l(t)+r(t,i,n),f=m,m=p,p=s,s=o+g,o=n,n=i,i=t,t=g+_}this._a=t+this._a|0,this._b=i+this._b|0,this._c=n+this._c|0,this._d=o+this._d|0,this._e=s+this._e|0,this._f=p+this._f|0,this._g=m+this._g|0,this._h=f+this._h|0},i.prototype._hash=function(){var t=new e(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},i}},function(e,t,i){var n=i(191).inherits;e.exports=function(e,t){function i(){this.init(),this._w=l,t.call(this,128,112)}function o(e,t,i){return e>>>i|t<<32-i}function s(e,t,i){return e&t^~e&i}function a(e,t,i){return e&t^e&i^t&i}var r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],l=new Array(160);return n(i,t),i.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._al=-205731576,this._bl=-2067093701,this._cl=-23791573,this._dl=1595750129,this._el=-1377402159,this._fl=725511199,this._gl=-79577749,this._hl=327033209,this._len=this._s=0,this},i.prototype._update=function(e){var t,i,n,l,c,u,d,h,p,m,f,g,_,v,y,b,w=this._w;t=0|this._a,i=0|this._b,n=0|this._c,l=0|this._d,c=0|this._e,u=0|this._f,d=0|this._g,h=0|this._h,p=0|this._al,m=0|this._bl,f=0|this._cl,g=0|this._dl,_=0|this._el,v=0|this._fl,y=0|this._gl,b=0|this._hl;for(var M=0;M<80;M++){var T,C,I=2*M;if(M<16)T=w[I]=e.readInt32BE(4*I),C=w[I+1]=e.readInt32BE(4*I+4);else{var A=w[I-30],S=w[I-30+1],E=o(A,S,1)^o(A,S,8)^A>>>7,x=o(S,A,1)^o(S,A,8)^o(S,A,7);A=w[I-4],S=w[I-4+1];var L=o(A,S,19)^o(S,A,29)^A>>>6,N=o(S,A,19)^o(A,S,29)^o(S,A,6),O=w[I-14],D=w[I-14+1],R=w[I-32],P=w[I-32+1];C=x+D,T=E+O+(C>>>0<x>>>0?1:0),C+=N,T=T+L+(C>>>0<N>>>0?1:0),C+=P,T=T+R+(C>>>0<P>>>0?1:0),w[I]=T,w[I+1]=C}var B=a(t,i,n),k=a(p,m,f),F=o(t,p,28)^o(p,t,2)^o(p,t,7),z=o(p,t,28)^o(t,p,2)^o(t,p,7),H=o(c,_,14)^o(c,_,18)^o(_,c,9),q=o(_,c,14)^o(_,c,18)^o(c,_,9),W=r[I],U=r[I+1],Y=s(c,u,d),G=s(_,v,y),j=b+q,V=h+H+(j>>>0<b>>>0?1:0);j+=G,V=V+Y+(j>>>0<G>>>0?1:0),j+=U,V=V+W+(j>>>0<U>>>0?1:0),j+=C,V=V+T+(j>>>0<C>>>0?1:0);var X=z+k,Q=F+B+(X>>>0<z>>>0?1:0);h=d,b=y,d=u,y=v,u=c,v=_,_=g+j|0,c=l+V+(_>>>0<g>>>0?1:0)|0,l=n,g=f,n=i,f=m,i=t,m=p,p=j+X|0,t=V+Q+(p>>>0<j>>>0?1:0)|0}this._al=this._al+p|0,this._bl=this._bl+m|0,this._cl=this._cl+f|0,this._dl=this._dl+g|0,this._el=this._el+_|0,this._fl=this._fl+v|0,this._gl=this._gl+y|0,this._hl=this._hl+b|0,this._a=this._a+t+(this._al>>>0<p>>>0?1:0)|0,this._b=this._b+i+(this._bl>>>0<m>>>0?1:0)|0,this._c=this._c+n+(this._cl>>>0<f>>>0?1:0)|0,this._d=this._d+l+(this._dl>>>0<g>>>0?1:0)|0,this._e=this._e+c+(this._el>>>0<_>>>0?1:0)|0,this._f=this._f+u+(this._fl>>>0<v>>>0?1:0)|0,this._g=this._g+d+(this._gl>>>0<y>>>0?1:0)|0,this._h=this._h+h+(this._hl>>>0<b>>>0?1:0)|0},i.prototype._hash=function(){function t(e,t,n){i.writeInt32BE(e,n),i.writeInt32BE(t,n+4)}var i=new e(64);return t(this._a,this._al,0),
t(this._b,this._bl,8),t(this._c,this._cl,16),t(this._d,this._dl,24),t(this._e,this._el,32),t(this._f,this._fl,40),t(this._g,this._gl,48),t(this._h,this._hl,56),i},i}},function(e,t,i){function n(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var i=1732584193,n=-271733879,o=-1732584194,u=271733878,d=0;d<e.length;d+=16){var h=i,p=n,m=o,f=u;i=s(i,n,o,u,e[d+0],7,-680876936),u=s(u,i,n,o,e[d+1],12,-389564586),o=s(o,u,i,n,e[d+2],17,606105819),n=s(n,o,u,i,e[d+3],22,-1044525330),i=s(i,n,o,u,e[d+4],7,-176418897),u=s(u,i,n,o,e[d+5],12,1200080426),o=s(o,u,i,n,e[d+6],17,-1473231341),n=s(n,o,u,i,e[d+7],22,-45705983),i=s(i,n,o,u,e[d+8],7,1770035416),u=s(u,i,n,o,e[d+9],12,-1958414417),o=s(o,u,i,n,e[d+10],17,-42063),n=s(n,o,u,i,e[d+11],22,-1990404162),i=s(i,n,o,u,e[d+12],7,1804603682),u=s(u,i,n,o,e[d+13],12,-40341101),o=s(o,u,i,n,e[d+14],17,-1502002290),n=s(n,o,u,i,e[d+15],22,1236535329),i=a(i,n,o,u,e[d+1],5,-165796510),u=a(u,i,n,o,e[d+6],9,-1069501632),o=a(o,u,i,n,e[d+11],14,643717713),n=a(n,o,u,i,e[d+0],20,-373897302),i=a(i,n,o,u,e[d+5],5,-701558691),u=a(u,i,n,o,e[d+10],9,38016083),o=a(o,u,i,n,e[d+15],14,-660478335),n=a(n,o,u,i,e[d+4],20,-405537848),i=a(i,n,o,u,e[d+9],5,568446438),u=a(u,i,n,o,e[d+14],9,-1019803690),o=a(o,u,i,n,e[d+3],14,-187363961),n=a(n,o,u,i,e[d+8],20,1163531501),i=a(i,n,o,u,e[d+13],5,-1444681467),u=a(u,i,n,o,e[d+2],9,-51403784),o=a(o,u,i,n,e[d+7],14,1735328473),n=a(n,o,u,i,e[d+12],20,-1926607734),i=r(i,n,o,u,e[d+5],4,-378558),u=r(u,i,n,o,e[d+8],11,-2022574463),o=r(o,u,i,n,e[d+11],16,1839030562),n=r(n,o,u,i,e[d+14],23,-35309556),i=r(i,n,o,u,e[d+1],4,-1530992060),u=r(u,i,n,o,e[d+4],11,1272893353),o=r(o,u,i,n,e[d+7],16,-155497632),n=r(n,o,u,i,e[d+10],23,-1094730640),i=r(i,n,o,u,e[d+13],4,681279174),u=r(u,i,n,o,e[d+0],11,-358537222),o=r(o,u,i,n,e[d+3],16,-722521979),n=r(n,o,u,i,e[d+6],23,76029189),i=r(i,n,o,u,e[d+9],4,-640364487),u=r(u,i,n,o,e[d+12],11,-421815835),o=r(o,u,i,n,e[d+15],16,530742520),n=r(n,o,u,i,e[d+2],23,-995338651),i=l(i,n,o,u,e[d+0],6,-198630844),u=l(u,i,n,o,e[d+7],10,1126891415),o=l(o,u,i,n,e[d+14],15,-1416354905),n=l(n,o,u,i,e[d+5],21,-57434055),i=l(i,n,o,u,e[d+12],6,1700485571),u=l(u,i,n,o,e[d+3],10,-1894986606),o=l(o,u,i,n,e[d+10],15,-1051523),n=l(n,o,u,i,e[d+1],21,-2054922799),i=l(i,n,o,u,e[d+8],6,1873313359),u=l(u,i,n,o,e[d+15],10,-30611744),o=l(o,u,i,n,e[d+6],15,-1560198380),n=l(n,o,u,i,e[d+13],21,1309151649),i=l(i,n,o,u,e[d+4],6,-145523070),u=l(u,i,n,o,e[d+11],10,-1120210379),o=l(o,u,i,n,e[d+2],15,718787259),n=l(n,o,u,i,e[d+9],21,-343485551),i=c(i,h),n=c(n,p),o=c(o,m),u=c(u,f)}return Array(i,n,o,u)}function o(e,t,i,n,o,s){return c(u(c(c(t,e),c(n,s)),o),i)}function s(e,t,i,n,s,a,r){return o(t&i|~t&n,e,t,s,a,r)}function a(e,t,i,n,s,a,r){return o(t&n|i&~n,e,t,s,a,r)}function r(e,t,i,n,s,a,r){return o(t^i^n,e,t,s,a,r)}function l(e,t,i,n,s,a,r){return o(i^(t|~n),e,t,s,a,r)}function c(e,t){var i=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(i>>16);return n<<16|65535&i}function u(e,t){return e<<t|e>>>32-t}var d=i(695);e.exports=function(e){return d.hash(e,n,16)}},function(e,t,i){(function(t){function i(e,i){if(e.length%s!==0){var n=e.length+(s-e.length%s);e=t.concat([e,a],n)}for(var o=[],r=i?e.readInt32BE:e.readInt32LE,l=0;l<e.length;l+=s)o.push(r.call(e,l));return o}function n(e,i,n){for(var o=new t(i),s=n?o.writeInt32BE:o.writeInt32LE,a=0;a<e.length;a++)s.call(o,e[a],4*a,!0);return o}function o(e,o,s,a){t.isBuffer(e)||(e=new t(e));var l=o(i(e,a),e.length*r);return n(l,s,a)}var s=4,a=new t(s);a.fill(0);var r=8;e.exports={hash:o}}).call(t,i(682).Buffer)},function(e,t,i){(function(t){function i(e,t,i){return e^t^i}function n(e,t,i){return e&t|~e&i}function o(e,t,i){return(e|~t)^i}function s(e,t,i){return e&i|t&~i}function a(e,t,i){return e^(t|~i)}function r(e,t){return e<<t|e>>>32-t}function l(e){var i=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof e&&(e=new t(e,"utf8"));var n=f(e),o=8*e.length,s=8*e.length;n[o>>>5]|=128<<24-o%32,n[(o+64>>>9<<4)+14]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8);for(var a=0;a<n.length;a+=16)_(i,n,a);for(var a=0;a<5;a++){var r=i[a];i[a]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var l=g(i);return new t(l)}e.exports=l;/** @preserve
	(c) 2012 by Cdric Mesnil. All rights reserved.
	
	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
	
	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
	
	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/
var c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],d=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],h=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],p=[0,1518500249,1859775393,2400959708,2840853838],m=[1352829926,1548603684,1836072691,2053994217,0],f=function(e){for(var t=[],i=0,n=0;i<e.length;i++,n+=8)t[n>>>5]|=e[i]<<24-n%32;return t},g=function(e){for(var t=[],i=0;i<32*e.length;i+=8)t.push(e[i>>>5]>>>24-i%32&255);return t},_=function(e,t,l){for(var f=0;f<16;f++){var g=l+f,_=t[g];t[g]=16711935&(_<<8|_>>>24)|4278255360&(_<<24|_>>>8)}var v,y,b,w,M,T,C,I,A,S;T=v=e[0],C=y=e[1],I=b=e[2],A=w=e[3],S=M=e[4];for(var E,f=0;f<80;f+=1)E=v+t[l+c[f]]|0,E+=f<16?i(y,b,w)+p[0]:f<32?n(y,b,w)+p[1]:f<48?o(y,b,w)+p[2]:f<64?s(y,b,w)+p[3]:a(y,b,w)+p[4],E=0|E,E=r(E,d[f]),E=E+M|0,v=M,M=w,w=r(b,10),b=y,y=E,E=T+t[l+u[f]]|0,E+=f<16?a(C,I,A)+m[0]:f<32?s(C,I,A)+m[1]:f<48?o(C,I,A)+m[2]:f<64?n(C,I,A)+m[3]:i(C,I,A)+m[4],E=0|E,E=r(E,h[f]),E=E+S|0,T=S,S=A,A=r(I,10),I=C,C=E;E=e[1]+b+A|0,e[1]=e[2]+w+S|0,e[2]=e[3]+M+T|0,e[3]=e[4]+v+C|0,e[4]=e[0]+y+I|0,e[0]=E}}).call(t,i(682).Buffer)},function(e,t,i){(function(t){function n(e,i){if(!(this instanceof n))return new n(e,i);this._opad=l,this._alg=e;var a="sha512"===e?128:64;i=this._key=t.isBuffer(i)?i:new t(i),i.length>a?i=o(e).update(i).digest():i.length<a&&(i=t.concat([i,s],a));for(var r=this._ipad=new t(a),l=this._opad=new t(a),c=0;c<a;c++)r[c]=54^i[c],l[c]=92^i[c];this._hash=o(e).update(r)}var o=i(688),s=new t(128);s.fill(0),e.exports=n,n.prototype.update=function(e,t){return this._hash.update(e,t),this},n.prototype.digest=function(e){var t=this._hash.digest();return o(this._alg).update(this._opad).update(t).digest(e)}}).call(t,i(682).Buffer)},function(e,t,i){var n=i(699);e.exports=function(e,t){t=t||{};var i=n(e);return t.pbkdf2=i.pbkdf2,t.pbkdf2Sync=i.pbkdf2Sync,t}},function(e,t,i){(function(t){e.exports=function(e){function i(e,t,i,o,s,a){if("function"==typeof s&&(a=s,s=void 0),"function"!=typeof a)throw new Error("No callback provided to pbkdf2");setTimeout(function(){var r;try{r=n(e,t,i,o,s)}catch(l){return a(l)}a(void 0,r)})}function n(i,n,o,s,a){if("number"!=typeof o)throw new TypeError("Iterations not a number");if(o<0)throw new TypeError("Bad iterations");if("number"!=typeof s)throw new TypeError("Key length not a number");if(s<0)throw new TypeError("Bad key length");a=a||"sha1",t.isBuffer(i)||(i=new t(i)),t.isBuffer(n)||(n=new t(n));var r,l,c,u=1,d=new t(s),h=new t(n.length+4);n.copy(h,0,0,n.length);for(var p=1;p<=u;p++){h.writeUInt32BE(p,n.length);var m=e.createHmac(a,i).update(h).digest();if(!r&&(r=m.length,c=new t(r),u=Math.ceil(s/r),l=s-(u-1)*r,s>(Math.pow(2,32)-1)*r))throw new TypeError("keylen exceeds maximum length");m.copy(c,0,0,r);for(var f=1;f<o;f++){m=e.createHmac(a,i).update(m).digest();for(var g=0;g<r;g++)c[g]^=m[g]}var _=(p-1)*r,v=p==u?l:r;c.copy(d,_,0,v)}return d}return{pbkdf2:i,pbkdf2Sync:n}}}).call(t,i(682).Buffer)},function(e,t,i){function n(){this.linksToReplace=[],this.previousLinks=[]}function o(e){var t=[],i=e.isItemInstance;if(i)for(var n=0;n<e.effects.length;n++){var o=e.effects[n];o&&t.push(o.serialize())}return{_type:"ObjectItem",position:i?e.position:0,objectGID:i?e.objectGID:e.id,objectUID:i?e.objectUID:0,effects:t,quantity:i?e.quantity:1}}var s=i(29).getText,a=i(277),r="";e.exports=n,n.OBJ_REPL_CHAR=r,n.prototype.newLinkForSending=function(e,t){var i,n,o;switch(e){case"recipe":i="["+s("ui.common.recipes",1)+s("ui.common.colon")+t.getName()+"]",n="{recipe,"+t.getProperty("id")+"}";break;case"itemStats":if(this.linksToReplace.length>=a.MAX_CHAT_OBJECT_REF)return;i="["+t.getName()+"]",n=r,o=t;break;default:return console.error(new Error("Invalid link type: "+e))}return this.linksToReplace.push([i,n,o]),i},n.prototype.prepareForSending=function(e,t){for(var i=0;i<this.linksToReplace.length;i++){var n=this.linksToReplace[i],s=e.replace(n[0],n[1]);n[2]&&s!==e&&t.push(o(n[2])),e=s}return this.previousLinks=this.linksToReplace,this.linksToReplace=[],e},n.prototype.undoPrepareForSending=function(){this.linksToReplace=this.previousLinks},n.prototype.replaceLinksReceived=function(e,t){for(var i=0;i<t.length;i++){var n=t[i],o="{itemStats,"+n.objectGID+","+n.objectUID+"}";e=e.replace(r,o)}return e}},function(e,t,i){function n(){this._whoIsMap={},this._setEventListeners()}var o=i(412),s=i(669),a=i(702),r=i(203),l="#{",c="}",u=",",d=2e3;e.exports=n,n.prototype.processMsg=function(e,t){if(e.channel!==o.PSEUDO_CHANNEL_PRIVATE)return!1;var i=e.content;if(i.substr(0,l.length)!==l)return!1;if(i.substr(i.length-c.length)!==c)return!1;if(t)return!0;var n=i.substring(l.length,i.length-c.length),s=n.split(u);switch(s[0]){case"rejoinRequest":var a=parseInt(s[1],10);window.gui.playerData.partyData.handleRejoinRequest(a,e.senderId);break;default:window.dofus.sendMessage("IgnoredAddRequestMessage",{name:e.senderName,session:!0}),console.error("Ignoring player "+e.senderName+" who sent invalid p2p command: "+e.content)}return!0},n.prototype.sendMsg=function(e,t){for(var i=l+t,n=2;n<arguments.length;n++)i+=u+arguments[n].toString();i+=c,s.sendMessage(i,o.PSEUDO_CHANNEL_PRIVATE,e)},n.prototype.checkPlayerOnline=function(e,t){var i=this._whoIsMap[e];i?i.cbs.push(t):(window.dofus.sendMessage("BasicWhoIsRequestMessage",{search:e,verbose:!1}),this._whoIsMap[e]={cbs:[t],timeout:r.setTimeout(this._playerOnlineHandler.bind(this,e,!1),d)})},n.prototype._playerOnlineHandler=function(e,t){var i=this._whoIsMap[e];delete this._whoIsMap[e],r.clearTimeout(i.timeout);for(var n=i.cbs,o=0;o<n.length;o++)n[o](e,t)},n.prototype._setEventListeners=function(){var e=this;window.gui.on("disconnect",function(){e._whoIsMap={}}),window.dofus.connectionManager.on("BasicWhoIsMessage",function(t){t.verbose||e._whoIsMap[t.playerName]&&e._playerOnlineHandler(t.playerName,t.playerState!==a.NOT_CONNECTED)})}},function(e,t){e.exports={NOT_CONNECTED:0,GAME_TYPE_ROLEPLAY:1,GAME_TYPE_FIGHT:2,UNKNOWN_STATE:99}},function(e,t,i){var n=i(29).getText,o=i(704),s=i(702);e.exports=function(e){var t;t=e.areaId!==-1?e._areaName:n("ui.common.unknowArea");var i="{player,"+e.playerName+","+e.playerId+"}";e.position===o.MODERATOR?i+='(<span class="position mod">'+n("ui.common.moderator")+"</span>)":e.position===o.GAMEMASTER_PADAWAN?i+='(<span class="position gma">'+n("ui.common.gameMasterAssistant")+"</span>)":e.position===o.GAMEMASTER?i+='(<span class="position gm">'+n("ui.common.gameMaster")+"</span>)":e.position===o.ADMIN&&(i+='(<span class="position admin">'+n("ui.common.administrator")+"</span>)");var a=n("ui.common.whois",e.accountNickname,i,t);if(e.socialGroups&&e.socialGroups.length>0)for(var r=0,l=e.socialGroups.length;r<l;r+=1){var c=e.socialGroups[r];"GuildInformations"===c._type&&(a+=" "+n("ui.common.guild")+" {guild,"+c.guildId+"::"+c.guildName+"}"),"AllianceInformations"===c._type&&(a+=" "+n("ui.common.alliance")+" {alliance,"+c.allianceId+"::["+c.allianceTag+"]}")}return e.playerState===s.NOT_CONNECTED&&(a+=" ("+n("tablet.common.disconnected")+")"),a}},function(e,t){e.exports={UNAVAILABLE:-1,PLAYER:0,MODERATOR:10,GAMEMASTER_PADAWAN:20,GAMEMASTER:30,ADMIN:40}},function(e,t,i){function n(e,t){function i(t){if(!h&&r("RESIZE",e)){h=!0,p.w=f.w=e.rootElement.clientWidth,p.h=f.h=e.rootElement.clientHeight;var i=a(t);m.x=i.x,m.y=i.y,e.emit("resizeStart"),window.gui.wBody.once("dom.touchend",s),window.gui.wBody.on("dom.touchmove",n),n(t)}}function n(t){var i=a(t),n=i.x-m.x,s=i.y-m.y;g&&(n=0),f.w=p.w+n,f.h=p.h+s,f.w=Math.min(Math.max(f.w,u),o.windowFullScreenWidth),f.h=Math.min(Math.max(f.h,d),o.windowFullScreenHeight),e.setStyles({width:f.w+"px",height:f.h+"px"})}function s(){window.gui.wBody.removeListener("dom.touchmove",n),h=!1,e.windowWidth=f.w,e.windowHeight=f.h,e.emit("resize")}t=t||{};var u=t.minWidth||l,d=t.minHeight||c;e.resizeHandle=e.createChild("div",{className:"resizeHandle"}),e.resizeHandle.allowDomEvents();var h=!1,p={w:null,h:null},m={x:null,y:null},f={w:null,h:null},g=!1;e.setWidthLock=function(e){g=!!e},e.resizeHandle.on("dom.touchstart",i)}i(706);var o=i(183).dimensions,s=i(229),a=s.getPosition,r=i(231).requestInteractionHandle,l=300,c=300;e.exports=n},function(e,t){},function(e,t,i){function n(e){for(var t=["&","%","?","#","","!"],i=t.length,n="",o=0;o<e;o++){var s=Math.floor(Math.random()*i);n+=t[s]}return n}function o(){var e=this;this.censoredMap={},s.getAllDataMap("CensoredWords",function(t,i){t&&console.error("Censor getAllDataMap:",t);var n=window.Config.language;for(var o in i)i[o].language===n&&(e.censoredMap[i[o].word]=!0)})}var s=i(30),a=i(195);e.exports=o,o.prototype.filterCensoredWords=function(e){if(!a.getValue("option-censorship",!0))return e;for(var t=e.split(" "),i=0;i<t.length;i++)this.censoredMap[t[i].toLowerCase()]&&(t[i]=n(t[i].length));return t.join(" ")}},function(e,t,i){function n(){r.call(this,"div",{className:"ChatButton"});var e=this,t=this.createChild("div",{className:"buttonChatPicto"}),i=this.button=t.appendChild(new l({className:"buttonChatTouchZone",scaleOnPress:!1},function(){window.gui.chat.active?window.gui.chat.deactivate():window.gui.chat.activate()}));i.on("tapstart",function(){e.addClassNames("pressed")}),i.on("tapend",function(){e.delClassNames("pressed")}),window.gui.on("resize",function(){if(this.ipadRatio)e.setStyles({left:s.posChatBtn+"px",right:"auto",top:"auto",bottom:0,width:o.CHAT_BTN_MIN_WIDTH+"px",height:s.bottomBarHeight+"px"});else{var t,i;t=s.sideBarWidth-o.PING_EMOTE_BTN_WIDE_MIN_WIDTH,i=o.PING_EMOTE_BTN_WIDE_MIN_WIDTH,e.setStyles({left:"auto",right:i+"px",top:s.posChatBtn+"px",bottom:"auto",width:t+"px",height:o.CHAT_BTN_MIN_HEIGHT+"px"})}})}i(709);var o=i(184),s=i(183).dimensions,a=i(191).inherits,r=i(235),l=i(246);a(n,r),e.exports=n},function(e,t){},function(e,t,i){function n(e){var t=e.role,i=c.setupNames(e.otherId,e.initiatorId);return i?(d=i.sourceName,h=i.targetName,c.setupCancelPopupTexts({title:l("ui.common.exchange"),message:l("ui.craft.waitForCraftClient",h)}),t===r.MULTICRAFT_CUSTOMER?c.setupConfirmPopupTexts({title:l("ui.common.exchange"),message:l("ui.craft.CrafterAskCustomer",d)}):t===r.MULTICRAFT_CRAFTER&&c.setupConfirmPopupTexts({title:l("ui.common.exchange"),message:l("ui.craft.CustomerAskCrafter",d)}),void c.askingExchangePopup()):console.error("MultiCraft: setupNames")}function o(e){var t=e.skillId,i=window.gui.playerData.jobs;i.prepareSkillRecipes(t,function(n){if(n)return console.error("Craft: prepareSkillRecipes",t,n);var o=i.getCraftType(t),s="craftMagus"===o?"craftMagus":"crafting";u.openDialog([s,"craftInventory"],{type:o,msg:e})})}function s(e,t){var i=e.skillId,n=window.gui.playerData.jobs;n.prepareSkillRecipes(i,function(o){if(o)return console.error("MultiCraft: prepareSkillRecipes",i,o);var s=n.getCraftType(i),a="craftMagus"===s?"craftMagusMulti":"craftingMulti";u.continueDialog([a,"craftInventory"],{type:s,isCrafter:t.isCrafter,sourceName:d,targetName:h,msg:e})})}var a=i(711),r=i(280),l=i(29).getText,c=i(712),u=i(225);t.SMITHMAGIC_RUNE_ID=78,t.SMITHMAGIC_POTION_ID=26,t.SIGNATURE_RUNE_ID=7508,t.SIGNATURE_AVAILABLE_LEVEL=100;var d="",h="";t.initialize=function(e){e.on("ExchangeOkMultiCraftMessage",n),e.on("ExchangeStartOkCraftWithInformationMessage",o),e.on("ExchangeStartOkMulticraftCrafterMessage",function(e){s(e,{isCrafter:!0})}),e.on("ExchangeStartOkMulticraftCustomerMessage",function(e){s(e,{isCrafter:!1})})},t.displayAutoCraftStopReasonMessage=function(e){var t="",i=!0;switch(e){case a.STOPPED_REASON_OK:t=l("ui.craft.autoCraftStopedOk");break;case a.STOPPED_REASON_USER:t=l("ui.craft.autoCraftStoped"),i=!1;break;case a.STOPPED_REASON_MISSING_RESSOURCE:t=l("ui.craft.autoCraftStopedNoRessource");break;case a.STOPPED_REASON_IMPOSSIBLE_CRAFT:t=l("ui.craft.autoCraftStopedInvalidRecipe")}var n=window.gui;i&&n.openSimplePopup(t,l("ui.popup.information")),t&&n.chat.logMsg(t)}},function(e,t){e.exports={STOPPED_REASON_OK:1,STOPPED_REASON_USER:2,STOPPED_REASON_MISSING_RESSOURCE:3,STOPPED_REASON_IMPOSSIBLE_CRAFT:4}},function(e,t,i){function n(e){function t(){var t={title:s.title,message:s.message,cb:function(){r&&r()}};h.getWindow("cancel").update(t,{keepDialog:e}),h.openDialog(["cancel"])}function i(){var t={title:o.title,message:o.message,cb:function(e){e===n.NO?a.refuse&&a.refuse():e===n.IGNORE?a.ignore&&a.ignore():a.confirm&&a.confirm()}};h.getWindow("confirm").update(t,{ignoreEnable:!0,keepDialog:e}),h.openDialog(["confirm"])}var n=h.getWindow("confirm").actionsEnum;d?t():i()}var o,s,a,r,l,c,u,d,h=i(225);t.askingExchangePopup=function(){a={confirm:function(){window.dofus.sendMessage("ExchangeAcceptMessage")},refuse:void 0,ignore:function(){window.dofus.sendMessage("IgnoredAddRequestMessage",{name:l,session:!0})}},r=void 0,n(!0)},t.askingChallengePopup=function(e){function t(){window.dofus.sendMessage("GameRolePlayPlayerFightFriendlyAnswerMessage",{fightId:e,accept:!0})}function i(){window.dofus.sendMessage("GameRolePlayPlayerFightFriendlyAnswerMessage",{fightId:e,accept:!1})}function o(){i(),window.dofus.sendMessage("IgnoredAddRequestMessage",{name:l,session:!0})}a={confirm:t,refuse:i,ignore:o},r=i,n(!1)},t.closingChallengePopup=function(e){var t=e?"cancel":"confirm",i=h.getWindow(t);h.close(i.id)},t.setupCancelPopupTexts=function(e){s=e},t.setupConfirmPopupTexts=function(e){o=e},t.setupNames=function(e,t){var i=window.gui.playerData;c=i.id,u=i.characterBaseInformations.name,d=t===c;var n=window.actorManager.getActor(d?e:t);if(!n)return null;var o=n.data.name;l=d?u:o;var s=d?o:u;return{sourceName:l,targetName:s}}},function(e,t,i){function n(){a.call(this,"div",{className:"TextNotification"});var e=this;window.gui.on("resize",function(){e.setStyles({left:o.mapLeft+l+"px",bottom:o.screenHeight-o.mapBottom+l+"px"})}),this.mutedChannelsId={};for(var t in c)this.mutedChannelsId[r[t]]=!0}i(714);var o=i(183).dimensions,s=i(191).inherits,a=i(235),r=i(412),l=10,c={PSEUDO_CHANNEL_FIGHT_LOG:!0};s(n,a),e.exports=n,n.prototype.add=function(e,t){function i(e){e.delClassNames("on"),setTimeout(function(){e.destroy()},300)}t=t||{};var n=this.createChild("div",{className:"bubble"}),o=n.createChild("div",{className:"bubbleText"});n.addClassNames(t.className);var s=t.channel;void 0===s&&(s=r.PSEUDO_CHANNEL_INFO),n.addClassNames("channel"+s),"object"==typeof e?o.appendChild(e):o.setHtml(e.toString()),setTimeout(function(){n.addClassNames("on")},50),setTimeout(function(){n.rootElement&&i(n)},7e3)}},function(e,t){},function(e,t,i){function n(e){o.getAllDataMap(s,function(t,i){return t?e(t):(window.gui.databases=i,void e())})}var o=i(30),s=["AlignmentGift","AlignmentRankJntGift","AlignmentSides","AlmanaxCalendars","Areas","BidHouseCategories","Breeds","ChatChannels","Incarnation","IncarnationLevels","ItemTypes","Months","MountBehaviors","OptionalFeatures","QuestObjectiveTypes","RankNames","ShieldModelsLevels","Smileys","SpellStates","SpellTypes","SuperAreas","ToaRank","TypeActions","WorldMaps"];e.exports.load=n},function(e,t,i){function n(){c.open("market",{tabId:"shop"})}function o(){d.call(this,"div",{className:"shopFloatingToolbar"}),this._isTutorial=!1,r(this,{grip:this});var e=this._shopBtnTap.bind(this);this.appendChild(new s({className:"shopBtn"},e));var t=this,i=window.gui;i.once("resize",function(){t.setStyles({left:Math.round(a.mapRight/3*2)+"px",top:"0px"})}),i.on("connected",function(){t.show()}),i.on("disconnect",function(){t.hide()}),i.fightManager.on("fightStart",function(){t.hide()}),i.fightManager.on("fightEnd",function(){t.show()})}i(717);var s=i(246),a=i(183).dimensions,r=i(658),l=i(191).inherits,c=i(225),u=i(7),d=i(235),h=i(718);l(o,d),e.exports=o,o.prototype._shopBtnTap=function(){if(this._isTutorial)window.gui.tutorialManager.openTheTutorialShop(),this._stopTutorial();else{n();var e=this.rootElement.getBoundingClientRect();u.log("HUD.Click_on_button",{interface_id:"ShopFloatingToolbar",button_id:"BTN_IG_SHOP",clic_parameter_key:"position",clic_parameter_value:~~e.left+","+~~e.top,clic_type:"Simple_court"})}},o.prototype.startTutorial=function(){this._hintArrow||(this._hintArrow=this.appendChild(new h)),this._isTutorial=!0,this.show(),this._hintArrow.showArrow(30,40)},o.prototype._stopTutorial=function(){this._isTutorial=!1,this._hintArrow.hideArrow(),this._hintArrow.clearContent(),this._hintArrow=null}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"HintArrow",hidden:!0}),this.arrow=this.createChild("div",{className:"arrow"})}i(719);var o=i(191).inherits,s=i(235);o(n,s),e.exports=n,n.prototype.showArrow=function(e,t,i){i=i||"downRight",this.arrow.setClassNames(["arrow",i]),this.setStyles({left:e+"px",top:t+"px"}),this.show()},n.prototype.hideArrow=function(){this.hide()}},function(e,t){},function(e,t,i){function n(){s.call(this);var e=this,t=window.gui,i=t.playerData,n=i.position;this._init(),a.init(this),c.init(),t.on("connected",this._onConnect.bind(this)),t.on("disconnect",this._onDisconnect.bind(this)),n.on("worldMapUpdate",function(){e._changeMap(this.worldmapId)}),n.on("mapUpdate",function(){e._delayedPois.length&&e._addDelayedPois(),(i.isFighting||t.tutorialManager.inTutorial)&&e._compass.setAllMarkersVisibility(!1),e._scheduleRendering()}),t.fightManager.on("fightStart",function(){e._compass.setAllMarkersVisibility(!1),e._scheduleRendering()}),t.fightManager.on("fightEnd",function(){e._startQuietAnimationPeriod(3e3),e._compass.setAllMarkersVisibility(!0)}),d.on("autoGpsPhoenixes",function(){e._compass.showOrHidePhoenixMarkers()})}function o(e,t){u.getObject("MapPositions",e,function(i,n){return i?t("GPS cannot load MapPositions for map "+e+": "+i):n.subAreaId?void u.getObject("SubAreas",n.subAreaId,function(i,o){if(i)return t("GPS cannot load subarea "+n.subAreaId+": "+i);var s,a=o.entranceMapIds||[],r=o.exitMapIds||[],l=window.gui.databases,c=l.Areas[o.areaId],d=l.SuperAreas[c.superAreaId],h=o.customWorldMap[0]||d.worldmapId,p=window.gui.playerData.position.worldmapId;return p!==h&&(s=p===f?a[0]:r[0]),void 0===s?t(null,{x:n.posX,y:n.posY,mapId:e}):void u.getObject("MapPositions",s,function(e,i){return e?t("GPS cannot load MapPositions fo map "+s+": "+e):void t(null,{x:i.posX,y:i.posY,mapId:s})})}):t(null,{x:n.posX,y:n.posY,mapId:e})})}var s=i(209).EventEmitter,a=i(721),r=i(191).inherits,l=i(723),c=i(724),u=i(30),d=i(190),h=i(29).getText,p=i(203),m=i(725),f=1,g=2,_=12,v="fixed",y=100;r(n,s),n.prototype._init=function(){this._POIMap={},this._POIMap[v]={},this._lastPhoenixes=[],this._delayedPois=[],this._isRenderingRequested=!1,this._waitingPoiCount=0,this._interval=null,this._nextRenderTime=0,this._compass=window.gui.compass},n.prototype._onConnect=function(){this._init()},n.prototype._onDisconnect=function(){this._removeAllPois(),p.clearInterval(this._interval),this._interval=null},n.prototype._startQuietAnimationPeriod=function(e){this._compass.setFlashyAnimationEnabled(!1),p.setTimeout(this._compass.setFlashyAnimationEnabled.bind(this._compass,!0),e)},n.prototype._requestUpdatePOI=function(e,t,i,n){e.x===t&&e.y===i||(e.x=t,e.y=i,n&&(e.nameId=n),e.isDestination&&this._compass.updateMarker(e.id,e.x,e.y,e.nameId),this.emit("updatePOI",e))},n.prototype.updatePOI=function(e){this._updatePOI(e),this._scheduleRendering()},n.prototype._updatePOI=function(e){var t=e.id,i=e.x,n=e.y,o=e.nameId,s=window.gui.playerData.position.worldmapId,a=this._getPOI(t,s);if(a)this._requestUpdatePOI(a,i,n,o);else{if(void 0===i&&void 0===n)return console.error("unexpected undefined x,y");delete e.mapId,this._addPOI(e)}},n.prototype._setTrackingEnabled=function(e,t){t?this._compass.addMarker({type:e.id,x:e.x,y:e.y,arrowType:e.categoryId,tooltip:e.nameId}):this._compass.removeMarker(e.id)},n.prototype._requestGuildInfo=function(){if(window.gui.playerData.guild.hasGuild())for(var e in m){var t=m[e];window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:t})}},n.prototype._removeAllPois=function(){for(var e in this._POIMap){var t=this._POIMap[e];for(var i in t)this._removePOI(i,e)}},n.prototype._isDungeonMap=function(e){return e!==g&&e!==f&&e!==_},n.prototype._addDelayedPois=function(){for(var e=this._delayedPois.length,t=0;t<e;t++){var i=this._delayedPois.shift();this._addPOI(i)}this._scheduleRendering()},n.prototype._scheduleRendering=function(){this._nextRenderTime=Date.now()+y,this._isRenderingRequested=!0,this._interval||(this._interval=p.setInterval(this._renderTick.bind(this),y))},n.prototype._renderTick=function(){this._isRenderingRequested&&(this._waitingPoiCount>0||Date.now()<this._nextRenderTime||(this._isRenderingRequested=!1,this._compass.renderAllMarkers()))},n.prototype.addPOI=function(e){this._addPOI(e),this._scheduleRendering()},n.prototype._addPOI=function(e){if(0===window.gui.playerData.position.worldmapId)return void this._delayedPois.push(e);if(e.mapId){this._waitingPoiCount++;var t=this;u.getObject("MapPositions",e.mapId,function(i,n){return t._waitingPoiCount--,i?console.error("No MapPosition for POI at "+e.mapId+"; "+i):void t._addPoiSync(e,n)})}else{var i;i="questObjective"===e.categoryId?f:window.gui.playerData.position.worldmapId,this._addPoiSync(e,{worldMap:i,posX:e.x,posY:e.y})}},n.prototype._addPoiSync=function(e,t){var i=t.posX,n=t.posY,o=window.gui.playerData.position.worldmapId,s=t.worldMap||o;if(s===-1&&(s=o),s===v)return console.error('worldMapId is "fixed"');var a=window.gui.databases.WorldMaps[s];if(!a)return console.error(new Error("WorldMap missing in DB:"+s));s=a.id,this._POIMap[s]||(this._POIMap[s]={});var r=this._POIMap[s][e.id];if(r)return this._requestUpdatePOI(r,i,n);var c=new l(e);c.x=i,c.y=n,c.worldMapId=s,this._POIMap[s][c.id]=c,c.isDestination&&this._addDestination(c),this.emit("addPOI",c)},n.prototype.addFlag=function(e,t,i){var n=this._compass.addMarker({type:e,x:t,y:i});return this._scheduleRendering(),n},n.prototype.removeFlag=function(e){this._compass.removeMarker({type:e}),this._scheduleRendering()},n.prototype.removePOI=function(e,t){if(void 0!==t)this._removePOI(e,t);else for(var i in this._POIMap)this._removePOI(e,i);this._scheduleRendering()},n.prototype._removePOI=function(e,t){var i=this._getPOI(e,t);i&&(i.isDestination&&this._removeDestination(i),delete this._POIMap[t][e],this.emit("removePOI",i),this._POIMap[v]&&delete this._POIMap[v][e])},n.prototype._changeMap=function(e){if(void 0!==e){this._isDungeonMap(e)||this._requestGuildInfo();var t,i;for(t in this._POIMap[v])i=this._POIMap[v][t],this._removePOI(t,this._lastWorldMapId),i.mapId=0,this._addPOI(i);var n=this._POIMap[this._lastWorldMapId];if(n)for(t in n)i=n[t],i.isDestination&&this._setTrackingEnabled(i,!1);var o=[];for(t in this._POIMap[e])i=this._POIMap[e][t],i.isDestination&&(this._setTrackingEnabled(i,!0),o.push(i.id));var s=this._compass;for(t in s.markers)o.indexOf(t)===-1&&s.removeMarker(t);this._scheduleRendering(),this.emit("changedMap",e),this._lastWorldMapId=e}},n.prototype._getPOI=function(e,t){var i=this._POIMap[t]||{};return i[e]},n.prototype.isActivePOI=function(e){for(var t in this._POIMap)if(this._POIMap[t][e])return!0;return!1},n.prototype.getPOIs=function(e){return e=e||window.gui.playerData.position.worldmapId,this._POIMap[e]||{}},n.prototype._addDestination=function(e){e.worldMapId===window.gui.playerData.position.worldmapId&&this._setTrackingEnabled(e,!0),this.emit("addDestination",e)},n.prototype._removeDestination=function(e){e.worldMapId===window.gui.playerData.position.worldmapId&&this._setTrackingEnabled(e,!1),this.emit("removeDestination",e)},n.prototype.getQuestObjectivePoiId=function(e){return"quest_"+e},n.prototype.addQuestObjectiveFromObjective=function(e){var t=e.objectiveDb,i=e.objectiveId,n=e.questId,s=e.coords||null,a=this,r=this.getQuestObjectivePoiId(i);if(!this.isActivePOI(r)){var l=t.mapId;if(!s){if(l)return o(l,function(e,o){return e?console.error("questId: "+n+", objectiveId: "+i+", error: "+e):(o=o||t.coords,void a.addQuestObjectiveFromObjective({objectiveDb:t,objectiveId:i,coords:o,questId:n}))});s=t.coords}if(s&&void 0!==s.x&&void 0!==s.y){for(var c=window.gui.playerData.quests.all[n],u=c.dbQuest.nameId,d="",h=0;h<c.objectives.length;h++){var p=c.objectives[h];if(p.objectiveId===i){d=p.text;break}}var m={id:r,x:s.x,y:s.y,mapId:l,nameId:u+"\n\n"+d+"\n\n("+s.x+","+s.y+")",categoryId:"questObjective",color:{r:148,g:185,b:35,a:1},isDestination:!0};this.addPOI(m)}}},n.prototype.addQuestObjective=function(e,t){var i=window.gui.playerData.quests;if(!i[e])return console.warn("GPS.addQuestObjective: quest id"+e+" is not active.");var n=i[e].dbObjectives[t];this.addQuestObjectiveFromObjective({objectiveDb:n,objectiveId:t,questId:e})},n.prototype.addQuestNextObjective=function(e){var t=window.gui.playerData.quests;if(!t.active[e])return console.warn("GPS.addQuestNextObjective: quest id"+e+" is not active.");for(var i=t.active[e],n=0;n<i.objectives.length;n++){var o=i.objectives[n];if(o.objectiveStatus){var s=o.objectiveId,a=i.dbObjectives[s];this.addQuestObjectiveFromObjective({objectiveDb:a,objectiveId:s,questId:e})}}},n.prototype.removeQuestObjectives=function(e){var t=window.gui.playerData.quests.all[e];if(!t)return console.warn("GPS.removeQuestObjectives: quest id"+e+" not found.");for(var i=0;i<t.objectives.length;i++){var n=t.objectives[i];if(n.objectiveStatus){var o=n.objectiveId,s=this.getQuestObjectivePoiId(o);this.removePOI(s)}}},n.prototype.addAllQuestsObjectives=function(){var e=window.gui.playerData.quests;for(var t in e.active)this.addQuestNextObjective(t)},n.prototype.addAllFollowedQuestsObjectives=function(){var e=window.gui.playerData.quests;for(var t in e.active)this.questFollower.isQuestFollowed(t)&&this.addQuestNextObjective(t)},n.prototype.isAtLeastOneQuestObjectiveFollowed=function(e){var t=window.gui.playerData.quests.active[e];if(!t)return console.warn("GPS.isAtLeastOneQuestObjectiveFollowed: quest id"+e+" not active."),!1;for(var i=0;i<t.objectives.length;i++){var n=t.objectives[i];if(n.objectiveStatus){var o=n.objectiveId,s=this.getQuestObjectivePoiId(o);if(this.isActivePOI(s))return!0}}return!1},n.prototype.addCustomFlag=function(e,t){this.addPOI({id:"customFlag_"+e+"_"+t,x:e,y:t,categoryId:"customFlag",nameId:h("ui.cartography.customFlag")+"\n\n("+e+","+t+")",color:{r:255,g:221,b:0,a:1},isDestination:!0})},n.prototype.removeCustomFlag=function(e,t){this.removePOI("customFlag_"+e+"_"+t)},n.prototype.addOrUpdateSpouse=function(e,t,i,n){this.addPOI({id:"spouse",categoryId:"spouse",nameId:h("ui.cartography.positionof",e),color:{r:255,g:0,b:137,a:1},mapId:null!==t?t:void 0,x:i,y:n,isDestination:!0})},n.prototype.removeSpouse=function(){this.removePOI("spouse")},n.prototype.autoGpsFlagOptionUpdate=function(){d.autoGpsFlags?this.addAllFollowedQuestsObjectives():(this._removeAllPois(),this._scheduleRendering())},n.prototype.questFollower=c,e.exports=n},function(e,t,i){function n(e){function t(t){var i={id:"house_"+t.houseId,mapId:t.mapId,categoryId:v,nameId:c("ui.common.myHouse"),iconId:m};e.addPOI(i)}function i(t){u.getData("Houses",t.modelId,function(i,n){if(i)return console.error(i);var o={id:"guild_house_"+t.houseId,mapId:t.mapId,categoryId:v,nameId:c("ui.common.guildHouse")+c("ui.common.colon")+n.nameId,iconId:f};e.addPOI(o)})}function n(t){var i={id:"guild_paddock_"+t.paddockId,mapId:t.mapId,categoryId:v,nameId:c("ui.guild.paddock",t.maxOutdoorMount),iconId:g};e.addPOI(i)}var o=window.gui;o.on("AccountHouseMessage",function(e){e.houses.forEach(function(e){t(e)})}),o.on("GuildHousesInformationMessage",function(e){e.housesInformations.forEach(function(e){i(e)})}),o.on("GuildHouseUpdateInformationMessage",function(e){i(e.housesInformations)}),o.on("GuildHouseRemoveMessage",function(t){e.removePOI("guild_house_"+t.houseId)}),o.on("GuildInformationsPaddocksMessage",function(e){e.paddocksInformations.forEach(function(e){n(e)})}),o.on("GuildPaddockBoughtMessage",function(e){n(e.paddockInfo)}),o.on("GuildPaddockRemovedMessage",function(t){e.removePOI("guild_paddock_"+t.paddockId)})}function o(e){l.on("AtlasPointInformationsMessage",function(t){if(t.type.type===h.ATLAS_INFOS_PHOENIX){var i;if(window.gui.playerData.isAlive())for(i=0;i<e._lastPhoenixes.length;i+=1)e.removePOI("phoenix_"+e._lastPhoenixes[i].mapId);else{var n=t.type.coords;for(i=0;i<n.length;i+=1){var o=n[i];b.indexOf(o.mapId)===-1&&e.addPOI({id:"phoenix_"+o.mapId,mapId:o.mapId,categoryId:"phoenix",x:o.worldX,y:o.worldY,nameId:c("ui.common.phoenix"),iconId:_,isDestination:!0})}e._lastPhoenixes=n}}})}function s(e){var t=window.gui,i=t.playerData.quests;i.on("objectiveValidated",function(t,i){e.removePOI(e.getQuestObjectivePoiId(i))}),i.on("stepValidated",function(t,i){for(var n=t.dbSteps[i],o=0;o<n.objectiveIds.length;o+=1)e.removePOI(e.getQuestObjectivePoiId(n.objectiveIds[o]))}),i.on("questFinished",function(t){for(var i=t.dbSteps[t.stepId],n=0;n<i.objectiveIds.length;n+=1)e.removePOI(e.getQuestObjectivePoiId(i.objectiveIds[n]))}),i.on("questUpdate",function(t){e.questFollower.isQuestFollowed(t)&&e.addQuestNextObjective(t)}),i.on("questStarted",function(t){d.autoGpsFlags&&e.questFollower.followQuest(t,!0)}),i.on("listUpdated",function(){e.addAllFollowedQuestsObjectives()})}function a(e){var t=window.gui;t.on("SpouseStatusMessage",function(i){if(i.hasSpouse){var n=t.playerData.socialData.spouse;n?n.followSpouse&&e.addOrUpdateSpouse(n.spouseName,n.mapId):t.once("SpouseInformationsMessage",function(t){n=t.spouse,n.followSpouse&&e.addOrUpdateSpouse(n.spouseName,n.mapId)})}else e.removeSpouse()})}function r(e){function t(t){switch(t.type){case p.COMPASS_TYPE_SPOUSE:var n=i.playerData.socialData.spouse;return n?e.addOrUpdateSpouse(n.spouseName,null,t.worldX,t.worldY):console.error("Spouse does not exist");case p.COMPASS_TYPE_PARTY:var o=i.party.getMemberById(i.party.currentParty.partyId,t.memberId);return o?(e._lastPartyMemberId=o.id,e.updatePOI({id:"party_"+o.id,x:t.worldX,y:t.worldY,categoryId:"user",nameId:c("ui.cartography.positionof",o.name)+"\n\n("+t.worldX+", "+t.worldY+")",color:{r:52,g:155,b:255,a:1},mapId:o.mapId,isDestination:!0})):void console.warn("Party member",t.memberId,"does not exist.");case p.COMPASS_TYPE_QUEST:return window.gui.chat.logMsg(c("tablet.cartography.flagUpdated",t.worldX,t.worldY)),e.updatePOI({id:"flag_srv"+t.type,x:t.worldX,y:t.worldY,categoryId:y,nameId:t.worldX+","+t.worldY,color:{r:85,g:136,b:0,a:1},mapId:window.gui.playerData.position.worldmapId,isDestination:!0});case"zaap":return e.updatePOI({id:"zaap",x:t.worldX,y:t.worldY,categoryId:"zaap",nameId:t.worldX+","+t.worldY,color:{r:150,g:199,b:221,a:1},mapId:window.gui.playerData.position.worldmapId,isDestination:!0});case"estate":return e.updatePOI({id:"estate",x:t.worldX,y:t.worldY,categoryId:"estate",nameId:t.name+" ("+t.worldX+","+t.worldY+")",color:{r:184,g:143,b:35,a:1},mapId:window.gui.playerData.position.worldmapId,isDestination:!0});case p.COMPASS_TYPE_SIMPLE:return e.addCustomFlag(t.worldX,t.worldY);default:return console.error("Unhandled CompassTypeEnum value:",t.type)}}var i=window.gui;i.on("CompassUpdateMessage",t),i.on("CompassUpdatePartyMemberMessage",t),i.on("CompassResetMessage",function(t){switch(t.type){case p.COMPASS_TYPE_SPOUSE:return e.removeSpouse();case p.COMPASS_TYPE_PARTY:e.removePOI("party_"+e._lastPartyMemberId);break;case p.COMPASS_TYPE_QUEST:e.removePOI("flag_srv"+t.type);break;default:e.removeFlag(t.type)}})}var l=i(271),c=i(29).getText,u=i(30),d=i(190),h=i(722),p=i(679),m="icon_1000",f="icon_1001",g="icon_1002",_="flag1",v=7,y="hint",b=[52428800,8390667,113902337,120066048,34476296];e.exports.init=function(e){
o(e),n(e),s(e),a(e),r(e)}},function(e,t){e.exports={ATLAS_INFOS_RESET:0,ATLAS_INFOS_UNKNOWN:1,ATLAS_INFOS_FLAG:2,ATLAS_INFOS_PHOENIX:3}},function(e,t){function i(e){e=e||{},this.id=e.id,this.categoryId=e.categoryId||"custom",this.x=e.x,this.y=e.y,this.nameId=e.nameId||"",this.color=e.color,this.color&&!Array.isArray(this.color)&&(this.color=[this.color.r/124,this.color.g/124,this.color.b/124,this.color.a]),this.data=e.data,this.isDestination=e.isDestination,this.iconId=e.iconId||n}var n="flag0";e.exports=i},function(e,t,i){var n=i(209).EventEmitter,o=i(191).inherits,s=i(195),a=function(){this.userPrefKey=null,this.followedQuests={}};o(a,n),a.prototype.init=function(){var e=this,t=window.gui;t.playerData.on("characterSelectedSuccess",function(){e.userPrefKey=t.playerData.id+"-followedQuests",e.followedQuests=s.getValue(e.userPrefKey,{})}),t.on("disconnect",this._clear)},a.prototype._clear=function(){this.userPrefKey=null,this.followedQuests={}},a.prototype._save=function(){s.setValue(this.userPrefKey,this.followedQuests)},a.prototype.followQuest=function(e,t){var i=window.gui,n=i.playerData.quests.active[e];return n?(this.followedQuests[e]=!0,this._save(),n.objectives?void(t&&i.GPS.addQuestNextObjective(e)):console.warn("followQuest: quest id "+e+" has no objectives")):console.warn("followQuest: quest id "+e+" is not active")},a.prototype.unfollowQuest=function(e,t){delete this.followedQuests[e],this._save(),t&&window.gui.GPS.removeQuestObjectives(e)},a.prototype.unfollowAllQuests=function(){var e=window.gui,t=e.playerData.quests.active;for(var i in t)e.GPS.removeQuestObjectives(i);this.followedQuests={},this._save()},a.prototype.isQuestFollowed=function(e){return!!this.followedQuests[e]},e.exports=new a},function(e,t){e.exports={INFO_GENERAL:1,INFO_MEMBERS:2,INFO_BOOSTS:3,INFO_PADDOCKS:4,INFO_HOUSES:5,INFO_TAX_COLLECTOR_GUILD_ONLY:6,INFO_TAX_COLLECTOR_ALLIANCE:7,INFO_TAX_COLLECTOR_LEAVE:8}},function(e,t,i){function n(){r.call(this,"",{className:"HouseMenuButton",hidden:!0});var e=this;this._reset(),this._icon=this.createChild("div",{className:"icon"}),this.on("tap",function(){e._updateToolTip(),window.gui.openContextualMenu("generic",e._tooltipParams)}),this._registerListeners()}function o(){c.open("guildHouseSetting"),window.dofus.sendMessage("HouseGuildRightsViewMessage")}function s(){c.open("padlock",{fromInside:!0})}i(727);var a=i(191).inherits,r=i(246).DofusButton,l=i(29).getText,c=i(225);a(n,r),e.exports=n,n.prototype._reset=function(){this._locked=!1,this._myHouse=null,this._onSale=!1,this._tooltipParams=null},n.prototype._registerListeners=function(){var e=this,t=window.gui,i=t.playerData,n=i.position;t.on("disconnect",function(){e._reset()}),n.on("myHouseNotification",function(t){t=t||{};var i=t.isInMyHouse,n=t.msg;return i?(e._myHouse=n.currentHouse,e._onSale=!!n.currentHouse.price,e._locked=n.currentHouse.isLocked,e._updateIcon(),void e.show()):(e.hide(),void e._reset())}),t.on("HousePropertiesMessage",function(t){var i=t.properties;e._tooltipParams&&e._myHouse&&e._myHouse.houseId===i.houseId&&(e._onSale=i.isOnSale,e._updateIcon())}),t.on("LockableStateUpdateHouseDoorMessage",function(t){e._tooltipParams&&e._myHouse&&e._myHouse.houseId===t.houseId&&(e._locked=t.locked,e._updateIcon())}),t.on("HouseSoldMessage",function(t){var n=t.buyerName;e._tooltipParams&&e._myHouse&&n===i.identification.nickname&&(e._myHouse.price=t.realPrice)})},n.prototype._updateIcon=function(){var e=this._locked?"locked":"";e=this._onSale?"onSale":e,this._icon.replaceClassNames(["onSale","locked"],e?[e]:[])},n.prototype._updateToolTip=function(){var e=this;this._tooltipParams={title:l("ui.house.homeOf",this._myHouse.ownerName),actions:[]};var t=l(this._onSale?"ui.common.changeHousePrice":"ui.common.sell");this._tooltipParams.actions.push({caption:t,cb:function(){var t=c.getWindow("houseBuySell");t.prepareDialog(e._myHouse),c.open("houseBuySell",{fromInside:!0,myHouse:e._myHouse})}});var i=l(this._locked?"ui.common.unlock":"ui.common.lock");this._tooltipParams.actions.push({caption:i,cb:s});var n=window.gui.playerData.guild;n.hasGuild()&&this._tooltipParams.actions.push({caption:l("ui.common.guildHouseConfiguration"),cb:o})}},function(e,t){},function(e,t,i){function n(){v.call(this,"div",{className:"KohBox",hidden:!0}),m(this),this.on("tap",function(){window.gui.windowsContainer.appendChild(this)}),this.once("show",function(){this._createDom()});var e=this;window.gui.on("KohUpdateMessage",function(t){e.show(),e._setCurrentState(t)}),this.isInProbation=!1,window.gui.on("UpdateSelfAgressableStatusMessage",function(t){switch(t.status){case r.AvA_ENABLED_AGGRESSABLE:e.isInProbation=!1;break;case r.AvA_PREQUALIFIED_AGGRESSABLE:e.isInProbation=!0}})}function o(e,t,i,n,o,s){var a=new v("div",{className:["side",t]});l(a,i);var r=new d({width:25,height:25});r.setValue(e.allianceEmblem,!0),l(r,e.allianceName+" ["+e.allianceTag+"]");var u=new v("div",{text:e.allianceTag});return m(u),u.on("tap",function(){c.openAllianceCard(e.allianceId)}),{side:a,emblem:r,tag:u,characters:s,maps:o,time:n}}i(729);var s,a,r=i(522),l=i(248).addTooltip,c=i(630),u=i(183).dimensions,d=i(469),h=i(29).getText,p=i(191).inherits,m=i(228),f=i(730).serverConstants,g=i(523),_=i(735),v=i(235),y=i(737);p(n,v),n.prototype._createDom=function(){function e(){w.replaceClassNames(["full"],["open"]),b="open"}var t=window.gui.serversData;s=t.sessionConstants[f.SERVER_CONST_KOH_WINNING_SCORE],a=Math.floor(t.sessionConstants[f.SERVER_CONST_KOH_DURATION]),this.setStyle("left",u.mapLeft+Math.floor(u.mapWidth/2)+"px");var i=this.createChild("div",{className:"displaySwitch"});i.createChild("div",{className:"arrow"});var n=this.createChild("div",{className:"mainBox"}),o=n.createChild("div",{className:"topBox"}),r=n.createChild("div",{className:"secondaryBox"});this.gauge=o.appendChild(new y(["green","blue","red"],380));var c=Math.floor(a/1e3/60),d=Math.floor(c/60)+":"+c%60,p=o.createChild("div",{className:"kohInfo"});l(p,h("ui.koh.tooltip.rules",s,d),{openOnTap:!0});var g=r.createChild("div",{className:"allianceBox"});this.table=g.appendChild(new _({colIds:["side","emblem","tag","characters","maps","time"],headerContent:["","",h("ui.common.alliance"),h("ui.short.characters"),h("ui.common.maps"),h("ui.common.time")]})),l(this.table.getHeaderCol("characters"),h("ui.koh.tooltip.members")),l(this.table.getHeaderCol("maps"),h("ui.koh.tooltip.maps")),l(this.table.getHeaderCol("time"),h("ui.koh.tooltip.time")),this.winnerInfo=g.createChild("div",{className:"info"});var v=r.createChild("div",{className:"statsBox"});this.winnerStats=v.createChild("div",{className:"winnerStats"}),l(this.winnerStats,h("ui.koh.tooltip.mapConquest")),this.myStats=v.createChild("div",{className:"myStats"}),l(this.myStats,h("ui.koh.tooltip.mapConquestForMyAlliance"));var b;m(i);var w=this;i.on("tap",function(){switch(b){case"open":w.replaceClassNames(["open"],["full"]),b="full";break;case"full":w.delClassNames("open","full"),b="close";break;case"close":e()}}),this.on("hide",e),e()},n.prototype._setCurrentState=function(e){var t=this;this.table.clearContent();for(var i=window.gui.playerData,n=i.alliance.current,a=i.position,r=g.entities.prism[a.subAreaId],l=r&&r.prism&&r.prism.alliance||n,u=0,d=0,p={mine:{weight:0,type:h("ui.alliance.myAlliance"),tooltip:""},defense:{weight:0,type:h("ui.alliance.allianceInDefense"),tooltip:""},attack:{weight:0,type:h("ui.alliance.allianceInAttack"),tooltip:""}},f=0,_=e.alliances.length;f<_;f+=1){var y=e.alliances[f],b=e.allianceNbMembers[f],w=e.allianceMatchScore[f],M=e.allianceRoundWeigth[f];u+=M;var T;T=y.allianceId===n.allianceId?"mine":y.allianceId===l.allianceId?"defense":"attack";var C=w+"/"+s,I=p[T];I.weight+=M,I.tooltip+=y.allianceName+" ["+y.allianceTag+"] ("+M+") : "+C+"\n",this.table.addRow(o(y,T,I.type,C,M,b),{weight:M}),e.allianceMatchScore[d]<w&&(d=f)}this.table.sort(function(e,t){return t.weight-e.weight}),u=u||1,p.mine.weight/=u,p.mine.tooltip+=p.mine.type,p.defense.weight/=u,p.defense.tooltip+=p.defense.type,p.attack.weight/=u,p.attack.tooltip+=p.attack.type,this.gauge.setValues([p.mine,p.defense,p.attack]);var A=e.alliances[d],S=e.allianceMatchScore[d];if(A&&S>=s)return this.winnerInfo.setText(h("ui.koh.win",A.allianceName)),this.winnerInfo.show(),void setTimeout(function(){t.winnerInfo.setText(""),t.hide()},6e4);var E=e.allianceMapWinner,x=e.allianceMapWinnerScore;this.winnerStats.clearContent();var L=a.coordinates;if(this.winnerStats.createChild("span",{text:h("ui.option.worldOption")+" ["+L.posX+", "+L.posY+"]"+h("ui.common.colon")}),0===x||this.isInProbation)this.winnerStats.createChild("span",{text:h("ui.common.neutral")});else if(""===E.allianceTag)this.winnerStats.createChild("span",{text:h("ui.koh.draw",x)});else{var N=this.winnerStats.createChild("span",{text:E.allianceTag,className:"link"});m(N),N.on("tap",function(){c.openAllianceCard(E.allianceId)}),this.winnerStats.appendChild(new v("span",{text:" "+x+" "+h("ui.short.points")}))}if(E.allianceId!==n.allianceId&&x>0&&!this.isInProbation){this.myStats.clearContent(),this.myStats.createChild("span",{text:"("});var O=this.myStats.createChild("span",{text:n.allianceTag,className:"link"});m(O),O.on("tap",function(){c.openAllianceCard(n.allianceId)}),this.myStats.appendChild(new v("span",{text:" "+e.allianceMapMyAllianceScore+" "+h("ui.short.points")+")"})),this.myStats.show()}else this.myStats.hide()},e.exports=n},function(e,t){},function(e,t,i){function n(e){return!!b[e]}function o(){a.call(this),this.serversRawData=[],this.serversWithMyCharacter=[],this.optionalFeatures={},this.connectedServerId=null,this.connectedServerData=null,this.sessionConstants={},this.settings={}}var s=i(271),a=i(194).EventEmitter,r=i(191).inherits,l=i(30),c=i(225),u=i(29).getText,d=i(282),h=i(731),p=i(732),m=i(202),f=i(733),g=i(184),_=i(189),v=6e4,y=!1,b={401:!0,402:!0,407:!0,403:!0,404:!0,405:!0,406:!0,408:!0,409:!0,410:!0,411:!0};e.exports=o,r(o,a),o.serverConstants={SERVER_CONST_TIME_BEFORE_DISCONNECTION:1,SERVER_CONST_KOH_DURATION:2,SERVER_CONST_KOH_WINNING_SCORE:3,SERVER_CONST_MINIMAL_TIME_BEFORE_KOH:4,SERVER_CONST_TIME_BEFORE_WEIGH_IN_KOH:5},o.prototype._continueSelectServer=function(e){var t=_();this.connectedServerId=e,this.connectedServerData=this._findServerById(e),t.dofus.accessGameServer(e,function(t){if(t)return console.error("accessGameServer serverId: "+e,t)}),this.failTimeout&&(console.warn("Clearing previous connection timeout from ServersData.selectServer"),t.clearTimeout(this.failTimeout));var i=this;this.failTimeout=t.setTimeout(function(){i._onSelectedServerRefused({serverId:e,serverStatus:h.STATUS_UNKNOWN,error:p.SERVER_CONNECTION_ERROR_NO_REASON})},v),t.gui.once("AuthenticationTicketAcceptedMessage",function(){t.clearTimeout(i.failTimeout),i.failTimeout=null})},o.prototype.selectServer=function(e){if(!e)return console.error(new Error("serverId is null")),void this._onSelectedServerRefused({});var t=this,i=_(),n=i.Config.preferredServerId;n&&n!==e?i.gui.openConfirmPopup({title:u("ui.server.confirmPreferredServerTitle"),message:u("ui.server.confirmPreferredServerMessage"),cb:function(i){i?t._continueSelectServer(e):d.goBackToSelectionOf("server")}}):t._continueSelectServer(e)},o.prototype.showServerSelectionUi=function(){this.serversWithMyCharacter.length>0?c.open("serverSelection",this.serversWithMyCharacter):c.open("serverSimpleSelection",this.serversRawData)},o.prototype._filterMyServersList=function(){this.serversWithMyCharacter=this.serversRawData.filter(function(e){return e&&e.charactersCount>0}),this.serversWithMyCharacter.sort(function(e,t){return t.date-e.date})},o.prototype.initialize=function(e){var t=this;e.on("disconnect",function(e){t.serversRawData=[],t.serversWithMyCharacter=[],t.optionalFeatures={},t.connectedServerId="disconnect"+e,t.connectedServerData=null,t.sessionConstants={},t.settings={}}),e.on("ServerStatusUpdateMessage",function(e){if(!e.server)return console.warn("WARN: ServerStatusUpdateMessage message have no server information");for(var i=e.server,n=!0,o=0,s=t.serversRawData.length;o<s;o+=1)if(i.id===t.serversRawData[o].id){t.serversRawData[o]=i,n=!1;break}n&&t.serversRawData.push(i),t._filterMyServersList(),t.emit("serversUpdate",i)}),e.on("SelectedServerRefusedMessage",function(e){t._onSelectedServerRefused(e)}),e.on("ServerOptionalFeaturesMessage",function(e){t.optionalFeatures={};for(var i=window.gui.databases.OptionalFeatures,n=0,o=e.features.length;n<o;n+=1){var s=e.features[n];t.optionalFeatures[i[s].keyword]=s}}),e.on("ServerSessionConstantsMessage",function(e){t.sessionConstants={};for(var i=e.variables,n=0,o=e.variables.length;n<o;n+=1)t.sessionConstants[i[n].id]=i[n].value}),e.on("ServerSettingsMessage",function(e){t.settings.serverCommunityId=e.community,t.settings.serverLang=e.lang,t.settings.serverGameType=e.gameType}),s.on("CharacterSelectedSuccessMessage",function(){t.staticContent=null}),s.on("AuthenticationTicketRefusedMessage",function(){t.failTimeout&&window.clearTimeout(t.failTimeout)})},o.prototype.onServerList=function(e){this.serversRawData=e.servers,this._filterMyServersList();var t=d.connectMethod,i="lastServer"===t||"lastCharacter"===t||"characterId"===t;if(i){var n=this.serversWithMyCharacter[0]||{},o=n.id;if(o&&n.status===h.ONLINE&&n.isSelectable)return this.selectServer(o)}this.showServerSelectionUi()},o.prototype.isFeatureActive=function(e){return this.optionalFeatures.hasOwnProperty(e)},o.prototype.syncServerStaticData=function(e){var t=this;if(this.staticContent)return e();var i=["Servers","ServerGameTypes","ServerPopulations","ServerCommunities"];l.getAllDataMap(i,function(i,n){return i?e(i):(t.staticContent={},t.staticContent.data=n.Servers,t.staticContent.gameTypes=n.ServerGameTypes,t.staticContent.populations=n.ServerPopulations,t.staticContent.communities=n.ServerCommunities,e())})},o.prototype.getAutoChosenServers=function(e){var t=this;this.syncServerStaticData(function(i){return i?e(i):void f(t.serversRawData,t.staticContent,_().gui.playerData.identification.communityId,e)})},o.prototype.pickUpOneServerForMe=function(){this.getAutoChosenServers(function(e,t){if(e)return window.gui.openSimplePopup(u("tablet.server.noServersForYourCommunity")),void(y||(console.error("pickUpOneServerForMe:",e),y=!0));var i=t[Math.floor(Math.random()*t.length)];i&&c.open("serverDetails",i)})},o.prototype._findServerById=function(e){for(var t=0;t<this.serversRawData.length;t++)if(e===this.serversRawData[t].id)return this.serversRawData[t];return null},o.prototype.getServerNameById=function(e){for(var t=0;t<this.serversRawData.length;t++)if(e===this.serversRawData[t].id)return this.serversRawData[t]._name;return e.toString()},o.prototype.getAllowedServerList=function(){for(var e=[],t=0;t<this.serversRawData.length;t++){var i=this.serversRawData[t];i.status!==h.ONLINE&&i.status!==h.SAVING&&i.status!==h.FULL||i.id===g.TOURNAMENT_PROD_SERVERID||e.push(i)}return e},o.prototype.getSelectableServerList=function(){for(var e=[],t=0;t<this.serversRawData.length;t++){var i=this.serversRawData[t];i.status===h.ONLINE&&i.isSelectable&&e.push(i)}return e},o.prototype.getSelectableServerNames=function(){var e=this.getSelectableServerList();if(0===e.length)return u("ui.common.none").toLowerCase();for(var t=e[0]._name,i=1;i<e.length;i++)t+=", "+e[i]._name;return t},o.prototype._onSelectedServerRefused=function(e){this.failTimeout&&window.clearTimeout(this.failTimeout);var t=this._findServerById(e.serverId);t&&(t.status=e.serverStatus);var i;switch(e.error){case p.SERVER_CONNECTION_ERROR_DUE_TO_STATUS:switch(i="Status",e.serverStatus){case h.OFFLINE:i+="Offline";break;case h.STARTING:i+="Starting";break;case h.NOJOIN:i+="Nojoin";break;case h.SAVING:i+="Saving";break;case h.STOPING:i+="Stoping";break;case h.FULL:i+="Full";break;default:i+="Unknown"}break;case p.SERVER_CONNECTION_ERROR_ACCOUNT_RESTRICTED:i="AccountRestricted";break;case p.SERVER_CONNECTION_ERROR_COMMUNITY_RESTRICTED:i="CommunityRestricted";break;case p.SERVER_CONNECTION_ERROR_LOCATION_RESTRICTED:i="LocationRestricted";break;case p.SERVER_CONNECTION_ERROR_SERVER_FULL:i="ServerFull";break;case p.SERVER_CONNECTION_ERROR_REGULAR_PLAYERS_ONLY:i="RegularPlayersOnly";break;default:i="NoReason"}var n;switch(i){case"AccountRestricted":n=u("ui.server.cantChoose.serverForbidden");break;case"CommunityRestricted":n=u("ui.server.cantChoose.communityRestricted");break;case"LocationRestricted":n=u("ui.server.cantChoose.locationRestricted");break;case"ServerFull":n=u("ui.server.cantChoose.serverFull");break;case"RegularPlayersOnly":n=u("ui.server.cantChoose.regularPlayerRestricted");break;case"StatusOffline":n=u("ui.server.cantChoose.serverDown");break;case"StatusStarting":n=u("ui.server.cantChoose.serverDown");break;case"StatusNojoin":n=u("ui.server.cantChoose.serverForbidden");break;case"StatusSaving":n=u("ui.server.cantChoose.serverSaving");break;case"StatusStoping":n=u("ui.server.cantChoose.serverDown");break;case"StatusFull":n=u("ui.server.cantChoose.serverFull")+"\n\n"+u("ui.server.serversAccessibles",this.getSelectableServerNames());break;case"NoReason":case"StatusUnknown":n=u("ui.popup.connectionFailed.text")}this.showServerSelectionUi(),window.gui.openSimplePopup(n)},o.getServerImage=function(e,t){var i=["gfx/illus/illu_0.png"];n(e)&&i.push("gfx/illus/illu_"+e+".png"),m.preloadImages(i,function(e){var i=e[0],n=e[1];return n&&"none"!==n?t(null,n):t(null,i)})},o.prototype.getMyServerName=function(){return this.connectedServerData&&this.connectedServerData._name},o.prototype.isTournamentServer=function(){var e=window.parseInt(this.connectedServerId,10);return e===g.TOURNAMENT_TEST_SERVERID||e===g.TOURNAMENT_PROD_SERVERID}},function(e,t){e.exports={STATUS_UNKNOWN:0,OFFLINE:1,STARTING:2,ONLINE:3,NOJOIN:4,SAVING:5,STOPING:6,FULL:7}},function(e,t){e.exports={SERVER_CONNECTION_ERROR_DUE_TO_STATUS:0,SERVER_CONNECTION_ERROR_NO_REASON:1,SERVER_CONNECTION_ERROR_ACCOUNT_RESTRICTED:2,SERVER_CONNECTION_ERROR_COMMUNITY_RESTRICTED:3,SERVER_CONNECTION_ERROR_LOCATION_RESTRICTED:4,SERVER_CONNECTION_ERROR_SERVER_FULL:5,SERVER_CONNECTION_ERROR_REGULAR_PLAYERS_ONLY:6}},function(e,t,i){"use strict";function n(){var e=l.tz.guess().split("/"),t=e[0],i=e[1];switch(t){case"US":t="America"}switch(i){case"Honolulu":case"Guam":t="America"}return t}function o(e,t){return"America"===e&&t.area===e||"America"!==e&&"America"!==t.area}function s(e,t,i){if(u.indexOf(e)===-1&&!i)return t;for(var s,a,r=n(),l=[],c=0;c<t.length;c+=1)s=t[c],a=s.staticData.server,o(r,a)&&l.push(s);return l}var a=i(734),r=i(731),l=i(45),c=i(184),u=[1,2];e.exports=function(e,t,i,n){function o(e){for(var t=-1,i=[],n=0,o=e.length;n<o;n+=1){var s=e[n],a=s.staticData.server;s.status===r.ONLINE&&t===-1&&(t=s.completion),a.nameId=a.nameId||"n/a",t!==-1&&a.populationId===t&&s.status===r.ONLINE&&a.nameId.indexOf("Test")===-1&&i.push(s)}return i}function l(e){e.completion!==a.COMPLETION_FULL&&h.push(e)}function u(e){e.completion!==a.COMPLETION_FULL&&p.push(e)}for(var d,h=[],p=[],m=[],f=0;f<e.length;f+=1){var g=e[f];if(g){var _=t&&t.data||{},v=_[g.id];if(v){switch(g.staticData||(g.staticData={}),g.staticData.server=v,g.id){case 401:case 402:v.area="America";case 406:g.completion=a.COMPLETION_AVERAGE,v.populationId=a.COMPLETION_AVERAGE;break;case 403:case 404:case 405:case 409:g.completion=a.COMPLETION_AVERAGE,v.populationId=a.COMPLETION_AVERAGE;break;case 407:case c.TOURNAMENT_TEST_SERVERID:case c.TOURNAMENT_PROD_SERVERID:g.completion=a.COMPLETION_FULL,v.populationId=a.COMPLETION_FULL}var y=v.communityId;900===g.id?d=g:i===y?l(g):(1!==i&&2!==i||1!==y&&2!==y||l(g),4!==i&&6!==i||4!==y&&6!==y||l(g),2!==y&&1!==y||u(g))}else console.warn("WARN: server",g.id,"has no staticContent")}}var b=!1;return 0===h.length&&(b=!0,h=h.concat(p)),h=s(i,h,b),0===h.length&&d&&l(d),h.sort(function(e,t){return e.completion-t.completion}),0===h.length?n("My community servers is empty, for userCommunity "+i):(m=o(h),0===m.length?n("Available servers is empty, for userCommunity "+i):n(null,m))}},function(e,t){e.exports={COMPLETION_RECOMANDATED:0,COMPLETION_AVERAGE:1,COMPLETION_HIGH:2,COMPLETION_COMING_SOON:3,COMPLETION_FULL:4}},function(e,t,i){function n(e){return e?(o.call(this,"div",e),this.addClassNames(["Table",e.className]),this._rows=[],this._rowCount=0,this._hiddenRowIds=[],this._clickable=!1,this._colIds=e.colIds,this._minRows=e.minRows||0,this._colCount=this._colIds?this._colIds.length:e.colCount||1,this._defaultRowContent=e.defaultRowContent||[],this._highlightable=e.highlightable,this._disableAutoSelect=e.disableAutoSelect,this._autoUpdateRowColor=!e.disableRowColor,e.headerContent&&(this.header=this.createChild("div",{className:["container","header"]}),this._addHeader(e.headerContent)),this.content=this.createChild("div",{className:["container","content"]}),e.footerContent&&(this.footer=this.createChild("div",{className:["container","footer"]}),this._addFooter(e.footerContent)),e.onRowTap&&(this._clickable=!0,this.on("selected",e.onRowTap)),void(e.minRows&&this._setupDefaultRows())):void console.error("Undefined Table 'options' parameter")}i(736);var o=i(235),s=i(228),a=i(191).inherits;a(n,o),e.exports=n,n.prototype.addRow=function(e,t){var i;return this._rowCount<this._rows.length?(this._rows[this._rowCount]._isEmpty=!1,i=this.updateRow(this._rowCount,e,t)):i=this._addRow(e,null,t),this._rowCount++,this._updateRowColor(),i},n.prototype.insertRow=function(e,t,i){if(e<0||e>this._rows.length)return console.warn("[Table.insertRow] the specified index ("+e+") is out of range."),null;var n=this._rows[e];if(n&&n._isEmpty)n._isEmpty=!1,n=this.updateRow(e,t,i);else{n=this._createRow(t,"content");for(var o in i)n[o]=i[o];e===this._rows.length?this.content.appendChild(n):n.insertBefore(this._rows[e]),this._rows.splice(e,0,n)}return this._rowCount++,this._updateRowColor(),n},n.prototype.sort=function(e){var t=this._rows;t.sort(e);for(var i=0,n=t.length;i<n;i+=1)this.content.appendChild(t[i]);this._updateRowColor()},n.prototype.delRow=function(e){if(e>this._rowCount)return console.error("[Table.delRow] Row index "+e+" does not exist.");if(!this._isRowEmpty(e)){var t=this._rows[e];this._lastSelected===t&&(this._lastSelected=null),t.destroy(),this._rowCount--,this._rows.splice(e,1),this._rows.length<this._minRows&&this._addRow(),this._highlightable&&!this._disableAutoSelect&&this.highlight(0),this._updateRowColor()}},n.prototype.updateRowContent=function(e,t,i){if(!e._isEmpty){for(var n in i)e[n]=i[n];if(this._highlightable&&e.enable(),Array.isArray(t)){for(var s={},a=this._colIds,r=0;r<a.length;r++)s[a[r]]=t[r];t=s}for(var l in t){var c=e.getChild(l),u=t[l];c.clearContent(),u instanceof o?c.appendChild(u):(void 0!==u&&null!==u||(u=""),c.setHtml(u.toString()))}return!this._highlightable||this._lastSelected||this._disableAutoSelect||this.highlight(0),e}},n.prototype.updateRow=function(e,t,i){if(!this._isRowEmpty(e)){var n=this._rows[e];return this.updateRowContent(n,t,i)}},n.prototype.getRows=function(){return this._rows},n.prototype.clearContent=function(){for(var e=0;e<this._rows.length;e++)this._rows[e].destroy();this._rows=[],this._rowCount=0,this._lastSelected=null,this._hiddenRowIds=[],this._setupDefaultRows()},n.prototype.removeHightlight=function(){this._lastSelected&&(this._lastSelected.delClassNames("highlight"),this._lastSelected=null)},n.prototype.highlightFirstRow=function(){for(var e=0;e<this._rows.length;e++){var t=this._rows[e];if(t.isVisible())return void this.highlightRow(t)}},n.prototype.highlightRow=function(e){if(this._highlightable){if(!e||e._isEmpty)return void console.warn("Invalid index, row does not exist or empty!");e!==this._lastSelected&&(this._lastSelected&&this._lastSelected.delClassNames("highlight"),this._lastSelected=e,this._lastSelected.addClassNames("highlight")),this.emit("selected",e)}},n.prototype.highlight=function(e){this.highlightRow(this._rows[e])},n.prototype.getRowCount=function(){return this._rowCount},n.prototype.getRow=function(e){return this._rows[e]&&this._isRowEmpty(e)?void console.warn("[Table.getRow] Row index "+e+" is empty."):this._rows[e]},n.prototype.getCol=function(e,t){var i=this.getRow(e);if(i)return i.getChild(t)},n.prototype.getHeaderCol=function(e){return this.header.getChildren()[0].getChild(e)},n.prototype.hideRows=function(e){if(e.length){for(var t=0,i=0;i<e.length;i++){var n=e[i],o=this.getRow(n);o&&(o.hide(),this._hiddenRowIds.push(n),t++)}var s=this.getRowCount()-t;return this._disableAutoSelect||this.highlightFirstRow(),s<this._minRows?(s=this._minRows-s,void this._addEmptyRows(s)):void this._updateRowColor()}},n.prototype.showRows=function(){var e=this._hiddenRowIds;if(e.length){for(var t=0;t<e.length;t++){var i=this.getRow(e[t]);i&&i.show()}return this._disableAutoSelect||this.highlightFirstRow(),this._hiddenRowIds=[],this._rows.length>this._minRows?void this._delEmptyRows(this._rows.length-this._minRows):void this._updateRowColor()}},n.prototype._updateRowColor=function(){if(this._autoUpdateRowColor)for(var e=!0,t=0;t<this._rows.length;t++){var i=this._rows[t];i.isVisible()&&(e?(i.addClassNames("odd"),e=!1):(i.delClassNames("odd","even"),e=!0))}},n.prototype._isRowEmpty=function(e){return this._rows[e]._isEmpty},n.prototype._createRow=function(e,t){var i=this._colIds||[],n=new o("div",{className:"row"});e||(n._isEmpty=!0,e=this._defaultRowContent);for(var a,r=Array.isArray(e),l=0;l<this._colCount;l++){var c=i[l],u=n.createChild("div",{className:"col",name:c||""});r?a=e[l]:(a=e[c],n[c]=a),(a||0===a)&&(a instanceof o?u.appendChild(a):u.setHtml(a.toString()))}if("content"!==t)return n;if(this._highlightable||this._clickable){s(n),n.on("disabled",function(){n.addClassNames("disabled")}),n.on("enabled",function(){n.delClassNames("disabled")}),n._isEmpty&&n.disable();var d=this;n.on("tap",function(){d.highlightRow(this)})}return n},n.prototype._addRow=function(e,t,i){t=t||"content";var n=this._createRow(e,t);this[t].appendChild(n);for(var o in i)n[o]=i[o];return"content"!==t?n:(this._rows.push(n),e?(!this._highlightable||this._lastSelected||this._disableAutoSelect||this.highlight(0),n):void 0)},n.prototype._addEmptyRows=function(e){for(var t=0;t<e;t++)this._addRow();this._updateRowColor()},n.prototype._addHeader=function(e){this._addRow(e,"header")},n.prototype._addFooter=function(e){this._addRow(e,"footer")},n.prototype._setupDefaultRows=function(){for(;this._rows.length<this._minRows;)this._addRow();this._updateRowColor()},n.prototype._delEmptyRows=function(e){for(var t=this._rows.length-1;t>=0&&!(0===e||this._rows.length<=this._minRows);t--)this._isRowEmpty(t)&&(this._rows[t].destroy(),this._rows.splice(t,1),e--);this._updateRowColor()}},function(e,t){},function(e,t,i){function n(e,t){a.call(this,"div",{className:"Gauge"}),this.createChild("div",{className:"barBg"});var i=this.createChild("div",{className:"barBox"});this.bars=[];for(var n=0,s=e.length;n<s;n+=1){var r=i.createChild("div",{className:"barContainer"});r.createChild("div",{className:["bar",e[n]]}),r.tooltip=i.createChild("div",{className:"tooltip"}),r.tooltipContent=new a("div"),o(r.tooltip,r.tooltipContent,{openOnTap:!0}),this.bars.push(r)}this.width=t}var o=i(248).addTooltip,s=i(191).inherits,a=i(235);s(n,a),e.exports=n,n.prototype.setValues=function(e){for(var t=0,i=0,n=this.bars.length;i<n;i+=1){var o=e[i],s=this.bars[i],a=Math.floor(this.width*o.weight);s.setStyles({"-webkit-mask-position":t+"px 0","-webkit-mask-size":a+"px 100%"}),s.tooltip.setStyles({left:t+"px",width:a+"px"}),t+=a,s.tooltipContent.setText(o.tooltip)}}},function(e,t,i){function n(){c.call(this,"div",{className:"mapCoordinateDisplay",hidden:!0}),this._shouldShowMapInfo=!1,this._isTransparent=!0,this._markerCount=0,this._setupListeners(),this._createContent()}function o(){u.openAllianceCard(this.allianceInfo.allianceId)}i(739);var s=i(248).addTooltip,a=i(183).dimensions,r=i(252),l=i(191).inherits,c=i(235),u=i(630),d=i(469),h=i(228),p=i(29).getText,m=i(523),f=i(227),g=i(225),_=12,v=5,y=43;l(n,c),e.exports=n,n.prototype._createContent=function(){var e=this.createChild("div",{className:"mapInfo"});this.descriptionElement=e.createChild("div",{className:"areaInfo"}),this.coordinatesElement=e.createChild("div",{className:"coordsAndLevel"}),this.allianceInfo=this.createChild("div",{className:"allianceInfo"}),this.allianceTag=this.allianceInfo.createChild("div",{className:"tag"}),this.allianceEmblem=this.allianceInfo.appendChild(new d({width:35,height:35}));var t=this._smallFlags=this.createChild("div",{className:"smallFlagsIcon",hidden:!0}),i=this._markerBox=this.createChild("div",{className:"markerBox",hidden:!0}),n=i.createChild("div",{className:"minimizeBtn"});n.createChild("div",{className:"icon"}),this._markerList=i.createChild("div",{className:"markerList"}),this._markerList.setStyle("maxHeight",y*v+"px"),h(this),window.foreground.handleTapAfter(this),this.allianceEmblem.on("longtap",o),this.allianceEmblem.allianceInfo=this.allianceInfo,this._isMarkerBoxMinimized=!1,h(n),h(t);var s=this._toggleMarkerBox.bind(this);n.on("longtap",s),t.on("longtap",s)},n.prototype._toggleMarkerBox=function(){this._isMarkerBoxMinimized=!this._isMarkerBoxMinimized,this.toggleClassName("minimizedMarkers",this._isMarkerBoxMinimized)},n.prototype._updateMapInfo=function(){var e=window.gui.playerData.position;if(!e.mapPosition)return!1;var t=m.entities.prism,i=e.coordinates.posX+","+e.coordinates.posY,n=e.mapPosition.nameId;n||(n=e.area.nameId+" ("+e.subArea.nameId+")",i+=", "+p("ui.common.averageLevel")+" "+e.subArea.level),this.descriptionElement.setText(n),this.coordinatesElement.setText(i);var o=t[e.subArea.id];if(o&&o.prism){var s=o.getAlliance();this.allianceInfo.allianceId=s.allianceId,this.allianceTag.setText("["+s.allianceTag+"]"),this.allianceEmblem.setValue(s.allianceEmblem,!0),this.allianceInfo.show()}else this.allianceInfo.hide();return!0},n.prototype.setMapInfoVisibility=function(e){if(e!==this._shouldShowMapInfo)if(this._shouldShowMapInfo=e,e){if(!this._updateMapInfo())return;this._appear()}else this._markerCount>0?this.addClassNames("noMapInfo"):this._disappear()},n.prototype._appear=function(){this.toggleClassName("noMapInfo",!this._shouldShowMapInfo),this._isTransparent&&(this._isTransparent=!1,this.show(),r.forceReflow(this),f.tween(this,{opacity:1},{time:100,easing:"linear"}))},n.prototype._disappear=function(){this._isTransparent||(this._isTransparent=!0,f.tween(this,{opacity:0},{time:100,easing:"linear"},this.hide))},n.prototype._clear=function(){this._isTransparent=!0,this.hide(),this.setStyle("opacity",0),this.addClassNames("noMapInfo")},n.prototype._setupListeners=function(){var e=this,t=window.gui;t.on("disconnect",function(){e._clear()}),t.playerData.position.on("mapUpdate",function(){e._shouldShowMapInfo&&(e._updateMapInfo(),e._appear())}),t.on("resize",function(){e.setStyles({left:a.mapLeft+_+"px",top:a.mapTop+_+"px"})});var i=t.fightManager;i.on("fightEnterPreparation",this._disappear.bind(this)),i.on("fightEnterBattle",this._disappear.bind(this)),i.on("fightEnd",this._appear.bind(this))},n.prototype.addMarker=function(e,t){this._markerCount===v&&this._createDotDotButton(),this._markerCount++;var i=this._markerList.createChild("div",{className:"marker"});i.createChild("div",{className:["icon",e]});var n=t?t.split("\n")[0]:"";return i.createChild("div",{className:"text",text:n}),s(i,t),1===this._markerCount&&(this._markerBox.show(),this._smallFlags.show(),this._appear()),i},n.prototype.removeMarker=function(e){this._markerCount--,this._markerList.removeChild(e),this._markerCount===v&&this._deleteDotDotButton(),0===this._markerCount&&(this._markerBox.hide(),this._smallFlags.hide(),this._shouldShowMapInfo||this._disappear())},n.prototype._createDotDotButton=function(){var e=this._markerBox.createChild("div",{className:"dotDotBtn",text:"..."});h(e),e.on("longtap",function(){g["switch"]("worldMap")}),this._dotDotButton=e},n.prototype._deleteDotDotButton=function(){this._markerBox.removeChild(this._dotDotButton),this._dotDotButton=null}},function(e,t){},function(e,t,i){function n(e,t){if(!t)return _["switch"](e);
var i=_.getWindow(e),n=i.getOpenedTabId();i.openState&&t===n?_.close(e):_.open(e,{tabId:t})}function o(){_.getWindow("tradeInventory").isMyShopOpen()?_.close("tradeInventory"):(window.dofus.sendMessage("LeaveDialogRequestMessage",null),window.dofus.sendMessage("ExchangeRequestOnShopStockMessage"))}function s(){_.getWindow("bidHouseShop").openState?_.close("bidHouseShop"):r.openBidHouse(!1)}function a(){g.call(this,{autoClose:!0}),this.addClassNames("MenuBar"),this._sizeInIcons=-1,this._iconOrder=[],this._notificationIconList={},this._manualMode=!1,this._createDom(),this._listenToServerEvents(),this._listenToInternalEvents()}i(741);var r=i(496),l=i(184),c=i(183).dimensions,u=i(383),d=i(29).getText,h=i(191).inherits,p=i(246),m=i(195),f=i(227),g=i(742),_=i(225),v=i(7),y=i(248),b=l.MENU_ICON_SIZE,w=l.WARN_INVENTORY_RED_MIN,M={narrow:8,wide:4},T={narrow:35,wide:45},C={Carac:{tooltip:"ui.banner.character",windowId:"characteristics"},Spell:{tooltip:"ui.grimoire.mySpell",windowId:"grimoire",tabId:"spells"},Bag:{tooltip:"ui.banner.inventory",windowId:"equipment"},Book:{tooltip:"ui.common.quests",windowId:"grimoire",tabId:"quests"},Map:{tooltip:"ui.banner.map",windowId:"worldMap"},Friend:{tooltip:"ui.banner.friends",windowId:"social",tabId:"friends"},Guild:{tooltip:"ui.common.guild",windowId:"social",tabId:"guild"},BidHouse:{tooltip:"ui.bidhouse.bigStore",action:s},Conquest:{tooltip:"ui.common.koliseum",windowId:"arena"},Goultine:{tooltip:"tablet.window.shop.title",windowId:"market",tabId:"shop"},Job:{tooltip:"ui.common.myJobs",windowId:"grimoire",tabId:"jobs"},Alliance:{tooltip:"ui.common.alliance",windowId:"social",tabId:"alliance"},Mount:{tooltip:"ui.banner.mount",windowId:"mount"},Directory:{tooltip:"ui.common.directory",windowId:"social",tabId:"directory"},Alignment:{tooltip:"ui.common.alignment",windowId:"grimoire",tabId:"alignment"},Bestiary:{tooltip:"ui.common.bestiary",windowId:"grimoire",tabId:"bestiary"},Title:{tooltip:"ui.common.titles",windowId:"grimoire",tabId:"ornaments"},Achievement:{tooltip:"ui.achievement.achievement",windowId:"grimoire",tabId:"achievements"},Almanax:{tooltip:"ui.almanax.almanax",windowId:"grimoire",tabId:"almanax"},Spouse:{tooltip:"ui.common.spouse",windowId:"social",tabId:"spouse"},Shop:{tooltip:"ui.common.shop",action:o},TOA:{tooltip:"ui.toa.interfaceTitle",windowId:"toa"},Help:{tooltip:"ui.helpWindow.title",windowId:"help"}},I=["Carac","Spell","Bag","BidHouse","Map","Friend","Book","Guild","Conquest","Goultine","Job","Alliance","Mount","Directory","Alignment","Bestiary","Title","Achievement","Almanax","Spouse","Shop","TOA","Help"],A="menuBarOrder";h(a,g),e.exports=a,a.prototype._createDom=function(){this._iconsBox=this.content.createChild("div",{className:"iconsBoxContainer"}),this._icons=this.content.createChild("div",{className:"iconsContainer"});var e=this;this._unlock=!1,this._lockBtn=this.content.appendChild(new p({className:"lockBtn",scaleOnPress:!0},function(){e._toggleIconsDrag(!e._unlock)}));for(var t=0;t<I.length;t++)this._createIcon(t,I[t])},a.prototype.setIconAvailability=function(e,t){void 0===t&&(console.error(new Error("setIconAvailability: enabled param should not be undefined")),t=!1);var i=this._icons.getChild(e);i.toggleClassName("disabled",!t),i.isDisabled=!t},a.prototype.enableDragButton=function(e){this._lockBtn.setEnable(e)},a.prototype._toggleIconsDrag=function(e){for(var t=this._icons.getChildren(),i=0,n=t.length;i<n;i+=1)u.setDragEnable(t[i],e);this._lockBtn.toggleClassName("on",!e),this.toggleClassName("draggable",e),this._unlock=e},a.prototype._listenToServerEvents=function(){function e(){return o.tutorialManager.inTutorial||o.playerData.isFighting}function t(){n._addedBagWarnRedIcon&&(n._removeNotificationIcon("Bag","warnRedIconCircle"),n._addedBagWarnRedIcon=!1)}function i(){n._addedBagWarnRedIcon||(n._addNotificationIcon("Bag","warnRedIconCircle"),n._addedBagWarnRedIcon=!0)}var n=this,o=window.gui;o.uiLocker.on("updated",function(e){if(e.menuButtonId){if(!C[e.menuButtonId])return console.error(new Error("Unknown button id `"+e.menuButtonId+"` in MenuBar."));if(n.setIconAvailability(e.menuButtonId,!e.locked),!e.locked){var t=n._getIcon(e.menuButtonId);if(t){var i=n._notificationIconList,o=e.menuButtonId,s=i[o];i.hasOwnProperty(o)&&t.addClassNames(s)}}}}),o.tutorialManager.on("inTutorialStateChanged",function(e){return e?(n._manualMode=!0,n._setButtonsOrder(I),n.enableDragButton(!1),o.uiLocker.lockAllFeatures("tutorial",d("tablet.tutorial.uiLocker.default")),void n._clearNotificationIconsStyle(["plusIcon"])):(n._manualMode&&n._setButtonsOrder(n._iconOrder),n._manualMode=!1,n.enableDragButton(!0),n._showNotificationIcons(["plusIcon"]),void o.uiLocker.unlockAllFeatures("tutorial"))}),o.fightManager.on("fightStart",function(){n._clearNotificationIconsStyle()}),o.fightManager.on("fightEnd",function(){n._showNotificationIcons()}),o.playerData.inventory.on("weightUpdated",function(e,n){var o=e/n;o<w?t():o>=w&&i()}),o.playerData.characters.mainCharacter.on("newSpellLearned",function(){n._addNotificationIcon("Spell","plusIcon",{doNotShow:e()})}),o.playerData.on("characterLevelUp",function(){n._addNotificationIcon("Carac","plusIcon",{doNotShow:e()})});var s=_.getWindow("grimoire");s.tabs.on("openTab",function(t){"spells"!==t||e()||n._removeNotificationIcon("Spell","plusIcon")});var a=_.getWindow("characteristics");a.on("open",function(){e()||n._removeNotificationIcon("Carac","plusIcon")})},a.prototype._listenToInternalEvents=function(){var e=this,t=window.gui;t.on("connected",function(){e._loadButtonOrderFromAccountPref(),e._setButtonsOrder(e._iconOrder)}),t.on("disconnect",function(){e._manualMode=!1,e._clearNotificationIconsStyle(),e._resetNotificationIconList(),e._addedBagWarnRedIcon=!1,e._addedBagWarnYellowIcon=!1}),this.on("close",function(){this._toggleIconsDrag(!1)})},a.prototype._onDrop=function(e,t){if(e.id!==t.id){e.delClassNames("vibrate");var i=e.index,n=t.index,o=this;f.tween(e,{webkitTransform:"translate3d("+(t.x-e.x)+"px,"+(t.y-e.y)+"px,0)"},{time:100,easing:"ease-out"},function(){o._positionIcon(e,n),o._iconOrder[e.index]=e.id,o._iconOrder[t.index]=t.id,m.setValue(A,o._iconOrder),e.addClassNames("vibrate")}),this._positionIcon(t,i)}},a.prototype._createIcon=function(e,t){var i=this;this._iconsBox.createChild("div",{className:"iconBox"});var o=C[t],s=this._icons.appendChild(new p({className:["vibrate","anim"+Math.floor(9*Math.random()),"menuIcon"+t,"menuBarIcon"],tooltip:d(o.tooltip),name:t,scaleOnPress:!0},function(){if(this.isDisabled){var e=window.gui.uiLocker.getMenuButtonLockedReasons(t);return void y.showNotification(e.join("\r\n"),this)}i.close(),"Goultine"===t&&v.log("HUD.Click_on_button",{interface_id:"MenuBar",button_id:"BTN_MENUBAR_SHOP",clic_parameter_key:"position",clic_parameter_value:s.index+1,clic_type:"Simple_court"}),o.action?o.action():n(o.windowId,o.tabId)}));s.id=t,s.index=e,u.setDraggable(s,null,"menuBar",null,{dragElement:!0,dragOnTouchstart:!0}),u.setDroppable(s,["menuBar"],{matchPositionOnDrop:!0}),u.disableDrag(s),s.on("drop",function(e){i._onDrop(this,e)}),s.on("tooltipOn",function(){this.setStyle("webkitTransform","scale(1.1)")}),s.on("tooltipOut",function(){this.setStyle("webkitTransform","scale(1)")})},a.prototype._getIcon=function(e){return this._icons.getChild(e)},a.prototype.getIconForTuto=function(e){return this._getIcon(e)},a.prototype._reorderButtons=function(){for(var e=this._icons.getChildren(),t=this._iconsBox.getChildren(),i=0,n=e.length;i<n;i+=1){var o=e[i];this._positionIcon(o,o.index),this._positionIcon(t[i],o.index)}},a.prototype._setButtonsOrder=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=this._icons.getChild(i);n.index=t,this._positionIcon(n,t)}},a.prototype._loadButtonOrderFromAccountPref=function(){if(this._iconOrder=m.getValue(A,null),this._iconOrder)for(var e=0;e<I.length;e++)this._iconOrder.indexOf(I[e])===-1&&this._iconOrder.splice(e,0,I[e]);else this._iconOrder=I.concat();for(var t=0;t<this._iconOrder.length;t++){var i=this._iconOrder[t],n=this._icons.getChild(i);if(n){var o=window.gui.uiLocker.isMenuButtonAvailable(i);this.setIconAvailability(i,o)}else this._iconOrder.splice(t,1),t--}},a.prototype._positionIcon=function(e,t){window.gui.ipadRatio?(e.x=(b+1)*(t%this._iconsPerLine),e.y=(b+2)*Math.floor(t/this._iconsPerLine)):(e.x=(b+4)*Math.floor(t/this._iconsPerColumn),e.y=b*(t%this._iconsPerColumn)),e.index=t,e.setStyles({left:e.x+"px",top:e.y+"px",webkitTransform:""})},a.prototype.computeMinimumSize=function(e,t){return this._sizeInIcons=e,e*b+M[t]},a.prototype._resize=function(){var e,t=window.gui.ipadRatio?"narrow":"wide";window.gui.ipadRatio?(this._iconsPerLine=this._sizeInIcons,this._iconsPerColumn=Math.ceil(I.length/this._iconsPerLine),this.setStyles({top:"",right:"",bottom:0,left:c.posMenuBar+"px",width:c.menuBarSize+"px",height:c.bottomBarHeight+"px"}),this._icons.setStyle("height",b*this._iconsPerColumn+T[t]+"px"),this._icons.setStyle("width",b*this._iconsPerLine+"px"),e="top"):(this._iconsPerColumn=this._sizeInIcons,this._iconsPerLine=Math.ceil(I.length/this._iconsPerColumn),this.setStyles({bottom:"",left:"",top:c.posMenuBar+"px",right:0,width:c.sideBarWidth+"px",height:c.menuBarSize+"px"}),this._icons.setStyle("width",b*this._iconsPerLine+T[t]+"px"),e="left"),this._reorderButtons(),this.setOpeningSide(e)},a.prototype._addNotificationIcon=function(e,t,i){if(!e)return void console.error("MenuBar._addNotificationIcon: undefined iconName with notificationIcon",t);if(!t)return void console.error("MenuBar._addNotificationIcon: undefined notificationIcon on iconName",e);i=i||{};var n=this._getIcon(e);if(n){var o=this._notificationIconList;o.hasOwnProperty(e)||(o[e]=t,!i.doNotShow&&window.gui.uiLocker.isMenuButtonAvailable(e)&&n.addClassNames(t))}},a.prototype._removeNotificationIcon=function(e,t){if(!e)return void console.error("MenuBar._removeNotificationIcon: undefined iconName with notificationIcon:",t);if(!t)return void console.error("MenuBar._removeNotificationIcon: undefined notificationIcon on iconName:",e);var i=this._getIcon(e);if(i){var n=this._notificationIconList;n.hasOwnProperty(e)&&(i.delClassNames(t),delete n[e])}},a.prototype._clearNotificationIconsStyle=function(e){e?e instanceof Array||(e=[e]):e="all";for(var t=this._notificationIconList,i=this._icons.getChildren(),n=0;n<i.length;n+=1){var o=i[n],s=o.id;t.hasOwnProperty(s)&&("all"!==e&&e.indexOf(t[s])===-1||o.delClassNames(t[s]))}},a.prototype._resetNotificationIconList=function(){var e=this._notificationIconList;for(var t in e)e.hasOwnProperty(t)&&delete e[t]},a.prototype._showNotificationIcons=function(e){e?e instanceof Array||(e=[e]):e="all";var t=this._notificationIconList;for(var i in t)if(t.hasOwnProperty(i)){var n=i,o=this._getIcon(n);"all"!==e&&e.indexOf(t[n])===-1||o.addClassNames(t[n])}}},function(e,t){},function(e,t,i){function n(e){function t(){var e=n.isOpen;n._resize(),window.setTimeout(function(){n.getCurrentDrawerSize()>=n.getCurrentContentSize()?(n.setAsAlwaysOpen(!0),i.hide()):(n.setAsAlwaysOpen(!1),i.show()),n.refresh(),e&&n.shouldKeepOpen&&n.open()},0)}e=e||{},s.call(this,{className:"MenuDrawer",background:!0,autoClose:e.autoClose,backDrawerSize:e.backDrawerSize}),this.shouldKeepOpen=!1;var i,n=this;window.gui.once("connected",function(){this.on("resize",function(){t()}),t()}),window.gui.on("disconnect",function(){n.close()}),this.content.createChild("div",{className:"topBorder"}),i=this.content.createChild("div",{className:"arrowBtnBg"}),i.appendChild(new a({className:"arrowBtn"},function(){n.isOpen?n.close():n.open()}));var o=l.getValue("tablet.tutorial.canSwipeDrawer");o||i.once("tap",function(){var e=window.gui.notificationBar,t={type:e.notificationType.PRIORITY_INVITATION,title:r("tablet.tutorial.tip"),text:r("tablet.tutorial.canSwipeDrawer")};e.newNotification("tip canSwipeDrawer",t),l.setValue("tablet.tutorial.canSwipeDrawer",!0)}),this.createChild("div",{className:"borderBox"})}i(743);var o=i(191).inherits,s=i(744),a=i(246),r=i(29).getText,l=i(195);o(n,s),e.exports=n,n.prototype._resize=function(){}},function(e,t){},function(e,t,i){function n(e){function t(e){var t=e[this._axis]-l;t*this._direction<=0?t=0:t*this._direction>this._contentSize-this._visibleSize&&(t=(this._contentSize-this._visibleSize)*this._direction);var i="translate"+this._axis+"("+(this._currentPosition+t)+"px)";this.content.setStyle("webkitTransform",i),this.background&&this.background.setStyle("webkitTransform",i)}function i(e){var t=e[this._axis]-l;t*this._direction>=0?t=0:t*this._direction<this._visibleSize-this._contentSize&&(t=(this._visibleSize-this._contentSize)*this._direction);var i="translate"+this._axis+"("+(this._currentPosition+t)+"px)";this.content.setStyle("webkitTransform",i),this.background&&this.background.setStyle("webkitTransform",i)}function n(){c=!0}function o(){c||u.close(),c=!1}r.call(this,"div",{className:"SwipingDrawer"}),e=e||{},this.addClassNames(e.className),e.background&&(this.backgroundArea=this.createChild("div",{className:"drawerBackgroundArea"}),this.background=this.backgroundArea.createChild("div",{className:"drawerBackground"})),this.visibleArea=this.createChild("div",{className:"visibleArea"}),this.content=this.visibleArea.createChild("div",{className:"drawerContent"}),this._contentSize=0,this._extraContentSize=e.backDrawerSize||0,this.isOpen=!1,this._isAlwaysOpen=!1,s(this);var a,l;this.on("slideStart",function(e){this.addClassNames("open"),this._tween1&&(this._tween1.cancel(),this._tween1=null),this._tween2&&(this._tween2.cancel(),this._tween2=null),l=e[this._axis],a=this.isOpen?t:i,this.on("slide",a)}),this.on("slideEnd",function(e,t,i){var n="x"===this._axis?t:i;this._currentPosition+=n;var o;o=e?n*this._direction<0:this.isOpen,o?this._open(!0):this._close(!0),this.removeListener("slide",a)}),this.on("slideCancel",function(){this.isOpen?this._open(!0):this._close(!0),this.removeListener("slide",a)});var c=!1,u=this;e.autoClose&&(this.on("open",function(){this.on("dom.touchstart",n),window.gui.wBody.on("dom.touchstart",o)}),this.on("close",function(){this.removeListener("dom.touchstart",n),window.gui.wBody.removeListener("dom.touchstart",o)})),e.openingSide&&this.setOpeningSide(e.openingSide)}i(745);var o=i(191).inherits,s=i(232),a=i(227),r=i(235),l=150;o(n,r),e.exports=n,n.prototype.getCurrentDrawerSize=function(){return parseInt(this.getStyle(this._dimension),10)},n.prototype.getCurrentContentSize=function(){return this.content.rootElement[this._clientProperty]},n.prototype.setAsAlwaysOpen=function(e){this._isAlwaysOpen=e,this.lockDrawer(e)},n.prototype.lockDrawer=function(e){e!==this.drawerLocked&&(this.close(),this.drawerLocked=e,this.lockSlide(e))},n.prototype.setOpeningSide=function(e){switch(this.side=e,this.replaceClassNames(["top","bottom","left","right"],[e]),e){case"top":this._axis="y",this._dimension="height",this._clientProperty="clientHeight",this._direction=1,this.setSlideDirection("vertical");break;case"bottom":this._axis="y",this._dimension="height",this._clientProperty="clientHeight",this._direction=-1,this.setSlideDirection("vertical");break;case"left":this._axis="x",this._dimension="width",this._clientProperty="clientWidth",this._direction=1,this.setSlideDirection("horizontal");break;case"right":this._axis="x",this._dimension="width",this._clientProperty="clientWidth",this._direction=-1,this.setSlideDirection("horizontal")}},n.prototype.refresh=function(){if(this._visibleSize=this.rootElement[this._clientProperty],this._contentSize=this.getCurrentContentSize(),this._contentSize){this._isAlwaysOpen&&(this._contentSize+=this._extraContentSize),this._contentSize<this._visibleSize&&(this._contentSize=this._visibleSize);var e,t,i,n,o,s;switch(e=t=i=n=o=s="",this.side){case"top":t=this._visibleSize+"px";break;case"bottom":e=this._visibleSize+"px";break;case"left":n=this._visibleSize+"px";break;case"right":i=this._visibleSize+"px"}if(this.content.setStyles({top:e,bottom:t,left:i,right:n,width:o,height:s,webkitTransform:"translate"+this._axis+"("+100*this._direction+"%)"}),this.setStyle(this._dimension,this._contentSize+"px"),this.background){var a={top:e,bottom:t,left:i,right:n,width:"",height:"",webkitTransform:"translate"+this._axis+"("+100*this._direction+"%)"};a[this._dimension]=this._contentSize+"px",this.background.setStyles(a)}this._currentPosition=this._contentSize*this._direction,this.isOpen=!1,this.delClassNames("open")}},n.prototype._open=function(e){if(e||!(this._opening||this.isOpen||this.drawerLocked)){this._opening=!0,this.addClassNames("open"),this._tween1&&this._tween1.cancel(),this._tween2&&this._tween2.cancel(),e||this.emit("opening");var t=this;this._tween1=a.tween(this.content,{webkitTransform:"translate"+this._axis+"("+this._visibleSize*this._direction+"px)"},{time:l,easing:"ease-out"},function(){t._currentPosition=t._visibleSize*t._direction,t._tween1=null,t._opening=!1,t.isOpen||t.emit("open"),t.isOpen=!0}),this.background&&(this._tween2=a.tween(this.background,{webkitTransform:"translate"+this._axis+"("+this._visibleSize*this._direction+"px)"},{time:l,easing:"ease-out"},function(){t._tween2=null}))}},n.prototype.open=function(){this._open(!1)},n.prototype._close=function(e){if(e||!this._closing&&this.isOpen&&!this.drawerLocked){this._closing=!0,this._tween1&&this._tween1.cancel(),this._tween2&&this._tween2.cancel(),e||this.emit("closing");var t=this;this._tween1=a.tween(this.content,{webkitTransform:"translate"+this._axis+"("+100*this._direction+"%)"},{time:l,easing:"ease-out"},function(){t._currentPosition=t._contentSize*t._direction,t._tween1=null,t._closing=!1,t.emit("close"),t.isOpen=!1,t.delClassNames("open")}),this.background&&(this._tween2=a.tween(this.background,{webkitTransform:"translate"+this._axis+"("+100*this._direction+"%)"},{time:l,easing:"ease-out"},function(){t._tween2=null}))}},n.prototype.close=function(){this._close(!1)}},function(e,t){},function(e,t,i){function n(){u.call(this,{autoClose:!0}),this.addClassNames("MainControls"),this._createDom();var e=this;this._fightCount=0,this._shouldForceCreature=!1;var t=window.gui;t.on("connected",function(){e._shouldForceCreature=!1,v&&this.serversData.isTournamentServer()&&(e._shouldForceCreature=!0,v=!1),e._setPreferences(),e._setLayout("roleplay",!0)}),t.on("disconnect",function(){e._fightCount=0,e.fightLocked=!1,e._shouldForceCreature=!1});var i=t.fightManager;i.on("fightEnterPreparation",function(){var t=window.gui.playerData.isSpectator?"spectator":"battlePreparation";e._setLayout(t)}),i.on("fightEnterBattle",function(){var t=window.gui.playerData.isSpectator?"spectator":"battle";e._setLayout(t)}),i.on("fightEnd",function(){e._setLayout("roleplay")}),i.on("fightOptionUpdate",function(){e._secretButton.toggleClassName("on",window.gui.fightManager.fightSecretOn),e._helpButton.toggleClassName("on",window.gui.fightManager.fightHelpOn)})}i(747);var o=i(248).addTooltip,s=i(246),a=i(183).dimensions,r=i(29).getText,l=i(29).findText,c=i(191).inherits,u=i(742),d=i(748),h=i(195),p=i(225),m=i(752),f=i(396),g=i(493),_=i(753),v=!0;c(n,u),e.exports=n,n.prototype._resize=function(){var e;window.gui.ipadRatio?(this.setStyles({bottom:0,top:"",right:"",left:a.posMainControlBar+"px",width:a.mainControlBarSize+"px",height:a.bottomBarHeight+"px"}),e="top"):(this.setStyles({bottom:"",top:a.posMainControlBar+"px",right:0,left:"",width:a.sideBarWidth+"px",height:a.mainControlBarSize+"px"}),e="left"),this.setOpeningSide(e)},n.prototype._createDom=function(){function e(e,t){"function"==typeof e&&(t=e),e=e||{};var n=e.className||[];return n.push("controlsButton"),i.appendChild(new s({disable:!!e.disable,tooltip:e.tooltip,className:n,scaleOnPress:!0},t))}var t=this,i=this.buttonBox=this.content.createChild("div",{className:"buttonBox"});this.playerPoints=i.appendChild(new d),this._fightListBtn=e({className:["showFightsButton","roleplayButton"],disable:!0},function(){p.open("fightList")}),o(this._fightListBtn,function(){return r("ui.fightsOnMap",t._fightCount)}),window.gui.playerData.position.on("mapChanged",function(e){var i=e.fights||[];t._fightCount=i.length,t._updateFightListButton()}),window.gui.on("MapFightCountMessage",function(e){t._fightCount=e.fightCount||0,t._updateFightListButton()}),this._tacticalModeBtn=e({className:["tacticalModeButton","battleButton","battlePreparationButton","spectatorButton"],tooltip:r("ui.fight.option.tacticMod")},function(){var e=h.getValue("tacticModeEngaged",!1);e?(_.turnOff(),t._tacticalModeBtn.delClassNames("on"),h.setValue("tacticModeEngaged",!1)):(_.turnOn(),t._tacticalModeBtn.addClassNames("on"),h.setValue("tacticModeEngaged",!0))}),this._consoleButton=e({className:["consoleButton","alwaysShowButton"]},function(){p["switch"]("adminConsole")}),this._mapInfoButton=e({className:["mapInfoButton","roleplayButton"],tooltip:r("ui.option.mapInfo")},function(){var e=t._isMapInfoDisplayed=!t._isMapInfoDisplayed;window.gui.mapCoordinateDisplay.setMapInfoVisibility(e),t._mapInfoButton.toggleClassName("on",e),h.setValue("showMapCoordinates",e)}),this._nicknamesButton=e({className:["nicknamesButton","roleplayButton","battleButton","battlePreparationButton","spectatorButton"],tooltip:r("ui.shortcuts.displayNames")},function(){var e=window.actorManager.areNicknamesOn();t._nicknamesButton.toggleClassName("on",!e),e?window.actorManager.turnNicknamesOff():window.actorManager.turnNicknamesOn()}),this._fightLockButton=e({className:["fightLockButton","battlePreparationButton"],tooltip:r("ui.fight.option.blockJoiner")},function(){t.fightLocked=!t.fightLocked,t._fightLockButton.toggleClassName("on",t.fightLocked),window.dofus.sendMessage("GameFightOptionToggleMessage",{option:f.FIGHT_OPTION_SET_CLOSED})}),this._helpButton=e({className:["helpButton","battlePreparationButton"],tooltip:r("ui.fight.option.help")},function(){window.dofus.sendMessage("GameFightOptionToggleMessage",{option:f.FIGHT_OPTION_ASK_FOR_HELP})}),this._secretButton=e({className:["secretButton","battleButton","battlePreparationButton"],tooltip:r("ui.fight.option.spectator")},function(){window.dofus.sendMessage("GameFightOptionToggleMessage",{option:f.FIGHT_OPTION_SET_SECRET})}),this._leaveButton=e({className:["leaveButton","battleButton","battlePreparationButton","spectatorButton"],tooltip:r("ui.common.quit")},function(){var e=window.gui,t=window.dofus.connectionManager;if(e.playerData.isSpectator)return t.sendMessage("GameContextQuitMessage");var i,n=1===e.serversData.settings.serverGameType;i=r(n&&e.fightManager.fightType!==m.FIGHT_TYPE_CHALLENGE?"ui.popup.hardcoreGiveup":"ui.popup.giveup"),e.fightManager.fightType===m.FIGHT_TYPE_PVP_ARENA&&(i+="\n"+r("ui.party.arenaLeaveWarning")),e.openConfirmPopup({title:r("ui.popup.warning"),message:i,cb:function(e){e&&t.sendMessage("GameContextQuitMessage")}})}),this._creatureModeButton=e({className:["creatureModeButton","alwaysShowButton"],tooltip:r("ui.fight.option.invisible")},function(){var e=window.isoEngine.actorManager,i=!h.getValue("creatureMode",!1);t._creatureModeButton.toggleClassName("on",i),h.setValue("creatureMode",i),e.setCreatureMode(i)}),this._transparentModeButton=e({className:["transparentModeButton","alwaysShowButton"],tooltip:r("ui.option.transparentOverlayMode")},function(){var e=window.isoEngine.actorManager,i=!e.isTransparentModeOn;t._transparentModeButton.toggleClassName("on",i),h.setValue("transparentMode",i),e.setTransparentMode(i)}),this._interactiveBlink=e({className:["interactiveBlinkBtn","roleplayButton"],tooltip:l("Toggle interactive halo")},function(){var e=!window.isoEngine.interactiveBlink;window.isoEngine.setInteractiveBlink(e),e&&window.isoEngine.highlightInteractivesWithDifferentType(),t._interactiveBlink.toggleClassName("on",e),h.setValue("interactiveBlink",e)}),this._progressBarPref=e({className:["progressBarPrefBtn","roleplayButton"],tooltip:r("ui.banner.customGauge")},function(){window.gui.progressGauge.openPrefMenu()}),e({className:["globalMenu","alwaysShowButton"],tooltip:r("ui.common.mainMenu")},function(){p["switch"]("global")})},n.prototype._setLayout=function(e,t){switch(e){case"roleplay":this.replaceClassNames(["battlePreparation","battle","spectator"],["roleplay"]),this.playerPoints.actionAndMovement.hide();break;case"spectator":this.replaceClassNames(["roleplay","battle","battlePreparation"],["spectator"]),this.playerPoints.actionAndMovement.hide(),this.buttonBox.getChildren()[2]!==this._leaveButton&&this._leaveButton.insertBefore(this._tacticalModeBtn);break;case"battlePreparation":this.replaceClassNames(["roleplay","battle","spectator"],["battlePreparation"]),this.fightHelpOn=!1,this._helpButton.delClassNames("on"),this.fightSpectatorOn=!1,this._secretButton.addClassNames("on"),this.buttonBox.getChildren()[2]!==this._leaveButton&&this._leaveButton.insertBefore(this._tacticalModeBtn);break;case"battle":this.replaceClassNames(["roleplay","battlePreparation","spectator"],["battle"]),this.buttonBox.getChildren()[3]!==this._leaveButton&&this._leaveButton.insertBefore(this._consoleButton),window.gui.playerData.isSpectator||this.playerPoints.actionAndMovement.show()}var i=window.gui.playerData,n=i.hasRight(g.SHOW_ADMIN_CONSOLE_BUTTON);this._consoleButton.toggleDisplay(n||i.isForcedAccount),this._nicknamesButton.toggleClassName("on",window.actorManager.areNicknamesOn()),t||(this._resize(),this.refresh())},n.prototype._setPreferences=function(){var e=this._isMapInfoDisplayed=h.getValue("showMapCoordinates",!0);this._mapInfoButton.toggleClassName("on",e),window.gui.mapCoordinateDisplay.setMapInfoVisibility(e);var t=h.getValue("tacticModeEngaged",!1);this._tacticalModeBtn.toggleClassName("on",t);var i=h.getValue("interactiveBlink",!0);this._interactiveBlink.toggleClassName("on",i),window.isoEngine.setInteractiveBlink(i);var n=h.getValue("creatureMode",!1);this._shouldForceCreature&&(n=!0,h.setValue("creatureMode",!0)),this._creatureModeButton.toggleClassName("on",n),window.isoEngine.actorManager.setCreatureMode(n);var o=h.getValue("transparentMode",!1);this._transparentModeButton.toggleClassName("on",o),window.isoEngine.actorManager.setTransparentMode(o)},n.prototype._updateFightListButton=function(){var e=this._fightCount>0;this._fightListBtn.setEnable(e),this._fightListBtn.toggleClassName("on",e)}},function(e,t){},function(e,t,i){function n(){function e(e){s._lifePoints=e,s.displayLifePoints()}function t(e){s._maxLifePoints=e,s.displayLifePoints()}function i(e){s.actionPointsNumber.setText(e)}function n(e){s.movementPointsNumber.setText(e)}l.call(this,"div",{className:"playerPoints"});var s=this;this._lifePoints=1,this._maxLifePoints=1,this._shieldPoints=0,window.gui.on("connected",function(){s.lifeDisplay=c.getValue("lifeDisplayMode","simple")}),window.gui.on("disconnect",function(){s.lifeGauge.setStyle("height","0%"),s.lifePointsNumber.clearContent(),s._shieldPoints=0,s.updateShieldUI()});var u=this.actionAndMovement=this.createChild("div",{className:"actionAndMovement"});this.actionPointsNumber=u.createChild("div",{className:["number","actionPoints"]}),this.movementPointsNumber=u.createChild("div",{className:["number","movementPoints"]}),o(this.actionPointsNumber,a("ui.common.ap")),o(this.movementPointsNumber,a("ui.common.mp"));var d=this.createChild("div",{className:"lifePointsWrapper"}),h=d.createChild("div",{className:"lifeHeart"});this.lifeGauge=h.createChild("div",{className:"lifeGauge"}),d.createChild("div",{className:"highlights"}),this.lifePointsNumberWrapper=d.createChild("div",{className:"numberWrapper"}),this.lifePointsNumber=this.lifePointsNumberWrapper.createChild("div",{className:"number"}),d.appendChild(new r),o(h,a("ui.common.lifePoints")),h.on("tap",function(){s.switchLifeDisplay()}),window.gui.playerData.on("lifePointsUpdated",function(t){e(t)}),window.gui.playerData.on("maxLifePointsUpdated",function(e){t(e)}),window.gui.playerData.on("actionPointsCurrentUpdated",function(e){i(e)}),window.gui.playerData.on("movementPointsCurrentUpdated",function(e){n(e)}),window.gui.fightManager.on("shieldPointsUpdated",function(e,t){e===window.gui.playerData.characters.controlledCharacterId&&(s._shieldPoints=t,s.updateShieldUI())})}i(749);var o=i(248).addTooltip,s=i(191).inherits,a=i(29).getText,r=i(750),l=i(235),c=i(195);s(n,l),n.prototype.updateShieldUI=function(){this._shieldPoints>0?this._addShieldColor():this._removeShieldColor(),this.displayLifePoints()},n.prototype._addShieldColor=function(){this.lifeGauge.addClassNames("shield")},n.prototype._removeShieldColor=function(){this.lifeGauge.delClassNames("shield")},n.prototype.switchLifeDisplay=function(){switch(this.lifeDisplay){case"simple":this.lifeDisplay="total";break;case"total":this.lifeDisplay="percentage";break;case"percentage":this.lifeDisplay="simple"}c.setValue("lifeDisplayMode",this.lifeDisplay),this.displayLifePoints()},n.prototype.displayLifePoints=function(){var e=this._lifePoints/this._maxLifePoints*100;switch(this.lifeGauge.setStyle("height",e+"%"),this.lifeDisplay){case"simple":this._shieldPoints>0?this.lifePointsNumber.setHtml(this._lifePoints+"<br>"+this._shieldPoints):this.lifePointsNumber.setHtml(this._lifePoints);break;case"total":this.lifePointsNumber.setHtml(this._lifePoints+"<br>"+this._maxLifePoints);break;case"percentage":this.lifePointsNumber.setHtml(Math.round(e)+"%")}},e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,"div"),this._currentServerLag(0);var e=this;window.gui.on("checkServerLag",function(t,i){e.checkServerLag(t,i)})}i(751);var o=i(191).inherits,s=i(235),a=1500,r=800;o(n,s),e.exports=n,n.prototype._currentServerLag=function(e){e>a?(this.setClassNames(["networkIndicator","bad"]),console.debug("Current server lag is bad:",e)):e>r?this.setClassNames(["networkIndicator","slow"]):this.setClassNames(["networkIndicator","good"])},n.prototype.checkServerLag=function(e,t){if("start"===t)this.serverLagEventName=e,this.serverLagStart=Date.now();else if("stop"===t){if(this.serverLagEventName!==e)return;this._currentServerLag(Date.now()-this.serverLagStart),this.serverLagEventName=null}else console.warn("Invalid action emitted to checkServerLag",e,":",t)}},function(e,t){},function(e,t){e.exports={FIGHT_TYPE_CHALLENGE:0,FIGHT_TYPE_AGRESSION:1,FIGHT_TYPE_PvMA:2,FIGHT_TYPE_MXvM:3,FIGHT_TYPE_PvM:4,FIGHT_TYPE_PvT:5,FIGHT_TYPE_PvMU:6,FIGHT_TYPE_PVP_ARENA:7,FIGHT_TYPE_Koh:8,FIGHT_TYPE_ToA:9}},function(e,t,i){function n(){var e=c.getValue("tacticModeEngaged",!1);e&&m.isFightMode?o():r()}function o(){var e=window.isoEngine.mapRenderer;e.isReady?(e.hideGraphics(),e.hideStatedElements(),window.background.hide(),s(),a(),_.show(),g.show()):e.once("ready",o)}function s(){if(g&&g.remove(),_&&_.remove(),f)for(var e=0;e<f.length;e++)f[e].remove()}function a(){f=p(),g=h(),_=d(m.isRoleplayMode)}function r(){l();var e=window.isoEngine.mapRenderer;window.background.show(),e.showGraphics(),e.showStatedElements(),g=null,_=null,f=null}function l(){if(_&&_.hide(),g&&g.hide(),f)for(var e in f)f[e].hide()}var c=i(195),u=i(754),d=u.makeTacticalBoxes,h=u.makeTacticalBackground,p=u.makeTacticGraphics,m=i(269),f=null,g=null,_=null;m.on("gameContextChanged",n),t.turnOn=o,t.turnOff=r},function(e,t,i){function n(e){for(var t=window.isoEngine.mapRenderer,i=[],n=t.map.cells,o=0;o<a.NB_CELLS;o++){var s=t.isWalkable(o);if(s){var r=n[o],d=l.cellCoord[o],h=(e&&r.f||0)+g,_=d.x,y=_-m,b=_+m,w=d.y-h,M=w+f,T=w+p,C=new c(_,w,b,M,_,T,y,M);C.cellId=o,i.push(C)}}var I=new u({scene:window.isoEngine.mapScene,x:0,y:0,position:-3,boxes:i,hue:v,hueContrast:!0,layer:S,id:"tacticalBoxes"});return I}function o(){return new u({scene:window.isoEngine.mapScene,x:0,y:0,position:-4,boxes:[new c((-h),(-p),(-h),A,I,A,I,(-p))],hue:_,layer:S,id:"tacticalBackground"})}function s(){for(var e=window.isoEngine.mapRenderer,t=e.map.cells,i=[],n=0;n<y;n++)if(!(7&t[n].l)){var o=l.cellCoord[n],s=e.mapScene.createTexture(r(),"roleplayTacticBlock","linear","permanent");i.push(new d({id:"tacticGraphic"+n,position:n,hue:[1,1,1,1],x:o.x-T/2,y:o.y-p,g:1,w:T,h:C,scene:e.mapScene},s))}return i}var a=i(184),r=i(755).createTacticBlockImage,l=i(756),c=i(757),u=i(758),d=i(759),h=a.CELL_WIDTH,p=a.CELL_HEIGHT,m=h/2,f=p/2,g=a.GRID_ALTITUDE_OFFSET,_=[0,0,0,1],v=[.569,.522,.38,1],y=a.NB_CELLS,b=2,w=a.CELL_WIDTH,M=Math.round(1.5*p),T=w+b,C=M+b,I=a.MAP_SCENE_WIDTH,A=a.MAP_SCENE_HEIGHT,S=a.MAP_LAYER_BACKGROUND;
t.makeTacticalBoxes=n,t.makeTacticalBackground=o,t.makeTacticGraphics=s},function(e,t,i){var n=i(184),o=n.CELL_HEIGHT,s=n.CELL_WIDTH,a=Math.round(1.5*o);e.exports.createTacticBlockImage=function(){var e=document.createElement("canvas");e.width=s,e.height=a;var t=e.getContext("2d");t.clearRect(0,0,s,a),t.fillStyle="#5A523C",t.strokeStyle="#CCCCCC";var i=[s/2,s,s,s/2,0,0],n=[0,o/2,o,a,o,o/2];t.beginPath(),t.moveTo(0,o/2);for(var r=0;r<i.length;r++)t.lineTo(i[r],n[r]);return t.closePath(),t.fill(),t.stroke(),t.lineTo(s/2,o),t.lineTo(s,o/2),t.moveTo(s/2,o),t.lineTo(s/2,a),t.stroke(),e}},function(e,t,i){function n(e){var t=e%14,i=Math.floor(e/14);return t+=i%2*.5,{x:t*a,y:.5*i*r}}function o(){for(var e=0;e<560;e+=1)l.push(n(e));return Object.freeze(l),l}var s=i(184),a=s.CELL_WIDTH,r=s.CELL_HEIGHT;t.getCellCoord=n;var l=[];t.cellCoord=o()},function(e,t){function i(e,t,i,n,o,s,a,r){this.x0=e,this.y0=t,this.x1=i,this.y1=n,this.x2=o,this.y2=s,this.x3=a,this.y3=r,this.cellId=null}e.exports=i},function(e,t,i){function n(e){s.call(this,e),this._boxes=e.boxes,this._hueContrast=e.hueContrast,this._boxByteSize=this.renderer.getNbBytesPerBox(),this._bbox=[1/0,-(1/0),1/0,-(1/0)],this._createVertexBuffer()}var o=i(191).inherits,s=i(421);o(n,s),e.exports=n,n.prototype._createBox=function(e,t){var i=this._boxes[e];this._expandToFitBox(i);var n=e*this._boxByteSize/4;this._positions[n+0]=i.x0,this._positions[n+1]=i.y0,this._colorView[n+3]=t,this._positions[n+5]=i.x2,this._positions[n+6]=i.y2,this._colorView[n+8]=t,this._positions[n+10]=i.x3,this._positions[n+11]=i.y3,this._colorView[n+13]=t,this._positions[n+15]=i.x0,this._positions[n+16]=i.y0,this._colorView[n+18]=t,this._positions[n+20]=i.x1,this._positions[n+21]=i.y1,this._colorView[n+23]=t,this._positions[n+25]=i.x2,this._positions[n+26]=i.y2,this._colorView[n+28]=t},n.prototype._createVertexBuffer=function(){var e=this._boxes.length;this._vertexBuffer=new window.ArrayBuffer(e*this._boxByteSize),this._positions=new window.Float32Array(this._vertexBuffer),this._colorView=new window.Uint32Array(this._vertexBuffer);var t=1077952576,i=943734848;if(this._hueContrast)for(var n=0,o=!1,s=0;s<e;s+=1){var a=this._boxes[s];a.x0>n?(n=a.x0,this._createBox(s,o?i:t)):(n=0,o=!o,this._createBox(s,o?i:t))}else for(var r=0;r<e;r+=1)this._createBox(r,t);this._bbox[0]+=this._x,this._bbox[1]+=this._x,this._bbox[2]+=this._y,this._bbox[3]+=this._y,this.renderer.releaseBuffer(this.id),this.forceRefresh()},n.prototype.draw=function(){this.renderer.drawBoxBatch(this.id)},n.prototype._expandToFitPoint=function(e,t){this._bbox[0]>e&&(this._bbox[0]=e),this._bbox[2]>t&&(this._bbox[2]=t),this._bbox[1]<e&&(this._bbox[1]=e),this._bbox[3]<t&&(this._bbox[3]=t)},n.prototype._expandToFitBox=function(e){this._expandToFitPoint(e.x0,e.y0),this._expandToFitPoint(e.x1,e.y1),this._expandToFitPoint(e.x2,e.y2),this._expandToFitPoint(e.x3,e.y3)},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=this._positions,n=!1;this.renderer.loadSpriteBuffer(t,i,null,this._bbox,n),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t,i){function n(e,t){s.call(this,e),this.w=e.w||0,this.h=e.h||0,this.texture=t}var o=i(191).inherits,s=i(421);o(n,s),e.exports=n,n.prototype.render=function(){this.renderer.save(),this.renderer.multiplyColor(this.tint[0],this.tint[1],this.tint[2],this.tint[3]),this.renderer.drawImage(this.texture,this._x,this._y,this.w*this._scaleX,this.h),this.renderer.restore()},n.prototype.generateCurrentFrameData=function(){return[0,this.w,0,this.h]},n.prototype.clear=function(){this.texture&&this.texture.release()}},function(e,t,i){function n(){u.call(this,"div",{className:"NotificationBar",hidden:!0}),this.notificationType=h.notificationType,a(this),this.currentOpenedId=null,this.dialogs={},this.container=this.createChild("div",{className:"container"}),this.counter=this.createChild("div",{className:"counter"});var e=this;this.on("dragStart",function(){e.hideDialog(e.currentOpenedId)}),window.gui.on("disconnect",function(){e.clearNotifications()})}i(761);var o=i(202),s=i(191).inherits,a=i(658),r=i(250),l=i(227),c=i(246),u=i(235),d=i(258).playUiSound,h=i(762),p=h.notificationImageInfo,m=12,f="blue";s(n,u),e.exports=n,n.prototype._updateCounter=function(){var e=this.container.getChildren().length;this.counter.setText(e),this.toggleDisplay(e)},n.prototype._repositionDialog=function(e){var t=this.dialogs[e],i=this.container.getChild(e);r.positionNextTo(t,i)},n.prototype._destroyNotification=function(e,t){if(this.dialogs[e]){this.dialogs[e].destroy(),delete this.dialogs[e];var i=this.container.getChild(e),n=i.getChild("icon");if("function"==typeof n.cancelTween&&n.cancelTween(),i.destroy(),this._updateCounter(),!t&&this.currentOpenedId)if(e===this.currentOpenedId){this.currentOpenedId=null;var o=this.container.getChildren();if(o.length){var s=o[o.length-1].getWuiName();this.showDialog(s,!0)}}else this._repositionDialog(this.currentOpenedId)}},n.prototype.clearNotifications=function(){for(var e in this.dialogs)this._destroyNotification(e,!0);this.currentOpenedId=null},n.prototype._notificationButtonAction=function(e){return this.currentOpenedId===e?this.hideDialog(e):void this.showDialog(e)},n.prototype._createDialog=function(e,t){function i(){o.removeNotification(e),t.onClose&&t.onClose(-1)}function n(){var i=this.index,n=t.buttons[i].action(i);switch(n){case"HIDE_DIALOG":o.hideDialog(e);break;default:o.removeNotification(e)}}var o=this,s=new u("div");s.createChild("div",{className:"dialogTitle",text:t.title}),s.appendChild(new c({className:"closeBtn"},i)),t.wuidom?(s.createChild("div",{className:"dialogText"}),s.appendChild(t.wuidom)):s.createChild("div",{className:"dialogText",text:t.text});var a=s.createChild("div",{className:"buttons"});if(t.buttons){t.buttons.length>1&&!t.onClose&&console.warn("Notification needs an onClose function");for(var r=0;r<t.buttons.length;r++){var l=a.appendChild(new c({className:"button",text:t.buttons[r].label},n));l.index=r}}var d=window.gui.gameGuiContainer.createChild("div",{className:"NotificationDialog"});d.appendChild(s),this.dialogs[e]=d},n.prototype._createNotification=function(e,t){var i=this;this.isNotificationOpen(e)&&(console.error(new Error("notif "+e+" already existing, destroy.")),this._destroyNotification(e));var n=this.container.createChild("div",{className:"notificationButton",name:e}),s=n.appendChild(new c({className:["icon","spinner"],name:"icon"},function(){i._notificationButtonAction(this.notifId)}));s.notifId=e;var a="",r="";if(!isNaN(t.type)){var u=p[t.type]||{};a=u.icon||a,r=u.color||r}a=t.iconId||a,r=t.iconColor||r;var d=["gfx/notifications/"+(a||m)+".png","gfx/notifications/"+(r||f)+".png"];o.preloadImages(d,function(o){if(s&&s.rootElement&&(s.setStyle("backgroundImage",o[0]+", "+o[1]),s.delClassNames("spinner"),t.timer)){var a=parseInt(t.timer,10),r=n.createChild("div",{className:"timer"}),c=l.tween(r,{height:"100%"},{time:a,easing:"linear"},function(){i.removeNotification(e)});s.cancelTween=c.cancel}})},n.prototype.showDialog=function(e,t){this.hideDialog(this.currentOpenedId),this.currentOpenedId=e;var i=this.container.getChild(e);i.addClassNames("opened"),t&&i.rootElement.scrollIntoView(!1),this._repositionDialog(e),d("NEW_TIPS")},n.prototype.hideDialog=function(e){if(e&&e===this.currentOpenedId){var t=this.container.getChild(e);t.delClassNames("opened"),this.currentOpenedId=null,this.dialogs[e].hide()}},n.prototype.removeNotification=function(e){var t=this.dialogs[e];if(t){var i=this;window.setTimeout(function(){i._destroyNotification(e)},0)}},n.prototype.newNotification=function(e,t){this._createNotification(e,t),this._updateCounter(),this._createDialog(e,t),this.showDialog(e,!0)},n.prototype.isNotificationOpen=function(e){return!!this.dialogs[e]}},function(e,t){},function(e,t){var i={TUTORIAL:0,ERROR:1,INVITATION:2,PRIORITY_INVITATION:3,INFORMATION:4};t.notificationType=i,t.notificationPriority=[i.ERROR,i.PRIORITY_INVITATION,i.INVITATION,i.INFORMATION,i.TUTORIAL];var n={};n[i.TUTORIAL]={icon:11,color:"green"},n[i.ERROR]={icon:11,color:"red"},n[i.INVITATION]={icon:12,color:"blue"},n[i.PRIORITY_INVITATION]={icon:10,color:"blue"},n[i.INFORMATION]={icon:27,color:"yellow"},t.notificationImageInfo=n},function(e,t,i){function n(){this.inDialog=!1,this.npcData=null,this.npcActorId=null,this.uiReplyHandler=this._uiReplyHandler.bind(this),this._setListeners()}function o(e,t){for(var i=0;i<t.length;i++)e=e.replace("#"+(i+1),t[i]);return e}var s=i(30),a=i(7);e.exports=n,n.prototype._setListeners=function(){var e=window.dofus.connectionManager,t=this;e.on("NpcGenericActionFailureMessage",function(){window.foreground.unlock("npcActionRequest")}),e.on("NpcDialogCreationMessage",function(e){t.npcActorId=e.npcId,window.foreground.lock("npcActionRequest")}),e.on("GameContextCreateMessage",function(){window.foreground.unlock("npcActionRequest")}),window.isoEngine.on("mapLoaded",function(){window.foreground.unlock("npcActionRequest")}),e.on("NpcDialogQuestionMessage",function(e){if(!t.npcData){var i=window.actorManager.getActor(t.npcActorId).data.npcData;t.prepareDialog(i)}a.log("Game_Action.Talk_To_NPC",{message_id:e.messageId,npc_id:t.npcData.id}),t.nextQuestionAsync(e.messageId,e.visibleReplies,e.dialogParams)}),e.on("LeaveDialogMessage",function(){window.foreground.unlock("npcActionRequest"),t.inDialog&&(window.gui.npcDialogUi.leaveDialog(),t.inDialog=!1)}),e.on("ExchangeLeaveMessage",function(){window.foreground.unlock("npcActionRequest")})},n.prototype.prepareDialog=function(e){this.npcData=e;var t,i,n=this.msgTextIds={};for(i=0;i<e.dialogMessages.length;i++)t=e.dialogMessages[i],n[t[0]]=t[1];for(n=this.replyTextIds={},i=0;i<e.dialogReplies.length;i++)t=e.dialogReplies[i],n[t[0]]=t[1]},n.prototype.nextQuestionAsync=function(e,t,i){this.inDialog=!0,this.replyIds=t,window.gui.npcDialogUi.prepareForNextQuestion(this.npcData,t.length);for(var n=this.msgTextIds[e],a=[n],r=0;r<t.length;r++)a.push(this.replyTextIds[t[r]]);var l=this;s.getText(a,function(e,s){if(e)return console.error("Failed to get texts for NPC. textIds:",a,"error:",e),l._closeDialog();var c=o(s[n],i),u=[];for(r=0;r<t.length;r++)u.push(s[l.replyTextIds[t[r]]]);l._showUi(c,u)})},n.prototype._uiReplyHandler=function(e){(null!==e||null===e&&this.replyIds.length>0)&&a.log("Game_Action.Player_Answer_To_NPC",{answer_id:this.replyIds[e],npc_id:this.npcData.id}),null!==e?window.dofus.sendMessage("NpcDialogReplyMessage",{replyId:this.replyIds[e]}):this._closeDialog()},n.prototype._closeDialog=function(){window.dofus.sendMessage("LeaveDialogRequestMessage",null),this.npcData=null},n.prototype._showUi=function(e,t){var i={npcData:this.npcData};window.gui.npcDialogUi.showNpcQuestion(e,t,this.uiReplyHandler,i)}},function(e,t,i){function n(){f.call(this,"div",{className:"npcDialogUi",hidden:!0}),this.inDialog=!1,this.replyHandler=null,this.npcName=null,this.currentMsg=null,this.msgBubble=null,this.singleMsgBubbles={},this.isZoomed=!1,this.isChangingZoom=!1,this.uiBox=null,window.gui.on("disconnect",this._closeDialog.bind(this)),this.highlightRepliesFunc=this._highlightReplies.bind(this)}function o(){this.myUi._sendReply(null)}function s(){var e=window.gui.tutorialManager;e.inTutorial&&e.tutorialStep.checkAnswerNPC(),this.myUi._sendReply(this.replyId)}function a(){var e=this.myUi.replyTabs;e.swipeNegative()}function r(){var e=this.myUi.replyTabs;e.swipePositive()}function l(){var e=this.myUi;e.leftBtn.setEnable(!!this.leftTab),e.rightBtn.setEnable(!!this.rightTab)}function c(e,t,i,n,o){e.replyId=t,e.setText(i),e.enable(),e.setStyles({width:n,lineHeight:w+"px",minHeight:o+"px"}),e.show()}i(765);var u=i(246),d=i(183).dimensions,h=i(252),p=i(191).inherits,m=i(611),f=i(235),g=150,_=10,v=4,y=10,b=4,w=22,M=50,T=70,C={1:"100%",2:"50%",3:"33.3%",4:"25%"},I="25%",A={1:"40%",2:"60%"},S="100%";p(n,f),e.exports=n,n.prototype._closeDialog=function(){this.inDialog&&(this.inDialog=!1,window.foreground.removeListener("dom.touchend",this.highlightRepliesFunc),this.replyHandler&&this._sendReply(null),this._closeMsgBubble(),this.hide(),this._restoreZoom(),window.gui.boxArranger.removeBox(this.uiBox),this.uiBox=null,this.emit("closed"))},n.prototype._closeMsgBubble=function(){this.msgBubble&&(this.msgBubble.close(),this.msgBubble=null)},n.prototype._newButton=function(e,t,i){var n=e.appendChild(new u({className:t,addIcon:!0},i));return n.myUi=this,n},n.prototype._createContent=function(){this.setStyles({left:d.mapLeft+y+"px",width:d.mapWidth-2*y+"px",bottom:d.screenHeight-d.screenExceptToolbar.height+v+"px"});var e=this.frame=this.createChild("div",{className:"frame"});this.leftBtn=this._newButton(e,"leftBtn",a);var t=this.replyTabs=e.appendChild(new m({noHeader:!0,noCycling:!0}));t.myUi=this,t.on("openTab",l),this.replyElts=[],this.replyBoxes=[],this.numReplyTabs=0,this.numUsedReplyTabs=0,this.rightBtn=this._newButton(e,"rightBtn",r),this.closeBtn=this._newButton(e,"closeBtn",o)},n.prototype._prepareReplyButtons=function(){for(var e=this.replies,t=e.length,i=Math.ceil(t/b),n=this.numReplyTabs;n<i;n++){var o=this.replyBoxes[n]=new f("div",{className:"replyBox"});this.replyTabs.addTab("",o,n),this.numReplyTabs++;for(var a=0;a<b;a++){var r=o.appendChild(new u({className:"reply"},s));r.myUi=this,this.replyElts.push(r)}}for(n=t;n<this.replyElts.length;n++)this.replyElts[n].hide();for(this.leftBtn.toggleDisplay(i>1),this.rightBtn.toggleDisplay(i>1),this.replyBoxes[0].setStyle("textAlign",i>1?"left":"center"),n=this.numUsedReplyTabs;n<this.numReplyTabs;n++)this.replyTabs.toggleTabAvailability(n,n<i);this.numUsedReplyTabs=i;var l=C[t]||I;for(n=0;n<t;n++)c(this.replyElts[n],n,e[n],l,M)},n.prototype.getNpcReplyButtonForTuto=function(e){if(!this.isVisible())return null;var t=this.replyElts[e];return t},n.prototype._setAllReplyBoxesVisibility=function(e){for(var t=0;t<this.numUsedReplyTabs;t++)this.replyBoxes[t].toggleDisplay(e)},n.prototype._resizeAndAppear=function(e){this.replyTabs.setStyle("opacity",0),this._setAllReplyBoxesVisibility(!1),this._prepareReplyButtons(),this._setAllReplyBoxesVisibility(!0),e&&(this.setStyle("opacity",0),this.show());var t=A[this.replies.length]||S;this.frame.setStyles({width:t});for(var i,n=T,o=this.replies,s=0;s<o.length;s++)i=this.replyElts[s].rootElement.offsetHeight,n=Math.max(n,i);for(this.replyTabs.setStyle("min-height",n+"px"),s=0;s<o.length;s++){var a=this.replyElts[s];if(i=a.rootElement.offsetHeight,i!==n){var r=1+(i-M)/w,l=Math.round(w+(n-i)/r);a.setStyles({"line-height":l+"px",minHeight:n+"px"})}}if(this.replyTabs.reopen(),this.leftBtn.setEnable(!!this.replyTabs.leftTab),this.rightBtn.setEnable(!!this.replyTabs.rightTab),this.closeBtn.toggleDisplay(!window.gui.tutorialManager.inTutorial),this.replyTabs.setStyle("opacity",1),e){var c=this.rootElement;this.uiBox=window.gui.boxArranger.addObstacle(0,c.offsetTop-_,d.screenWidth,c.offsetHeight),this._waitZoomChange(this._appear)}},n.prototype._appear=function(){h.showProgressively(this,g)},n.prototype._waitZoomChange=function(e){if(!this.isChangingZoom)return e&&e.call(this);var t=this,i=window.isoEngine.mapScene.camera;i.once("atDestination",function(){return t.isChangingZoom&&(t.isChangingZoom=!1,t.isZoomed&&i.freeze()),e&&e.call(t)})},n.prototype._zoomOnActor=function(e){if(this.isZoomed)return this._waitZoomChange(e);this.isZoomed=!0,this.isChangingZoom=!0;var t=this.actor.bbox,i=window.isoEngine.mapScene.camera;this.previousZoom=i.zoom,this.previousCameraX=i.x,this.previousCameraY=i.y,i.zoom!==i.maxZoom&&i.zoomTo(i.maxZoom),i.moveTo(t[1],t[2],!0),this._waitZoomChange(e)},n.prototype._restoreZoom=function(e){if(!this.isZoomed)return this._waitZoomChange(e);this.isZoomed=!1,this.isChangingZoom=!0;var t=window.isoEngine.mapScene.camera;t.unfreeze(),t.zoom!==this.previousZoom&&t.zoomTo(this.previousZoom),t.moveTo(this.previousCameraX,this.previousCameraY,!0),this._waitZoomChange(e)},n.prototype._sendReply=function(e){if(this.replyHandler){null!==e&&this.replyElts[e].disable(),this._closeMsgBubble();var t=this.replyHandler;this.replyHandler=null,t(e)}},n.prototype._bubbleTapHandler=function(){return 1===this.replies.length?this._sendReply(0):void this._highlightReplies()},n.prototype._showLockedBubble=function(){this.replyHandler&&(this.bubbleTapHandler||(this.bubbleTapHandler=this._bubbleTapHandler.bind(this)),this.msgBubble=window.gui.newSpeechBubble({msg:this.currentMsg,title:this.npcName,actor:this.actor,isLocked:!0,action:this.bubbleTapHandler,isNonChat:!0}))},n.prototype._showSingleMsgBubble=function(){var e=this,t=this.npcName;this.singleMsgBubbles[t]=window.gui.newSpeechBubble({msg:this.currentMsg,title:t,actor:this.actor,isNonChat:!0,onClose:function(){delete e.singleMsgBubbles[t]}}),this._sendReply(null)},n.prototype._closeSingleMsgBubbles=function(){for(var e in this.singleMsgBubbles)this.singleMsgBubbles[e].close()},n.prototype._highlightReplies=function(){var e=this.frame.createChild("div",{className:"highlight"});window.setTimeout(function(){e.destroy()},250)},n.prototype._showQuestion=function(){this.frame||this._createContent();var e=!this.inDialog;this.inDialog=!0,this._closeSingleMsgBubbles(),e?this._zoomOnActor(this._showLockedBubble):this._showLockedBubble(),this._resizeAndAppear(e),e&&window.foreground.on("dom.touchend",this.highlightRepliesFunc),this.emit("opened")},n.prototype.prepareForNextQuestion=function(e,t){t?this.inDialog||(this.actor=window.actorManager.getActorFromNpcId(e.id),this._zoomOnActor()):this._restoreZoom()},n.prototype.showNpcQuestion=function(e,t,i,n){if(null!==this.replyHandler&&console.error("previous replyHandler was not called"),n=n||{},this.replies=t,this.replyHandler=i,this.actor=n.actor||window.actorManager.getActorFromNpcId(n.npcData.id),this.npcName=n.npcData&&n.npcData.nameId,this.currentMsg=e,0===t.length){if(this.singleMsgBubbles[this.npcName])return this._sendReply(null);this.hide(),this._restoreZoom(this._showSingleMsgBubble)}else this._showQuestion()},n.prototype.leaveDialog=function(){this._closeDialog()}},function(e,t){},function(e,t,i){function n(){_.call(this,"div",{className:"numberInputPad",hidden:!0}),this.digits=[],this.overlay=window.gui.gameGuiContainer.createChild("div",{className:"numberPadOverlay",hidden:!0})}function o(){this.numberInput._tapOnKey(this.id)}function s(){this.numberInput._tapOnDisplay(this.id)}i(767);var a,r=i(246),l=i(246).DofusButton,c=i(183).dimensions,u=i(29).getText,d=i(658),h=i(252),p=i(191).inherits,m=i(277),f=i(228),g=i(248),_=i(235),v=m.MAX_NUMBER,y=v.toString().length,b={DISPLAY:0,INSERT:1,EDIT:2},w=["7","8","9","4","5","6","1","2","3","BS","0","000","CLR","ENTER"],M={BS:"@",ENTER:"@ENTER",CLR:"CLR"},T=10;p(n,_),e.exports=n,n.prototype.open=function(e,t,i,n){this.keyboard||this._createContent(),this.inputBox=e,t&&this.title.setText(t),this.minValue=void 0!==i?i:0,this.maxValue=void 0!==n?n:v,this.setValue(e.getValue()),this._switchMode(b.DISPLAY),this._show()},n.prototype._show=function(){if(this.overlay.show(),this.setStyle("opacity",0),this.show(),!a){var e=this.digitBoxes[0].rootElement;a=e.offsetTop+e.offsetHeight/2}var t=this.inputBox.rootElement.getBoundingClientRect(),i=this.rootElement.getBoundingClientRect(),n=t.right-i.width,o=t.top+t.height/2-a;n=Math.min(Math.max(n,T),c.screenWidth-T-i.width),o=Math.min(Math.max(o,T),c.screenHeight-T-i.height),this.setStyles({left:n+"px",top:o+"px"}),this.setStyle("opacity",1),this.rootElement.focus()},n.prototype._createContent=function(){var e=this;window.gui.on("disconnect",function(){e.hide()}),this.on("hide",function(){e.overlay.hide()});var t=this.createChild("div",{className:"titleBar"});d(this,{grip:t,isFullScreen:!0}),this.title=t.createChild("div",{className:"title"});var i=t.appendChild(new r({className:"closeButton",scaleOnPress:!0}));i.on("tap",function(){e.hide()}),this.digitBoxes=[],this.digitElements=[],this.separators=[];for(var n=this.createChild("div",{className:"displayContainer"}),a=u("ui.common.numberSeparator")||".",c=0;c<y;c++){var h=y-1-c,p=h%3===2;p&&(this.separators[h+1]=n.createChild("div",{className:"separator",text:a}));var m=this.digitBoxes[h]=n.createChild("div",{className:"digitBox"});p&&m.addClassNames("groupStart"),m.id=h,m.numberInput=this,f(m),m.on("tap",s),this.digitElements[h]=m.createChild("div",{className:"digit"})}this.keyMap={};var g=this.createChild("div",{className:"keyboardContainer"}),_=this.keyboard=g.createChild("div",{className:"keyboard"});for(c=0;c<w.length;c++){var v=w[c],b=M[v]||v,T=this.keyMap[v]=new l(b,{className:["keyboardKey","key"+v]});"@"===b[0]&&(b.length>1&&T.createChild("div",{text:b.substr(1)}),T.createChild("div",{className:"keyIcon"})),_.appendChild(T),T.id=v,T.numberInput=this,T.on("tap",o)}};var C=/[^0-9]/g;n.prototype.setValue=function(e){"string"==typeof e?(e=e.replace(C,"").toString(),e||(e="0")):e=e.toFixed(),e.length>=y&&(e=e.substr(0,y));for(var t=y-1;t>=e.length;t--)this._setDigit(t,"");for(var i=0;i<e.length;i++)this._setDigit(t,e[i]),t--;"0"===e&&this._switchMode(b.DISPLAY)},n.prototype._getValue=function(){for(var e="",t=y-1;t>=0;t--)e+=this.digits[t];return parseInt(e,10)},n.prototype._enableKey=function(e,t){t?this.keyMap[e].enable():this.keyMap[e].disable()},n.prototype._switchMode=function(e){e!==this.mode&&(this.mode===b.EDIT&&e!==b.EDIT&&this._setCursor(-1),this.mode=e,this._enableKey("BS",this.mode===b.INSERT),this._enableKey("0",this.mode!==b.DISPLAY),this._enableKey("000",this.mode!==b.DISPLAY))},n.prototype._setCursor=function(e){this.cursor>=0&&this.digitBoxes[this.cursor].delClassNames("highlight"),this.cursor=e,this.cursor>=0&&this.digitBoxes[e].addClassNames("highlight")},n.prototype._tapOnDisplay=function(e){this.mode!==b.EDIT&&this._switchMode(b.EDIT),this._setCursor(e)},n.prototype._tapOnKey=function(e){switch(e){case"ENTER":return this._doEnter();case"CLR":return this._doClear();case"000":return this._do000();case"BS":return this._doBackspace();default:return this._doDigit(e)}},n.prototype._doEnter=function(){this._switchMode(b.DISPLAY);var e=this._getValue();return e>this.maxValue?g.showNotification(u("tablet.common.maxValue",h.intToString(this.maxValue)),this.keyMap.ENTER):e<this.minValue?g.showNotification(u("tablet.common.minValue",h.intToString(this.minValue)),this.keyMap.ENTER):(this.inputBox.setValue(e,!0),void this.hide())},n.prototype._doClear=function(){this.setValue("0")},n.prototype._doBackspace=function(){if(this.mode===b.INSERT){var e=Math.floor(this._getValue()/10);this.setValue(e)}},n.prototype._do000=function(){for(var e=0;e<3;e++)this._doDigit("0")},n.prototype._doDigit=function(e){switch(this.mode){case b.DISPLAY:if("0"===e&&0===this._getValue())return;return this.setValue(e),this._switchMode(b.INSERT);case b.INSERT:if(""!==this.digits[y-1])return;return this.setValue(10*this._getValue()+~~e);case b.EDIT:return this._setDigit(this.cursor,e),this._fixZeroes(this.cursor,e),0===this.cursor?this._switchMode(b.INSERT):this._setCursor(this.cursor-1)}},n.prototype._setDigit=function(e,t){this.digitElements[e].setText(t),this.digits[e]=t,this.separators[e]&&this.separators[e].toggleDisplay(""!==t)},n.prototype._fixZeroes=function(e,t){if(0!==e){for(var i=y-1;i>=e;i--){var n=this.digits[i];if("0"!==n&&""!==n)break;"0"===n&&this._setDigit(i,"")}if("0"!==t)for(i=e-1;i>=0&&""===this.digits[i];i--)this._setDigit(i,"0")}}},function(e,t){},function(e,t,i){function n(){u.call(this,"div",{className:"Party",hidden:!0}),h(this,{isCollapsable:!0}),this.numParties=0,this.hasParty={},this.currentPartyType=null,this.currentParty=null,this.invitedFrom={},this.partyTypesById={},this.setupEvents()}function o(e){return e===g.PARTY_TYPE_ARENA?g.PARTY_TYPE_CLASSICAL:g.PARTY_TYPE_ARENA}function s(e,t){var i=e.memberData,n=t.memberData,o=i.initiative||0,s=n.initiative||0,a=i.LifePoints||0,r=n.LifePoints||0,l=i.maxLifePoints||0,c=n.maxLifePoints||0;return o>s?-1:o===s&&o*a/l>s*r/c?-1:1}i(769);var a=i(248).addTooltip,r=i(183).dimensions,l=i(678),c=i(191).inherits,u=i(235),d=i(246),h=i(658),p=i(29),m=p.getText,f=p.processTextWithModifier,g=i(623),_=i(415),v=i(457),y=i(412),b=i(225),w=i(483);c(n,u),e.exports=n,n.prototype._reset=function(){this.hide(),this._cleanData(g.PARTY_TYPE_CLASSICAL,!0),this._cleanData(g.PARTY_TYPE_ARENA,!0)},n.prototype._selectPartyType=function(e){var t=e===g.PARTY_TYPE_ARENA;this.toggleClassName("arena",t),this.currentPartyType=e,this.currentParty=t?this.arenaParty:this.classicParty,this.classicParty.toggleDisplay(!t),this.arenaParty.toggleDisplay(t)},n.prototype._createContent=function(){var e=this;this.setStyle("max-height",r.mapHeight+"px"),this.createChild("div",{className:"gripIcon"}),this.scroller=this.appendChild(new w({className:"partyScroller"}));var t=this.switchPartyButton=this.scroller.content.appendChild(new d({className:"switchPartyButton",hidden:!0}));t.createChild("div",{className:"iconGroup"}),t.createChild("div",{className:"separator"}),t.createChild("div",{className:"iconArena"}),t.on("tap",function(){e._selectPartyType(o(e.currentPartyType))});var i=this.scroller.content.appendChild(new d({className:["optionsButton","greenButton"]}));i.createChild("div",{className:"icon"}),i.on("tap",function(){var t=e.currentParty;window.gui.openContextualMenuAround("partyOptions",i,{partyType:e.currentPartyType,partyId:e.currentParty.partyId,isLoyal:t.isLoyal,isRestricted:t.isRestricted,isLeader:t.partyLeaderId===window.gui.playerData.id})}),this.partyBoxes=this.scroller.content.createChild("div",{className:"partyBoxes"}),this.classicParty=this.partyBoxes.createChild("div",{className:["partyBox","classic"],name:g.PARTY_TYPE_CLASSICAL}),this.arenaParty=this.partyBoxes.createChild("div",{className:["partyBox","arena"],name:g.PARTY_TYPE_ARENA,hidden:!0}),this.setStyles({left:r.mapRight-90+"px"}),this.show();var n=this.scroller.rootElement.offsetTop;this.scroller.setStyle("maxHeight",r.mapHeight-n+"px"),this.scroller.refresh()},n.prototype.addMember=function(e,t){var i=this.partyBoxes.getChild(e),n=t.id||t.guestId,o=i.createChild("div",{className:"member",name:n}),s=new _({name:"characterDisplay",scale:"fitin"});o.appendChild(s),o.on("tap",function(){window.gui.openContextualMenuAround("player",o,{playerId:t.id||t.guestId,playerName:t.name})});var a=o.createChild("div",{className:"hpBar",name:"hpBar"});o.hp=a.createChild("div",{className:"hp",name:"hp"}),o.createChild("div",{className:"pendingIcon",name:"pendingIcon",text:"?"}),o.createChild("div",{className:"leaderIcon",name:"leaderIcon"});var r=o.createChild("div",{className:"followingBadge"});r.createChild("div",{className:"icon"}),this.updateMember(e,t),this.scroller.refresh(),this.emit("resized")},n.prototype.updateMember=function(e,t){var i=this.partyBoxes.getChild(e),n=t.id||t.guestId,o=i.partyLeaderId===n,a=i.getChild(n);if(a){a.memberData=t,this._updateMemberTooltip(a,o);for(var r=i.getChildren(),l=r.sort(s),c=0;c<l.length;c+=1){var u=i.removeChild(l[c]);i.appendChild(u)}var d=a.getChild("characterDisplay"),h=t.entityLook||t.guestLook;d.setLook(h,{riderOnly:!0,direction:v.DIRECTION_SOUTH_WEST,animation:"AnimArtwork",boneType:"timeline/",skinType:"timeline/"}),a.hp.setStyle("height",t.lifePoints/t.maxLifePoints*100+"%"),a.toggleClassName("guest",!!t.guestId),a.toggleClassName("leader",o)}},n.prototype.addOrUpdateMember=function(e,t){var i=this._getPartyById(e);if(i){var n=i.getChild(t.id);n?(n.memberData=t,this.updateMember(i.type,t)):this.addMember(i.type,t)}},n.prototype.getMemberById=function(e,t){var i=this._getPartyById(e);if(i){var n=i.getChild(t);if(n)return n.memberData}},n.prototype._getPartyById=function(e){var t=this.partyTypesById[e];return t?this.partyBoxes.getChild(t):null},n.prototype._joinParty=function(e,t,i,n,o){this.partyBoxes||this._createContent(),this.hasParty[e]=!0,this.numParties++,this.partyTypesById[t]=e;var s=this.partyBoxes.getChild(e);s.type=e,s.partyLeaderId=i,s.partyId=t,s.isLoyal=!1,s.isRestricted=!0;for(var a=0;a<n.length;a+=1)s.getChild(n[a].id)?this.updateMember(e,n[a]):this.addMember(e,n[a]);for(a=0;a<o.length;a+=1)s.getChild(o[a].id)?this.updateMember(e,o[a]):this.addMember(e,o[a]);this._selectPartyType(e),this.numParties>=2&&this.switchPartyButton.show(),1===this.numParties&&this.show(),this.emit("resized")},n.prototype._cleanData=function(e,t){if(e&&this.hasParty[e]){this.hasParty[e]=!1,this.numParties--;var i=this.partyBoxes.getChild(e);i.hide(),i.clearContent(),delete i.partyLeaderId;for(var n in this.partyTypesById)parseInt(this.partyTypesById[n],10)===e&&delete this.partyTypesById[n];this.switchPartyButton.hide(),this.numParties>0?this._selectPartyType(o(e)):this.hide(),e===g.PARTY_TYPE_ARENA&&this.removeArenaFightQuestion(),t||this.emit("resized")}},n.prototype._removeMember=function(e,t){var i=this._getPartyById(e);i&&(i.getChild(t).destroy(),this.removeTeleportQuestion(t),this.scroller.refresh(),this.emit("resized"))},n.prototype.setupEvents=function(){var e=this,t=window.gui,i=t.playerData.partyData,n=window.dofus.connectionManager;t.on("disconnect",function(){e._reset()}),t.on("PartyJoinMessage",function(t){e._joinParty(t.partyType,t.partyId,t.partyLeaderId,t.members,t.guests)}),i.on("partyLeaderUpdate",function(t,i){var n=e._getPartyById(t);if(n){var o=n.getChild(n.partyLeaderId),s=n.getChild(i);n.partyLeaderId=i,e.updateMember(n.type,o.memberData),e.updateMember(n.type,s.memberData)}}),t.on("PartyNewGuestMessage",function(t){var i=e._getPartyById(t.partyId);if(i){var n=t.guest;n.hostName=i.getChild(n.hostId).memberData.name,e.addMember(i.type,n),i.partyId=t.partyId}}),i.on("partyMemberLeaving",function(t,i){e._removeMember(t,i)}),i.on("partyNewMember",function(t,i){e.addOrUpdateMember(t,i)}),i.on("partyUpdateMember",function(t,i){e.addOrUpdateMember(t,i)}),i.on("playerLeavingParty",function(t){e._cleanData(e.partyTypesById[t])}),t.on("GameRolePlayArenaFightPropositionMessage",function(t){e.showArenaFightQuestion(t.fightId)}),t.on("GameRolePlayArenaFighterStatusMessage",function(t){t.accepted||e.removeArenaFightQuestion(t.fightId)}),i.on("partyInvitationCancelled",function(i,n){if(t.playerData.id!==n){var o=e.invitedFrom[i],s=m("ui.party.invitationCancelledForGuest",o);t.chat.logMsg(s),t.notificationBar.removeNotification("party"+i)}}),i.on("partyGuestLeaving",function(n,o,s){var a=i.getGuestName(n,o);if(s){if(s!==t.playerData.characterBaseInformations.id){var r=i.getMemberName(s);t.chat.logMsg(m("ui.party.invitationCancelled",r,a))}}else t.chat.logMsg(m("ui.party.invitationRefused",a));e._removeMember(n,o)}),t.on("PartyFollowStatusUpdateMessage",function(t){if(t.success){var i=e._getPartyById(t.partyId);if(i){var n=i.getChild(e.followedId);if(e.followedId&&(n?n.delClassNames("following"):console.error(new Error("Cannot find the previous child "+e.followedId))),e.followedId=t.followedId,e.followedId){var o=i.getChild(e.followedId);o?o.addClassNames("following"):console.error(new Error("Cannot find the new child "+e.followedId))}}}}),t.on("PartyUpdateLightMessage",function(t){var i=e._getPartyById(t.partyId);if(i){var n=i.getChild(t.id).getChild("hpBar").getChild("hp");n.setStyle("height",t.lifePoints/t.maxLifePoints*100+"%")}}),n.on("TeleportBuddiesMessage",function(){t.openConfirmPopup({title:m("ui.common.confirm"),message:m("ui.party.teleportMembersProposition"),cb:function(e){n.sendMessage("TeleportBuddiesAnswerMessage",{accept:e})}})}),n.on("TeleportBuddiesRequestedMessage",function(e){for(var n=i.getMemberName(e.inviterId),o=[],s=0;s<e.invalidBuddiesIds.length;s++)o.push(i.getMemberName(e.invalidBuddiesIds[s]));var a=m("ui.party.teleportWish",n,e._dungeonName);o.length&&(a+=" "+f(m("ui.party.teleportCriterionFallenAngels"),o.length,o.join(", "))),t.chat.logMsg(a,y.CHANNEL_PARTY)}),n.on("TeleportToBuddyOfferMessage",function(t){e.showTeleportQuestion(t.buddyId,t.dungeonId,t._dungeonName,1e3*t.timeLeft)}),n.on("TeleportToBuddyCloseMessage",function(t){e.removeTeleportQuestion(t.buddyId)}),n.on("PartyRestrictedMessage",function(t){var i=e._getPartyById(t.partyId);
i&&(i.isRestricted=t.restricted)}),n.on("PartyLoyaltyStatusMessage",function(t){var i=e._getPartyById(t.partyId);i&&(i.isLoyal=t.loyal)})},n.prototype.showTeleportQuestion=function(e,t,i,n){function o(i){var n=1===i;n&&b.isDialogActive()&&b.closeAll(),window.isoEngine.cancelMoveAndDo(function(){window.dofus.connectionManager.sendMessage("TeleportToBuddyAnswerMessage",{dungeonId:t,buddyId:e,accept:n})})}var s=window.gui.playerData.partyData.getMemberName(e),a=window.gui.notificationBar,r={type:a.notificationType.PRIORITY_INVITATION,title:m("ui.common.invitation"),text:m("ui.party.teleportProposition",s,i),timer:n,buttons:[{label:m("ui.common.refuse"),action:o},{label:m("ui.common.accept"),action:o}],onClose:o};a.newNotification("teleport"+e,r)},n.prototype.removeTeleportQuestion=function(e){window.gui.notificationBar.removeNotification("teleport"+e)},n.prototype.showArenaFightQuestion=function(e){function t(t){var i=1===t;window.dofus.connectionManager.sendMessage("GameRolePlayArenaFightAnswerMessage",{fightId:e,accept:i})}this.arenaFightId=e;var i="arena"+e,n=window.gui.notificationBar,o={type:n.notificationType.PRIORITY_INVITATION,title:m("ui.common.koliseum"),text:m("ui.party.fightFound"),buttons:[{label:m("ui.common.refuse"),action:t},{label:m("ui.common.accept"),action:t}],onClose:t};n.newNotification(i,o)},n.prototype.removeArenaFightQuestion=function(e){e&&e!==this.arenaFightId&&console.error("removeArenaFightQuestion: bad fightId?"),this.arenaFightId&&(window.gui.notificationBar.removeNotification("arena"+this.arenaFightId),this.arenaFightId=null)},n.prototype.showPartyInvitationQuestion=function(e,t,i){function n(){return b.getWindow("partyInviteDetails").showPartyDetails(t),"HIDE_DIALOG"}function o(e){var i=e===-1?"PartyRefuseInvitationMessage":"PartyAcceptInvitationMessage";window.dofus.connectionManager.sendMessage(i,{partyId:t})}this.invitedFrom[t]=i;var s,a="party"+t;if(e===g.PARTY_TYPE_CLASSICAL)s=m("ui.party.playerInvitation",i);else{if(e!==g.PARTY_TYPE_ARENA)return console.error("Unknown party type "+e);s=m("ui.party.playerInvitationArena",i)}var r=window.gui.notificationBar,l={type:r.notificationType.INVITATION,title:m("ui.common.invitation"),text:s,buttons:[{label:m("ui.common.details"),action:n},{label:m("ui.common.accept"),action:o}],onClose:o};r.newNotification(a,l)},n.prototype.showPartyFightQuestion=function(e,t,i,n,o){function s(){window.gui.playerData.isSpectator&&window.dofus.connectionManager.sendMessage("GameContextQuitMessage"),window.dofus.connectionManager.sendMessage("GameFightJoinRequestMessage",{fightId:e,fighterId:t})}var a=window.gui.notificationBar,r={type:a.notificationType.PRIORITY_INVITATION,title:m("ui.party.teamFightTitle"),wuidom:l.process(m("ui.party.joinTeamFightQuestion",n,i)),timer:o,buttons:[{label:m("ui.common.join"),action:s}]};a.newNotification("partyFight"+e,r)},n.prototype.removePartyFightQuestion=function(e){window.gui.notificationBar.removeNotification("partyFight"+e)},n.prototype._updateMemberTooltip=function(e,t){a(e,function(){var i,n,o=e.memberData,s=e.getChild("tooltip");s||(s=new u("div",{className:"memberTooltip",name:"tooltip"}),s.createChild("div",{className:"stat",name:"leaderTitle",text:m("ui.party.leader")}),s.createChild("div",{className:"stat",name:"memberName"}),i=s.createChild("div",{className:"memberTips",name:"memberTips"}),n=s.createChild("div",{className:"guestTips",name:"guestTips"}),i.createChild("div",{className:"stat",name:"level"}),i.createChild("div",{className:"stat",name:"hp"}),i.createChild("div",{className:"stat",name:"prospecting"}),i.createChild("div",{className:"stat",name:"initiative"}),n.createChild("div",{className:"stat",name:"invitedBy"})),s.getChild("memberName").setText(o.name);var a=Boolean(o.guestId);i=s.getChild("memberTips"),n=s.getChild("guestTips"),i.toggleDisplay(!a),n.toggleDisplay(a);var r=m("ui.common.colon");if(a)s.getChild("leaderTitle").hide(),n.getChild("invitedBy").setText(m("ui.party.invitedBy")+r+"\n"+o.hostName);else{var l=o.lifePoints+" / "+o.maxLifePoints;s.getChild("leaderTitle").toggleDisplay(t),i.getChild("level").setText(m("ui.common.level")+r+o.level),i.getChild("hp").setText(m("ui.short.lifePoints")+r+l),i.getChild("prospecting").setText(m("ui.stats.prospecting")+r+o.prospecting),i.getChild("initiative").setText(m("ui.stats.initiative")+r+o.initiative)}return s})}},function(e,t){},function(e,t,i){function n(){function e(e){t.identification={accountCreation:e.accountCreation,accountId:e.accountId,communityId:e.communityId,hasRights:e.hasRights,hasConsoleRight:e.hasConsoleRight,accountSessionUid:e.login,login:t.loginName,nickname:e.nickname,secretQuestion:e.secretQuestion,subscriptionEndDate:e.subscriptionEndDate,wasAlreadyConnected:e.wasAlreadyConnected},s.setAccountInfo(e._groupFlags,e.accountId),t._setApplicationUsername(e._applicationName)}o.call(this);var t=this;this.loginName=null,this.identification={},this.characterBaseInformations={},this.characterBreed=null,this.accountCapabilities={},this.achievements={},this.lifePoints=0,this.maxLifePoints=0,this.movementPoints=0,this.actionPoints=0,this.isFightLeader=!1,this.isFighting=!1,this.isSpectator=!1,this.state=l.STATUS_ALIVE_AND_KICKING,this.experienceFactor=0,this.isForcedAccount=!1,this.shieldTutorialQuestId=1620,this.shieldTutorialQuestObjective=9560,this.alliance=new f,this.characters=new _,this.emoteData=new v,this.fightRequests=new y,this.guild=this.guildData=new b,this.inventory=new w,this.belongings=new g(this.inventory),this.jobs=new M,this.achievements=new T,this.position=new C,this.partyData=new I,this.quests=new A,this.socialData=new S,this.myShop=new E,this.alignment=new x,this.adminMenu=new L,this.ToaData=new N,this.ShopData=new O,window.dofus.connectionManager.on("IdentificationSuccessMessage",e),window.dofus.connectionManager.on("IdentificationSuccessWithLoginTokenMessage",e)}var o=i(194).EventEmitter,s=i(211),a=i(252),r=i(191).inherits,l=i(627),c=i(704),u=i(225),d=i(29).getText,h=i(522),p=i(28),m=i(493),f=i(771),g=i(773),_=i(776),v=i(777),y=i(778),b=i(780),w=i(783),M=i(789),T=i(790),C=i(791),I=i(792),A=i(796),S=i(799),E=i(800),x=i(801),L=i(802),N=i(803),O=i(804),D={};r(n,o),e.exports=n,n.prototype.initialize=function(e){this.alliance.initialize(e),this.characters.initialize(e),this.emoteData.initialize(e),this.fightRequests.initialize(e),this.guildData.initialize(e),this.inventory.initialize(e),this.jobs.initialize(e),this.achievements.initialize(e),this.position.initialize(e),this.partyData.initialize(e),this.quests.initialize(e),this.socialData.initialize(e),this.myShop.initialize(e),this.alignment.initialize(e),this.adminMenu.initialize({lang:window.Config.language}),this.ToaData.initialize(e),this.ShopData.initialize(e),this._setupListeners(e)},n.prototype.connectModules=function(e,t){this._selectCharacter(e),this.alliance.connect(),this.belongings.connect(),this.characters.connect(e.id),this.inventory.connect(),this.partyData.connect(),this.quests.connect(t),this.socialData.connect(),this.adminMenu.connect({lang:window.Config.language})},n.prototype.disconnectModules=function(){this.characters.disconnect(),this.emoteData.disconnect(),this.fightRequests.disconnect(),this.guildData.disconnect(),this.inventory.disconnect(),this.jobs.disconnect(),this.achievements.disconnect(),this.position.disconnect(),this.partyData.disconnect(),this.quests.disconnect(),this.socialData.disconnect(),this.myShop.disconnect(),this.adminMenu.disconnect(),this.ToaData.disconnect(),this.experienceFactor=0,this.accountCapabilities={},this.loginName=null,this.characterBaseInformations={},this.characterBreed=null,this.isForcedAccount=!1,this.state=l.STATUS_ALIVE_AND_KICKING,this._removeMount()},n.prototype._selectCharacter=function(e){this.id=e.id,a.storeMapAndEmit(this,this.characterBaseInformations,e,"characterInfosUpdated"),this.characterBreed=window.gui.databases.Breeds[e.breed],this.emit("setCharacterBreed"),this.emit("characterSelectedSuccess"),this.emit("lookUpdate",e.entityLook)},n.prototype._removeMount=function(){delete this.equippedMount,this.isRiding=!1},n.prototype._setupListeners=function(e){function t(e){e.informations.contextualId===i.id&&(i.characterBaseInformations.entityLook=e.informations.look,i.emit("lookUpdate",e.informations.look))}var i=this,n=window.dofus.connectionManager;n.on("AccountCapabilitiesMessage",function(e){i.adminMenu.setAccountCapabilities(e),i.accountCapabilities=e}),e.on("ServerExperienceModificatorMessage",function(e){i.experienceFactor=e.experiencePercent-100}),e.on("GameContextRefreshEntityLookMessage",function(e){e.id===i.id&&(i.characterBaseInformations.entityLook=e.look,i.emit("lookUpdate",e.look))}),n.on("GameFightRefreshFighterMessage",function(e){t(e)}),n.on("GameRolePlayShowActorMessage",function(e){t(e)}),e.on("mapComplementaryInformationsData",function(t){for(var n=e.playerData.characters.controlledCharacterId,o=0;o<t.actors.length;o++){var s=t.actors[o];if(s.contextualId===n){var a=i.characterBaseInformations.entityLook.skins,r=s.look.skins,l=!1;if(a.length!==r.length)l=!0;else for(var c=0;c<a.length;c++)if(a[c]!==r[c]){l=!0;break}return void(l&&(i.characterBaseInformations.entityLook=s.look,i.emit("lookUpdate",s.look)))}}}),e.on("CharacterLevelUpMessage",function(e){var t=i.characterBaseInformations.level;i.characterBaseInformations.level=e.newLevel,i.emit("characterLevelUp",{newLevel:e.newLevel,previousLevel:t}),i.emit("characterInfosUpdated"),i.evaluateRatingOpening("levelUp")}),n.on("CharactersListMessage",function(){i.adminMenu.runStartupCmd({isOnCharacterSelection:!0})}),n.on("StartupActionsListMessage",function(){i.adminMenu.runStartupCmd({isOnRP:!0})}),n.on("MountUnSetMessage",function(){if(i.equippedMount){var e=i.equippedMount.id;i._removeMount(),i.emit("unsetMount",e)}}),n.on("MountRidingMessage",function(e){i.isRiding=e.isRiding,i.emit("mountRiding",e.isRiding)}),n.on("MountSetMessage",function(e){i.equippedMount&&i.equippedMount.level<e.mountData.level&&window.gui.chat.logMsg(d("ui.mount.levelUp",[e.mountData.level])),i.equippedMount=e.mountData,i.equippedMount.mountLocation="equip",i.equippedMount.xpRatio=i.mountXpRatio,i.emit("setMount",e)}),n.on("MountXpRatioMessage",function(e){i.equippedMount&&(i.equippedMount.xpRatio=i.mountXpRatio=e.ratio,i.emit("setMountRatio",e.ratio))}),e.on("GameRolePlayPlayerLifeStatusMessage",function(e){var t=e.state;if(i.state=t,t===l.STATUS_TOMBSTONE){var n={title:d("ui.login.news"),message:d("ui.gameuicore.playerDied")+"\n\n"+d("ui.gameuicore.freeSoul"),cb:function(e){e&&window.dofus.sendMessage("GameRolePlayFreeSoulRequestMessage")}};u.getWindow("confirm").update(n),u.openDialog(["confirm"])}else t===l.STATUS_PHANTOM&&window.gui.openSimplePopup(d("ui.gameuicore.soulsWorld"),d("ui.login.news"))}),e.on("GameRolePlayGameOverMessage",function(){u.openDialog(["hardcoreDeath"])}),window.developmentMode&&(n.on("ExchangeStartedBidSellerMessage",function(e){a.checkBidHouseCategoriesAddendumIntegrity(e.sellerDescriptor.types,window.gui.databases.BidHouseCategories)}),n.on("ExchangeStartedBidBuyerMessage",function(e){a.checkBidHouseCategoriesAddendumIntegrity(e.buyerDescriptor.types,window.gui.databases.BidHouseCategories)}))},n.prototype.setForcedAccount=function(e){this.isForcedAccount=e},n.prototype.setLoginName=function(e){return e?void(this.loginName=e):console.error(new Error("PlayerData.setLoginName: login is emtpy"))},n.prototype.isAlive=function(){return this.state===l.STATUS_ALIVE_AND_KICKING},n.prototype.isAdmin=function(){return this.hasRight(m.RIGHT_IS_ADMIN)},n.prototype.isModeratorOrMore=function(){return this.accountCapabilities.status>=c.MODERATOR},n.prototype.isCommunityHelper=function(){return this.hasRight(m.IS_COMMUNITY_HELPER)},n.prototype.hasRight=function(e){return!!this.accountCapabilities._accountRightsMap&&Boolean(this.accountCapabilities._accountRightsMap[e])},n.prototype.isModerator=function(){return this.accountCapabilities.status>=c.MODERATOR&&this.accountCapabilities.status<=c.GAMEMASTER},n.prototype.isSubscriber=function(){return this.identification.subscriptionEndDate>p.now()},n.prototype.getSubscriptionDays=function(){if(!this.isSubscriber())return 0;var e=this.identification.subscriptionEndDate-p.now(),t=Math.ceil(e/1e3/60/60/24);return Math.ceil(t)},n.prototype.isMutant=function(){return"GameRolePlayMutantInformations"===window.isoEngine.actorManager.userActor.data.type},n.prototype.getRestrictions=function(){return window.isoEngine.actorManager.userActor.data.humanoidInfo.restrictions},n.prototype.isPvpAggressable=function(){return this.alignment.alignmentInfos.aggressable===h.PvP_ENABLED_AGGRESSABLE||this.alignment.alignmentInfos.aggressable===h.PvP_ENABLED_NON_AGGRESSABLE},n.prototype.getLevelDiff=function(e){var t,i,n=this.characterBaseInformations.level;return e<n?(t=-1,i=n/e):(t=1,i=e/n),Math.abs(e-n)>20||i>=1.2?t:0},n.prototype.isIncarnation=function(){var e=window.gui.playerData.characterBaseInformations.entityLook.bonesId;if(void 0!==D[e])return D[e];var t=window.gui.databases.Incarnation;for(var i in t){var n=t[i],o=n.lookMale.slice(1,n.lookMale.indexOf("|")),s=n.lookFemale.slice(1,n.lookFemale.indexOf("|"));if(e===~~o||e===~~s)return D[e]=!0,!0}return D[e]=!1,!1},n.prototype.isShopDisabled=function(){var e=window.Config||{},t=e.disabledFeatures||{};if(t.shop)return!0;var i=window.parseInt(window.gui.serversData.connectedServerId,10);if(isNaN(i)||!i)return!1;i=i.toString();var n=t.shopByServerIdList||[];return n.indexOf(i)!==-1},n.prototype.isOnShieldTutorial=function(){return!!window.gui.playerData.quests.active[this.shieldTutorialQuestId]},n.prototype.isShieldTutorialFortified=function(){if(!this.isOnShieldTutorial())return!1;for(var e=window.gui.playerData.quests.active[this.shieldTutorialQuestId],t=0;t<e.objectives.length;t++)if(e.objectives[t].objectiveId===this.shieldTutorialQuestObjective)return!e.objectives[t].objectiveStatus},n.prototype._setApplicationUsername=function(e){function t(){}function i(t){console.error("wizPurchase#setApplicationUsername failure: for token",e,"and accountId",n.identification.accountId,"with the error",t)}if(e&&window.wizPurchase&&"function"==typeof window.wizPurchase.setApplicationUsername){var n=this;window.wizPurchase.setApplicationUsername(e,t,i)}},n.prototype.evaluateRatingOpening=function(e,t){var i=this.characterBaseInformations.level;if("levelUp"===e&&i%20===0)this._openRatingWindow();else if("fightEnd"===e&&t&&t.fighters){for(var n=Object.keys(t.fighters),o=0;o<n.length;o++)if(t.fighters[n[o]].isBoss&&i>=200){this._openRatingWindow();break}}else if("arenaFightWin"===e&&t&&t.fighters&&i>=200)for(var s=this.id,a=t.fighters,r=0;r<a.length;r++)if(s===a[r].id){a[r].outcome&&this._openRatingWindow();break}},n.prototype._openRatingWindow=function(){}},function(e,t,i){function n(){s.call(this),this.current=null}var o=i(630),s=i(194),a=i(29).getText,r=i(191).inherits,l=i(772),c=i(225),u=25;r(n,s),e.exports=n,n.prototype.connect=function(){this.current=null},n.prototype.hasAlliance=function(){return null!==this.current},n.prototype.isBoss=function(){if(!this.current||!this.current.guilds.length)return!1;var e=this.current.guilds[0],t=window.gui.playerData.guild;return e.guildId===t.current.guildId&&t.isBoss()},n.prototype.getPrismBonusPercent=function(e){if(!this.hasAlliance())return 0;var t=Object.keys(this.current.prisms);return t.indexOf(e.toString())===-1?0:u},n.prototype.initialize=function(e){var t=this;e.on("AllianceMembershipMessage",function(e){t.current?t.current.setInfo(e.allianceInfo):t.current=o.createAlliance(e.allianceInfo),t.current.enabled=e.enabled}),e.on("AllianceJoinedMessage",function(i){t.current=o.createAlliance(i.allianceInfo),t.current.enabled=i.enabled,e.chat.logMsg(a("ui.alliance.joinAllianceMessage",[i.allianceInfo.allianceName])),t.emit("allianceJoined")}),e.on("AllianceGuildLeavingMessage",function(e){for(var i=t.current.guilds,n=0,o=i.length;n<o;n+=1)if(i[n].guildId===e.guildId)return i.splice(n,1),void t.emit("guildLeft",e.guildId)}),e.on("AllianceLeftMessage",function(){t.current=null,t.emit("allianceLeft")}),e.on("AllianceInsiderInfoMessage",function(e){var i=e.allianceInfos;i.guilds=e.guilds,i.prisms=e.prisms,t.current?t.current.setInfo(i):t.current=o.createAlliance(i),t.emit("allianceUpdated",t.current)}),e.on("AllianceInvitationStateRecruterMessage",function(t){return t.invitationState!==l.SOCIAL_GROUP_INVITATION_SENT?c.close("cancel"):void e.openCancelPopup({title:a("ui.common.invitation"),message:a("ui.craft.waitForCraftClient",t.recrutedName),cb:function(){window.dofus.sendMessage("AllianceInvitationAnswerMessage",{accept:!1})}})}),e.on("AllianceInvitationStateRecrutedMessage",function(e){if(e.invitationState===l.SOCIAL_GROUP_INVITATION_CANCELED)return c.close("confirm")}),e.on("AllianceInvitedMessage",function(e){window.gui.openConfirmPopup({title:a("ui.common.invitation"),message:a("ui.alliance.youAreInvited",e.recruterName,e.allianceInfo.allianceName),cb:function(e){window.dofus.sendMessage("GuildInvitationAnswerMessage",{accept:e})}})}),e.on("PrismsListUpdateMessage",function(e){if(t.current){for(var i=e.prisms,n=[],o=[],s=t.current.prisms,a=0,r=i.length;a<r;a+=1){var l=i[a];"PrismGeolocalizedInformation"===l._type&&"AllianceInsiderPrismInformation"===l.prism._type?(l.prism.alliance=t.current,s[l.subAreaId]=l,n.push(l)):s[l.subAreaId]&&(delete s[l.subAreaId],o.push(l.subAreaId))}n.length&&t.emit("prismUpdatedList",n),o.length&&t.emit("prismDeletedList",o)}})}},function(e,t){e.exports={SOCIAL_GROUP_INVITATION_FAILED:0,SOCIAL_GROUP_INVITATION_SENT:1,SOCIAL_GROUP_INVITATION_CANCELED:2,SOCIAL_GROUP_INVITATION_OK:3}},function(e,t,i){function n(e){this._inventory=e,this._bankCache=new o("bankCache",o.PER_SERVER,(!0)),this._mountCache=new o("mountCache",o.PER_CHARACTER)}var o=i(774);e.exports=n,n.prototype.connect=function(){var e=window.gui.playerData,t=e.identification.accountId,i=window.gui.serversData.connectedServerId,n=e.id;this._bankCache.load(t,i,n),this._mountCache.load(t,i,n)},n.prototype.getItemCounts=function(e){return[this._inventory.quantityList[e]||0,this._bankCache.getItemCount(e),this._mountCache.getItemCount(e)]},n.prototype.setBankItems=function(e){this._bankCache.setItems(e)},n.prototype.updateBankItems=function(e){this._bankCache.updateItems(e)},n.prototype.removeBankItems=function(e){this._bankCache.removeItems(e)},n.prototype.setMountItems=function(e){this._mountCache.setItems(e)},n.prototype.updateMountItems=function(e){this._mountCache.updateItems(e)},n.prototype.removeMountItems=function(e){this._mountCache.removeItems(e)}},function(e,t,i){function n(e,t,i){this._cacheLevel=t,this._isSingleCopy=!!i,this._isUnknown=!0,this._localStore=new o(e),this._entryName=null,this._countByGid={},this._countByUid={},this._gidByUid={}}var o=i(775),s="singleCopy";e.exports=n,n.PER_ACCOUNT=1,n.PER_SERVER=2,n.PER_CHARACTER=3,n.prototype.load=function(e,t,i){switch(this._localStore.load(),this._cacheLevel){case n.PER_ACCOUNT:this._entryName="a"+e;break;case n.PER_SERVER:this._entryName="a"+e+"-s"+t;break;case n.PER_CHARACTER:this._entryName="a"+e+"-s"+t+"-c"+i;break;default:return console.error("Invalid cache level: "+this._cacheLevel)}if(this._isSingleCopy){var o=this._localStore.getValue(s);this._entryName!==o&&(this._erase(o),this._localStore.setValue(s,this._entryName))}var a=this._localStore.getValue(this._entryName+"-countByGid");this._isUnknown=!a,this._countByGid=a||{},this._countByUid=this._localStore.getValue(this._entryName+"-countByUid")||{},this._gidByUid=this._localStore.getValue(this._entryName+"-gidByUid")||{}},n.prototype.isUnknown=function(){return this._isUnknown},n.prototype._erase=function(e){this._localStore.delValue(e+"-countByGid"),this._localStore.delValue(e+"-countByUid"),this._localStore.delValue(e+"-gidByUid")},n.prototype._save=function(){this._isUnknown||(this._localStore.setValue(this._entryName+"-countByGid",this._countByGid),this._localStore.setValue(this._entryName+"-countByUid",this._countByUid),this._localStore.setValue(this._entryName+"-gidByUid",this._gidByUid),this._localStore.save())},n.prototype.setItems=function(e){this._isUnknown=!1,this._countByGid={},this._countByUid={},this._gidByUid={};for(var t=0;t<e.length;t++){var i=e[t],n=i.objectGID,o=i.objectUID,s=i.quantity;this._countByGid[n]=(this._countByGid[n]||0)+s,this._countByUid[o]=s,this._gidByUid[o]=n}this._save()},n.prototype.updateItems=function(e){for(var t=0;t<e.length;t++){var i,n=e[t],o=n.objectGID,s=n.objectUID,a=n.quantity,r=this._countByUid[s];void 0===r?(i=a,this._gidByUid[s]=o):i=a-r,this._countByGid[o]=(this._countByGid[o]||0)+i,this._countByUid[s]=a}this._save()},n.prototype.removeItems=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=this._gidByUid[i];n?(this._countByGid[n]-=this._countByUid[i],0===this._countByGid[n]&&delete this._countByGid[n],delete this._countByUid[i],delete this._gidByUid[i]):console.error("Invalid UID: "+i)}this._save()},n.prototype.getItemCount=function(e){return this._isUnknown?null:this._countByGid[e]||0}},function(e,t){function i(e){this._storeName=e,this._keyName="localStore-"+e,this._valueMap={},this._needsSave=!1}e.exports=i,i.prototype.load=function(){this._valueMap={},this._needsSave=!1;try{var e=window.localStorage.getItem(this._keyName);e&&(this._valueMap=JSON.parse(e))}catch(t){console.error("Failed to load LocalStore "+this._keyName+": "+t)}},i.prototype.save=function(){if(this._needsSave){var e,t=Date.now();try{var i=JSON.stringify(this._valueMap);e=i.length,window.localStorage.setItem(this._keyName,i),this._needsSave=!1,console.info("LocalStore saved "+e+" characters to "+this._keyName+" in "+(Date.now()-t)+"ms")}catch(n){console.error("Failed to save LocalStore, size "+e+" into "+this._keyName+": "+n)}e>1e5&&console.error("LocalStore size is "+e+" for "+this._keyName);var o=Date.now()-t;o>500&&console.error("LocalStore took "+o+"ms to save")}},i.prototype.getValue=function(e){return this._valueMap[e]},i.prototype.setValue=function(e,t){this._valueMap[e]=t,this._needsSave=!0},i.prototype.delValue=function(e){delete this._valueMap[e],this._needsSave=!0}},function(e,t,i){function n(){s.call(this),this.slaves={},this.mainCharacter=new r,this.controlledCharacterId=0,this.mainCharacterId=0}function o(e,t,i){if(!e)return null;var n=window.gui.playerData.characters.getCharacterById(e);if(!n)return null;var o=n.characteristics.spellModifications;if(!o)return null;for(var s=0;s<o.length;s++){var a=o[s];if(a.spellId===t&&a.modificationType===i)return a}return null}var s=i(194).EventEmitter,a=i(191).inherits,r=i(462),l=i(462).SpellData.SPELL_STATUS,c=i(225),u=i(399),d=i(271);a(n,s),e.exports=n,n.prototype.connect=function(e){this.controlledCharacterId=e,this.mainCharacterId=e,this.mainCharacter.setCharacterId(e)},n.prototype.disconnect=function(){this.clearSlaves(),this.mainCharacter.disconnect(),this.controlledCharacterId=0,this.mainCharacterId=0,this.stopRegen()},n.prototype.clearSlaves=function(){for(var e in this.slaves)this.slaves[e].disconnect();this.slaves={}},n.prototype._removeSlave=function(e){var t=this.slaves[e];return t?(t.disconnect(),void delete this.slaves[e]):void console.error(new Error("CharactersData: Cannot remove slave "+e))},n.prototype.switchControlledCharacter=function(e){if(e!==this.controlledCharacterId){this.controlledCharacterId=e,window.actorManager.switchUserActor(e),this.emit("switchControlledCharacter");var t=this.getControlledCharacter();t.characteristics&&t.emitCharacteristicsUpdate()}},n.prototype.canControlCharacterId=function(e){return!(e!==this.mainCharacterId&&!this.slaves[e])},n.prototype.getControlledCharacter=function(){return this.controlledCharacterId===this.mainCharacterId?this.mainCharacter:this.slaves[this.controlledCharacterId]},n.prototype.isMainCharacterControlled=function(){return this.controlledCharacterId===this.mainCharacterId},n.prototype.getCharacterById=function(e){return e===this.mainCharacterId?this.mainCharacter:this.slaves[e]},n.prototype.setCharacteristic=function(e,t){var i=this.getControlledCharacter();i.setCharacteristic(e,t)},n.prototype.addSummonedCreature=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();t.currentSummonedCreature+=1},n.prototype.removeSummonedCreature=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();t.currentSummonedCreature>0&&(t.currentSummonedCreature-=1)},n.prototype.canSummonCreature=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();return t.getMaxSummonedCreature()>t.currentSummonedCreature},n.prototype.addSummonedBomb=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();t.currentSummonedBomb+=1},n.prototype.removeSummonedBomb=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();t.currentSummonedBomb>0&&(t.currentSummonedBomb-=1)},n.prototype.canSummonBomb=function(e){var t=e?this.getCharacterById(e):this.getControlledCharacter();return t.characteristics.summonableMaximumBombs.getTotalStat()>t.currentSummonedBomb},n.prototype.getSpellModifications=o,n.prototype.stopRegen=function(){window.clearInterval(this.regenTimer)},n.prototype.startRegen=function(){this.regenTimer=window.setInterval(this._autoRegenerateLife.bind(this),this.regenRate)},n.prototype._autoRegenerateLife=function(){return this.mainCharacter&&this.mainCharacter.characteristics?void(this.mainCharacter.characteristics.lifePoints>=this.mainCharacter.characteristics.maxLifePoints?this.stopRegen():this.mainCharacter.setCharacteristic("lifePoints",this.mainCharacter.characteristics.lifePoints+1)):void this.stopRegen()},n.prototype.initialize=function(e){function t(e){for(var t=n.mainCharacter.spellData,i={},o=window.gui.playerData.characterBreed,s=e.spellPrevisualization?l.VISIBLE:l.UNAVAILABLE,a=0;a<o.breedSpellsId.length;a++)i[o.breedSpellsId[a]]={spellStatus:s};for(a=0;a<e.spells.length;a++)i[e.spells[a].spellId]={spellStatus:l.USABLE,spellLevel:e.spells[a].spellLevel,position:e.spells[a].position};t.resetSpellsStatus(),t.addSpells(i,function(){n.emit("spellList")})}function i(e){var t=n.mainCharacter.characteristics.alignmentInfos;t.aggressable=e,n.mainCharacter.setCharacteristic("alignmentInfos",t)}var n=this;d.on("CharacterStatsListMessage",function(t){if(n.mainCharacter.characteristics){var i=n.mainCharacter.characteristics.energyPoints,o=t.stats.energyPoints;i>o&&e.playerData.emit("playerIsDead")}n.mainCharacter.setCharacteristics(t.stats)}),d.on("SlaveSwitchContextMessage",function(e){var t=e.summonerId;if(t===n.mainCharacterId){var i=e.slaveId,o=n.slaves[i];o||(o=n.slaves[i]=new r,o.setCharacterId(i));for(var s={},a=0;a<e.slaveSpells.length;a++)s[e.slaveSpells[a].spellId]={spellStatus:l.USABLE,spellLevel:e.slaveSpells[a].spellLevel,position:e.slaveSpells[a].position};o.spellData.addSpells(s,function(){n.emit("spellList")}),n.switchControlledCharacter(i),o.setCharacteristics(e.slaveStats)}}),d.on("FighterStatsListMessage",function(e){var t=n.getControlledCharacter();t.setCharacteristics(e.stats),c.getWindow("characteristics").updateStats(e.stats)}),e.on("LifePointsRegenBeginMessage",function(e){n.regenRate=100*e.regenRate,n.stopRegen(),n.startRegen()}),e.on("LifePointsRegenEndMessage",function(e){n.stopRegen(),n.mainCharacter.setCharacteristic("lifePoints",e.lifePoints),n.mainCharacter.setCharacteristic("maxLifePoints",e.maxLifePoints)}),e.on("SpellListMessage",function(e){var i=window.gui.playerData;return i.characterBreed?void t(e):i.once("setCharacterBreed",function(){t(e)})}),e.on("SpellUpgradeSuccessMessage",function(e){n.mainCharacter.spellData.upgradeSpell(e.spellId,e.spellLevel,l.USABLE,function(){1===e.spellLevel&&n.mainCharacter.emit("newSpellLearned",e.spellId,e.spellLevel),n.mainCharacter.emit("spellUpgrade",e.spellId,e.spellLevel)})}),e.playerData.inventory.on("weaponChanged",function(){n.mainCharacter.spellData.weaponChanged(function(){n.mainCharacter.emit("weaponChanged")})}),e.on("UpdateSelfAgressableStatusMessage",function(e){var t=e.status;i(t),window.actorManager.updateActorsAggressableStatus([n.mainCharacterId],[t])}),e.on("UpdateMapPlayersAgressableStatusMessage",function(e){var t=e.playerIds,o=t.indexOf(n.mainCharacterId);o!==-1&&i(e.enable[o])}),e.fightManager.on("BuffRemove",function(e){e.actionId===u.ACTION_CONTROL_ENTITY&&n._removeSlave(e.targetId)})}},function(e,t,i){function n(){o.call(this),this.list={}}var o=i(194).EventEmitter,s=i(29).getText,a=i(191).inherits,r=i(30);a(n,o),e.exports=n,n.prototype.disconnect=function(){this.list={}},n.prototype.initialize=function(e){var t=this;e.on("EmoteListMessage",function(e){r.getDataMap("Emoticons",e.emoteIds,function(e,i){if(e)return console.error("could not retrieve emotes data",e);for(var n in i)i[n]&&(t.list[n]=i[n]);t.emit("emoteListUpdated",t.list)})}),e.on("EmoteAddMessage",function(e){r.getData("Emoticons",e.emoteId,function(e,i){if(e)return console.error("could not retrieve emotes data",e);var n=i.id;t.list[n]||(t.list[n]=i,window.gui.chat.logMsg(s("ui.common.emoteAdded",[i.nameId])),t.emit("emoteAdded",i))})}),e.on("EmoteRemoveMessage",function(e){var i=t.list[e.emoteId];i&&(window.gui.chat.logMsg(s("ui.common.emoteRemoved",[i.nameId])),delete t.list[e.emoteId],t.emit("emoteRemoved",e.emoteId))})}},function(e,t,i){function n(){this._targetInfo={}}var o=i(29).getText,s=i(712),a=i(779),r=i(472);e.exports=n,n.prototype.disconnect=function(){this._targetInfo={}},n.prototype.initialize=function(e){function t(e){var t=s.setupNames(i._targetInfo.targetId,e.sourceId);return t?(s.setupCancelPopupTexts({title:o("ui.fight.challenge"),message:o("ui.fight.youChallenge",t.targetName)}),s.setupConfirmPopupTexts({title:o("ui.fight.challenge"),message:o("ui.fight.aChallengeYou",t.sourceName)}),void s.askingChallengePopup(e.fightId)):console.error("FightRequestsData: setupNames")}var i=this;e.on("GameRolePlayPlayerFightFriendlyRequestedMessage",t),e.on("GameRolePlayPlayerFightFriendlyAnsweredMessage",function(e){s.closingChallengePopup(e.sourceId===window.gui.playerData.id)}),e.on("ChallengeFightJoinRefusedMessage",function(e){i.alertChallengeRefused(e.reason)}),e.on("GameRolePlayAggressionMessage",function(e){i.alertAggression(e)})},n.prototype.requestChallenge=function(e){this._targetInfo=e,this.sendRequest(e,!1,!0,!1)},n.prototype.requestAssault=function(e,t){this._targetInfo=e,this.sendRequest(e,t,!1,!0)},n.prototype.sendRequest=function(e,t,i,n){var o=e.targetId,s=e.targetCellId;if(n){var a=window.isoEngine.actorManager,l=a.getActor(o).data;if("GameRolePlayCharacterInformations"===l.type){if(t)return this.confirmAttackTarget(e,!0,null);var c="GameRolePlayMutantInformations"===a.userActor.data.type;if(l.alignmentInfos.alignmentSide===r.ALIGNMENT_NEUTRAL&&!c)return this.confirmAttackTarget(e,!1,2);var u=l.alignmentInfos.characterPower-o,d=window.gui.playerData.getLevelDiff(u);if(d)return this.confirmAttackTarget(e,!1,d)}}window.dofus.sendMessage("GameRolePlayPlayerFightRequestMessage",{targetId:o,targetCellId:s,friendly:i})},n.prototype.confirmAttackTarget=function(e,t,i){var n,s=e.targetName;t||0===i?n=o("ui.pvp.doUAttack",s):2===i?n=o("ui.pvp.doUAttackNeutral"):i===-1?n=o("ui.pvp.doUAttackNoGain",s):1===i&&(n=o("ui.pvp.doUAttackBonusGain",s));var a=this;window.gui.openConfirmPopup({title:o("ui.popup.warning"),message:n,cb:function(i){1===i&&a.sendRequest(e,t,!1,!1)}})},n.prototype.alertAggression=function(e){var t=window.isoEngine.actorManager,i=t.getActor(e.attackerId),n=t.getActor(e.defenderId);if(!i||!n)return console.error("Could not find aggressed actors.");var s=o("ui.pvp.aAttackB",i.data.name,n.data.name);window.gui.chat.logMsg(s)},n.prototype.alertChallengeRefused=function(e){var t;switch(e){case a.CHALLENGE_FULL:t=o("ui.fight.challengeFull");break;case a.TEAM_FULL:t=o("ui.fight.teamFull");break;case a.WRONG_ALIGNMENT:t=o("ui.wrongAlignment");break;case a.WRONG_GUILD:t=o("ui.fight.wrongGuild");break;case a.TOO_LATE:t=o("ui.fight.tooLate");break;case a.MUTANT_REFUSED:t=o("ui.fight.mutantRefused");break;case a.WRONG_MAP:
t=o("ui.fight.wrongMap");break;case a.JUST_RESPAWNED:t=o("ui.fight.justRespawned");break;case a.IM_OCCUPIED:t=o("ui.fight.imOccupied");break;case a.OPPONENT_OCCUPIED:t=o("ui.fight.opponentOccupied");break;case a.MULTIACCOUNT_NOT_ALLOWED:t=o("ui.fight.onlyOneAllowedAccount");break;case a.INSUFFICIENT_RIGHTS:t=o("ui.fight.insufficientRights");break;case a.MEMBER_ACCOUNT_NEEDED:t=o("ui.fight.MemberAccountNeeded");break;case a.OPPONENT_NOT_MEMBER:t=o("ui.fight.opponentNotMember");break;case a.TEAM_LIMITED_BY_MAINCHARACTER:t=o("ui.fight.teamLimitedByMainCharacter");break;case a.GHOST_REFUSED:t=o("ui.fight.ghostRefused");break;case a.AVA_ZONE:t=o("ui.fight.cantAttackAvAZone");break;default:return}window.gui.chat.logMsg(t)}},function(e,t){e.exports={FIGHTER_REFUSED:-1,FIGHTER_ACCEPTED:0,CHALLENGE_FULL:1,TEAM_FULL:2,WRONG_ALIGNMENT:3,WRONG_GUILD:4,TOO_LATE:5,MUTANT_REFUSED:6,WRONG_MAP:7,JUST_RESPAWNED:8,IM_OCCUPIED:9,OPPONENT_OCCUPIED:10,FIGHT_MYSELF:11,INSUFFICIENT_RIGHTS:12,MEMBER_ACCOUNT_NEEDED:13,OPPONENT_NOT_MEMBER:14,TEAM_LIMITED_BY_MAINCHARACTER:15,MULTIACCOUNT_NOT_ALLOWED:16,GHOST_REFUSED:17,RESTRICTED_ACCOUNT:19,WRONG_ALLIANCE:20,AVA_ZONE:21}},function(e,t,i){function n(){c.call(this),this._reset()}var o=i(412),s=i(271),a=i(526),r=a.GuildRightsBitEnum,l=i(725),c=i(194),u=i(29).getText,d=i(252),h=i(191).inherits,p=i(772),m=i(781),f=i(225),g=i(640),_=i(782),v=i(668),y=1,b={allPagesAllowed:!0};h(n,c),e.exports=n,n.prototype._reset=function(){this.current=null,this._requestedSocialInfoMap={},this._awaitedSocialInfoMap={}},n.prototype.initialize=function(e){this._setupListeners(e)},n.prototype.disconnect=function(){this._reset()},n.prototype.hasGuild=function(){return null!==this.current},n.prototype.checkRight=function(e,t){return(e&t)>0},n.prototype.getGuildMemberInfo=function(e){if(this.hasGuild())return this.current.members[e]},n.prototype.hasRight=function(e){return!!this.isBoss()||this.checkRight(e,this.current.memberRights)},n.prototype.isBoss=function(){return this.current.leaderId===window.gui.playerData.id||this.checkRight(r.GUILD_RIGHT_BOSS,this.current.memberRights)},n.prototype.isAMember=function(e){return this.current.members.hasOwnProperty(e)},n.prototype._initPerceptors=function(){return this.current.perceptors={nbcollectorMax:0,informationsOrderList:[],perceptorsMap:{}},this.current.perceptors},n.prototype.getPerceptors=function(){var e=this.current.perceptors;return e||(e=this._initPerceptors()),e},n.prototype.getPerceptor=function(e){var t=this.getPerceptors();return t.perceptorsMap[e]},n.prototype._setupListeners=function(e){var t=this;e.on("GuildMembershipMessage",function(e){t.current&&t.current.guildId===e.guildInfo.guildId||(t.current=a.createGuild(e.guildInfo)),t.current.enabled=e.enabled,t.current.memberRights=e.memberRights,t.requestSocialInfo(m.SOCIAL_INFO_GUILD_MOTD,!0)}),e.on("GuildJoinedMessage",function(i){t.current=a.createGuild(i.guildInfo),t.current.enabled=i.enabled,t.current.memberRights=i.memberRights,e.chat.logMsg(u("ui.guild.JoinGuildMessage",[i.guildInfo.guildName]))}),s.on("GuildInformationsGeneralMessage",function(i){if(e.isConnected){var n=t.current;n.level=i.level,n.creationDate=i.creationDate,n.abandonnedPaddock=i.abandonnedPaddock,n.experience=i.experience,n.expNextLevelFloor=i.expNextLevelFloor,n.experiencePercentage=(i.experience-i.expLevelFloor)/(i.expNextLevelFloor-i.expLevelFloor),t.emit("GuildGeneralInformationUpdate")}}),e.on("GuildInformationsMembersMessage",function(i){if(e.isConnected){for(var n=t.current,o=0,s={},a=i.members.length,r=0,l=0;l<a;l++){var c=i.members[l];r+=c.level,c.rank===y&&(n.leaderId=c.id),c.connected&&(o+=1),s[c.id]=c}n.members=s,n.averageMemberLevel=Math.floor(r/a),n.nbMembers=a,n.nbConnectedMembers=o,t.emit("guildMemberCountUpdate"),t.emit("guildMember",n.getMembersByRank())}}),s.on("GuildInformationsMemberUpdateMessage",function(e){var i=t.current,n=e.member;i.members[n.id]=n,n.rank===y&&(i.leaderId=n.id),t.emit("guildMember",i.getMembersByRank())}),e.on("GuildMemberLeavingMessage",function(e){var i=t.current,n=i.members;delete n[e.memberId];var o=0,s=0;for(var a in n){var r=n[a];r.connected&&(o+=1),s+=1}i.nbMembers=s,i.nbConnectedMembers=o,t.emit("guildMemberCountUpdate"),t.emit("guildMember",t.current.getMembersByRank())}),e.on("GuildMemberOnlineStatusMessage",function(e){var i=t.current,n=i.members[e.memberId];n&&(e.online?(n.connected=1,n.status.statusId=g.PLAYER_STATUS_AVAILABLE,i.nbConnectedMembers++):(n.connected=0,n.status.statusId=g.PLAYER_STATUS_OFFLINE,i.nbConnectedMembers--),t.emit("guildMemberCountUpdate"),t.emit("guildMember",i.getMembersByRank()))}),s.on("PlayerStatusUpdateMessage",function(e){if(t.current){var i=t.current.members[e.playerId];i&&(i.status=e.status,t.emit("guildMemberStatusUpdate",i))}}),e.on("GuildMemberWarnOnConnectionStateMessage",function(e){t.current&&(t.current.warnMemberOnConnectionState=e.enable)}),e.on("GuildLeftMessage",function(){t.current=null,t.emit("guildLeft")}),e.on("GuildInvitationStateRecruterMessage",function(t){return t.invitationState===p.SOCIAL_GROUP_INVITATION_OK&&window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:l.INFO_MEMBERS}),t.invitationState!==p.SOCIAL_GROUP_INVITATION_SENT?f.close("cancel"):void e.openCancelPopup({title:u("ui.common.invitation"),message:u("ui.craft.waitForCraftClient",t.recrutedName),cb:function(){window.dofus.sendMessage("GuildInvitationAnswerMessage",{accept:!1})}})}),e.on("GuildInvitationStateRecrutedMessage",function(e){if(e.invitationState===p.SOCIAL_GROUP_INVITATION_CANCELED)return f.close("confirm")}),e.on("GuildInvitedMessage",function(e){window.gui.openConfirmPopup({title:u("ui.common.invitation"),message:u("ui.social.aInvitYouInGuild",e.recruterName,e.guildInfo.guildName),cb:function(e){window.dofus.sendMessage("GuildInvitationAnswerMessage",{accept:e})}})}),e.on("GuildInformationsPaddocksMessage",function(e){t.current&&(t.current.paddocks=e.paddocksInformations||[],t.emit("guildPaddockUpdate"))}),e.on("GuildPaddockBoughtMessage",function(e){t.current&&(t.current.paddocks||(t.current.paddocks=[]),t.current.paddocks.push(e.paddockInfo),t.emit("guildPaddockBought",e.paddockInfo))}),e.on("GuildPaddockRemovedMessage",function(e){if(t.current&&t.current.paddocks){var i=e.paddockId;d.removeObjectInArrayById(t.current.paddocks,"paddockId",i)&&t.emit("guildPaddockRemoved",i)}}),e.on("GuildHousesInformationMessage",function(e){t.current&&(t.current.houses=e.housesInformations||[],t.emit("guildHouseUpdateAll"))}),e.on("GuildHouseUpdateInformationMessage",function(e){t.current&&(t.current.houses||(t.current.houses=[]),t.current.houses.push(e.housesInformations),t.emit("guildHouseUpdateInfo",e.housesInformations))}),e.on("GuildHouseRemoveMessage",function(e){if(t.current&&t.current.houses){var i=e.houseId;d.removeObjectInArrayById(t.current.houses,"houseId",i)&&t.emit("guildHouseRemoved",i)}}),e.on("MoodSmileyUpdateMessage",function(e){var i=t.current&&t.current.members[e.playerId];i&&(i.moodSmileyId=e.smileyId,t.emit("guildMember",t.current.getMembersByRank()))}),e.on("MoodSmileyResultMessage",function(e){if(e.resultCode===_.MOOD_OK){var i=t.current&&t.current.members[window.gui.playerData.id];i&&(i.moodSmileyId=e.smileyId,t.emit("guildMember",t.current.getMembersByRank()))}}),s.on("SocialInfoDataMessage",function(e){t._receiveSocialInfo(e.infoTypes,e.contents)})},n.prototype.requestSocialInfo=function(e,t){this._requestedSocialInfoMap[e]=this._requestedSocialInfoMap[e]||Boolean(t),this._socialInfoRequestTimeout||(this._socialInfoRequestTimeout=window.setTimeout(function(e){e._socialInfoRequestTimeout=null;var t=[];for(var i in e._requestedSocialInfoMap)e._requestedSocialInfoMap.hasOwnProperty(i)&&(t.push(i),e._awaitedSocialInfoMap[i]=e._awaitedSocialInfoMap[i]||e._requestedSocialInfoMap[i]);e._requestedSocialInfoMap={},window.dofus.sendMessage("SocialInfoRequestMessage",{infoTypes:t})},0,this))},n.prototype._receiveSocialInfo=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],s=t[i],a=this._awaitedSocialInfoMap[n];if(delete this._awaitedSocialInfoMap[n],(void 0===a||a)&&n===m.SOCIAL_INFO_GUILD_MOTD&&s.value){var r=v.decode(s.value,b),l=u("tablet.social.motd")+u("ui.common.colon")+r;window.gui.chat.logMsg(l,o.CHANNEL_GUILD)}this.emit("socialInfoUpdated",n,s)}}},function(e,t){e.exports={SOCIAL_INFO_ERROR:0,SOCIAL_INFO_GUILD_MOTD:1,SOCIAL_INFO_GUILD_PRIVATE_MSG:2,SOCIAL_INFO_GUILD_PUBLIC_MSG:3,SOCIAL_INFO_GUILD_RECRUIT:4,SOCIAL_INFO_ALLIANCE_MOTD:5,SOCIAL_INFO_ALLIANCE_PRIVATE_MSG:6,SOCIAL_INFO_ALLIANCE_PUBLIC_MSG:7}},function(e,t){e.exports={MOOD_OK:0,MOOD_ERROR_UNKNOWN:1,MOOD_ERROR_FLOOD:2}},function(e,t,i){function n(){o.call(this),this.objects={},this.isLoaded=!1,this.presets={},this.kamas=0,this.goultines=0,this.weight=0,this.maxWeight=0,this.quantityList={},this.equippedItems={},this._lastUpdatedPosition={},this.itemSets={}}var o=i(194).EventEmitter,s=i(252),a=i(29).getText,r=i(191).inherits,l=i(784),c=i(509),u=i(258).playUiSound,d=c.positions,h=i(7),p=i(24),m=i(785),f=i(786),g=i(787),_=i(788),v=113;r(n,o),e.exports=n,n.prototype.connect=function(){window.dofus.send("moneyGoultinesAmountRequest")},n.prototype.isOverloaded=function(){return this.weight>this.maxWeight},n.prototype.disconnect=function(){this.objects={},this.isLoaded=!1,this.presets={},this.weight=0,this.maxWeight=0,this.quantityList={},this.equippedItems={},this._lastUpdatedPosition={},this.itemSets={},this.kamas=null,this.goultines=null,this.emit("unloaded")},n.prototype.initialize=function(e){function t(){var e=v.quantityList={},t=v.objects;for(var i in t){var n=t[i],o=n.objectGID;e[o]=(e[o]||0)+n.quantity}}function i(e){for(var i=0,n=e.length;i<n;i+=1){var o=e[i];v.objects[o.objectUID]=o,o.position!==d.notEquipped&&(v.equippedItems[o.position]=o,o.position===d.weapon&&v.emit("weaponChanged"))}t()}function n(){v.isLoaded=!0,v.emit("loaded"),v.emit("listUpdate",v.objects)}function o(e){v.kamas=e.kamas,v.emit("kamasUpdated",e.kamas);var t=c.createItemInstances(e.objects,function(t){if(t)return console.error(t);if(!e.presets)return n();e.presets=e.presets||[],v.presets={};for(var i=[],o=0;o<e.presets.length;o+=1){var s=e.presets[o];v.presets[s.presetId]=s;for(var a=0;a<s.objects.length;a+=1){var r=s.objects[a].objGid;c.items[r]||i.push(r)}}c.getItems(i,function(e){return e?console.error(e):void n()})});i(t)}function r(e,t,i){var n=e.presets[i.presetId];if(!n)return t.retry(new Error("Preset is missing for presetId "+i.presetId))?void console.warn("Preset is missing for presetId "+i.presetId+" will retry..."):void console.error(t.mainError());for(var o=0;o<n.objects.length;o+=1)if(n.objects[o].position===i.presetItem.position){n.objects[o]=i.presetItem;break}e.emit("presetItemUpdated",i.presetId)}function u(e){var i=v.objects[e];return i?(i.position!==d.notEquipped&&(delete v.equippedItems[i.position],i.position===d.weapon&&v.emit("weaponChanged")),i.emit("deleted"),delete v.objects[e],t(),i):console.error("[ObjectDeletedMessage] unknown object UID")}var v=this,y=window.dofus.connectionManager;e.on("ObjectAddedMessage",function(e){var t=c.createItemInstances(e.object,function(e,t){return e?console.error(e):void v.emit("itemAdded",t.array[0])});i(t)}),e.on("ObjectsAddedMessage",function(e){var t=c.createItemInstances(e.object,function(e,t){return e?console.error(e):void v.emit("itemsAdded",t.map)});i(t)}),e.on("ObjectModifiedMessage",function(e){var t=c.createItemInstances(e.object,function(t,i){if(t)return console.error(t);var n=i.array[0];return v.objects[e.object.objectUID]||n.livingObjectCategory?void(n.isInitialised&&(n.emit("modified"),v.emit("itemModified",n))):console.error("[ObjectModifiedMessage] unknown object UID")});i(t)}),e.on("ObjectMovementMessage",function(e){var t=v.objects[e.objectUID],i=!1;if(t){t.position!==d.weapon&&e.position!==d.weapon||(i=!0);var n=t.position;t.position=e.position,v.equippedItems[n]&&delete v.equippedItems[n],e.position!==d.notEquipped&&(v.equippedItems[e.position]=t),t.isInitialised&&(i&&v.emit("weaponChanged"),t.emit("moved"),v.emit("itemMoved",t,n,e.position))}}),e.on("InventoryContentMessage",o),e.on("InventoryContentAndPresetMessage",o),e.on("InventoryPresetDeleteResultMessage",function(e){switch(e.code){case m.PRESET_DEL_OK:delete v.presets[e.presetId],v.emit("presetDeleted",e.presetId);break;case m.PRESET_DEL_ERR_TOO_MANY:v.emit("presetDeleted",e.presetId,"tooMany");break;case m.PRESET_DEL_ERR_UNKNOWN:v.emit("presetDeleted",e.presetId,"unknown");break;case m.PRESET_DEL_ERR_BAD_PRESET_ID:v.emit("presetDeleted",e.presetId,"badId")}}),e.on("InventoryPresetSaveResultMessage",function(e){switch(e.code){case f.PRESET_SAVE_OK:v.emit("presetSaved",e.presetId);break;case f.PRESET_SAVE_ERR_TOO_MANY:v.emit("presetSaved",e.presetId,"tooMany");break;case f.PRESET_SAVE_ERR_UNKNOWN:v.emit("presetSaved",e.presetId,"unknown")}}),e.on("InventoryPresetUseResultMessage",function(e){switch(e.code){case _.PRESET_USE_OK:v.emit("presetUsed",e.presetId);break;case _.PRESET_USE_OK_PARTIAL:v.emit("presetUsed",e.presetId,"usePartial");break;case _.PRESET_USE_ERR_UNKNOWN:v.emit("presetUsed",e.presetId,"unknown");break;case _.PRESET_USE_ERR_CRITERION:v.emit("presetUsed",e.presetId,"criterion");break;case _.PRESET_USE_ERR_BAD_PRESET_ID:v.emit("presetUsed",e.presetId,"badId")}}),e.on("InventoryPresetUpdateMessage",function(e){v.presets[e.preset.presetId]=e.preset,v.emit("presetUpdated",e.preset.presetId)}),e.on("InventoryPresetItemUpdateMessage",function(e){var t=p.operation({retries:4,randomize:!0});t.attempt(function(){r(v,t,e)})}),e.on("InventoryPresetItemUpdateErrorMessage",function(e){switch(e.code){case g.PRESET_UPDATE_ERR_UNKNOWN:v.emit("presetItemUpdateError","unknown");break;case g.PRESET_UPDATE_ERR_BAD_PRESET_ID:v.emit("presetItemUpdateError","badId");break;case g.PRESET_UPDATE_ERR_BAD_POSITION:v.emit("presetItemUpdateError","badPosition");break;case g.PRESET_UPDATE_ERR_BAD_OBJECT_ID:v.emit("presetItemUpdateError","badObjectId")}}),y.on("GoultinesGivenMessage",function(){window.dofus.send("moneyGoultinesAmountRequest")}),y.on("InventoryWeightMessage",function(e){v.weight=e.weight,v.maxWeight=e.weightMax,v.emit("weightUpdated",e.weight,e.weightMax)}),e.on("SetUpdateMessage",function(e){var t=e.setId;v.itemSets[t]={setEffects:e.setEffects,setObjects:e.setObjects}}),y.on("ObjectsQuantityMessage",function(e){for(var i={},n={},o=0,s=e.objectsUIDAndQty.length;o<s;o+=1){var a=e.objectsUIDAndQty[o],r=a.objectUID,l=a.quantity,c=v.objects[r],u=c.quantity;c.quantity=l,c.isInitialised&&(i[r]=l,n[r]=u)}t(),v.emit("itemsQuantity",i,n)}),y.on("ObjectQuantityMessage",function(e){var i=v.objects[e.objectUID],n=i.quantity;i.quantity=e.quantity,t(),i.isInitialised&&v.emit("itemQuantity",e.objectUID,e.quantity,n)}),y.on("ObjectsDeletedMessage",function(e){for(var t={},i=0,n=e.objectUID.length;i<n;i+=1){var o=e.objectUID[i];t[o]=u(o)}v.emit("itemsDeleted",e.objectUID,t)}),y.on("ObjectDeletedMessage",function(e){var t=u(e.objectUID);v.emit("itemDeleted",e.objectUID,t)}),y.on("ObjectErrorMessage",function(t){var i;switch(t.reason){case l.INVENTORY_FULL:i=a("ui.objectError.InventoryFull");break;case l.CANNOT_EQUIP_TWICE:i=a("ui.objectError.CannotEquipTwice");break;case l.CANNOT_DROP:i=a("ui.objectError.CannotDrop");break;case l.CANNOT_DROP_NO_PLACE:i=a("ui.objectError.CannotDropNoPlace");break;case l.CANNOT_DESTROY:i=a("ui.objectError.CannotDelete");break;case l.LEVEL_TOO_LOW:i=a("ui.objectError.levelTooLow");break;case l.LIVING_OBJECT_REFUSED_FOOD:i=a("ui.objectError.LivingObjectRefusedFood")}i&&e.chat.logError(i)}),e.on("KamasUpdateMessage",function(e){s.storeValueAndEmit(v,v,"kamas",e.kamasTotal,"kamasUpdated")}),y.on("CharacterStatsListMessage",function(e){s.storeValueAndEmit(v,v,"kamas",e.stats.kamas,"kamasUpdated")}),y.on("moneyGoultinesAmountSuccess",function(e){s.storeValueAndEmit(v,v,"goultines",e.goultinesAmount,"goultinesUpdated"),h.wKpi.hardCurrencyAmount(e.goultinesAmount)})},n.prototype.getCurrentWeapon=function(){return this.equippedItems[d.weapon]};var y={0:"EQUIP_NECKLACE",1:"EQUIP_WEAPON",2:"EQUIP_WRISTBAND",3:"EQUIP_ACCESORIES",4:"EQUIP_WRISTBAND",5:"EQUIP_BOOTS",6:"EQUIP_CLOTH_2",7:"EQUIP_CLOTH_1",8:"EQUIP_PET",9:"EQUIP_DOFUS",10:"EQUIP_DOFUS",11:"EQUIP_DOFUS",12:"EQUIP_DOFUS",13:"EQUIP_DOFUS",14:"EQUIP_DOFUS",15:"EQUIP_HAND",16:"EQUIP_PET"};n.prototype._equip=function(e,t,i){this._lastUpdatedPosition[i.superTypeId]=e,window.dofus.sendMessage("ObjectSetPositionMessage",{objectUID:t.objectUID,position:e,quantity:1});var n=y[e];n&&u(n)},n.prototype.equipItem=function(e,t){var i=this.objects[e];if(i&&i.position===d.notEquipped){var n=i.item,o=n.type;if(o.category===c.categories.equipment){if(n.typeId===v)return this._equip(t,i,o);var s=o.possiblePositions;if(s.length){if(t&&s.indexOf(t)!==-1)return this._equip(t,i,o);var a,r,l,u,h=this.equippedItems;if(9!==o.id||i.belongsToSet)for(a=0,r=s.length;a<r;a+=1)if(l=s[a],u=h[l],u&&u.objectGID===i.objectGID)return this._equip(l,i,o);for(a=0,r=s.length;a<r;a+=1)if(l=s[a],!h[l])return this._equip(l,i,o);var p=this._lastUpdatedPosition[o.superTypeId]||0,m=p<s.length-1?p+1:0;this._equip(s[m],i,o)}}}},n.prototype.unEquipItem=function(e){var t=this.objects[e];t&&t.position!==d.notEquipped&&(window.isoEngine.actionQueue.isActive()||window.dofus.sendMessage("ObjectSetPositionMessage",{objectUID:e,position:d.notEquipped,quantity:1}))},n.prototype.confirmDestroyItem=function(e,t){window.gui.openConfirmPopup({title:a("ui.common.delete.item"),message:a("ui.common.doYouDestroy",t,e.item.nameId),cb:function(i){i&&window.dofus.sendMessage("ObjectDeleteMessage",{objectUID:e.objectUID,quantity:t})}})},n.prototype.getGenericItem=function(e){var t,i=this.objects;for(var n in i)if(t=i[n],t.objectGID===e)return t;return null},n.prototype.getGenericItemCount=function(e){var t=this.objects,i=0;for(var n in t){var o=t[n];o.objectGID===e&&(i+=o.quantity)}return i},n.prototype.isGenericItemEquipped=function(e){var t=this.objects;for(var i in t){var n=t[i];if(n.objectGID===e&&n.position!==d.notEquipped)return!0}return!1},n.prototype.isPetFood=function(e,t){var i=e.foodItems,n=e.foodTypes;return!(!i||!n)&&(i.indexOf(t.getProperty("objectGID"))!==-1||n.indexOf(t.getProperty("typeId"))!==-1)}},function(e,t){e.exports={INVENTORY_FULL:1,CANNOT_EQUIP_TWICE:2,NOT_TRADABLE:3,CANNOT_DROP:4,CANNOT_DROP_NO_PLACE:5,CANNOT_DESTROY:6,LEVEL_TOO_LOW:7,LIVING_OBJECT_REFUSED_FOOD:8,CANNOT_UNEQUIP:9,CANNOT_EQUIP_HERE:10,CRITERIONS:11,MIMICRY_OBJECT_ERROR:12}},function(e,t){e.exports={PRESET_DEL_OK:1,PRESET_DEL_ERR_UNKNOWN:2,PRESET_DEL_ERR_BAD_PRESET_ID:3}},function(e,t){e.exports={PRESET_SAVE_OK:1,PRESET_SAVE_ERR_UNKNOWN:2,PRESET_SAVE_ERR_TOO_MANY:3}},function(e,t){e.exports={PRESET_UPDATE_ERR_UNKNOWN:1,PRESET_UPDATE_ERR_BAD_PRESET_ID:2,PRESET_UPDATE_ERR_BAD_POSITION:3,PRESET_UPDATE_ERR_BAD_OBJECT_ID:4}},function(e,t){e.exports={PRESET_USE_OK:1,PRESET_USE_OK_PARTIAL:2,PRESET_USE_ERR_UNKNOWN:3,PRESET_USE_ERR_CRITERION:4,PRESET_USE_ERR_BAD_PRESET_ID:5}},function(e,t,i){function n(){d={},h={},p={},m={Jobs:d,Skills:h,Recipes:p}}function o(e,t,i){return t.length?void v.getDataMap(e,t,function(t,n){if(t)return i(t);var o=m[e];for(var s in n)o[s]=n[s];i()}):i()}function s(e,t){o("Skills",e,function(i){if(i)return t(i);for(var n={},s=0,a=e.length;s<a;s+=1){var r=h[e[s]];if(r&&r.craftableItemIds)for(var l=0,c=r.craftableItemIds.length;l<c;l+=1){var u=r.craftableItemIds[l];p[u]||(n[u]=!0)}}o("Recipes",Object.keys(n),function(i){if(i)return t(i);for(var n=0,o=e.length;n<o;n+=1){var s=h[e[n]];if(s&&s.craftableItemIds){s.recipes=[];for(var a=0,r=s.craftableItemIds.length;a<r;a+=1){var l=s.craftableItemIds[a];p[l]&&s.recipes.push(p[l])}}}t()})})}function a(){v.getDataMap("Npcs",E,function(e,t){if(e)return console.error("Failed to get the name of the job npcs",e);for(var i in t)x[i]=t[i].nameId})}function r(e,t,i){for(var n={},a={},r=0,l=e.length;r<l;r+=1){var c=e[r],u=c.jobId,p=t[u];p||(p=t[u]={id:u}),p.description=c,d[u]||(n[u]=!0);for(var m=0,f=c.skills.length;m<f;m+=1){var g=c.skills[m].skillId;h[g]||(a[g]=!0)}}o("Jobs",Object.keys(n),function(e){return e?i(e):void s(Object.keys(a),function(e){if(e)return i(e);for(var n in t){var o=t[n];o.info=d[o.id];for(var s=0,a=o.description.skills.length;s<a;s+=1){var r=o.description.skills[s];r.info=h[r.skillId]}}i()})})}function l(){f.call(this),this.SKILLID_WRAP_GIFT=209,this.SKILLID_DECRAFT=181,this.ITEMID_MAGIC_FRAGMENT=8378,this.RUNE_SIGNATURE_GID=M,this.SMITHMAGIC_RUNE_ID=C,this.SMITHMAGIC_POTION_ID=I,this.MAX_CRAFT_SLOTS=8,this.list={},this._publicMode=!1,this._playersMultiCraftSkillById={},this._existingSlotCount=0,this._onCraftTable={},this._stackCount=0,this._stackCountPerGid={}}function c(e){return!!window.gui.playerData.inventory.objects[e.objectUID]}function u(e,t,i){var n=e+("SOLO"!==t?"-"+t:"")+"-"+i;return A[n]||S}var d,h,p,m,f=i(194).EventEmitter,g=i(29).getText,_=i(191).inherits,v=i(30),y=i(509),b=i(252),w=i(258).playUiSound,M=7508,T=100,C=78,I=26,A={"decrafting-craftInventory":{move:"max"},"decrafting-crafting":{move:"max"},"craftMagus-craftInventory":{move:"max"},"craftMagus-crafting":{move:"max"},"craftMagus-CLIENT-ingredientsBag":{move:"max"},"craftMagus-CLIENT-craftInventory":{move:"max"},"craftMagus-CRAFTER-ingredientsBag":{move:"max"},"craftMagus-CRAFTER-crafting":{move:"max"},"craftMagus-CRAFTER-craftInventory":{move:"max"}},S={move:1},E=[601,849],x={};_(l,f),e.exports=l,l.prototype.disconnect=function(){n(),this.list={},this._publicMode=!1,this._playersMultiCraftSkillById={},this.clearAfterCraft()},l.prototype.startCraftingSession=function(e,t,i){this.craftSide=e,this.craftType=this.getCraftType(t),this._setupSkillData(t),this.setExistingSlotCount(i),this.isMagicCraft="craftMagus"===this.craftType,this._stackCount=0,this.canUseCrafterIngredient=!1,this.isCrafterWorking=!1,this.isCombining=!1,this._startListeningForCraft()},l.prototype.setCrafterIngredientsAllowed=function(e){this.canUseCrafterIngredient=e},l.prototype.switchToCrafter=function(e){this.isCrafterWorking=e},l.prototype.startCombining=function(){this.isCombining=!0},l.prototype.stopCombining=function(){this.isCombining=!1},l.prototype.clearAfterCraft=function(){this._onCraftTable={},this._stackCountPerGid={},this._stopListeningForCraft(),this.removeAllListeners("objectAdded"),this.removeAllListeners("objectModified"),this.removeAllListeners("objectRemoved")},l.prototype._startListeningForCraft=function(){if(!this.isListeningForCraft){this.isListeningForCraft=!0,this._objectAddedHandler||(this._objectAddedHandler=this._onCraftObjectAddedMessage.bind(this),this._objectModifiedHandler=this._onCraftObjectModifiedMessage.bind(this),this._objectRemovedHandler=this._onCraftObjectRemovedMessage.bind(this));var e=window.dofus.connectionManager;e.on("ExchangeObjectAddedMessage",this._objectAddedHandler),e.on("ExchangeObjectModifiedMessage",this._objectModifiedHandler),e.on("ExchangeObjectRemovedMessage",this._objectRemovedHandler)}},l.prototype._stopListeningForCraft=function(){if(this.isListeningForCraft){this.isListeningForCraft=!1;var e=window.dofus.connectionManager;e.removeListener("ExchangeObjectAddedMessage",this._objectAddedHandler),e.removeListener("ExchangeObjectModifiedMessage",this._objectModifiedHandler),e.removeListener("ExchangeObjectRemovedMessage",this._objectRemovedHandler)}},l.prototype._onCraftObjectAddedMessage=function(e){var t=e.remote,i=e.object,n=i.objectUID,o=i.objectGID,s=i.quantity,a=this._onCraftTable[n];return a?console.warn("ExchangeObjectAddedMessage received for existing object "+n):(this._onCraftTable[n]={GID:o,quantity:s},this._stackCount++,this._stackCountPerGid[o]=(this._stackCountPerGid[o]||0)+1,void this.emit("objectAdded",i,t))},l.prototype._onCraftObjectModifiedMessage=function(e){var t=e.object,i=e.remote,n=t.objectUID,o=this._onCraftTable[n];return o?(o.quantity=t.quantity,void this.emit("objectModified",t,i)):console.error("craftObjectModified of unknown object "+n)},l.prototype._onCraftObjectRemovedMessage=function(e){var t=e.remote,i=e.objectUID,n=this._onCraftTable[i];if(!n)return console.error("craftObjectRemoved of unknown object "+i);var o=n.GID;delete this._onCraftTable[i],this._stackCount--,0===--this._stackCountPerGid[o]&&delete this._stackCountPerGid[o],this.emit("objectRemoved",i,t)},l.prototype._setupSkillData=function(e){this.currentSkillId=e,this.skillData=h[e];var t=this.list[this.skillData.parentJobId]||{},i=t.experience||{};this.crafterSkillLevel=i.jobLevel,this.canCrafterSign=this.crafterSkillLevel>=T},l.prototype.getCraftType=function(e){var t=h[e];return t?t.isForgemagus||t.modifiableItemType!==-1?"craftMagus":e===this.SKILLID_DECRAFT?"decrafting":e===this.SKILLID_WRAP_GIFT?"wrapping":"crafting":console.error("Invalid skillId: "+e)},l.prototype.isCraftableItem=function(e){return this.skillData.modifiableItemType===e.getProperty("typeId")&&e.getProperty("enhanceable")},l.prototype._getReplacedItemOnMagicTable=function(e){return this._onCraftTable[e.objectUID]?null:e.objectGID===M?this._getSignatureRuneOnTable():this._isMagicRuneOrPotion(e)?this._getRuneOrPotionOnMagicTable():this._getItemOnMagicTable()},l.prototype._getSignatureRuneOnTable=function(){for(var e in this._onCraftTable){var t=this._onCraftTable[e];if(t.GID===M)return e}return null},l.prototype._getRuneOrPotionOnMagicTable=function(){for(var e in this._onCraftTable){var t=this._onCraftTable[e],i=y.items[t.GID].typeId;if(i===C||i===I)return e}return null},l.prototype._getItemOnMagicTable=function(){for(var e in this._onCraftTable){var t=this._onCraftTable[e];if(t.GID!==M){var i=y.items[t.GID].typeId;if(i!==C&&i!==I)return e}}return null},l.prototype._isMagicRuneOrPotion=function(e){var t=e.item.typeId;return t===C||t===I},l.prototype._getItemMoveTargets=function(e,t){if(this.isMagicCraft)switch(this.craftSide){case"SOLO":switch(e){case"craftInventory":return["crafting"];case"crafting":return["craftInventory"];default:return[]}case"CLIENT":if(this.isCrafterWorking)return[];switch(e){case"craftInventory":return["ingredientsBag","craftPayment"];case"ingredientsBag":return["craftInventory"];case"craftPayment":return["craftInventory"];default:return[]}case"CRAFTER":if(!this.isCrafterWorking)return[];switch(e){case"craftInventory":return this.canUseCrafterIngredient||t.objectGID===M?["crafting"]:[];case"crafting":return c(t)?["craftInventory"]:["ingredientsBag"];case"ingredientsBag":return["crafting"];default:return[]}default:return[]}else switch(this.craftSide){case"SOLO":switch(e){case"craftInventory":return["crafting"];case"crafting":return["craftInventory"];default:return[]}case"CRAFTER":switch(e){case"craftInventory":return["crafting"];case"crafting":return["craftInventory"];default:return[]}case"CLIENT":switch(e){case"craftInventory":return["crafting","craftPayment"];case"crafting":return["craftInventory"];case"craftPayment":return["craftInventory"];default:return[]}default:return[]}},l.prototype.canItemMove=function(e,t,i){var n=this._getItemMoveTargets(e,i);return n.indexOf(t)!==-1},l.prototype.getQuickTransferPreference=function(e){var t=null;return t||u(this.craftType,this.craftSide,e)},l.prototype.getQuickTransferInfo=function(e,t,i){if(this.isCombining)return{targets:[],movedQty:0,proposedQty:0};var n=this._getItemMoveTargets(e,t);if(0===n.length)return{targets:[],movedQty:0,proposedQty:0};var o,s=this.isMagicCraft&&"CLIENT"===this.craftSide?"ingredientsBag":"crafting";if(o=n.indexOf(s)!==-1?this.howManyCanBeAddedToCraft(e,t,i):t.quantity,0===o)return{targets:[],movedQty:0,proposedQty:0};var a=this.getQuickTransferPreference(e);return a.move?{targets:n,movedQty:"max"===a.move?o:1}:{targets:n,proposedQty:"max"===a.propose?o:1,maxQty:o}},l.prototype.howManyCanBeAddedToCraft=function(e,t,i){if(this.isCombining)return 0;if(i<1)return 0;if(t.objectGID===M)return!this._getSignatureRuneOnTable()&&"CLIENT"!==this.craftSide&&this.canCrafterSign?1:0;if(this.isMagicCraft){if("CLIENT"===this.craftSide&&this.isCrafterWorking)return 0;if("CRAFTER"===this.craftSide&&!this.isCrafterWorking)return 0;var n="CRAFTER"===this.craftSide&&"craftInventory"===e;return this._isMagicRuneOrPotion(t)?n&&!this.canUseCrafterIngredient?0:i:this.isCraftableItem(t)?n?0:this._onCraftTable[t.objectUID]?0:1:0}return"SOLO"===this.craftSide?this.getFreeSlotCount()||this._onCraftTable[t.objectUID]?i:0:this.getFreeSlotCount()||this._stackCountPerGid[t.objectGID]?i:0},l.prototype.moveItemToCraft=function(e,t,i){if(!(i>=1))return console.error("moveItemToCraft quantity: "+i);if(this.isMagicCraft){var n=this._getReplacedItemOnMagicTable(t);n&&this.removeItemFromCraft(n,this._onCraftTable[n].quantity)}var o=t.objectUID;"CRAFTER"===this.craftSide&&"craftInventory"!==e?window.dofus.sendMessage("ExchangeObjectUseInWorkshopMessage",{objectUID:o,quantity:i}):window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:o,quantity:i})},l.prototype.removeItemFromCraft=function(e,t){return t>=1?void("CRAFTER"===this.craftSide&&this.isMagicCraft?window.dofus.sendMessage("ExchangeObjectUseInWorkshopMessage",{objectUID:e,quantity:-t}):window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e,quantity:-t})):console.error("removeItemFromCraft quantity: "+t)},l.prototype.initialize=function(e){function t(e,t){var i;i=t?g("ui.craft.referenceAdd",e.nameId):g("ui.craft.referenceRemove",e.nameId),window.gui.chat.logMsg(i)}function i(e){var t=o.list[e.jobId];t||(t={},o.list[e.jobId]=t),t.experience=e}var o=this;n(),a();var s=b.createFifo();e.on("JobDescriptionMessage",function(e){s.push(function(t){r(e.jobsDescription,o.list,function(i){if(i)return t(i);o.jobOriginalOrder=[];for(var n=0;n<e.jobsDescription.length;n++)o.jobOriginalOrder.push(e.jobsDescription[n].jobId);o.emit("jobListUpdated"),t()})})}),e.on("JobCrafterDirectorySettingsMessage",function(e){s.push(function(t){o.craftersSettings=e.craftersSettings,t()})}),e.on("JobListedUpdateMessage",function(e){s.push(function(i){var n=o.list[e.jobId];return n?(t(n.info,e.addedOrDeleted),i()):void v.getData("Jobs",e.jobId,function(n,o){return n?i(n):(t(o,e.addedOrDeleted),void i())})})}),e.on("JobExperienceUpdateMessage",function(e){s.push(function(t){i(e.experiencesUpdate);var n=e.experiencesUpdate.jobId;o.emit("jobExperienceUpdate",o.getJobExperience(n)),t()})}),e.on("JobExperienceMultiUpdateMessage",function(e){s.push(function(t){for(var n=0,s=e.experiencesUpdate.length;n<s;n+=1){i(e.experiencesUpdate[n]);var a=e.experiencesUpdate[n].jobId;o.emit("jobExperienceUpdate",o.getJobExperience(a))}t()})}),e.on("JobLevelUpMessage",function(e){s.push(function(t){r([e.jobsDescription],o.list,function(i){if(i)return t(i);var n=e.newLevel,s=o.list[e.jobsDescription.jobId];s.experience.jobLevel=n;var a=g("ui.craft.newJobLevel",s.info.nameId,n);window.gui.chat.logMsg(a),window.gui.openSimplePopup(a,g("ui.common.informations")),w("LEVEL_UP"),o.emit("jobLevelUp",s,n),t()})})}),e.on("JobUnlearntMessage",function(e){s.push(function(t){delete o.list[e.jobId],o.jobOriginalOrder.splice(o.jobOriginalOrder.indexOf(e.jobId),1),o.emit("jobListUpdated"),t()})}),e.on("JobAllowMultiCraftRequestMessage",function(e){s.push(function(t){o._publicMode=e.enabled,delete o._playersMultiCraftSkillById[window.gui.playerData.id],o.emit("jobPublicMode",o._publicMode),t()})}),e.on("JobMultiCraftAvailableSkillsMessage",function(e){s.push(function(t){o._updateMultiCraftAvailableSkills(e),t()})}),e.on("CurrentMapMessage",function(){s.push(function(e){o._playersMultiCraftSkillById={},e()})})},l.prototype.getCraftTable=function(){return this._onCraftTable},l.prototype.setExistingSlotCount=function(e){this._existingSlotCount=Math.min(Math.max(e,0),this.MAX_CRAFT_SLOTS)},l.prototype.getExistingSlotCount=function(){return this._existingSlotCount},l.prototype.getFreeSlotCount=function(){var e=this._stackCountPerGid[M]?1:0;return"SOLO"===this.craftSide?this._existingSlotCount-this._stackCount+e:this._existingSlotCount-Object.keys(this._stackCountPerGid).length+e},l.prototype.prepareSkillRecipes=function(e,t){s([e],t)},l.prototype.getRecipesBySkill=function(e){
return h[e].recipes},l.prototype.getSkill=function(e){return h[e]},l.prototype.getStorageCraftFilterMap=function(e,t){for(var i=this._getRecipeByNbIngredient(e,1,t),n={},o=0,s=i.length;o<s;o+=1)for(var a=i[o].ingredientIds,r=0,l=a.length;r<l;r+=1){var c=a[r];n[c]=!0}return this.canCrafterSign&&"CLIENT"!==this.craftSide&&(n[M]=!0),n},l.prototype._getRecipeByNbIngredient=function(e,t,i){i=i||t;for(var n=this.getRecipesBySkill(e),o=[],s=0,a=n.length;s<a;s+=1){var r=n[s],l=r.ingredientIds.length;l>=t&&l<=i&&o.push(r)}return o},l.prototype._getRecipesWithItemsOnCraftTable=function(e){function t(){var e={};for(var t in i._onCraftTable){var n=i._onCraftTable[t],o=n.GID,s=n.quantity;o!==M&&(e[o]||(e[o]=0),e[o]+=s)}return e}for(var i=this,n=[],o=t(),s=Object.keys(o).length,a=this._getRecipeByNbIngredient(e,s),r=0,l=a.length;r<l;r+=1){var c=a[r],u=!0;for(var d in o){for(var h=parseInt(d,10),p=o[h],m=!1,f=0,g=c.ingredientIds.length;f<g;f+=1){var _=c.ingredientIds[f],v=c.quantities[f];if(h===_&&p===v){m=!0;break}}if(!m){u=!1;break}}u&&n.push(c)}return n},l.prototype.checkRecipe=function(e){var t,i=!1,n=this._getRecipesWithItemsOnCraftTable(e);return 1===n.length?(t=n[0],i=!0):e===this.SKILLID_DECRAFT&&(i=!0,t={resultId:this.ITEMID_MAGIC_FRAGMENT,resultLevel:1,ingredientIds:[],quantities:[]}),{isRecipeKnown:i,itemToCraft:t}},l.prototype._updateMultiCraftAvailableSkills=function(e){var t=this,i=e.playerId,n=e.skills,s={};if(!e.enabled)return void delete this._playersMultiCraftSkillById[i];for(var a=[],r=0,l=n.length;r<l;r+=1){var c=n[r];h[c]||a.push(c)}o("Skills",a,function(e){if(e)return console.error("JobData: Cannot get missing skills for ids",a,e);for(var o=0,r=n.length;o<r;o+=1){var l=n[o],c=h[l];c?s[l]=c:console.warn("JobsData: No data for skillId",l)}t._playersMultiCraftSkillById[i]=s})},l.prototype.playersMultiCraftSkillById=function(e){return this._playersMultiCraftSkillById[e]},l.prototype.getToolFromJob=function(e,t){var i=d[e];if(!i)return t(new Error("noJobForThatId "+e));var n=i.toolIds;if(!n||n.length<=0)return t();var o=null;y.getItems(n,function(e){if(e)return t(e);for(var i=0,s=n.length;i<s;i+=1){var a=n[i],r=y.items[a];if(r){var l=r.nameId;l.indexOf("WIP")===-1&&0!==r.iconId&&(!o||o.level>r.level||o.level===r.level&&o.objectGID>a)&&(o=r,o.objectGID=a)}}return t(null,o)})},l.prototype.getMaxSlotsByJobId=function(e){var t=this.list[e],i=0;if(!t)return 0;for(var n=t.description.skills,o=0,s=n.length;o<s;o+=1){var a=n[o].maxSlots;a&&a>i&&(i=a)}return i},l.prototype.getUsableSkillsInMap=function(e,t){var i=[];if(!t)return i;var n=this.playersMultiCraftSkillById(e);if(!n)return i;var o={};for(var s in t)for(var a=t[s],r=a.enabledSkills,l=a.disabledSkills,c=r.concat(l),u=0,d=c.length;u<d;u+=1){var h=c[u].skillId;n[h]&&!o[h]&&(i.push(n[h]),o[h]=!0)}return i},l.prototype.getJobNpcNameById=function(e){return x[e]},l.prototype.getJobExperience=function(e){var t=this.list[e];if(!t)return null;var i=t.experience||{},n={jobId:e};return n.currentLevel=i.jobLevel,n.currentExperience=i.jobXP,n.levelExperienceFloor=i.jobXpLevelFloor,n.levelExperienceCeil=i.jobXpNextLevelFloor,n.percentage=100,n.levelExperienceCeil&&(n.percentage=Math.floor((n.currentExperience-n.levelExperienceFloor)/(n.levelExperienceCeil-n.levelExperienceFloor)*100)),n}},function(e,t,i){function n(){o.call(this),this.finishedAchievementsIds=[],this.accountAchievementsIds=[],this.rewardableAchievements={},this.maximumNumberOfAchievements=0,this.achievementCategories=[],this.categories={},this.categoriesPercentage={},this.categoriesAchievementCount={},this.categoriesCurrentAchievementCount={},this.categoriesTotal={},this.categoriesTotalPercentage={},this.categoriesTotalAchievementCount={},this.categoriesTotalCurrentAchievementCount={},this.subCategories={},this.subCategoriesPercentage={},this.subCategoriesAchievementCount={},this.subCategoriesCurentAchievementCount={},this.points=0}var o=i(194).EventEmitter,s=i(191).inherits,a=i(29).getText,r=i(30),l=1.5,c=.7;s(n,o),e.exports=n,n.prototype.disconnect=function(){this.finishedAchievementsIds=[],this.accountAchievementsIds=[],this.rewardableAchievements={},this.points=0,this.categoriesPercentage={},this.categoriesCurrentAchievementCount={},this.categoriesTotalPercentage={},this.categoriesTotalCurrentAchievementCount={},this.subCategoriesPercentage={},this.subCategoriesCurentAchievementCount={}},n.prototype.initialize=function(e){var t=this;e.on("AchievementListMessage",function(e){var i=e.enrichData.points;e.enrichData.achievementsTotal&&(t.maximumNumberOfAchievements=e.enrichData.achievementsTotal),t.finishedAchievementsIds=e.finishedAchievementsIds;for(var n=0;n<e.rewardableAchievements.length;n++)t.finishedAchievementsIds.push(e.rewardableAchievements[n].id),t.rewardableAchievements[e.rewardableAchievements[n].id]=e.rewardableAchievements[n];for(var o=0;o<e.accountAchievements.length;o++)e.accountAchievements[o].isFirstForAccount||t.accountAchievementsIds.push(e.accountAchievements[o].id);t.points=i,t.emit("achievementListUpdated",e)}),e.on("AchievementFinishedMessage",function(e){window.gui.chat.logMsg(a("ui.achievement.achievementUnlockWithLink",e.id));var i=e.enrichData.points;t.finishedAchievementsIds.push(e.id),t.rewardableAchievements[e.id]=e,t.points+=i;var n=null,o=e.enrichData.categoryID;if(t.categories[o])t.categoriesTotalCurrentAchievementCount[o]++,t.categoriesCurrentAchievementCount[o]++,t.categoriesPercentage[o]=t.categoriesCurrentAchievementCount[o]/t.categoriesAchievementCount[o];else{for(var s in t.categoriesTotal)if(t.categoriesTotal.hasOwnProperty(s)&&t.categoriesTotal[s].indexOf(o)!==-1){n=s;break}n&&(t.categoriesTotalCurrentAchievementCount[n]++,t.subCategoriesCurentAchievementCount[o]++,t.subCategoriesPercentage[o]=t.subCategoriesCurentAchievementCount[o]/t.subCategoriesAchievementCount[o])}n?t.categoriesTotalPercentage[n]=t.categoriesTotalCurrentAchievementCount[n]/t.categoriesTotalAchievementCount[n]:t.categoriesTotalPercentage[o]=t.categoriesTotalCurrentAchievementCount[o]/t.categoriesTotalAchievementCount[o],e.parentCategoryID=n,t.emit("achievementFinished",e)}),e.on("AchievementRewardSuccessMessage",function(e){delete t.rewardableAchievements[e.achievementId],t.emit("achievementRewardSuccess",e.achievementId)}),r.getAllDataBulk("AchievementCategories",function(e,i){return e?console.error("AchievementCategories error",e):(t.achievementCategories=i,void i.forEach(function(e){var i=e.achievementIds.length;0===e.parentId?i>0&&(t.categoriesTotalAchievementCount[e.id]?t.categoriesTotalAchievementCount[e.id]+=i:t.categoriesTotalAchievementCount[e.id]=i,t.categoriesAchievementCount[e.id]=i,t.categories[e.id]=e.achievementIds):(t.categoriesTotal[e.parentId]?t.categoriesTotal[e.parentId].push(e.id):t.categoriesTotal[e.parentId]=[e.id],t.categoriesTotalAchievementCount[e.parentId]?t.categoriesTotalAchievementCount[e.parentId]+=i:t.categoriesTotalAchievementCount[e.parentId]=i,t.subCategoriesAchievementCount[e.id]=i,t.subCategories[e.id]=e.achievementIds)}))})},n.prototype.getCategoryPercentage=function(e){var t=this,i=this.categoriesTotal[e];this.categoriesTotalCurrentAchievementCount[e]=0,i&&i.forEach(function(i){var n=t.subCategories[i];t.subCategoriesCurentAchievementCount[i]=0,n?(n.forEach(function(n){t.finishedAchievementsIds.indexOf(n)!==-1&&(t.subCategoriesCurentAchievementCount[i]++,t.categoriesTotalCurrentAchievementCount[e]++)}),t.subCategoriesPercentage[i]=t.subCategoriesCurentAchievementCount[i]/t.subCategoriesAchievementCount[i]):console.error("getCategoryPercentage : Cannot get sub category ID ",i)});var n=this.categories[e];this.categoriesCurrentAchievementCount[e]=0,n&&(n.forEach(function(i){t.finishedAchievementsIds.indexOf(i)!==-1&&(t.categoriesCurrentAchievementCount[e]++,t.categoriesTotalCurrentAchievementCount[e]++)}),this.categoriesPercentage[e]=this.categoriesCurrentAchievementCount[e]/this.categoriesAchievementCount[e]),this.categoriesTotalPercentage[e]=this.categoriesTotalCurrentAchievementCount[e]/this.categoriesTotalAchievementCount[e]},n.prototype.getAchievementKamasReward=function(e,t,i){if(!e)return 0;var n=e.kamasScaleWithPlayerLevel?i:t;return Math.floor((Math.pow(n,2)+20*n-20)*e.kamasRatio)},n.prototype.getAchievementExperienceReward=function(e,t,i){if(!e)return 0;var n=1+window.gui.playerData.experienceFactor/100,o=e.experienceRatio;if(i>t){var s=Math.floor(Math.min(i,t*l)),a=this.getFixedExperienceReward(t,o),r=this.getFixedExperienceReward(s,o),u=(1-c)*a,d=c*r;return Math.floor((u+d)*n)}var h=this.getFixedExperienceReward(i,o);return Math.floor(h*n)},n.prototype.getFixedExperienceReward=function(e,t){return Math.floor(e*Math.pow(100+2*e,2)/20*t)},n.prototype.completedData=function(e){var t=this.finishedAchievementsIds.indexOf(e)!==-1,i=this.rewardableAchievements[e],n=this.accountAchievementsIds.indexOf(e)!==-1,o={isAccountCompleted:n,isCompleted:t&&!i,finishedlevel:null};if(o.isCompleted)return o;var s=this.rewardableAchievements;for(var a in s)if(s.hasOwnProperty(a)){var r=s[a];if(r.id===e){o.isCompleted=!0,o.finishedlevel=r.finishedlevel;break}}return o},n.prototype.getAchievementPercent=function(){return 0===this.maximumNumberOfAchievements?0:Math.round(this.finishedAchievementsIds.length/this.maximumNumberOfAchievements*100)}},function(e,t,i){function n(){o.call(this),this._reset()}var o=i(194).EventEmitter,s=i(191).inherits,a=i(30),r=i(258),l=45;s(n,o),e.exports=n,n.prototype.disconnect=function(){this._reset()},n.prototype._reset=function(){this.mapId=0,this.subAreaId=0,this.worldmapId=0,this.mapPosition=null,this.subArea=null,this.area=null,this.superArea=null,this.coordinates={posX:0,posY:0},this.isInMyHouse=!1,this.currentMapHouses={}},n.prototype.initialize=function(e){function t(e){o.currentMapHouses={},o.emit("mapChanged",e)}function i(t,i){o.mapId=t.mapId,a.getObject("MapPositions",t.mapId,function(n,s){if(n)return console.error("MapPositions missing or error",t.mapId,n);o.mapPosition=s;var l=i?i.worldX:s.posX,c=i?i.worldY:s.posY;return o.coordinates.posX=l,o.coordinates.posY=c,o.subArea&&o.subArea.id===t.subAreaId&&o.subAreaId===t.subAreaId?(o.emit("mapUpdate"),void r.mapChange(o.subArea.ambientSounds,s.sounds)):(o.subAreaId=t.subAreaId,void a.getData("SubAreas",o.subAreaId,function(t,i){if(t)return console.warn("SubAreas error",t);r.mapChange(i.ambientSounds,s.sounds),o.subArea=i,o.area=e.databases.Areas[i.areaId],o.superArea=e.databases.SuperAreas[o.area.superAreaId];var n=s.worldMap>=0?s.worldMap:o.superArea.worldmapId;o.worldmapId!==n&&(o.worldmapId=n,o.emit("worldMapUpdate")),o.emit("mapUpdate")}))})}function n(e){var t=e.currentHouse;if(t){var i=window.gui.playerData;o.isInMyHouse=t.ownerId===i.identification.accountId,o.emit("myHouseNotification",{isInMyHouse:o.isInMyHouse,msg:e})}else!t&&o.isInMyHouse&&(o.isInMyHouse=!1,o.emit("myHouseNotification",{isInMyHouse:o.isInMyHouse}))}var o=this;e.on("mapComplementaryInformationsData",function(e){t(e),"MapComplementaryInformationsWithCoordsMessage"===e._messageType?i(e,{worldX:e.worldX,worldY:e.worldY}):"MapComplementaryInformationsDataInHouseMessage"===e._messageType?i(e,e.currentHouse):i(e),n(e)}),e.on("HousePropertiesMessage",function(e){var t=e.properties;if(t){var i=t.houseId;o.currentMapHouses[i]=t}})},n.prototype.getHousePropertiesById=function(e){return this.currentMapHouses[e]},n.prototype.isInIncarnam=function(){return this.area?this.area.id===l:(console.warn("isInIncarnam called before we know our area"),!1)}},function(e,t,i){function n(){s.call(this),this._pastParties=null,this._reset()}function o(e,t,i,n){this._partyId=t,this._partyType=e,this._leaderId=i,this._myCharacterId=n,this._timeWhenDisconnected=0,this._inviterName=null,this._members={},this._guests={},this._pastMembers={}}var s=i(194).EventEmitter,a=i(191).inherits,r=i(29).getText,l=i(793),c=i(623),u=i(752),d=i(277),h=i(794),p=i(795),m=i(195),f=c.PARTY_TYPE_CLASSICAL,g=c.PARTY_TYPE_ARENA,_=3e5,v=1;a(n,s),e.exports=n,n.NUM_SLOTS_ARENA=3,n.NUM_SLOTS_CLASSIC=d.MAX_MEMBERS_PER_PARTY,n.prototype._reset=function(){this._partyFromId={},this.arenaStats={},this.arenaRegistered=!1,this.arenaStep=h.ARENA_STEP_UNREGISTER,this._followedCharacterId=0,this._partyFights={}},n.prototype.connect=function(){null===this._pastParties&&this._reloadRecentParties(),this._tryToRejoin(window.gui.playerData.id)},n.prototype.disconnect=function(){for(var e in this._partyFromId)this._archiveParty(this._partyFromId[e]);this._reset()},o.unserializeFrom=function(e){var t=new o(e._partyType,e._partyId,e._leaderId,e._myCharacterId);return t._timeWhenDisconnected=e._timeWhenDisconnected,t._members=e._members,t._guests=e._guests,t._pastMembers=e._pastMembers,t},o.prototype._purgeExpiredPastMembers=function(){for(var e in this._pastMembers){var t=this._pastMembers[e];Date.now()-t._timeWhenLeft>_&&delete this._pastMembers[e]}},o.prototype.getPartyId=function(){return this._partyId},o.prototype.getLeaderId=function(){return this._leaderId},o.prototype.getMember=function(e){return this._members[e]},o.prototype.getMembers=function(){return this._members},o.prototype.getGuest=function(e){return this._guests[e]},o.prototype.getSlotCount=function(){return this._partyType===g?n.NUM_SLOTS_ARENA:n.NUM_SLOTS_CLASSIC},o.prototype.getFreeSlotCount=function(){return this.getSlotCount()-this.getMemberCount()-this.getGuestCount()},o.prototype.getGuestCount=function(){return Object.keys(this._guests).length},o.prototype.getMemberCount=function(){return Object.keys(this._members).length+1},o.prototype._addMember=function(e,t,i){e!==this._myCharacterId&&(this._members[e]={name:t,level:i},this._pastMembers[e]&&delete this._pastMembers[e])},o.prototype._removeMember=function(e,t){this._purgeExpiredPastMembers();var i=this._members[e];i&&(t||(this._pastMembers[e]=i,i._timeWhenLeft=Date.now()),delete this._members[e])},o.prototype._addGuest=function(e){this._guests[e.guestId]={hostId:e.hostId,guestName:e.name,guestId:e.guestId}},o.prototype._removeGuest=function(e){delete this._guests[e]},n.prototype._joinParty=function(e,t,i,n,s){var a=new o(e,t,s,window.gui.playerData.id);this._partyFromId[t]=a;for(var r=0;r<i.length;r+=1){var l=i[r];a._addMember(l.id,l.name,l.level)}for(r=0;r<n.length;r++)a._addGuest(n[r]);e===g&&this.emit("arenaJoined"),this._rememberRecentParties(v)},n.prototype._leaveParty=function(e,t,i){var n=this._partyFromId[e];n&&(this.emit("playerLeavingParty",e,t),i&&this._archiveParty(n),delete this._partyFromId[e],this.emit("playerLeftParty",e,t),this._rememberRecentParties())},n.prototype._updatePartyLeader=function(e,t){var i=this._partyFromId[e];i&&(this.emit("partyLeaderUpdate",e,t),i._partyType===g&&this.emit("arenaLeaderUpdate",t),i._leaderId=t)},n.prototype._getPartyFromType=function(e){for(var t in this._partyFromId){var i=this._partyFromId[t];if(i._partyType===e)return i}return null},n.prototype.getClassicalParty=function(){return this._getPartyFromType(f)},n.prototype.getArenaParty=function(){return this._getPartyFromType(g)},n.prototype.getMemberName=function(e){var t=window.gui.playerData;if(e===t.id)return t.characterBaseInformations.name;for(var i in this._partyFromId){var n=this._partyFromId[i],o=n._members[e];if(o)return o.name}return"?"},n.prototype._addPartyGuest=function(e,t){var i=this._partyFromId[e];i&&(i._addGuest(t),this.emit("partyNewGuest",e,t))},n.prototype._removePartyGuest=function(e,t,i){var n=this._partyFromId[e];n&&(this.emit("partyGuestLeaving",e,t,i),n._removeGuest(t))},n.prototype._addPartyMember=function(e,t){var i=this._partyFromId[e];i&&(i._removeGuest(t.id),i._addMember(t.id,t.name,t.level),i._partyType===g&&this.emit("arenaNewMember",t),this.emit("partyNewMember",e,t),this._rememberRecentParties())},n.prototype._removePartyMember=function(e,t,i){var n=this._partyFromId[e];n&&(this.emit("partyMemberLeaving",e,t,i),n._partyType===g&&this.emit("arenaMemberLeaving",t),n._removeMember(t,!!i),this._rememberRecentParties())},n.prototype.getGuestName=function(e,t){var i=this._partyFromId[e];if(!i)return"?";var n=i._guests[t];return n?n.guestName:"?"},n.prototype._enrichGuestInfo=function(e){e.isGuest=!0,e.level="?",e.id=e.guestId,e.entityLook=e.guestLook},n.prototype.getFollowedCharacterId=function(){return this._followedCharacterId},n.prototype.initialize=function(e){var t=this,i=window.dofus.connectionManager;i.on("PartyInvitationMessage",function(i){t._handleRequestedInvitation(i.partyType,i.partyId,i.fromName)||e.party.showPartyInvitationQuestion(i.partyType,i.partyId,i.fromName)}),e.on("PartyInvitationDetailsMessage",function(e){for(var i=0;i<e.guests.length;i++)t._enrichGuestInfo(e.guests[i]);t.emit("partyInvitationDetails",e)}),e.on("PartyNewGuestMessage",function(e){t._enrichGuestInfo(e.guest),t._addPartyGuest(e.partyId,e.guest)}),e.on("PartyNewMemberMessage",function(e){t._addPartyMember(e.partyId,e.memberInformations)}),e.on("PartyUpdateMessage",function(e){t.emit("partyUpdateMember",e.partyId,e.memberInformations)}),i.on("PartyDeletedMessage",function(e){t._leaveParty(e.partyId,0,!0)}),i.on("PartyLeaveMessage",function(e){t._leaveParty(e.partyId,0)}),i.on("PartyKickedByMessage",function(e){t._leaveParty(e.partyId,e.kickerId)}),i.on("PartyCancelInvitationNotificationMessage",function(e){t._removePartyGuest(e.partyId,e.guestId,e.cancelerId)}),i.on("PartyInvitationCancelledForGuestMessage",function(e){t.emit("partyInvitationCancelled",e.partyId,e.cancelerId)}),e.on("PartyJoinMessage",function(e){t._joinParty(e.partyType,e.partyId,e.members,e.guests,e.partyLeaderId)}),i.on("PartyMemberRemoveMessage",function(e){t._removePartyMember(e.partyId,e.leavingPlayerId)}),i.on("PartyMemberEjectedMessage",function(e){t._removePartyMember(e.partyId,e.leavingPlayerId,e.kickerId)}),i.on("PartyLeaderUpdateMessage",function(e){t._updatePartyLeader(e.partyId,e.partyLeaderId)}),i.on("PartyRefuseInvitationNotificationMessage",function(e){t._removePartyGuest(e.partyId,e.guestId)}),e.on("PartyFollowStatusUpdateMessage",function(e){e.success&&(t._followedCharacterId=e.followedId)}),e.on("GameRolePlayArenaRegistrationStatusMessage",function(e){t.arenaStep=e.step,t.arenaRegistered=e.registered,1!==e.step||e.registered||(t.nbArenaFigthersReady=0),t.emit("arenaRegistrationStatus")}),e.on("GameFightJoinMessage",function(e){e.fightType!==u.FIGHT_TYPE_PVP_ARENA||e.isSpectator||(t.arenaStep=h.ARENA_STEP_STARTING_FIGHT,t.arenaRegistered=!1,t.emit("arenaRegistrationStatus")),t._cleanPartyFightNotifications()}),e.on("GameFightEndMessage",function(e){t.arenaStep===h.ARENA_STEP_STARTING_FIGHT&&(t.arenaStep=h.ARENA_STEP_UNREGISTER,t.emit("arenaRegistrationStatus"),t.emit("arenaFightEnd"),window.gui.playerData.evaluateRatingOpening("arenaFightWin",{fighters:e.results}))}),e.on("GameRolePlayArenaUpdatePlayerInfosMessage",function(e){t.arenaStats={rank:e.rank,bestDailyRank:e.bestDailyRank,bestRank:e.bestRank,victoryCount:e.victoryCount,arenaFightCount:e.arenaFightcount},t.emit("arenaStatsUpdated")}),e.on("GameRolePlayArenaFighterStatusMessage",function(e){e.accepted?(t.nbArenaFigthersReady++,t.emit("arenaFighterReady",t.nbArenaFigthersReady)):t.emit("arenaFightDeclined",e.fightId,e.playerId)}),e.on("PartyCannotJoinErrorMessage",function(e){var t;switch(e.reason){case l.PARTY_JOIN_ERROR_UNKNOWN:t=r("ui.party.cantInvit");break;case l.PARTY_JOIN_ERROR_PLAYER_NOT_FOUND:break;case l.PARTY_JOIN_ERROR_PARTY_NOT_FOUND:t=r("ui.party.cantFindParty");break;case l.PARTY_JOIN_ERROR_PARTY_FULL:t=r("ui.party.partyFull");break;case l.PARTY_JOIN_ERROR_PLAYER_BUSY:t=r("ui.party.cantInvitPlayerBusy");break;case l.PARTY_JOIN_ERROR_PLAYER_ALREADY_INVITED:t=r("ui.party.playerAlreayBeingInvited");break;case l.PARTY_JOIN_ERROR_PLAYER_TOO_SOLLICITED:t=r("ui.party.playerTooSollicited");break;case l.PARTY_JOIN_ERROR_UNMODIFIABLE:t=r("ui.party.partyUnmodifiable");break;case l.PARTY_JOIN_ERROR_UNMET_CRITERION:case l.PARTY_JOIN_ERROR_PLAYER_LOYAL:}t&&this.openSimplePopup(t)}),e.on("PartyMemberInFightMessage",function(i){var n=e.playerData.isFighting&&!e.playerData.isSpectator;if(!n){var o,s=i.fightMap.mapId;switch(i.reason){case p.FIGHT_REASON_MONSTER_ATTACK:o=r("ui.party.memberStartFight.monsterAttack",i.memberName,i.memberId,s);break;case p.FIGHT_REASON_PLAYER_ATTACK:o=r("ui.party.memberStartFight.playerAttack",i.memberName,i.memberId,s);break;case p.FIGHT_REASON_MEMBER_ATTACKED_PLAYERS:o=r("ui.party.memberStartFight.attackPlayer",i.memberName,i.memberId,s);break;default:o=r("ui.party.memberStartFight.unknownReason",i.memberName,i.memberId,s)}e.chat.logMsg(o);var a=i.secondsBeforeFightStart;if(t._addFightInfo(s,i.fightId,i.memberId,i.memberName,a),e.playerData.position.mapId===s){var l=i.memberId;e.party.showPartyFightQuestion(i.fightId,l,i.memberId,i.memberName,a)}}}),e.on("GameRolePlayRemoveChallengeMessage",function(i){e.party.removePartyFightQuestion(i.fightId),t._deleteFightInfo(e.playerData.position.mapId,i.fightId)}),e.on("mapComplementaryInformationsData",function(i){t._cleanPartyFightNotifications();var n=t._partyFights[i.mapId];if(n)for(var o=i.fights,s=0;s<o.length;s++){var a=n[o[s].fightId];if(a){var r=a.memberId;e.party.showPartyFightQuestion(a.fightId,r,a.memberId,a.memberName,a.startTime-Date.now())}}})},n.prototype._addFightInfo=function(e,t,i,n,o){var s=this._partyFights[e];s||(s=this._partyFights[e]={}),s[t]={fightId:t,memberId:i,memberName:n,startTime:Date.now()+o};var a=this;window.setTimeout(function(){a._deleteFightInfo(e,t)},o)},n.prototype._deleteFightInfo=function(e,t){var i=this._partyFights[e];i&&(delete i[t],0===Object.keys(i).length&&delete this._partyFights[e])},n.prototype._cleanPartyFightNotifications=function(){for(var e in this._partyFights){var t=this._partyFights[e];for(var i in t)window.gui.party.removePartyFightQuestion(i)}},n.prototype._archiveParty=function(e){e._timeWhenDisconnected=Date.now(),this._pastParties[e._partyId]=e},n.prototype._purgeExpiredPastParties=function(){var e,t={};for(var i in this._pastParties)e=this._pastParties[i],t[e._partyType]=Math.max(t[e._partyType]||0,e._timeWhenDisconnected),Date.now()-e._timeWhenDisconnected>_&&delete this._pastParties[i];for(i in this._pastParties)e=this._pastParties[i],e._timeWhenDisconnected<t[e._partyType]&&delete this._pastParties[i]},n.prototype._rememberRecentParties=function(e){var t={};for(var i in this._partyFromId)t[i]=this._partyFromId[i];this._purgeExpiredPastParties();for(i in this._pastParties)t[i]=this._pastParties[i];m.setValue("recentParties",t,e)},n.prototype._reloadRecentParties=function(){var e=m.getValue("recentParties",{});this._pastParties={};for(var t in e){var i=o.unserializeFrom(e[t]);this._pastParties[t]=i,i._timeWhenDisconnected||(i._timeWhenDisconnected=Date.now())}},n.prototype._tryToRejoin=function(e){this._purgeExpiredPastParties();for(var t in this._pastParties){var i=this._pastParties[t];if(!i._inviterName&&e===i._myCharacterId){var n=[];for(var o in i._members)n.push(i._members[o].name);i._purgeExpiredPastMembers();for(o in i._pastMembers)n.push(i._pastMembers[o].name);if(n.length){var s=i._members[i._leaderId]||i._pastMembers[i._leaderId];s&&(n.splice(n.indexOf(s.name),1),n.unshift(s.name)),this._findOnlineInviter(i,n)}}}},n.prototype._findOnlineInviter=function(e,t){var i=this;window.gui.chat.p2p.checkPlayerOnline(t[0],function(n,o){return o?(e._inviterName=n,window.gui.chat.p2p.sendMsg(n,"rejoinRequest",e._partyId)):(t.shift(),t.length?i._findOnlineInviter(e,t):void 0)})},n.prototype.handleRejoinRequest=function(e,t){var i,n;this._purgeExpiredPastParties();var o=this._partyFromId[e];if(o){if(n=o._partyType,o._purgeExpiredPastMembers(),i=o._pastMembers[t],!i)return;if(0===o.getFreeSlotCount())return}else{var s=this._pastParties[e];if(!s)return;if(s._purgeExpiredPastMembers(),i=s._members[t]||s._pastMembers[t],!i)return;if(n=s._partyType,this._getPartyFromType(n))return}var a=n===g?"PartyInvitationArenaRequestMessage":"PartyInvitationRequestMessage";window.dofus.sendMessage(a,{name:i.name})},n.prototype._handleRequestedInvitation=function(e,t,i){this._purgeExpiredPastParties();var n=this._pastParties[t];if(!n){var o=!1;for(var s in this._pastParties){var a=this._pastParties[s];if(a._partyType===e&&a._inviterName===i){o=!0;break}}if(!o)return!1}return window.dofus.sendMessage("PartyAcceptInvitationMessage",{partyId:t}),!0}},function(e,t){e.exports={PARTY_JOIN_ERROR_UNKNOWN:0,PARTY_JOIN_ERROR_PLAYER_NOT_FOUND:1,PARTY_JOIN_ERROR_PARTY_NOT_FOUND:2,PARTY_JOIN_ERROR_PARTY_FULL:3,PARTY_JOIN_ERROR_PLAYER_BUSY:4,PARTY_JOIN_ERROR_PLAYER_ALREADY_INVITED:6,PARTY_JOIN_ERROR_PLAYER_TOO_SOLLICITED:7,PARTY_JOIN_ERROR_PLAYER_LOYAL:8,PARTY_JOIN_ERROR_UNMODIFIABLE:9,PARTY_JOIN_ERROR_UNMET_CRITERION:10}},function(e,t){e.exports={ARENA_STEP_REGISTRED:0,ARENA_STEP_WAITING_FIGHT:1,ARENA_STEP_STARTING_FIGHT:2,ARENA_STEP_UNREGISTER:3}},function(e,t){e.exports={FIGHT_REASON_UNKNOWN:0,FIGHT_REASON_MONSTER_ATTACK:1,FIGHT_REASON_PLAYER_ATTACK:2,FIGHT_REASON_MEMBER_ATTACKED_PLAYERS:3}},function(e,t,i){function n(){s.call(this),this._reset()}var o=i(31),s=i(194).EventEmitter,a=i(29).getText,r=i(797),l=i(191).inherits,c=i(252).createFifo();l(n,s),e.exports=n,n.prototype._reset=function(){this.finished={},this.active={},this.all={},this.initialized=!1},n.prototype.connect=function(e){return e?window.gui.once("GameFightStartingMessage",function(){window.dofus.sendMessage("QuestListRequestMessage")}):void window.dofus.sendMessage("QuestListRequestMessage")},n.prototype.disconnect=function(){this._reset()},n.prototype.initialize=function(e){var t=this;e.on("QuestListMessage",function(e){o.parallel([function(i){r.createFinishedQuestsMap(e.finishedQuestsIds,e.finishedQuestsCounts,function(e,n){if(e)return i(e);for(var o in n)t.finished[o]=t.all[o]=n[o];i()})},function(i){r.initializeActiveQuests(e.activeQuests,function(e,n){if(e)return i(e);for(var o in n)t.active[o]=t.all[o]=n[o];i()})}],function(e){return e?console.error(e):(t.initialized=!0,void t.emit("listUpdated"))})}),e.on("QuestStartedMessage",function(e){delete t.finished[e.questId],window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:e.questId})}),e.on("QuestObjectiveValidatedMessage",function(e){var i=t.active[e.questId];window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:i.questId});for(var n=0,o=i.objectives.length;n<o;n+=1){var s=i.objectives[n];if(s.objectiveId===e.objectiveId)return s.objectiveStatus=!1,t.emit("objectiveValidated",i,e.objectiveId),t.emit("questUpdate",e.questId)}}),e.on("QuestStepInfoMessage",function(e){c.push(function(i){if(!e.infos.objectives)return i();var n=e.infos;if(!n)return i();var o=n.questId,s=t.active[o]||n;s.stepId=n.stepId,s.objectives=n.objectives,s.dbQuest?r.updateQuestObjectives(s,function(e){return e?i(e):(t.emit("questUpdate",s.questId),void i())}):r.initializeActiveQuests([s],function(e,n){return e?i(e):(t.active[o]=t.all[o]=n[o],t.emit("questStarted",o),void i())})})}),e.on("QuestStepStartedMessage",function(e){var i=t.active[e.questId];i&&(i.stepId=e.stepId,window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:i.questId}))}),e.on("QuestStepValidatedMessage",function(e){var i=t.active[e.questId];if(i){var n=i.dbQuest.stepIds,o=n.indexOf(e.stepId);i.stepId=n[o+1],t.emit("stepValidated",i,e.stepId),window.dofus.sendMessage("QuestStepInfoRequestMessage",{questId:i.questId})}}),e.on("QuestValidatedMessage",function(e){var i=t.active[e.questId];delete t.active[e.questId],i.finishedCount=1,t.finished[e.questId]=t.all[e.questId]=i;var n=window.gui.playerData.characterBaseInformations.level;for(var o in i.dbRewards){var s=i.dbRewards[o],r=s.itemsReward,l=s.levelMax,c=s.levelMin;if(!(l>-1&&c>-1&&(l<=n||c>=n)))for(var u in r){var d=r[u];window.gui.chat.logMsg(a("ui.common.newItem",d[1],d[0]))}}t.emit("questFinished",i)})}},function(e,t,i){function n(e,t,i,n,o){e[n.id]||(e[n.id]=[],o[n.id]=n.type),e[n.id].push(t[i])}function o(e,t,i,n,o,s){var a=t[o];s.hyperlink&&i.push([o,s.hyperlink+a]);var r=n[s.id]||{},l=r[a];l||(d.error(new Error("ptop "+e+": missing db for param "+a+" on id "+s.id)),l={}),t[o]=l.nameId||""}function s(e,t,i){e[i]=t.GetText[e[i]]}function a(e,t){for(var i=window.gui.databases.QuestObjectiveTypes,a={},c={},u=0,d=e.length;u<d;u+=1)for(var m=e[u],f=m.objectives,g=0,_=f.length;g<_;g+=1)for(var v=m.dbObjectives[f[g].objectiveId],y=h[v._type],b=0,w=y.length;b<w;b+=1){var M=y[b];n(a,v.parameters,b,M,c)}r.each(Object.keys(a),function(e,t){return a[e].length?void p[c[e]](a,e,t):t()},function(n){if(n)return t(n);for(var r=0,c=e.length;r<c;r+=1)for(var u=e[r],d=u.objectives,p=0,m=d.length;p<m;p+=1){for(var f=d[p],g=f.objectiveId,_=u.dbObjectives[g],v=_.parameters.slice(0),y=[],b=h[_._type],w=0,M=b.length;w<M;w+=1){var T=b[w];"getText"===T.type?s(v,a,w):"table"===T.type&&o(g,v,y,a,w,T)}var C=i[_.typeId].nameId;if(v.unshift(C),f.text=l.apply(null,v),y.length){for(var I=v.concat(),A=0;A<y.length;A++)I[y[A][0]+1]=y[A][1];f.hypertext=l.apply(null,I)}}t()})}var r=i(31),l=i(29).processText,c=i(30),u=i(798),d=i(207).logger,h={QuestObjectiveBringItemToNpc:[{type:"table",id:"Npcs"},{type:"table",id:"Items",hyperlink:"$item"}],QuestObjectiveBringSoulToNpc:[{type:"table",id:"Npcs"},{type:"table",id:"Monsters",hyperlink:"$monster"}],QuestObjectiveDiscoverMap:[{type:"getText",id:"GetText"}],QuestObjectiveDiscoverSubArea:[{type:"table",id:"SubAreas"}],QuestObjectiveDuelSpecificPlayer:[{type:"getText",id:"GetText"}],QuestObjectiveFightMonster:[{type:"table",id:"Monsters",hyperlink:"$monster"}],QuestObjectiveFightMonstersOnMap:[{type:"table",id:"Monsters"}],QuestObjectiveFreeForm:[{type:"getText",id:"GetText"}],QuestObjectiveGoToNpc:[{type:"table",id:"Npcs"}],QuestObjectiveMultiFightMonster:[{type:"table",id:"Monsters",hyperlink:"$monster"}]},p={table:function(e,t,i){c.getDataMap(t,e[t],function(n,o){e[t]=o,i(n)})},getText:function(e,t,i){c.getText(e[t],function(n,o){e[t]=o,i(n)})}};e.exports.updateQuestObjectives=function(e,t){a([e],t)},e.exports.createFinishedQuestsMap=function(e,t,i){var n={};c.getDataMap("Quests",e,function(o,s){if(o)return i(o);for(var a=0,r=e.length;a<r;a+=1){var l=e[a];n[l]={questId:l,dbQuest:s[l],finishedCount:t[a]}}i(null,n)})},e.exports.initializeActiveQuests=function(e,t){for(var i=[],n={},o=0,s=e.length;o<s;o+=1){var l=e[o];n[l.questId]=l,i.push(l.questId)}c.getDataMap("Quests",i,function(i,o){if(i)return t(i);var s=[];for(var l in o){var d=n[l].dbQuest=o[l];s=s.concat(d.stepIds)}c.getDataMap("QuestSteps",s,function(i,s){if(i)return t(i);var l=[],d=[];for(var h in o){var p=n[h],m=p.dbQuest.stepIds;p.dbSteps={};var f,g;for(f=0,g=m.length;f<g;f+=1){var _=m[f],v=p.dbSteps[_]=s[_];l=l.concat(v.rewardsIds),d=d.concat(v.objectiveIds)}}var y=[{ids:d,table:"QuestObjectives"},{ids:l,table:"QuestStepRewards"}];r.each(y,function(e,t){c.getDataMap(e.table,e.ids,function(i,n){e.data=n,t(i)})},function(i){if(i)return t(i);for(var s in o){var r=n[s];r.dbObjectives={},r.dbRewards={};for(var l in r.dbSteps){var c,d,h,p=r.dbSteps[l];for(c=0,d=p.objectiveIds.length;c<d;c+=1)h=p.objectiveIds[c],r.dbObjectives[h]=y[0].data[h],0===r.dbObjectives[h].mapId&&(r.dbObjectives[h].mapId=u[h]||0);for(c=0,d=p.rewardsIds.length;c<d;c+=1)h=p.rewardsIds[c],r.dbRewards[h]=y[1].data[h]}}a(e,function(e){t(e,n)})})})})}},function(e,t){var i={713:"80216068",4944:"80217604",4945:"80216580",5048:"80216068",5068:"80216068",5071:"80216068",5134:"80216068",720:"80216579",5051:"80216579",745:"80216580",5132:"80216580",5133:"80216580",4982:"80216833",757:"80217090",785:"80217090",4983:"80217098",748:"80217602",793:"80217605",794:"80217605",820:"80218116",5139:"80218116",5157:"80218116",5158:"80218116",5162:"80218116",5163:"80218116",5164:"80218116",5165:"80218116",5166:"80218116",5184:"80218116",787:"80218120",788:"80218120",789:"80218120",790:"80218120",791:"80218120",5073:"80218120",5074:"80218120",786:"80218624",5069:"80218624",5070:"80218624",751:"80218626",771:"80218626",4990:"80218627",5047:"80218631",810:"80219136",783:"80219143",784:"80219144",796:"80219144",4963:"80219144",4995:"80219653",808:"80219654",809:"80219654",749:"80219655",4991:"80220160",4993:"80220163",
746:"80220164",753:"80220164",4992:"80220673",747:"80220676",4907:"80220676",4981:"80347648",4980:"80347651",4985:"80347653",5189:"80347656",4984:"80348167",5072:"80740865",4943:"81003522",4655:"81268739",4656:"81268739",4941:"81269763",4942:"81269763",758:"81270787",759:"81270787",4947:"81270787",4964:"81270787",4986:"81270787",4996:"81270787",5024:"81270787",5043:"81270787",4657:"81396739",729:"81527297",782:"81527297",822:"81527297",823:"81527297",724:"81527299",750:"81527299",755:"81527299",800:"81527299",806:"81527299",5067:"81527299",744:"81527301",752:"81527301",754:"81528321",824:"81528321",825:"81528321",4946:"81528321",5136:"81528321",5140:"81528321",5141:"81528321",5142:"81528321",5159:"81528321",5161:"81528321",804:"81528323",5058:"81528323",5135:"81528323",761:"81529345",795:"81529345",821:"81529345",5160:"81529345",4912:"84672515",4916:"84673538",4911:"84674048",4910:"84675586",5717:"84676097",4919:"84676101",4921:"84676103",4909:"84804101",7418:"88081174"};e.exports=i},function(e,t,i){function n(){r.call(this),this.friendsList={},this.enemiesList={},this.ignoredList={},this.spouse=null,this.onConnectNotification=!1}var o=i(271),s=i(29).getText,a=i(252),r=i(194),l=i(191).inherits;l(n,r),e.exports=n,n.prototype.connect=function(){window.dofus.sendMessage("FriendsGetListMessage"),window.dofus.sendMessage("IgnoredGetListMessage"),window.dofus.sendMessage("SpouseGetInformationsMessage")},n.prototype.disconnect=function(){this.friendsList={},this.enemiesList={},this.ignoredList={},this.spouse=null,this.onConnectNotification=!1},n.prototype.initialize=function(e){var t=this,i={0:s("ui.common.unknownFail"),1:s("ui.social.friend.addFailureListFull"),2:s("ui.social.friend.addFailureNotFound"),3:s("ui.social.friend.addFailureEgocentric"),4:s("ui.social.friend.addFailureAlreadyInList")};o.on("PlayerStatusUpdateMessage",function(e){t.friendsList[e.accountId]&&(t.friendsList[e.accountId].status=e.status,t.emit("friendUpdate",t.friendsList[e.accountId])),t.enemiesList[e.accountId]&&(t.enemiesList[e.accountId].status=e.status,t.emit("enemyUpdate",t.enemiesList[e.accountId])),t.ignoredList[e.accountId]&&(t.ignoredList[e.accountId].status=e.status,t.emit("ignoredUpdate",t.ignoredList[e.accountId]))}),e.on("FriendUpdateMessage",function(e){var i=e.friendUpdated;t.friendsList[i.accountId]=i,t.emit("friendUpdate",i),t.emit("enemyUpdate",i),t.emit("ignoredUpdate",i)}),e.on("FriendsListMessage",function(e){for(var i={},n=0;n<e.friendsList.length;n++)i[e.friendsList[n].accountId]=e.friendsList[n];t.friendsList=i,t.emit("newFriendList")}),e.on("IgnoredListMessage",function(e){for(var i={},n=0;n<e.ignoredList.length;n++)i[e.ignoredList[n].accountId]=e.ignoredList[n];t.enemiesList=i,t.emit("newEnemyList")}),e.on("FriendAddedMessage",function(e){t.friendsList[e.friendAdded.accountId]=e.friendAdded,t.emit("friendAdded",e.friendAdded)}),e.on("IgnoredAddedMessage",function(e){var i=e.session?t.ignoredList:t.enemiesList;i[e.ignoreAdded.accountId]=e.ignoreAdded,t.emit(e.session?"ignoredAdded":"enemyAdded",e.ignoreAdded)}),o.on("FriendDeleteResultMessage",function(i){if(i.success){e.chat.logError(s("ui.social.friend.delete"));for(var n in t.friendsList)if(t.friendsList[n].accountName===i.name)return delete t.friendsList[n],t.emit("friendDeleted",n)}}),e.on("IgnoredDeleteResultMessage",function(e){if(e.success){var i=e.session?t.ignoredList:t.enemiesList;for(var n in i)if(i[n].accountName===e.name)return delete i[n],t.emit(e.session?"ignoredDeleted":"enemyDeleted",n)}}),o.on("FriendAddFailureMessage",function(t){e.chat.logError(i[t.reason])}),o.on("IgnoredAddFailureMessage",function(t){e.chat.logError(i[t.reason])}),e.on("FriendWarnOnConnectionStateMessage",function(e){t.onConnectNotification=e.enable}),e.on("SpouseInformationsMessage",function(e){var i=e.spouse;t.spouse={spouseAccountId:i.spouseAccountId,spouseId:i.spouseId,spouseName:i.spouseName,spouseLevel:i.spouseLevel,breed:i.breed,sex:i.sex,spouseEntityLook:i.spouseEntityLook,guildInfo:i.guildInfo,alignmentSide:i.alignmentSide,mapId:i.mapId,subAreaId:i.subAreaId,inFight:i.inFight,followSpouse:i.followSpouse},t.emit("spouseUpdate",t.spouse)}),e.on("SpouseStatusMessage",function(e){t.spouse&&e.hasSpouse===!1&&(t.spouse=null,t.emit("spouseLeft"))}),e.on("MoodSmileyUpdateMessage",function(e){var i=t.friendsList[e.accountId];i&&(i.moodSmileyId=e.smileyId,t.emit("friendUpdate",i),t.emit("enemyUpdate",i),t.emit("ignoredUpdate",i))})},n.prototype.isIgnored=function(e){return!!this.ignoredList[e]},n.prototype.searchOnlineFriendById=function(e){for(var t in this.friendsList){var i=this.friendsList[t];if(i.playerId===e)return i}return null},n.prototype.searchOnlineFriendByName=function(e){var t=a.simplifyString(e);for(var i in this.friendsList){var n=this.friendsList[i];if(n.playerName&&a.simplifyString(n.playerName)===t)return n}return null},n.prototype.isMutualFriend=function(e){return e.level>0}},function(e,t,i){function n(){o.call(this),this._itemList={}}var o=i(194).EventEmitter,s=i(191).inherits;s(n,o),e.exports=n,n.prototype.initialize=function(){function e(e,t){i._itemList[e]=t}var t=window.dofus.connectionManager,i=this;t.on("ExchangeShopStockMovementUpdatedMessage",function(t){t.objectInfo&&e(t.objectInfo.objectGID,t.objectInfo.quantity)}),t.on("ExchangeShopStockStartedMessage",function(t){if(t.objectsInfos)for(var i=0;i<t.objectsInfos.length;i++)e(t.objectsInfos[i].objectGID,t.objectsInfos[i].quantity)})},n.prototype.getItemSellableAmount=function(e){var t=this._itemList[e]||0,i=window.gui.playerData.inventory.quantityList[e]||0;return t+i},n.prototype.disconnect=function(){this._itemList={}}},function(e,t,i){function n(){this.alignmentInfos=null,this.playerRank=null,this.alignmentRank=null,this.alignmentTitles=null,this.alignmentRanks=null,this._imagePaths=["gfx/alignments/Alignement_tx_IllusNeutre.png","gfx/alignments/Alignement_tx_IllusBontarien.png","gfx/alignments/Alignement_tx_IllusBrakmarien.png","gfx/alignments/Alignement_tx_IllusMercenaire.png"],this._orderImagePaths=["gfx/alignments/order_0.png","gfx/alignments/order_1.png","gfx/alignments/order_2.png","gfx/alignments/order_3.png","gfx/alignments/order_4.png","gfx/alignments/order_5.png","gfx/alignments/order_6.png","gfx/alignments/order_7.png","gfx/alignments/order_8.png","gfx/alignments/order_9.png"],this._sideImagePaths={1:"gfx/alignments/wings/tx_alignment1_frame0.png",2:"gfx/alignments/wings/tx_alignment2_frame0.png"}}var o=i(194).EventEmitter,s=i(191).inherits,a=i(30),r=i(202),l=45,c=63;s(n,o),e.exports=n,n.prototype.initialize=function(e){var t=this;e.on("AlignmentRankUpdateMessage",function(e){t.playerRank=e.alignmentRank,t.emit("alignmentChanged")}),e.on("initialized",function(){var i=["AlignmentTitles","AlignmentRank"];a.getAllDataTable(i,function(e,i){return e?console.error("Unable to load data for alignment window",e):(t.alignmentTitles=i.AlignmentTitles,void(t.alignmentRanks=i.AlignmentRank))}),e.playerData.on("alignmentInfosUpdated",function(){t.alignmentInfos=this.characters.mainCharacter.characteristics.alignmentInfos,t.alignmentSide=e.databases.AlignmentSides[t.alignmentInfos.alignmentSide],t.emit("alignmentChanged")})});var i="gfx/alignments/wings.json";r.loadJson(i,function(e){e.meta&&e.symbols&&(e=e.symbols),t._wingsData=e})},n.prototype.getRank=function(e){a.getData("AlignmentRank",this.playerRank,e)},n.prototype.getOrder=function(e,t){a.getData("AlignmentOrder",e.orderId,t)},n.prototype.getAlignmentImageUrl=function(e){this.alignmentInfos?r.preloadImage(this._imagePaths[this.alignmentInfos.alignmentSide],e):r.preloadImage(this._imagePaths[0],e)},n.prototype.getTopWings=function(e,t){var i=this,n=e.alignmentSide,o=e.alignmentGrade,s=10*(n-1)+o,a="gfx/alignments/wings/demonAngel_frame"+s+".png",r=i._wingsData[l].frames[s].position,c={imagePath:a,left:r.x,top:r.y,width:r.w,height:r.h};t(c)},n.prototype.getBottomWings=function(e,t){var i=this,n=e.alignmentSide,o=e.alignmentGrade,s=10*(n-1)+o;if(i._wingsData[c].frames[s]){var a="gfx/alignments/wings/demonAngel2_frame"+s+".png",r=i._wingsData[c].frames[s].position,l={imagePath:a,left:r.x,top:r.h+r.y,width:r.w,height:r.h};return t(l)}return t(null)},n.prototype.getSmallWingsUrl=function(e,t){var i=this._sideImagePaths[e];r.preloadImage(i,t)},n.prototype.getOrderImageUrl=function(e,t){var i=this._orderImagePaths[e];r.preloadImage(i,t)},n.prototype.getAlignmentGradeString=function(){var e=this.alignmentInfos,t=e.alignmentGrade,i=e.alignmentSide,n=this.alignmentTitles;return t+" ("+n[i].namesId[t]+")"},n.prototype.getHonor=function(){var e=this.alignmentInfos,t=(e.honor-e.honorGradeFloor)/(e.honorNextGradeFloor-e.honorGradeFloor);return t},n.prototype.getNameId=function(){return this.alignmentSide.nameId}},function(e,t,i){function n(){this._adminMenuId=null,this._myRank=null,this._lang=null,this._url=null,this._isModerator=null,this._isModeratorOrMore=null}var o=i(225),s=["lookinvis"],a=["god","adminhide","unmutable","adminaway","admininvisible"],r=i(704),l=["fr","en","es"];e.exports=n,n.prototype.initialize=function(e){e=e||{},this._initTheLang(e.lang)},n.prototype.connect=function(e){e=e||{},this._initTheLang(e.lang)},n.prototype.disconnect=function(){this._adminMenuId=null,this._myRank=null,this._url=null,this._lang=null,this._isModeratorOrMore=null,this._isModerator=null},n.prototype._initTheLang=function(e){this._lang=e,this._lang||(this._lang="fr",console.error("AdminMenu#initialize: lang is missing, fallback to fr.")),l.indexOf(this._lang)===-1&&(console.warn("AdminMenu#initialize: lang",this._lang,"is not authorized, fallback to en."),this._lang="en")},n.prototype.setAccountCapabilities=function(e){e._url&&(this._url=e._url),e._myModeratorRank&&Array.isArray(e._myModeratorRank)&&(this._myRank=e._myModeratorRank,this.setAdminMenuId(this._myRank[this._myRank.length-1])),this._isModeratorOrMore=e.status>=r.MODERATOR,this._isModerator=e.status===r.MODERATOR},n.prototype.runStartupCmd=function(e){if(e=e||{},this._isModerator){var t;if(e.isOnCharacterSelection)for(t=0;t<a.length;t+=1)o.getWindow("adminConsole").runCommand(a[t]);if(e.isOnRP)for(t=0;t<s.length;t+=1)o.getWindow("adminConsole").runCommand(s[t])}},n.prototype.getAdminMenuId=function(){var e=null,t=this._adminMenuId;return this._isModeratorOrMore&&t&&this.getURL()&&(e=t),e},n.prototype.getURL=function(){return this._url?this._url+this._lang+"/":null},n.prototype.setAdminMenuId=function(e){return!!this._canUse(e)&&(this._adminMenuId=e,o.getWindow("adminConsole").logMessage('adminMenu "'+e+'" loaded.',"Debug"),!0)},n.prototype._canUse=function(e){return!(null===this._myRank||!this.getURL())&&this._myRank.indexOf(e)!==-1},n.prototype.helpToString=function(){var e=[];if(!Array.isArray(this._myRank))return e.join("\n");for(var t=0;t<this._myRank.length;t+=1){var i=this._myRank[t];this._canUse(i)&&e.push(i)}return e.join("\n")}},function(e,t,i){function n(){o.call(this),this.current={},this.current.ladder={},this._reset()}var o=i(194),s=i(191).inherits,a=i(30),r=i(225),l=i(29).getText,c=i(184),u=i(207),d=i(412),h=75,p=100,m=150,f=200,g=300,_=[];s(n,o),e.exports=n,n.prototype.GENERAL_TAB_NAME="general",n.prototype.COMPOSITION_TAB_NAME="composition",n.prototype.LADDER_TAB_NAME="ladder",n.prototype._reset=function(){this.current={},this.current.ladder={},this._requestedSocialInfoMap={},this._awaitedSocialInfoMap={}},n.prototype.initialize=function(e){this._setupListeners(e),this._setupTheRetryPopup(e)},n.prototype.disconnect=function(){this._reset()},n.prototype.isQuestAccomplished=function(){return!!window.gui.playerData.quests.finished[c.TOA_QUEST_ID]},n.prototype.canTabBeDisable=function(e){var t=this.current.steps;return e!==this.GENERAL_TAB_NAME&&e!==this.LADDER_TAB_NAME&&(e!==this.COMPOSITION_TAB_NAME||!t)},n.prototype.gatheringCompositionData=function(e,t,i){a.getDataMap("Monsters",e,function(e,n){return e?i(e):void a.getDataMap("Challenge",t,function(e,t){return e?i(e):i(null,n,t)})})},n.prototype.calculateMaxStageScore=function(e,t){var i=h;e>0&&e<=50?i+=p:e>50&&e<=100&&(i+=m),50===e?i+=f:100===e&&(i+=g);for(var n in t)i+=t[n].points;return i},n.prototype.getMonsterIds=function(e,t){var i=this.current.steps,n=[];if(!e||!t)return n;for(var o=0;o<i.length;o++)if(i[o].stepNumber===t)for(var s=0;s<i[o].stages.length;s++)if(i[o].stages[s].stageLevel===e){for(var a=0;a<i[o].stages[s].monsters.length;a++)n.push(i[o].stages[s].monsters[a].creatureGenericId);return n}},n.prototype.getChallengeIds=function(e,t){if(!e||!t)return[];for(var i=this.current.steps,n=0;n<i.length;n++)if(i[n].stepNumber===t)for(var o=0;o<i[n].stages.length;o++)if(i[n].stages[o].stageLevel===e)return i[n].stages[o].challengeId},n.prototype.getSelectedStageScore=function(e){var t=this.current.scoreStageList,i=0;if(!e||!t)return i;for(var n=0;n<t.length;n++)if(t[n].stageLevel===e&&t[n].scorer.length>0){for(var o=!1,s=0;s<t[n].scorer.length;s++)o||(i=t[n].scorer[s].score,o=t[n].scorer[s].validated);return i}return i},n.prototype.isSelectedStageDone=function(e){var t=this.current.scoreStageList,i=!1;if(!e||!t)return i;for(var n=0;n<t.length;n++)if(t[n].stageLevel===e&&t[n].scorer.length>0)return i=!0;return i},n.prototype.getStepsScoreRatio=function(){var e=this.current.steps,t=[];if(!e)return t;for(var i=0;i<e.length;i++){for(var n=0,o=0,s=0;s<e[i].stages.length;s++){n+=this.getSelectedStageScore(e[i].stages[s].stageLevel);for(var a={},r=0;r<e[i].stages[s]._challengePts.length;r++){var l=e[i].stages[s].challengeId[r];a[l]={points:e[i].stages[s]._challengePts[r]}}o+=this.calculateMaxStageScore(e[i].stages[s].stageLevel,a)}t.push(Math.trunc(n/o*100))}return t},n.prototype.getSelectedStageSucceedChallengeIds=function(e){var t=this.current.scoreStageList,i=[],n=!1;if(!e||!t)return i;for(var o=0;o<t.length;o++)if(t[o].stageLevel===e&&t[o].scorer.length>0){var s=!1;n=!0;for(var a=0;a<t[o].scorer.length;a++)s||(i=t[o].scorer[a].challengeId,s=t[o].scorer[a].validated);return i}return!!n&&i},n.prototype.getMonstersData=function(e,t){var i=this.current.steps,n=[];if(!e||!t)return n;for(var o=0;o<i.length;o++)if(i[o].stepNumber===t)for(var s=0;s<i[o].stages.length;s++)if(i[o].stages[s].stageLevel===e)return n=i[o].stages[s].monsters},n.prototype._setupListeners=function(){var e=this,t=window.dofus.connectionManager;t.on("toaLadderSuccess",function(t){for(var i={},n=0;n<t.ladderResult.length;n+=1)i[n]={rank:t.ladderResult[n].rank,name:t.ladderResult[n].character.name,breed:window.gui.databases.Breeds[t.ladderResult[n].character.breed].shortNameId,level:t.ladderResult[n].character.level,server:t.ladderResult[n].character.server,score:t.ladderResult[n].score};e.current.ladder.nbPlayer=t.nbPlayer,e.current.ladder.data=i,e.emit("toaLadderDataSuccess")}),t.on("toaLadderError",function(){e.emit("toaLadderDataFailure")}),t.on("toaLadderRankCountSuccess",function(t){e._setRank(t.rankCountResult,t.lastRankTop100),e._getCurrentPlayersData()}),t.on("toaLadderRankCountError",function(){e.emit("toaPlayerRankDataFailure")}),t.on("ToARewardsGivenMessage",function(t){e._displayToaRewards(t.rankId)}),t.on("toaPlayerRankSuccess",function(t){var i={},n=0;t.ladderResult.score&&(n=t.ladderResult.score),i[0]={rank:t.ladderResult.rank||0===t.ladderResult.rank?t.ladderResult.rank:-1,score:n,name:t.ladderResult.character?t.ladderResult.character.name:"-"},e.current.ladder.player=i,e._setPlayersData()}),t.on("TowerOfAscensionCompositionMessage",function(t){e.current.steps=t.steps}),t.on("TowerOfAscensionResultsMessage",function(t){e.current.scoreStageList?t.steps.forEach(function(t){for(var i=!1,n=0;n<e.current.scoreStageList.length;n++)if(e.current.scoreStageList[n].stageLevel===t.stageLevel){e.current.scoreStageList[n]=t,i=!0;break}i||e.current.scoreStageList.push(t)}):(e.current.scoreStageList=t.steps,e.current.scoreStageList.sort(function(e,t){return e.stageLevel>t.stageLevel?1:-1}));var i=0;e.current.scoreStageList.forEach(function(e){e.scorer.forEach(function(e){i+=e.validated?e.score:0})}),e.current.score=i})},n.prototype._setPlayersData=function(){var e=this.current.ladder.player,t=this.current.scoreStageList;if((e[0].rank||0===e[0].rank)&&0!==_.length){var i;if(t&&t.length>0)for(var n=0;n<_.length;n++)if(e[0].rank+1<=_[n].rank&&e[0].score>=this.ranks[_[n].rankId].score){i=_[n].rankId;break}var o={};o[0]={rank:e[0].rank,score:e[0].score,name:e[0].name,rankId:i},this.current.ladder.player=o,this.emit("toaPlayerRankDataSuccess")}},n.prototype.getCurrentStage=function(){var e=this,t={step:1,stage:1},i=e.current.scoreStageList,n=e.current.steps;if(!i||0===i.length)return t;for(var o=i.length-1;o>=0;o--)if(i[o].scorer.length>0){t.stage=i[o].stageLevel,t.stage=100===t.stage?t.stage:t.stage++;break}for(var s=0;s<n.length;s++)for(var a=0;a<n[s].stages.length;a++)if(n[s].stages[a].stageLevel===t.stage)return t.step=n[s].stepNumber,t},n.prototype._displayToaRewards=function(e){if(e){this.initRanksData();var t=this.ranks[e];if(t&&t.rewards&&0!==!t.rewards.length){for(var i,n=t.rewards,o="",s=0;s<n.length;s++)i=s+1===n.length?".":", ",o=o+n[s].quantity+" x $item"+n[s].itemId+i;var a=l("ui.toa.infoRewards",o);window.gui.chat.logMsg(a,d.PSEUDO_CHANNEL_INFO)}}},n.prototype._setupTheRetryPopup=function(){var e=this,t=window.dofus.connectionManager;t.on("ContinueTOAWithCreditErrorMessage",function(e){window.gui.openPopup({title:l("ui.common.error"),message:l("ui.common.error")+" (reason: CreditError"+e.reason+")"}),console.error("ContinueTOAWithCreditErrorMessage reason",e.reason)}),t.on("PlayerCanContinueStageWithCreditNotificationMessage",function(t){e.openTheRetryPopup(t.stepNumber)})},n.prototype.openTheRetryPopup=function(e){r.open("toaRetryPopup",{stepNumber:e})},n.prototype.initRanksData=function(){if(!this.hasOwnProperty("ranks")){for(var e={},t=[l("ui.toa.rewardsBoardTop1"),l("ui.toa.rewardsBoardTop2"),l("ui.toa.rewardsBoardTop3"),l("ui.toa.rewardsBoardTop15"),l("ui.toa.rewardsBoardTop16"),l("ui.toa.rewardsBoardTop4"),l("ui.toa.rewardsBoardTop5"),l("ui.toa.rewardsBoardTop6"),l("ui.toa.rewardsBoardTop7"),l("ui.toa.rewardsBoardTop8"),l("ui.toa.rewardsBoardTop9"),l("ui.toa.rewardsBoardTop10"),l("ui.toa.rewardsBoardTop11"),l("ui.toa.rewardsBoardTop12"),l("ui.toa.rewardsBoardTop13"),l("ui.toa.rewardsBoardTop14")],i=[80,79,79,78,77,76,75,75],n=window.gui.databases.ToaRank,o=0;o<t.length;o+=1)e[n[o+1].id]={id:n[o+1].id,rankName:n[o+1].nameId,score:n[o+1].minScore,rewards:n[o+1].rewards,goultines:n[o+1].goultines,ornament:i[o]||-1,details:t[o]};this.ranks=e}},n.prototype.requestMaxRankLadderData=function(){u.send("toaLadderRankCount")},n.prototype.requestLadderData=function(e,t){u.send("toaLadder",{page:e,server:t,order:"desc"})},n.prototype._getCurrentPlayersData=function(){u.send("toaPlayerRank",{name:window.gui.playerData.identification.nickname})},n.prototype.getRank=function(e){var t=window.gui.databases.ToaRank,i=[];if(e&&!(e<=0)){for(var n=0;n<t.length;n++)if(e===t[n].id){i=t[n];break}return i}},n.prototype._setRank=function(e,t){this.initRanksData();var i=[1,2,3,10,30,100,.1*(e-t)+t,.2*(e-t)+t,.3*(e-t)+t,.4*(e-t)+t,.5*(e-t)+t,.6*(e-t)+t,.7*(e-t)+t,.8*(e-t)+t,.9*(e-t)+t,e],n=[];for(var o in this.ranks)this.ranks.hasOwnProperty(o)&&n.push(o);for(var s=[],a=0;a<i.length;a++)s.push({rank:i[a],rankId:n[a]});_=s},n.prototype.getMonsterLevelScaled=function(e){if(!Number.isInteger(e)||e<0)return 0;var t=Math.floor(c.BASE_MONSTER_LEVEL+e*((c.MAX_MONSTER_LEVEL-c.BASE_MONSTER_LEVEL)/c.NB_SCALE_LEVEL));return t}},function(e,t,i){function n(){o.call(this)}var o=i(194).EventEmitter,s=i(191).inherits,a=i(225),r=i(195),l=i(28),c=i(805);s(n,o),e.exports=n;var u=2592e6;n.prototype._displayMarketingPopup=function(e){a.open("marketingWindow",e)},n.prototype.getPromoDisplayUserPrefKey=function(){return"promoDisplayed"},n.prototype.initialize=function(e){var t=this;this.alreadyOpenedPopup=!1,e.on("connected",function(){c.reset(),window.gui.playerData.isShopDisabled()||c.getStoreInfos(function(e){if(e)return console.error(e)})}),e.on("disconnect",function(){t.alreadyOpenedPopup=!1});var i=window.dofus.connectionManager;i.on("setShopDetailsSuccess",function(){window.dofus.send("shopOpenRequest")}),i.on("shopOpenSuccess",function(e){if(!t.alreadyOpenedPopup){var i=e.home.hightlight_popup,n=r.getValue(t.getPromoDisplayUserPrefKey(),{}),o=t._getMarketingItemToDisplay(i,n);o&&(t.alreadyOpenedPopup=!0,t._displayMarketingPopup(o.external_article))}})},n.prototype._getMarketingItemToDisplay=function(e,t){for(var i=null,n=0;n<e.length;n++){var o=e[n];if("POPUP"===o.mode&&o.external_article){var s=t[o.external_article.id];if(s){var a=l.now();a-s>=u&&(i=o)}else if(i)if(i.enddate){if(o.enddate){var r=new Date(i.enddate),c=new Date(o.enddate);c<r&&(i=o)}}else i=o;else i=o}}return i}},function(e,t,i){function n(e){j=e}function o(){W=!1,U={},Y=[],G=null}function s(e){return W?Y.push(e):void(G?X.setImmediate(function(){e(null,G)}):(Y.push(e),r()))}function a(e,t){for(var i=0;i<Y.length;i++)Y[i](e,t);Y=[]}function r(){return W=!0,j?void ne.send("shopIAPListRequest"):d({})}function l(){m(new Error("Request IAP keys failed"))}function c(e){var t=e.iapList;if(!t.length)return d({});for(var i=[],n=0;n<t.length;n++)i.push(t[n].key);u(i)}function u(e){return j?e.length?void j.getProductDetails(e,function(e){var t=e.products;for(var i in t){var n=t[i],o=ie.parsePriceMicros(n.priceMicros);isNaN(o)||(n._parsedPrice=o,U[i]=n)}var s={platform:K.osName,currency:e.currency,country:e.country};d(s)},function(t){return m(new Error("wizPurchase.getProductDetails failed with keys: "+e+" and error: "+t))}):d({}):m(new Error("Purchases are not available on this platform"))}function d(e){e=e||{},ne.send("setShopDetailsRequest",e)}function h(){m(new Error("Request to set shop details failed"))}function p(e){m(null,e.shopDetails)}function m(e,t){return W=!1,e?a(e):(G=t,void a(null,t))}function f(e){e.key||G&&G.goultineOnlyArticles[e.id]||e.hardOnlyTuto||(e._softPrice=$.computeSoftPrice(e._hardPrice),e._hardOriginalPrice&&(e._softOriginalPrice=$.computeSoftPrice(e._hardOriginalPrice)))}function g(e){for(var t=null,i=e.pricelist||[],n=0;n<i.length;n+=1){var o=i[n];if(o.currency===Q.GOULTINE){t=o;break}}return t||e.currency!==Q.GOULTINE||(t={price:e.price,original_price:e.original_price}),t}function _(e){var t=[];if(!e)return t;for(var i=0;i<e.length;i++){var n=e[i],o=g(n);if(o&&(n._hardPrice=o.price,n._hardOriginalPrice=o.original_price),n.key){var s=U[n.key];if(!s&&!o)continue;s&&(n.product=s,n._inAppPrice=s.price)}else if(n.currency!==Q.GOULTINE)continue;if(f(n),n._hardPrice&&n._hardOriginalPrice){var a=Math.floor(100-100*n._hardPrice/n._hardOriginalPrice);n._promoRate=a?"- "+a+"%":""}for(var r=[],l=!1,c=n.references,u=0;u<c.length;u++){var d=c[u].reference_virtualgift;if(d)for(var h=0;h<d.length;h++)r.push(d[h].id);var p=c[u].reference_kard;if(p)for(var m=0;m<p.length;m++)if("MULTIPLE"===p[m].type){l=!0;break}}n.isMysteryBox=l,n.itemsId=r,t.push(n)}return t}function v(e){var t=J("tablet.price.hard",Z.kamasToString(e._hardPrice,""));window.gui.openConfirmPopup({title:J("ui.popup.warning"),message:J("tablet.shop.notEnoughKamas",e.name,t),cb:function(t){t&&w(e,Q.GOULTINE)}})}function y(e){var t=ee.getWindow("buyHardCurrencyConfirm");t.confirmBuy(e)}function b(e){return e?void H(function(t,i){return t?(console.error(t),window.gui.openSimplePopup(J("tablet.shop.couldNotBuy"))):i.length?ee.getWindow("purchasesPending").validatePendingPurchases(i):void ee.getWindow("shopConfirm").confirmBuy({article:e,isInApp:!0},function(t){if(t){if(!G)return console.error(new Error("Purchase could not be done, store infos are no longer available")),P(),window.gui.openSimplePopup(J("tablet.shop.couldNotBuy"));var i={currency:G.currency,iapKey:e.key,purchase:JSON.stringify([{quantity:1,id:e.id,amount:e.product._parsedPrice}])};console.error("[Haapi info] ShopWindow sending shopBuyIAPRequest with data: "+JSON.stringify(i)),window.dofus.send("shopBuyIAPRequest",i)}})}):console.error(new Error("Trying to buy a non-existent article"))}function w(e,t){if(!e)return console.error(new Error("Trying to buy a non-existent article"));var i=window.gui.playerData.inventory,n=i.goultines,o=i.kamas,s=t===Q.KAMA;if(s&&e._softPrice>o)return v(e);if(!s&&e._hardPrice>n){var a=e._hardPrice-n;return y(a)}ee.getWindow("shopConfirm").confirmBuy({article:e,isSoft:s},function(i){i&&(te.wKpi.shopBuyPrepare({article:e,currency:t}),window.dofus.send("shopBuyRequest",{currency:t,amountHard:e._hardPrice,amountSoft:e._softPrice,purchase:[{quantity:1,id:e.id}],isMysteryBox:e.isMysteryBox}))})}function M(e){var t;return t="android"===e.platform?JSON.stringify({json:e.json,developerPayload:e.developerPayload,signature:e.signature}):e.receipt}function T(e,t,i){return i=i||function(e){e&&console.error(e)},j?(ne.send("moneyGoultinesAmountRequest"),void j.finishPurchase(e,!0,function(){return i(null,e)},function(n){return i(new Error("Finish purchase failed for key "+e+" and order id "+t+" with error: "+n),e)})):i(new Error("Purchase should not have been possible on this platform, for key: "+e+" and order id: "+t),e)}function C(e){"RECEIPT_ALREADY_VALIDATED"===e.reason?T(e.iapKey,e.orderId,function(){P()}):(P(),window.gui.openSimplePopup(J("tablet.shop.validateIAPFail")))}function I(e){window.gui.openSimplePopup(J("tablet.shop.validateIAPSuccess"),J("ui.common.informations")),T(e.iapKey,e.buyResult.order_id,function(){P()})}function A(){P(),window.gui.openSimplePopup(J("tablet.shop.buyFail"))}function S(e){P(),window.gui.openSimplePopup(J("tablet.shop.buySuccess"),J("ui.common.informations")),e.currency===Q.GOULTINE&&window.dofus.send("moneyGoultinesAmountRequest"),te.wKpi.shopBuySuccess()}function E(){window.gui.openSimplePopup(J("tablet.shop.mysteryBoxFail"))}function x(e){window.gui.openSimplePopup(J("tablet.shop.mysteryBoxSuccess"),J("ui.common.informations")),te.wKpi.mysteryBoxSuccess(e)}function L(){window.gui.openSimplePopup(J("tablet.shop.restoreMysteryBoxFail"))}function N(e){window.gui.openSimplePopup(J("tablet.shop.restoreMysteryBoxSuccess"),J("ui.common.informations")),te.wKpi.restoreMysteryBoxSuccess(e)}function O(e,t){var i=M(t),n=t.productId;"android"===t.platform?console.error("[Haapi info] ShopWindow sending shopMobileValidateOrderRequest with data: "+JSON.stringify({orderId:e,receipt:i,iapKey:n})):console.error("[Haapi info] ShopWindow sending shopMobileValidateOrderRequest with data: "+JSON.stringify({orderId:e,iapKey:n})),window.dofus.send("shopMobileValidateOrderRequest",{orderId:e,receipt:i,iapKey:n})}function D(e){P(),e.reason&&"GOULTINES_RESTRICTION"===e.reason?window.gui.openSimplePopup(J("tablet.shop.goultinesRestriction")):window.gui.openSimplePopup(J("tablet.shop.buyFail"))}function R(e){if(!j)return console.error(new Error("Purchase should not have been possible on this platform, for key: "+e.iapKey+" and order id: "+e.buyResult.order_id));var t=e.iapKey,i=e.buyResult.order_id;j.makePurchase(t,function(e){var n=U[t];G?n?V.trackIAPBought(t,n._parsedPrice,G.currency,i):console.error(new Error("Could not send event to Adjust, no product found for key: "+t)):console.error(new Error("Could not send event to Adjust, store infos are no longer available")),O(i,e)},function(e){return e===window.WizPurchaseError.ALREADY_OWNED?z():(P(),void window.gui.openSimplePopup(J("tablet.shop.validateIAPFail")))})}function P(){ee.close("shopConfirm")}function B(e){"RECEIPT_ALREADY_VALIDATED"===e.reason?T(e.iapKey,null,function(e,t){ee.getWindow("purchasesPending").validateNextPendingPurchases(e,t)}):ee.getWindow("purchasesPending").validateNextPendingPurchases(new Error("Validate pending order failed for productId: "+e.iapKey+" with reason: "+e.reason),e.iapKey)}function k(e){T(e.iapKey,e.buyResult.order_id,function(e,t){ee.getWindow("purchasesPending").validateNextPendingPurchases(e,t)})}function F(e){var t=M(e),i=e.productId;"android"===e.platform?console.error("[Haapi info] ShopWindow sending shopMobileValidatePendingOrderRequest with data: "+JSON.stringify({receipt:t,iapKey:i})):console.error("[Haapi info] ShopWindow sending shopMobileValidatePendingOrderRequest with data: "+JSON.stringify({iapKey:i})),window.dofus.send("shopMobileValidatePendingOrderRequest",{receipt:t,iapKey:i})}function z(){return j?void j.restoreAllPurchases(function(e){e=e||[],P(),ee.getWindow("purchasesPending").validatePendingPurchases(e)},function(e){console.error(new Error("Restore all purchases failed with error: "+e)),P(),window.gui.openSimplePopup(J("tablet.shop.restoreFailed"))}):console.error(new Error("Restoring purchases should not have been possible on this platform"))}function H(e){return j?void j.getPendingPurchases(function(t){return t=t||[],e(null,t)},function(t){return e(new Error("Get pending purchases failed with error: "+t))}):e(new Error("Check pending purchases should not have been possible on this platform"))}function q(){H(function(e,t){return e?console.error(new Error("Check pending purchases failed with error: "+e)):void(t.length&&ee.getWindow("purchasesPending").validatePendingPurchases(t))})}var W,U,Y,G,j,V=i(199),X=i(31),Q=i(44),K=i(185),J=i(29).getText,Z=i(252),$=i(806),ee=i(225),te=i(7),ie=i(807),ne=i(207),oe=i(271);oe.on("setShopDetailsSuccess",p),oe.on("setShopDetailsError",h),oe.on("shopIAPListSuccess",c),oe.on("shopIAPListError",l),oe.on("shopMobileValidateOrderError",C),oe.on("shopMobileValidateOrderSuccess",I),oe.on("shopBuyError",A),oe.on("shopBuySuccess",S),oe.on("mysteryBoxError",E),oe.on("mysteryBoxSuccess",x),oe.on("restoreMysteryBoxError",L),oe.on("restoreMysteryBoxSuccess",N),oe.on("shopBuyIAPError",D),oe.on("shopBuyIAPSuccess",R),oe.on("shopMobileValidatePendingOrderError",B),oe.on("shopMobileValidatePendingOrderSuccess",k),t.initialize=n,t.reset=o,t.getStoreInfos=s,t.enrichWithSoftPrice=f,t.validateArticles=_,t.purchaseArticleOnStore=b,t.purchaseArticleOnAnkama=w,t.openNotEnoughHardCurrencyPopup=y,t.validatePendingIAP=F,t.checkPendingPurchases=q},function(e,t,i){function n(){window.dofus.connectionManager.send("bakSoftToHardCurrentRateRequest"),window.dofus.connectionManager.send("bakHardToSoftCurrentRateRequest")}function o(){var e=window.dofus.connectionManager,i=window.gui;i.on("connected",function(){window.gui.playerData.isShopDisabled()||(n(),a.setInterval(n,c))}),e.on("bakSoftToHardCurrentRateSuccess",function(e){null!==r&&r===e.rate||(r=e.rate,t.emit("computedSoftPricesChange"))}),e.on("bakHardToSoftCurrentRateSuccess",function(e){null!==l&&l===e.rate||(l=e.rate,t.emit("computedHardPricesChange"))}),e.on("bakSoftToHardCurrentRateError",function(){r=null,t.emit("canNotComputeSoftPrices")}),e.on("bakHardToSoftCurrentRateError",function(){l=null,t.emit("canNotComputeHardPrices")})}var s=i(209).EventEmitter,a=i(203),r=null,l=null,t=e.exports=new s,c=29e4;t.initialize=function(){o()},t.isRateAvailable=function(){return null!==r&&null!==l},t.computeHardPrice=function(e){return l||0===l?Math.ceil(e/l):null},t.computeSoftPrice=function(e){return r||0===r?Math.ceil(e*r):null}},function(e,t,i){var n=i(808),o=i(207).logger;n.config({ROUNDING_MODE:n.ROUND_HALF_EVEN}),n.DEBUG=!0,t.parsePriceMicros=function(e){var t;try{var i=new n(e);t=i.times("0.000001").toNumber()}catch(s){return o.error(new Error("Could not parse price "+e)),NaN}return t===1/0||t===-(1/0)?(o.error(new Error("Parsed price is Infinity: "+e)),NaN):t}},function(e,t,i){var n;!function(o){"use strict";function s(e){function t(e,i){var n,o,s,a,r,l,u,d,h=this;if(!(h instanceof t))return new t(e,i);if(null==i){if(e instanceof t)return h.s=e.s,h.e=e.e,void(h.c=(e=e.c)?e.slice():e);if(l="number"==typeof e,l&&0*e==0){if(h.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,r=e;r>=10;r/=10,a++);return h.e=a,void(h.c=[e])}d=String(e)}else{if(d=String(e),!m.test(d))return E(h,d,l);h.s=45==d.charCodeAt(0)?(d=d.slice(1),-1):1}(a=d.indexOf("."))>-1&&(d=d.replace(".","")),(r=d.search(/e/i))>0?(a<0&&(a=r),a+=+d.slice(r+1),d=d.substring(0,r)):a<0&&(a=d.length)}else{if(c(i,2,q.length,"Base"),d=String(e),10==i)return h=new t(e instanceof t?e:d),p(h,N+h.e+1,O);if(l="number"==typeof e){if(0*e!=0)return E(h,d,l,i);
if(h.s=1/e<0?(d=d.slice(1),-1):1,t.DEBUG&&d.replace(/^0\.0*|\./,"").length>15)throw Error(v+e);l=!1}else h.s=45===d.charCodeAt(0)?(d=d.slice(1),-1):1;for(n=q.slice(0,i),a=r=0,u=d.length;r<u;r++)if(n.indexOf(o=d.charAt(r))<0){if("."==o){if(r>a){a=u;continue}}else if(!s&&(d==d.toUpperCase()&&(d=d.toLowerCase())||d==d.toLowerCase()&&(d=d.toUpperCase()))){s=!0,r=-1,a=0;continue}return E(h,String(e),l,i)}d=S(d,i,10,h.s),(a=d.indexOf("."))>-1?d=d.replace(".",""):a=d.length}for(r=0;48===d.charCodeAt(r);r++);for(u=d.length;48===d.charCodeAt(--u););if(d=d.slice(r,++u)){if(u-=r,l&&t.DEBUG&&u>15&&(e>w||e!==g(e)))throw Error(v+h.s*e);if(a=a-r-1,a>B)h.c=h.e=null;else if(a<P)h.c=[h.e=0];else{if(h.e=a,h.c=[],r=(a+1)%b,a<0&&(r+=b),r<u){for(r&&h.c.push(+d.slice(0,r)),u-=b;r<u;)h.c.push(+d.slice(r,r+=b));d=d.slice(r),r=b-d.length}else r-=u;for(;r--;d+="0");h.c.push(+d)}}else h.c=[h.e=0]}function i(e,i,n,o){var s,a,l,u,m;if(null==n?n=O:c(n,0,8),!e.c)return e.toString();if(s=e.c[0],l=e.e,null==i)m=r(e.c),m=1==o||2==o&&l<=D?d(m,l):h(m,l,"0");else if(e=p(new t(e),i,n),a=e.e,m=r(e.c),u=m.length,1==o||2==o&&(i<=a||a<=D)){for(;u<i;m+="0",u++);m=d(m,a)}else if(i-=l,m=h(m,a,"0"),a+1>u){if(--i>0)for(m+=".";i--;m+="0");}else if(i+=a-u,i>0)for(a+1==u&&(m+=".");i--;m+="0");return e.s<0&&s?"-"+m:m}function n(e,i){for(var n,o=1,s=new t(e[0]);o<e.length;o++){if(n=new t(e[o]),!n.s){s=n;break}i.call(s,n)&&(s=n)}return s}function o(e,t,i){for(var n=1,o=t.length;!t[--o];t.pop());for(o=t[0];o>=10;o/=10,n++);return(i=n+i*b-1)>B?e.c=e.e=null:i<P?e.c=[e.e=0]:(e.e=i,e.c=t),e}function p(e,t,i,n){var o,s,a,r,l,c,u,d=e.c,h=M;if(d){e:{for(o=1,r=d[0];r>=10;r/=10,o++);if(s=t-o,s<0)s+=b,a=t,l=d[c=0],u=l/h[o-a-1]%10|0;else if(c=f((s+1)/b),c>=d.length){if(!n)break e;for(;d.length<=c;d.push(0));l=u=0,o=1,s%=b,a=s-b+1}else{for(l=r=d[c],o=1;r>=10;r/=10,o++);s%=b,a=s-b+o,u=a<0?0:l/h[o-a-1]%10|0}if(n=n||t<0||null!=d[c+1]||(a<0?l:l%h[o-a-1]),n=i<4?(u||n)&&(0==i||i==(e.s<0?3:2)):u>5||5==u&&(4==i||n||6==i&&(s>0?a>0?l/h[o-a]:0:d[c-1])%10&1||i==(e.s<0?8:7)),t<1||!d[0])return d.length=0,n?(t-=e.e+1,d[0]=h[(b-t%b)%b],e.e=-t||0):d[0]=e.e=0,e;if(0==s?(d.length=c,r=1,c--):(d.length=c+1,r=h[b-s],d[c]=a>0?g(l/h[o-a]%h[a])*r:0),n)for(;;){if(0==c){for(s=1,a=d[0];a>=10;a/=10,s++);for(a=d[0]+=r,r=1;a>=10;a/=10,r++);s!=r&&(e.e++,d[0]==y&&(d[0]=1));break}if(d[c]+=r,d[c]!=y)break;d[c--]=0,r=1}for(s=d.length;0===d[--s];d.pop());}e.e>B?e.c=e.e=null:e.e<P&&(e.c=[e.e=0])}return e}function I(e){var t,i=e.e;return null===i?e.toString():(t=r(e.c),t=i<=D||i>=R?d(t,i):h(t,i,"0"),e.s<0?"-"+t:t)}var A,S,E,x=t.prototype={constructor:t,toString:null,valueOf:null},L=new t(1),N=20,O=4,D=-7,R=21,P=-1e7,B=1e7,k=!1,F=1,z=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},q="0123456789abcdefghijklmnopqrstuvwxyz";return t.clone=s,t.ROUND_UP=0,t.ROUND_DOWN=1,t.ROUND_CEIL=2,t.ROUND_FLOOR=3,t.ROUND_HALF_UP=4,t.ROUND_HALF_DOWN=5,t.ROUND_HALF_EVEN=6,t.ROUND_HALF_CEIL=7,t.ROUND_HALF_FLOOR=8,t.EUCLID=9,t.config=t.set=function(e){var t,i;if(null!=e){if("object"!=typeof e)throw Error(_+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(i=e[t],c(i,0,C,t),N=i),e.hasOwnProperty(t="ROUNDING_MODE")&&(i=e[t],c(i,0,8,t),O=i),e.hasOwnProperty(t="EXPONENTIAL_AT")&&(i=e[t],i&&i.pop?(c(i[0],-C,0,t),c(i[1],0,C,t),D=i[0],R=i[1]):(c(i,-C,C,t),D=-(R=i<0?-i:i))),e.hasOwnProperty(t="RANGE"))if(i=e[t],i&&i.pop)c(i[0],-C,-1,t),c(i[1],1,C,t),P=i[0],B=i[1];else{if(c(i,-C,C,t),!i)throw Error(_+t+" cannot be zero: "+i);P=-(B=i<0?-i:i)}if(e.hasOwnProperty(t="CRYPTO")){if(i=e[t],i!==!!i)throw Error(_+t+" not true or false: "+i);if(i){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw k=!i,Error(_+"crypto unavailable");k=i}else k=i}if(e.hasOwnProperty(t="MODULO_MODE")&&(i=e[t],c(i,0,9,t),F=i),e.hasOwnProperty(t="POW_PRECISION")&&(i=e[t],c(i,0,C,t),z=i),e.hasOwnProperty(t="FORMAT")){if(i=e[t],"object"!=typeof i)throw Error(_+t+" not an object: "+i);H=i}if(e.hasOwnProperty(t="ALPHABET")){if(i=e[t],"string"!=typeof i||/^.$|[+-.\s]|(.).*\1/.test(i))throw Error(_+t+" invalid: "+i);q=i}}return{DECIMAL_PLACES:N,ROUNDING_MODE:O,EXPONENTIAL_AT:[D,R],RANGE:[P,B],CRYPTO:k,MODULO_MODE:F,POW_PRECISION:z,FORMAT:H,ALPHABET:q}},t.isBigNumber=function(e){return e instanceof t||e&&e._isBigNumber===!0||!1},t.maximum=t.max=function(){return n(arguments,x.lt)},t.minimum=t.min=function(){return n(arguments,x.gt)},t.random=function(){var e=9007199254740992,i=Math.random()*e&2097151?function(){return g(Math.random()*e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var n,o,s,a,r,l=0,u=[],d=new t(L);if(null==e?e=N:c(e,0,C),a=f(e/b),k)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(a*=2));l<a;)r=131072*n[l]+(n[l+1]>>>11),r>=9e15?(o=crypto.getRandomValues(new Uint32Array(2)),n[l]=o[0],n[l+1]=o[1]):(u.push(r%1e14),l+=2);l=a/2}else{if(!crypto.randomBytes)throw k=!1,Error(_+"crypto unavailable");for(n=crypto.randomBytes(a*=7);l<a;)r=281474976710656*(31&n[l])+1099511627776*n[l+1]+4294967296*n[l+2]+16777216*n[l+3]+(n[l+4]<<16)+(n[l+5]<<8)+n[l+6],r>=9e15?crypto.randomBytes(7).copy(n,l):(u.push(r%1e14),l+=7);l=a/7}if(!k)for(;l<a;)r=i(),r<9e15&&(u[l++]=r%1e14);for(a=u[--l],e%=b,a&&e&&(r=M[b-e],u[l]=g(a/r)*r);0===u[l];u.pop(),l--);if(l<0)u=[s=0];else{for(s=-1;0===u[0];u.splice(0,1),s-=b);for(l=1,r=u[0];r>=10;r/=10,l++);l<b&&(s-=b-l)}return d.e=s,d.c=u,d}}(),t.sum=function(){for(var e=1,i=arguments,n=new t(i[0]);e<i.length;)n=n.plus(i[e++]);return n},S=function(){function e(e,t,i,n){for(var o,s,a=[0],r=0,l=e.length;r<l;){for(s=a.length;s--;a[s]*=t);for(a[0]+=n.indexOf(e.charAt(r++)),o=0;o<a.length;o++)a[o]>i-1&&(null==a[o+1]&&(a[o+1]=0),a[o+1]+=a[o]/i|0,a[o]%=i)}return a.reverse()}var i="0123456789";return function(n,o,s,a,l){var c,u,d,p,m,f,g,_,v=n.indexOf("."),y=N,b=O;for(v>=0&&(p=z,z=0,n=n.replace(".",""),_=new t(o),f=_.pow(n.length-v),z=p,_.c=e(h(r(f.c),f.e,"0"),10,s,i),_.e=_.c.length),g=e(n,o,s,l?(c=q,i):(c=i,q)),d=p=g.length;0==g[--p];g.pop());if(!g[0])return c.charAt(0);if(v<0?--d:(f.c=g,f.e=d,f.s=a,f=A(f,_,y,b,s),g=f.c,m=f.r,d=f.e),u=d+y+1,v=g[u],p=s/2,m=m||u<0||null!=g[u+1],m=b<4?(null!=v||m)&&(0==b||b==(f.s<0?3:2)):v>p||v==p&&(4==b||m||6==b&&1&g[u-1]||b==(f.s<0?8:7)),u<1||!g[0])n=m?h(c.charAt(1),-y,c.charAt(0)):c.charAt(0);else{if(g.length=u,m)for(--s;++g[--u]>s;)g[u]=0,u||(++d,g=[1].concat(g));for(p=g.length;!g[--p];);for(v=0,n="";v<=p;n+=c.charAt(g[v++]));n=h(n,d,c.charAt(0))}return n}}(),A=function(){function e(e,t,i){var n,o,s,a,r=0,l=e.length,c=t%T,u=t/T|0;for(e=e.slice();l--;)s=e[l]%T,a=e[l]/T|0,n=u*s+a*c,o=c*s+n%T*T+r,r=(o/i|0)+(n/T|0)+u*a,e[l]=o%i;return r&&(e=[r].concat(e)),e}function i(e,t,i,n){var o,s;if(i!=n)s=i>n?1:-1;else for(o=s=0;o<i;o++)if(e[o]!=t[o]){s=e[o]>t[o]?1:-1;break}return s}function n(e,t,i,n){for(var o=0;i--;)e[i]-=o,o=e[i]<t[i]?1:0,e[i]=o*n+e[i]-t[i];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(o,s,r,l,c){var u,d,h,m,f,_,v,w,M,T,C,I,A,S,E,x,L,N=o.s==s.s?1:-1,O=o.c,D=s.c;if(!(O&&O[0]&&D&&D[0]))return new t(o.s&&s.s&&(O?!D||O[0]!=D[0]:D)?O&&0==O[0]||!D?0*N:N/0:NaN);for(w=new t(N),M=w.c=[],d=o.e-s.e,N=r+d+1,c||(c=y,d=a(o.e/b)-a(s.e/b),N=N/b|0),h=0;D[h]==(O[h]||0);h++);if(D[h]>(O[h]||0)&&d--,N<0)M.push(1),m=!0;else{for(S=O.length,x=D.length,h=0,N+=2,f=g(c/(D[0]+1)),f>1&&(D=e(D,f,c),O=e(O,f,c),x=D.length,S=O.length),A=x,T=O.slice(0,x),C=T.length;C<x;T[C++]=0);L=D.slice(),L=[0].concat(L),E=D[0],D[1]>=c/2&&E++;do{if(f=0,u=i(D,T,x,C),u<0){if(I=T[0],x!=C&&(I=I*c+(T[1]||0)),f=g(I/E),f>1)for(f>=c&&(f=c-1),_=e(D,f,c),v=_.length,C=T.length;1==i(_,T,v,C);)f--,n(_,x<v?L:D,v,c),v=_.length,u=1;else 0==f&&(u=f=1),_=D.slice(),v=_.length;if(v<C&&(_=[0].concat(_)),n(T,_,C,c),C=T.length,u==-1)for(;i(D,T,x,C)<1;)f++,n(T,x<C?L:D,C,c),C=T.length}else 0===u&&(f++,T=[0]);M[h++]=f,T[0]?T[C++]=O[A]||0:(T=[O[A]],C=1)}while((A++<S||null!=T[0])&&N--);m=null!=T[0],M[0]||M.splice(0,1)}if(c==y){for(h=1,N=M[0];N>=10;N/=10,h++);p(w,r+(w.e=h+d*b-1)+1,l,m)}else w.e=d,w.r=+m;return w}}(),E=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,i=/^([^.]+)\.$/,n=/^\.([^.]+)$/,o=/^-?(Infinity|NaN)$/,s=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(a,r,l,c){var u,d=l?r:r.replace(s,"");if(o.test(d))a.s=isNaN(d)?null:d<0?-1:1,a.c=a.e=null;else{if(!l&&(d=d.replace(e,function(e,t,i){return u="x"==(i=i.toLowerCase())?16:"b"==i?2:8,c&&c!=u?e:t}),c&&(u=c,d=d.replace(i,"$1").replace(n,"0.$1")),r!=d))return new t(d,u);if(t.DEBUG)throw Error(_+"Not a"+(c?" base "+c:"")+" number: "+r);a.c=a.e=a.s=null}}}(),x.absoluteValue=x.abs=function(){var e=new t(this);return e.s<0&&(e.s=1),e},x.comparedTo=function(e,i){return l(this,new t(e,i))},x.decimalPlaces=x.dp=function(e,i){var n,o,s,r=this;if(null!=e)return c(e,0,C),null==i?i=O:c(i,0,8),p(new t(r),e+r.e+1,i);if(!(n=r.c))return null;if(o=((s=n.length-1)-a(this.e/b))*b,s=n[s])for(;s%10==0;s/=10,o--);return o<0&&(o=0),o},x.dividedBy=x.div=function(e,i){return A(this,new t(e,i),N,O)},x.dividedToIntegerBy=x.idiv=function(e,i){return A(this,new t(e,i),0,1)},x.exponentiatedBy=x.pow=function(e,i){var n,o,s,a,r,l,c,d,h,m=this;if(e=new t(e),e.c&&!e.isInteger())throw Error(_+"Exponent not an integer: "+I(e));if(null!=i&&(i=new t(i)),l=e.e>14,!m.c||!m.c[0]||1==m.c[0]&&!m.e&&1==m.c.length||!e.c||!e.c[0])return h=new t(Math.pow(+I(m),l?2-u(e):+I(e))),i?h.mod(i):h;if(c=e.s<0,i){if(i.c?!i.c[0]:!i.s)return new t(NaN);o=!c&&m.isInteger()&&i.isInteger(),o&&(m=m.mod(i))}else{if(e.e>9&&(m.e>0||m.e<-1||(0==m.e?m.c[0]>1||l&&m.c[1]>=24e7:m.c[0]<8e13||l&&m.c[0]<=9999975e7)))return a=m.s<0&&u(e)?-0:0,m.e>-1&&(a=1/a),new t(c?1/a:a);z&&(a=f(z/b+2))}for(l?(n=new t(.5),c&&(e.s=1),d=u(e)):(s=Math.abs(+I(e)),d=s%2),h=new t(L);;){if(d){if(h=h.times(m),!h.c)break;a?h.c.length>a&&(h.c.length=a):o&&(h=h.mod(i))}if(s){if(s=g(s/2),0===s)break;d=s%2}else if(e=e.times(n),p(e,e.e+1,1),e.e>14)d=u(e);else{if(s=+I(e),0===s)break;d=s%2}m=m.times(m),a?m.c&&m.c.length>a&&(m.c.length=a):o&&(m=m.mod(i))}return o?h:(c&&(h=L.div(h)),i?h.mod(i):a?p(h,z,O,r):h)},x.integerValue=function(e){var i=new t(this);return null==e?e=O:c(e,0,8),p(i,i.e+1,e)},x.isEqualTo=x.eq=function(e,i){return 0===l(this,new t(e,i))},x.isFinite=function(){return!!this.c},x.isGreaterThan=x.gt=function(e,i){return l(this,new t(e,i))>0},x.isGreaterThanOrEqualTo=x.gte=function(e,i){return 1===(i=l(this,new t(e,i)))||0===i},x.isInteger=function(){return!!this.c&&a(this.e/b)>this.c.length-2},x.isLessThan=x.lt=function(e,i){return l(this,new t(e,i))<0},x.isLessThanOrEqualTo=x.lte=function(e,i){return(i=l(this,new t(e,i)))===-1||0===i},x.isNaN=function(){return!this.s},x.isNegative=function(){return this.s<0},x.isPositive=function(){return this.s>0},x.isZero=function(){return!!this.c&&0==this.c[0]},x.minus=function(e,i){var n,s,r,l,c=this,u=c.s;if(e=new t(e,i),i=e.s,!u||!i)return new t(NaN);if(u!=i)return e.s=-i,c.plus(e);var d=c.e/b,h=e.e/b,p=c.c,m=e.c;if(!d||!h){if(!p||!m)return p?(e.s=-i,e):new t(m?c:NaN);if(!p[0]||!m[0])return m[0]?(e.s=-i,e):new t(p[0]?c:3==O?-0:0)}if(d=a(d),h=a(h),p=p.slice(),u=d-h){for((l=u<0)?(u=-u,r=p):(h=d,r=m),r.reverse(),i=u;i--;r.push(0));r.reverse()}else for(s=(l=(u=p.length)<(i=m.length))?u:i,u=i=0;i<s;i++)if(p[i]!=m[i]){l=p[i]<m[i];break}if(l&&(r=p,p=m,m=r,e.s=-e.s),i=(s=m.length)-(n=p.length),i>0)for(;i--;p[n++]=0);for(i=y-1;s>u;){if(p[--s]<m[s]){for(n=s;n&&!p[--n];p[n]=i);--p[n],p[s]+=y}p[s]-=m[s]}for(;0==p[0];p.splice(0,1),--h);return p[0]?o(e,p,h):(e.s=3==O?-1:1,e.c=[e.e=0],e)},x.modulo=x.mod=function(e,i){var n,o,s=this;return e=new t(e,i),!s.c||!e.s||e.c&&!e.c[0]?new t(NaN):!e.c||s.c&&!s.c[0]?new t(s):(9==F?(o=e.s,e.s=1,n=A(s,e,0,3),e.s=o,n.s*=o):n=A(s,e,0,F),e=s.minus(n.times(e)),e.c[0]||1!=F||(e.s=s.s),e)},x.multipliedBy=x.times=function(e,i){var n,s,r,l,c,u,d,h,p,m,f,g,_,v,w,M=this,C=M.c,I=(e=new t(e,i)).c;if(!(C&&I&&C[0]&&I[0]))return!M.s||!e.s||C&&!C[0]&&!I||I&&!I[0]&&!C?e.c=e.e=e.s=null:(e.s*=M.s,C&&I?(e.c=[0],e.e=0):e.c=e.e=null),e;for(s=a(M.e/b)+a(e.e/b),e.s*=M.s,d=C.length,m=I.length,d<m&&(_=C,C=I,I=_,r=d,d=m,m=r),r=d+m,_=[];r--;_.push(0));for(v=y,w=T,r=m;--r>=0;){for(n=0,f=I[r]%w,g=I[r]/w|0,c=d,l=r+c;l>r;)h=C[--c]%w,p=C[c]/w|0,u=g*h+p*f,h=f*h+u%w*w+_[l]+n,n=(h/v|0)+(u/w|0)+g*p,_[l--]=h%v;_[l]=n}return n?++s:_.splice(0,1),o(e,_,s)},x.negated=function(){var e=new t(this);return e.s=-e.s||null,e},x.plus=function(e,i){var n,s=this,r=s.s;if(e=new t(e,i),i=e.s,!r||!i)return new t(NaN);if(r!=i)return e.s=-i,s.minus(e);var l=s.e/b,c=e.e/b,u=s.c,d=e.c;if(!l||!c){if(!u||!d)return new t(r/0);if(!u[0]||!d[0])return d[0]?e:new t(u[0]?s:0*r)}if(l=a(l),c=a(c),u=u.slice(),r=l-c){for(r>0?(c=l,n=d):(r=-r,n=u),n.reverse();r--;n.push(0));n.reverse()}for(r=u.length,i=d.length,r-i<0&&(n=d,d=u,u=n,i=r),r=0;i;)r=(u[--i]=u[i]+d[i]+r)/y|0,u[i]=y===u[i]?0:u[i]%y;return r&&(u=[r].concat(u),++c),o(e,u,c)},x.precision=x.sd=function(e,i){var n,o,s,a=this;if(null!=e&&e!==!!e)return c(e,1,C),null==i?i=O:c(i,0,8),p(new t(a),e,i);if(!(n=a.c))return null;if(s=n.length-1,o=s*b+1,s=n[s]){for(;s%10==0;s/=10,o--);for(s=n[0];s>=10;s/=10,o++);}return e&&a.e+1>o&&(o=a.e+1),o},x.shiftedBy=function(e){return c(e,-w,w),this.times("1e"+e)},x.squareRoot=x.sqrt=function(){var e,i,n,o,s,l=this,c=l.c,u=l.s,d=l.e,h=N+4,m=new t("0.5");if(1!==u||!c||!c[0])return new t(!u||u<0&&(!c||c[0])?NaN:c?l:1/0);if(u=Math.sqrt(+I(l)),0==u||u==1/0?(i=r(c),(i.length+d)%2==0&&(i+="0"),u=Math.sqrt(+i),d=a((d+1)/2)-(d<0||d%2),u==1/0?i="1e"+d:(i=u.toExponential(),i=i.slice(0,i.indexOf("e")+1)+d),n=new t(i)):n=new t(u+""),n.c[0])for(d=n.e,u=d+h,u<3&&(u=0);;)if(s=n,n=m.times(s.plus(A(l,s,h,1))),r(s.c).slice(0,u)===(i=r(n.c)).slice(0,u)){if(n.e<d&&--u,i=i.slice(u-3,u+1),"9999"!=i&&(o||"4999"!=i)){+i&&(+i.slice(1)||"5"!=i.charAt(0))||(p(n,n.e+N+2,1),e=!n.times(n).eq(l));break}if(!o&&(p(s,s.e+N+2,0),s.times(s).eq(l))){n=s;break}h+=4,u+=4,o=1}return p(n,n.e+N+1,O,e)},x.toExponential=function(e,t){return null!=e&&(c(e,0,C),e++),i(this,e,t,1)},x.toFixed=function(e,t){return null!=e&&(c(e,0,C),e=e+this.e+1),i(this,e,t)},x.toFormat=function(e,t,i){var n,o=this;if(null==i)null!=e&&t&&"object"==typeof t?(i=t,t=null):e&&"object"==typeof e?(i=e,e=t=null):i=H;else if("object"!=typeof i)throw Error(_+"Argument not an object: "+i);if(n=o.toFixed(e,t),o.c){var s,a=n.split("."),r=+i.groupSize,l=+i.secondaryGroupSize,c=i.groupSeparator||"",u=a[0],d=a[1],h=o.s<0,p=h?u.slice(1):u,m=p.length;if(l&&(s=r,r=l,l=s,m-=s),r>0&&m>0){for(s=m%r||r,u=p.substr(0,s);s<m;s+=r)u+=c+p.substr(s,r);l>0&&(u+=c+p.slice(s)),h&&(u="-"+u)}n=d?u+(i.decimalSeparator||"")+((l=+i.fractionGroupSize)?d.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):d):u}return(i.prefix||"")+n+(i.suffix||"")},x.toFraction=function(e){var i,n,o,s,a,l,c,u,d,h,p,m,f=this,g=f.c;if(null!=e&&(c=new t(e),!c.isInteger()&&(c.c||1!==c.s)||c.lt(L)))throw Error(_+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+I(c));if(!g)return new t(f);for(i=new t(L),d=n=new t(L),o=u=new t(L),m=r(g),a=i.e=m.length-f.e-1,i.c[0]=M[(l=a%b)<0?b+l:l],e=!e||c.comparedTo(i)>0?a>0?i:d:c,l=B,B=1/0,c=new t(m),u.c[0]=0;h=A(c,i,0,1),s=n.plus(h.times(o)),1!=s.comparedTo(e);)n=o,o=s,d=u.plus(h.times(s=d)),u=s,i=c.minus(h.times(s=i)),c=s;return s=A(e.minus(n),o,0,1),u=u.plus(s.times(d)),n=n.plus(s.times(o)),u.s=d.s=f.s,a=2*a,p=A(d,o,a,O).minus(f).abs().comparedTo(A(u,n,a,O).minus(f).abs())<1?[d,o]:[u,n],B=l,p},x.toNumber=function(){return+I(this)},x.toPrecision=function(e,t){return null!=e&&c(e,1,C),i(this,e,t,2)},x.toString=function(e){var t,i=this,n=i.s,o=i.e;return null===o?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(t=r(i.c),null==e?t=o<=D||o>=R?d(t,o):h(t,o,"0"):(c(e,2,q.length,"Base"),t=S(h(t,o,"0"),10,e,n,!0)),n<0&&i.c[0]&&(t="-"+t)),t},x.valueOf=x.toJSON=function(){return I(this)},x._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(x[Symbol.toStringTag]="BigNumber",x[Symbol["for"]("nodejs.util.inspect.custom")]=x.valueOf),null!=e&&t.set(e),t}function a(e){var t=0|e;return e>0||e===t?t:t-1}function r(e){for(var t,i,n=1,o=e.length,s=e[0]+"";n<o;){for(t=e[n++]+"",i=b-t.length;i--;t="0"+t);s+=t}for(o=s.length;48===s.charCodeAt(--o););return s.slice(0,o+1||1)}function l(e,t){var i,n,o=e.c,s=t.c,a=e.s,r=t.s,l=e.e,c=t.e;if(!a||!r)return null;if(i=o&&!o[0],n=s&&!s[0],i||n)return i?n?0:-r:a;if(a!=r)return a;if(i=a<0,n=l==c,!o||!s)return n?0:!o^i?1:-1;if(!n)return l>c^i?1:-1;for(r=(l=o.length)<(c=s.length)?l:c,a=0;a<r;a++)if(o[a]!=s[a])return o[a]>s[a]^i?1:-1;return l==c?0:l>c^i?1:-1}function c(e,t,i,n){if(e<t||e>i||e!==(e<0?f(e):g(e)))throw Error(_+(n||"Argument")+("number"==typeof e?e<t||e>i?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function u(e){var t=e.c.length-1;return a(e.e/b)==t&&e.c[t]%2!=0}function d(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function h(e,t,i){var n,o;if(t<0){for(o=i+".";++t;o+=i);e=o+e}else if(n=e.length,++t>n){for(o=i,t-=n;--t;o+=i);e+=o}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}var p,m=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,f=Math.ceil,g=Math.floor,_="[BigNumber Error] ",v=_+"Number primitive has more than 15 significant digits: ",y=1e14,b=14,w=9007199254740991,M=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],T=1e7,C=1e9;p=s(),p["default"]=p.BigNumber=p,n=function(){return p}.call(t,i,t,e),!(void 0!==n&&(e.exports=n))}(this)},function(e,t,i){function n(){s.call(this,"div",{className:"progressGauge"}),this.gaugeBg=this.createChild("div",{className:"gaugeBg"}),this.gaugeMask=this.createChild("div",{className:"gaugeMask"}),this.gaugeFill=this.gaugeMask.createChild("div",{className:"gaugeFill"}),this._resetAnimInfo(),this._initEvents()}i(810);var o=i(191).inherits,s=i(235),a=i(183).dimensions,r=i(252),l=i(29).getText,c=i(195),u={PLAYER_EXPERIENCE:"playerExperience",GUILD_EXPERIENCE:"guildExperience",MOUNT_EXPERIENCE:"mountExperience",INVENTORY_PODS:"inventoryPods",FIGHT_TIMER:"fightTimer"},d="-progressBarPref";o(n,s),e.exports=n,n.prototype._initEvents=function(){var e=this,t=window.dofus.connectionManager,i=window.gui,n=i.playerData;i.on("resize",function(){e._resize()}),n.on("characterSelectedSuccess",function(){var t=c.getValue(n.id+d,u.PLAYER_EXPERIENCE);t&&(e.defaultMode=t,e._setMode(e.defaultMode),e._setPercentage(0))}),t.on("CharacterStatsListMessage",function(t){var i=t.stats;e.playerPercentage=e._convertXpToPercentage(i.experience,i.experienceLevelFloor,i.experienceNextLevelFloor),e.gaugeMode===u.PLAYER_EXPERIENCE&&e._setPercentage(e.playerPercentage)}),t.on("GuildInformationsGeneralMessage",function(t){e.guildPercentage=e._convertXpToPercentage(t.experience,t.expLevelFloor,t.expNextLevelFloor),e.gaugeMode===u.GUILD_EXPERIENCE&&e._setPercentage(e.guildPercentage)}),t.on("MountSetMessage",function(t){var i=t.mountData;e.mountPercentage=e._convertXpToPercentage(i.experience,i.experienceForLevel,i.experienceForNextLevel),e.gaugeMode===u.MOUNT_EXPERIENCE&&e._setPercentage(e.mountPercentage)}),n.jobs.on("jobExperienceUpdate",function(t){e["job"+t.jobId+"Percentage"]=t.percentage,e.gaugeMode==="job"+t.jobId&&e._setPercentage(e["job"+t.jobId+"Percentage"])}),n.inventory.on("weightUpdated",function(){e.gaugeMode===u.INVENTORY_PODS&&e._updateGaugeWithInventoryPods()}),i.fightManager.on("fightEnterPreparation",function(t){t.isSpectator||e._setMode(u.FIGHT_TIMER,{duration:t.timeMaxBeforeFightStart})}),i.fightManager.on("fightEnterBattle",function(){n.isSpectator||(e.gaugeMode!==u.FIGHT_TIMER&&e._setMode(u.FIGHT_TIMER),e._pauseAnimation())}),i.timeline.on("setTurnOf",function(t,i){if(e.gaugeMode===u.FIGHT_TIMER){var o=n.characters.controlledCharacterId;t.id===o?e._animate(i):(e._setStatic(),e._setPercentage(0))}}),i.fightManager.on("fightEnd",function(){e._setMode(e.defaultMode)})},n.prototype._updateGaugeWithInventoryPods=function(){var e=window.gui.playerData.inventory;this._setPercentage(Math.round(e.weight/e.maxWeight*100))},n.prototype._setMode=function(e,t){var i=t&&"number"==typeof t.duration?t.duration:null,n=t&&"number"==typeof t.percentage?t.percentage:0;this.gaugeMode=e;var o=null;e.indexOf("job")!==-1&&(o=parseInt(e.split("job")[1],10),e="job");var s;switch(e){case u.FIGHT_TIMER:s="fightTimer",null!==i?this._animate(i,n):(this._setStatic(),this._setPercentage(n));break;case u.GUILD_EXPERIENCE:s="guildXp",this._setStatic(),this._setPercentage(this.guildPercentage);break;case u.MOUNT_EXPERIENCE:s="mountXp",this._setStatic(),this._setPercentage(this.mountPercentage);break;case u.INVENTORY_PODS:s="inventoryPods",this._setStatic(),this._updateGaugeWithInventoryPods();break;case"job":s="jobXp",this._setStatic(),this._setPercentage(this["job"+o+"Percentage"]);break;case u.PLAYER_EXPERIENCE:default:s="playerXp",this._setStatic(),this._setPercentage(this.playerPercentage)}this.setClassNames(["progressGauge",s])},n.prototype._resetAnimInfo=function(){this.animationInfo={startTime:0,duration:0,startFrom:0}},n.prototype._setStatic=function(){this.gaugeFill.setStyles({webkitAnimation:"initial",webkitAnimationPlayState:"initial"}),this._resetAnimInfo()},n.prototype._setPercentage=function(e){e||(e=0),e=Math.max(0,Math.min(100,e)),this.gaugeFill.setStyle("webkitTransform","translate3d(-"+(100-e)/2+"%,0,0) scaleX("+e/100+")")},n.prototype._convertXpToPercentage=function(e,t,i){return(e-t)/(i-t)*100},n.prototype._animate=function(e,t){if(this.gaugeMode!==u.FIGHT_TIMER)return console.error(new Error("ProgressGauge._animate: ProgressGauge is not in timer mode"));t=t||0,t=Math.max(0,Math.min(100,t));var i=e/100*t;this._setStatic(),this._setPercentage(100),r.forceReflow(this.gaugeFill),this.animationInfo={startTime:Date.now(),duration:e,startFrom:t},this.gaugeFill.setStyles({webkitAnimation:"progressGaugeAnimation "+e+"ms linear -"+i+"ms",webkitAnimationPlayState:"running"})},n.prototype._pauseAnimation=function(){return this.gaugeMode!==u.FIGHT_TIMER?console.error(new Error("ProgressGauge._pauseAnimation: ProgressGauge is not in timer mode")):void this.gaugeFill.setStyle("webkitAnimationPlayState","paused")},n.prototype._resize=function(){window.gui.ipadRatio?this.setStyle("width","100%"):this.setStyle("width",a.shortcutBarSize-9+"px");var e=this.animationInfo;if(this.gaugeMode===u.FIGHT_TIMER&&0!==e.startTime){var t=Date.now()-e.startTime;if(t<e.duration){var i=t/e.duration*(100-e.startFrom),n=e.startFrom+i;this._animate(e.duration-t,n)}}},n.prototype.openPrefMenu=function(){function e(){i.defaultMode=this.value,i._setMode(i.defaultMode),c.setValue(window.gui.playerData.id+d,i.defaultMode)}function t(t,o){n.push({caption:t,value:o,cb:e,ticked:i.defaultMode===o})}var i=this,n=[];t(l("ui.banner.xpCharacter"),"playerExperience"),t(l("ui.common.weight"),"inventoryPods"),window.gui.playerData.guild.current&&t(l("ui.banner.xpGuild"),"guildExperience"),window.gui.playerData.equippedMount&&t(l("ui.banner.xpMount"),"mountExperience");for(var o in window.gui.playerData.jobs.list){var s=window.gui.playerData.jobs.list[o];t(l("ui.common.xp")+" "+s.info.nameId,"job"+s.id)}window.gui.openContextualMenu("generic",{title:l("ui.banner.customGauge"),actions:n})}},function(e,t){},function(e,t,i){function n(){a.call(this,{scaleOnPress:!0,className:"RewardsIndicator",hidden:!0},function(){r["switch"]("rewardsPending")});var e=this;window.gui.on("disconnect",function(){e.hide()}),window.gui.on("resize",function(){e._initPosition()}),this.on("show",function(){c("NEW_REWARD")})}i(812);var o=i(191).inherits,s=i(235),a=i(246),r=i(225),l=i(183).dimensions,c=i(258).playUiSound;o(n,s),e.exports=n,n.prototype._initPosition=function(){this.setStyle("left",l.mapLeft+l.mapWidth/2-32+"px"),this.setStyle("top",l.mapBottom-64+"px")}},function(e,t){},function(e,t,i){function n(){var e=this,t=window.gui;this._isActive=!1,this._activePictoMap={},t.once("initialized",function(){var i=window.gui.gameGuiContainer;e._pingBtn=i.appendChild(new s),e._pingBox=i.appendChild(new a),e._emoteBox=i.appendChild(new r),e._setupEvents(t),e._emoteBox.refreshPosition(),e._emoteBox.hide()}),t.on("disconnect",function(){e._reset(),e._resetPicto()}),t.fightManager.on("fightStart",function(){e._pingBtn.enterFightState()}),t.fightManager.on("fightEnd",function(){e._pingBtn.enterRolePlayState()})}var o=i(229).position,s=i(814),a=i(817),r=i(820),l=4e3;e.exports=n,n.prototype.PING_CELL_COLOR={r:240,g:160,b:65,a:.75},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=this._pingBtn,n=this._pingBox;t.on("GameFightEndMessage",function(){e._reset(),e._resetPicto()}),i.on("selected",function(){t.playerData.isFighting&&(e._isActive=!0)}),i.on("unselected",function(){t.playerData.isFighting&&(e._isActive=!1,e._pingBox.close())}),i.on("emoteBtnTap",function(){if(e._emoteBox.isOpen)e._emoteBox.hide();else{if(t.playerData.isFighting)return;e._emoteBox.show(),e._emoteBox.refreshPosition()}}),n.on("actionSent",function(){e._reset()})},n.prototype.cancelPingBox=function(){this._pingBox.close()},n.prototype.openPingBox=function(e,t){this._pingBox.open(o.x,o.y,e,t)},n.prototype.isPingBoxOpen=function(){return this._pingBox.isOpen()},n.prototype.addPingPicto=function(e,t){function i(e){return window.setTimeout(function(){window.isoEngine.mapRenderer.removePingPicto(e),delete n._activePictoMap[e]},l)}if(window.gui.playerData.isFighting&&e!==-1){var n=this,o=t+"-cellId"+e;if(this._activePictoMap[o])return window.clearTimeout(this._activePictoMap[o]),void(this._activePictoMap[o]=i(o));window.isoEngine.mapRenderer.addPingPictoOnCell(o,e,t),this._activePictoMap[o]=i(o)}},n.prototype._removePingPicto=function(){for(var e in this._activePictoMap)this._activePictoMap.hasOwnProperty(e)&&(window.clearTimeout(this._activePictoMap[e]),window.isoEngine.mapRenderer.removePingPicto(e),delete this._activePictoMap[e])},n.prototype._reset=function(){this._isActive=!1,this._pingBtn&&(this._pingBtn.unselect(),this._pingBox.close())},n.prototype._resetPicto=function(){this._removePingPicto(),this._activePictoMap={}},n.prototype.isActive=function(){return this._isActive},n.prototype.getChatIcons=function(){return this._emoteBox.getChatIcons()}},function(e,t,i){function n(){s.call(this,"div",{className:"PingBtn"});var e=this;this._isActivated=!1;var t=this.createChild("div",{className:"borderBox"});this._pingBtn=t.appendChild(new o({className:"pingBtn",scaleOnPress:!0,tooltip:a("tablet.pingsystem.pingsystem"),hidden:!0},function(){window.gui.playerData.isFighting&&(e._isActivated?e.unselect():e.select())})),this._emoteBtn=t.appendChild(new o({className:"emoteBtn",tooltip:a("tablet.common.emotesAndSmilies")},function(){window.gui.playerData.isFighting||(e.unselect(),e.emit("emoteBtnTap"))})),this._setupEvents(),this._resize(),this.exclusiveSelector=u("shortcutSlots"),this.exclusiveSelector.register(this)}i(815);var o=i(246),s=i(235),a=i(29).getText,r=i(191).inherits,l=i(183).dimensions,c=i(184),u=i(816).getExclusiveSelectorByGroup;r(n,s),e.exports=n,n.prototype._setupEvents=function(){var e=this,t=window.gui;t.on("resize",function(){e._resize()})},n.prototype._resize=function(){var e=l.pingEmoteBtnSize;window.gui.ipadRatio?this.setStyles({top:"",right:"",left:l.posPingEmoteBtn+"px",bottom:"0",width:e+"px",height:l.bottomBarHeight+"px"}):this.setStyles({bottom:"",left:"",right:"0",top:l.posPingEmoteBtn+"px",width:c.PING_EMOTE_BTN_WIDE_MIN_WIDTH+"px",height:e+"px"})},n.prototype.select=function(){this._pingBtn.addClassNames("on"),this._isActivated=!0,this.emit("selected")},n.prototype.unselect=function(){this._pingBtn.delClassNames("on"),this._isActivated=!1,this.emit("unselected")},n.prototype.enterFightState=function(){this._pingBtn.show(),this._emoteBtn.hide(),this._resize()},n.prototype.enterRolePlayState=function(){this._emoteBtn.show(),this._pingBtn.hide(),this._resize()}},function(e,t){},function(e,t,i){function n(){s.call(this),this._currentSelection=null;var e=this;this._onSelected=function(){e._selectionChanged(this,!0)},this._onUnselected=function(){e._selectionChanged(this,!1)}}var o=i(191),s=i(194),a={};o.inherits(n,s),t.ExclusiveSelector=n,n.prototype.register=function(e){return"function"!=typeof e.unselect?console.error(new Error("ExclusiveSelector.register: target does not have an unselect method")):e.listeners("selected").indexOf(this._onSelected)!==-1?console.error(new Error("Dupe call to ExclusiveSelector.register")):(e.on("selected",this._onSelected),void e.on("unselected",this._onUnselected))},n.prototype.unregister=function(e){return e.listeners("selected").indexOf(this._onSelected)===-1?console.error(new Error("ExclusiveSelector extra unregister")):(e.removeListener("selected",this._onSelected),void e.removeListener("unselected",this._onUnselected))},n.prototype._selectionChanged=function(e,t){if(t){if(this._currentSelection){if(e===this._currentSelection)return;this._currentSelection.unselect()}this._currentSelection=e}else e===this._currentSelection&&(this._currentSelection=null);this.emit("selectionChanged",this._currentSelection)},t.getExclusiveSelectorByGroup=function(e){if(e||(e="default"),e in a)return a[e];var t=new n;return a[e]=t,t}},function(e,t,i){function n(){function e(e){e.toggleDisplay(!0)}function t(e,t){e.toggleDisplay(t.isEmptyCell)}function i(e,t){e.toggleDisplay(!t.isEmptyCell)}a.call(this,"div",{className:"PingBox",hidden:!0});var n=this,s=window.gui,l="pingBoxShowBoxId",u=s.pingSystem.PING_CELL_COLOR;this._MESSAGE_CHANNEL=c.CHANNEL_TEAM,this._position={x:0,y:0},this._isOpen=!1,this._cellId=-1,this._talks=[],this._actions=[];var d=this.createChild("div",{className:"tabPanel"}),h=this.createChild("div",{className:"containers"});d.appendChild(new o({className:["pingTalk","tab"],scaleOnPress:!0},function(){g.hide(),f.hide(),h.getChildren()[0]!==m&&h.insertAsFirstChild(m),m.show(),n.reposition()})),d.appendChild(new o({className:["pingSentence","tab"],scaleOnPress:!0},function(){m.hide(),g.hide(),h.getChildren()[0]!==f&&h.insertAsFirstChild(f),f.show(),n.reposition()})),d.appendChild(new o({className:["pingAction","tab"],scaleOnPress:!0},function(){m.hide(),f.hide(),h.getChildren()[0]!==g&&h.insertAsFirstChild(g),g.show(),n.reposition()}));var m=this._talkContainer=h.createChild("div",{className:["container","talkContainer"]}),f=this._sentenceContainer=h.createChild("div",{className:["container","sentenceContainer"]}),g=this._actionContainer=h.createChild("div",{className:["container","actionContainer"]});m.hide(),g.hide(),f.hide(),this._addSmileys(),this._addSentence(r("tablet.pingsystem.hello"),p.hello,e),this._addSentence(r("tablet.pingsystem.thx"),p.thx,e),this._addSentence(r("tablet.pingsystem.great"),p.great,e),this._addSentence(r("tablet.pingsystem.goodJob"),p.goodJob,e),this._addSentence(r("tablet.pingsystem.yes"),p.yes,e),this._addSentence(r("tablet.pingsystem.no"),p.no,e),this._addSentence(r("tablet.pingsystem.ready"),p.ready,e),this._addSentence(r("tablet.pingsystem.tooFar"),p.tooFar,e),this._addSentence(r("tablet.pingsystem.outSight"),p.outSight,e),this._addSentence(r("tablet.pingsystem.comeCloser"),p.comeCloser,e),this._addSentence(r("tablet.pingsystem.retreat"),p.retreat,e),this._addSentence(r("tablet.pingsystem.challenge"),p.lightBulb,e),this._addAction(r("tablet.pingsystem.mp"),"mp",t),this._addAction(r("tablet.pingsystem.warning"),"warning",t),this._addAction(r("tablet.pingsystem.stop"),"stop",t),this._addAction(r("tablet.pingsystem.attack"),"attack",i),this._addAction(r("tablet.pingsystem.move"),"move",i),this._addAction(r("tablet.pingsystem.heal"),"heal",i),this._addAction(r("tablet.pingsystem.boost"),"boost",i),this._addAction(r("tablet.pingsystem.tackle"),"tackle",i),this._addAction(r("tablet.pingsystem.valid"),"valid",i),this.on("show",function(){window.isoEngine.mapRenderer.addCellHighlight(l,[this._cellId],u)}),this.on("hide",function(){window.isoEngine.mapRenderer.deleteCellHighlight(l)}),s.on("disconnect",function(){n.close()})}i(818);var o=i(246),s=i(669),a=i(235),r=i(29).getText,l=i(191).inherits,c=i(412),u=i(227),d=i(250).getElementPositionCenteredAt,h=i(183).dimensions,p=i(819),m=i(202),f=i(228);
l(n,a),e.exports=n,n.prototype._addSmileys=function(){function e(e,i){function n(){window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:o.id}),t.emit("actionSent"),t._talkContainer.hide()}var o=new a("div",{name:e.id,className:["chatIcon","smileyIcon"]});o.id=e.id,o.setStyle("backgroundImage",i),f(o),o.on("tap",n),t._talkContainer.appendChild(o)}var t=this;t._talkContainer.addClassNames("spinner");for(var i=window.gui.databases.Smileys,n=Object.keys(i),o=[],s=0;s<n.length;s++)o.push("gfx/smilies/"+i[n[s]].gfxId+".png");m.preloadImages(o,function(o){for(var s=0;s<o.length;s++)e(i[n[s]],o[s]);t._talkContainer.delClassNames("spinner")})},n.prototype._addSentence=function(e,t,i){var n=this,o=window.gui.databases.Smileys[t];o||(o={},console.warn("PingBox: Smiley "+t+" details are not available, it could not be displayed"));var a=this._sentenceContainer.createChild("div",{className:"pingRow"});f(a,null),a.on("tap",function(){window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:t}),s.sendMessage(e,n._MESSAGE_CHANNEL),n.emit("actionSent")});var r=a.createChild("div",{className:"smiley"});m.preloadImage("gfx/smilies/"+o.gfxId+".png",function(e){r.setStyle("backgroundImage",e)}),a.createChild("div",{text:e,className:"label"}),a.displayFn=i,this._talks.push(a)},n.prototype._addAction=function(e,t,i){var n=this,o=this._actionContainer.createChild("div",{className:"pingRow"});f(o,null),o.on("tap",function(){var i="{pingsystem,"+n._cellId+","+t+"::["+e+"]}";s.sendMessage(i,n._MESSAGE_CHANNEL),n.emit("actionSent")});var a=o.createChild("div",{className:"iconBox"});a.createChild("div",{className:["icon",t]}),o.createChild("div",{text:e,className:"label"}),o.displayFn=i,this._actions.push(o)},n.prototype._filterActionsMenu=function(e){e=e||{};var t,i,n=this._talks,o=this._actions;for(t=0,i=n.length;t<i;t+=1){var s=n[t];s.displayFn(s,e)}for(t=0,i=o.length;t<i;t+=1){var a=o[t];a.displayFn(a,e)}},n.prototype.isOpen=function(){return this._isOpen},n.prototype.reposition=function(){var e=10,t=this.rootElement.getBoundingClientRect(),i=t.left,n=t.left+t.width,o=t.top,s=t.top+t.height;i<e&&(i=e),n>h.screenWidth-e&&(i=h.screenWidth-e-t.width),o<e&&(o=e),s>h.screenHeight-e&&(o=h.screenHeight-e-t.height),i===t.left&&o===t.top||u.tween(this,{webkitTransform:"scale(1) translate3d("+Math.round(i)+"px, "+Math.round(o)+"px, 0)"},{time:100,easing:"linear"})},n.prototype.open=function(e,t,i,n){var o=window.foreground;this._cellId=i,o.confirmBox.close(),o.deselectSpell(),window.gui.shortcutBar.deselectCurrentSlot(),this._filterActionsMenu({isEmptyCell:n}),this.show();var s=this._position=d(this,e,t);this._isOpen?this.setStyles({webkitTransformOrigin:e+"px "+t+"px"}):this.setStyles({webkitTransform:"scale(0) translate3d("+s.x+"px, "+s.y+"px, 0)",webkitTransformOrigin:e+"px "+t+"px"}),u.tween(this,{webkitTransform:"scale(1) translate3d("+s.x+"px, "+s.y+"px, 0)"},{time:100,easing:"linear"}),this._isOpen=!0},n.prototype.close=function(){var e=this,t=this._position;this._isOpen&&(this._isOpen=!1,this._cellId=-1,u.tween(this,{webkitTransform:"scale(0) translate3d("+t.x+"px,"+t.y+"px,0)"},{time:100,easing:"linear"},function(){e.hide(),e._sentenceContainer.hide(),e._actionContainer.hide(),e._talkContainer.hide()}))}},function(e,t){},function(e,t){e.exports={hello:1,ready:4,great:7,thx:8,goodJob:10,outSight:26,comeCloser:43,tooFar:44,retreat:63,lightBulb:80,yes:88,no:89}},function(e,t,i){function n(){s.call(this,"div",{className:"EmoteBox"}),this._chatIcons=new o,this.appendChild(this._chatIcons);var e=this;this._chatIcons.on("closing",function(){e.hide()}),this.isOpen=!1,this._emoteBoxSize=85,this._time=200,this._delay=0,this._easing="ease-out"}i(821);var o=i(822),s=i(235),a=i(191).inherits,r=i(183).dimensions,l=i(184),c=i(227);a(n,s),e.exports=n,n.prototype.refreshPosition=function(){window.gui.ipadRatio?(this._chatIcons.setPanelsStyle("right","auto"),this._chatIcons.setPanelsStyle("left",r.pingEmoteBtnSize+"px"),this._chatIcons.setPanelsStyle("bottom",this._emoteBoxSize+"px"),this.setStyle("left",l.CHAT_BTN_MIN_WIDTH+"px"),this.setStyle("width",r.pingEmoteBtnSize+"px"),this.setStyle("height",this._emoteBoxSize+"px"),this.setStyle("bottom",r.bottomBarHeight+"px"),this.setStyle("line-height","inherit")):(this._chatIcons.setPanelsStyle("left","auto"),this._chatIcons.setPanelsStyle("right",this._emoteBoxSize+"px"),this._chatIcons.setPanelsStyle("bottom",r.pingEmoteBtnSize+"px"),this.setStyle("left",r.mapRight-this._emoteBoxSize+"px"),this.setStyle("width",this._emoteBoxSize+"px"),this.setStyle("height",r.pingEmoteBtnSize+"px"),this.setStyle("bottom","0px"),this.setStyle("line-height",r.pingEmoteBtnSize+"px"))},n.prototype.getChatIcons=function(){return this._chatIcons},n.prototype.show=function(){var e=this;e.setStyle("visibility","visible"),c.tween(this,{webkitTransform:"translate3d(0, 0, 0)"},{time:this._time,delay:this._delay,easing:this._easing},function(){e.isOpen=!0})},n.prototype.hide=function(){var e=this;window.gui.ipadRatio?c.tween(this,{webkitTransform:"translate3d(0, "+this._emoteBoxSize+"px, 0)"},{time:this._time,delay:this._delay,easing:this._easing},function(){e.setStyle("visibility","collapse"),e.isOpen=!1}):c.tween(this,{webkitTransform:"translate3d("+this._emoteBoxSize+"px, 0, 0)"},{time:this._time,delay:this._delay,easing:this._easing},function(){e.setStyle("visibility","collapse"),e.isOpen=!1})}},function(e,t){},function(e,t,i){function n(){var e=this;r.call(this,"div",{className:"ChatIcons"}),this.openPanel=null;var t=this.createChild("div",{className:"buttons"});this.smileysButton=t.createChild("div",{className:"smileysButton",tooltip:s("ui.chat.smilies")}),this.attitudesButton=t.createChild("div",{className:"attitudesButton",tooltip:s("ui.common.emotes")}),o(this.smileysButton,s("ui.chat.smilies")),o(this.attitudesButton,s("ui.common.emotes"));var i=this.createChild("div");this.smileysPanel=i.createChild("div",{className:"smileysPanel"}),this.attitudesPanel=i.createChild("div",{className:"attitudesPanel"}),this.smileysPanel.hide(),this.attitudesPanel.hide(),this.smileysButton.on("tap",function(){d.hide(),"smileys"===e.openPanel?e.closePanels():(e.openSmileys(),e.emit("activated"))}),this.attitudesButton.on("tap",function(){d.hide(),"attitudes"===e.openPanel?e.closePanels():(e.openAttitudes(),e.emit("activated"))}),d.on("show",function(){"smileys"!==e.openPanel&&"attitudes"!==e.openPanel||e.closePanels()}),this.once("open",this.loadIcons),this.attitudeList={},this.currentMood=null,this.previousMood=-1,this.setMessageHandlers()}i(823);var o=i(248).addTooltip,s=i(29).getText,a=i(191).inherits,r=i(235),l=i(228),c=i(202),u=i(250).getElementPositionAround,d=i(482),h=i(383),p=i(782);a(n,r),e.exports=n,n.prototype.setMessageHandlers=function(){var e=this,t=window.gui;t.on("MoodSmileyResultMessage",function(i){var n=i.resultCode;return n===p.MOOD_ERROR_UNKNOWN?(e.setCurrentMood(e.previousMood),t.openSimplePopup(s("ui.smiley.errorMood"))):n===p.MOOD_ERROR_FLOOD?(e.setCurrentMood(e.previousMood),t.openSimplePopup(s("ui.smiley.errorFloodMood"))):(e.setCurrentMood(i.smileyId),void(e.previousMood=i.smileyId))}),t.on("disconnect",function(){e.setCurrentMood(-1),e.previousMood=-1})},n.prototype.bindToPlayerEmoteData=function(){var e=this,t=window.gui.playerData.emoteData;t.on("emoteAdded",function(t){c.preloadImage("gfx/emotes/"+t.id+".png",function(i){e.addAttitudeIcon(t,i)})}),t.on("emoteRemoved",function(t){e.removeAttitudeIcon(t)}),t.on("emoteListUpdated",function(t){e.loadEmotes(t)})},n.prototype.loadIcons=function(){var e=this;this.loadEmotes(window.gui.playerData.emoteData.list),this.smileysPanel.addClassNames("spinner");for(var t=window.gui.databases.Smileys,i=Object.keys(t),n=[],o=0;o<i.length;o++)n.push("gfx/smilies/"+t[i[o]].gfxId+".png");c.preloadImages(n,function(n){for(var o=0;o<n.length;o++)e.addSmileyIcon(t[i[o]],n[o]);e.smileysPanel.delClassNames("spinner")}),this.bindToPlayerEmoteData()},n.prototype.loadEmotes=function(e){var t=this;this.attitudesPanel.clearContent(),this.attitudeList={},this.attitudesPanel.addClassNames("spinner");var i=Object.keys(e);i=i.map(function(e){return parseInt(e,10)}),i=i.sort(function(e,t){return e-t});for(var n=[],o=0;o<i.length;o++)n.push("gfx/emotes/"+i[o]+".png");c.preloadImages(n,function(n){for(var o=0;o<n.length;o++)t.addAttitudeIcon(e[i[o]],n[o]);t.attitudesPanel.delClassNames("spinner")})},n.prototype._addDraggableBehaviourTo=function(e,t,i){var n={prepareForDrag:function(t,i){return i.setStyle("backgroundImage",e.getStyle("backgroundImage")),e.once("dragEnd",function(){i.setStyle("backgroundImage",null)}),!0}},o={id:i},s={dragOnTouchstart:!1,dragElement:!1,noHover:!1};h.setDraggable(e,n,t,o,s)},n.prototype.addAttitudeIcon=function(e,t){function i(){window.dofus.sendMessage("EmotePlayRequestMessage",{emoteId:this.id}),n.closePanels()}var n=this,o=this.attitudesPanel.createChild("div",{className:["chatIcon","attitudeIcon"]});o.id=e.id,o.setStyle("backgroundImage",t),this.attitudeList[e.id]=o,this._addDraggableBehaviourTo(o,"attitude",o.id),l(o),o.on("tap",i)},n.prototype.removeAttitudeIcon=function(e){var t=this.attitudeList[e];t&&(t.destroy(),delete this.attitudeList[e])},n.prototype.setCurrentMood=function(e){var t=this.smileysPanel.getChild(e);this.currentMood!==t&&(this.currentMood&&this.currentMood.delClassNames("mood"),t&&t.addClassNames("mood"),this.currentMood=t)},n.prototype.addSmileyIcon=function(e,t){function i(){window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:this.id}),o.closePanels()}function n(){var e=o.currentMood===this?-1:this.id;o.setCurrentMood(e),window.dofus.sendMessage("MoodSmileyRequestMessage",{smileyId:e})}if(e.forPlayers){var o=this,s=new r("div",{name:e.id,className:["chatIcon","smileyIcon"]});s.id=e.id,s.setStyle("backgroundImage",t),l(s),s.on("tap",i),s.on("longtap",n),this.smileysPanel.appendChild(s),this._addDraggableBehaviourTo(s,"smiley",s.id)}},n.prototype.openSmileys=function(){this.emit("open"),this.attitudesPanel.hide(),this.smileysPanel.show(),this.openPanel="smileys"},n.prototype.openAttitudes=function(){this.emit("open"),this.smileysPanel.hide(),this.attitudesPanel.show(),this.openPanel="attitudes"},n.prototype.closePanels=function(){this.emit("closing"),this.smileysPanel.hide(),this.attitudesPanel.hide(),this.openPanel=null},n.prototype.setPanelsStyle=function(e,t){this.smileysPanel.setStyle(e,t),this.attitudesPanel.setStyle(e,t)},n.prototype.positionPanel=function(){function e(e,t){var i=u(e,t);e.setStyles({left:i.x+"px",top:i.y+"px"})}e(this.smileysPanel,this.smileysButton),e(this.attitudesPanel,this.attitudesButton)}},function(e,t){},function(e,t,i){function n(){s.call(this);var e=this,t=window.gui;this._characterList=[],this._charaListMinusDeadPeople=[],this._giftList=[],this._assigningGifts={},this._autoAssign=!1,this._toaRetryPending=[],t.once("initialized",function(){e._setupEvents()}),t.on("disconnect",function(){e._reset()})}var o=i(191).inherits,s=i(209).EventEmitter,a=i(509),r=i(225),l=i(661),c=i(184),u=i(29).getText;o(n,s),e.exports=n,n.prototype._setupEvents=function(){function e(e){for(var t=[],n=0;n<e.length;n+=1){for(var o=e[n],s=o.uid,a=o.items||[],r=null,l=0;l<a.length;l+=1)if(a[l].objectGID===c.TOA_RETRY_ITEM_ID){r=a[l];break}r?i._autoAssign?(i.assignGift(s,window.gui.playerData.id),i._autoAssign=!1):i._toaRetryPending.push(s):t.push(o)}return t}function t(t){var o=e(t);o.length&&(r.getWindow("giftSelection").openState||n||i._reset(),n=!0,i.setCharacterList(l.getCharacterList()),i._createGiftList(o,function(e){return e?console.error(new Error("Gifts module: "+e)):i._giftList.length?void(i.getCharaListMinusDeadPeople().length&&(r.open("giftSelection",i._giftList),n=!1)):console.error(new Error("Gifts module: _giftList is empty"))}))}var i=this,n=!1;window.dofus.connectionManager.on("StartupActionsListMessage",function(e){t(e.actions)}),window.dofus.connectionManager.on("StartupActionAddMessage",function(e){t([e.newAction])}),window.dofus.connectionManager.on("StartupActionFinishedMessage",function(e){return e.success?void(i._assigningGifts[e.actionId]?(i._assigningGifts[e.actionId]=!1,i.emit("giftAssigned",e)):(i._assigningGifts[e.actionId]=e.success,i.emit("giftAssignRequestResult",e))):(window.gui.openSimplePopup(u("tablet.gift.unableToAssign"),u("tablet.gift.unableToAssignTitle")),void i.emit("giftAssignFailed",e))})},n.prototype._createGiftList=function(e,t){for(var i=this,n=[],o=0,s=e.length;o<s;o+=1)for(var r=e[o],l=r.items,c=0,u=l.length;c<u;c+=1){var d=l[c];d&&n.push(d)}a.createItemInstances(n,function(n,o){if(n)return t(n);for(var s=0,a=0,r=e.length;a<r;a+=1){for(var l=e[a],c=[],u=l.items,d=0,h=u.length;d<h;d+=1){var p=o.array[s]||null;s+=1,p&&c.push(p)}c.length&&i._giftList.push({uid:l.uid,title:l.title,text:l.text,items:c})}t()})},n.prototype._reset=function(){this._characterList=[],this._charaListMinusDeadPeople=[],this._giftList=[],this._assigningGifts={},this._autoAssign=!1,this._toaRetryPending=[]},n.prototype.getCharacterList=function(){return this._characterList},n.prototype.getCharaListMinusDeadPeople=function(){return this._charaListMinusDeadPeople},n.prototype.setCharacterList=function(e){this._characterList=e,this._charaListMinusDeadPeople=[];var t=window.gui.playerData.characterBaseInformations;if(t.id)for(var i=0,n=e.length;i<n;i+=1){var o=e[i];t.id===o.id&&(o.deathState&&0!==o.deathState||this._charaListMinusDeadPeople.push(o))}},n.prototype.assignGift=function(e,t){window.dofus.sendMessage("StartupActionsObjetAttributionMessage",{actionId:e,characterId:t})},n.prototype.setAutoAssign=function(e){this._autoAssign=e},n.prototype.getToaRetryPendingUid=function(){return this._toaRetryPending},n.prototype.assignPendingToaRetry=function(e){if(!this._toaRetryPending.length)return console.error(new Error("Pending retry are empty "+e)),!1;var t=this._toaRetryPending.indexOf(e);return t===-1?(console.error(new Error("No pending retry "+e)),!1):(this.assignGift(e,window.gui.playerData.id),this._toaRetryPending.splice(t,1),!0)}},function(e,t,i){function n(){this._panels=null,this._currentPanelType=null,this._selectedSlot=null,this._panelLoadingCb={},this._currentCharacterId=null,this.isOrganizing=!1,_.call(this,{backDrawerSize:u.SHORTCUT_GAUGE_SIZE}),this._createDom(),this._setupEvents(),this.openPanel("spell")}function o(e,t){for(var i=0;i<e.length;i++){var n=e[i];n.enableContextMenu(t)}}function s(e,t){var i=e.getShortcutHash(),n=t[i];if(n){if(n.indexOf(e)!==-1)return}else n=t[i]=[];e.exclusiveSelector=A("shortcutSlots"),e.exclusiveSelector.register(e),n.push(e)}function a(e,t){var i=e.getShortcutHash(),n=t[i];if(n){var o=n.indexOf(e);o!==-1&&n.splice(o,1)}e.exclusiveSelector&&(e.exclusiveSelector.unregister(e),delete e.exclusiveSelector)}function r(e){for(var t=0;t<e.length;t++){var i=e[t];i.exclusiveSelector&&(i.exclusiveSelector.unregister(i),delete i.exclusiveSelector)}}i(826);var l=i(827),c=i(246),u=i(184),d=i(183).dimensions,h=i(252),p=i(383),m=i(190),f=i(29).getText,g=i(191).inherits,_=i(742),v=i(828),y=i(611),b=i(459),w=i(248),M=i(227),T=i(235),C=i(271),I=i(258).playUiSound,A=i(816).getExclusiveSelectorByGroup,S=i(830),E=i(831),x=i(837),L=i(269),N={};N[l.GENERAL_SHORTCUT_BAR]="item",N[l.SPELL_SHORTCUT_BAR]="spell";var O={item:l.GENERAL_SHORTCUT_BAR,spell:l.SPELL_SHORTCUT_BAR},D=u.SHORTCUT_ICON_SIZE,R=30,P=3;g(n,_),e.exports=n,n.prototype._createDom=function(){function e(e){t._pagination.setCurrent(e)}var t=this;this.addClassNames("ShortcutBar"),this._panelBox=this.content.createChild("div",{className:"panelBox"}),this._panels={spell:this._panelBox.appendChild(this._createPanel("spell")),item:this._panelBox.appendChild(this._createPanel("item"))},this._buttonBox=this.content.createChild("div",{className:"buttonBox"}),this.spellBtn=this._buttonBox.appendChild(new c({className:"spellBtn",tooltip:f("ui.charcrea.spells"),sound:"BANNER_SPELL_TAB"},function(){t.openPanel("spell")})),this.itemBtn=this._buttonBox.appendChild(new c({className:"itemBtn",tooltip:f("ui.common.objects"),sound:"BANNER_SPELL_TAB"},function(){t.openPanel("item")})),this._pagination=this._buttonBox.appendChild(new v({disableInput:!0,soundPrev:"SCROLL_DOWN",soundNext:"SCROLL_UP"})),this._pagination.setPageCount(P),this._pagination.setCurrent(0),this._pagination.on("next",function(){t._panels[t._currentPanelType].openTab(this.current+1)}),this._pagination.on("previous",function(){t._panels[t._currentPanelType].openTab(this.current-1)}),this._panels.spell.on("openTab",e),this._panels.item.on("openTab",e),this._organizeBtn=this._buttonBox.appendChild(new c({className:"lockBtn",scaleOnPress:!0},function(){t._setOrganizeMode(!t.isOrganizing)})),this._trashZone=this.createChild("div",{className:"trashZone"}),this._trashZone.createChild("div",{className:"trashBin",text:f("ui.common.remove")}),p.setDroppable(this._trashZone,["shortcutBar"],{isDropAllowed:function(){return t.isOrganizing}}),this._trashZone.on("drop",function(e){t._removeShortcutFromSlotRequestWith1Animation(e)}),this.on("open",function(){I("WINDOW_OPEN")}),this.on("close",function(){I("WINDOW_CLOSE"),this.isOrganizing&&this._setOrganizeMode(!1)})},n.prototype._createPanel=function(e){var t=new y({noHeader:!0});t.slotList=new Array(R*P),t.slotMap={};for(var i="spell"===e?x:E,n=0;n<P;n++){var o=new T("div",{className:"page"});t.addTab("",o,n);for(var s=0;s<R;s++){var a=n*R+s,r=new i(this,a);t.slotList[a]=r,o.appendChild(r),this._positionSlot(r)}}return t.openTab(0),t},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=t.playerData.characters,n=i.mainCharacter,o=t.playerData.inventory;t.on("disconnect",function(){e.close(),e.delClassNames("dragging"),e._selectedSlot=null,e._emptyPanel("spell"),e._emptyPanel("item"),e._currentCharacterId=null,C.removeAllListeners("ShortcutBarAddErrorMessage"),C.removeAllListeners("ShortcutBarRemoveErrorMessage"),C.removeAllListeners("ShortcutBarSwapErrorMessage")}),C.on("ShortcutBarContentMessage",function(t){for(var n=N[t.barType],o=[],s=0;s<t.shortcuts.length;s++)o.push(new S(t.shortcuts[s]));"spell"===n&&i.getControlledCharacter().setSpellShortcuts(o),e._setPanelContentRequest(n,o)}),C.on("ShortcutBarRefreshMessage",function(t){var n=N[t.barType],o=new S(t.shortcut);e._isSlotIndexValid(o.slotIndex)&&("spell"===n&&i.getControlledCharacter().updateSpellShortcut(o),e._setShortcutClient(o))}),C.on("ShortcutBarRemovedMessage",function(t){var i=N[t.barType];e._removeShortcutClient(i,t.slot)}),i.on("switchControlledCharacter",function(){var t=i.getControlledCharacter();t.spellShortcuts?e._setPanelContentRequest("spell",t.spellShortcuts):e._emptyPanel("spell")}),n.on("weaponChanged",function(){e._currentCharacterId===this.spellData.characterId&&e._updateWeaponSpell()}),o.on("itemsDeleted",this._disableItems.bind(this)),o.on("itemDeleted",this._disableItem.bind(this)),o.on("itemsQuantity",this._updateItemsQuantity.bind(this)),o.on("itemQuantity",this._updateItemQuantity.bind(this)),o.on("itemModified",this._updateModifiedItem.bind(this)),t.fightManager.on("fightEnterPreparation",this._fightPreparation.bind(this)),t.fightManager.on("fightEnterBattle",this._fightEntered.bind(this)),t.fightManager.on("fightEnd",this._fightExited.bind(this)),t.playerData.on("actionPointsCurrentUpdated",this.updateSpellsAvailability.bind(this)),t.fightManager.on("UpdatePreFightersList",this.updateSpellsAvailability.bind(this)),t.fightManager.on("TurnCountUpdated",this.updateSpellsAvailability.bind(this)),t.fightManager.on("updateSpellsAvailability",this.updateSpellsAvailability.bind(this));var s=A("shortcutSlots");s.on("selectionChanged",function(t){t instanceof x||t instanceof E?e._selectedSlot=t:null===t&&(e._selectedSlot=null)})},n.prototype._isSlotIndexValid=function(e){return e<R*P},n.prototype._isShortcutValid=function(e){return e instanceof S&&this._isSlotIndexValid(e.slotIndex)},n.prototype.getSlotForTuto=function(e,t){var i=this._panels[e];if(i)return i.slotList[t]},n.prototype._updateItemQuantity=function(e,t){var i=this._panels.item.slotMap["item"+e];if(i)for(var n=0;n<i.length;n++)i[n].setQuantity(t)},n.prototype._updateItemsQuantity=function(e){for(var t in e)this._updateItemQuantity(t,e[t])},n.prototype._disableItem=function(e){var t=this._panels.item.slotMap["item"+e];if(t)for(var i=0;i<t.length;i++){var n=t[i];n.icon.addClassNames("disabled"),n.isDisabled=!0}},n.prototype._disableItems=function(e){for(var t=0;t<e.length;t++)this._disableItem(e[t])},n.prototype._updateModifiedItem=function(e){var t=this._panels.item.slotMap["item"+e.objectUID];if(t)for(var i=0;i<t.length;i++)t[i].refreshShortcut()},n.prototype._updateSpellSlotAvailability=function(e){if("spell"===e.type){var t;if(L.isFightMode&&!e.isEmpty()){var i=e.shortcut.spellId;e.isDisabled=!window.gui.fightManager.canCastThisSpell(i),t=window.gui.fightManager.getSpellCooldown(i)}else e.isDisabled=!1,t=0;e.isDisabled&&this._unSelectSlot(e),e.icon.toggleClassName("disabled",e.isDisabled),e.setCooldown(t)}},n.prototype.updateSpellAvailability=function(e){if(this._currentCharacterId===window.gui.playerData.characters.controlledCharacterId){var t=this._panels.spell.slotMap["spell"+e];if(t)for(var i=0;i<t.length;i++)this._updateSpellSlotAvailability(t[i])}},n.prototype.updateSpellsAvailability=function(){if(this._currentCharacterId===window.gui.playerData.characters.controlledCharacterId)for(var e=this._panels.spell.slotList,t=0;t<e.length;t++){var i=e[t];i.isEmpty()||this._updateSpellSlotAvailability(i)}},n.prototype.setAvailability=function(e){this.overlay?this.overlay.toggleDisplay(!e):this.overlay=this.content.createChild("div",{className:"overlay",hidden:!e}),this.lockDrawer(!e)},n.prototype.computeBestSize=function(e,t){var i;return"narrow"===t?(i=u.ICONBAR_TAB_WIDTH+u.ICONBAR_CORNER_WIDTH,this._iconsVisiblePerLine=~~((e-i)/D),this._iconsVisiblePerLine*D+i):(i=u.ICONBAR_TAB_HEIGHT,this._iconsVisiblePerColumn=~~((e-i)/D),this._iconsVisiblePerColumn*D+i)},n.prototype._setPlaceHolder=function(e,t){for(var i=this._panels[e],n=i.slotList,o=0,s=t.length;o<s;o+=1){var a=t[o];this._isSlotIndexValid(a.slotIndex)&&(n[a.slotIndex].isEmpty()?n[a.slotIndex].setImage(b.placeHolder):console.error(new Error("ShortcutBar._setPlaceHolder: cannot change image of non empty slot")))}},n.prototype._resize=function(){var e,t,i=this._panels.spell,n=this._panels.item;window.gui.ipadRatio?(this.setStyles({top:"",right:"",left:d.posShortcutBar+"px",bottom:"0px",width:d.shortcutBarSize+"px",height:d.bottomBarHeight+"px"}),e=d.shortcutBarSize-75,this._columns=Math.floor(e/D),this._lines=Math.ceil(R/this._columns),t=this._lines*D+8,this.setOpeningSide("top"),i.setSwipeDirection("horizontal"),n.setSwipeDirection("horizontal"),this._trashZone.setStyle("width",e+"px"),this._buttonBox.appendChild(this._organizeBtn),this._buttonBox.appendChild(this._pagination),this._pagination.setDirection("horizontal")):(this.setStyles({bottom:"",left:"",right:"0px",top:d.posShortcutBar+"px",width:d.sideBarWidth+"px",height:d.shortcutBarSize+"px"}),t=d.shortcutBarSize-29,this._lines=Math.floor(t/D),this._columns=Math.ceil(R/this._lines),e=this._columns*D+13+30,this.setOpeningSide("left"),i.setSwipeDirection("vertical"),n.setSwipeDirection("vertical"),this._trashZone.setStyle("height",t+"px"),this._panelBox.appendChild(this._organizeBtn),this._panelBox.appendChild(this._pagination),this._pagination.setDirection("vertical")),this._panelBox.setStyles({width:e+"px",height:t+"px"});for(var o=i.slotList,s=n.slotList,a=0;a<o.length;a++)this._positionSlot(o[a]),this._positionSlot(s[a])},n.prototype._positionSlot=function(e){var t,i,n,o,s=e.slotIndex,a=s%R;window.gui.ipadRatio?(t=a%this._columns,i=Math.floor(a/this._columns),n=t*D,o=i*D):(t=a%this._lines,i=Math.floor(a/this._lines),n=i*D,o=t*D),e.x=n,e.y=o,e.setStyles({left:n+"px",top:o+"px",webkitTransform:""})},n.prototype._enableSlotContextMenus=function(e){o(this._panels.item.slotList,e),o(this._panels.spell.slotList,e)},n.prototype.showTrash=function(){this.addClassNames("dragging")},n.prototype.hideTrash=function(){this.delClassNames("dragging")},n.prototype._setShortcutRequest=function(e){if(!this._isShortcutValid(e))return console.error(new Error("ShortcutBar._setShortcutRequest: invalid shortcut"));var t=this,i=e.getShortcutBarPanelType(),n=this._panels[i],o=e.slotIndex,s=n.slotList[o],a=s.shorcut;this._setShortcutClient(e),C.removeAllListeners("ShortcutBarAddErrorMessage"),C.once("ShortcutBarAddErrorMessage",function(){s.isEmpty()?t._removeShortcutClient(i,o):t._setShortcutClient(a)}),window.dofus.sendMessage("ShortcutBarAddRequestMessage",{barType:O[s.type],shortcut:e.serialize()})},n.prototype._setShortcutClient=function(e){if(!this._isShortcutValid(e))return console.error(new Error("ShortcutBar._setShortcutClient: invalid shortcut"));var t=e.getShortcutBarPanelType(),i=this._panels[t],n=i.slotList[e.slotIndex];n.setStyles({webkitTransform:"scale(1)",opacity:1}),n.getShortcutHash()!==e.getHash()&&(this._selectedSlot===n&&this._unSelectSlot(n),a(n,i.slotMap),n.setShortcut(e),s(n,i.slotMap),w.enableTooltip(n,!n.isEmpty()&&!this.isOrganizing),this.isOrganizing?n.enableDrag():n.disableDrag())},n.prototype._removeShortcutFromSlotRequestWith1Animation=function(e){this._removeShortcutRequest(e.type,e.slotIndex),e.setStyles({webkitTransform:"scale(0)",opacity:1}),h.forceReflow(e),M.tween(e,{webkitTransform:"scale(1)"},{time:100,easing:"ease-out"})},n.prototype._removeShortcutFromSlotRequestWith2Animations=function(e){var t=this;h.forceReflow(e),M.tween(e,{opacity:0},{time:100,easing:"ease-out"},function(){t._removeShortcutFromSlotRequestWith1Animation(e)})},n.prototype._removeShortcutRequest=function(e,t){var i=this,n=this._panels[e],o=n.slotList[t],s=o.shortcut,a=O[o.type];this._removeShortcutClient(e,t),C.removeAllListeners("ShortcutBarRemoveErrorMessage"),C.once("ShortcutBarRemoveErrorMessage",function(){i._setShortcutClient(s)}),window.dofus.sendMessage("ShortcutBarRemoveRequestMessage",{barType:a,slot:t})},n.prototype._removeShortcutClient=function(e,t){if(this._isSlotIndexValid(t)){var i=this._panels[e],n=i.slotList[t];n.isEmpty()||(a(n,i.slotMap),this._selectedSlot===n&&this._unSelectSlot(n),n.unset(),n.disableDrag())}},n.prototype._fightPreparation=function(){this.openPanel("item")},n.prototype._fightEntered=function(){this.openPanel("spell"),this._enableSlotContextMenus(!1),this._setSpellsSlotsDraggability(!0)},n.prototype._fightExited=function(){this.openPanel("item"),this._enableSlotContextMenus(!0),this._setSpellsSlotsDraggability(this.isOrganizing),this._unSelectSlot(this._selectedSlot)},n.prototype.openPanel=function(e){var t="spell"===e?"item":"spell";this._currentPanelType=e;var i=this._panels[e];i.show(),this._panels[t].hide(),this.replaceClassNames([t],[e]),this._pagination.setCurrent(i.currentTab.id)},n.prototype._emptyPanel=function(e){var t=this._panels[e],i=t.slotList;r(i),t.slotMap={};for(var n=0;n<i.length;n++){var o=i[n];o.isEmpty()?o.image&&o.setImage():o.unset()}this._cancelPanelLoadingCb(e)},n.prototype._setPanelContent=function(e,t){var i=this,n=window.gui.playerData.characters.getControlledCharacter();this._cancelPanelLoadingCb(e);var o=i._panels[e],l=o.slotList;r(l);var c,u,d=o.slotMap={},h=new Array(l.length);for(c=0;c<t.length;c++)u=t[c],this._isSlotIndexValid(u.slotIndex)&&(h[u.slotIndex]=u);for(c=0;c<l.length;c++){u=h[c];var p=l[c];u?(p.isEmpty()||p.getShortcutHash()!==u.getHash())&&(p.setShortcut(u),s(p,d)):p.isEmpty()||(p.unset(),a(p,d))}"spell"===e&&(this._currentCharacterId=n.spellData.characterId,this.updateSpellsAvailability())},n.prototype._setPanelContentRequest=function(e,t){var i,n=window.gui.playerData.characters.getControlledCharacter();if(this._emptyPanel(e),"spell"===e?(this._currentCharacterId=null,i=n.spellData):i=window.gui.playerData.inventory,i.isLoaded)this._setPanelContent(e,t);else{this._setPlaceHolder(e,t);var o=this._setPanelContent.bind(this,e,t);this._panelLoadingCb[e]=o,i.once("loaded",o)}},n.prototype._cancelPanelLoadingCb=function(e){if(this._panelLoadingCb[e]){var t=window.gui.playerData.characters.getControlledCharacter(),i="spell"===e?t.spellData:window.gui.playerData.inventory;i.removeListener("loaded",this._panelLoadingCb[e]),delete this._panelLoadingCb[e]}},n.prototype._setItemsSlotsDraggability=function(e){for(var t=this._panels.item.slotList,i=0;i<t.length;i++)t[i].setDraggability(e&&!t[i].isEmpty())},n.prototype._setSpellsSlotsDraggability=function(e){for(var t=this._panels.spell.slotList,i=0;i<t.length;i++)t[i].setDraggability(e&&!t[i].isEmpty())},n.prototype._selectSlot=function(e,t){if(!this.isOrganizing){if(t&&window.isoEngine.clearSpellDisplay(),this._selectedSlot===e)return this._unSelectSlot(e);if(this._selectedSlot&&this._selectedSlot.unselect(),e.isEmpty())return void(this._selectedSlot=null);this._selectedSlot=e,e.select(),window.gui.fightManager.isInBattle()&&this._close(!0)}},n.prototype._unSelectSlot=function(e){e&&this._selectedSlot===e&&(this._selectedSlot.unselect(),this._selectedSlot=null)},n.prototype.deselectCurrentSlot=function(){this._unSelectSlot(this._selectedSlot)},n.prototype.getIdOfSelectedSpellIfAny=function(){var e=this._selectedSlot;return!e||"spell"!==e.type||e.isEmpty()?null:e.shortcut.spellId},n.prototype._updateWeaponSpell=function(){var e=window.gui.playerData.characters.mainCharacter.spellData.spells[b.WEAPON_SPELL_ID];if(!e)return console.warn("the player weapon spell has not been created yet");var t=this._panels.spell.slotMap["spell"+b.WEAPON_SPELL_ID];if(t)for(var i=0;i<t.length;i++)t[i].setSpell(e)},n.prototype._swapSlots=function(e,t){var i=this;if(e.type!==t.type)return console.error(new Error("Impossible to swap a slot from panel "+e.type+" and panel "+t.type));var n=this._panels[e.type];if((!window.gui.fightManager.isInBattle()||this.isOrganizing)&&this._dragStartPage===this._pagination.current){if(e.slotIndex===t.slotIndex)return t.setStyle("webkitTransform","translate3d(0,0,0)");C.removeAllListeners("ShortcutBarSwapErrorMessage");var o=t.slotIndex,s=t.getParent(),a=t.x-e.x,r=t.y-e.y;t.slotIndex=e.slotIndex,n.slotList[t.slotIndex]=e.getParent().appendChild(t),this._positionSlot(t),e.slotIndex=o,n.slotList[e.slotIndex]=s.appendChild(e),M.tween(e,{webkitTransform:"translate3d("+a+"px,"+r+"px,0)"},{time:100,easing:"ease-out"},function(){i._positionSlot(e),window.dofus.sendMessage("ShortcutBarSwapRequestMessage",{barType:O[t.type],firstSlot:t.slotIndex,secondSlot:e.slotIndex})}),C.once("ShortcutBarSwapErrorMessage",function(){var n=t.slotIndex;t.slotIndex=e.slotIndex,e.slotIndex=n,i._positionSlot(t),i._positionSlot(e)})}},n.prototype._onDropOnSlot=function(e,t,i,n){switch(i){case"shortcutBar":this._swapSlots(e,t);break;case"characterBox":case"equipment":var o=t.itemInstance;this._setShortcutRequest(new S({_type:"ShortcutObjectItem",slot:e.slotIndex,itemUID:o.objectUID,itemGID:o.objectGID}));break;case"presets":this._setShortcutRequest(new S({_type:"ShortcutObjectPreset",slot:e.slotIndex,presetId:t.preset.presetId}));break;case"spellsWindow":this._setShortcutRequest(new S({_type:"ShortcutSpell",slot:e.slotIndex,spellId:n.spellId}));break;case"attitude":this._setShortcutRequest(new S({_type:"ShortcutEmote",slot:e.slotIndex,emoteId:n.id}));break;case"smiley":this._setShortcutRequest(new S({_type:"ShortcutSmiley",slot:e.slotIndex,smileyId:n.id}))}},n.prototype._setOrganizeMode=function(e){var t=window.gui.playerData.characters.isMainCharacterControlled();if(!e||"spell"!==this._currentPanelType||t)if(this._tempToolbarResize||(this._tempToolbarResize={active:!1,previousPanel:null}),this.isOrganizing=e,this.toggleClassName("draggable",this.isOrganizing),this._setItemsSlotsDraggability(this.isOrganizing),this._setSpellsSlotsDraggability(this.isOrganizing),this.isOrganizing){this.spellBtn.disable(),this.itemBtn.disable();var i="spell"===this._currentPanelType,n=m.menubarSizeInFight!==m.menubarSize,o=i!==window.gui.playerData.isFighting;if(n&&o){this._tempToolbarResize.active=!0,this._tempToolbarResize.previousPanel=i?"spell":"item",this.shouldKeepOpen=!0;
var s=i?"tablet.nowShowingFightToolbar":"tablet.nowShowingRpToolbar";w.showNotification(f(s),this),window.gui.showFightingToolbar(i)}}else this.spellBtn.enable(),this.itemBtn.enable(),this._tempToolbarResize.active?(this.shouldKeepOpen=!1,"spell"===this._tempToolbarResize.previousPanel?window.gui.resizeToolbarForRoleplay():window.gui.resizeToolbarForFight(),this._tempToolbarResize.active=!1,this._tempToolbarResize.previousPanel=null):this.close()}},function(e,t){},function(e,t){e.exports={GENERAL_SHORTCUT_BAR:0,SPELL_SHORTCUT_BAR:1}},function(e,t,i){function n(e,t,i){var n=new l({className:["arrow",e],repeatDelay:c,sound:i},function(){t.emit(e)});return t.appendChild(n)}function o(e){r.call(this,"div",{className:"PaginationUI"}),e=e||{},this._leftArrow=n("previous",this,e.soundPrev),this._centeringContainer=this.createChild("div",{className:"centeringContainer"});var t=this._numberInputBox=this._centeringContainer.appendChild(new a);this.isInputDisabled=!!e.disableInput,t.setReadonly(this.isInputDisabled);var i=this;t.on("change",function(e){i.emit("page",e-1)}),this._pageCountLabel=this._centeringContainer.createChild("div",{className:"pageCount"}),this._rightArrow=n("next",this,e.soundNext)}i(829);var s=i(191).inherits,a=i(388),r=i(235),l=i(246),c=200;s(o,r),o.prototype.setDirection=function(e){this.toggleClassName("vertical","vertical"===e)},o.prototype._checkPosition=function(){this._leftArrow.setEnable(0!==this.current),this._rightArrow.setEnable(this.current<this._pageCount-1);var e=this._pageCount<=1||this.isInputDisabled;this._numberInputBox.setReadonly(e),this._centeringContainer.toggleClassName("readOnly",e)},o.prototype.setCurrent=function(e){this.current=e,this._numberInputBox.setValue(e+1),this._checkPosition()},o.prototype.setPageCount=function(e){this._numberInputBox.maxValue=e,this._pageCount=e,this._pageCountLabel.setText("/ "+e),this._checkPosition()},e.exports=o},function(e,t){},function(e,t){function i(e){if(!e)return console.error(new Error("Shortcut: cannot create a new shortcut without data"));if(!e._type||!n[e._type])return console.error(new Error("Shortcut: type "+e._type+" is invalid"));if(void 0===e.slot||null===e.slot)return console.error(new Error("Shortcut: invalid slot "+e.slot));this._type=e._type,this.slotIndex=e.slot;for(var t=n[e._type],i=0;i<t.length;i++){if(void 0===e[t[i]]||null===e[t[i]])return console.error(new Error("Shortcut ("+e._type+"): invalid "+t[i]+" :"+e[t[i]]));this[t[i]]=e[t[i]]}}var n={ShortcutSpell:["spellId"],ShortcutObjectItem:["itemGID","itemUID"],ShortcutObjectPreset:["presetId"],ShortcutEmote:["emoteId"],ShortcutSmiley:["smileyId"]};e.exports=i,i.prototype.serialize=function(){var e={};e._type=this._type,e.slot=this.slotIndex;for(var t=n[this._type],i=0;i<t.length;i++)e[t[i]]=this[t[i]];return e},i.prototype.getHash=function(){switch(this._type){case"ShortcutSpell":return"spell"+this.spellId;case"ShortcutObjectItem":return"item"+this.itemUID;case"ShortcutObjectPreset":return"preset"+this.presetId;case"ShortcutEmote":return"emote"+this.emoteId;case"ShortcutSmiley":return"smiley"+this.smileyId;default:return null}},i.prototype.isHandled=function(){return null!==this.getHash()},i.prototype.getShortcutBarPanelType=function(){switch(this._type){case"ShortcutSpell":return"spell";case"ShortcutObjectItem":case"ShortcutObjectPreset":case"ShortcutEmote":case"ShortcutSmiley":return"item";default:return null}}},function(e,t,i){function n(e,t){r.call(this,{scaleOnPress:!0}),this.type="item",l.constructor.call(this,e,t),this.on("doubletap",this._doubleTapHandler)}var o=i(202),s=i(191).inherits,a=i(509),r=i(832),l=i(836);s(n,r),e.exports=n,n.prototype.setShortcut=function(e){var t=this;if(!this._isShortcutValid(e))return!this.isEmpty()&&this.unset();var i=window.gui.playerData.inventory;if(this.shortcut=e,e.hasOwnProperty("presetId")){this.icon.delClassNames("disabled"),this.isDisabled=!1,this.setQuantity(1);var n=i.presets[e.presetId];o.preloadImage("gfx/presets/icon_"+n.symbolId+".png",function(e){t.setImage(e)}),this.setData(n),this.setContextMenu("preset",{presetId:e.presetId,canRemove:!0,onClose:this._onContextualMenuClosed.bind(this)})}else if(e.hasOwnProperty("emoteId"))this.icon.delClassNames("disabled"),this.isDisabled=!1,this.setQuantity(1),this.setData({emoteId:e.emoteId}),this.setContextMenu("emote",{emoteId:e.emoteId,canRemove:!0,onClose:this._onContextualMenuClosed.bind(this)}),o.preloadImage("gfx/emotes/"+e.emoteId+".png",function(e){t.setImage(e)});else if(e.hasOwnProperty("smileyId")){this.icon.delClassNames("disabled"),this.isDisabled=!1,this.setQuantity(1),this.setData({smileyId:e.smileyId}),this.setContextMenu("smiley",{smileyId:e.smileyId,canRemove:!0,onClose:this._onContextualMenuClosed.bind(this)});var s=window.gui.databases.Smileys;o.preloadImage("gfx/smilies/"+s[e.smileyId].gfxId+".png",function(e){t.setImage(e)})}else{var r=i.objects[e.itemUID];if(r){if(!r.isInitialised)return r.once("initialised",function(){t.setShortcut(e)});this.isDisabled=!1,this.icon.delClassNames("disabled"),this.setContextMenu("item",{item:r,onClose:this._onContextualMenuClosed.bind(this),remove:!0,enableActions:!0,enableDestroy:!0}),this.setItem(r)}else this.isDisabled=!0,this.icon.addClassNames("disabled"),a.getItems([e.itemGID],function(e,i){if(e)return console.error(e);var n=i[0];t.setContextMenu("item",{item:n,onClose:t._onContextualMenuClosed.bind(t),remove:!0,enableActions:!0,enableDestroy:!0}),t.setItem(n)})}},n.prototype._doubleTapHandler=function(){if(this.shortcut)switch(this.shortcut._type){case"ShortcutObjectItem":var e=this.getItem();e.isItemInstance&&e.doDefaultAction();break;case"ShortcutEmote":window.dofus.sendMessage("EmotePlayRequestMessage",{emoteId:this.shortcut.emoteId});break;case"ShortcutSmiley":window.dofus.sendMessage("ChatSmileyRequestMessage",{smileyId:this.shortcut.smileyId});break;case"ShortcutObjectPreset":window.dofus.sendMessage("InventoryPresetUseMessage",{presetId:this.shortcut.presetId})}},l.appendPrototypeTo(n)},function(e,t,i){function n(e){e=e||{},o.call(this,e),this.addClassNames("ItemSlot"),this.itemTypeStyle="",this.descriptionOptions=e.descriptionOptions||{},this.setItem(e.itemData,e.quantity)}i(833);var o=i(834),s=i(588),a=i(191).inherits,r=i(202),l=0,c=[1,9,10,11,16,17,81,26,78];a(n,o),e.exports=n,n.prototype._getContextualMenuProperties=function(){return this._contextMenuParams.item=this.data,o.prototype._getContextualMenuProperties.call(this)},n.prototype.setItem=function(e,t){if(!e)return this.unset();this.toggleClassName("cosmeticSlot",e.isCosmetic()),this._itemData=e,this.itemInstance=e.getItemInstance(),this.dbItem=e.getItem();var i=e.getProperty("image");if(!i&&e.isItemInstance&&!e.isInitialised){var n=this;e.once("initialised",function(){n._itemData===e&&(n.setImage(e.getProperty("image")),n.toggleClassName("cosmeticSlot",e.isCosmetic()))})}t=t||e.getProperty("quantity")||1,this.setImage(i),this.setQuantity(t),this.setTooltip(this._getTooltipContent),this.setData(e)},n.prototype.getItem=function(){return this._itemData},n.prototype.unset=function(){o.prototype.unset.call(this),this._itemData=null,this.itemInstance=null,this.dbItem=null},n.prototype.lock=function(){var e=this;this.unset(),r.preloadImage("ui/slots/tx_slotLockedimg.png",function(t){e.setImage(t)})},n.prototype._getTooltipContent=function(){return new s(this._itemData,this.descriptionOptions)},n.prototype.setBackgroundImageByItemType=function(e){c.indexOf(e)===-1&&(e=l);var t="itemType"+e;this.replaceClassNames([this.itemTypeStyle],[t]),this.itemTypeStyle=t}},function(e,t){},function(e,t,i){function n(e){e=e||{},r.call(this,"div",{className:"Slot",name:e.name||""}),a(this,e.noDoubleTap?{doubletapTimeout:1}:null),this._quantity=0,e.errorIcon&&(this.errorIcon=this.createChild("div",{className:"errorIcon"})),this.icon=this.createChild("div",{className:"slotIcon"}),this.iconBorder=this.createChild("div",{className:"slotIconBorder"}),this.quantityBox=this.createChild("div",{className:"quantity"}),this.forceQuantity=e.forceQuantity,e.quantity&&this.setQuantity(e.quantity),e.image&&this.setImage(e.image),this.tooltipOptions=e.tooltipOptions,e.tooltip&&this.setTooltip(e.tooltip,this.tooltipOptions),this.on("destroy",this._onDestroy),this.on("tap",this._openContextMenu),this.on("tooltipOn",this._removeHoverStyle),this.on("tooltipOut",this._applyHoverStyle),e.scaleOnPress&&(this.on("tapstart",this._showAsPressed),this.on("tapend",this._showAsReleased)),this.enableContextMenu(!e.hasOwnProperty("enableContextMenu")||e.enableContextMenu)}i(835);var o=i(248),s=i(191).inherits,a=i(228),r=i(235),l=i(202);s(n,r),e.exports=n,n.prototype._onDestroy=function(){this.destroyed=!0},n.prototype._openContextMenu=function(){this._contextMenuId&&this.isContextEnabled&&window.gui.openContextualMenuAround(this._contextMenuId,this,this._getContextualMenuProperties())},n.prototype._showAsPressed=function(){this.data&&this.icon.setStyle("webkitTransform","scale(0.9)")},n.prototype._showAsReleased=function(){this.icon.setStyle("webkitTransform","scale(1)")},n.prototype._removeHoverStyle=function(){this.icon.setStyle("webkitTransform","scale(1.1)")},n.prototype._applyHoverStyle=function(){this.icon.setStyle("webkitTransform","scale(1)")},n.prototype._getContextualMenuProperties=function(){return this._contextMenuParams},n.prototype.unset=function(){o.enableTooltip(this,!1),this.quantityBox.hide(),this.setContextMenu(),this.setImage(),this.setData(),this.emit("unset")},n.prototype.setQuantity=function(e){this._quantity=e,this.quantityBox.setText(e),this.quantityBox.toggleDisplay(!!this.forceQuantity||e&&e>1)},n.prototype.getQuantity=function(){return this._quantity},n.prototype.select=function(e){var t=e&&e.extraStyle?e.extraStyle:null;t!==this.extraStyle&&(this.extraStyle&&this.delClassNames(this.extraStyle),t&&this.addClassNames(t),this.extraStyle=t),this.selected||(this.selected=!0,this.addClassNames("selected"),this.emit("selected"))},n.prototype.unselect=function(){this.extraStyle&&this.delClassNames(this.extraStyle),this.delClassNames("selected"),this.selected=!1,this.emit("unselected")},n.prototype.setImage=function(e){return this.rootElement?(this.image=e,e=e||"none",this.icon.setStyle("backgroundImage",e),this.loadingImage=!1,this.requestedImages=null,void this.emit("setImage",this.image)):console.warn("trying to set an image on a destroyed object")},n.prototype.getImage=function(){return this.image},n.prototype.setTooltip=function(e,t){return this.hasTooltip?void o.enableTooltip(this,!0):(o.addTooltip(this,e,t||this.tooltipOptions),void(this.hasTooltip=!0))},n.prototype.setContextMenu=function(e,t){this._contextMenuId=e,this._contextMenuParams=t},n.prototype.setData=function(e){if(this.data=e,this.data){if(this.data.mountLocation)for(var t=this.data.effectList||[],i=0,n=t.length;i<n;i+=1){var o=t[i];o.effectCaller||(o.effectCaller="Slot: mount "+this.data.model+" from location "+this.data.mountLocation)}this.emit("setData",this.data)}},n.prototype.preloadAndSetImages=function(e){e=e||[],this.requestedImages=e;var t=this;this.loadingImage=!0,l.preloadImages(e,function(i){if(t.requestedImages===e&&!this.destroyed){for(var n="none",o=0;o<i.length&&(n=i[o],"none"===n);o+=1);t.loadingImage&&t.setImage(n)}})},n.prototype.enableContextMenu=function(e){this.isContextEnabled=!arguments.length||e}},function(e,t){},function(e,t,i){var n=i(383),o=i(830),s={prototype:{}};s.appendPrototypeTo=function(e){for(var t in s.prototype){if(e.prototype[t])return console.error("ShortcutBarSlot: class "+e.name+' already has a method called "'+t+'"');e.prototype[t]=s.prototype[t]}};var a={item:["shortcutBar","equipment","presets","characterBox","attitude","smiley"],spell:["shortcutBar","spellsWindow"]};e.exports=s,s.constructor=function(e,t){var i=this;this.slotIndex=t,this.shortcutBar=e,this.shortcut=null,this.isDisabled=!1,this._addDraggableBehaviour(),this._addDroppableBehaviour(),this.addClassNames("empty","ShortcutSlot","vibrate","anim"+Math.round(9*Math.random())),this.on("unset",function(){i.shortcut=null,i.isDisabled=!1,n.disableDrag(i),i.icon.delClassNames("disabled"),i.addClassNames("empty"),e._selectedSlot===i&&e._unSelectSlot(i)}),this.on("setData",function(){i.delClassNames("empty"),e._selectedSlot===i&&e._unSelectSlot(i)}),this.on("dragStart",function(){e._dragStartPage=e._pagination.current,e.isOrganizing&&e.showTrash(),"spell"===i.type&&window.gui.fightManager.isInBattle()&&!e.isOrganizing&&(i.selected||e._selectSlot(i,!1),i.customScale=1,i.customXOffset=0,i.customYOffset=-24,i.customRotation=45)}),this.on("dragEnd",function(t,n){e.hideTrash(),"spell"===i.type&&window.gui.fightManager.isInBattle()&&!e.isOrganizing&&(window.background.dragCellRelease(t,n,i),window.foreground.confirmBox.isOpen||e._unSelectSlot(i),i.customScale=null,i.customXOffset=null,i.customYOffset=null,i.customRotation=null)}),this.on("drop",function(t,n,o){e._onDropOnSlot(i,t,n,o)}),this.on("tap",function(){if(!("spell"===i.type&&i.isDisabled||"item"===i.type&&window.gui.fightManager.isInBattle())){var t=!0;e._selectSlot(i,t)}})},s.prototype._addDraggableBehaviour=function(){var e=null,t="shortcutBar",i=null,o={dragOnTouchstart:!1,dragElement:!0,noHover:!0};n.setDraggable(this,e,t,i,o),n.setDragEnable(this,!1)},s.prototype._addDroppableBehaviour=function(){var e=a[this.type],t={matchPositionOnDrop:!0,isDropAllowed:this._isDropAllowed.bind(this)};n.setDroppable(this,e,t)},s.prototype._isDropAllowed=function(e,t,i){return!window.gui.fightManager.isInBattle()||(!!this.shortcutBar.isOrganizing||("shortcutBar"!==i||!t||"spell"!==t.type))},s.prototype._onContextualMenuClosed=function(e){this.shortcutBar._unSelectSlot(this),"remove"===e&&this.shortcutBar._removeShortcutFromSlotRequestWith2Animations(this)},s.prototype.enableDrag=function(){this.setDraggability(!0)},s.prototype.disableDrag=function(){this.setDraggability(!1)},s.prototype.setDraggability=function(e){this.isEmpty()?e=!1:!e&&"spell"===this.type&&window.gui.fightManager.isInBattle()&&(e=!0),n.setDragEnable(this,e)},s.prototype._isShortcutValid=function(e){return e&&e instanceof o&&e.isHandled()},s.prototype.isEmpty=function(){return!this.shortcut},s.prototype.getShortcutHash=function(){return this.shortcut?this.shortcut.getHash():null},s.prototype.refreshShortcut=function(){this.setShortcut(this.shortcut)}},function(e,t,i){function n(e,t){s.call(this,{scaleOnPress:!0}),this.type="spell",this.delayedSetShortcutData=null,a.constructor.call(this,e,t);var i=this;this.on("dragMove",function(t,n){window.gui.fightManager.isInBattle()&&!e.isOrganizing&&window.background.colorCurrentDragCell(t,n,i)}),this.on("selected",function(){i.isEmpty()||window.gui.emit("spellSlotSelected",i.shortcut.spellId)}),this.on("unselected",function(){window.gui.emit("spellSlotDeselected")}),window.gui.on("disconnect",function(){i._resetDelayedSetShortcut()})}var o=i(191).inherits,s=i(838),a=i(836);o(n,s),e.exports=n,n.prototype._resetDelayedSetShortcut=function(){if(this.delayedSetShortcutData){var e=this.delayedSetShortcutData.character;e&&e.spellData&&(e.spellData.removeListener("loaded",this.delayedSetShortcutData.cb),this.delayedSetShortcutData=null)}},n.prototype.setShortcut=function(e){if(this._resetDelayedSetShortcut(),!this._isShortcutValid(e))return!this.isEmpty()&&this.unset();var t=window.gui.playerData.characters.getControlledCharacter(),i=t.spellData.spells[e.spellId];return this.shortcut=e,i?(this.setSpell(i),void this.setContextMenu("spell",{spell:i,canRemove:!0,onClose:this._onContextualMenuClosed.bind(this)})):(this.delayedSetShortcutData={shortcut:e,character:t,cb:this.setShortcut.bind(this,e)},t.spellData.once("loaded",this.delayedSetShortcutData.cb))},a.appendPrototypeTo(n)},function(e,t,i){function n(e){e=e||{},o.call(this,e),this.addClassNames("SpellSlot"),this.setSpell(e.spellData,e.descriptionOptions),this.customScale=null,this.customXOffset=null,this.customYOffset=null,this.customRotation=null,this._setSpellCount=0}i(839);var o=i(834),s=i(459),a=i(840),r=i(191).inherits,l=i(202);r(n,o),e.exports=n,n.prototype.setSpell=function(e,t){if(this.descriptionOptions=t||this.descriptionOptions,!e)return this.unset();var i=++this._setSpellCount,n=this.spellInstance=e._uid?e:null,o=this.dbSpell=n?n.spell:e,a=this;if(n&&n.isItem){var r=n._item;if(!r.isInitialised)return r.once("initialised",function(){a._setSpellCount===i&&a.setSpell(e)});this.setImage(r.getProperty("image"))}else o.image?this.setImage(o.image):(this.setImage(s.placeHolder),o.iconId<0&&console.error(new Error("iconId < 0 for spellId "+o.id+": "+o.iconId)),l.preloadImage("gfx/spells/sort_"+o.iconId+".png",function(e){a._setSpellCount===i&&(o.image=e,a.setImage(o.image))}));this.setTooltip(this._getTooltipContent),this.setData(e)},n.prototype._getTooltipContent=function(){return new a({spell:this.spellInstance||this.dbSpell},this.descriptionOptions)},n.prototype.setCooldown=function(e){this.quantityBox.setText(e),this.quantityBox.toggleDisplay(e>0)}},function(e,t){},function(e,t,i){function n(e,t){if(t=t||{},A.call(this,"div",t),this.addClassNames("SpellDescription"),this._buildDomElements(t),this.visibilityBoundToOptions=!t.visibilityOptions&&!t.spellTooltipAll,this.visibilityOptions=t.visibilityOptions||{},t.spellTooltipAll)for(var i in x)this.visibilityOptions[i]=!0;this.updateVisibleBlocks(!0),this.updateUI(e)}function o(e){this._domElements.spellName.setText(e.getName())}function s(e,t){var i=e.getProperty("apCost",t),n=e.getProperty("minRange",t),o=e.getProperty("range",t);this._domElements.points.ap.setText(C("ui.common.ap")+C("ui.common.colon")+i),this._domElements.points.ra.setText(C("ui.common.ra")+C("ui.common.colon")+n),o!==n?this._domElements.points.range.setText(" - "+o):this._domElements.points.range.clearContent()}function a(e,t){var i=e.getProperty("criticalHitProbability",t);i>0?this._domElements.criticalHit.setText(C("ui.common.short.CriticalHit")+C("ui.common.colon")+"1/"+i):this._domElements.criticalHit.clearContent()}function r(e,t){var i=e.getProperty("criticalHitProbability",t),n=0,o=window.gui.playerData.characters.getControlledCharacter().characteristics;o&&(n=E.totalCriticalHitRate(i,o)),i>0&&n>0&&this._domElements.criticalHit.isVisible()?this._domElements.criticalReal.setText(C("ui.itemtooltip.itemCriticalReal","1/"+n)):this._domElements.criticalReal.clearContent()}function l(e){var t=e.getHumanReadableZoneInfo();t.length?this._domElements.areaOfEffect.setText(C("ui.common.spellArea")+C("ui.common.colon")+t):this._domElements.areaOfEffect.setText(t)}function c(e,t){this._domElements.level.setText(C("ui.common.level")+" "+e.getProperty("grade",t))}function u(e,t){0!==e.getProperty("typeId",t)?this._domElements.breed.setText(C("ui.common.breedSpell")+C("ui.common.colon")+e.getHumanReadableSpellType()):this._domElements.breed.clearContent()}function d(e,t){e.getProperty("rangeCanBeBoosted",t)?this._domElements.rangeBoost.setText(C("ui.spell.rangeBoost")):this._domElements.rangeBoost.clearContent()}function h(e,t){!e.getProperty("castTestLos",t)&&e.getProperty("range",t)?this._domElements.castWithoutLos.setText(C("ui.spellInfo.castWithoutLos")):this._domElements.castWithoutLos.clearContent()}function p(e,t){e.getProperty("castInLine",t)?this._domElements.castInLine.setText(C("ui.spellInfo.castInLine")):this._domElements.castInLine.clearContent()}function m(e,t){var i=e.getProperty("maxCastPerTurn",t);i>0?this._domElements.maxCastPerTurn.setText(C("ui.spellInfo.maxCastPerTurn")+C("ui.common.colon")+i):this._domElements.maxCastPerTurn.clearContent()}function f(e,t){var i=e.getProperty("maxCastPerTarget",t);i>0?this._domElements.maxCastPerTarget.setText(C("ui.spellInfo.maxCastPerTarget")+C("ui.common.colon")+i):this._domElements.maxCastPerTarget.clearContent()}function g(e,t){e.getProperty("maxStack",t)>0?this._domElements.maxStack.setText(C("ui.spellInfo.maxStack")+C("ui.common.colon")+e.getProperty("maxStack",t)):this._domElements.maxStack.clearContent()}function _(e,t){var i=e.getProperty("minCastInterval",t);i>0?this._domElements.minCastInterval.setText(C("ui.spellInfo.minCastInterval")+C("ui.common.colon")+i):this._domElements.minCastInterval.clearContent()}function v(e,t){e.getProperty("globalCooldown",t)===-1?this._domElements.globalCooldown.setText(C("ui.spellInfo.globalCastInterval")):this._domElements.globalCooldown.clearContent()}function y(e,t){var i=e.getProperty("statesForbidden",t);if(i&&i.length>0){this._domElements.forbiddenStates.createChild("span",{text:C("ui.spellInfo.stateForbidden")+C("ui.common.colon")});for(var n=0;n<i.length;n++)this._domElements.forbiddenStates.createChild("span",{text:" "+e._tables.spellStates[i[n]].nameId})}else this._domElements.forbiddenStates.clearContent()}function b(e,t){var i=e.getProperty("statesRequired",t);if(i&&i.length>0){this._domElements.requiredStates.createChild("span",{text:C("ui.spellInfo.stateRequired")+C("ui.common.colon")});for(var n=0;n<i.length;n++)this._domElements.requiredStates.createChild("span",{text:" "+e._tables.spellStates[i[n]].nameId})}else this._domElements.requiredStates.clearContent()}function w(e,t){this._domElements.effectsAndDamage.setEffectsFromSpell(e,t)}function M(e,t){this._domElements.description.setText(e.getProperty("descriptionId",t))}i(841);var T=i(590),C=i(29).getText,I=i(191).inherits,A=i(235),S=i(190),E=i(252),x={spellTooltipName:["spellName"],spellTooltipApRange:["pointsLine"],spellTooltipCritical:["criticalHit"],spellTooltipEffect:["areaOfEffect","level","breed","rangeBoost","castWithoutLos","castInLine","maxStack","maxCastPerTarget","maxCastPerTurn","minCastInterval","globalCooldown","forbiddenStates","requiredStates","effectsAndDamage"],spellTooltipDescription:["description"]};I(n,A),e.exports=n,n.prototype.updateVisibleBlocks=function(e){var t=this._domElements;for(var i in x){var n=this.visibilityOptions[i],o=this.visibilityBoundToOptions?S[i]:!!this.visibilityOptions[i];if(e||o!==n){this.visibilityOptions[i]=o;for(var s=x[i],a=0;a<s.length;a++)t[s[a]].toggleDisplay(o)}}},n.prototype._buildDomElements=function(e,t){var i=this._domElements={};i.spellName=this.createChild("div",{className:"spellName"}),i.pointsLine=this.createChild("div",{className:"pointsLine"}),i.points={ap:i.pointsLine.createChild("span",{className:"ap"}),ra:i.pointsLine.createChild("span",{className:"ra"}),range:i.pointsLine.createChild("span")},i.criticalReal=this.createChild("div"),i.criticalHit=this.createChild("div"),i.areaOfEffect=this.createChild("div"),i.level=this.createChild("div"),i.breed=this.createChild("div"),i.rangeBoost=this.createChild("div"),i.castWithoutLos=this.createChild("div"),i.castInLine=this.createChild("div"),i.maxStack=this.createChild("div"),i.maxCastPerTarget=this.createChild("div"),i.maxCastPerTurn=this.createChild("div"),i.minCastInterval=this.createChild("div"),i.globalCooldown=this.createChild("div"),i.forbiddenStates=this.createChild("div"),i.requiredStates=this.createChild("div"),i.effectsAndDamage=this.appendChild(new T(t)),i.description=this.createChild("div",{className:"description"})},n.prototype.updateUI=function(e){if(e&&e.spell&&e.spell.isLoaded){this.updateVisibleBlocks();var t=e.spell,i=void 0!==e.level?e.level:t.level;o.call(this,t),s.call(this,t,i),a.call(this,t,i),r.call(this,t,i),l.call(this,t),c.call(this,t,i),u.call(this,t,i),d.call(this,t,i),h.call(this,t,i),p.call(this,t,i),m.call(this,t,i),f.call(this,t,i),g.call(this,t,i),_.call(this,t,i),v.call(this,t,i),b.call(this,t,i),y.call(this,t,i),w.call(this,t,i),M.call(this,t,i)}}},function(e,t){},function(e,t,i){function n(e){return e?(h.call(this,"div",e),this.isAlive=!0,this.tweener=null,this.timeout=null,this.isLocked=e.isLocked,this.channel=e.channel,this.decodeAllPages=e.decodeAllPages,this.msgPages=null,this.currentPage=0,this._senderId=e.senderId,this._senderName=e.senderName,this._isNonChat=e.isNonChat||!1,this._createContent(e),this.closeFunc=this.close.bind(this),this.actionHandler=e.action,this.closeHandler=e.onClose,e.title&&this.setTitle(e.title),this._setContent(e.msg,e.objectItems),this.actor=e.actor,void(e.actor&&this.contentLength&&this._openNextToActor())):console.error(new Error("SpeechBubble: params is missing"))}function o(e,t){for(var i=0,n=null,o=0;o<t.length;o++){var s=e.lastIndexOf(t[o]);s>i&&(n=t[o],i=s)}return null===n?null:e.substr(0,i+n.length)}function s(e){for(var t,i=[],n=0,s="",a="";;){t=e.substr(n,w);var r=e.length-n;if(r<w)return i.push(a+t),i;var l=o(t,I);if(l&&r-l.length<w*M){var c=o(t.substr(0,r*T),I);c&&r-c.length<=w&&(l=c)}if(!l||l.length<w*M){var u=o(t,A);u&&u.length>=w*T&&(l=u,s=S),l||(l=t,s=S)}n+=l.length,i.push(a+l+s),a=s===S?S:"",s=""}}i(843);var a=i(252),r=i(678),l=i(191).inherits,c=i(228),u=i(248),d=i(227),h=i(235),p=250,m=150,f=150,g=150,_=.85,v=2e3,y=.6,b=150,w=450,M=.3,T=.6,C="",I=["\n",". ","... ","? ","! "],A=[" ",", ",": ","; "],S="...";l(n,h),e.exports=n,n.prototype._createContent=function(e){this.addClassNames("speechBubble"),this.isLocked&&this.addClassNames("frozen"),c(this,{doubletapTimeout:1}),this.on("tap",this._tapHandler),e.title&&(this.title=this.createChild("div",{className:"title"})),this.content=this.createChild("div",{className:"content"}),this.arrow=this.createChild("div"),e.channel&&this.addClassNames("channel"+e.channel)},n.prototype._resize=function(){var e=this.content,t=e.rootElement.clientWidth;if(t>m){var i=this.contentLength<f?m:p;e.setStyle("width",i+"px")}},n.prototype._setArrow=function(e){this.arrow.setClassNames("arrow");var t=e.angle;t>0?t>Math.PI/2?this.arrow.addClassNames("bottomLeft"):this.arrow.addClassNames("bottomRight"):t<-Math.PI/2?this.arrow.addClassNames("topLeft"):this.arrow.addClassNames("topRight")},n.prototype.setTitle=function(e){this.title.setText(e)},n.prototype._setPage=function(e){this.content.appendChild(r.process(e,{objectItems:this.objectItems,channel:this.channel,decodeAllPages:this.decodeAllPages,senderId:this._senderId,senderName:this._senderName,isNonChat:this._isNonChat})),this.contentLength=e.length},n.prototype._setContent=function(e,t){if(this.objectItems=t,"string"==typeof e)e.length>w&&(this.nextBtn=this.createChild("div",{className:"nextBtn"}),this.msgPages=s(e),this.currentPage=0,e=this.msgPages[0]+C),this._setPage(e);else{if(!(e instanceof h))return console.error(new Error("SpeechBubble: unknown msg type ("+typeof e+")"));this.content.appendChild(e),this.contentLength=e.rootElement.innerText.length}},n.prototype._displayNextPage=function(){return!!this.msgPages&&(!(this.currentPage>=this.msgPages.length-1)&&(d.tween(this,{opacity:0},{time:b},function(){if(this.isAlive){this.currentPage++,this.currentPage===this.msgPages.length-1&&this.nextBtn.hide();var e=this.msgPages[this.currentPage]+C;this.content.setStyle("width",null),this.content.clearContent(),this._setPage(e),this._resize(),this._findPosition(),a.forceReflow(this),d.tween(this,{opacity:1},{time:g})}}),!0))},n.prototype._openNextToActor=function(){this.setStyle("opacity",0),window.gui.gameGuiContainer.appendChild(this),this._resize();var e=window.isoEngine.mapScene.camera;e.emitAtDestination?e.once("atDestination",this._findPositionAppearAndListen.bind(this)):this._findPositionAppearAndListen()},n.prototype._findPositionAppearAndListen=function(){this.isAlive&&(this._findPosition(),this._appearAndListen())},n.prototype._findPosition=function(){var e=window.gui.boxArranger;this.box&&e.removeBox(this.box);var t=this.box=window.gui.boxArranger.addBoxNextToActor(this.actor,this);this.setStyles({left:t.x+"px",top:t.y+"px"}),this._setArrow(t)},n.prototype._appearAndListen=function(){window.gui.on("disconnect",this.closeFunc),this.isLocked||window.isoEngine.on("mapLoaded",this.closeFunc);var e=this.isLocked||this.msgPages,t=e?1:_;this.tweener=d.tween(this,{opacity:t},{time:g},function(){if(!e){var t=u.computeNotificationDisplayTime(this.contentLength);this.timeout=window.setTimeout(function(e){e._dimBeforeDisappearing()},t,this)}})},n.prototype._dimBeforeDisappearing=function(){this.tweener=d.tween(this,{opacity:y},{time:400},this._disappearLater)},n.prototype._disappearLater=function(){this.timeout=window.setTimeout(this.closeFunc,v)},n.prototype._tapHandler=function(){if(!this._displayNextPage()){if(this.isLocked){if(!this.actionHandler)return;return this.actionHandler()}return this.msgPages?this.close():this.tweener||this.timeout?void this._freeze():this.close()}},n.prototype._freeze=function(){this.addClassNames("frozen"),this.setStyle("opacity",1),this.tweener.cancel(),this.tweener=null,this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null),window.foreground.on("dom.touchend",this.closeFunc)},n.prototype.close=function(e){e&&e.isReload||this.isAlive&&(this.isAlive=!1,this.setEnable(!1),this.tweener&&this.tweener.cancel(),window.clearTimeout(this.timeout),window.isoEngine.removeListener("mapLoaded",this.closeFunc),window.foreground.removeListener("dom.touchend",this.closeFunc),window.gui.removeListener("disconnect",this.closeFunc),this.closeHandler&&this.closeHandler(),window.gui.boxArranger.removeBox(this.box),d.tween(this,{opacity:0},{time:b},this.destroy))}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"Timeline",hidden:!0}),this._createContent(),this.statsDetails=null,this.currentFighter=null,this.selectedFighter=null,this.isCollapsed=!1,this._registerListeners(window.gui),this.timerTimestamp=null,this.timerDuration=null,this.timerTween=null,this._previousFighter=null}i(845);var o=i(191).inherits,s=i(190),a=i(235),r=i(658),l=i(846),c=i(848),u=i(248).addTooltip,d=i(29).getText,h=i(395),p=i(483),m=i(227),f=i(383),g=i(410),_=55,v=45,y=0;o(n,a),e.exports=n,n.prototype._registerListeners=function(e){function t(e,t,i){t||(t=[],e.length>0&&t.push(e[0]));for(var n=a.getAvailableFighters(),o=0,s=t.length;o<s;o++){var r=t[o],l=n[r];l&&i(l)}}function i(e,i){t(e,i,function(e){o.unsetTurnOf(e),o.onOrderFightersSwitched(),s.hideDeadFighters&&o.refreshTimeline()})}function n(e){e.refreshHP(),e.refreshShield()}var o=this,a=e.fightManager;a.on("GameFightTurnEnd",function(e){var t=this.getFighter(e);t&&t.data.alive&&o.unsetTurnOf(t)}),a.on("FightersListUpdated",function(){o.refreshTimeline()}),a.on("UpdatePreFightersList",function(){o.refreshTimeline()}),a.on("GameFightTurnStart",function(e,t){var i=this.getFighter(e);i&&i.data.alive&&o.setTurnOf(i,t)}),a.on(h.FIGHTER_DEATH,i),a.on(h.FIGHTER_LEAVE,i),a.on("FoldAll",function(){}),a.on("BuffAdd",function(e,t){n(t),o._refreshAfterResize()}),a.on("BuffDispell",function(e){n(e)}),a.on("BuffRemove",function(e,t){n(t),o._refreshAfterResize()}),a.on("BuffUpdate",function(e,t){n(t)}),a.on("TurnCountUpdated",function(e){o.turnCountLabel.setText(d("ui.fight.turnNumber",e+1))}),a.on("OrderFightersSwitched",function(){o.onOrderFightersSwitched()}),s.on("hideDeadFighters",function(){o.refreshTimeline()}),s.on("orderFighters",function(e){var t=a.getAvailableFighters();for(var i in t)t[i].picto.fighterNumber.toggleDisplay(e);o.refreshTimeline(),e||window.actorManager.allTurnNumbersOff()}),e.on("resize",function(e){y=Math.floor(.7*e.mapWidth)}),this.on("collapse",function(e){this.isCollapsed=e,this._refreshAfterResize()}),this.on("dragEnd",function(){this.fighterListScroller.refresh()})},n.prototype._createContent=function(){r(this,{isCollapsable:!0});var e=this.infoAndFighters=this.createChild("div",{className:"infoAndFighters"});this.fighterListContainer=e.createChild("div",{name:"fighterListContainer",className:"fighterListContainer"}),this.fighterListScroller=this.fighterListContainer.appendChild(new p({name:"fighterListScroller",className:"fighterList"},{isHorizontal:!0})),this.fighterList=this.fighterListScroller.content,this.infoContainer=e.createChild("div",{className:"infoContainer"}),this.turnCountLabel=this.infoContainer.createChild("div",{className:"turnCountLabel"}),this.fightControlButtons=this.infoContainer.appendChild(new l),this.fightControlButtons.on("TurnReadyPressed",function(){window.gui.fightManager.finishTurn()}),this.buffList=this.appendChild(new c);
},n.prototype.close=function(){this.currentFighter&&this.unsetTurnOf(this.currentFighter),this.selectedFighter=null,this.buffList.close(),this.hide(),this.fighterList.clearContent(),this.turnCountLabel.clearContent()},n.prototype.restoreFighterList=function(){this.infoAndFighters.insertAsFirstChild(this.fighterListContainer),this.restartTimerAnimation(),this.refreshTimeline()},n.prototype.appendFighterListTo=function(e){e.appendChild(this.fighterListContainer),this.restartTimerAnimation(),this.refreshTimeline()},n.prototype.refreshTimeline=function(){var e,t,i,n="fightPlacement"===window.foreground.tapOptions.mode,o=window.gui.fightManager,a=o.getFighters(),r=o.getDeadFighters(),l=o.getAvailableFighters(),c={},u=1;if(n){var d=this.fighterList.getChildren();for(i=0;i<d.length;i++)this.fighterList.removeChild(d[i])}var h,p=a.length,m=0;for(i=0;i<p;i++)if(e=a[i],c[e]=!0,t=l[e]){var f=r.indexOf(e)<0;if(t.setAlive(f,!0),(f||!s.hideDeadFighters)&&(t.updateNumber(f&&u++),m+=t.isSummon()?v:_,!this.fighterList.getChild(e))){h=null;for(var g=i+1;g<p&&!(h=this.fighterList.getChild(a[g]));g++);this.fighterList.insertChildBefore(t.picto,h),t.resizeFighterIllustration()}}else console.error(new Error("Fighter "+e+" not found when refreshing timeline during fight state "+o.fightState));if(!n)for(e in l)if(!c[e]){var b=this.fighterList.getChild(e);b&&this.fighterList.removeChild(b)}m=Math.min(m,y),this.fighterListContainer.setStyle("width",m+"px"),this._refreshAfterResize()},n.prototype._refreshAfterResize=function(){this.emit("resized"),this.fighterListScroller.refresh(),this.isCollapsed&&this.currentFighter&&this.fighterListScroller.showElement(this.currentFighter.picto)},n.prototype.onOrderFightersSwitched=function(){for(var e=this.fighterList.getChildren(),t=window.gui.fightManager,i=1,n=0,o=e.length;n<o;n++){var s=e[n].getWuiName(),a=t.getFighter(s);if(!a)return console.error("Fighters' order switch failed, fighter does not exist.");a.data.alive?(a.updateNumber(i),i++):a.updateNumber()}},n.prototype.linkToTimeline=function(e){var t=this;u(e.picto,function(){return t.statsDetails?e.refreshStatsTooltipContent(t.statsDetails):t.statsDetails=e.createStatsTooltipContent(),t.statsDetails}),e.picto.on("tap",function(){t.onFighterSelected(e)}),e.picto.on("tooltipOn",function(){t.onPressEntity(e,!1),window.isoEngine.displayEnemyMovementZone(e)}),e.picto.on("tooltipOut",function(){t.onReleaseEntity(),window.isoEngine.removeEnemyMovementZone()}),f.setDroppable(e.picto,["shortcutBar"]),e.picto.on("beforeDragEnd",function(){t.onFighterSelected(e)})},n.prototype.onFighterSelected=function(e){var t=window.gui.shortcutBar.getIdOfSelectedSpellIfAny();if(t||0===t){var i=window.gui,n=i.playerData.characters.controlledCharacterId;return void(e.data.alive&&i.fightManager.currentFighterId===n&&(window.dofus.sendMessage("GameActionFightCastOnTargetRequestMessage",{spellId:t,targetId:e.id}),i.fightManager.spellCastSucceeded(t,n),window.isoEngine.clearSpellDisplay(),i.shortcutBar.deselectCurrentSlot()))}if(this.selectedFighter){window.actorManager.selectionIndicatorOff(this.selectedFighter);var o=this.selectedFighter.picto;o&&o.rootElement&&o.delClassNames("selected")}this.selectedFighter===e?(this.selectedFighter=null,this.buffList.hide()):(window.actorManager.selectionIndicatorOn(e),e.picto.addClassNames("selected"),this.selectedFighter=e,this.buffList.open(e)),this._refreshAfterResize()},n.prototype.onPressEntity=function(e){e&&e.data.stats.invisibilityState!==g.INVISIBLE&&window.isoEngine.highlightActorOnAction(e.id,1e3)},n.prototype.onReleaseEntity=function(){window.isoEngine.clearHighlights()},n.prototype.restartTimerAnimation=function(){if(this.currentFighter&&this.timerTween){this.timerTween.cancel();var e=Date.now()-this.timerTimestamp;if(!(e<0||e>=this.timerDuration)){var t=this.timerDuration-e,i=Math.ceil(100*e/this.timerDuration);this.playTimerAnimation(t,i)}}},n.prototype.startTimerAnimation=function(e){this.timerTimestamp=Date.now(),this.timerDuration=e,this.playTimerAnimation(e,0)},n.prototype.stopTimerAnimation=function(){this.timerTimestamp=null,this.timerDuration=null,this.timerTween.cancel(),this.timerTween=null;var e=this.currentFighter.picto;e.delClassNames("current"),e.fighterTimeValue.setStyles({webkitTransition:"",webkitTransform:"translate3d(0,100%,0)"})},n.prototype.playTimerAnimation=function(e,t){var i=this.currentFighter.picto;i.fighterTimeValue.setStyle("webkitTransform","translate3d(0, "+(100-t)+"%, 0)"),this.timerTween=m.tween(i.fighterTimeValue,{webkitTransform:"translate3d(0, 0, 0)"},{time:e,easing:"linear"}),i.addClassNames("current"),this.isCollapsed&&this.fighterListScroller.showElement(i)},n.prototype.unsetTurnOf=function(e){this.currentFighter&&this.currentFighter===e&&(window.actorManager.turnIndicatorOff(e),this.stopTimerAnimation(),this.currentFighter=null)},n.prototype.setTurnOf=function(e,t){this.currentFighter&&this.unsetTurnOf(this.currentFighter),this.currentFighter=e,this.startTimerAnimation(t),this.emit("setTurnOf",e,t),this._previousFighter&&window.actorManager.turnIndicatorOff(this._previousFighter),window.actorManager.turnIndicatorOn(e),this._previousFighter=e}},function(e,t){},function(e,t,i){function n(){function e(e){c.show(),l._isReadyForFight=e,e?c.addClassNames("readyForFight"):c.delClassNames("readyForFight")}function t(){c.hide(),l.setTurnReadyButtonAvailability(!1),u.show()}function i(e){e&&!window.gui.playerData.characters.canControlCharacterId(e.id)||l.setTurnReadyButtonAvailability(!0)}function n(){l.setTurnReadyButtonAvailability(!1)}function o(){u.hide()}a.call(this,"div",{className:"fightControlButtons"});var l=this;this._isReadyForFight=!1;var c=this._fightReadyBtn=new r({text:s("ui.banner.ready"),className:"fightBtn",hidden:!0,scaleOnPress:!0},function(){l.toggleReadyForFight()});this.appendChild(c);var u=this._turnReadyBtn=new r({text:s("tablet.fight.option.nextTurn"),className:"fightBtn",hidden:!0,scaleOnPress:!0},function(){l.emit("TurnReadyPressed"),n()});this.appendChild(u),window.gui.on("GameFightJoinMessage",function(t){e(!1),t.canSayReady?c.enable():c.disable()}),window.gui.fightManager.on("playerReady",e),window.gui.on("GameFightStartMessage",t),window.gui.on("GameFightResumeMessage",t),window.gui.on("GameFightResumeWithSlavesMessage",t),window.gui.on("GameFightTurnStartPlayingMessage",function(){i(null)}),window.gui.on("GameFightTurnStartMessage",i),window.gui.on("GameFightTurnStartSlaveMessage",i),window.gui.on("GameFightTurnResumeMessage",i),window.gui.on("GameFightTurnEndMessage",n),window.gui.on("GameFightEndMessage",o),window.gui.on("disconnect",o)}i(847);var o=i(191).inherits,s=i(29).getText,a=i(235),r=i(246);o(n,a),e.exports=n,n.prototype.toggleReadyForFight=function(){window.dofus.sendMessage("GameFightReadyMessage",{isReady:!this._isReadyForFight})},n.prototype.isReadyForFightButtonVisible=function(){return this._fightReadyBtn.isVisible()},n.prototype.setTurnReadyButtonAvailability=function(e){var t=this._turnReadyBtn;e?t.enable():t.disable()},n.prototype.getButtonForTuto=function(e){var t;switch(e){case"fightReadyBtn":t=this._fightReadyBtn;break;case"turnReadyBtn":t=this._turnReadyBtn;break;default:return null}return t.isVisible()?t:null}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"FightBuffs"}),this.buffList=this.createChild("div",{className:"buffList"}),this.buffItems={},this._registerListeners(window.gui.fightManager),this.fighter=null,this.lastWasPlayer=!1,this.buffDescription=new l,this.hide()}i(849);var o=i(191).inherits,s=i(235),a=i(850),r=i(248).addTooltip,l=i(851);o(n,s),e.exports=n,n.prototype._registerListeners=function(e){var t=this;e.on("GameFightTurnStart",function(e){if(e===window.gui.playerData.id)t.lastWasPlayer=!0;else if(t.lastWasPlayer){for(var i=t.buffList.getChildren(),n=0;n<i.length;n++)i[n].updateCooldown();t.lastWasPlayer=!1}}),e.on("BuffUpdate",function(e,i){t.fighter===i&&t.updateBuff(e)}),e.on("BuffRemove",function(e,i){t.fighter===i&&t.removeBuff(e)}),e.on("BuffAdd",function(e,i){t.fighter===i&&(t._addBuff(e),t.updateUi())})},n.prototype.open=function(e){this.fighter!==e&&(this.clean(),this.fighter=e,this.makeItemBuffs(e),this.updateUi()),this.show()},n.prototype.close=function(){this.clean(),this.hide()},n.prototype.clean=function(){this.fighter=null,this.buffList.clearContent(),this.buffItems={}},n.prototype.makeItemBuffs=function(e){for(var t=e.buffs,i=0,n=t.length;i<n;i++)this._addBuff(t[i])};var c=function(e,t){return e.maxCooldown()-t.maxCooldown()};n.prototype.updateUi=function(){for(var e=[],t=[],i=this.buffList.getChildren(),n=0;n<i.length;n++){var o=i[n];0!==o.parentBoostUid?t.push(o):e.push(o)}for(e.sort(c),n=0;n<t.length;n++){for(var s=t[n],a=!1,r=0,l=0;l<e.length;l++)if(e[l].maxCooldown()<s.cooldown&&(r=l),e[l].hasUid(s.parentBoostUid)){e.splice(l+1,0,s),a=!0;break}a||e.splice(r,0,s)}for(n=0;n<e.length;n++){var u=e[n];this.buffList.appendChild(u)}},n.prototype._addBuff=function(e){function t(){for(var e=[],t=-1,i=0;i<n.buffs.length;i++){var s=n.buffs[i];e.push(s.effect),t=s.source}var a=window.gui.fightManager,r=a.getFighter(t);if(!r)return null;var c={};return c.spellName=n.spell.getName(),c.casterName=r.name,c.effects=e,o?o.updateUI(c):o=new l(c),o}if(!e.hidden){var i=a.getKey(e),n=this.buffItems[i];if(n)return void n.addBuff(e);n=new a(e);var o;r(n,t),this.buffItems[i]=n,this.buffList.appendChild(n),n.addBuff(e)}},n.prototype.updateBuff=function(e){var t=a.getKey(e),i=this.buffItems[t];if(i)i.updateCooldown(e),this.updateUi();else{var n=a.getDelayKey(e);if(i=this.buffItems[n],!i)return void console.warn("Trying to update a non-existing buff.");this.buffItems[t]=i,delete this.buffItems[n]}},n.prototype.removeBuff=function(e){this.removeBuffItem(e,a.getKey(e)),this.removeBuffItem(e,a.getDelayKey(e)),this.updateUi()},n.prototype.removeBuffItem=function(e,t){var i=this.buffItems[t];i&&(i.removeBuff(e),0===i.buffs.length&&(this.buffList.removeChild(i),i.destroy(),delete this.buffItems[t]))}},function(e,t){},function(e,t,i){function n(e){var t=window.gui.fightManager.getTurnCount();return e.effect.hasOwnProperty("delay")?t+e.effect.delay:t}function o(e){l.call(this,"div",{className:"BuffItem"});var t=e.castingSpell.spell.id,i=e.castingSpell.casterId,o=e.parentBoostUid,s=e.effect.hasOwnProperty("delay")&&e.effect.delay>0?n(e):-1;s>0?this.key=t+"#"+i+"#"+o+"#"+s:this.key=t+"#"+i+"#"+o,this.parentBoostUid=0,this.spell=e.castingSpell.spell;var a=this;this.spell.getIconUri&&c.preloadImage(this.spell.getIconUri(),function(e){a&&a.rootElement&&a.setStyle("backgroundImage",e)}),this.buffs=[],this.cooldownLabel=this.createChild("div",{className:"cooldown"}),this.setCooldown(0)}function s(e){return e.castingSpell.spell.id+"#"+e.castingSpell.casterId+"#"+e.parentBoostUid+"#"+n(e)}function a(e){return e.effect.hasOwnProperty("delay")&&e.effect.delay>0?s(e):e.castingSpell.spell.id+"#"+e.castingSpell.casterId+"#"+e.parentBoostUid}var r=i(191).inherits,l=i(235),c=i(202);r(o,l),e.exports=o,e.exports.getDelayKey=s,e.exports.getKey=a,o.prototype.hasUid=function(e){for(var t=0;t<this.buffs.length;t++)if(this.buffs[t].uid===e)return!0;return!1},o.prototype.addBuff=function(e){this.buffs.push(e),0!==e.parentBoostUid&&(this.parentBoostUid=e.parentBoostUid),this.updateCooldown()},o.prototype.isUnusableNextTurn=function(){for(var e=0;e<this.buffs.length;e++)if(!this.buffs[e].isUnusableNextTurn())return!1;return!0},o.prototype.updateCooldown=function(){for(var e=0,t=!1,i=0,n=0,o=this.buffs.length;n<o;n++){var s=this.buffs[n];t&&e!==s.duration&&this.setCooldown(this.cooldown-1),(0===i||s.effect.delay<i)&&(i=s.effect.delay),e=s.duration,t=!0}i>0?this.setCooldown(i):this.setCooldown(e),this.isUnusableNextTurn()&&this.addClassNames("disabled")},o.prototype.setCooldown=function(e){this.cooldown=e,e===-1?(this.cooldownLabel.setText("+"),this.cooldownLabel.show()):0===e||e===Number.MAX_VALUE?(this.cooldownLabel.setText(""),this.cooldownLabel.hide()):e<-1?(this.cooldownLabel.setText(""),this.cooldownLabel.show()):(this.cooldownLabel.setText(e),this.cooldownLabel.show())},o.prototype.maxCooldown=function(){if(this.cooldown!==-1)return this.cooldown;for(var e=0,t=0,i=this.buffs.length;t<i;t++){var n=this.buffs[t];(n.duration>e||n.duration<-1)&&(e=n.duration)}return e},o.prototype.removeBuff=function(e){for(var t=0;t<this.buffs.length;t++)if(this.buffs[t]===e){this.buffs.splice(t,1),this.updateCooldown();break}}},function(e,t,i){function n(e,t){u.call(this,"div",t),this.addClassNames("BuffDescription"),this._buildDomElements(t),this.updateUI(e)}function o(e){this._domElements.spellName.setText(e)}function s(e){this._domElements.casterName.setText(l("ui.fight.caster")+l("ui.common.colon")+e)}function a(e){this._domElements.effectsAndDamage.setEffects(e)}i(852);var r=i(590),l=i(29).getText,c=i(191).inherits,u=i(235);c(n,u),e.exports=n,n.prototype._buildDomElements=function(e,t){var i=this._domElements={};i.spellName=this.createChild("div",{className:"spellName"}),i.casterName=this.createChild("div",{className:"casterName"}),i.effectsAndDamage=this.appendChild(new r(t))},n.prototype.updateUI=function(e){if(e){var t=e.spellName,i=e.casterName,n=e.effects;o.call(this,t),s.call(this,i),a.call(this,n)}}},function(e,t){},function(e,t,i){function n(){u.call(this,"div",{className:"dropDown",hidden:!0});var e=this,t=this.createChild("div",{className:"dropDrownOverlay"});c(t),t.on("tap",function(){e.close()}),this.entryContainer=this.createChild("div",{className:"entryContainer"}),this.scroller=this.entryContainer.appendChild(new l({className:"entryList"},{showHintArrows:!0})),this.entryList=this.scroller.content,this._isOpen=!1,this.clearContent(),window.gui.on("disconnect",function(){e.clearContent(),e.close()})}function o(){var e=this.dropDown,t=this.action;e.close(),e._selectionFn(t.value,t.index)}i(854);var s=i(246),a=i(183).dimensions,r=i(191).inherits,l=i(483),c=i(228),u=i(235),d=30,h=15;r(n,u),e.exports=n,n.prototype.setupDropDown=function(e,t,i,n){var o=e.rootElement.getBoundingClientRect();return e===this._parentElt&&o.left===this._parentRect.left&&o.top===this._parentRect.top?this.open(i):(this._updateContent(t,n,e,o),void this._firstOpen(i))},n.prototype.clearContent=function(){this.entryList.clearContent(),this._parentElt=null,this._parentRect=null,this._selectionFn=null,this._entries=[],this._selectedIndex=-1},n.prototype._updateContent=function(e,t,i,n){this.clearContent();for(var o=0,s=e.length;o<s;o++){var a=e[o];if(!a.hidden){var r={index:o,value:a.value};a.disabled&&(r.disabled=!0),this._addEntry(a.text,r)}}this._entries=this.entryList.getChildren(),this._parentElt=i,this._parentRect=n,this._selectionFn=t},n.prototype.select=function(e){e>=this._entries.length||(this._selectedIndex!==-1&&this._entries[this._selectedIndex].delClassNames("ticked"),this._selectedIndex=e,this._entries[e].addClassNames("ticked"))},n.prototype.close=function(){this._isOpen&&(this.hide(),this._isOpen=!1)},n.prototype._firstOpen=function(e){this.setStyle("opacity",0),this.show(),this._refreshPositionAndSize(),this.open(e)},n.prototype.open=function(e){this.show(),void 0!==e&&(this.select(e),this._scrollToEntryIndex(e)),this._isOpen=!0,this.setStyle("opacity",1)},n.prototype._scrollToEntryIndex=function(e){return e<0||e>=this._entries.length?console.warn("Invalid dropdown index",e):void this.scroller.scrollToElement(this._entries[e],0)},n.prototype._refreshPositionAndSize=function(){var e=this._parentRect,t=e.left,i=e.width-d,n=e.bottom+1,o=a.screenHeight-h-n,s=this.entryList.rootElement.getBoundingClientRect();if(o<s.height&&e.top>.6*a.screenHeight){var r=e.top-5;o=Math.min(s.height,r-h),n=r-o}this.entryContainer.setStyles({left:t+"px",top:n+"px",minWidth:i+"px"}),this.scroller.setStyle("max-height",o+"px"),this.scroller.refresh()},n.prototype._addEntry=function(e,t){var i=this.entryList.appendChild(new s({text:e,className:"dropDownEntry"}));return t.disabled?void i.addClassNames("disabled"):(i.on("tap",o),i.dropDown=this,void(i.action=t))}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"Compass"}),this.markers={},this._withFlashyAnim=!0}i(856);var o=i(191).inherits,s=i(235),a=i(857),r=i(190),l=i(858),c=2,u={"-5,-1":-5,"-4,0":-4,"-3,1":-3,"-2,2":-2},d={X:0,Y:3};o(n,s),e.exports=n,n.arrowType={QUEST:4,PARTY:2},n.prototype.setFlashyAnimationEnabled=function(e){this._withFlashyAnim=e},n.prototype.addMarker=function(e){var t=e.type,i=!window.gui.playerData.isFighting,n=new l(this,t,e.arrowType,i,e.x,e.y,e.tooltip);return this.markers[t]=n,this.getDistance(e.x,e.y)},n.prototype.updateMarker=function(e,t,i,n){var o=this.markers[e];return o?void o.update(t,i,n):console.error("marker not found: "+e)},n.prototype.removeMarker=function(e){var t=this.markers[e];return t?(t.remove(),void delete this.markers[e]):console.error("marker not found: "+e)},n.prototype.setAllMarkersVisibility=function(e){for(var t in this.markers){var i=this.markers[t];i.setVisibility(e)}},n.prototype.renderAllMarkers=function(){r.autoGpsPhoenixes&&this._updatePhoenixMarkersVisibility();var e=[];for(var t in this.markers){var i=this.markers[t];i.prepareRendering(),i.isVisible()&&e.push(i)}a(e,l.sortFunction);for(var n=0;n<e.length;n++)e[n].render(this._withFlashyAnim)},n.prototype.showOrHidePhoenixMarkers=function(){if(!r.autoGpsPhoenixes)for(var e in this.markers){var t=this.markers[e];"phoenix"===t.getArrowType()&&t.setVisibility(!1)}this.renderAllMarkers()},n.prototype._updatePhoenixMarkersVisibility=function(){var e,t,i=[],n=1/0;for(e in this.markers)if(t=this.markers[e],"phoenix"===t.getArrowType()){t.setVisibility(!1);var o=t.getDistance();o<n?(n=o,i=[e]):o===n&&i.push(e)}for(var s=0;s<i.length;s++)t=this.markers[i[s]],t.setVisibility(!0)},n.prototype.getDistance=function(e,t){var i=window.gui.playerData.position.coordinates,n=e-i.posX,o=t-i.posY,s=Math.abs(n)+Math.abs(o),a=this.isInTutorialCorridor(e,t),r=this.isInTutorialCorridor(i.posX,i.posY);return a||r?a&&r?Math.abs(e-i.posX):a?i.posX>=d.X&&i.posY>=d.Y?Math.max(1,s+u[e+","+t]):Math.max(1,s-1):e>i.posX&&t>i.posY?Math.max(1,s+u[i.posX+","+i.posY]):Math.max(1,s-1):s},n.prototype.isInTutorialCorridor=function(e,t){return window.gui.playerData.position.worldmapId===c&&void 0!==u[e+","+t]}},function(e,t){},function(e,t){function i(e,t){this.value=e,this.originalValue=e,this.forceLeft=0,this.forceRight=0,this.left=t,this.right=null,t&&(t.right=this)}function n(e,t,n){if(!(e.length<2)){n=n||o,e.sort(t);var r,l=[],c=null,u=!0,d=null;for(r=0;r<e.length;r++)d=new i(e[r].getAngle(),d),l.push(d),c=c||d,u=u&&d.distance(c)<n;if(u){if(e[e.length-1].getAngle()-e[0].getAngle()>n){for(r=1;r<e.length;r++)if(e[r].getAngle()-e[0].getAngle()>n){l[r-1].right=null,l[r].left=null;break}l[0].left=d,d.right=l[0]}}else l[0].left=d,d.right=l[0];for(var h=1/0,p=s*e.length,m=0;h>p&&!(++m>=a);){for(h=0,r=0;r<l.length;r++)l[r].updateForces(n);for(r=0;r<l.length;r++)h+=l[r].updateValue()}for(r=0;r<e.length;r++)e[r].setCorrectedAngle(l[r].value)}}var o=.08,s=.001,a=1e3,r=1e-4,l=2*Math.PI;i.prototype.updateValue=function(){var e=this.forceLeft-this.forceRight;return this.value+=e,Math.abs(e)},i.prototype.distance=function(e){if(!e)return 1/0;var t=Math.abs(e.value-this.value);return Math.min(t,l-t)},i.prototype.updateForces=function(e){var t=this.distance(this.left),i=this.distance(this.right);this.forceLeft=t<e+r?(e-t)/2:0,this.forceRight=i<e+r?(e-i)/2:0},e.exports=n},function(e,t,i){function n(e,t,i,n,o,s,a){this._compass=e,this._id=t,this._arrowType=i,this._isVisible=n,this._x=o,this._y=s,this._tooltip=a,this._distance=0,this._angle=0,this._markerDom=null}var o=i(183).dimensions,s=i(859),a=s.transitions;e.exports=n,n.sortFunction=function(e,t){var i=e._angle-t._angle;return 0!==i?i:e._id>t._id?1:-1},n.prototype.getAngle=function(){return this._angle},n.prototype.setCorrectedAngle=function(e){this._angle=e},n.prototype.setVisibility=function(e){e!==this._isVisible&&(this._isVisible=e)},n.prototype.getDistance=function(){return this._compass.getDistance(this._x,this._y)},n.prototype.getArrowType=function(){return this._arrowType},n.prototype.isVisible=function(){return this._isVisible},n.prototype.update=function(e,t,i){this._x=e,this._y=t,i&&(this._tooltip=i)},n.prototype.remove=function(){this._markerDom&&(this._markerDom.disappear(),this._markerDom=null)},n.prototype.prepareRendering=function(){if(!this._isVisible)return void(this._markerDom&&this.remove());var e=window.gui.playerData.position.coordinates,t=this._x-e.posX,i=this._y-e.posY;this._distance=this._compass.getDistance(this._x,this._y),0===this._distance?this._angle=Math.atan2(-o.mapWidth,-o.mapHeight):this._angle=Math.atan2(i,t)},n.prototype.render=function(e){if(this._isVisible){var t=null;this._markerDom?t=a.MOVE:(this._markerDom=new s(this._compass,this._arrowType||this._id,this._tooltip),t=e?a.APPEAR_CENTER:a.APPEAR),this._markerDom.updateDisplay(this._angle,this._distance,t)}}},function(e,t,i){function n(e,t,i){c.call(this,"div",{className:"marker"}),this._compass=e,this._sameMapMarker=null,this._type=t,this._tooltipText=i,this._x=0,this._y=0,this._arrowAngle=void 0,this._distance=0,this._scalingDiv=null,this._markerArrow=null,this._markerNumber=null}var o=i(248).addTooltip,s=i(183).dimensions,a=i(252),r=i(191).inherits,l=i(227),c=i(235),u=50,d=5,h=50,p=300;r(n,c),e.exports=n,n.prototype._createDom=function(){this._scalingDiv=this.createChild("div"),this._markerArrow=this._scalingDiv.createChild("div",{className:["markerArrow","arrow_"+this._type]}),this._markerNumber=this._scalingDiv.createChild("div",{className:"markerNumber"}),window.foreground.handleTapAfter(this),o(this,this._tooltipText)},n.prototype._detachFromDom=function(){this._sameMapMarker?(window.gui.mapCoordinateDisplay.removeMarker(this._sameMapMarker),this._sameMapMarker=null):this._compass.removeChild(this)},n.prototype._attachToDom=function(){0===this._distance?this._sameMapMarker=window.gui.mapCoordinateDisplay.addMarker(this._type,this._tooltipText):this._compass.appendChild(this)},n.prototype.disappear=function(){var e=this;l.tween(this._scalingDiv,{webkitTransform:"scale(0.1)"},{time:p,easing:"ease-out"},function(){e._detachFromDom()})},n.prototype._startCenterAppearTransition=function(){var e=s.mapLeft+s.mapWidth/2-u/2,t=s.mapTop+s.mapHeight/2-u/2,i=.6,n=(this._x-e)*i+e,o=(this._y-t)*i+t;this.setStyles({zIndex:2e3,webkitTransform:this._getPositionTransform(n,o)}),this._scalingDiv.setStyles({webkitTransform:"scale("+d+")",opacity:0}),this._markerArrow.setStyle("webkitTransform",this._getArrowTransform()),this._updateDistanceLabel(),a.forceReflow(this);var r=this;l.tween(this._scalingDiv,{webkitTransform:this._getScalingTransform(),opacity:1},{time:p,easing:"ease-out"},function(){r._scalingDiv.setStyles({opacity:null}),r.setStyles({zIndex:null})}),this._doMoveTransition()},n.prototype._startAppearTransition=function(){this._appearByScalingUp()},n.prototype._startMoveTransition=function(){this._scalingDiv.setStyle("webkitTransform",this._getScalingTransform()),this._doMoveTransition(),l.tween(this._markerArrow,{webkitTransform:this._getArrowTransform()},{time:p,easing:"ease-out"})},n.prototype._doMoveTransition=function(){l.tween(this,{webkitTransform:this._getPositionTransform(this._x,this._y)},{time:p,easing:"ease-out"},function(){this._updateDistanceLabel()})},n.prototype._startWideMoveTransition=function(){this._disappearByScalingDown(this._appearByScalingUp.bind(this))},n.prototype._startAppearSameMapTransition=function(e){this._isOnSameMap=!0,e||this._disappearByScalingDown(this._continueAppearSameMapTransition.bind(this))},n.prototype._continueAppearSameMapTransition=function(){this._detachFromDom(),this._attachToDom()},n.prototype._startLeaveSameMapTransition=function(){this._isOnSameMap=!1,this._detachFromDom(),this._attachToDom(),this._appearByScalingUp()},n.prototype._disappearByScalingDown=function(e){l.tween(this._scalingDiv,{webkitTransform:"scale(0.1)"},{time:p,easing:"ease-out"},e)},n.prototype._appearByScalingUp=function(){this._updateDistanceLabel(),this._markerArrow.setStyle("webkitTransform",this._getArrowTransform()),this.setStyle("webkitTransform",this._getPositionTransform(this._x,this._y)),this._scalingDiv.setStyle("webkitTransform","scale(0.1)"),a.forceReflow(this._scalingDiv),l.tween(this._scalingDiv,{webkitTransform:this._getScalingTransform()},{time:p,easing:"ease-out"})},n.prototype._updateDistanceLabel=function(){this._markerNumber.setText(this._distance)},n.prototype._updatePositionAndAngle=function(e){var t=180*e/Math.PI,i=this._arrowAngle;this._arrowAngle=t;var n,o,a=s.mapWidth-u,r=s.mapHeight-u;t<=-34&&t>=-146?(n=(a-Math.tan(Math.PI/2-e)*r)/2,o=0):t>=34&&t<=146?(n=(a+Math.tan(Math.PI/2-e)*r)/2,o=r):t<34&&t>-34?(n=a,o=(r+Math.tan(e)*a)/2):(n=0,o=(r-Math.tan(e)*a)/2),this._x=s.mapLeft+n,this._y=s.mapTop+o;var l=(t-i+360)%360;return l>180&&(l-=360),l},n.prototype._getPositionTransform=function(e,t){return"translate3d("+e+"px,"+t+"px,0)"};var m=10,f=50,g=.5;n.prototype._getScalingTransform=function(){var e=f-m,t=Math.min(1,Math.max(0,this._distance-m)/e),i=Math.round(10*(1-t*(1-g)))/10;return 1!==i?"scale("+i+")":""},n.prototype._getArrowTransform=function(){return this._isOnSameMap?"":"rotate("+this._arrowAngle+"deg)"};var _=n.transitions={APPEAR_CENTER:1,APPEAR:2,MOVE:6};n.prototype.updateDisplay=function(e,t,i){var n=this._updatePositionAndAngle(e);this._distance=~~t;var o=!this._scalingDiv;if(o&&(this._createDom(),this._attachToDom()),0===this._distance){if(this._isOnSameMap)return;return this._startAppearSameMapTransition(o)}if(this._isOnSameMap)return this._startLeaveSameMapTransition();if(Math.abs(n)>=h)return this._startWideMoveTransition();switch(i){case _.APPEAR_CENTER:this._startCenterAppearTransition();break;case _.APPEAR:this._startAppearTransition();break;case _.MOVE:this._startMoveTransition();break;default:console.error("invalid transition: "+i)}}},function(e,t,i){function n(){s.call(this),this.inTutorial=void 0,this.isChangingMap=!1,this._inTutorialShop=!1}function o(e){window.gui.transmitMessage({_messageType:"_tutorialGameMapMovementMessage",actorId:e.actorId,isInFight:!0})}var s=i(194).EventEmitter,a=i(191).inherits,r=i(861),l=i(862),c=i(661),u=i(195),d=i(29).getText,h=i(225),p=i(7),m=i(271),f=16478;a(n,s),e.exports=n,n.prototype.initialize=function(e){var t=this;this.tutorialStep=new l,e.on("disconnect",function(){t.inTutorial=void 0,t.isChangingMap=!1,t._removeListeners(),t._inTutorialShop=!1}),e.playerData.position.on("mapUpdate",function(){var i=e.playerData.position.subArea,n=i&&i.id===r.QUEST_TUTORIAL_FIRST_SUB_AREA_ID;t.inTutorial!==n&&(t.inTutorial=n,t.inTutorial?window.isoEngine.mapRenderer.map?t._openTutorialStepWindow():window.isoEngine.once("mapLoaded",function(){t._openTutorialStepWindow()}):t._closeTutorialWindows()),t.inTutorial?window.gui.textNotification.hide():window.gui.textNotification.show(),t.isChangingMap=!1}),m.on("NpcDialogQuestionMessage",function(e){e.messageId===f&&t.startShopTutorial()})},n.prototype._openTutorialStepWindow=function(){this._registerListeners(),this.tutorialStep.start(),this.emit("inTutorialStateChanged",this.inTutorial)},n.prototype._closeTutorialWindows=function(){this._removeListeners(),this.tutorialStep.stop(),this.emit("inTutorialStateChanged",this.inTutorial)},n.prototype._registerListeners=function(){window.dofus.toggleTutorialListeners(!0),window.gui.on("GameMapMovementMessage",o)},n.prototype._removeListeners=function(){window.dofus.toggleTutorialListeners(!1),window.gui.removeListener("GameMapMovementMessage",o)},n.prototype._hasTutorial=function(){var e=window.gui.playerData.quests.finished;for(var t in e){var i=e[t];if(i.questId===r.QUEST_TUTORIAL_ID)return!1}return!0},n.prototype._hasValidLevel=function(){return window.gui.playerData.characterBaseInformations.level<=r.MAX_CHARACTER_LEVEL_FOR_TUTORIAL},n.prototype.isTutorialRequired=function(){var e=u.getValue("tutorialDone");if(e)return!1;for(var t=c.getCharacterList(),i=0;i<t.length;i++)if(t[i].level>r.MAX_CHARACTER_LEVEL_FOR_TUTORIAL)return u.setValue("tutorialDone",!0),!1;return!0},n.prototype.adminCommand=function(e){return e&&1===e.length&&"start"===e[0]?window.gui.tutorialManager.inTutorial?"You are already in the tutorial":(window.dofus.sendMessage("GuidedModeReturnRequestMessage"),"Done"):"Wrong parameter, allowed parameters: start"},n.prototype.SHOP_TUTO_ARTICLE_ID=r.SHOP_TUTO_ARTICLE_ID,n.prototype.SHOP_TUTO_QUEST_ID=r.SHOP_TUTO_QUEST_ID,n.prototype.openTheTutorialShop=function(){h.open("market",{isModal:!0,tabId:"shop",tabParams:{tutorialMode:!0}})},n.prototype.startShopTutorial=function(){this._inTutorialShop||p.log("Tuto.Shop.start",{},{wizAnalyticsOnly:!0}),this._inTutorialShop=!0;var e=window.gui.uiLocker;e.isFeatureLocked("market")||e.lockFeature("market","shopTutorial",d("tablet.tutorial.uiLocker.default")),window.gui.shopFloatingToolbar.startTutorial()},n.prototype.stopShopTutorial=function(){window.gui.uiLocker.unlockFeature("market","shopTutorial"),this._inTutorialShop=!1},n.prototype.isShopTutorial=function(){return this._inTutorialShop}},function(e,t){t.QUEST_TUTORIAL_ID=489,t.QUEST_TUTORIAL_FIRST_SUB_AREA_ID=536,t.SHOP_TUTO_QUEST_ID=1461,t.SHOP_TUTO_ARTICLE_ID=-777,t.TUTORIAL_MAP_ID_FIRST=81002496,t.TUTORIAL_MAP_ID_SECOND_BEFORE_FIGHT=81003520,t.TUTORIAL_MAP_ID_SECOND_AFTER_FIGHT=81003522,t.TUTORIAL_MAP_ID_THIRD_BEFORE_FIGHT=81004544,t.TUTORIAL_MAP_ID_THIRD_AFTER_FIGHT=81004546,t.MAX_CHARACTER_LEVEL_FOR_TUTORIAL=49,t.QUEST_TUTORIAL_REWARDS=[[10785,1],[10794,1],[10797,1],[10798,1],[10799,1],[10784,1],[10800,1],[10801,1],[10792,1],[10793,2],[10795,1],[10796,1]],t.FIRST_EQUIP_ITEMS=[10785],t.SECOND_EQUIP_ITEMS=[10784,10794,10797,10799,10800],t.TUTORIAL_STEP_TALK_NPC_ID=1222,t.TUTORIAL_FIRST_MONSTER_ID=2785,t.TUTORIAL_BOSS_MONSTER_ID=2781,t.TUTORIAL_STEP_ROLEPLAY_MOVE_CELL_ID=272,t.TUTORIAL_STEP_CHANGE_MAP_ARROW_CELL_ID=503,t.FIGHT_LOCATION_TARGET_CELLS=[232,216,229,270,313,328,316,274],t.FIGHT_MOVE_TARGET_CELLS={232:259,216:259,229:258,270:286,313:286,328:287,316:287,274:287},t.TUTORIAL_STEP_ROLEPLAY_MOVE=1,t.TUTORIAL_STEP_TALK=2,t.TUTORIAL_SUB_STEP_TALK_SHOW_NPC=1,t.TUTORIAL_SUB_STEP_TALK_SHOW_RESPONSE=2,t.TUTORIAL_STEP_EQUIP_ITEM=3,t.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_ITEM_MENU_ICON=1,t.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_TAB=2,t.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_EQUIPMENT=3,t.TUTORIAL_STEP_CHANGE_MAP=4,t.TUTORIAL_STEP_STARTING_A_FIGHT=5,t.TUTORIAL_STEP_FIGHT_LOCATION=6,t.TUTORIAL_STEP_FIGHT_MOVE=7,t.TUTORIAL_SUB_STEP_FIGHT_MOVE_START_FIGHT=1,t.TUTORIAL_STEP_FIGHT_CAST_SPELL=8,t.TUTORIAL_STEP_FIGHT_SKIP_TURN=9,t.TUTORIAL_STEP_FIGHT_WIN=10,t.TUTORIAL_STEP_START_QUEST=11,t.TUTORIAL_STEP_EQUIP_ALL_ITEMS=12,t.TUTORIAL_STEP_FIND_BOSS=13,t.TUTORIAL_STEP_KILL_BOSS=14,t.TUTORIAL_STEP_SUCCESS_QUEST=15},function(e,t,i){function n(e,t){var i={};for(var n in t){var o=t[n].objectGID;e.indexOf(o)!==-1&&(i[o]=!0)}return Object.keys(i).length===e.length}function o(){var e=u.QUEST_TUTORIAL_ID,t=window.gui.playerData.quests||{},i=t.active||{},n=i[e];if(!n)return null;var o=n.stepId;return{quest:n,currentStepId:o,currentStep:n.dbSteps[o],currentStepCount:n.dbQuest.stepIds.indexOf(o)+1}}function s(){this.initialized=!1,this.quest=null,this.currentStepId=null,this.currentStep=null,this.currentStepCount=null,this.currentSubStepCount=null,this.tutorialPopup=null}function a(){window.gui.tutorialManager.isChangingMap=!0,window.isoEngine.addArrowOnCell(u.TUTORIAL_STEP_CHANGE_MAP_ARROW_CELL_ID,0,0,"upLeft")}var r=i(383),l=i(680),c=i(678),u=i(861),d=i(225),h=i(863),p=i(7),m=i(199),f=i(195),g=i(29).getText,_=0;e.exports=s,s.prototype.start=function(){this.initialized||(this._setupHandlerFunctions(),this._setupListeners(),this.initialized=!0),window.gui.playerData.quests.initialized?this._requestQuestStatus():window.gui.playerData.quests.once("listUpdated",this._requestQuestStatus),this.tutorialPopup=new h,this.tutorialPopup.open()},s.prototype._requestQuestStatus=function(){window.dofus.sendMessage("QuestStepInfoRequestMessage",{
questId:u.QUEST_TUTORIAL_ID})},s.prototype.stop=function(){this.tutorialPopup&&this.tutorialPopup.close()},s.prototype._updateSubStep=function(e){this.currentSubStepCount=e,p.logTutorialSubStep(this.currentStepCount,e-1)},s.prototype._setupHandlerFunctions=function(){function e(e){return e===u.TUTORIAL_STEP_EQUIP_ITEM||e===u.TUTORIAL_STEP_EQUIP_ALL_ITEMS}var t=this;this.movementHandler=function(e){e.actorId===window.gui.playerData.id&&(t.currentStepCount===u.TUTORIAL_STEP_ROLEPLAY_MOVE||e.isInFight&&t.currentStepCount===u.TUTORIAL_STEP_FIGHT_MOVE)&&t._validateCurrentStep()},this.itemEquippedHandler=function(e){if(t.currentStepCount===u.TUTORIAL_STEP_EQUIP_ITEM||t.currentStepCount===u.TUTORIAL_STEP_EQUIP_ALL_ITEMS){var i=t.currentStepCount===u.TUTORIAL_STEP_EQUIP_ITEM?u.FIRST_EQUIP_ITEMS:u.SECOND_EQUIP_ITEMS;e&&i.indexOf(e.objectGID)!==-1&&(p.logTutorialSubStep(t.currentStepCount,"item"+e.position),this.currentSubStepCount++),n(i,window.gui.playerData.inventory.equippedItems)&&t._validateCurrentStep()}},this.fightStartingHandler=function(){t.currentStepCount===u.TUTORIAL_STEP_STARTING_A_FIGHT||t.currentStepCount===u.TUTORIAL_STEP_FIND_BOSS?(t._getCurrentMonster()===u.TUTORIAL_BOSS_MONSTER_ID&&p.log("F_T_U_E.Step2770_Attack_Monster_Lupus_Minimus"),t._validateCurrentStep()):t._updateHintArrow()},this.fightStartHandler=function(){t.currentStepCount===u.TUTORIAL_STEP_FIGHT_LOCATION?t._validateCurrentStep():t._updateHintArrow()},this.fightLocationHandler=function(){t.currentStepCount===u.TUTORIAL_STEP_FIGHT_LOCATION&&t._validateCurrentStep()},this.fightTurnEndHandler=function(e){t.currentStepCount===u.TUTORIAL_STEP_FIGHT_SKIP_TURN&&e.id===window.gui.playerData.id&&t._validateCurrentStep()},this.useSpellHandler=function(e){t.currentStepCount===u.TUTORIAL_STEP_FIGHT_CAST_SPELL&&e.sourceId===window.gui.playerData.id&&t._validateCurrentStep()},this.npcDialogOpenedHandler=function(){t._updateSubStep(u.TUTORIAL_SUB_STEP_TALK_SHOW_RESPONSE),t._updateHintArrow()};var i={};this.windowOpenedHandler=function(n){var o=n.id,s=t.currentStepCount;"equipment"===o&&e(s)?(t._updateSubStep(u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_TAB),t._updateHintArrow()):("fightEnd"===o&&s===u.TUTORIAL_STEP_KILL_BOSS&&p.log("F_T_U_E.Step2930_Win_Fight_Monster_Lupus_Minimus"),t._hideArrows()),i[o]=t.currentStepCount},this.windowClosedHandler=function(e){var n=e.id,o=i[n];"equipment"===n?o===u.TUTORIAL_STEP_EQUIP_ITEM?p.log("F_T_U_E.Step0880_Close_Menu"):o===u.TUTORIAL_STEP_EQUIP_ALL_ITEMS&&p.log("F_T_U_E.Step2590_Quit_Bag_Menu"):"fightEnd"===n&&(t._getCurrentMonster()===u.TUTORIAL_FIRST_MONSTER_ID?p.log("F_T_U_E.Step2180_Close_Fight_Summary_Window"):t._getCurrentMonster()===u.TUTORIAL_BOSS_MONSTER_ID&&p.log("F_T_U_E.Step2960_Close_Fight_Summary_Window")),t._updateHintArrow()},this.equipmentFilterHandler=function(i){e(t.currentStepCount)&&t.currentSubStepCount>u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_ITEM_MENU_ICON&&(i!==_?t._updateSubStep(u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_TAB):t._updateSubStep(u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_EQUIPMENT),t._updateHintArrow())},this.equippableHighlightedHandler=function(i){e(t.currentStepCount)&&t.currentSubStepCount&&l.pointToCharacterItem(i[0])},this.itemDragEndHandler=function(i,n,o){o&&"equipment"===o.source&&e(t.currentStepCount)&&t.currentSubStepCount&&t._updateHintArrow()},this.updateHintArrowHandler=this._updateHintArrow.bind(this)},s.prototype._onQuestUpdatedOrStarted=function(e){if(e===u.QUEST_TUTORIAL_ID||e===u.SHOP_TUTO_QUEST_ID){var t=o(),i=t.currentStepCount,n=!!window.gui.playerData.quests.finished[u.SHOP_TUTO_QUEST_ID];if(i!==u.TUTORIAL_STEP_SUCCESS_QUEST||n)this._updateDisplay();else{window.gui.tutorialManager.startShopTutorial();var s=g("tablet.tutorial.shop.start");s&&this._updateStepDescription(s)}}},s.prototype._setupListeners=function(){var e=this,t=window.gui;t.on("disconnect",function(){e.reset()});var i=this._onQuestUpdatedOrStarted.bind(this);t.playerData.quests.on("questStarted",i),t.playerData.quests.on("questUpdate",i),t.playerData.quests.on("questFinished",function(t){var i=t.questId;return i===u.SHOP_TUTO_QUEST_ID?(p.log("F_T_U_E.Step3300_Use_shop"),void e._updateDisplay()):void(i===u.QUEST_TUTORIAL_ID&&(f.setValue("tutorialDone",!0,3),p.logTutorialStepEnd(15),m.trackTutorialCompleted(),e._hideArrows()))}),t.tutorialManager.on("inTutorialStateChanged",function(t){t?e._registerInTutorialListeners():e._removeInTutorialListeners()})},s.prototype._registerInTutorialListeners=function(){var e=window.gui;e.on("_tutorialGameMapMovementMessage",this.movementHandler),e.playerData.inventory.on("itemMoved",this.itemEquippedHandler),e.playerData.inventory.on("itemAdded",this.itemEquippedHandler),e.on("GameFightStartingMessage",this.fightStartingHandler),e.on("_tutorialGameEntitiesDispositionMessage",this.fightLocationHandler),e.on("GameFightStartMessage",this.fightStartHandler),e.fightManager.on("GameFightTurnStart",this.fightStartHandler),e.on("GameFightTurnEndMessage",this.fightTurnEndHandler),e.on("GameActionFightSpellCastMessage",this.useSpellHandler),e.on("GameActionFightCloseCombatMessage",this.useSpellHandler),e.npcDialogUi.on("opened",this.npcDialogOpenedHandler),d.on("opened",this.windowOpenedHandler),d.on("closed",this.windowClosedHandler);var t=d.getWindow("equipment");t.on("equippableHighlighted",this.equippableHighlightedHandler),t.storageView.on("filter",this.equipmentFilterHandler),r.on("dragEnd",this.itemDragEndHandler),window.isoEngine.on("mapLoaded",this.updateHintArrowHandler),window.gui.menuBar.on("open",this.updateHintArrowHandler),window.gui.menuBar.on("close",this.updateHintArrowHandler)},s.prototype._removeInTutorialListeners=function(){var e=window.gui;e.removeListener("_tutorialGameMapMovementMessage",this.movementHandler),e.playerData.inventory.removeListener("itemMoved",this.itemEquippedHandler),e.playerData.inventory.removeListener("itemAdded",this.itemEquippedHandler),e.removeListener("GameFightStartingMessage",this.fightStartingHandler),e.removeListener("_tutorialGameEntitiesDispositionMessage",this.fightLocationHandler),e.removeListener("GameFightStartMessage",this.fightStartHandler),e.fightManager.removeListener("GameFightTurnStart",this.fightStartHandler),e.removeListener("GameFightTurnEndMessage",this.fightTurnEndHandler),e.removeListener("GameActionFightSpellCastMessage",this.useSpellHandler),e.removeListener("GameActionFightCloseCombatMessage",this.useSpellHandler),e.npcDialogUi.removeListener("opened",this.npcDialogOpenedHandler),d.removeListener("opened",this.windowOpenedHandler),d.removeListener("closed",this.windowClosedHandler);var t=d.getWindow("equipment");t.removeListener("equippableHighlighted",this.equippableHighlightedHandler),t.storageView.removeListener("filter",this.equipmentFilterHandler),r.removeListener("dragEnd",this.itemDragEndHandler),window.isoEngine.removeListener("mapLoaded",this.updateHintArrowHandler),window.gui.menuBar.removeListener("open",this.updateHintArrowHandler),window.gui.menuBar.removeListener("close",this.updateHintArrowHandler)},s.prototype._validateCurrentStep=function(){if(this.currentStep){for(var e=this.currentStep.questId,t=this.currentStep.objectiveIds,i=0;i<t.length;i+=1)window.dofus.sendMessage("QuestObjectiveValidationMessage",{questId:e,objectiveId:t[i]});this._hideArrows(),p.logTutorialSubStep(this.currentStepCount,this.currentSubStepCount),this.currentSubStepCount=null}},s.prototype._hideArrows=function(){window.gui.hintArrow.hideArrow(),window.isoEngine.removeArrows()},s.prototype.reset=function(){this.quest=null,this.currentStepId=null,this.currentStep=null,this.currentStepCount=null,this.currentSubStepCount=null,this.tutorialPopup.setContent(""),this.tutorialPopup.hide(),this._hideArrows(),window.gui.shortcutBar.setAvailability(!0),window.gui.timeline.fightControlButtons.setTurnReadyButtonAvailability(!0),window.gui.tutorialManager.inTutorial&&this._removeInTutorialListeners()},s.prototype._shouldSkipFightLocationStep=function(){var e=window.gui.fightManager,t=e.FIGHT_STATES;return e.fightState===t.BATTLE&&this.currentStepCount===u.TUTORIAL_STEP_FIGHT_LOCATION},s.prototype._shouldSkipEquipItemsStep=function(){if(this.currentStepCount===u.TUTORIAL_STEP_EQUIP_ITEM||this.currentStepCount===u.TUTORIAL_STEP_EQUIP_ALL_ITEMS){var e=this.currentStepCount===u.TUTORIAL_STEP_EQUIP_ITEM?u.FIRST_EQUIP_ITEMS:u.SECOND_EQUIP_ITEMS;return!n(e,window.gui.playerData.inventory.objects)}},s.prototype._updateDisplay=function(){var e=!1;this.currentStepCount&&(p.logTutorialSubStep(this.currentStepCount,this.currentSubStepCount),p.logTutorialStepEnd(this.currentStepCount),e=!0);var t=o();return t?(this.quest=t.quest,this.currentStepId=t.currentStepId,this.currentStep=t.currentStep,this.currentStepCount=t.currentStepCount,e||p.log("F_T_U_E.Step0300_Enter_Tuto"),p.logTutorialStepStart(this.currentStepCount),this._updateSubStep(1),this._shouldSkipFightLocationStep()||this._shouldSkipEquipItemsStep()?this._validateCurrentStep():(this._handleMenuBarDisplay(),this._updateStepDescription(this.currentStep.descriptionId),void this._updateHintArrow())):void console.error("TutorialStep: Cannot find quest data with questId: "+u.QUEST_TUTORIAL_ID)},s.prototype._handleMenuBarDisplay=function(){var e=this.currentStepCount;e>=u.TUTORIAL_STEP_EQUIP_ITEM&&window.gui.uiLocker.unlockFeature("inventory","tutorial")},s.prototype._updateStepDescription=function(e){this.tutorialPopup.setContent(c.process(e))},s.prototype._getCurrentMonster=function(){return this.currentStepCount>=u.TUTORIAL_STEP_FIND_BOSS?u.TUTORIAL_BOSS_MONSTER_ID:u.TUTORIAL_FIRST_MONSTER_ID},s.prototype._pointToMonsterCheck=function(){window.gui.playerData.isFighting||window.isoEngine.addArrowOnMonster(this._getCurrentMonster())},s.prototype.checkClickedMonster=function(){this._getCurrentMonster()===u.TUTORIAL_FIRST_MONSTER_ID?p.log("F_T_U_E.Step1230_Clic_Scarecrow"):this._getCurrentMonster()===u.TUTORIAL_BOSS_MONSTER_ID&&p.log("F_T_U_E.Step2750_Clic_Monster_Lupus_Minimus")},s.prototype.checkSelectTarget=function(){this.currentStepCount===u.TUTORIAL_STEP_FIGHT_CAST_SPELL&&this._getCurrentMonster()===u.TUTORIAL_FIRST_MONSTER_ID&&p.log("F_T_U_E.Step1850_Select_Target")},s.prototype.checkFightConfirmValidate=function(){this.currentStepCount===u.TUTORIAL_STEP_FIGHT_MOVE?p.log("F_T_U_E.Step1660_Clic_Validate_Move"):this.currentStepCount===u.TUTORIAL_STEP_FIGHT_CAST_SPELL&&p.log("F_T_U_E.Step1870_Validate_Attack")},s.prototype.checkAnswerNPC=function(){this.currentStepCount===u.TUTORIAL_STEP_SUCCESS_QUEST&&p.log("F_T_U_E.Step3160_Answer_NPC_Maitre_Pifo")},s.prototype._handleHintArrow=function(){if(this._hideArrows(),window.gui.shortcutBar.setAvailability(!0),window.gui.timeline.fightControlButtons.setTurnReadyButtonAvailability(!0),this.currentStepCount)switch(this.currentStepCount){case u.TUTORIAL_STEP_ROLEPLAY_MOVE:window.isoEngine.addArrowOnCell(u.TUTORIAL_STEP_ROLEPLAY_MOVE_CELL_ID,0,0,"upLeft");break;case u.TUTORIAL_STEP_TALK:case u.TUTORIAL_STEP_START_QUEST:case u.TUTORIAL_STEP_SUCCESS_QUEST:this.currentSubStepCount===u.TUTORIAL_SUB_STEP_TALK_SHOW_NPC?window.isoEngine.addArrowOnNpc(u.TUTORIAL_STEP_TALK_NPC_ID):this.currentSubStepCount===u.TUTORIAL_SUB_STEP_TALK_SHOW_RESPONSE&&l.pointToNpcAnswer(0);break;case u.TUTORIAL_STEP_EQUIP_ITEM:case u.TUTORIAL_STEP_EQUIP_ALL_ITEMS:switch(this.currentSubStepCount){case u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_ITEM_MENU_ICON:l.pointToMenuIcon("Bag");break;case u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_TAB:l.pointToEquipFilterIcon();break;case u.TUTORIAL_SUB_STEP_EQUIP_ITEM_SHOW_EQUIPMENT:l.pointToStorageFirstSlotBox()}break;case u.TUTORIAL_STEP_CHANGE_MAP:l.pointToWindowCloseButton("equipment"),d.getWindow("equipment").openState||a();break;case u.TUTORIAL_STEP_STARTING_A_FIGHT:this._pointToMonsterCheck();break;case u.TUTORIAL_STEP_FIGHT_LOCATION:this._pointToMonsterCheck(),window.foreground.tapOptions&&"fightPlacement"===window.foreground.tapOptions.mode&&window.isoEngine.addArrowsSequence(u.FIGHT_LOCATION_TARGET_CELLS);break;case u.TUTORIAL_STEP_FIGHT_MOVE:if(this._pointToMonsterCheck(),window.foreground.tapOptions)if("fightPlacement"===window.foreground.tapOptions.mode)l.pointToTimelineButton("fightReadyBtn");else if("fight"===window.foreground.tapOptions.mode){var e=window.gui.playerData.id,t=window.gui.fightManager,i=t.currentFighterId,n=t.getFighter(e);if(!n)return console.error("Tutorial step fight move failed, fighter does not exist");if(i===e){var o=u.FIGHT_MOVE_TARGET_CELLS[n.data.disposition.cellId];window.isoEngine.addArrowOnCell(o)}window.gui.shortcutBar.setAvailability(!1),window.gui.timeline.fightControlButtons.setTurnReadyButtonAvailability(!1)}break;case u.TUTORIAL_STEP_FIGHT_CAST_SPELL:this._pointToMonsterCheck(),window.gui.playerData.isFighting&&l.pointToFirstSkillShortcut();break;case u.TUTORIAL_STEP_FIGHT_SKIP_TURN:this._pointToMonsterCheck(),l.pointToTimelineButton("turnReadyBtn");break;case u.TUTORIAL_STEP_FIND_BOSS:this._pointToMonsterCheck(),l.pointToWindowCloseButton("equipment"),d.getWindow("equipment").openState||window.gui.playerData.position.mapId!==u.TUTORIAL_MAP_ID_SECOND_AFTER_FIGHT||a()}},s.prototype._updateHintArrow=function(){var e=this;setTimeout(function(){e._handleHintArrow()},0)}},function(e,t,i){function n(e){e=e||{},r.call(this,"div",e),this.addClassNames("tutorialPopup"),this._header=this.appendChild(new r("div",{className:"tutorialPopupHeader",name:"tutorialPopupHeader"})),this._header.appendChild(new r("div",{className:"tutorialPopupTitle",text:s(e.actor?e.actor:"tablet.joris")})),this.content=this.appendChild(new r("div",{className:"tutorialPopupContent"})),e.actor||this.appendChild(new r("div",{className:"joris"})),this._hasAlreadyHaveCloseButton=!1}var o=i(183).dimensions,s=i(29).getText,a=i(191).inherits,r=i(235);i(864),a(n,r),e.exports=n,n.prototype.setContent=function(e){this.content.clearContent(),e instanceof r?this.content.appendChild(e):this.content.setText(e),this.show()},n.prototype.setCloseButton=function(){if(!this._hasAlreadyHaveCloseButton){var e=this._header.appendChild(new r("div",{className:"tutorialPopupCloseBtn"}));e.appendChild(new r("div",{className:"btnIcon"})),this._hasAlreadyHaveCloseButton=!0}},n.prototype.open=function(){this.setStyle("bottom",o.screenHeight-o.mapHeight+7+"px"),this.hide(),window.gui.windowsContainer.appendChild(this)},n.prototype.close=function(){this.hide()}},function(e,t){},function(e,t,i){function n(){r.call(this),this._shieldSelected=!1,this._isQuestFilter=!1,this._initialized=!1,this._isContextMenuOpen=!1,this._isRuneSelected=!1,this._isShieldWindowOpened=!1,this._isShieldSpellDisplayed=!1}function o(){a&&a.close()}function s(e){if(a||(a=new d({actor:"ui.shield.tutorialNPC"}),a.allowDomEvents(),a.on("dom.touchstart",o),a.setCloseButton(),a.open()),"string"==typeof e){var t=new p("span");t.setHtml(e),e=t}return a.setContent(e),!0}var a,r=i(194).EventEmitter,l=i(191).inherits,c=i(225),u=i(680),d=i(863),h=i(478),p=i(235),m=i(29).getText,f=i(575);l(n,r),e.exports=n,n.prototype.initialize=function(e){var t=this;e.on("disconnect",function(){t._initialized&&t.stop()}),e.playerData.quests.on("listUpdated",function(){e.playerData.isOnShieldTutorial()&&!e.playerData.isShieldTutorialFortified()&&t.start()}),e.playerData.quests.on("questStarted",function(){e.playerData.isOnShieldTutorial()&&!e.playerData.isShieldTutorialFortified()&&t.start()}),e.on("QuestObjectiveValidatedMessage",function(){e.playerData.isShieldTutorialFortified()&&t.stop()})},n.prototype.start=function(){this._initialized||(this._setupHandlerFunctions(),this._initialized=!0),this.updateHintArrowHandler()},n.prototype._registerInTutorialListeners=function(){c.on("opened",this.windowOpenedHandler),c.on("closed",this.windowClosedHandler);var e=c.getWindow("equipment");e.on("itemSelected",this.itemSelectedHandler),e.storageView.on("filter",this.questFilterHandler);var t=c.getWindow("shieldWindow");t.feedingBox.on("quantityUpdated",this.runeSelectedHandler),h.getContextMenu("item").on("open",this.itemContextMenuHandler),window.gui.menuBar.on("open",this.updateHintArrowHandler),window.gui.menuBar.on("close",this.updateHintArrowHandler)},n.prototype._removeInTutorialListeners=function(){c.removeListener("opened",this.windowOpenedHandler),c.removeListener("closed",this.windowClosedHandler);var e=c.getWindow("equipment");e.removeListener("itemSelected",this.itemSelectedHandler),e.storageView.removeListener("filter",this.questFilterHandler);var t=c.getWindow("shieldWindow");t.feedingBox.on("quantityUpdated",this.runeSelectedHandler),h.getContextMenu("item").removeListener("open",this.itemContextMenuHandler),this._isShieldWindowOpened&&t.getShieldSpellSlot().removeListener("tapend",this.shieldSpellSlotHandler),window.gui.menuBar.removeListener("open",this.updateHintArrowHandler),window.gui.menuBar.removeListener("close",this.updateHintArrowHandler)},n.prototype.stop=function(){o(),this._hideArrows(),this._removeInTutorialListeners(),this.reset()},n.prototype.reset=function(){this._shieldSelected=!1,this._isQuestFilter=!1,this._initialized=!1,this._isContextMenuOpen=!1,this._isRuneSelected=!1,this._isShieldWindowOpened=!1,this._isShieldSpellDisplayed=!1},n.prototype._hideArrows=function(){window.gui.hintArrow.hideArrow(),window.isoEngine.removeArrows()},n.prototype._setupHandlerFunctions=function(){var e=this;this.windowOpenedHandler=function(t){var i=t.id;if("equipment"===i)e._shieldSelected=!1,e._isQuestFilter=!1,e._isContextMenuOpen=!1;else if("shieldWindow"===i){e._isContextMenuOpen=!1,e._isShieldSpellDisplayed=!1,e._isRuneSelected=!1;var n=c.getWindow("shieldWindow");e._isShieldWindowOpened||(n.getShieldSpellSlot().on("tooltipOut",e.shieldSpellSlotHandler),e._isShieldWindowOpened=!0)}e._updateHintArrow()},this.windowClosedHandler=function(){e._updateHintArrow()},this.shieldSpellSlotHandler=function(){e._isShieldSpellDisplayed=!0,e._updateHintArrow()},this.questFilterHandler=function(t){t!==f.questFilterId?e._isQuestFilter=!1:e._isQuestFilter=!0,e._updateHintArrow()},this.itemSelectedHandler=function(t){e._shieldSelected=!1,t.id===f.fakeShieldId&&(e._shieldSelected=!0),e._updateHintArrow()},this.runeSelectedHandler=function(){e._isRuneSelected=!0,e._updateHintArrow()},this.itemContextMenuHandler=function(){e._shieldSelected&&(e._isContextMenuOpen=!0),e._updateHintArrow()},this.updateHintArrowHandler=this._updateHintArrow.bind(this),this._registerInTutorialListeners()},n.prototype.isSpellSlotStepPassed=function(){return this._isShieldSpellDisplayed},n.prototype._handleHintArrowAndDialogue=function(){var e=window.gui.playerData;if(this._hideArrows(),e.isOnShieldTutorial()&&!e.isShieldTutorialFortified())switch(c.getLastFocusedWindowId()){case"confirm":break;case"shieldWindow":if(this._isRuneSelected&&this._isShieldSpellDisplayed){s(m("ui.shield.tutorialStep6")),u.pointToShieldValidateButton();break}if(this._isShieldSpellDisplayed){s(m("ui.shield.tutorialStep5")),u.pointToShieldStorageFirstSlotBox();break}s(m("ui.shield.tutorialStep4")),u.pointToShieldSpellSlot();break;case"equipment":if(this._isContextMenuOpen){u.pointToEntryManageShield();break}if(this._shieldSelected){o(),u.pointToActionButton();break}if(this._isQuestFilter){s(m("ui.shield.tutorialStep3")),u.pointToStorageFirstSlotBox();break}s(m("ui.shield.tutorialStep2")),u.pointToQuestFilterIcon();break;default:s(m("ui.shield.tutorialStep1")),self._shieldSelected=!1,self._isQuestFilter=!1,u.pointToMenuIcon("Bag")}},n.prototype._updateHintArrow=function(){var e=this;setTimeout(function(){e._handleHintArrowAndDialogue()},300)}},function(e,t,i){function n(e){return e=e||"",e.split(",")[0]}function o(e){var t=S[e];if(t){for(var i=C[e],o=n(i.trigger),s=A[o],a=s.eventsList||[],r=0;r<a.length;r+=1){var l=a[r];l.listener.removeListener(l.eventId,t)}delete S[e]}}function s(){for(var e=Object.keys(S),t=0;t<e.length;t+=1){var i=e[t];o(i)}}function a(){s();for(var e=0;e<E.length;e+=1)window.gui.notificationBar.removeNotification(E[e]);E=[]}function r(e){var t=E.indexOf(e);t>=0&&E.splice(t,1)}function l(e){var t=e.id,i="tip"+t,n=window.gui.notificationBar;if(!n.isNotificationOpen(i)&&!I[t]){var s={type:n.notificationType.TUTORIAL,title:e.titleId,wuidom:b.process(e.messageId),onClose:function(){window.dofus.sendMessage("NotificationUpdateFlagMessage",{index:t}),I[t]=!0,r(i)}};n.newNotification(i,s),E.push(i),o(t)}}function c(){for(var e in C){var t=C[e],i=n(t.trigger),o=A[i];if(i&&o&&!I[e])if("GameStart"!==i)for(var s=o.eventsList||[],a=0;a<s.length;a+=1){var r=s[a],c=r.listener,u=r.eventId;if(!S[e]){var d=o.customFunc||l;S[e]=d.bind(null,t)}var h=S[e];c.on(u,h)}else l(t)}}function u(){setTimeout(function(){c()},0)}function d(e,t){for(var i=t.results||[],n=0;n<i.length;n+=1){var o=i[n];if(o.id===window.gui.playerData.id&&o.outcome===v.RESULT_VICTORY)return l(e)}}function h(e,t){for(var i=t.actors||[],n=0;n<i.length;n+=1)if("GameRolePlayGroupMonsterInformations"===i[n]._type)return l(e)}function p(e,t){t.actorId===window.gui.playerData.id&&l(e)}function m(){var e=window.gui,t=e.playerData,i=T.getWindow("grimoire");A={CharacterLevelUp:{eventsList:[{listener:t,eventId:"characterLevelUp"}]},FightResultVictory:{customFunc:d,eventsList:[{listener:e,eventId:"GameFightEndMessage"}]},FightSpellCast:{eventsList:[{listener:e,eventId:"GameActionFightSpellCastMessage"},{listener:e,eventId:"GameActionFightCloseCombatMessage"}]},GameFightStart:{eventsList:[{listener:e,eventId:"GameFightStartMessage"}]},GameFightStarting:{eventsList:[{listener:e,eventId:"GameFightStartingMessage"}]},GameRolePlayPlayerLifeStatus:{eventsList:[{listener:e,eventId:"GameRolePlayPlayerLifeStatusMessage"}]},GameStart:{},LifePointsRegenBegin:{eventsList:[{listener:e,eventId:"LifePointsRegenBeginMessage"}]},MapWithMonsters:{customFunc:h,eventsList:[{listener:e,eventId:"mapComplementaryInformationsData"}]},NpcDialogCreation:{eventsList:[{listener:e,eventId:"NpcDialogCreationMessage"}]},OpenBook:{eventsList:[{listener:i,eventId:"open"}]},OpenGrimoireAlignmentTab:{eventsList:[{listener:i.tabs.getTabTarget("alignment"),eventId:"open"}]},OpenGrimoireJobTab:{eventsList:[{listener:i.tabs.getTabTarget("jobs"),eventId:"open"}]},OpenGrimoireQuestTab:{eventsList:[{listener:i.tabs.getTabTarget("quests"),eventId:"open"}]},OpenGrimoireSpellTab:{eventsList:[{listener:i.tabs.getTabTarget("spells"),eventId:"open"}]},OpenInventory:{eventsList:[{listener:T.getWindow("equipment"),eventId:"open"}]},OpenStats:{eventsList:[{listener:T.getWindow("characteristics"),eventId:"open"}]},PlayerFightMove:{customFunc:p,eventsList:[{listener:e,eventId:"GameMapMovementMessage"}]},PlayerIsDead:{eventsList:[{listener:t,eventId:"playerIsDead"}]},PlayerMove:{customFunc:p,eventsList:[{listener:window.dofus,eventId:"GameMapMovementMessage"}]},PlayerNewSpell:{eventsList:[{listener:t.characters.mainCharacter,eventId:"newSpellLearned"}]}}}function f(e){w.getAllDataMap("Notifications",function(t,i){return t?e(t):(C=i,void e())})}function g(e){f(function(t){return t?e(t):(m(),void e())})}function _(e){I={};for(var t=0;t<e.length;t+=1)for(var i=e[t],n=0;n<32;n+=1)I[n+32*t]=!!(1&i),i>>=1}var v=i(867),y=i(190),b=i(678),w=i(30),M=i(195),T=i(225),C={},I={},A={},S={},E=[],x=!0,L=!1;t.initialize=function(e){e.once("initialized",function(){x=M.getValue("option-tutorialTips",!0),y.on("tutorialTips",function(e){t.enableTips(e)}),g(function(e){if(e)return console.error(e)})}),e.tutorialManager.on("inTutorialStateChanged",function(e){L=e,L?(a(),window.gui.notificationBar.clearNotifications()):x&&!L&&u()}),e.on("disconnect",function(){a(),L=!1}),e.on("NotificationListMessage",function(e){_(e.flags)})},t.enableTips=function(e){x=e,L||(x?u():a())},t.resetTips=function(){window.dofus.sendMessage("NotificationResetMessage"),_([0]),x&&!L&&(a(),u())}},function(e,t){e.exports={RESULT_LOST:0,RESULT_DRAW:1,RESULT_VICTORY:2,RESULT_TAX:5,RESULT_DEFENDER_GROUP:6}},function(e,t,i){function n(e){var t=window.gui,i=this;a.call(this,"div",{className:"RoleplayBuffs"}),c(this,{isCollapsable:!0}),this._itemSlotMap={},this._timedBuffMap={},this._createDom(),this._setupListeners(e),this.hide(),t.on("disconnect",function(){i._unloadTimedBuffsContent()})}function o(e){return e.position===m.INVENTORY_POSITION_MUTATION||e.position===m.INVENTORY_POSITION_BOOST_FOOD||e.position===m.INVENTORY_POSITION_FIRST_BONUS||e.position===m.INVENTORY_POSITION_SECOND_BONUS||e.position===m.INVENTORY_POSITION_FIRST_MALUS||e.position===m.INVENTORY_POSITION_SECOND_MALUS||e.position===m.INVENTORY_POSITION_ROLEPLAY_BUFFER||e.position===m.INVENTORY_POSITION_FOLLOWER}i(869);var s=i(191).inherits,a=i(235),r=i(832),l=i(870),c=i(658),u=i(205).isEmptyObject,d=i(183).dimensions,h=i(28),p=i(271),m=i(671);s(n,a),e.exports=n,n.prototype._setupListeners=function(e){var t=this;window.gui.on("connected",function(){t.setStyle("left",~~(d.mapWidth/2)+d.mapLeft+"px"),t.setStyle("top",d.mapTop+"px")}),e.on("listUpdate",function(e){t._unloadItemsContent();for(var i in e)t._addItem(e[i])}),e.on("unloaded",function(){t._unloadItemsContent()}),e.on("itemAdded",function(e){t._addItem(e)}),e.on("itemsAdded",function(e){for(var i in e)t._addItem(e[i])}),e.on("itemDeleted",function(e){t._removeItem(e)}),e.on("itemsDeleted",function(e){for(var i in e)t._removeItem(e[i])}),e.on("itemModified",function(e){t._modifyItem(e)}),p.on("UpdateTimedBuffTimeMessage",function(e){t._addOrUpdateTimedBuff(e.buffType,e.updatedTime)})},n.prototype._createDom=function(){this.itemSlotBox=this.createChild("div",{className:"slotBox"}),this.timedBuffSlotBox=this.createChild("div",{className:"slotBox"})},n.prototype._addItem=function(e){if(o(e)){var t=e.objectUID,i=this._itemSlotMap[t];i||(i=this._itemSlotMap[t]=new r({itemData:e,enableContextMenu:!1,descriptionOptions:{averagePrice:!1,showCategory:!1,showWeight:!1}}),this.itemSlotBox.appendChild(i),this.show(),this.emit("resized"))}},n.prototype._removeItem=function(e){var t=this._itemSlotMap[e];t&&(t.destroy(),delete this._itemSlotMap[e],this._refreshDisplay())},n.prototype._modifyItem=function(e){this._removeItem(e.objectUID),this._addItem(e),this._refreshDisplay()},n.prototype._unloadItemsContent=function(){this._itemSlotMap={},this.itemSlotBox.clearContent(),this._refreshDisplay()},n.prototype._unloadTimedBuffsContent=function(){this._timedBuffMap={},this.timedBuffSlotBox.clearContent(),this._refreshDisplay()},n.prototype._refreshDisplay=function(){u(this._itemSlotMap)&&u(this._timedBuffMap)&&this.hide(),this.emit("resized")},n.prototype._addOrUpdateTimedBuff=function(e,t){var i=this._timedBuffMap[e];if(i)return i.setEndTime(t),void this._refreshDisplay();if(!(t-h.now()<0)){i=this._timedBuffMap[e]=new l(e,t);var n=this;i.on("onTimerFinished",function(){delete n._timedBuffMap[e],n.timedBuffSlotBox.removeChild(i),n._refreshDisplay()}),this.timedBuffSlotBox.appendChild(i),this.show(),this._refreshDisplay()}}},function(e,t){},function(e,t,i){function n(e,t){o.call(this,"div",{className:"TimedBuffSlot"});var i=this;e===a.ANTI_AGGRO&&(i.addClassNames("antiAggro"),l.addTooltip(this,c("tablet.buff.nonAggroDesc"))),this._endTime=t,this._createDom(),this.emit("resized"),this.updateInterval=u.setInterval(function(){i._update()},1e3),this.on("tooltipOn",this._removeHoverStyle),this.on("tooltipOut",this._applyHoverStyle)}i(871);var o=i(235),s=i(191).inherits,a=i(872),r=i(28),l=i(248),c=i(29).getText,u=i(203);s(n,o),e.exports=n,n.prototype._update=function(){var e=this._endTime-r.now();if(e<0)return void this._onFinished();var t=Math.floor(e/6e4),i=Math.floor(e/1e3-60*t);this.timedBuffSlotCounter.setText(r.leadWithZero(t)+":"+r.leadWithZero(i))},n.prototype._onFinished=function(){this.emit("onTimerFinished"),u.clearInterval(this.updateInterval)},n.prototype.setEndTime=function(e){this._endTime=e},n.prototype._createDom=function(){this.timedBuffSlotCounter=this.createChild("div",{className:"timedBuffSlotCounter"})},n.prototype._applyHoverStyle=function(){this.setStyle("webkitTransform","scale(1)")},n.prototype._removeHoverStyle=function(){this.setStyle("webkitTransform","scale(1.1)")}},function(e,t){},function(e,t){e.exports={ANTI_AGGRO:0}},function(e,t,i){function n(){h=window.gui,p=window.isoEngine,h.playerData.on("characterSelectedSuccess",o)}function o(){y&&r()&&(p.on("mapLoaded",s),h.once("disconnect",a))}function s(){return h.playerData.position.removeListener("worldMapUpdate",s),h.tutorialManager.removeListener("inTutorialStateChanged",s),0===h.playerData.position.worldmapId?void h.playerData.position.once("worldMapUpdate",s):void 0===h.tutorialManager.inTutorial?void h.tutorialManager.once("inTutorialStateChanged",s):void(l()&&(p.removeListener("mapLoaded",s),f.initialize(),g.initialize(),_.initialize()))}function a(){p.removeListener("mapLoaded",s),h.playerData.position.removeListener("worldMapUpdate",s),h.tutorialManager.removeListener("inTutorialStateChanged",s),b=!1}function r(){return h.playerData.characterBaseInformations.level<=v.characterLevelLimit}function l(e){return!h.tutorialManager.inTutorial&&(!!(!m.isFightMode||e&&e.fightContextAllowed)&&(h.playerData.position.worldmapId!==v.INCARNAM_WORLD_MAP?b:h.playerData.characterBaseInformations.level>v.characterLevelLimit?b:(b=!0,!0)))}function c(e){b=e}function u(){a(),f.removeAndClean(),g.removeAndClean(),_.removeAndClean()}function d(e){var t="Wrong parameter, allowed parameters are: on, ui reset, ui unlock, trigger reset";if(!e)return t;if(1===e.length&&"on"===e[0])return y?"Already activated":(y=!0,o(),"Activated");if(2===e.length)if("ui"===e[0]){if("reset"===e[1])return _.reset(),"Done";if("unlock"===e[1])return _.unlockAll(),"Done"}else if("trigger"===e[0]&&"reset"===e[1])return g.reset(),"Done";return t}i(874);var h,p,m=i(269),f=i(875),g=i(897),_=i(898),v=i(896),y=!0,b=!1;t.initialize=n,t.isBeginnerAssistantRequired=l,t.adminCommand=d,t.openDialog=g.openDialog,t.setRequired=c,t.removeAndClean=u},function(e,t){},function(e,t,i){function n(e){return Math.floor(Math.random()*e.length)}function o(e){return e[n(e)]}function s(e){return!(!e&&0!==e)&&(e>=0&&e<=559)}function a(e){var t=e+28;return s(t)?t:null}function r(e){var t=e-28;return s(t)?t:null}function l(e){for(var t,i,n=e.length;0!==n;)i=Math.floor(Math.random()*n),n-=1,t=e[n],e[n]=e[i],e[i]=t;return e}function c(){return me===Ne.NOT_CREATED?null:ce}function u(){ce&&ce.refreshAnimation()}function d(){ae=window.isoEngine,re=window.actorManager,le=window.gui,me=Ne.NOT_CREATED,be={transitionning:!1,mapSide:null},ae.on("mapLoaded",h),ae.on("launchMapTransition",ie),ae.on("cancelMapTransition",ne),le.once("disconnect",p),h()}function h(e){Te.isBeginnerAssistantRequired()&&(e&&e.isReload&&ce&&me!==Ne.NOT_CREATED||(be.transitionning=!1,be.mapSide=null,ve={},ye={},_e=!1,P()))}function p(){ae.removeListener("mapLoaded",h),ae.removeListener("launchMapTransition",ie),ae.removeListener("cancelMapTransition",ne)}function m(){p()}function f(e,t){return t=t||1,e<28*t}function g(e,t){return t=t||1,e>559-28*t}function _(e,t){t=t||1;var i=e%14;return i<t}function v(e,t){t=t||1;var i=e%14;return i>13-t}function y(e,t){return _(e,t)||v(e,t)||f(e,t)||g(e,t)}function b(e){var t=a(e);return!!re.occupiedCells[t]}function w(e){var t=r(e);return!!re.occupiedCells[t]}function M(e){var t=r(e),i=Se.exits[le.playerData.position.mapId];if(!i||!i.length)return!1;for(var n=0;n<i.length;n++){var o=i[n],s=null;if("tile"===o.target)s=o.targetId;else if("interactive"===o.type){var a=ae.mapRenderer.identifiedElements[o.targetId];a&&void 0!==a._position&&null!==a._position&&(s=a._position)}if(null!==s&&(e===s||t===s))return!0}return!1}function T(e,t){var i;t||(i={front:!1,behind:!1});var n=a(e),o=r(e),s=ae.mapRenderer.interactiveElements,l=ae.mapRenderer.identifiedElements;for(var c in s)if(l[c]&&void 0!==l[c]._position){if(l[c]._position===n){if(t)return!0;i.front=!0}if(l[c]._position===o){if(t)return!0;i.behind=!0}}return i}function C(e){if(!ae.mapRenderer.isVisibleCell(e))return!1;var t=r(e);return!!s(t)&&ae.mapRenderer.isVisibleCell(t)}function I(e,t,i){t=t||(i?0:1);for(var n=[],o=Ae.getMapPointFromCellId(e),s=o.x-t,a=o.x+t,r=o.y-t,l=o.y+t,c=r;c<=l;c++)for(var u=s;u<=a;u++)if(u!==o.x||c!==o.y||i){
var d=Ae.getCellIdFromMapPoint(u,c);d&&n.push(d)}return n}function A(e){if(!s(e)||0===ve[e]||re.occupiedCells[e])return 0;var t=Be;if(void 0!==ve[e])t=ve[e];else{if(!ae.mapRenderer.isWalkable(e))return ve[e]=0,0;C(e)||(t-=25),y(e,1)&&(t-=3),y(e,2)&&(t-=2),y(e,3)&&(t-=1),M(e)&&(t-=30);var i=T(e);i.front&&(t-=15),i.behind&&(t-=10),ve[e]=t}return b(e)&&(t-=15),w(e)&&(t-=15),t}function S(e,t){if(!s(e)||ye[e]===!1)return!1;if(re.occupiedCells[e]){if(re.occupiedCells[e].length>1)return!1;if(!ce||ce.cellId!==e)return!1}var i=!0;return!(void 0===ye[e]&&((!ae.mapRenderer.isWalkable(e)||!C(e)||t&&y(e,2)||M(e)||T(e,!0))&&(i=!1),ye[e]=i,!i))&&((b(e)||w(e))&&(i=!1),i)}function E(e,t){for(var i,n=1,s=[],a=0;a<e.length;a++)i=A(e[a]),i>n&&(n=i,s=[]),i===n&&s.push(e[a]);return 0===s.length?null:t?s:o(s)}function x(e,t,i){var n=I(e,t,i);if(0===n.length)return null;var s=E(n,!0);return s&&0!==s.length||(s=n),o(s)}function L(e,t,i){for(var n=0;n<=t;n++)if(0!==n||i){var o=I(e,n,i);if(0!==o.length){var a=E(o);if(s(a))return a}}return null}function N(){ce=null,me=Ne.NOT_CREATED,ge=null}function O(){ke.emit("removed"),N()}function D(){O(),Ce.prototype.remove.call(this)}function R(e,t,i){var n={contextualId:"beginnerAssistant",look:{bonesId:Ee,scales:[100],skins:[]},disposition:{cellId:e,direction:t},name:"Joris",_type:"BeginnerAssistant"};re.addActor(n,function(t){return t?(ce=t,ce.remove=D,ce.setCellPosition(e),re.addAnimBehaviourToActor(ce.actorId,Y),me=Ne.CREATED,void i()):i(new Error("Unable to create the beginner assistant actor"))})}function P(){if(ce||me!==Ne.NOT_CREATED){if(we===le.playerData.position.mapId)return console.error(new Error("Beginner assistant deploy: actor is already loaded"));console.error(new Error("Beginner assistant deploy: actor is already loaded but map has changed. Will re-create it for seemless user experience but this should not happen.")),O()}var e=ue=re.userActor.position,t=Ae.getMapPointFromCellId(e),i=y(e,2),n=re.userActor.direction,o=null;if(i){var a=[];if(_(e,2))a.push({x:-1,y:1}),a.push({x:1,y:-1}),n=1;else if(v(e,2))a.push({x:-1,y:1}),a.push({x:1,y:-1}),n=3;else if(f(e,2))a.push({x:-1,y:-1}),a.push({x:1,y:1}),n=Math.random()>.5?3:1;else{if(!g(e,2))return console.error(new Error("player seems to be on map border but unable to determine which one"));a.push({x:-1,y:-1}),a.push({x:1,y:1}),n=Math.random()>.5?5:7}for(var r=0;r<a.length;r++){var l=Ae.getCellIdFromMapPoint(t.x+a[r].x,t.y+a[r].y);if(S(l,!1)){o=l;break}}s(o)||(o=L(e,7))}else o=L(e,7);return s(o)?void R(o,n,function(e){return e?console.error(e):i?(me=Ne.MAP_TRANSITION_ENTER,void ae.makeActorWalkIn(ce,300,function(){fe=Date.now()+3e3,me=Ne.WAITING_PLAYER,u(),ke.emit("actorStopped"),ke.emit("actorReady")})):(fe=Date.now()+k(),me=Ne.IDLE,u(),ke.emit("actorStopped"),void ke.emit("actorReady"))}):console.error(new Error("Unable to deploy beginner assistant near the player"))}function B(){ce.setCellPosition(ce.position)}function k(){return De+Math.floor(Math.random()*Re)}function F(e){return(he!==e||!de||void 0===pe||pe>=de.length)&&(he=e,de=Le[e],pe=0,l(de)),de[pe++]}function z(){return re.userActor.moving&&y(re.userActor.cellId,1)}function H(){return y(re.userActor.cellId)}function q(){return ce?Ae.getDistance(ce.position,re.userActor.position):console.error(new Error("Beginner assistant visualDistanceFromUser: no actor available"))}function W(){return re.occupiedCells[ce.cellId].length>1}function U(){return me===Ne.IDLE||me===Ne.WAITING_PLAYER||me===Ne.WAITING_FOR_PLAYER_EXIT}function Y(){if(me!==Ne.CREATED&&!_e){var e=Date.now()>fe,t=z();if(me===Ne.WAITING_PLAYER){var i=ue!==re.userActor.position;i?t?X():V():W()?J():e&&j()}else if(me===Ne.IDLE&&t)X();else if(me===Ne.IDLE&&e){var n=Math.random()<Pe?"pose":"move";"pose"===n&&($()&&!W()&&S(ce.cellId)||(n="move")),"pose"===n?K():J()}else me!==Ne.MOVING_TO_EXIT||t?W()&&U()?J():me!==Ne.WAITING_FOR_PLAYER_EXIT||t||H()?e&&(fe=Date.now()+k()):(me=Ne.IDLE,fe=Date.now()+k()):Q()}}function G(){return be.transitionning&&me!==Ne.MAP_TRANSITION_EXIT?oe():(fe=Date.now()+k(),me=Ne.IDLE,void ke.emit("actorStopped"))}function j(){me=Ne.WAITING_PLAYER_POSE,fe=1/0;var e=Z(),t=F("ENTERED_MAP_ANIMS");ce.setDisposition(ce.position,e),se(t,e,function(){ce&&(fe=Date.now()+k(),me=Ne.WAITING_PLAYER,ke.emit("actorStopped"))})}function V(e){me=Ne.FIRST_MOVEMENT;var t=x(re.userActor.cellId,3,!1,!0);if(null===t)return G();var i=Ie.getPath(ce.cellId,t,re.occupiedCells,!0);return 0===i.length?G():(t=i[i.length-1],ce.setCellPosition(t),ge=i,ce.speedAdjust=Oe,void ce.setPath(i,{cb:function(){if(ce)return ce.speedAdjust=0,ge=null,ce.position===t||(B(),e)?be.transitionning&&me!==Ne.MAP_TRANSITION_EXIT?oe():void G():V(!0)}}))}function X(e){me=Ne.MOVING_TO_EXIT,fe=1/0;var t=L(re.userActor.cellId,3,!1);if(!s(t))return void(me=Ne.WAITING_FOR_PLAYER_EXIT);var i=Ie.getPath(ce.cellId,t,re.occupiedCells,!0);return 0===i.length?void(me=Ne.WAITING_FOR_PLAYER_EXIT):(t=i[i.length-1],ce.setCellPosition(t),ge=i,ce.speedAdjust=Oe,void ce.setPath(i,{cb:function(){if(ce&&(ce.speedAdjust=0,me===Ne.MOVING_TO_EXIT)){if(ge=null,ce.position!==t)return B(),void(e||X(!0));if(be.transitionning&&me!==Ne.MAP_TRANSITION_EXIT)return oe();me=Ne.WAITING_FOR_PLAYER_EXIT,fe=Date.now()+k()}}}))}function Q(e){if(ge){ce.speedAdjust=0;var t=ge.indexOf(ce.position);if(t!==-1){var i=ge[t+1];s(i)&&(B(),me=Ne.MOVING_CANCEL,ce.cancelMovement(function(){if(ce)return ge=null,G(),e?e():void 0}))}}}function K(){me=Ne.IDLE_POSE,fe=1/0;var e=Z(),t=F("IDLE_ANIMS");ce.setDisposition(ce.position,e),se(t,e,function(){ce&&G()})}function J(){me=Ne.IDLE_MOVE,fe=1/0;var e=x(ce.cellId,3,!1,!0);if(!s(e))return G();var t=Ie.getPath(ce.cellId,e,re.occupiedCells,!0);return 0===t.length?G():(e=t[t.length-1],ce.setCellPosition(e),ge=t,ce.speedAdjust=0,void ce.setPath(t,{forceWalk:!0,cb:function(){if(ce)return ge=null,ce.position!==e&&B(),be.transitionning&&me!==Ne.MAP_TRANSITION_EXIT?oe():void G()}}))}function Z(){var e=ce.direction;return 5===e||4===e?e=3:7===e||0===e?e=1:6!==e&&2!==e||(e=Math.random()>.5?3:1),e}function $(){return 3===ce.direction||1===ce.direction||2===ce.direction}function ee(){_e=!0}function te(e){fe=Date.now()+(e||0),_e=!1}function ie(e){we=le.playerData.position.mapId,ce&&!_e&&(be.mapSide=e,be.transitionning=!0,U()&&oe())}function ne(e){ce&&!_e&&(be.transitionning=!1,be.mapSide=null,me=Ne.MAP_TRANSITION_EXIT,ae.makeActorWalkInDirection(ce,e,!0,function(){ce&&G()}))}function oe(){if(ce&&!_e&&be.transitionning&&me!==Ne.MAP_TRANSITION_EXIT){if(q()>3)return void X();me=Ne.MAP_TRANSITION_EXIT,ae.makeActorWalkInDirection(ce,be.mapSide,!1)}}function se(e,t,i){var n={base:xe[e],direction:t},o=ce;ce.animManager.addAnimation(n,function(){ce&&ce===o&&ce.animManager.assignSymbol(n,!1,function(){if(ce&&ce===o)return ce.staticAnim(),ce.animManager.cleanupAnimations(),i?i():void 0})})}var ae,re,le,ce,ue,de,he,pe,me,fe,ge,_e,ve,ye,be,we,Me=i(209).EventEmitter,Te=i(873),Ce=i(876),Ie=i(894),Ae=i(895),Se=i(896),Ee=3192,xe={HandWave:"AnimAttaque1",LookOnFloor:"AnimAttaque2",LookAround:"AnimAttaque3",AirPunchs:"AnimAttaque4",Jump:"AnimAttaque5",LetsGo:"AnimAttaque6",CrossedArms:"AnimAttaque7",GoRight:"AnimAttaque8",GoLeft:"AnimAttaque9",HeadAttack:"AnimAttaque10",JumpAndFlash:"AnimHit",JumpAndSmoke:"AnimMort"},Le={IDLE_ANIMS:["LookOnFloor","LookAround","LookAround","AirPunchs","CrossedArms","GoRight","GoLeft","HandWave","Jump"],ENTERED_MAP_ANIMS:["LetsGo","LetsGo","LetsGo","LetsGo","AirPunchs","AirPunchs","CrossedArms","LookAround"]},Ne={NOT_CREATED:0,CREATED:1,WAITING_PLAYER:2,WAITING_PLAYER_POSE:3,FIRST_MOVEMENT:4,IDLE:5,IDLE_POSE:6,IDLE_MOVE:7,MOVING_TO_EXIT:8,WAITING_FOR_PLAYER_EXIT:9,MOVING_CANCEL:10,MAP_TRANSITION_EXIT:11,MAP_TRANSITION_ENTER:12},Oe=8,De=3e3,Re=4e3,Pe=.75,Be=1e3,ke=new Me;t.initialize=d,t.stopMoving=Q,t.freeze=ee,t.unfreeze=te,t.getActor=c,t.setAnimation=se,t.removeAndClean=m,t.on=ke.on.bind(ke),t.once=ke.once.bind(ke),t.removeListener=ke.removeListener.bind(ke)},function(e,t,i){i(877),i(879),i(884),i(885),i(886),i(887),i(888),i(889),e.exports=i(878)},function(e,t,i){function n(){}var o=i(878),s=i(184),a=s.ANIM_SYMBOLS;o.prototype.getAnimSymbol=function(e,t){return t||0===t||(t=this.direction),{id:e+"_"+a[t],base:e,direction:t}},o.prototype.finalizeAnimationSymbol=function(e){e.direction||0===e.direction||(e.direction=this.direction)},o.prototype.loadAndPlayAnimation=function(e,t,i){function n(){t?o.loopAnim(e,i):o.oneShootAnim(e,!1,i)}var o=this;this.finalizeAnimationSymbol(e),this.animManager.addAnimation(e,n)},o.prototype.staticAnim=function(e){var t=e||n;this.animSymbol=this.getAnimSymbol("AnimStatique"),this.animManager.assignSymbol(this.animSymbol,!1,t),this.animated=!1},o.prototype.loopAnim=function(e,t){this.animSymbol=e,this.animated=!0,this.animManager.assignSymbol(e,!0,t)},o.prototype.oneShootAnim=function(e,t,i){var n=this;this.finalizeAnimationSymbol(e),this.animSymbol=e,this.animated=!0,this.animManager.assignSymbol(e,!1,function(){return t&&n.staticAnim(),n.animated=!1,i&&i()})},o.prototype.cleanupAnimations=function(){this.animManager.cleanupAnimations()},o.prototype.death=function(e){var t=this;this.moving&&(console.warn("kill a moving actor"),this.pathTween.stop()),this.animated&&console.warn("kill an animated actor");var i=this.getAnimSymbol("AnimMort");return this.animSymbol=i,this.animated=!0,t.actorManager.userActor===this&&this.animManager.cleanupAnimationsAndRemoveSubentities(),this.isDead=!0,this.animManager.assignSymbol(i,!1,function(){t.animated=!1,t.fighterIndicator&&t.fighterIndicator.remove(),t.removeTeamCircle(),t.actorManager.removeActor(t.actorId),t.actorManager.userActor.isDead||!window.gui.fightManager.isFightersTurn(t.actorManager.userActor.actorId)||window.gui.fightManager.getIsTurnEndRequestPending()||window.isoEngine.displayUserMovementZone()}),e&&e()},o.prototype.testAnimation=function(e,t){var i=e.animationString,n=e.direction,o=this.getAnimSymbol(i,n);this.animSymbol=o;var s=this;return this.animManager.addAnimation(o,function(){return s.animated=!0,s.animManager.addAnimation(o,function(){return s.animManager.assignSymbol(o,!0),t(s.animManager.template.hasAnimation(o.id)?"playing: "+o.id:"animation not found: "+o.id)})})}},function(e,t,i){function n(){}function o(e){e=e||{},e.data=e.data||{},l.call(this,e),this.actorId=void 0===e.actorId?null:e.actorId,this.cellId=null,this._step=0,this.path=[],this.moving=!1,this.animated=!1,this.speedAdjust=0,this.tints=null,this.data={},this.groupBoss=null,this.isInvisible=!1,this.followers=null,this.isFollower=!1,this.isLocked=!1,this.isRiding=!1,this.isDead=!1,this.canMoveDiagonally=!0,this.isolationCoefficient=0,this.pathTween=new a(this,["step"]),this.riderEntity=null,this.carriedActor=null,this.carriedEntity=null,this.parentActor=null,this.circleGraphic=null,this.icons={},this.realLook=null,this.actorManager=e.actorManager,this.fighterIndicator=null,this._turnNumberLabel=null,this.nicknameLabel=null,this._questIconLoadingStartTime=null,this.updateData(e.data)}var s=i(191).inherits,a=i(439).Tween,r=i(458),l=i(419),c=i(269),u=i(190);s(o,l),e.exports=o,o.prototype.hasFullNicknameLabelData=function(){if(this.isMerchant())return!1;var e=this.data;if(!e.humanoidInfo)return!1;for(var t=e.humanoidInfo.options||[],i=!1,n=0;n<t.length;n++){var o=t[n];if("HumanOptionOrnament"===o._type||"HumanOptionTitle"===o._type){i=!0;break}}var s=e.alignmentInfos&&0!==e.alignmentInfos.alignmentGrade;return i||s},Object.defineProperty(o.prototype,"step",{get:function(){return this._step},set:function(e){this._step=e,this.forceRefresh()}}),o.prototype._isCandidateToHideTheMountInFight=function(e){return e?Boolean(l.getLookOfRider(e))&&this.isPlayer()&&!u.showMountsInFight&&!c.isRoleplayMode:(console.error(new Error("The look is missing.")),!1)},o.prototype.setLook=function(e,t,i){var o=i||n;return e||console.error(new Error("Assigning falsy look to realLook")),this.realLook=e,this.isRiding=!!l.getLookOfRider(e),this.speedAdjust=1003===e.bonesId?25:5,this.actorManager.isCreatureModeOn&&!t.useRealLook?this.setCreatureLook(t,o):this._isCandidateToHideTheMountInFight(e)?l.prototype.setLook.call(this,l.getLookWithoutMount(e),t,o):void l.prototype.setLook.call(this,e,t,o)},o.prototype.applyLook=function(e){return this.actorManager.isCreatureModeOn?(e.look||console.error(new Error("Assigning falsy look to realLook")),void(this.realLook=e.look)):(e.animationManager&&1===e.look.bonesId&&e.look.skins[0]&&e.animationManager.addAnimationModifier("AnimStatique","AnimStatique"+e.look.skins[0]),e.animationManager&&e.animationManager!==this.animationManager&&(this.animManager.clear(),this.setAnimManager(e.animationManager)),this.staticAnim(),this.look=this._isCandidateToHideTheMountInFight(e.look)?l.getLookWithoutMount(e.look):e.look,this.look||console.error(new Error("Assigning falsy look to realLook")),void(this.realLook=this.look))},o.prototype.useRealLook=function(){return this.realLook?void this.actorManager.setActorLook(this.actorId,this.realLook,{useRealLook:!0},null):void console.warn("actorId "+this.actorId+" not real look yet...")},o.prototype.updateData=function(e){var t=window.isoEngine,i=e.disposition;if(i){var n=!0;window.actorManager.paused&&window.actorManager.userActor!==this&&(this.position=i.cellId,this.cellId=i.cellId,n=!1),this.moving&&this.actorManager.userActor===this&&c.isRoleplayMode&&(n=!t.isMovementWaitingForConfirmation),n&&this.setDisposition(i.cellId,i.direction)}switch(void 0!==e.alive&&(this.isDead=!e.alive),e.npcId&&(this.data.npcId=e.npcId,this.data.npcData=e._npcData),e.name&&(this.data.name=e.name),e.contextualId&&(this.data.actorId=e.contextualId),e._type){case"GameRolePlayCharacterInformations":this.data.accountId=e.accountId,this.data.playerId=e.contextualId,this.data.humanoidInfo=e.humanoidInfo,this.data.alignmentInfos=e.alignmentInfos,25!==this.speedAdjust&&(this.speedAdjust=5),this.processHumanoidOptions();break;case"GameRolePlayMutantInformations":this.data.accountId=e.accountId,this.data.playerId=e.contextualId,this.data.humanoidInfo=e.humanoidInfo,this.data.monsterId=e.monsterId,this.data.powerLevel=e.powerLevel,this.processHumanoidOptions();break;case"GameRolePlayNpcWithQuestInformations":this.addQuestIcon(e.questFlag);break;case"GameFightMonsterInformations":case"GameFightMonsterWithAlignmentInformations":this.data.contextualId=e.contextualId,this.data.isBoss=e._isBoss,this.data.isSummon=e.stats&&e.stats.summoned,this.data.creatureGenericId=e.creatureGenericId;break;case"GameRolePlayGroupMonsterInformations":this.data.ageBonus=e.ageBonus,this.data.alignmentSide=e.alignmentSide,this.data.contextualId=e.contextualId,this.data.hasHardcoreDrop=e.hasHardcoreDrop,this.data.keyRingBonus=e.keyRingBonus,this.data.lootShare=e.lootShare,this.data.staticInfos=e.staticInfos,this.data.scaleLevel=e.scaleLevel,e.hasHardcoreDrop&&this.addIcon("hardcoreDrop");var o=e.staticInfos.mainCreatureLightInfos.staticInfos;if(o&&o.isMiniBoss)this.addIcon("miniBoss");else if(!u.showAllMonsters){var s=e.staticInfos.underlings;if(s)for(var a=0;a<s.length;a++)s[a].staticInfos.isMiniBoss&&this.addIcon("miniBoss")}break;case"GameRolePlayPrismInformations":this.data.prism=e.prism,this.data.contextualId=e.contextualId;break;case"GameRolePlayTaxCollectorInformations":this.data.contextualId=e.contextualId,this.data.taxCollectorAttack=e.taxCollectorAttack;var r=e.identification.guildIdentity;this.data.guild={guildLevel:e.guildLevel,guildEmblem:r.guildEmblem,guildId:r.guildId,guildName:r.guildName},this.data.taxCollector={lastNameId:e.identification.lastNameId,firstNameId:e.identification.firstNameId};break;case"FightTeamInformations":case"FightAllianceTeamInformations":case"FightTeamLightInformations":this.data.fightId=e.fightId,this.data.teamId=e.teamId,this.data.leaderId=e.leaderId,this.data.teamSide=e.teamSide,this.data.teamTypeId=e.teamTypeId,this.data.teamMembers=e.teamMembers;break;case"GameFightCharacterInformations":this.data.playerId=e.contextualId;break;case"PaddockObject":this.data.durability=e.durability;break;case"GameRolePlayMountInformations":this.data.level=e.level,this.data.ownerName=e.ownerName}this.data.type=e._type},o.prototype.updateRestrictions=function(e){if(this.data.humanoidInfo&&(this.data.humanoidInfo.restrictions=e),this.canMoveDiagonally=!e.cantWalk8Directions,this.canMoveDiagonally===!1&&0===(1&this.direction)){var t=this.direction+1;t>7&&(t=1),this.setDisposition(this.position,t)}},o.prototype.processHumanoidOptions=function(){if(this.actorManager.removeActorFollowers(this,!0),this.data.humanoidInfo&&this.data.humanoidInfo.options)for(var e=this.data.humanoidInfo.options,t=0;t<e.length;t++){var i=e[t];"HumanOptionAlliance"===i._type?this.addConquestIcon(i):"HumanOptionFollowers"===i._type&&this.actorManager.addActorFollowers(this,i.followingCharactersLook,!0)}},o.prototype.remove=function(){this.removeIcons(),(this.pathTween.playing||this.pathTween.starting)&&this.pathTween.stop(),this.actorManager._removeActor(this),l.prototype.remove.call(this)},o.prototype.getFighter=function(){return window.gui.fightManager.getFighter(this.actorId)},o.prototype.getFighterData=function(){var e=this.getFighter();return e?e.data:(console.warn("Fighter "+this.actorId+" could not be found."),new r)},o.prototype.isNPC=function(){return Boolean(this.data&&this.data.npcId)},o.prototype.getTeamId=function(){return this.getFighterData().teamId},o.prototype.isPlayer=function(){return this.isMerchant()||this.data.playerId&&!this.isFollower},o.prototype.isOnlinePlayer=function(){return this.data.playerId&&!this.isFollower},o.prototype.isMerchant=function(){var e=this.data.name&&"GameRolePlayMerchantInformations"===this.data.type;return e},o.prototype.refreshLook=function(e){this.actorManager.setActorLook(this.actorId,this.realLook,{},e)}},function(e,t,i){function n(e,t,i,n,o,s){this.c=e,this.x=t,this.y=i,this.d=n,this.a=o,this.m=s}var o=i(878),s=i(184),a=i(756),r=i(269),l=i(880),c=s.TIME_UNITS_PER_SECOND,u={mounted:{linear:135,horizontal:200,vertical:120,symbolId:"AnimCourse"},parable:{linear:400,horizontal:500,vertical:450,symbolId:"FX"},running:{linear:170,horizontal:255,vertical:150,symbolId:"AnimCourse"},walking:{linear:480,horizontal:510,vertical:425,symbolId:"AnimMarche"},slide:{linear:57,horizontal:85,vertical:50,symbolId:"AnimStatique"}};o.prototype.setCellPosition=function(e){this.actorManager.removeActorOccupation(this),this.cellId=e,this.actorManager.addActorOccupation(this),this.carriedActor&&this.carriedActor.setCellPosition(e)},o.prototype.setOnScreenPosition=function(e){var t=this.actorManager.isoEngine,i=t.mapRenderer.map,n=a.cellCoord[e],o=0;i&&(r.isRoleplayMode?o=i.cells[e].f||0:this._positionCircle()),this.position=e,this.x=n.x,this.y=n.y-o,this._positionIcons()},o.prototype.setDisposition=function(e,t){this.moving&&this.cancelMovement(),!e&&0!==e||e===-1||(this.setOnScreenPosition(e),this.setCellPosition(e)),(t||0===t)&&(this.direction=t),this.animated||this.staticAnim()},o.prototype.noMovement=function(){this.moving&&(this.pathTween.removeOnFinish(),this.pathTween.stop(),this.moving=!1,this.isLocked&&(this.isLocked=!1),this.step=0,this.path=[])},o.prototype.cancelMovement=function(e){var t=this;this.pathTween.removeOnFinish(),this.pathTween.stop();var i=~~this.step,n=i+1,o=this.path[i].m*(1-this.step+i),s=this.path[n].c;this.pathTween.reset().from({step:this.step}).to({step:n},o),this.pathTween.start(!1),this.pathTween.onceFinish(function(){if(t.moving=!1,t.step=0,t.path=[],t.setCellPosition(s),t.actorId===window.gui.playerData.id&&window.dofus.sendMessage("GameMapMovementCancelMessage",{cellId:s}),t.moving||t.setDisposition(s),e)return e()})},o.prototype.switchPath=function(e,t){var i=this;this.pathTween.removeOnFinish(),this.pathTween.stop();var n=~~this.step,o=n+1,s=this.path[n].m*(1-(this.step-n));this.pathTween.reset().from({step:this.step}).to({step:o},s),this.pathTween.start(!1),this.pathTween.onceFinish(function(){return i.moving=!1,i.step=0,i.path=[],1===e.length?(i.setDisposition(e[0]),t()):(i.setPath(e,{cb:t}),void i.setCellPosition(e[e.length-1]))})},o.prototype.isPathMatchingServerPath=function(e,t){var i=e[e.length-1],n=this.path;if(n[n.length-1].c===i)return!0;var o;for(o=n.length-2;o>=0&&n[o].c!==i;o--);var s=~~this.step;if(s>=o)return!1;for(var a=n[s+1].c,r=e.length-1;r>=0&&(t.unshift(e[r]),e[r]!==a);r--);return!1},o.prototype.refreshAnimation=function(e){if(this.moving===!0){var t=~~this._step,i=this._step-t,n=this.path[t];if(n){var o=this.path[t+1]||this.path[t];this._x=n.x+(o.x-n.x)*i,this._y=n.y+(o.y-n.y)*i,i>.5&&this._position!==o.c&&(this.position=o.c),this.animSymbol.id===n.a.id&&this.direction===n.d||(this.animSymbol=n.a,this.direction=n.d,this.animManager.assignSymbol(this.animSymbol,!0))}}this._refreshAnimation(e),this._positionIcons(),this._positionCircle()},o.prototype._startPath=function(e){var t=this,i=this.path,n=i[0].m;this.step=0,this.pathTween.reset().from({step:0}).to({step:1},n);for(var o=1,s=this.path.length-1;o<s;o++)n=i[o].m,this.pathTween.to({step:o+1},n);this.animManager.isTemporary||(this.animSymbol=i[0].a,this.animManager.assignSymbol(this.animSymbol,!0)),this.moving?console.warn('[Actor._startPath] error: actor "'+this.actorId+'" is already moving.'):(this.pathTween.start(!1),this.pathTween.onceFinish(function(){t.moving=!1,r.isRoleplayMode&&l.hasFullNicknameLabelData(t)&&t.nicknameLabel&&t._hadFullNicknameLabel&&"name"===t.nicknameLabel.getType()&&t.nicknameLabel.set(t,"full");var i=t.path[t.path.length-1];return t.animSymbol=i.a,t._x=i.x,t._y=i.y,t.animManager.assignSymbol(t.animSymbol,!1),e&&e()})),this.moving=!0,this.nicknameLabel&&"full"===this.nicknameLabel.getType()&&this.nicknameLabel.set(this,"name")},o.prototype.walkToSceneCoordinate=function(e,t,i,o,s){var a=this.getAnimSymbol("AnimMarche",i),r=this.getAnimSymbol("AnimStatique",i);this.path=[new n(this.cellId,this._x,this._y,i,a,o),new n(this.cellId,e,t,i,r,0)],this._startPath(s)},o.prototype.setPath=function(e,t){var i=t&&t.cb,o=this.actorManager.isoEngine;if(!o.mapRenderer.isReady)return console.warn("setPath: renderer was not ready"),i();if(e.length<=1)return i&&i();var s=t&&t.slide,l=t&&t.forceWalk;this.path=[],this.step=0;var d,h,p,m;m=s?u.slide:this.isRiding?u.mounted:e.length>3&&!l?u.running:u.walking;var f,g=(1+this.speedAdjust/10||.001)*c,_=null;if(o.mapRenderer.map)_=o.mapRenderer.map.cells;else{var v="actorId: "+this.actorId;console.error(new Error("Actor#setPath: map is null, cells are unknown "+v))}for(var y=0;y<e.length;y++){var b=e[y],w=0;r.isFightMode?w=0:_&&_[b]&&_[b].f&&(w=_[b].f);var M,T=a.cellCoord[b];0===y?f=1:T.y===p?(M=m.horizontal,f=T.x>h?0:4):T.x===h?(M=m.vertical,f=T.y>p?2:6):(M=m.linear,f=T.x>h?T.y>p?1:7:T.y>p?3:5),M/=g,s&&(f=this.direction);var C=this.getAnimSymbol(m.symbolId,f);y>0&&(d.d=f,d.a=C,d.m=M),this.path.push(new n(b,T.x,T.y-w,f,C,M)),d=this.path[this.path.length-1],h=T.x,p=T.y}var I,A,S=this.animManager,E=S.isTemporary?{}:S.template.exposedSymbols,x=this.getAnimSymbol("AnimStatique",f),L=this.getAnimSymbol("AnimStatique_to_"+this.path[0].a.base,this.path[0].a.direction),N=this.getAnimSymbol(m.symbolId+"_to_"+x.base,f);E[L.id]&&(I=this.path[0],A=S.getSymbolDuration(L.id),this.path.unshift(new n(I.c,I.x,I.y,I.d,L,A))),E[N.id]&&(I=this.path[this.path.length-1],A=S.getSymbolDuration(N.id),I.a=N,I.m=A,this.path.push(new n(I.c,I.x,I.y,I.d,x,I.m))),this.path[this.path.length-1].a=x,this._startPath(i)}},function(e,t,i){i(881),e.exports=i(882)},function(e,t,i){var n=i(882);n.prototype.updatePosition=function(e,t){this.x=e-this.w/2,this.y=t-this.h},n.prototype.setTexture=function(e){this.hide(),this.clearTexture(),this.w=e.width,this.h=e.height,"none"===this._textureId?this.texture=window.isoEngine.mapScene.createTexture(e,this.id,"nearest","throwable"):this.texture=window.isoEngine.mapScene.createTexture(e,this._textureId,"nearest","archivable")},n.prototype.clearTexture=function(){this.texture&&(this.texture.release(),this.texture=null)},n.prototype.clear=function(){this.clearTexture()}},function(e,t,i){function n(){var e={x:300,y:300,id:"nicknameLabelCount"+S++,scene:window.isoEngine.mapScene,layer:a.MAP_LAYER_FOREGROUND,position:0};s.call(this,e,e.scene.renderer.getEmptyTexture()),this._charName=null,this._title=null,this._titleId=null,this._ornamentId=null,this._ornamentAssetId=null,this._guild=null,this._gender=null,this._alliance=null,this._alignment=null,this._nicknameLabelCanvas=new p,this._textCanvas=this._nicknameLabelCanvas.getTextCanvas(),this._canvas=this._nicknameLabelCanvas.getCanvas(),this._guildEmblem=new l({width:40,height:40}),this._allianceEmblem=new l({width:40,height:40}),this._textureId="none"}var o=i(191).inherits,s=i(759),a=i(184),r=i(31),l=i(469),c=i(471),u=i(30),d=i(472),h=i(202),p=i(883),m=160,f=40,g=16,_=16,v=19,y=g+"px Arial",b=_+"px Arial",w=v+"px Arial",M=10,T=5,C=40,I=10,A=C+I,S=0;o(n,s),e.exports=n,n.hasFullNicknameLabelData=function(e){if(e.isMerchant())return!1;var t=e.data;if(!t.humanoidInfo)return!1;for(var i=t.humanoidInfo.options||[],n=!1,o=0;o<i.length;o++){var s=i[o];if("HumanOptionOrnament"===s._type||"HumanOptionTitle"===s._type){n=!0;break}}var a=t.alignmentInfos&&0!==t.alignmentInfos.alignmentGrade;return n||a},n.prototype.getType=function(){return this._type},n.prototype.set=function(e,t){this._nicknameLabelCanvas.clearAll(),this._type=t,this.hasOrnament=!1,this.hasGuild=!1,this.hasAlliance=!1,this.hasTitle=!1,this.hasWings=!1;var i=e.data,n={};if(n.name=i.name,"full"===t){for(var o,s,a,r,l=i.humanoidInfo.options||[],c=0;c<l.length;c+=1){var u=l[c];"HumanOptionGuild"===u._type?(a=u.guildInformations,this.hasGuild=!0):"HumanOptionAlliance"===u._type?(r=u.allianceInformations,this.hasAlliance=!0):"HumanOptionOrnament"===u._type?(s=u.ornamentId,this.hasOrnament=!0):"HumanOptionTitle"===u._type&&(o=u.titleId,this.hasTitle=!0)}i.alignmentInfos&&0!==i.alignmentInfos.alignmentGrade&&(this.hasWings=!0);var d=i.alignmentInfos.characterPower-i.actorId,h=window.gui.playerData.getLevelDiff(d);this.setAttributes({charName:i.name,titleId:o,ornamentId:s,guild:a,alliance:r,gender:i.humanoidInfo.sex,alignmentInfos:i.alignmentInfos,levelDiff:h}),this.hasNameOnly=!1,n.gender=i.humanoidInfo.sex,n.guild=a,n.alliance=r,n.alignment=i.alignmentInfos,n.titleId=o,n.ornamentId=s}else this.setAttributes({charName:i.name}),this.hasNameOnly=!0;this._setTextureId(n),this.displayOnActor(e)},n.prototype._setTextureId=function(e){this._textureId=e.name,this.hasNameOnly||(this.hasGuild&&(this._textureId+=".g"+e.guild.guildId),this.hasAlliance&&(this._textureId+=".a"+e.alliance.allianceId),this.hasTitle&&(this._textureId+=".t"+e.titleId),this.hasWings?this._textureId+=".w"+e.alignment.alignmentSide+"."+e.alignment.alignmentGrade:this.hasOrnament&&(this._textureId+=".o"+e.ornamentId))},n.prototype.setAttributes=function(e){e=e||{},this._charName=e.hasOwnProperty("charName")?e.charName:null,this._guild=e.hasOwnProperty("guild")?e.guild:null,this._alliance=e.hasOwnProperty("alliance")?e.alliance:null,this._alignment=e.hasOwnProperty("alignmentInfos")?e.alignmentInfos:null,this._levelDiff=e.levelDiff,this._ornamentId=e.hasOwnProperty("ornamentId")?e.ornamentId:null,this._ornamentAssetId=e.hasOwnProperty("ornamentAssetId")?e.ornamentAssetId:null,this._title=e.hasOwnProperty("title")?e.title:null,this._titleId=e.hasOwnProperty("titleId")?e.titleId:null,this._gender=e.hasOwnProperty("gender")?e.gender:null},n.prototype.changeAttributes=function(e){e=e||{};for(var t in e)this.hasOwnProperty("_"+t)&&(this["_"+t]=e[t])},n.prototype.displayOnActor=function(e){var t=this,i=function(i){if(window.actorManager.getActor(e.actorId)){if(i)return console.error(i);t.hasWings?t._nicknameLabelCanvas.updateWithWings():t._nicknameLabelCanvas.update(),t.setTexture(t._canvas);var n=e.bbox,o=n[0]+(n[1]-n[0])/2,s=n[2];t.x=o-t.w/2,t.y=s-t.h,t.show()}};this.display(i)},n.prototype.display=function(e){var t=this;t.hide(),this._preload(function(i){return i?e(i):(t._calculateDimension(),!t._ornamentAssetId||t._alignment&&0!==t._alignment.alignmentGrade?(t._resizeTextCanvas(t._textWidth,t._textHeight,0,0),t._displayText(),t._alignment&&0!==t._alignment.alignmentGrade?t._displayWings(e):e()):(1===t._textCanvas.width&&t._displayTextAndOrnament(),e()))})},n.prototype._loadOrnament=function(e){var t=this;r.series([function(e){return t._ornamentId?void u.getData("Ornaments",t._ornamentId,function(i,n){return i?e(i):n?(t._ornamentAssetId=n.assetId,void e()):e("staticContent.getData Ornaments - ornamentData is "+n)}):e()},function(e){return t._ornamentAssetId?void c.loadModel("ornaments","ornament_"+t._ornamentAssetId,function(i,n){t._jsonObj=i,t._image=n,e()}):e()}],e)},n.prototype._preload=function(e){var t=this;r.parallel([function(e){t._loadOrnament(e)},function(e){return t._titleId?void u.getData("Titles",t._titleId,function(i,n){return i?e(i):n?(t._title=t._gender?n.nameFemaleId:n.nameMaleId,void e()):e("staticContent.getData Titles - titleData is "+n)}):e()},function(e){return t._guild&&t._guild.guildEmblem?void t._guildEmblem.setValue(t._guild.guildEmblem,!0,e):e()},function(e){return t._alliance&&t._alliance.allianceEmblem?void t._allianceEmblem.setValue(t._alliance.allianceEmblem,!0,e):e()},function(e){if(!t._alignment||0===t._alignment.alignmentGrade)return e();var i=window.gui.playerData.alignment;i.getTopWings(t._alignment,function(i){i&&(t._topWingsInfo=i),e()})},function(e){if(!t._alignment||0===t._alignment.alignmentGrade)return e();var i=window.gui.playerData.alignment;i.getBottomWings(t._alignment,function(i){i&&(t._bottomWingsInfo=i),e()})}],e)},n.prototype._calculateDimension=function(){var e=this._textCanvas.getContext("2d"),t=[],i=0,n=0;if(e.font=b,this._nameWidth=e.measureText(this._charName).width,t.push(this._nameWidth),n=_,this.hasNameOnly?(m=0,f=0,M=3,T=0):(m=160,f=40,M=10,T=5),this.hasGuild){var o=this._guild.guildName;e.font=y,this._guildNameWidth=e.measureText(o).width,t.push(this._guildNameWidth+A),t.push(this._nameWidth+A),n+=T+g}if(this.hasAlliance&&(t.push(this._guildNameWidth+2*A),t.push(this._nameWidth+2*A)),this.hasTitle){e.font=w;var s=this._title,a=e.measureText(s).width;t.push(a),n+=T+v}i=Math.max.apply(null,t)+2*M,n+=2*M,i=Math.round(i),n=Math.round(n),this._textWidth=Math.max(i,m),this._textHeight=Math.max(n,f),this._diffWidth=this._textWidth-m,this._diffHeight=this._textHeight-f},n.prototype._displayText=function(){var e=this._textWidth,t=this._textHeight;this._nicknameLabelCanvas.displayTextBackground(e,t);var i=Math.max(this._guildNameWidth||0,this._nameWidth),n=i+(this.hasGuild?A:0)+(this.hasAlliance?A:0),o=Math.round(i/2),s=Math.round((e-n)/2)+(this._guild?A:0),a=M;if(this.hasNameOnly&&(a=0),this.hasGuild&&(a+=g,this._nicknameLabelCanvas.displayText(this._guild.guildName,s+o,a,y,"#ffffff"),a+=T),this._charName&&(a+=_,this._nicknameLabelCanvas.displayText(this._charName,s+o,a,b,"#ffffff"),a+=T),this.hasTitle){a+=v;var r=this._title;this._nicknameLabelCanvas.displayText(r,Math.round(e/2),a,w,"#00B346")}this.hasGuild&&this._nicknameLabelCanvas.displayImage(this._guildEmblem.getContext().canvas,s-A,M,40,40),this.hasAlliance&&this._nicknameLabelCanvas.displayImage(this._allianceEmblem.getContext().canvas,s+i+I,M,40,40)},n.prototype._displayWings=function(e){this._alignment&&this._alignment.alignmentSide!==d.ALIGNMENT_NEUTRAL&&0!==this._alignment.alignmentGrade&&(this._glowMargin=20,this._opacity=this._levelDiff===-1?.6:1,this._shadowBlur=1===this._levelDiff?this._glowMargin:0,this._shadowColor=this._alignment.alignmentSide===d.ALIGNMENT_ANGEL?"#ffffff":"#ff0018",this._getWingsImages(e))},n.prototype._getWingsImages=function(e){var t=this;r.parallel([function(e){h.loadImage(t._topWingsInfo.imagePath,function(i){t._nicknameLabelCanvas.displayWingPart(i,t._topWingsInfo,!0),e()})},function(e){return t._bottomWingsInfo?void h.loadImage(t._bottomWingsInfo.imagePath,function(i){t._nicknameLabelCanvas.displayWingPart(i,t._bottomWingsInfo,!1),e()}):e()}],e)},n.prototype._displayTextAndOrnament=function(){var e=this._diffWidth,t=this._diffHeight,i=this._jsonObj;
if(i){var n=this._image,o=Math.round(e/2),s=Math.round(t/2);for(var a in i.symbols){var r=i.symbols[a];if(r.className&&r.className.indexOf("ornament_")!==-1){this._resizeOrnament(r);for(var l=r.children.length-1;l>=0;l--){var c=r.children[l],u=c.id,d=i.symbols[u],h=c.matrices[0],p=i.matrices[h],g=p[0],_=p[1],v=p[2],y=p[3],b=p[4],w=p[5];switch(c.name){case"left":w+=s;break;case"right":b+=e,w+=s;break;case"picto":b+=o;break;case"top":b+=o;break;case"bottom":b+=o,w+=t}this._nicknameLabelCanvas.saveAndTransform(g,_,v,y,b,w),this._nicknameLabelCanvas.displayTextAndOrnament(c.name,n,d,e,t,m,f),"bg"===c.name&&this._displayText(),this._nicknameLabelCanvas.restore()}}}}},n.prototype._resizeTextCanvas=function(e,t,i,n){var o=this._textCanvas.getContext("2d");this._textCanvas.width=e,this._textCanvas.height=t,o.clearRect(0,0,e,t),o.translate(i,n)},n.prototype._resizeOrnament=function(e){var t=1/0,i=1/0,n=-(1/0),o=-(1/0);if(e.children.length){for(var s=e.children.length-1;s>=0;s--){var a=e.children[s],r=a.id,l=this._jsonObj.symbols[r];if(l.isGraphic){var c=a.matrices[0],u=this._jsonObj.matrices[c],d=u[4]+l.x||0,h=u[5]+l.y||0;t=Math.min(t,h),i=Math.min(i,d),n=Math.max(n,d+l.w),o=Math.max(o,h+l.h)}}var p=Math.round(n-i+this._diffWidth),m=Math.round(o-t+this._diffHeight);this._resizeTextCanvas(p,m,-i,-t)}}},function(e,t){function i(){this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._topCanvas=document.createElement("canvas"),this._topCtx=this._topCanvas.getContext("2d"),this._bottomCanvas=document.createElement("canvas"),this._bottomCtx=this._bottomCanvas.getContext("2d"),this._textCanvas=document.createElement("canvas"),this._textCtx=this._textCanvas.getContext("2d"),this._canvas.width=1,this._canvas.height=1,this._topCanvas.width=1,this._topCanvas.height=1,this._bottomCanvas.width=1,this._bottomCanvas.height=1,this._bottomOffset=0,this._textCanvas.width=1,this._textCanvas.height=1,this._textOffset=0,this._top=!1,this._bottom=!1,this._text=!1,this._canvasHasContents=!1}function n(e){e.width=1,e.height=1}e.exports=i,i.prototype.displayTextBackground=function(e,t){var i=this._textCtx;i.fillStyle="rgba(0, 0, 0, 0.8)";var n=5;i.beginPath(),i.moveTo(n,0),i.lineTo(e-n,0),i.quadraticCurveTo(e,0,e,n),i.lineTo(e,t-n),i.quadraticCurveTo(e,t,e-n,t),i.lineTo(n,t),i.quadraticCurveTo(0,t,0,t-n),i.lineTo(0,n),i.quadraticCurveTo(0,0,n,0),i.closePath(),i.fill(),i.textAlign="center"},i.prototype.displayText=function(e,t,i,n,o){var s=this._textCtx;s.font=n,s.fillStyle=o,s.fillText(e,t,i)},i.prototype.displayImage=function(e,t,i,n,o){this._textCtx.drawImage(e,t,i,n,o)},i.prototype._syncCanvas=function(e,t,i){var n=document.createElement("canvas"),o=n.getContext("2d");n.width=Math.max(this._canvas.width,t.width);var s=0;t.width>this._canvas.width&&(s=t.width/2-this._canvas.width/2);var a=n.width/2-t.width/2;e?(n.height=this._canvas.height+t.height+i,o.drawImage(t,a,0),this._canvasHasContents&&o.drawImage(this._canvas,s,t.height+i)):(n.height=this._canvas.height+t.height+i,o.drawImage(t,a,this._canvas.height+i),this._canvasHasContents&&o.drawImage(this._canvas,0,0)),this._canvas.width=n.width,this._canvas.height=n.height,this._ctx.drawImage(n,0,0)},i.prototype.updateWithWings=function(){n(this._canvas),this._top?(this._canvasHasContents=!0,this._syncCanvas(!1,this._textCanvas,0),this._syncCanvas(!0,this._topCanvas,this._textOffset)):this._syncCanvas(!1,this._textCanvas,0),this._bottom&&this._syncCanvas(!1,this._bottomCanvas,this._bottomOffset)},i.prototype.update=function(){n(this._canvas),this._syncCanvas(!1,this._textCanvas,0)},i.prototype.clearAll=function(){n(this._canvas),this._canvasHasContents=!1,n(this._topCanvas),this._top=!1,this._textOffset=0,n(this._bottomCanvas),this._bottom=!1,this._bottomOffset=0,n(this._textCanvas),this._text=!1},i.prototype.displayWingPart=function(e,t,i){var o=document.createElement("canvas"),s=o.getContext("2d");o.height=e.height,o.width=e.width,s.drawImage(e,0,0),i?(n(this._topCanvas),this._textOffset=-(t.top+o.height),this._topCanvas.width=o.width,this._topCanvas.height=o.height,this._topCtx.drawImage(o,0,0),this._top=!0):(n(this._bottomCanvas),this._bottomOffset=t.top-o.height,this._bottomCanvas.width=o.width,this._bottomCanvas.height=o.height,this._bottomCtx.drawImage(o,0,0),this._bottom=!0)},i.prototype.saveAndTransform=function(e,t,i,n,o,s){var a=this._textCtx;a.save(),a.transform(e,t,i,n,o,s),this._isTransformed=!0},i.prototype.restore=function(){var e=this._textCtx;this._isTransformed&&(this._isTransformed=!1,e.restore())},i.prototype.displayTextAndOrnament=function(e,t,i,n,o,s,a){var r=this._textCtx;if("bg"===e){var l=i.sw/i.w,c=i.sh/i.h,u=.5*s-i.x,d=.5*a-i.y,h=i.w+i.x-.5*s,p=i.h+i.y-.5*a;r.drawImage(t,i.sx,i.sy,u*l,d*c,i.x,i.y,u,d),r.drawImage(t,i.sx+u*l,i.sy,h*l,d*c,i.x+u+n,i.y,h,d),r.drawImage(t,i.sx,i.sy+d*c,u*l,p*c,i.x,i.y+d+o,u,p),r.drawImage(t,i.sx+u*l,i.sy+d*c,h*l,p*c,i.x+u+n,i.y+d+o,h,p),r.drawImage(t,i.sx+u*l,i.sy,1*l,d*c,i.x+u,i.y,n,d),r.drawImage(t,i.sx+u*l,i.sy+d*c,1*l,p*c,i.x+u,i.y+d+o,n,p),r.drawImage(t,i.sx,i.sy+d*c,u*l,1*c,i.x,i.y+d,u,o),r.drawImage(t,i.sx+u*l,i.sy+d*c,u*l,1*c,i.x+u+n,i.y+d,u,o)}else r.drawImage(t,i.sx,i.sy,i.sw,i.sh,i.x,i.y,i.w,i.h)},i.prototype.getCanvas=function(){return this._canvas},i.prototype.getTextCanvas=function(){return this._textCanvas}},function(e,t,i){var n=i(878),o=i(29).getText,s=i(619).npcActionRequest,a=i(873),r=i(225);n.prototype.openPlayerContextualMenu=function(e){var t=this.data;if(!t||!t.accountId)return void console.error("openPlayerContextualMenu was called on non player actor",this.actorId);var i=this.cellId;window.gui.openContextualMenu("player",{accountId:t.accountId,playerId:t.playerId,playerName:t.name,cellId:i,isMutant:"GameRolePlayMutantInformations"===t.type,humanoidInfoOptions:t.humanoidInfo&&t.humanoidInfo.options,alignmentInfos:t.alignmentInfos,isInteractiveRequired:!0},e)},n.prototype.openNpcContextualMenu=function(e){var t=this.data;if(!t||!t.npcData)return void console.error("openNpcContextualMenu was called on non npc actor",this.actorId);var i=window.isoEngine,n=i.mapRenderer.map.id,o=this.actorId;return 1===t.npcData.actions.length&&window.gui.playerData.isAlive()?(i.highlightActorOnAction(o),s(t.npcData,this.actorId,n,t.npcData.actions[0])):void window.gui.openContextualMenu("npc",{actorId:o,npcId:t.npcId,npcData:t.npcData,mapId:n},e)},n.prototype.openMerchantContextualMenu=function(e){var t=this.data,i=this.actorId;window.gui.openContextualMenu("merchant",{id:i,name:t.name,cellId:this.cellId},e)},n.prototype.tap=function(e,t){var i=this.actorId,n=this.cellId,s=this.data,l=this.scene.convertSceneToCanvasCoordinate(e,t),c={x:l.x,y:l.y,isCanvasCoordinate:!0},u=window.isoEngine.getCellActors(n).length,d=window.isoEngine.getCellActorsByTypes(n),h=d.onlinePlayer,p=h.length,m=d.merchantPlayer,f=d.npc,g=d.other;if(1===u)switch(s.type){case"GameRolePlayGroupMonsterInformations":window.gui.openContextualMenu("monster",s,c);break;case"GameRolePlayPrismInformations":window.gui.openContextualMenu("prism",s,c);break;case"GameRolePlayTaxCollectorInformations":s.mapId=window.isoEngine.mapRenderer.map.id,window.gui.openContextualMenu("taxCollector",s,c);break;case"GameRolePlayNpcInformations":case"GameRolePlayNpcWithQuestInformations":var _=window.isoEngine,v=_.mapRenderer.map.id,y=s.npcId;if(!y)return;var b=s.npcData;if(!b)return console.error("NPC id",y,"missing in database on mapId",v);this.openNpcContextualMenu(c);break;case"GameRolePlayCharacterInformations":case"GameRolePlayMutantInformations":1===p?this.openPlayerContextualMenu(c):this.isFollower||console.error("nbOnlinePlayersOnCell has an unexpected value (< 1): ",p,this.actorId);break;case"GameRolePlayMerchantInformations":this.openMerchantContextualMenu(c);break;case"FightTeamInformations":case"FightAllianceTeamInformations":case"FightTeamLightInformations":window.gui.openContextualMenu("fightTeam",s,c);break;case"GameFightCharacterInformations":window.gui.openContextualMenu("player",{playerId:s.playerId,playerName:s.name,isMutant:!1},c);break;case"GameRolePlayMountInformations":var w=[{caption:o("ui.mount.viewMountDetails"),cb:function(){r.getWindow("mount").showPaddockMount(i)}}];window.gui.openContextualMenu("generic",{title:(s.name||o("ui.common.noName"))+"\n"+o("ui.mount.mountOf",s.ownerName)+"\n"+o("ui.common.rank",s.level),actions:w},c);break;case"GameFightMutantInformations":case"GameFightMonsterInformations":case"GameFightMonsterWithAlignmentInformations":case"GameFightTaxCollectorInformations":return;case"PaddockObject":window.gui.openContextualMenu("paddockObject",{cellId:n,paddockObjectName:this.data.name},c);break;case"BeginnerAssistant":a.openDialog()}else window.gui.openContextualMenu("playersList",{coordinates:c,actors:h,merchant:m[0],npc:f[0],monster:g[0]})}},function(e,t,i){var n=i(878),o=i(439).Tween,s={red:0,green:0,blue:0,alpha:0},a={red:1,green:1,blue:1,alpha:.6};n.prototype.setInvisibility=function(e,t){if(this.showTeamCircle(1!==e),3===e)this.removeHighlight(),this.isInvisible=!1,this.actorManager.addActorOccupation(this);else{var i=this.actorManager.userActor.getTeamId();t===i?this.setHighlight(a):(this.setHighlight(s),this.actorManager.turnIndicatorOff()),this.isInvisible=!0,this.actorManager.removeActorOccupation(this)}},n.prototype.invisibleDetectedAnimation=function(){var e={red:0,green:0,blue:0,alpha:1};this.setHighlight(e),new o(this.highlight,["alpha"]).from({alpha:1}).to({alpha:0},30).start(!1)}},function(e,t,i){var n=i(878),o=i(419),s=i(441),a=i(444),r=a.HOOK_POINT_CATEGORY_MOUNT_DRIVER,l=a.HOOK_POINT_CATEGORY_LIFTED_ENTITY;n.prototype.addSubentity=function(e,t,i){var n=this;o.prototype.addSubentity.call(this,e,t,function(t){return e.bindingPointCategory===r&&(n.riderEntity=t),i&&i(t)})},n.prototype.carryCharacter=function(e){var t=this;if(this.animManager.isTemporary)return console.warn("Actor animManager is not ready."),void window.setTimeout(function(){t.carryCharacter(e)},2e3);var i=window.actorManager,n={animManager:e.animManager,bindingPoint:"carried_3_0",symbolModifier:s[l],bindingPointCategory:l};e.getFighterData().isCarryied=!0,e.parentActor=t,t.carriedEntity=n,t.carriedActor=e;var o=!i.isCreatureModeOn&&this.riderEntity||this.animManager;o.addAnimation({base:"carrying",direction:-1},function(){i.isCreatureModeOn||(o.addAnimationModifier("AnimStatique","AnimStatiqueCarrying"),o.addAnimationModifier("AnimMarche","AnimMarcheCarrying"),o.addAnimationModifier("AnimCourse","AnimCourseCarrying"),o.addAnimationModifier("AnimHit","AnimHitCarrying"),o.addAnimationModifier("AnimTacle","AnimTacleCarrying")),o.addSubentity(n),e.setDisposition(t.cellId),e.y=-1e3,t.staticAnim()})}},function(e,t,i){function n(e,t,i){return e===t?"ally":e===i?"defender":"attacker"}function o(e){var t=0,i=window.gui.playerData.characterBaseInformations.level;return i>=e.levelMin&&i<=e.levelMax&&(t+=2),e.repeatType!==A&&(t+=1),t}function s(e,t){var i=e.questsToValidId.concat(e.questsToStartId);_.getDataMap("Quests",i,function(e,i){if(e)return t(e);var n,s;for(var a in i){var r=i[a];if(r){var l=o(r);(!n||s<l)&&(s=l,n=r)}}return t(null,n)})}function a(e,t){s(e,function(i,n){if(i)return t(i);if(!n)return t();var o;return o=e.questsToStartId.indexOf(n.id)!==-1?n.repeatType===A?"questClip":"questRepeatableClip":n.repeatType===A?"questObjectiveClip":"questRepeatableObjectiveClip",t(null,o)})}var r=i(878),l=i(184),c=i(425),u=i(759),d=i(430),h=i(426),p=i(523),m=i(439).Delay,f=i(533),g=i(522),_=i(30),v=l.CELL_HEIGHT,y=v/2,b=24,w={QUEST:1,DEFAULT:2,AVA:3,SMILEY:4,UI:5},M={miniBoss:"archmonsters",hardcoreDrop:"treasure",defender:"defender",attacker:"forward",ally:"ownTeam",disqualified:"neutral",prequalified:"clock"},T=5,C=5,I=72,A=0,S=new m;r.prototype._getIcon=function(e,t){return this.icons.hasOwnProperty(t)?this.icons[t][e]:null},r.prototype._setIcon=function(e,t,i){this.icons.hasOwnProperty(i)||(this.icons[i]={}),this.icons[i][t]=e},r.prototype.addConquestIcon=function(e){var t=window.gui.playerData,i=!1,o=t.characters.mainCharacter.characteristics;if(o){var s=o&&o.alignmentInfos.aggressable;i=s!==g.NON_AGGRESSABLE}else console.error(new Error("player's characteristics are null, isPlayerAggressable will be false"));var a,r=e.aggressable!==g.NON_AGGRESSABLE,l=e.aggressable===g.PvP_ENABLED_AGGRESSABLE||e.aggressable===g.PvP_ENABLED_NON_AGGRESSABLE;if(i&&t.alliance.hasAlliance()&&r&&!l){var c=p.entities.prism[t.position.subAreaId];if(c&&c.prism&&c.prism.state===f.PRISM_STATE_VULNERABLE){var u=e.allianceInformations.allianceId,d=t.alliance.current.allianceId,h=c.getAlliance().allianceId,m=this.actorId===t.id;switch(e.aggressable){case g.AvA_DISQUALIFIED:m&&(a="disqualified");break;case g.AvA_PREQUALIFIED_AGGRESSABLE:a=m?"prequalified":n(u,d,h);break;case g.AvA_ENABLED_AGGRESSABLE:a=m?"ally":n(u,d,h)}}}this._getIcon(a,w.AVA)||(this.removeIconCategory(w.AVA),a&&this.addIcon(a,w.AVA))},r.prototype.addSmileyIcon=function(e){var t=this,i=window.gui.databases.Smileys[e];if(!i)return console.error("Smiley "+e+" details are not available, it could not be displayed");var n=w.SMILEY;this.removeIconCategory(n),this.addIcon(i.gfxId,n),(S.playing||S.starting)&&S.stop(),S.reset(I,function(){t.removeIconCategory(n)}),S.start()},r.prototype.addReadyIconOnActor=function(){this.addIcon("Social_tx_fightState",w.UI)},r.prototype.removeReadyIconOnActor=function(){this.removeIconCategory(w.UI)},r.prototype.addQuestIcon=function(e,t){t=t||function(e){if(e)return console.error("addQuestIcon:",e)};var i=this,n=this._questIconLoadingStartTime=Date.now();a(e,function(e,o){if(e)return t(e);if(!o)return t();if(i._getIcon(o,w.QUEST))return t();if(n!==i._questIconLoadingStartTime)return t();var s=new c({layer:l.MAP_LAYER_ICONS,x:i.x,y:i.y,offsetY:0,scene:i.scene});h.loadAnimationManager(s,"embedded","quest",function(e){var a=i._questIconLoadingStartTime;return i._questIconLoadingStartTime=null,n!==a?(s.remove(),t()):(e.assignSymbol({base:o,direction:-1},!0),i.removeQuestIcon(),i._setIcon(s,o,w.QUEST),i._positionIcons(),t())})})},r.prototype.addIcon=function(e,t){function i(e){return r._cleared?void e.release():(r.w=e.element.width,r.h=e.element.height,r.texture=e,s._positionIcons(),void r.forceRefresh())}t=t||w.DEFAULT;var n=this._getIcon(e,t);if(!n){var o;switch(t){case w.SMILEY:o="gfx/smilies/";break;case w.UI:o="ui/";break;default:e=M[e],o="gfx/icons/conquestIcon/"}if(!e)return console.warn("Icon type '"+e+"' is unknown and could not be displayed.");var s=this,a=o+e+".png",r=new u({layer:l.MAP_LAYER_ICONS,x:this.x,y:this.y,w:0,h:0,scene:this.scene});this._setIcon(r,e,t),d.loadTexture(a,i,this.scene.renderer)}},r.prototype._positionIcons=function(){var e=0;for(var t in w){var i,n=w[t],o=0,s=0;for(i in this.icons[n]){var a=this.icons[n][i].w;o+=a?a:0,s++}if(0!==s){o+=T*(s-1);var r=~~(.5*-o),l=0;for(i in this.icons[n]){var c=this.icons[n][i],u=c.h?c.h:0;l=Math.max(l,c.h?c.h:50);var d=this.bbox?this.bbox[2]-this.y-u-10:-100;d-=e,this.y+d<0&&(d=this.bbox?this.bbox[3]-this.y+10:100,d+=e),c.x=this.x+r,c.y=this.y+d,c.position=this.position,r+=c.w+T}e+=l+C}}if(1===window.gui.fightManager.fightState&&this.updateTurnIndicatorPosition(),this.fighterIndicator&&(this.fighterIndicator.x=this.x,this.fighterIndicator.y=this.bbox[2]-10),this._turnNumberLabel&&this._turnNumberLabel.updatePosition(this.x,this.y),this.nicknameLabel){var h=this.bbox,p=h[0]+(h[1]-h[0])/2,m=h[2];this.nicknameLabel.updatePosition(p,m)}},r.prototype._calculateNicknameYOffset=function(){var e;return e=this.bbox[2]-b+y>0?this.bbox[2]-b:this.y+y},r.prototype.removeQuestIcon=function(){this._questIconLoadingStartTime=null,this.removeIconCategory(w.QUEST)},r.prototype.removeIcon=function(e,t){var i=this._getIcon(e,t);i&&(i.remove(),delete this.icons[t][e])},r.prototype.removeIconCategory=function(e){for(var t in this.icons[e])this.removeIcon(t,e)},r.prototype.removeIcons=function(){for(var e in w){var t=w[e];this.removeIconCategory(t)}}},function(e,t,i){function n(){}function o(){if(h)return h;h={};var e=/^\{[\d]*\|([\d]*)/i,t=window.gui.databases.Breeds;for(var i in t){var n=t[i],o=e.exec(n.maleLook)[1],s=e.exec(n.femaleLook)[1];h[o]=n.creatureBonesId,h[s]=n.creatureBonesId}return h[453]=t[12].creatureBonesId,h}function s(e){return{base:e.base,type:0,param:null,direction:e.direction}}function a(e){return{base:"AnimAttaque",type:0,param:null,direction:e.direction}}var r=i(878),l=i(419),c=i(269),u={1:!0,113:!0,44:!0,1575:!0,1576:!0},d=[1097,1111,1112,3451],h=null;r.prototype.getCreatureBones=function(){switch(this.data.type){case"FightTeamInformations":case"FightAllianceTeamInformations":case"FightTeamLightInformations":case"GameRolePlayNpcInformations":case"GameRolePlayNpcWithQuestInformations":return null;case"GameFightCharacterInformations":case"GameRolePlayCharacterInformations":case"GameRolePlayHumanoidInformations":var e=l.getLookWithoutMount(this.realLook),t=e.bonesId;if(!u[t])return 1749;var i=e.skins[0],n=o()[i];return n?n:(console.error("getCreatureBones not found for:",t),666);case"GameRolePlayPrismInformations":return 2247;case"GameRolePlayMerchantInformations":return 1965;case"GameRolePlayTaxCollectorInformations":case"GameFightTaxCollectorInformations":return 1813;case"GameRolePlayGroupMonsterInformations":case"GameFightMonsterInformations":case"GameFightMonsterWithAlignmentInformations":return this.data.isBoss?1748:d.indexOf(this.data.creatureGenericId)>=0?2247:this.data.isSummon?1765:1747;case"GameRolePlayMountInformations":return 1749;case"GameFightMutantInformations":case"GameRolePlayMutantInformations":return 1747;default:return console.error("getCreatureBones: unrecognized data type:",this.data.type),666}},r.prototype.setCreatureLook=function(e,t){var i=t||n,o="GameRolePlayMerchantInformations"===this.data.type,r="GameRolePlayPrismInformations"===this.data.type,u="GameRolePlayTaxCollectorInformations"===this.data.type,d=this.data.humanoidInfo||o||r||u;if(c.isRoleplayMode&&!d)return this.realLook?this.setLook(this.realLook,{useRealLook:!0},i):i();var h=this.getCreatureBones();if(!h)return i();var p={bonesId:h,skins:[],indexedColors:[],scales:[90],subentities:[]};o&&(p.scales[0]=130);var m=this;return l.prototype.setLook.call(this,p,e,function(){return m.animManager.addAnimationModifier("AnimArme",s),m.animManager.addAnimationModifier("AnimAttaque",s),m.animManager.addAnimationModifier("AnimTacle","AnimHit"),m.animManager.addAnimationModifier("AnimEmote",a),m.animManager.addAnimationModifier("AnimConsulter","AnimAttaque0"),m.animManager.addAnimationModifier("AnimCueillir0","AnimAttaque0"),m.animManager.addAnimationModifier("AnimCueillirSol0","AnimAttaque0"),m.animManager.addAnimationModifier("AnimDrop","AnimAttaque0"),m.animManager.addAnimationModifier("AnimFaucher","AnimAttaque0"),m.animManager.addAnimationModifier("AnimHache","AnimAttaque0"),m.animManager.addAnimationModifier("AnimPeche","AnimAttaque0"),m.animManager.addAnimationModifier("AnimPickup","AnimAttaque0"),m.animManager.addAnimationModifier("AnimPioche","AnimAttaque0"),m.animManager.addAnimationModifier("AnimPuiser","AnimAttaque0"),m.animManager.addAnimationModifier("AnimThrow","AnimAttaque0"),m.staticAnim(i)})}},function(e,t,i){var n=i(878),o=i(430),s=i(184),a=i(759),r=i(890),l=i(390),c=i(891),u=i(880),d="ui/embedded/teamCircleRed.png",h="ui/embedded/teamCircleBlue.png";n.prototype.addTeamCircle=function(){function e(e){n.circleGraphic?(n.circleGraphic.w=e.element.width,n.circleGraphic.h=e.element.height,n.circleGraphic.texture=e,n._positionCircle(),n.circleGraphic.forceRefresh()):e.release()}if(!this.circleGraphic){var t=this.getFighter();if(t){var i=t.data.teamId,n=this;this.circleGraphic=new a({layer:s.MAP_LAYER_BACKGROUND,x:this.x,y:this.y,w:0,h:0,scene:this.scene});var r;0===i?r=d:1===i?r=h:console.error("invalid team number"),o.loadTexture(r,e,this.scene.renderer)}}},n.prototype.removeTeamCircle=function(){this.circleGraphic&&(this.circleGraphic.remove(),this.circleGraphic=null)},n.prototype._positionCircle=function(){this.circleGraphic&&(this.circleGraphic.x=this.x-s.CELL_WIDTH/2,this.circleGraphic.y=this.y-s.CELL_HEIGHT/2,this.circleGraphic.position=this.position,this.circleGraphic.forceRefresh())},n.prototype.showTeamCircle=function(e){this.circleGraphic&&(e?this.circleGraphic.show():this.circleGraphic.hide())},n.prototype.updateTurnIndicatorPosition=function(){var e=window.gui.fightManager.getFighter(this.actorId);e&&e.data.alive&&window.gui.fightManager.currentFighterId===e.id&&(e.data.teamId===l.TEAM_CHALLENGER?r.moveRedFeedback(this.x,this.y):r.moveBlueFeedback(this.x,this.y))},n.prototype.addTurnNumber=function(e){this.removeTurnNumber(),this._turnNumberLabel=new c(this.x,this.y,e)},n.prototype.removeTurnNumber=function(){this._turnNumberLabel&&(this._turnNumberLabel.remove(),this._turnNumberLabel=null)},n.prototype.addNicknameLabel=function(e){this.nicknameLabel||(this.nicknameLabel=new u),this.updateNicknameLabel(e)},n.prototype.updateNicknameLabel=function(e){e=e||!1,e=e&&u.hasFullNicknameLabelData(this),e?(this.nicknameLabel.set(this,"full"),this._hadFullNicknameLabel=!0):(this.nicknameLabel.set(this,"name"),this._hadFullNicknameLabel=!1)},n.prototype.removeNicknameLabel=function(){this.nicknameLabel&&(this.nicknameLabel.remove(),this.nicknameLabel=null),this._hadFullNicknameLabel=!1}},function(e,t,i){function n(e,t){e===g.TAP_MARKER&&(t.layer=p.MAP_LAYER_TAP_FEEDBACK),h.call(this,t),this.setWhiteListedness(!0),this.infos=e}function o(){var e=1.5,t=[1,0,0,1],i=[0,0,1,1];for(var o in g){var s=g[o];if(3===s.id||4===s.id)var a=new n(s,{scene:window.isoEngine.mapRenderer.mapScene,layer:p.MAP_LAYER_BACKGROUND,hue:3===s.id?t:i,sx:e,sy:e});else a=new n(s,{scene:window.isoEngine.mapRenderer.mapScene});_[s.id]=a,m.loadAnimationManager(a,"embedded","tapFeedback")}}function s(e,t){var i=_[e.id];return i?void i.play(t):console.warn("Tap feedback",e.id,"does not exist.")}function a(e){var t=_[e.id];t&&t.remove()}function r(e){s(g.MOVEMENT_MARKER,e)}function l(){a(g.MOVEMENT_MARKER),a(g.TURN_MARKER_RED),a(g.TURN_MARKER_BLUE)}function c(e){s(g.TAP_MARKER,e)}function u(){a(g.TAP_MARKER)}var d=i(191).inherits,h=i(425),p=i(184),m=i(426),f=i(390),g={TAP_MARKER:{id:1,animationName:"touch_anim_ok",isLoop:!1},MOVEMENT_MARKER:{id:2,animationName:"marqueur_anim_ok",isLoop:!0},TURN_MARKER_RED:{id:3,animationName:"marqueur_anim_ok",isLoop:!0},TURN_MARKER_BLUE:{id:4,animationName:"marqueur_anim_ok",isLoop:!0}},_={};d(n,h),n.prototype.play=function(e){var t=this.infos,i=this,n=t.isLoop,o=n?void 0:function(){i.remove(!1)};this.animManager.assignSymbol({base:t.animationName,direction:-1},n,o),(e.position||0===e.position)&&(this.position=e.position),this.x=e.x,this.y=e.y,this.show()},t.initialize=function(){o()},t.addMovementFeedback=r,t.removeMovementFeedback=l,t.addTapFeedback=c,t.removeTapFeedback=u,t.addTurnFeedback=function(e,t){var i=t===f.TEAM_CHALLENGER?g.TURN_MARKER_RED:g.TURN_MARKER_BLUE;s(i,e)},t.moveRedFeedback=function(e,t){var i=_[3];i.x=e,i.y=t},t.moveBlueFeedback=function(e,t){var i=_[4];i.x=e,i.y=t}},function(e,t,i){function n(e,t,i){o.call(this,e-c,t-u,i)}var o=i(892),s=i(184),a=i(191).inherits,r=s.CELL_WIDTH,l=s.CELL_HEIGHT,c=r/2,u=l/4;a(n,o),e.exports=n,n.prototype.updatePosition=function(e,t){this._textImage.x=e-c,this._textImage.y=t-u}},function(e,t,i){function n(e,t,i){this._text=i,this._textImage=new o(i),this._x=e,this._y=t,this._textImage.x=e,this._textImage.y=t,this._isCentered=!1}var o=i(893);e.exports=n,n.prototype.updatePosition=function(e,t){this._textImage.x=e,this._textImage.y=t},n.prototype.clearTexture=function(){this._textImage.clear()},n.prototype.resetPosition=function(){this._textImage.x=this._x,this._textImage.y=this._y,this._isCentered=!1},n.prototype.updateText=function(e){if(e!==this._text){var t=this.getForegroundColor(),i=this.getBackgroundColor();this.clearTexture(),this._textImage=new o(e),this.resetPosition(),this._text=e,this._centerText(),this.setForegroundColor(t),this.setBackgroundColor(i)}},n.prototype.remove=function(){this._textImage.clear(),this._textImage=null},n.prototype._centerText=function(){this._textImage.x=this._textImage.x-this._textImage.canvas.width/2,this._isCentered=!0},n.prototype.setForegroundColor=function(e){this._textImage.setForegroundColor(e)},n.prototype.setBackgroundColor=function(e){this._textImage.setBackgroundColor(e)},n.prototype.getForegroundColor=function(){return this._textImage.getForegroundColor()},n.prototype.getBackgroundColor=function(){return this._textImage.getBackgroundColor()}},function(e,t,i){function n(e){var t={id:l++,scene:window.isoEngine.mapScene,layer:a.MAP_LAYER_FOREGROUND,position:0};this._text=e,this.canvas=document.createElement("canvas"),this.canvas.height=t.h=r+c+2,this.canvasContext=this.canvas.getContext("2d"),this.canvasContext.font=r+"px "+u,this.canvas.width=t.w=Math.ceil(this.canvasContext.measureText(e.toString()).width)+c,this.canvasContext.font=r+"px "+u,this.canvasContext.shadowBlur=2,this.canvasContext.shadowColor="rgba(0, 0, 0, 1)",this.canvasContext.shadowOffsetX=1,this.canvasContext.shadowOffsetY=1,s.call(this,t),this.setForegroundColor("rgb(255, 255, 255)"),this.show()}var o=i(191).inherits,s=i(759),a=i(184),r=20,l=0,c=2,u="Verdana";o(n,s),e.exports=n,n.prototype.resetTexture=function(){this._setTexture()},n.prototype.setForegroundColor=function(e){this._foregroundColor=e,this.canvasContext.fillStyle=e,this.canvasContext.textAlign="left",this.canvasContext.fillText(this._text,1,r-c),this._setTexture()},n.prototype.setBackgroundColor=function(e){this._backgroundColor=e,this.canvasContext.fillStyle=e,this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.setForegroundColor(this._foregroundColor)},n.prototype.getForegroundColor=function(){return this._foregroundColor},n.prototype.getBackgroundColor=function(){return this._backgroundColor},n.prototype.clear=function(){this.texture?(this.texture.release(),this.texture=null):console.warn("[CanvasText.clear] Clearing CanvasText, but it was already clear"),this.hide()},n.prototype._setTexture=function(){this.texture&&this.texture.release(),this.texture=window.isoEngine.mapScene.createTexture(this.canvas)}},function(e,t,i){function n(e,t){this.i=e,this.j=t,this.floor=-1,this.zone=-1,this.speed=1,this.weight=0,this.candidateRef=null}function o(e,t){void 0!==e&&1&e.l?(t.floor=e.f||0,t.zone=e.z||0,t.speed=1+(e.s||0)/10,t.zone!==C&&(T=!1)):(t.floor=-1,t.zone=-1)}function s(e,t,i,n,o){this.i=e,this.j=t,this.w=i,this.d=n,this.path=o}function a(e,t){return e.floor===t.floor||e.zone===t.zone&&(T||0!==e.zone||Math.abs(e.floor-t.floor)<=g)}function r(e,t,i,n){return a(e,t)&&(a(e,i)||a(e,n))}function l(e,t,i,n,o,a){var r=e.i,l=e.j,c=Math.sqrt((i-r)*(i-r)+(n-l)*(n-l));if(t=t/e.speed+e.weight,null===e.candidateRef){var u=new s(r,l,a.w+t,c,a);o.push(u),e.candidateRef=u}else{var d=e.candidateRef.w,h=a.w+t;h<d&&(e.candidateRef.w=h,e.candidateRef.path=a)}}function c(e,t,i,n,o){var s=e.i,c=e.j,u=y[s][c],d=y[s-1][c],h=y[s][c-1],p=y[s][c+1],m=y[s+1][c],f=1;a(u,d)&&l(d,f,t,i,n,e),a(u,m)&&l(m,f,t,i,n,e),a(u,h)&&l(h,f,t,i,n,e),a(u,p)&&l(p,f,t,i,n,e);var g=y[s-1][c-1],_=y[s-1][c+1],v=y[s+1][c-1],b=y[s+1][c+1],w=Math.sqrt(2);o&&(r(u,g,d,h)&&l(g,w,t,i,n,e),r(u,v,m,h)&&l(v,w,t,i,n,e),r(u,_,d,p)&&l(_,w,t,i,n,e),r(u,b,m,p)&&l(b,w,t,i,n,e))}function u(e){if(!Array.isArray(e)||e.length<2)return!1;for(var t=p(e[0]),i=1,n=e.length;i<n;i+=1){var o=e[i],s=p(o);if(Math.abs(t.x-s.x)>1)return!1;if(Math.abs(t.y-s.y)>1)return!1;t=s}return!0}function d(e){if(!Array.isArray(e))return[];if(e.length<2)return e;var t=[];t.push(e[0]);for(var i=p(e[0]),n=1,o=e.length;n<o;n+=1){var s,a,r=e[n],l=p(r),c=Math.abs(l.x-i.x),u=Math.abs(l.y-i.y);if(0===c||0===u){if(c>1)for(s=l.x>i.x?1:-1,i.x+=s;i.x!==l.x;)t.push(m(i.x,i.y)),i.x+=s;if(u>1)for(a=l.y>i.y?1:-1,i.y+=a;i.y!==l.y;)t.push(m(i.x,i.y)),i.y+=a}else if(c===u)for(s=l.x>i.x?1:-1,a=l.y>i.y?1:-1,i.x+=s,i.y+=a;i.y!==l.y;)t.push(m(i.x,i.y)),i.x+=s,i.y+=a;i=l,t.push(r)}return t}for(var h=i(895),p=h.getMapPointFromCellId,m=h.getCellIdFromMapPoint,f=10,g=11.825,_=35,v=36,y=[],b=0;b<_;b+=1){for(var w=[],M=0;M<v;M+=1)w[M]=new n(b,M);y[b]=w}var T,C;t.fillPathGrid=function(e){C=e.cells[0].z||0,T=!0;for(var t=0;t<_;t+=1)for(var i=y[t],n=0;n<v;n+=1){var s=m(t-1,n-1),a=i[n],r=e.cells[s];o(r,a)}},t.updateCellPath=function(e,t){var i=h.getMapPointFromCellId(e),n=y[i.x+1][i.y+1];o(t,n)},t.getPath=function(e,t,i,n,o){var a,r;n=void 0===n||!!n;var l=p(e),u=p(t),d=l.x+1,h=l.y+1,g=y[d][h];if(g.zone===-1){for(var _=null,v=1/0,b=1/0,w=-1;w<=1;w+=1)for(var M=-1;M<=1;M+=1)if(0!==w||0!==M){var T=y[d+w][h+M];if(T.zone!==-1){var C=Math.abs(T.f-g.f),I=Math.abs(w)+Math.abs(M);(null===_||C<b||C<=b&&I<v)&&(_=T,v=I,b=C)}}return null!==_?[e,m(_.i-1,_.j-1)]:(console.error(new Error("[pathFinder.getPath] Player is stuck in "+d+"/"+h)),[e])}var A,S,E=u.x+1,x=u.y+1;for(S in i)A=p(S),y[A.x+1][A.y+1].weight+=f;for(var L=[],N=[],O=Math.sqrt((d-E)*(d-E)+(h-x)*(h-x)),D=new s(d,h,0,O,null),R=null,P=D;D.i!==E||D.j!==x;){c(D,E,x,L,n);var B=L.length;if(0===B){D=P;break}var k=1/0,F=0;for(a=0;a<B;a+=1)r=L[a],r.w+r.d<k&&(D=r,k=r.w+r.d,F=a);if(N.push(D),L.splice(F,1),0===D.d||o&&D.d<1.5){if(null===R||D.w<R.w){R=D,P=D;var z=[];for(a=0;a<L.length;a+=1)r=L[a],r.w+r.d<R.w?z.push(r):y[r.i][r.j].candidateRef=null;L=z}}else D.d<P.d&&(P=D)}for(a=0;a<L.length;a+=1)r=L[a],y[r.i][r.j].candidateRef=null;for(var H=0;H<N.length;H+=1)D=N[H],y[D.i][D.j].candidateRef=null;for(S in i)A=p(S),y[A.x+1][A.y+1].weight-=f;for(var q=[];null!==P;)q.unshift(m(P.i-1,P.j-1)),P=P.path;return q},t.getAccessibleCells=function(e,t){e+=1,t+=1;var i=y[e][t],n=y[e-1][t],o=y[e][t-1],s=y[e][t+1],r=y[e+1][t],l=[];return a(i,n)&&l.push({i:n.i-1,j:n.j-1}),a(i,r)&&l.push({i:r.i-1,j:r.j-1}),a(i,o)&&l.push({i:o.i-1,j:o.j-1}),a(i,s)&&l.push({i:s.i-1,j:s.j-1}),l},t.compressPath=function(e){for(var t,i,n=[],o=e[0],s=-1,a=0;a<e.length;a++){var r,l=e[a],c=p(l);r=0===a?-1:c.y===i?c.x>t?7:3:c.x===t?c.y>i?1:5:c.x>t?c.y>i?0:6:c.y>i?2:4,r!==s&&(n.push(o+(r<<12)),s=r),o=l,t=c.x,i=c.y}return n.push(o+(s<<12)),n},t.normalizePath=function(e){return u(e)?e:d(e)},t.logPath=function(e){e=e||[];var t,i,n=[];for(t=0;t<33;t+=1)for(n.push([]),i=0;i<34;i+=1)void 0===m(t,i)?n[t][i]="    ":n[t][i]="[  ]";for(var o=0,s=e.length;o<s;o+=1){var a=e[o],r=p(a),l=o<10?"0":"";n[r.x][r.y]="["+l+o+"]"}var c="";for(i=0;i<34;i+=1){for(t=0;t<33;t+=1)c+=n[t][i];c+="\n"}return c}},function(e,t,i){function n(e){var t=e.x-_,i=e.y;return{x:(y*t+y*i)/b+h/2+m,y:(y*i-y*t)/w+f}}function o(e){var t=e%14-~~(e/28),i=t+19,n=t+~~(e/14);return{x:i,y:n}}function s(){for(var e=0;e<560;e++){var t=o(e);M[t.x+"_"+t.y]=e}}function a(e,t){var i=M[e+"_"+t];return i}function r(e,t){t=t||!1;var i=o(e),n=i.x,s=i.y,r=[];return r.push(a(n,s+1)),r.push(a(n-1,s)),r.push(a(n,s-1)),r.push(a(n+1,s)),t&&(r.push(a(n+1,s+1)),r.push(a(n-1,s+1)),r.push(a(n-1,s-1)),r.push(a(n+1,s-1))),r}function l(e,t,i){return r(e,i).indexOf(t)!==-1}function c(e,t,i){var n,s=o(e),a=o(t),r=Math.atan2(s.y-a.y,a.x-s.x);return i?(r=~~(Math.floor(8*r/Math.PI)+8),n=[3,2,2,1,1,0,0,7,7,6,6,5,5,4,4,3,3][r]):(r=~~(Math.floor(4*r/Math.PI)+4),n=[3,1,1,7,7,5,5,3,3][r]),n}function u(e,t){return e=o(e),t=o(t),Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}var d=i(184),h=d.CELL_WIDTH,p=d.CELL_HEIGHT,m=d.HORIZONTAL_OFFSET-h,f=d.VERTICAL_OFFSET-p/2,g=19,_=g+.225,v=Math.sqrt(2),y=v/2,b=v/h,w=v/p;t.getCoordinateSceneFromGrid=n,t.getMapPointFromCellId=o;var M={};s(),Object.freeze(M),t.getCellIdFromMapPoint=a,t.getNeighbourCells=r,t.areCellsNeighbours=l,t.getOrientation=c,t.getDistance=u},function(e,t){t.characterLevelLimit=29,t.exits={81527299:[{type:"sun",target:"tile",targetId:424,delta:{x:0,y:0}},{type:"sun",target:"tile",targetId:438,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463588,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463589,delta:{x:0,y:0}}],80219654:[{type:"sun",target:"tile",targetId:148,delta:{x:0,y:0}}],81529347:[{type:"sun",
target:"tile",targetId:341,delta:{x:0,y:0}}],81527301:[{type:"sun",target:"tile",targetId:316,delta:{x:0,y:0}}],81529349:[{type:"sun",target:"tile",targetId:344,delta:{x:0,y:0}}],81528323:[{type:"sun",target:"tile",targetId:311,delta:{x:0,y:0}},{type:"sun",target:"tile",targetId:324,delta:{x:0,y:0}}],81528325:[{type:"sun",target:"tile",targetId:316,delta:{x:0,y:0}}],81529345:[{type:"sun",target:"tile",targetId:358,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463599,delta:{x:0,y:0}}],81527297:[{type:"sun",target:"tile",targetId:427,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463597,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:509053,delta:{x:0,y:0}}],80218116:[{type:"interactive",target:"interactive",targetId:463596,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463601,delta:{x:0,y:0}}],81528321:[{type:"interactive",target:"interactive",targetId:463586,delta:{x:0,y:0}}],80218626:[{type:"interactive",target:"interactive",targetId:463600,delta:{x:0,y:0}}],80216578:[{type:"interactive",target:"interactive",targetId:463602,delta:{x:0,y:0}}],80216066:[{type:"interactive",target:"interactive",targetId:463603,delta:{x:0,y:0}},{type:"interactive",target:"interactive",targetId:463604,delta:{x:0,y:0}}],80216064:[{type:"interactive",target:"interactive",targetId:463605,delta:{x:0,y:0}}],80216068:[{type:"interactive",target:"interactive",targetId:463648,delta:{x:0,y:0}}]},t.questsHints={717:{questId:717,question:"tablet.joris.questQuestion717",answer:"tablet.joris.questAnswer717",coordinate:{x:-5,y:-1},priority:10},780:{questId:780,question:"tablet.joris.questQuestion717",answer:"tablet.joris.questAnswer717",coordinate:{x:-5,y:-1},requirements:[717],priority:10},777:{questId:777,question:"tablet.joris.questQuestion717",answer:"tablet.joris.questAnswer717",coordinate:{x:-5,y:-1},requirements:[780],priority:10},783:{questId:783,question:"tablet.joris.questQuestion783",answer:"tablet.joris.questAnswer783",coordinate:{x:3,y:3},requirements:[777],priority:9},181:{questId:181,question:"tablet.joris.questQuestion181",answer:"tablet.joris.questAnswer181",coordinate:{x:1,y:3},requirements:[777],priority:8},784:{questId:784,question:"tablet.joris.questQuestion784",answer:"tablet.joris.questAnswer784",coordinate:{x:4,y:3},requirements:[777],priority:7}},t.phoenixPosition={x:6,y:6},t.tutorialQuests={489:!0,492:!0,1461:!0},t.rewardsPendingHintLimit=5,t.beginnerHatGID=10801,t.INCARNAM_WORLD_MAP=2,t.noTacticalModeMaps=[80216064,80216068,80347654,80219655,80219141,80219143,80216584,80218112,80218113,80217602,80216585,80218114,80219136,80219140,80217605,80216065,80218118,80218632,80347649,80220162,80220164,80219144,80220676,80219142,80216067,81527297,81528321,81529345,81529347,81528323,81527299,81527301,81528325,81529349],t.achievementsHintId=118,t.incarnamDungeon={keyId:8545,playerLevelThreshold:29,firstMapId:80742913,coord:{x:7,y:5}},t.newEquipmentHintsId=[2478,2475,2476,2473,2477,2474,14578,14577,14579,14580,14581,14582,2428,2425,2422,2419,2416,2414,2411],t.creatureModeHintCreaturesId=[3543,3534,3533,3524,3523,3540,3539,3536,3535,3538,3537],t.numPlayersMetForGuildHint=2,t.minLevelForGuildHint=12},function(e,t,i){function n(){le=window.foreground,ce=window.gui,ue=window.isoEngine,de=ce.GPS,he=null;for(var e=0;e<Pe.length;e++){var t=Pe[e].key,i=Pe[e].type;ze[t]=xe.getValue(ce.playerData.id+"-"+t,0),"bool"===i&&(ze[t]=!!ze[t])}s(),l()}function o(){for(var e=0;e<Pe.length;e++){var t=Pe[e].key;xe.setValue(ce.playerData.id+"-"+t,0)}}function s(){ye.on("removed",r),ue.on("mapLoaded",l),ve.on("GameRolePlayShowActorMessage",c),ce.playerData.on("characterInfosUpdated",u),ce.playerData.inventory.on("weightUpdated",d),ce.on("GameActionFightTackledMessage",h),ue.on("GameFightEndMessage",p),ue.on("GameFightStartMessage",b),ce.once("disconnect",a)}function a(){ye.removeListener("removed",r),ue.removeListener("mapLoaded",l),ve.removeListener("GameRolePlayShowActorMessage",c),ce.playerData.removeListener("characterInfosUpdated",u),ce.playerData.inventory.removeListener("weightUpdated",d),ce.removeListener("GameActionFightTackledMessage",h),ue.removeListener("GameFightEndMessage",p),ue.removeListener("GameFightStartMessage",b),ce.removeListener("QuestStartedMessage",se),ce.removeListener("CompassResetMessage",ne),v(),te()}function r(){ke=[],null!==Be&&(clearTimeout(Be),Be=null),N()}function l(){Le.isBeginnerAssistantRequired()&&(Fe=!1,C(),I(),ae(),A())}function c(){Le.isBeginnerAssistantRequired()&&C()}function u(){Le.isBeginnerAssistantRequired()&&(T(),A())}function d(){Le.isBeginnerAssistantRequired()&&I()}function h(e){if(!ze.tackleHintShown&&Le.isBeginnerAssistantRequired({fightContextAllowed:!0})&&e.sourceId===ce.playerData.id){var t=$(Te("tablet.joris.fight.tackle"));t&&(ze.tackleHintShown=!0,xe.setValue(ce.playerData.id+"-tackleHintShown",1))}}function p(e){te(),Le.isBeginnerAssistantRequired({fightContextAllowed:!0})&&(y(),m(e))}function m(e){if(!ze.newEquipmentHintShown&&!ce.uiLocker.isFeatureLocked("inventory")&&e.results&&0!==e.results.length){for(var t=window.gui.playerData.inventory,i=null,n=0;n<e.results.length;n++){var o=e.results[n];if("FightResultPlayerListEntry"===o._type&&o.id===ce.playerData.id&&o.rewards&&o.rewards.objects&&0!==o.rewards.objects.length){for(var s=0;s<o.rewards.objects.length;s+=2){var a=o.rewards.objects[s];if(be.newEquipmentHintsId.indexOf(a)!==-1&&!t.isGenericItemEquipped(a)){i=a;break}}if(i)break}}i&&Se.getItems([i],function(e){if(e)return console.error(e);var t=Se.items[i],n=t.nameId;E(Ae.process(Te("tablet.joris.newEquipment","("+n+")"))),ze.newEquipmentHintShown=!0,xe.setValue(ce.playerData.id+"-newEquipmentHintShown",1)})}}function f(){window.gui.hintArrow.hideArrow(),window.isoEngine.removeArrows()}function g(){f(),window.gui.chatButton.button.removeListener("tap",g),window.gui.chat.once("closed",v),window.gui.chat.chatInput.buttonTouchZone.on("tap",_),Oe.pointToChatChannelButton()}function _(){f(),window.gui.chat.chatInput.buttonTouchZone.removeListener("tap",_)}function v(){He===Re&&(f(),window.gui.chat.active?(window.gui.chat.removeListener("closed",v),window.gui.chat.chatInput.buttonTouchZone.removeListener("tap",_)):window.gui.chatButton.button.removeListener("tap",g),He="")}function y(){ze.firstFightOutsideTutorial||""!==He||(He=Re,E(Te("tablet.joris.beginnersChannel"),[],v),window.gui.chat.active?(window.gui.chat.once("closed",v),Oe.pointToChatChannelButton(),window.gui.chat.chatInput.buttonTouchZone.on("tap",_)):(Oe.pointToChatButton(),window.gui.chatButton.button.on("tap",g)),ze.firstFightOutsideTutorial=!0,xe.setValue(ce.playerData.id+"-firstFightOutsideTutorial",1,10))}function b(){M(),w()}function w(){if(!ze.tacticalModeHintShown&&Le.isBeginnerAssistantRequired({fightContextAllowed:!0})&&be.noTacticalModeMaps.indexOf(ce.playerData.position.mapId)===-1){var e=$(Te("tablet.joris.fight.tactical"));e&&(ze.tacticalModeHintShown=!0,xe.setValue(ce.playerData.id+"-tacticalModeHintShown",1))}}function M(){if(!ze.creatureModeHintShown&&Le.isBeginnerAssistantRequired({fightContextAllowed:!0})){var e=!1;for(var t in window.actorManager.actors){var i=window.actorManager.actors[t];if(i.data&&be.creatureModeHintCreaturesId.indexOf(i.data.creatureGenericId)!==-1){e=!0;break}}if(e){var n=$(Te("tablet.joris.fight.creatureMode"));n&&(ze.creatureModeHintShown=!0,xe.setValue(ce.playerData.id+"-creatureModeHintShown",1))}}}function T(){ze.dungeonKeyHintShown||Le.isBeginnerAssistantRequired()&&ce.playerData.inventory.quantityList[be.incarnamDungeon.keyId]&&(ce.playerData.characterBaseInformations.level<be.incarnamDungeon.playerLevelThreshold||(E(Ae.process(Te("tablet.joris.dungeonKey"))),oe(be.incarnamDungeon.coord.x,be.incarnamDungeon.coord.y,null,be.incarnamDungeon.firstMapId),ze.dungeonKeyHintShown=!0,xe.setValue(ce.playerData.id+"-dungeonKeyHintShown",1)))}function C(){ce.playerData.characterBaseInformations.level<be.minLevelForGuildHint||ze.numPlayersMet>=be.numPlayersMetForGuildHint||0!==window.actorManager.getPlayers().length&&(Fe||(ze.numPlayersMet++,Fe=!0,xe.setValue(ce.playerData.id+"-numPlayersMet",ze.numPlayersMet),ze.numPlayersMet<be.numPlayersMetForGuildHint||Q()&&E(J())))}function I(){if(!ze.maxWeightHintShown){var e=window.gui.playerData.inventory;e.weight<e.maxWeight||(E(Ae.process(Te("tablet.joris.maxWeight"))),ze.maxWeightHintShown=!0,xe.setValue(ce.playerData.id+"-maxWeightHintShown",1))}}function A(){(ce.playerData.characterBaseInformations.level>be.characterLevelLimit||ce.playerData.position.worldmapId!==be.INCARNAM_WORLD_MAP)&&Z()}function S(){a();for(var e=0;e<Pe.length;e++){var t=Pe[e].key;xe.delValue(ce.playerData.id+"-"+t)}}function E(e,t,i){function n(){E(e,t,i)}if(ce.npcDialogUi.inDialog){if(ce.npcDialogUi.actor&&"beginnerAssistant"===ce.npcDialogUi.actor.actorId){if(!e)return;return ke.push({content:e,buttons:t,closeCb:i})}return ce.npcDialogUi.once("closed",n)}if(he){if(!e)return;return ke.push({content:e,buttons:t,closeCb:i})}var o=ye.getActor();return o?(pe=null,me=t||[],fe=i||null,o.moving?ye.once("actorStopped",n):(ye.freeze(),e?R(e):O(),void x())):ye.once("actorReady",n)}function x(){if(!me||0===me.length)return he=ce.newSpeechBubble({title:Te("tablet.joris"),msg:pe,actor:ye.getActor(),isNonChat:!0,onClose:function(){return fe?fe():void L()},isLocked:!0,action:function(){he.close()}}),void le.unlock("beginnerAssistantDialog");le.lock("beginnerAssistantDialog");for(var e=[],t=0;t<me.length;t++)e.push(me[t].buttonText);ce.npcDialogUi.showNpcQuestion(pe,e,function(e){var t;return null!==e&&me[e].callback?t=me[e].callback:null===e&&fe&&(t=fe,ce.npcDialogUi.leaveDialog()),t?(pe=null,me=[],fe=null,t()):(ce.npcDialogUi.leaveDialog(),void L())},{actor:ye.getActor(),npcData:{nameId:Te("tablet.joris")}})}function L(){return he=null,pe=null,fe=null,me=[],ke.length>0?void(Be=setTimeout(function(){Be=null;var e=ke.shift();E(e.content,e.buttons,e.closeCb)},500)):(le.unlock("beginnerAssistantDialog"),void ye.unfreeze(2e3))}function N(){he&&he.close(),ce.npcDialogUi.inDialog&&(ce.npcDialogUi.leaveDialog(),L())}function O(){var e,t=[];if(be.exits[ce.playerData.position.mapId]&&t.push({type:"exit",priority:10}),U()&&t.push({type:"nextQuest",priority:8}),ce.playerData.state===Ie.STATUS_PHANTOM&&t.push({type:"ghost",priority:20}),Object.keys(ce.playerData.achievements.rewardableAchievements).length>=be.rewardsPendingHintLimit&&t.push({type:"rewards",priority:3}),V()&&t.push({type:"beginnerHat",priority:5}),Q()&&t.push({type:"guild",priority:2}),t.sort(D),0===t.length)return R(Te("tablet.joris.noHint")),void B();for(R(Te("tablet.joris.canIHelp")),e=0;e<t.length&&!(e>=De);e++)"exit"===t[e].type?P(k()):"nextQuest"===t[e].type?P(F()):"ghost"===t[e].type?P(G()):"rewards"===t[e].type?P(j()):"beginnerHat"===t[e].type?P(X()):"guild"===t[e].type&&P(K())}function D(e,t){return t.priority-e.priority}function R(e){var t=new we("div",{className:"message"});e instanceof we?t.appendChild(e):t.setHtml(e),pe=t}function P(e){return e?void me.push(e):console.warn("beginnerAssistant.addButton: invalid buttonData")}function B(e){P({buttonText:"Ok",callback:e||N})}function k(){var e=!1,t=!1,i=be.exits[ce.playerData.position.mapId];if(i&&i.length)for(var n=0;n<i.length;n++){var o=i[n];"sun"===o.type?e=!0:"interactive"===o.type&&(t=!0)}var s;return s=Te(e&&!t?"tablet.joris.exitSun":!e&&t?"tablet.joris.exitInteractive":"tablet.joris.exits"),{buttonText:Te("tablet.joris.searchingExit"),callback:function(){R(s),B(function(){ie(),N()}),x()}}}function F(){var e=Y();return 0===e.length?null:{buttonText:Te("tablet.joris.whatToDo"),callback:function(){q(e),x()}}}function z(e,t){return be.questsHints[t].priority-be.questsHints[e].priority}function H(e){P({buttonText:Te(e.question),callback:function(){W(e),x()}})}function q(e){if(1===e.length)return W(be.questsHints[e[0]]);e.sort(z);for(var t=0;t<e.length;t++){var i=be.questsHints[e[t]];H(i)}}function W(e){R(Te(e.answer)),P({buttonText:Te("tablet.joris.yesPlease"),callback:function(){var t=ce.playerData.position.coordinates;return e.coordinate.x===t.posX&&e.coordinate.y===t.posY?(R(Te("tablet.joris.onTheMap")),P({buttonText:Te("ui.common.ok"),callback:N}),void x()):(oe(e.coordinate.x,e.coordinate.y,e.questId),void N())}}),P({buttonText:Te("tablet.joris.noThanks"),callback:N})}function U(){return Y().length>0}function Y(){var e=ce.playerData.quests,t=[];for(var i in be.questsHints)if(!e.all[i]){var n=be.questsHints[i],o=!0;if(n.requirements&&n.requirements.length>0)for(var s=0;s<n.requirements.length;s++)if(!e.finished[n.requirements[s]]){o=!1;break}o&&t.push(i)}return t}function G(){return{buttonText:Te("tablet.joris.ghostQuestion"),callback:function(){var e=be.phoenixPosition;R(Ae.process(Te("tablet.joris.ghostAnswer",e.x,e.y))),P({buttonText:Te("ui.common.ok"),callback:N}),x()}}}function j(){return{buttonText:Te("tablet.joris.rewardsQuestion"),callback:function(){R(Te("tablet.joris.rewardsAnswer")),P({buttonText:Te("ui.common.ok"),callback:N}),x()}}}function V(){var e=ce.playerData.inventory;if(0!==e.getGenericItemCount(be.beginnerHatGID)&&!e.isGenericItemEquipped(be.beginnerHatGID)&&!e.equippedItems[Ee.hat])return!0}function X(){return{buttonText:Te("tablet.joris.beginnerHatQuestion"),callback:function(){R(Ae.process(Te("tablet.joris.beginnerHatAnswer"))),P({buttonText:Te("ui.common.ok"),callback:N}),x()}}}function Q(){return!1}function K(){return{buttonText:Te("tablet.joris.guildQuestion"),callback:function(){R(J()),P({buttonText:Te("ui.common.ok"),callback:N}),x()}}}function J(){return Te("tablet.joris.guildAnswerFailover")}function Z(){var e=ye.getActor();if(!e)return ye.once("actorReady",Z);var t,i;if(ce.playerData.characterBaseInformations.level>be.characterLevelLimit)t="tablet.joris.goodByeMaxLevel",i="maxLevel";else{if(ce.playerData.position.worldmapId===be.INCARNAM_WORLD_MAP)return console.error(new Error("beginnerAssistant: no reason to say good bye"));t="tablet.joris.goodByeIncarnam",i="incarnamLeft"}var n=e.direction;3!==n&&1!==n&&(n=Math.random()<.5?3:1),Le.setRequired(!1);var o=function(){ce.npcDialogUi.leaveDialog(),setTimeout(function(){ke=[],L(),ye.freeze(),ye.setAnimation("JumpAndSmoke",n,function(){ye.getActor().remove(),"maxLevel"===i&&Le.removeAndClean()})},300)};E(Te(t),[{buttonText:Te("tablet.joris.goodBye"),callback:o}],o)}function $(e){if(_e&&_e.isVisible())return!1;if(_e||(_e=new Ne,_e.allowDomEvents(),_e.on("dom.touchstart",ee),_e.setCloseButton(),_e.open()),"string"==typeof e){var t=new we("span");t.setHtml(e),e=t}return _e.setContent(e),!0}function ee(){_e&&_e.close()}function te(){_e&&(ee(),_e.removeListener("dom.touchstart",ee),_e.destroy(),_e=null)}function ie(){ue.removeArrows();var e=be.exits[ce.playerData.position.mapId];if(e&&e.length)for(var t=0;t<e.length;t++){var i=e[t],n=i.delta||{x:0,y:0};if("tile"===i.target)ue.addArrowOnCell(i.targetId,n.x,n.y,void 0,5);else if("interactive"===i.target){var o=ue.mapRenderer.identifiedElements[i.targetId];ue.addArrowOnGraphic(o,n.x,n.y,void 0,5)}}}function ne(){ge&&ge.listening&&(ce.removeListener("QuestStartedMessage",se),ce.removeListener("CompassResetMessage",ne)),!ge||null===ge.questId&&null===ge.mapId||de.removePOI("flag_srv"+Ce.COMPASS_TYPE_QUEST),ge={questId:null,mapId:null,listening:!1}}function oe(e,t,i,n){ne(),de.addPOI({id:"flag_srv"+Ce.COMPASS_TYPE_QUEST,x:e,y:t,categoryId:"hint",nameId:"("+e+","+t+")",color:{r:85,g:136,b:0,a:1},isDestination:!0}),ce.on("QuestStartedMessage",se),ce.on("CompassResetMessage",ne),ge.listening=!0,ge.questId=i||null,ge.mapId=n||null}function se(e){ge&&ge.questId!==e.questId||ne()}function ae(){ce.playerData.position.mapId===be.incarnamDungeon.firstMapId&&(ze.dungeonKeyHintShown=!0,xe.setValue(ce.playerData.id+"-dungeonKeyHintShown",1),re()),ge&&ge.mapId===ce.playerData.position.mapId&&ne()}function re(){if(!ze.dungeonFirstRoomHintShown){var e=$(Te("tablet.joris.dungeonFirstRoom"));e&&(ze.dungeonFirstRoomHintShown=!0,xe.setValue(ce.playerData.id+"-dungeonFirstRoomHintShown",1))}}var le,ce,ue,de,he,pe,me,fe,ge,_e,ve=i(271),ye=i(875),be=i(896),we=i(235),Me=i(29),Te=Me.getText,Ce=i(679),Ie=i(627),Ae=i(678),Se=i(509),Ee=Se.positions,xe=i(195),Le=i(873),Ne=i(863),Oe=i(680),De=3,Re="beginnerChan",Pe=[{key:"numPlayersMet",type:"int"},{key:"maxWeightHintShown",type:"bool"},{key:"tackleHintShown",type:"bool"},{key:"tacticalModeHintShown",type:"bool"},{key:"creatureModeHintShown",type:"bool"},{key:"pingHintShown",type:"bool"},{key:"dungeonKeyHintShown",type:"bool"},{key:"newEquipmentHintShown",type:"bool"},{key:"firstFightOutsideTutorial",type:"bool"},{key:"dungeonFirstRoomHintShown",type:"bool"}],Be=null,ke=[],Fe=!1,ze={},He="";t.initialize=n,t.openDialog=E,t.onActorRemoved=r,t.reset=o,t.removeAndClean=S},function(e,t,i){function n(){return!1}function o(e){return x.tutorialQuests[e]||!1}function s(){I=window.gui,A=window.isoEngine,w(),f(),C()||(b(),I.playerData.on("characterInfosUpdated",a),A.on("mapLoaded",r),S.on("GameRolePlayShowActorMessage",l),I.playerData.quests.on("questStarted",c),I.playerData.quests.on("questUpdate",u),I.on("AchievementFinishedMessage",d),I.uiLocker.on("updated",h),I.once("disconnect",p),g("myShop"),r())}function a(){return I.playerData.characterBaseInformations.level>x.characterLevelLimit?m():void g(["spells","carac","bidHouse"])}function r(){return I.playerData.position.worldmapId!==x.INCARNAM_WORLD_MAP?m():void g(["worldMap","friends"])}function l(){g(["friends","directory"])}function c(){g(["quests","bestiary"])}function u(){g("bestiary")}function d(){g("achievements")}function h(e){"job"===e.featureId&&g("job")}function p(){I.playerData.removeListener("characterInfosUpdated",a),A.removeListener("mapLoaded",r),S.removeListener("GameRolePlayShowActorMessage",l),I.playerData.quests.removeListener("questStarted",c),I.playerData.quests.removeListener("questUpdate",u),I.removeListener("AchievementFinishedMessage",d),I.uiLocker.removeListener("updated",h),I.removeListener("disconnect",p),T(!1)}function m(){T(!0),p()}function f(){for(var e in D){var t=D[e];t.alreadyUnlocked||!t.evaluateCurrent||t.evaluateCurrent({init:!0})?t.alreadyUnlocked=!0:(I.uiLocker.lockFeature(e,"beginnerAssistant",O("tablet.joris.uiLocker.default")),t.alreadyUnlocked=!1)}}function g(e){e?e instanceof Array||(e=[e]):e=Object.keys(D);for(var t=!1,i=0;i<e.length;i++){var n=e[i],o=_(n,!1);t=t||o}t&&b()}function _(e,t){if(!E.isBeginnerAssistantRequired())return!1;var i=D[e];return!i.alreadyUnlocked&&(!!i.evaluateCurrent()&&(i.alreadyUnlocked=!0,I.uiLocker.unlockFeature(e,"beginnerAssistant"),i.jorisDialog&&E.openDialog(N.process(O(i.jorisDialog))),t&&b(),!0))}function v(){m()}function y(){return"beginnerUiLocked"}function b(){var e={};for(var t in D)D[t].alreadyUnlocked||(e[t]=1);L.setValue(y(),e)}function w(){var e=L.getValue(y(),null);if(null!==e)for(var t in D)D[t].alreadyUnlocked=!e[t]}function M(){for(var e in D)D[e].alreadyUnlocked=!1;f(),b(),L.delValue("beginnerUiLocked.alreadyConnectedChars")}function T(e){for(var t in D)D[t].alreadyUnlocked=!0,I.uiLocker.unlockFeature(t,"beginnerAssistant");e&&b()}function C(){for(var e in D)if(!D[e].alreadyUnlocked)return!1;return!0}var I,A,S=i(271),E=i(873),x=i(896),L=i(195),N=i(678),O=i(29).getText,D={spells:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.spells",evaluateCurrent:function(){return I.playerData.characterBaseInformations.level>=3}},carac:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.carac",evaluateCurrent:function(){return I.playerData.characterBaseInformations.level>=2}},bidHouse:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.bidHouse",evaluateCurrent:function(){return I.playerData.characterBaseInformations.level>=8}},worldMap:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.worldMap",evaluateCurrent:function(){var e=I.playerData.position.coordinates;return!I.compass.isInTutorialCorridor(e.posX,e.posY)}},friends:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.friends",evaluateCurrent:function(){return window.actorManager.getPlayers().length>0}},quests:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.quests",evaluateCurrent:function(){for(var e=Object.keys(I.playerData.quests.all),t=0;t<e.length;t++)if(!o(e[t]))return!0;return!1}},koliseum:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:n},directory:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:function(){return D.friends.alreadyUnlocked||D.friends.evaluateCurrent()}},alignment:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:n},bestiary:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.bestiary",evaluateCurrent:function(){for(var e in I.playerData.quests.all){var t=Number(e);if(172===t||199===t||1428===t)return!0;if(826===t){var i=I.playerData.quests.all[826].objectives;if(void 0===i)return I.playerData.quests.finished[826]||console.error(new Error("quest 826 objectives is undefined but quest is not finished")),!0;for(var n=0;n<i.length;n++)if(5246===i[n].objectiveId||5247===i[n].objectiveId)return!0}}return!1}},ornaments:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:n},achievements:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.achievements",evaluateCurrent:function(){for(var e=I.playerData.achievements.finishedAchievementsIds,t=0;t<e.length;t++)if(e[t]===x.achievementsHintId)return!0;return!1}},almanax:{alreadyUnlocked:!1,jorisDialog:null,evaluateCurrent:n},myShop:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.myShop",evaluateCurrent:function(e){if(e&&e.init)return D.myShop.alreadyUnlocked;var t=L.getValue("beginnerUiLocked.alreadyConnectedChars",[]);return t.indexOf(I.playerData.id)!==-1?(L.delValue("beginnerUiLocked.alreadyConnectedChars"),!0):(t.push(I.playerData.id),L.setValue("beginnerUiLocked.alreadyConnectedChars",t),!1)}},job:{alreadyUnlocked:!1,jorisDialog:"tablet.joris.uiUnlocker.job",evaluateCurrent:function(){return I.playerData.jobs&&Object.keys(I.playerData.jobs.list).length>0}}};t.initialize=s,t.reset=M,t.unlockAll=T,t.removeAndClean=v},function(e,t,i){function n(){this.handlerMap={},this.handlerMap[c]=this.kamaConvertHandler,this.handlerMap[u]=this.kamaConvertHandler,this.handlerMap[d]=this.kamaLostHandler,this.handlerMap[l]=this.guestLimitHandler,this.handlerMap[h]=this.overweightHandler,this.previousConvertedKamaAmount=null}var o=i(412),s=i(29).getText,a=i(806),r=i(900),l=10418,c=221,u=220,d=46,h=10012;n.prototype.initialize=function(){var e=this,t=window.dofus.connectionManager,i={};i[r.TEXT_INFORMATION_MESSAGE]=o.PSEUDO_CHANNEL_INFO,i[r.TEXT_INFORMATION_PVP]=o.CHANNEL_ALLIANCE,i[r.TEXT_INFORMATION_FIGHT]=o.PSEUDO_CHANNEL_FIGHT_LOG,t.on("TextInformationMessage",function(t){if("ADMIN_DEBUG"===t.parameters[0])return console.warn(t.text);var n=1e4*t.msgType+t.msgId,o=e.handlerMap[n];o&&!o.call(e,t)||(t.msgType===r.TEXT_INFORMATION_ERROR?window.gui.chat.logError(t.text):window.gui.chat.logMsg(t.text,i[t.msgType]))}),t.on("TextInformationMessageWithPriority",function(e){e.msgType===r.TEXT_INFORMATION_ERROR?window.gui.chat.logError(e.text,e.msgPriority):window.gui.chat.logMsg(e.text,i[e.msgType],e.msgPriority)})},n.prototype.kamaConvertHandler=function(e){return this.previousConvertedKamaAmount=~~e.parameters[0],!1},n.prototype.kamaLostHandler=function(e){var t=~~e.parameters[0];if(t!==this.previousConvertedKamaAmount)return this.previousConvertedKamaAmount=null,!0;this.previousConvertedKamaAmount=null;var i=a.computeHardPrice(t);return i?(e.text=s("tablet.spent.hard",i),!0):console.warn("Cannot convert currency")},n.prototype.guestLimitHandler=function(){return window.gui.loginScreen.proposeRegistrationAfterGuestLimit(),!1},n.prototype.overweightHandler=function(e){return window.gui.openPopup({title:s("ui.popup.warning"),message:e.text}),!0},e.exports=new n},function(e,t){e.exports={TEXT_INFORMATION_MESSAGE:0,TEXT_INFORMATION_ERROR:1,TEXT_INFORMATION_PVP:2,TEXT_INFORMATION_FIGHT_LOG:3,TEXT_INFORMATION_POPUP:4,TEXT_LIVING_OBJECT:5,TEXT_ENTITY_TALK:6,TEXT_INFORMATION_FIGHT:7}},function(e,t,i){function n(){return u}function o(){s=window.gui,r.call(this),this.lockStatus={};for(var e in d)this.lockStatus[e]={base:null,customLockedReasons:null};this._setupEvents(),this.updateAll()}var s,a=i(191).inherits,r=i(209).EventEmitter,l=i(29).getText,c=!0,u=!1,d={carac:{windowId:"characteristics",menuButtonId:"Carac",evaluateCurrent:n},spells:{windowId:"grimoire",tabId:"spells",menuButtonId:"Spell",evaluateCurrent:n},inventory:{windowId:"equipment",menuButtonId:"Bag",evaluateCurrent:n},bidHouse:{windowId:"bidHouseShop",menuButtonId:"BidHouse",evaluateCurrent:n},worldMap:{windowId:"worldMap",menuButtonId:"Map",evaluateCurrent:n},friends:{windowId:"social",tabId:"friends",menuButtonId:"Friend",evaluateCurrent:n},quests:{windowId:"grimoire",tabId:"quests",menuButtonId:"Book",evaluateCurrent:n},guild:{windowId:"social",tabId:"guild",menuButtonId:"Guild",evaluateCurrent:function(){return s.playerData.guild.hasGuild()?u:c},lockedReasonDescription:"tablet.guild.uiLocker.default"},koliseum:{windowId:"arena",menuButtonId:"Conquest",evaluateCurrent:n},market:{windowId:"market",tabId:"shop",menuButtonId:"Goultine",evaluateCurrent:n},job:{windowId:"grimoire",tabId:"jobs",menuButtonId:"Job",evaluateCurrent:function(){return s.playerData.jobs&&Object.keys(s.playerData.jobs.list).length>0?u:c},lockedReasonDescription:"tablet.job.uiLocker.default"},alliance:{windowId:"social",tabId:"alliance",menuButtonId:"Alliance",evaluateCurrent:function(){return s.playerData.alliance.hasAlliance()?u:c},lockedReasonDescription:"tablet.alliance.uiLocker.default"},mount:{windowId:"mount",menuButtonId:"Mount",evaluateCurrent:function(){return s.playerData.equippedMount?u:c},lockedReasonDescription:"tablet.mount.uiLocker.default"},directory:{windowId:"social",tabId:"directory",menuButtonId:"Directory",evaluateCurrent:n},alignment:{windowId:"grimoire",tabId:"alignment",menuButtonId:"Alignment",evaluateCurrent:n},bestiary:{windowId:"grimoire",tabId:"bestiary",menuButtonId:"Bestiary",evaluateCurrent:n},ornaments:{windowId:"grimoire",tabId:"ornaments",menuButtonId:"Title",evaluateCurrent:n},achievements:{windowId:"grimoire",tabId:"achievements",menuButtonId:"Achievement",evaluateCurrent:n},almanax:{windowId:"grimoire",tabId:"almanax",menuButtonId:"Almanax",evaluateCurrent:n},spouse:{windowId:"social",tabId:"spouse",menuButtonId:"Spouse",evaluateCurrent:function(){return s.playerData.socialData.spouse?u:c},lockedReasonDescription:"tablet.spouse.uiLocker.default"},myShop:{windowId:"tradeStorage",menuButtonId:"Shop",evaluateCurrent:n},TOA:{windowId:"TOA",tabId:"general",menuButtonId:"TOA",evaluateCurrent:n},Help:{windowId:"help",menuButtonId:"Help",evaluateCurrent:n}};a(o,r),e.exports=o,o.prototype._getCustomReasonIndex=function(e,t){if(!this.lockStatus[e]||!this.lockStatus[e].customLockedReasons)return-1;for(var i=0;i<this.lockStatus[e].customLockedReasons.length;i++)if(this.lockStatus[e].customLockedReasons[i].id===t)return i;return-1},o.prototype.updateAll=function(){for(var e in d)this.updateFeatureId(e)},o.prototype.updateFeatureId=function(e){var t=d[e],i=this.lockStatus[e].base,n=t.evaluateCurrent();n!==i&&this._setStatus(e,n)},o.prototype.isFeatureLocked=function(e){return void 0===this.lockStatus[e]?(console.error(new Error("UiLocker.isFeatureLocked: featureId `"+e+"` unknown")),!0):!(this.lockStatus[e].base!==c&&!this.lockStatus[e].customLockedReasons)},o.prototype.isFeatureAvailable=function(e){return!this.isFeatureLocked(e)},o.prototype._getFeatureIdfromMenuButtonId=function(e){for(var t in d){var i=d[t];if(i.menuButtonId===e)return t}return console.error(new Error("UiLocker.isMenuButtonAvailable: no feature is matching the menuButtonId "+e)),null},o.prototype.isMenuButtonAvailable=function(e){var t=this._getFeatureIdfromMenuButtonId(e);return!!t&&this.isFeatureAvailable(t)},o.prototype.getMenuButtonLockedReasons=function(e){var t=[],i=this._getFeatureIdfromMenuButtonId(e);if(i){if(this.lockStatus[i].base&&d[i].lockedReasonDescription)if("Spouse"===e){var n=window.gui.playerData.characterBaseInformations.sex;t.push(l(d[i].lockedReasonDescription,n))}else t.push(l(d[i].lockedReasonDescription));if(this.lockStatus[i].customLockedReasons)for(var o=this.lockStatus[i].customLockedReasons,s=0;s<o.length;s++)t.push(o[s].description)}else console.error(new Error("UiLocker.getMenuButtonLockedReason: no feature is matching the menuButtonId"+e));return 0===t.length&&t.push(l("tablet.uiLocker.default")),t},o.prototype.isTabAvailable=function(e,t){for(var i in d){var n=d[i];if(n.windowId===e&&n.tabId===t)return this.isFeatureAvailable(i)}return console.error(new Error("UiLocker.isTabAvailable: no feature matching window "+e+" w/ tabId "+t)),!1},o.prototype._setStatus=function(e,t,i,n){var o=d[e];if(!o)return console.error(new Error("UiLocker._setStatus: featureId "+e+" unknown"));var s=this.isFeatureLocked(e),a=this.lockStatus[e],r=a.base;if(i){var l=-1;if(a.customLockedReasons&&(l=this._getCustomReasonIndex(e,i)),t){if(l===-1){a.customLockedReasons||(a.customLockedReasons=[]);var c={id:i,description:n};a.customLockedReasons.push(c)}}else l!==-1&&(a.customLockedReasons.splice(l,1),0===a.customLockedReasons.length&&(a.customLockedReasons=null)),a.base=o.evaluateCurrent()}else a.base=t;var u=this.isFeatureLocked(e),h=a.base;u===s&&h===r||this.emit("updated",{featureId:e,locked:u,baseLocked:h,menuButtonId:o.menuButtonId,windowId:o.windowId,tabId:o.tabId})},o.prototype._setupEvents=function(){var e=this;s.playerData.jobs.on("jobListUpdated",function(){e.updateFeatureId("job")}),s.playerData.alliance.on("allianceUpdated",function(){e.updateFeatureId("alliance")}),s.playerData.alliance.on("allianceJoined",function(){e.updateFeatureId("alliance")}),s.playerData.alliance.on("allianceLeft",function(){e.updateFeatureId("alliance")}),s.playerData.guild.on("GuildGeneralInformationUpdate",function(){e.updateFeatureId("guild")}),s.playerData.guild.on("guildLeft",function(){e.updateFeatureId("guild")}),s.playerData.on("setMount",function(){e.updateFeatureId("mount")}),s.playerData.on("unsetMount",function(){e.updateFeatureId("mount")}),s.playerData.socialData.on("spouseUpdate",function(){e.updateFeatureId("spouse")}),s.playerData.socialData.on("spouseLeft",function(){e.updateFeatureId("spouse")})},o.prototype.lockFeature=function(e,t,i){return t&&i?void this._setStatus(e,!0,t,i):console.error(new Error("UiLocker.lockFeature: featureId: "+e+" reasonKey: "+t+" reasonDescription: "+i+" - a reasonKey and a reasonDescription are required to lock a feature"))},o.prototype.unlockFeature=function(e,t){return t?void this._setStatus(e,!1,t):console.error(new Error("UiLocker.unlockFeature: a reasonKey is required to unlock a feature"))},o.prototype.lockAllFeatures=function(e,t){for(var i in this.lockStatus)this.lockFeature(i,e,t)},o.prototype.unlockAllFeatures=function(e){if(!e)return console.error(new Error("UiLocker.unlockAllFeatures: a reasonKey is required to unlock features"));for(var t in this.lockStatus)this.unlockFeature(t,e)}},function(e,t,i){var n=i(225),o=i(903),s=i(909),a=i(913),r=i(916),l=i(918),c=i(938),u=i(940),d=i(947),h=i(959),p=i(961),m=i(964),f=i(970),g=i(974),_=i(977),v=i(979),y=i(983),b=i(986),w=i(988),M=i(1019),T=i(1021),C=i(1027),I=i(1029),A=i(1033),S=i(1035),E=i(1037),x=i(1039),L=i(1043),N=i(1045),O=i(1047),D=i(1049),R=i(1051),P=i(1053),B=i(1055),k=i(1058),F=i(1060),z=i(1062),H=i(1064),q=i(1065),W=i(1067),U=i(1071),Y=i(1075),G=i(1079),j=i(1081),V=i(1084),X=i(1086),Q=i(1088),K=i(1094),J=i(1096),Z=i(1098),$=i(1100),ee=i(1102),te=i(496),ie=i(1106),ne=i(1129),oe=i(1170),se=i(1172),ae=i(1175),re=i(1178),le=i(1180),ce=i(1182),ue=i(1185),de=i(1187),he=i(1196),pe=i(1203),me=i(1204),fe=i(1206),ge=i(1209),_e=i(1213),ve=i(1215),ye=i(1220),be=i(1222),we=i(1228),Me=i(1230),Te=i(1232),Ce=i(1234),Ie=i(1242),Ae=i(1244),Se=i(1246),Ee=i(1253),xe=i(1270),Le=i(1272),Ne=i(1274),Oe=i(1284),De=i(1286),Re=i(1288),Pe=i(1290),Be=i(1293),ke=i(1295),Fe=i(1297);e.exports=function(){var e=new o({enablePresets:!0,dataHandler:window.gui.playerData.inventory
});n.addWindow("breedDetail",new r),n.addWindow("breeding",new l,{fixed:!0,group:"inventory"}),n.addWindow("cancel",new Te),n.addWindow("characterCreation",new de,{fixed:!0}),n.addWindow("serverSimpleSelection",new G,{fixed:!0}),n.addWindow("serverListSelection",new U,{fixed:!0}),n.addWindow("serverDetails",new W),n.addWindow("serverSelection",new Y,{fixed:!0}),n.addWindow("worldMap",new ie),n.addWindow("characteristics",new c,{group:"mainGroup"}),n.addWindow("characUpdate",new p),n.addWindow("fightEnd",new v),n.addWindow("fightList",new y),n.addWindow("itemAppearance",new L),n.addWindow("itemBox",new N),n.addWindow("itemManage",new O),n.addWindow("itemRecipes",new D),n.addWindow("itemSets",new R),n.addWindow("levelUp",new P),n.addWindow("rewardsPending",new q),n.addWindow("characterSelection",new u,{fixed:!0}),n.addWindow("giftSelection",new d,{fixed:!0}),n.addWindow("deleteCharacterConfirm",new h,{fixed:!0}),n.addWindow("options",new Ce),n.addWindow("adminConsole",new s),n.addWindow("document",new m),n.addWindow("houseBuySell",new x),n.addWindow("teleporterList",new j),n.addWindow("exchangeInventory",new V(e),{group:"inventory"}),n.addWindow("exchangeStorage",new X),n.addWindow("wallet",new ee),n.addWindow("tradeInventory",new Z(e),{group:"inventory"}),n.addWindow("tradeStorage",new $),n.addWindow("tradeMode",new J),n.addWindow("tradeItem",new Q),n.addWindow("tradeItemConfirm",new K),n.addWindow("bidHouseShop",new te),n.addWindow("mimicry",new B),n.addWindow("itemPicking",new k(e),{group:"inventory"}),n.addWindow("padlock",new F),n.addWindow("global",new b),n.addWindow("prismVulnerabilityDate",new M),n.addWindow("socialGroupCreation",new T),n.addWindow("allianceCard",new C),n.addWindow("guildCard",new I),n.addWindow("guildHouseInfo",new A),n.addWindow("guildHouseSetting",new S),n.addWindow("equipment",new f(e),{group:"inventory"}),n.addWindow("estateForSale",new g),n.addWindow("estateInformation",new _),n.addWindow("partyInviteDetails",new z),n.addWindow("presetChooseIcon",new H),n.addWindow("arena",new a),n.addWindow("grimoire",new w,{group:"mainGroup"}),n.addWindow("social",new ne,{group:"mainGroup"}),n.addWindow("paddockBuy",new oe),n.addWindow("mount",new se),n.addWindow("feed",new ae),n.addWindow("mountRename",new re),n.addWindow("familyTree",new le),n.addWindow("jobOptions",new ce),n.addWindow("spellForget",new ue),n.addWindow("crafting",new he),n.addWindow("craftingMulti",new pe),n.addWindow("craftersList",new me),n.addWindow("crafter",new fe),n.addWindow("craftMagus",new ge),n.addWindow("craftMagusMulti",new _e),n.addWindow("craftPayment",new ve),n.addWindow("craftInventory",new ye(e),{group:"inventory"}),n.addWindow("tradeWithNPC",new we),n.addWindow("tradeWithPlayer",new be),n.addWindow("tradeWithPlayerAndNPCInventory",new Me(e),{group:"inventory"}),n.addWindow("guildMemberRights",new E),n.addWindow("fightEndRewards",new Ie),n.addWindow("hardcoreDeath",new Ae),n.addWindow("purchasesPending",new Le),n.addWindow("buyHardCurrencyConfirm",new xe),n.addWindow("shopConfirm",new Se),n.addWindow("market",new Ee),n.addWindow("toa",new Ne),n.addWindow("shieldWindow",new Oe,{group:"inventory"}),n.addWindow("ShieldSelectionWindow",new De),n.addWindow("help",new Re),n.addWindow("toaRetryPopup",new Pe),n.addWindow("PromotionPopupWindow",new Be),n.addWindow("marketingWindow",new ke),n.addWindow("ratingWindow",new Fe)}},function(e,t,i){function n(e){h.call(this),e=e||{},this.itemList={},this._filteredItemList={},this._sortedItemList=[],this.itemsQuantityList={},this.slotList={},this.weight=0,this.maxWeight=1,this._isTagBarHidden=!0,this._disconneting=!1,this.enablePresets=e.enablePresets;var t=e.dataHandler;this.enableLookAllObjects=e.enableLookAllObjects,this._defaultFilter=function(e,t,i,n,o,s){if(!this.enableLookAllObjects&&e.position!==O)return!1;if(0===t)return!1;if(this.filteringOptions.usable&&!e.item.usable)return!1;if(!this.filterCategories[i])return!1;if(i!==this.filteringOptions.filterId&&o)return!1;if(e.item.typeId!==this.filteringOptions.subFilterId&&s)return!1;if(n&&e.isFullSoulStone())for(var a=0;a<e.effects.length;a++)if(m.simplifyString(e.effects[a].description).indexOf(n)!==-1)return!0;return!n||e.item.getNameForSearch().indexOf(n)!==-1},this._filters=[this._defaultFilter],t&&this.setDataHandler(t),this.currentOpenedWindow=null,this.selectedSlot=null,this.slotToShow=null,this.filterCategories={};for(var i in g.categories)this.filterCategories[g.categories[i]]=!0;this.filteringOptions={},this.storageUI=new I("div",{className:"StorageViewer"}),this.domIsCreated=!1,this.contentInitiated=!1,this.listUpdateRequested=null,this.dataHandlerItemList=null,this._itemFilter=null,this.sortingCriterias=null,this.sortingOrder="",this.currentPage=-1,this.pageCount=-1,this.dragSourceData={}}function o(){this.addClassNames("pressed")}function s(){this.delClassNames("pressed")}function a(e){var t=new I("div",{className:["arrow",e]});return C(t),t.on("tapstart",o),t.on("tapend",s),t}function r(e,t,i){var n=i.storageViewer.currentOpenedWindow;return!n.prepareForDragFunction||n.prepareForDragFunction(e,t,i)}function l(e,t,i){return e[i]-t[i]}function c(e,t,i,n){for(var o=0;o<e.length;o++){var s=e[o],a=D[s]||l,r=a(i,n,s,t);if(0!==r)return"ASC"===t?r:-r}return 0}i(904);var u=i(248).addTooltip,d=i(383),h=i(209).EventEmitter,p=i(29).getText,m=i(252),f=i(191).inherits,g=i(509),_=i(832),v=i(578),y=i(828),b=i(905),w=i(605),M=i(595),T=i(229).events,C=i(228),I=i(235),A=i(184),S=40,E=A.WARN_INVENTORY_YELLOW_MIN,x=A.WARN_INVENTORY_RED_MIN,L=30,N=14,O=g.positions.notEquipped;f(n,h),e.exports=n,n.prototype.setDataHandler=function(e){e&&(this._setupEvents(e),this.enablePresets&&this.on("StorageViewerOpen",function(){this.setWeight(e.weight,e.maxWeight),this.setKamas(e.kamas)}))},n.prototype._updatePageSystem=function(e){var t=this.currentOpenedWindow;t&&(t._storageViewer=t._storageViewer||{},this.slotsMask.setStyles({width:t.availableSlotBoxWidth,height:t.availableSlotBoxHeight}),this._updatePageCount(t,e),this.slotsBox.setStyle("height",t._storageViewer.slotsPerColumn*this.pageCount*S+"px"),this.slotsBox.show())},n.prototype._updatePageCount=function(e,t){var i=e._storageViewer;if(i.slotsPerPage){var n=Math.ceil(this.displayedSlotCount/i.slotsPerPage)||1;n!==this.pageCount&&(this.pageCount=n,this._displayPage(0,t),this.pagination.setPageCount(n))}},n.prototype._getAvailableSpaceAndUpdatePageSystem=function(){var e=this.currentOpenedWindow;if(!e)return!1;e._storageViewer=e._storageViewer||{};var t=e._storageViewer,i=this.storageUI.rootElement.clientHeight,n=this.pagination.rootElement.clientHeight,o=this.podContainer.rootElement.clientHeight,s=this._itemFilter.rootElement.clientHeight,a=i-(n+o+s+N);if(a<=0)return!1;var r=this.slotsContainer.rootElement.clientWidth,l=Math.floor(r/S);return t.slotsPerColumn=Math.floor((a-(this._isTagBarHidden?0:L))/S),t.slotsPerPage=l*t.slotsPerColumn,e.availableSlotBoxWidth=l*S+"px",e.availableSlotBoxHeight=t.slotsPerColumn*S+"px",this._updatePageSystem(),!0},n.prototype._initializeView=function(){this._isTagBarHidden=!0,this._getAvailableSpaceAndUpdatePageSystem()&&this.slotToShow&&this._displaySlotPage(this.slotToShow)},n.prototype.registerView=function(e,t){var i=this;t=t||{},e.on("open",function(){var n=i.currentOpenedWindow=this;if(i.dragSourceData.source=this.id,n.tapSelectedEmitsDoubleTap=t.tapSelectedEmitsDoubleTap,n.prepareForDragFunction=t.prepareForDragFunction,i._disconneting=!1,i.contextParams=t.contextParams||{},i.enableAveragePrice=!t.hasOwnProperty("enableAveragePrice")||t.enableAveragePrice,i.enableSlotContext=!t.hasOwnProperty("enableSlotContext")||t.enableSlotContext,i.domIsCreated||(i._createDom(),i.domIsCreated=!0),i.contentInitiated||i._spinner.addSpinner("loading"),i.averagePrice.toggleDisplay(!!i.enableAveragePrice),t.manualOpening||e.windowBody.appendChild(i.storageUI),e.availableSlotBoxWidth?i._updatePageSystem():i.slotsBox.hide(),i.currentOpenedWindow!==i.lastOpenedWindow){i.leftArrow.toggleDisplay(!!t.leftArrow),i.rightArrow.toggleDisplay(!!t.rightArrow),i.slotsMask.toggleClassName("hoverable",!!t.showHoverFrame);var o;if(!i.listUpdateRequested)for(o in i.slotList){var s=i.slotList[o];s.data&&(i.contextParams.item=s.data,s.setContextMenu("item",i.contextParams),s.enableContextMenu(!!i.enableSlotContext))}i._itemFilter.setAvailableCategories(t.filters)}i.contentInitiated=!0,i.emit("StorageViewerOpen")}),e.on("opened",function(){i.domIsCreated?i._initializeView():i.once("domCreated",i._initializeView),i.listUpdateRequested?(i.setItemList(i.listUpdateRequested),i.dataHandlerItemList=i.listUpdateRequested,i.listUpdateRequested=null):t.manualReset||i.resetDisplay()}),e.on("close",function(){i.lastOpenedWindow=i.currentOpenedWindow,i.currentOpenedWindow=null})},n.prototype._createDom=function(){function e(e){return e>=E&&e<x?p("tablet.inventory.yellowWarningTooltip"):e>=x?p("tablet.inventory.redWarningTooltip"):""}var t=this,i=this.storageUI=new I("div",{className:"StorageViewer"}),n=i.createChild("div",{className:"filterBox"}),o=this.leftArrow=n.appendChild(a("left"));u(o,p("ui.storage.advancedTransferts")),o.on("tap",function(e){t.currentOpenedWindow&&t.currentOpenedWindow.emit("leftArrow-tap",e)}),this._itemFilter=n.appendChild(new v({withTagBar:!0}));var s=this._itemFilter.getCurrentSorting();this.sortingCriterias=[s.by],this.sortingOrder=s.order,this.defaultSorting=this.sortingCriterias.toString()+"/"+this.sortingOrder,this.enablePresets&&(this.presetsBox=i.appendChild(new b),this.presetsBox.on("setItemSlotTapped",function(e){e.data&&"placeholder"===e.data.mountLocation||t.currentOpenedWindow.emit("slot-tap",e)})),this._itemFilter.toggleCategoryDisplay(g.categories.preset,!!this.enablePresets),this._itemFilter.on("filter",function(e,i,n){var o=t.filteringOptions.filterId!==e||t.filteringOptions.subFilterId!==i||t.filteringOptions.search!==n;o&&(t.filteringOptions.filterId=e,t.filteringOptions.subFilterId=i,t.filteringOptions.search=n,t._showTagBar(),t.filterList(),t.presetsBox&&t._enablePresetsView(e===g.categories.preset),t._updateFilter(),t._getAvailableSpaceAndUpdatePageSystem(),t._displayPage(0,!0),t.emit("filter",e))}),this._itemFilter.on("sort",function(e,i){t._spinner.addSpinner("sorting"),m.forceReflow(t.slotsContainer,function(){t.sortBy(e,i)})}),o=this.rightArrow=n.appendChild(a("right")),u(o,p("ui.storage.advancedTransferts")),o.on("tap",function(e){t.currentOpenedWindow&&t.currentOpenedWindow.emit("rightArrow-tap",e)}),this.slotsContainer=i.createChild("div",{className:"slotBox"}),this.slotsMask=this.slotsContainer.createChild("div",{className:"slotsMask"}),this.slotsBox=this.slotsMask.createChild("div",{className:"slots"}),this.slotsBox.hide(),this.slotsBox.rootElement.addEventListener(T.end,function(e){e.preventDefault()},!1),this._spinner=new M(this.slotsContainer,(!0)),this.pagination=i.appendChild(new y),this.pagination.on("previous",function(){t._displayPage(t.currentPage-1)}),this.pagination.on("next",function(){t._displayPage(t.currentPage+1)}),this.pagination.on("page",function(e){t._displayPage(e)}),this.pagination.setPageCount(this.pageCount);var r=this.podContainer=i.createChild("div",{className:"podContainer"}),l=r.createChild("div",{className:"priceBox"});this.averagePrice=l.createChild("div",{className:"averagePrice",text:0}),u(this.averagePrice,function(){var e=m.kamasToString(t.averagePriceValue);return new I("div",{text:p("ui.storage.estimatedValue")+p("ui.common.colon")+e})}),this.kamas=l.createChild("div",{className:"kamas",text:0}),u(this.kamas,function(){var e=m.kamasToString(t.kamasValue);return new I("div",{text:p("ui.storage.ownedKamas")+p("ui.common.colon")+e})});var c=r.createChild("div",{className:"progressBarContainer"});this.barLabel=c.createChild("div",{text:p("tablet.common.pods")+":",className:"label"}),this.progressBar=c.appendChild(new w({className:"green"})),u(this.progressBar,function(){return new I("div",{text:e(t.weight/t.maxWeight)+"\n("+m.intToString(t.weight)+" / "+m.intToString(t.maxWeight)+")"})}),this.emit("domCreated")},n.prototype._showTagBar=function(){var e=this.filteringOptions,t=e.filterId!==-1||e.subFilterId!==-1||!!e.search,i=this.sortingCriterias.toString()+"/"+this.sortingOrder,n=i!==this.defaultSorting;this.slotsMask.toggleClassName("withFilter",t||n)},n.prototype.setBarLabel=function(e){this.barLabel.setText(e)},n.prototype._enablePresetsView=function(e){this.pagination.toggleDisplay(!e),this.podContainer.toggleDisplay(!e),this.kamas.toggleDisplay(!e),this.presetsBox.toggleDisplay(e)},n.prototype._filter=function(e,t,i,n,o,s){for(var a=0,r=this._filters.length;a<r;a+=1){var l=this._filters[a];if(!l.call(this,e,t,i,n,o,s))return!1}return!0},n.prototype._displayPage=function(e,t){if(!t){if(this.currentPage===e||!this.currentOpenedWindow)return;if(e<0||e>this.pageCount-1)return}this.currentPage=e,this.pagination.setCurrent(e),this.sortBy(this.sortingCriterias,this.sortingOrder)},n.prototype.addFilters=function(e){for(var t=0,i=e.length;t<i;t+=1)this._filters.push(e[t])},n.prototype.removeFilter=function(e){var t=this._filters;t.indexOf(e)!==-1?t.splice(t.indexOf(e),1):console.error(new Error("StorageViewer: remove unknown filter"))},n.prototype.clearFilters=function(){this._filters=[this._defaultFilter],this._filteredItemList={}},n.prototype._updateAveragePrice=function(){var e=0;for(var t in this._filteredItemList){var i=this.itemList[t];if(i){var n=i.getItem();if(n){var o=n.averagePrice===-1?0:n.averagePrice;e+=o*this.itemsQuantityList[t]}else console.error(new Error("no item ref for "+(i.id||i.objectGID)+", is an instance? "+i.isItemInstance+", is yet initialised? "+i.isInitialised))}}this.averagePriceValue=e,this.averagePrice.setText(m.intToString(e))},n.prototype._updateFilter=function(){var e={};for(var t in this._filteredItemList){var i=this._filteredItemList[t];if(i.position===O&&this.itemsQuantityList[t]>0){if(!i.item){console.error(new Error('Missing the property "item" for itemInstance: '+i.id));continue}e[i.item.typeId]=!0}}this._itemFilter.updateSubFilters(Object.keys(e))},n.prototype._filterItem=function(e){var t=this.slotList[e.objectUID];if(t){var i=this.filteringOptions.search?m.simplifyString(this.filteringOptions.search):null,n=this.filteringOptions.filterId!==v.filters.all,o=this.filteringOptions.subFilterId!==v.subFilters.all,s=g.getItemTypeMap(),a=s[e.item.typeId].category,r=this.itemsQuantityList[e.objectUID],l=r&&this._filter(e,r,a,i,n,o);this._setDisplayedSlotCount(i,n,o),t.isVisible()&&(this.displayedSlotCount-=1),l?this.displayedSlotCount+=1:this.unSelectSlot(e.objectUID),this._updatePageSystem(),this.enableAveragePrice&&this._updateAveragePrice()}},n.prototype._setDisplayedSlotCount=function(e,t,i){this.displayedSlotCount=0;var n=g.getItemTypeMap();this._filteredItemList={};for(var o in this.itemList){var s=this.itemList[o];if(s.isInitialised){var a=n[s.item.typeId].category,r=this._filter(s,this.itemsQuantityList[o],a,e,t,i);r?(this.displayedSlotCount+=1,this._filteredItemList[o]=s):this.unSelectSlot(s.objectUID)}}},n.prototype.filterList=function(e){var t=this.filteringOptions.search?m.simplifyString(this.filteringOptions.search):null,i=this.filteringOptions.filterId!==v.filters.all,n=this.filteringOptions.subFilterId!==v.subFilters.all;t||i||n?this._isTagBarHidden=!1:this._isTagBarHidden=!0,this._setDisplayedSlotCount(t,i,n),this._updatePageSystem(e),this.enableAveragePrice&&this._updateAveragePrice()},n.prototype.getDisplayedItemsUIDs=function(){for(var e=[],t=this._sortedItemList,i=0;i<t.length;i+=1){var n=parseInt(t[i],10);e.push(n)}return e},n.prototype._createSlot=function(e){var t=new _({itemData:e,enableContextMenu:this.enableSlotContext});t.storageViewer=this,t.setQuantity(e.quantity),t.setContextMenu("item",this.contextParams);var i=this;return t.on("tap",function(e){t.selected?i.currentOpenedWindow.emit("slot-doubletap",t,e.x,e.y):t!==i.selectedSlot?(i.selectSlot(t),i.currentOpenedWindow.emit("slot-tap",t,e.x,e.y)):i.currentOpenedWindow.tapSelectedEmitsDoubleTap&&i.currentOpenedWindow.emit("slot-doubletap",t,e.x,e.y)}),t.on("doubletap",function(e){i.currentOpenedWindow.emit("slot-doubletap",this,e.x,e.y)}),t.on("dragStart",function(){d.setElementSource(this,i.currentOpenedWindow.id),i.dragSourceData.slot=t,i.currentOpenedWindow.emit("slot-dragStart",t)}),d.setDraggable(t,{backgroundImage:t.getImage(),prepareForDrag:r},"storageViewer",i.dragSourceData),this.emit("slotCreated",t),t};var D={none:function(e,t){return e.objectUID-t.objectUID},name:function(e,t){return e&&e.item&&e.item.nameId?t&&t.item&&t.item.nameId?e.item.nameId.localeCompare(t.item.nameId):(console.error("Missing information for "+t&&t.id),0):(console.error("Missing information for "+e&&e.id),0)},level:function(e,t){return e.item.level-t.item.level},totalWeight:function(e,t){return e.quantity*e.weight-t.quantity*t.weight},averagePrice:function(e,t){var i=e.item.averagePrice,n=t.item.averagePrice;return i>0&&n>0?i-n:i>0?1:n>0?-1:e.objectUID-t.objectUID},totalAveragePrice:function(e,t){var i=e.item.averagePrice,n=t.item.averagePrice;return i>0&&n>0?e.quantity*i-t.quantity*n:i>0?1:n>0?-1:e.objectUID-t.objectUID},category:function(e,t){return e.item.type.nameId.localeCompare(t.item.type.nameId)}};n.prototype._displaySlotPage=function(e){var t=this.currentOpenedWindow&&this.currentOpenedWindow._storageViewer;if(!t||!t.slotsPerPage)return void(this.slotToShow=e);this.slotToShow=null;for(var i=this.slotsBox.getChildren(),n=0,o=0;o<i.length;o++){var s=i[o];if(s.isVisible()){if(s===e)return void this._displayPage(~~(n/t.slotsPerPage));n++}}},n.prototype.sortBy=function(e,t){var i=this.currentOpenedWindow;if(i){var n=this._filteredItemList,o=this,s=this.slotsBox.getChildren();s.forEach(function(e){o.slotsBox.rootElement&&e&&o.slotsBox.removeChild(e)});var a=i._storageViewer;if(e&&n){this.sortingCriterias=e,this.sortingOrder=t;var r=Object.keys(n).sort(function(i,o){return c(e,t,n[i],n[o])});this._sortedItemList=r;for(var l=this.currentPage?this.currentPage*a.slotsPerPage:0,u=this.pageCount>this.currentPage&&r.length>a.slotsPerPage?(this.currentPage+1)*a.slotsPerPage:r.length,d=l;d<u;d+=1){var h=this.slotList[r[d]];if(!h){var p=parseInt(r[d],10),m=this.itemList[p];if(!m)continue;this.slotList[p]=this._createSlot(m),this.itemsQuantityList[p]=m.quantity,h=this.slotList[r[d]]}this.slotsBox.appendChild(h)}this._spinner.removeSpinner("sorting"),this._getAvailableSpaceAndUpdatePageSystem(),this._showTagBar()}}},n.prototype.resetDisplay=function(){for(var e in this.itemList){var t=this.itemsQuantityList[e]=this.itemList[e].quantity;this.slotList[e]&&this.slotList[e].setQuantity(t)}this._itemFilter&&this._itemFilter.reset(),this.pageCount=-1,this.currentPage=-1,this._updatePageSystem(),this.selectedSlot&&this.unSelectSlot()},n.prototype.unloadContent=function(){this._disconneting||(this.slotList={},this.slotsBox&&this.slotsBox.clearContent(),this._filteredItemList={},this.itemsQuantityList={},this.itemList=[],this.selectedSlot=null,this.contentInitiated=!1,this.currentPage=-1,this.pageCount=-1,this.listUpdateRequested=this.dataHandlerItemList)},n.prototype._disconnectionReset=function(){this.unloadContent(),this._sortedItemList=[],this.listUpdateRequested=null},n.prototype.setItemList=function(e){this._spinner&&!this._spinner.isActive()&&console.warn("Missing spinner",this.dragSourceData),this.slotsBox&&this.slotsBox.clearContent(),this.slotList={},this.itemsQuantityList={},this.itemList=e,this.selectedSlot=null;for(var t in this.itemList){var i=this.itemList[t];this.itemsQuantityList[t]=i.quantity}this.filterList(),this._updateFilter(),this._itemFilter.reset(),this.sortBy(this.sortingCriterias,this.sortingOrder),this._spinner.removeSpinner("loading")},n.prototype.modifyItem=function(e){if(this.contentInitiated){var t=e.objectUID,i=this.slotList[t];i&&(this.unSelectSlot(t),i.destroy(),delete this.slotList[t]),this.slotList[t]=this._createSlot(e),this.itemList[t]=e,this.itemsQuantityList[t]=e.quantity,this._filterItem(e),this.filterList(),this._displayPage(this.currentPage,!0),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemModified",e)}},n.prototype.moveItem=function(e){this.contentInitiated&&(this._filterItem(e),this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemMoved",e),this._displayPage(this.currentPage,!0))},n.prototype.setItemQuantity=function(e,t){var i=this.currentOpenedWindow;if(this.itemsQuantityList[e]=t,i&&this.contentInitiated){var n=this.slotList[e];if(!n)return void console.error(new Error("No slot with item UID "+e));n.setQuantity(t),this._filterItem(this.itemList[e]),this._updateFilter(),this.filterList(),this._displayPage(this.currentPage,!0),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemQuantity",this.itemList[e],t)}},n.prototype.setItemsQuantity=function(e){if(this.contentInitiated){for(var t in e){var i=this.slotList[t],n=e[t];if(!i)return void console.error(new Error("No slot with item UID "+t));i.setQuantity(n),this.itemsQuantityList[t]=n,this._filterItem(this.itemList[t])}this._updateFilter(),this.filterList(),this._displayPage(this.currentPage,!0),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemsQuantity",e)}},n.prototype.resetItemQuantity=function(e){var t=this.itemList[e];t&&this.setItemQuantity(e,t.quantity)},n.prototype.resetItemsQuantity=function(){for(var e in this.itemList)this.resetItemQuantity(e);this.filterList(),this._displayPage(this.currentPage,!0)},n.prototype._addItem=function(e){var t=e.objectUID,i=this.slotList[t];i&&this._removeItem(t),this.itemList[t]=e,this.itemsQuantityList[t]=e.quantity},n.prototype.addItem=function(e){this.contentInitiated&&(this._addItem(e),this._filterItem(e),this._updateFilter(),this.filterList(),this._displayPage(this.currentPage,!0),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemAdded",e))},n.prototype.addItems=function(e){if(this.contentInitiated){for(var t in e){var i=e[t];this._addItem(i),this._filterItem(i)}this.filterList(),this._displayPage(this.currentPage,!0),this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemsAdded",e)}},n.prototype._removeItem=function(e){var t=this.slotList[e];t&&(this.unSelectSlot(t.itemInstance.objectUID),t.destroy()),delete this.slotList[e],delete this.itemList[e],delete this.itemsQuantityList[e],delete this._filteredItemList[e]},n.prototype.removeItems=function(e){if(this.contentInitiated){for(var t=0,i=e.length;t<i;t+=1)this._removeItem(e[t]);this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemsRemoved",e),this.filterList(),this._displayPage(this.currentPage,!0)}},n.prototype.removeItem=function(e){this.contentInitiated&&(this._removeItem(e),this._updateFilter(),this.currentOpenedWindow&&this.currentOpenedWindow.emit("itemRemoved",e),this.filterList(),this._displayPage(this.currentPage,!0))},n.prototype.setPodProgressBarValue=function(e){this.progressBar.setValue(e),this.progressBar.toggleClassName("green",e<.75),this.progressBar.toggleClassName("yellow",e>=.75&&e<.9),this.progressBar.toggleClassName("orange",e>=.9&&e<1),this.progressBar.toggleClassName("red",e>=1),this.progressBar.toggleClassName("warnYellowIconCircle",e>=E&&e<x),this.progressBar.toggleClassName("warnRedIconCircle",e>=x)},n.prototype.setMaxWeight=function(e){this.maxWeight=e||1,this.contentInitiated&&(this.setPodProgressBarValue(this.weight/this.maxWeight),this.currentOpenedWindow&&this.currentOpenedWindow.emit("weightUpdated",this.weight,this.maxWeight))},n.prototype.refreshSlotGauge=function(){this.setWeight(Object.keys(this.itemList).length)},n.prototype.setWeight=function(e,t){this.weight=e,this.maxWeight=t||this.maxWeight,this.contentInitiated&&(this.setPodProgressBarValue(this.weight/this.maxWeight),this.currentOpenedWindow&&this.currentOpenedWindow.emit("weightUpdated",e,this.maxWeight))},n.prototype.setKamas=function(e){this.contentInitiated&&(this.kamasValue=e,this.kamas.setText(m.intToString(e)),this.currentOpenedWindow&&this.currentOpenedWindow.emit("kamasUpdated",e))},n.prototype.selectAndShowSlotByGID=function(e){for(var t in this.slotList){var i=this.itemList[t];if(i.getProperty("id")===e&&this._selectSlotAndDisplayPage(this.slotList[t]))return i}return null},n.prototype.getSlotByUID=function(e){return this.slotList[e]},n.prototype.selectAndShowSlotByUID=function(e){var t=this.slotList[e];return t&&this._selectSlotAndDisplayPage(t)?t.itemInstance:null},n.prototype._selectSlotAndDisplayPage=function(e){return!!e.isVisible()&&(this.selectSlot(e),this._displaySlotPage(e),!0)},n.prototype.selectSlot=function(e,t){this.selectedSlot&&e!==this.selectedSlot&&this.selectedSlot.unselect(),e&&e.select(t),this.selectedSlot=e},n.prototype.unSelectSlot=function(e){if(void 0===e)return void(this.selectedSlot&&(this.selectedSlot.unselect(),this.selectedSlot=null));var t=this.slotList[e];this.selectedSlot===t&&(t.unselect(),this.selectedSlot=null)},n.prototype.toggleSlotSelection=function(e){var t=this.slotList[e];this.selectedSlot!==t?(this.selectedSlot&&this.selectedSlot.unselect(),t.select(),this.selectedSlot=t):(t.unselect(),this.selectedSlot=null)},n.prototype.getSelectedSlot=function(){return this.selectedSlot},n.prototype._setupEvents=function(e){var t=this;e.on("listUpdate",function(e){t.currentOpenedWindow?t.setItemList(e):t.listUpdateRequested=e}),e.on("unloaded",function(){t._disconnectionReset(),t._disconneting=!0}),e.on("itemAdded",function(e){t.addItem(e)}),e.on("itemsAdded",function(e){t.addItems(e)}),e.on("itemDeleted",function(e){t.removeItem(e)}),e.on("itemsDeleted",function(e){t.removeItems(e)}),e.on("itemModified",function(e){t.modifyItem(e)}),e.on("itemMoved",function(e){t.moveItem(e)}),e.on("itemQuantity",function(e,i){t.setItemQuantity(e,i)}),e.on("itemsQuantity",function(e){t.setItemsQuantity(e)}),e.on("kamasUpdated",function(e){t.setKamas(e)}),e.on("weightUpdated",function(e,i){t.setWeight(e,i)})},n.prototype.getDisplayedQuantity=function(e){return this.itemsQuantityList[e]},n.prototype.getEquipmentFilterButtonForTuto=function(){return this._itemFilter.getEquipmentButton()},n.prototype.getQuestFilterButtonForTuto=function(){return this._itemFilter.getQuestButton()},n.prototype.getStorageFirstSlotForTuto=function(){var e=this.slotsBox.getChildren();return e[0]},n.prototype.showEquippableItems=function(){this._itemFilter.selectCategory(v.filters.equipment)},n.prototype.showTokens=function(e){this._itemFilter.toggleCategoryDisplay(e,!0),this._itemFilter.selectCategory(e)}},function(e,t){},function(e,t,i){function n(e,t){e.setData(t),a.preloadImage("gfx/mounts/"+t.model+".png",function(t){e.setImage(t)})}function o(){function e(){var e=N.setSlotsBox.selectedSlot;t(!e.preset),e.preset?(N.deleteSetButton.enable(),N.saveSetButton.enable()):(N.deleteSetButton.disable(),N.saveSetButton.disable());var i=window.gui.playerData.inventory.presets;Object.keys(i).length>=y?N.addSetButton.disable():N.addSetButton.enable()}function t(e){N.explanationPanel.toggleDisplay(e),N.setItemSlotsBox.toggleDisplay(!e),N.buttonsBox.toggleDisplay(!e)}function i(e){function t(t){if("remove"===t){var a=N.setSlotsBox.selectedSlot&&N.setSlotsBox.selectedSlot.preset;if(!a)return void console.error(new Error("PresetBox#setDeleteContextMenu: selectedPreset is missing for pos "+n+" mountModel "+o+" type "+s));var r=i.getName&&i.getName();return r?void A(r,a.presetId,function(t){t===_.YES?N.saveCustom=!0:e.setItem(i)}):void console.error(new Error("PresetBox#setDeleteContextMenu: itemNameId is missing for pos "+n+" mountModel "+o+" type "+s))}}var i=e.getItem&&e.getItem()||e.data,n=e.data&&e.data.position,o=e.data&&e.data.model,s=e.data&&e.data._type;return i?i.model?void e.enableContextMenu(!1):(e.enableContextMenu(!0),void e.setContextMenu("preset",{slot:e,canRemove:!0,onClose:t})):void console.error(new Error("PresetBox#setDeleteContextMenu: itemData is missing for pos "+n+" mountModel "+o+" type "+s))}function n(t){t.select();var i;N.setSlotsBox.getChild(t.getWuiName())?(i=N.setSlotsBox,N._displaySet(t.preset)):N.setItemSlotsBox.getChild(t.getWuiName())?(i=N.setItemSlotsBox,N.emit("setItemSlotTapped",t)):i=N.setIconsBox,i.selectedSlot&&t!==i.selectedSlot&&i.selectedSlot.unselect(),i.selectedSlot=t,i===N.setSlotsBox&&e()}function o(e){e.preset&&(window.dofus.sendMessage("InventoryPresetUseMessage",{presetId:e.preset.presetId}),N.addClassNames("spinner"))}function u(e){e.on("tap",function(){n(this)})}function p(e){e.on("doubletap",function(){o(this)})}function m(e){e.on("setData",function(){i(this)})}function g(){for(var e=0;e<y;e+=1){var t=N.setSlotsBox.appendChild(new d({name:"setSlot"+e}));u(t),p(t),t.dragUI={width:M,height:M,onDragClassName:"slot"},l.setDraggable(t,t.dragUI,"presets",{type:v})}}function b(){for(var e=0;e<T.length;e+=1){var t=N.setItemSlotsBox.appendChild(new h({name:"setItemSlot"+T[e],errorIcon:!0}));t.addClassNames("pos"+T[e]),u(t),m(t)}}function C(){N.setIconsBox.addClassNames("spinner");for(var e=[],t=0;t<w;t+=1){e.push("gfx/presets/small_"+t+".png");var i=N.setIconsBox.appendChild(new d({name:"setIconSlot"+t}));u(i)}a.preloadImages(e,function(e){for(var t=0;t<e.length;t+=1){var i=N.setIconsBox.getChild("setIconSlot"+t);i.setImage(e[t])}N.setIconsBox.delClassNames("spinner")})}function I(e,t){window.gui.openConfirmPopup({title:c("ui.popup.warning"),message:c("ui.preset.warningDelete",e+1),cb:t})}function A(e,t,i){window.gui.openConfirmPopup({title:c("ui.popup.warning"),message:c("ui.preset.warningItemDelete",e,t+1),cb:i})}function S(){N.addSetButton.on("tap",function(){this.disable(),N._addSet()}),N.importSetButton.on("tap",function(){N._importSet()}),s(N.importSetButton,c("ui.preset.importCurrentStuff")),N.deleteSetButton.on("tap",function(){var e=N.deleteSetButton;e.disable();var t=N.setSlotsBox.selectedSlot&&N.setSlotsBox.selectedSlot.preset;return t?void I(t.presetId,function(i){i===_.YES?(window.dofus.sendMessage("InventoryPresetDeleteMessage",{presetId:t.presetId}),N.addClassNames("spinner")):e.enable()}):e.enable()}),s(N.deleteSetButton,c("ui.preset.delete")),N.chooseIconButton.on("tap",function(){N._confirmIconPopup(function(e){e===_.YES&&N._saveSet()})}),N.saveSetButton.on("tap",function(){this.disable(),N._saveSet()})}function E(){for(var e=N.setSlotsBox.getChildren(),t=0;t<e.length;t+=1){var i=e[t];i.preset&&N._deleteSet(i.preset.presetId)}var n=window.gui.playerData.inventory.presets||{};for(var o in n)N._updateSetSlot(o);e[0].emit("tap")}function x(e){var t={usePartial:c("ui.preset.error.usePartial"),badObjectId:c("ui.preset.error.badObjectId"),tooMany:c("ui.preset.error.tooMany"),criterion:c("ui.preset.error.criterion"),badId:c("ui.preset.error.badId"),badPosition:c("ui.preset.error.badPosition"),unknown:c("ui.common.unknownFail")};window.gui.openSimplePopup(t[e])}function L(){N.displayedPreset&&N.displayedPreset.mount&&N._displaySet(N.displayedPreset)}f.call(this,"div",{className:"PresetsBox"});var N=this;this.displayedItems={},this.setSlotsBox=this.createChild("div",{className:"setSlotsBox"}),this.addSetButton=this.appendChild(new r(c("ui.common.new"),{className:["addSetButton"]})),this.setItemSlotsBox=this.createChild("div",{className:"setItemSlotsBox"}),this.setIconsBox=this.createChild("div",{className:"setIconsBox"});var O=this.createChild("div",{className:"buttonsBox"});this.importSetButton=O.appendChild(new r("",{className:["importSetButton"]})),this.importSetButton.createChild("div",{className:"icon"}),this.deleteSetButton=O.appendChild(new r("",{className:["deleteSetButton"]})),this.deleteSetButton.createChild("div",{className:"icon"}),this.chooseIconButton=O.appendChild(new r("!",{className:["chooseIconButton"]})),this.chooseIconButton.createChild("div",{className:"icon"}),this.saveSetButton=O.appendChild(new r(c("ui.common.save"),{className:["saveSetButton"]})),this.buttonsBox=O,this.createChild("div",{className:"overlay"}),this.explanationPanel=this.createChild("div",{className:"explanationPanel"}),this.explanationPanel.createChild("div",{className:"instruction",
text:c("ui.preset.howToUse")}),g(),b(),C(),S(),E();var D=window.gui.playerData,R=D.inventory;R.on("listUpdate",function(){E()}),R.on("presetSaved",function(t,i){if(N.delClassNames("spinner"),i)return e(),x(i)}),R.on("presetDeleted",function(t,i){return N.delClassNames("spinner"),i?(e(),x(i)):(N._deleteSet(t),void e())}),R.on("presetUpdated",function(t,i){return i?x(i):(N._updateSetSlot(t),void e())}),R.on("presetItemUpdated",function(e){N._updateSetSlot(e)}),R.on("presetItemUpdateError",x),R.on("presetUsed",function(e,t){if(N.delClassNames("spinner"),t)return x(t);var i=R.presets[e],n=D.equippedMount&&i.mount&&!D.isRiding;n&&window.gui.textNotification.add(c("tablet.mount.cannotRide"))}),D.on("setMount",L),D.on("unsetMount",L)}i(906);var s=i(248).addTooltip,a=i(202),r=i(246).DofusButton,l=i(383),c=i(29).getText,u=i(509),d=i(834),h=i(832),p=i(191),m=i(225),f=i(235),g=i(510),_=i(907).actionsEnum,v=i(827).GENERAL_SHORTCUT_BAR,y=8,b=33,w=27,M=40,T=[g.positions.cosmeticHat,g.positions.cosmeticWeapon,g.positions.cosmeticShield,g.positions.cosmeticCape,g.positions.cosmeticPets,g.positions.hat,g.positions.weapon,g.positions.shield,g.positions.cape,g.positions.pets,g.positions.amulet,g.positions.ringLeft,g.positions.ringRight,g.positions.belt,g.positions.boots,g.positions.dofus1,g.positions.dofus2,g.positions.dofus3,g.positions.dofus4,g.positions.dofus5,g.positions.dofus6,g.positions.mount],C=u.positions.mount,I=3;p.inherits(o,f),e.exports=o,o.prototype._getItemPosMap=function(e){if(e){for(var t=e.objects||e,i=window.gui.playerData.inventory,n={},o=0;o<t.length;o+=1){var s,a=t[o].objUid||t[o].objectUID,r=t[o].position;if(a)s=i.objects[a];else{var l=t[o].objGid;s=u.items[l]}n[r]=s}return n}},o.prototype._updateSetSlot=function(e){var t=window.gui.playerData.inventory.presets[e],i=this.setSlotsBox.getChild("setSlot"+t.presetId);i.preset=t,a.preloadImage("gfx/presets/icon_"+t.symbolId+".png",function(e){i.setImage(e),i.dragUI.backgroundImage=i.getImage(),l.enableDrag(i)});var n=this.setIconsBox.getChild("setIconSlot"+t.symbolId);n.preset=t;var o=this.setSlotsBox.selectedSlot&&this.setSlotsBox.selectedSlot.preset;o&&o.presetId===t.presetId&&this._displaySet(t)},o.prototype._getIsItemUnavailable=function(e){if(!e)return!1;if(e.mountLocation){var t=window.gui.playerData.equippedMount;return!t}return!e.objectUID||e.conditions&&!e.conditions.isRespected()},o.prototype._updateSetItemSlots=function(e){if(!e)return this._resetItemSlots(this.setItemSlotsBox.getChildren());for(var t=0;t<b;t+=1){var i=e[t],o=this.setItemSlotsBox.getChild("setItemSlot"+t);o&&(o.unset(),o.delClassNames("unavailable"),i&&(i.model?n(o,i):o.setItem(i),o.toggleClassName("unavailable",!!this._getIsItemUnavailable(i))))}var s=this.setItemSlotsBox.selectedSlot;s&&s.unselect()},o.prototype._resetItemSlots=function(e){for(var t=0;t<e.length;t+=1)e[t].unset()},o.prototype._displaySet=function(e){var t=window.gui.playerData,i=this._getItemPosMap(e),n=e&&e.symbolId;if(e)n=e.symbolId,e.mount&&(i[C]=t.equippedMount||{model:I,mountLocation:"placeholder"});else{var o=this.setIconsBox.getChildren(),s=this._getNextAvailableSlot(o);n=o.indexOf(s)}this._updateSetItemSlots(i),this.shouldSaveEquipment=!1,this.saveCustom=!1,this.setIconsBox.getChild("setIconSlot"+n).emit("tap"),this.displayedPreset=e},o.prototype._deleteSet=function(e){for(var t=this.setSlotsBox.getChildren(),i=0;i<t.length;i+=1){var n=t[i];if(n.preset&&n.preset.presetId===e){delete n.preset,n.unset(),l.disableDrag(n),this._resetItemSlots(this.setItemSlotsBox.getChildren());break}}},o.prototype._importSet=function(){var e=window.gui.playerData,t=e.inventory.equippedItems,i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);e.isRiding&&(i[g.positions.mount]=e.equippedMount),this._updateSetItemSlots(i),this.shouldSaveEquipment=!0},o.prototype._saveSet=function(){var e=this,t=this.setSlotsBox.getChildren(),i=this.setItemSlotsBox.getChildren(),n=this.setIconsBox.getChildren(),o=this.setSlotsBox.selectedSlot,s=this.setIconsBox.selectedSlot;if(o.preset){var a=n[o.preset.symbolId];delete a.preset}var r,l;if(this.saveCustom){for(var c=[],u=[],d=0;d<i.length;d+=1){var h=i[d].itemInstance;if(h)c.push(h.position),u.push(h.objectUID||h.mountLocation&&h.id);else{var p=i[d].data;p&&p.mountLocation&&(c.push(C),u.push(p.id))}}r={presetId:t.indexOf(o),symbolId:n.indexOf(s),itemsPositions:c,itemsUids:u},l="InventoryPresetSaveCustomMessage"}else r={presetId:t.indexOf(o),symbolId:n.indexOf(s),saveEquipment:this.shouldSaveEquipment},l="InventoryPresetSaveMessage";window.dofus.sendMessage(l,r),e.addClassNames("spinner")},o.prototype._getNextAvailableSlot=function(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(!i.preset)return i}},o.prototype._confirmIconPopup=function(e){m.open("presetChooseIcon",this.setIconsBox),m.getWindow("presetChooseIcon").once("close",e)},o.prototype._addSet=function(){var e=this,t=this._getNextAvailableSlot(this.setSlotsBox.getChildren());if(t){var i=this._getNextAvailableSlot(this.setIconsBox.getChildren());t.emit("tap"),i.emit("tap"),this._confirmIconPopup(function(t){return t!==_.YES?e.addSetButton.enable():(e._importSet(),void e._saveSet())})}}},function(e,t){},function(e,t,i){function n(e){e=e||{className:"confirmWindow",positionInfo:{left:"c",top:"c",width:600,height:200,isModal:!0},noCloseButton:!0},s.call(this,e),this._domCreated=!1,this.actionsEnum=u;var t=this._box=this.windowBody.createChild("div",{className:"messageBox"});this.message=t.createChild("div",{className:"message"})}i(908);var o=i(191).inherits,s=i(233),a=i(225),r=i(246).DofusButton,l=i(29).getText,c=i(678),u={NO:0,YES:1,IGNORE:2};o(n,s),e.exports=n,n.actionsEnum=u,n.prototype.createDom=function(){var e=this,t=this.windowBody.createChild("div",{className:"buttonContainer"});this._buttonYes=t.appendChild(new r(l("ui.common.yes"))),this._buttonYes.on("tap",function(){e.cb(u.YES),a.close(e.id,{keepDialog:e.keepDialog})}),this._buttonNo=t.appendChild(new r(l("ui.common.no"))),this._buttonNo.on("tap",function(){e.cb(u.NO),a.close(e.id)}),this._buttonIgnore=t.appendChild(new r(l("ui.common.ignore"))),this._buttonIgnore.on("tap",function(){e.cb(u.IGNORE),a.close(e.id)}),this._buttonIgnore.hide(),this._domCreated=!0},n.prototype.update=function(e,t){var i=this;if(this._domCreated||this.createDom(),this.message.clearContent(),t=t||{},this.windowTitle.setText(e.title||l("ui.common.confirm")),this.message.appendChild(c.process(e.message,{isNonChat:!0})),this._buttonNo.setText(e.buttonNoLabel||l("ui.common.no")),this.cb=e.cb,this.cb&&"function"==typeof this.cb||(console.error(new Error("missing cb")),this.cb=function(){}),this.keepDialog=t.keepDialog,this._buttonNo.toggleDisplay(!e.noDisable),this._buttonIgnore.toggleDisplay(!!t.ignoreEnable),e.timer){var n=e.timer;this._buttonYes.setText(l("ui.common.ok")+" ("+n+")"),this._buttonYes.disable();var o=setInterval(function(){n--,n<=0?(i._buttonYes.setText(l("ui.common.ok")),i._buttonYes.enable(),clearInterval(o)):i._buttonYes.setText(l("ui.common.ok")+" ("+n+")")},1e3)}else this._buttonYes.enable()}},function(e,t){},function(e,t,i){function n(){function e(){t.logScroller.refresh(),t.logScroller.goToBottom()}a.call(this,{className:"adminConsoleWindow",title:T,positionInfo:{left:"c",top:"c",width:800,height:500}}),f(this,{minWidth:480,minHeight:300});var t=this;this.history=[],this.historyPointer=0,this.autoScroll=!0,this.domCreated=!1,this._adminCmdManager=new w,this.once("open",function(){t._createDom(),t._addClientCommands()}),this.on("open",function(){t.setTitle(t.getAdminTitle())}),this.on("focus",function(){window.setTimeout(function(){t.cmdInput.focus()},100)}),this.on("close",function(){d.hide()}),this.on("opened",function(){t.cmdInput.focus()}),this.on("resize",e),this.on("repositioned",e),window.gui.on("ConsoleCommandsListMessage",function(e){t.helpInfo=e}),window.gui.on("ConsoleMessage",function(e){return t.log?void t.logMessage(e.content,E[e.type]):console.warn(e.content)}),window.gui.on("DebugInClientMessage",function(e){t.log&&t.logMessage(e.message,x[e.level]),e.level>=L?console.warn(e.message):console.log(e.message)}),I.on("step",function(e){e=e||{};var i=e.percent;t._preloadPB.setValue(i),t._preloadCount.setText(e.count+"/"+e.nbTotalMaps),t._preloadPercent.setText(~~(100*i)+"%"),t._preloadEstimate.setText(e.secondLeft<0?0:e.secondLeft+"s")}),I.on("error",function(e){t.cmdInput.enable(),t._buttonSend.enable(),t._preloadBox.hide(),console.error(e)}),I.on("end",function(e){t.cmdInput.enable(),t._buttonSend.enable(),t._preloadBox.hide(),t.logMessage("Finished preloading of in "+e.elapsedSecond+"s")}),this.optionButton=new r({className:"optionButton",scaleOnPress:!0},function(){var e=[];e.push({caption:"25%",cb:function(){t.setOpacity(.25)}}),e.push({caption:"50%",cb:function(){t.setOpacity(.5)}}),e.push({caption:"75%",cb:function(){t.setOpacity(.75)}}),e.push({caption:"100%",cb:function(){t.setOpacity(1)}}),window.gui.openContextualMenu("generic",{title:"Opacity",actions:e})}),this.optionButton.insertBefore(this.closeButton);var i=y.getValue(C);i&&t.setOpacity(i),this._createDom()}i(910);var o=i(642),s=i(191).inherits,a=i(233),r=i(246),l=i(582),c=i(605),u=i(29).getText,d=i(482),h=i(873),p=i(483),m=i(676),f=i(705),g=i(252),_=i(235),v=i(229).events,y=i(195),b=i(911),w=(i(282),i(912)),M=300,T="Admin Console",C="adminOpacity",I=new b,A="incarnam",S=45,E=["Info","Warn","Error"],x=["Debug","Debug","Info","Warn","Error","Fatal"],L=3;s(n,a),e.exports=n,n.prototype._addClientCommands=function(){},n.prototype._createDom=function(){if(!this.domCreated){var e=this,t=this.windowBody,i=t.createChild("div",{className:"topDom"}),n=i.createChild("div",{className:"upDownContainer"}),o=n.appendChild(new r({text:"Next cmd",className:["greenButton","upAndDown"]}));o.on("tap",function(){e.nextCmd()});var s=n.appendChild(new r({text:"Reset",className:["greenButton","upAndDown"]}));s.on("tap",function(){e._reset()});var a=n.appendChild(new r({text:"Previous cmd",className:["greenButton","upAndDown"]}));a.on("tap",function(){e.previousCmd()}),this.autoScrollCheckbox=n.appendChild(new m("autoscroll",(!0))),this.autoScrollCheckbox.addClassNames("upAndDown"),this.autoScrollCheckbox.on("change",function(t){e.autoScroll=t});var d=i.createChild("form",{attr:{action:"#_",method:"post"}}),h=d.createChild("table",{className:"cmdInputBar"}),f=h.createChild("td"),g=this.cmdInput=new l({className:"cmdInput",attr:{id:"cmdInput"}});f.appendChild(g),f=h.createChild("td",{className:"buttonSend"});var _=this._buttonSend=f.appendChild(new r({text:u("ui.social.reportSend"),className:["greenButton"]})),v=this._preloadBox=t.createChild("div",{className:"preloadBox",hidden:!0});this._preloadPB=v.appendChild(new c({className:["preloadPB","green"]})),this._preloadCount=v.createChild("div",{className:"preloadCount"}),this._preloadPercent=v.createChild("div",{className:"preloadPercent"}),this._preloadEstimate=v.createChild("div",{className:"preloadEstimate"}),this.logScroller=t.appendChild(new p({className:"logBox"})),this.log=this.logScroller.content,_.on("tap",function(){var t=g.getValue();g.setValue(""),e.runMultipleCommands(t)}),g.rootElement.addEventListener("keydown",function(t){if(t){var i=t.keyCode;40===i?(t.preventDefault(),e.nextCmd()):38===i&&(t.preventDefault(),e.previousCmd())}}),d.rootElement.addEventListener("submit",function(e){e.preventDefault(),_.emit("tap")}),this.domCreated=!0}},n.prototype.addToHistory=function(e){return this.history[this.history.length-1]!==e&&e?(this.history.push(e),void(this.historyPointer=this.history.length)):void(this.historyPointer=this.history.length)},n.prototype.previousCmd=function(){if(!(this.historyPointer<1)){this.historyPointer-=1;var e=this.history[this.historyPointer];this.cmdInput.setValue(e)}},n.prototype.nextCmd=function(){if(!(this.historyPointer>this.history.length-1)){this.historyPointer+=1;var e=this.history[this.historyPointer]||"";this.cmdInput.setValue(e)}},n.prototype.setOpacity=function(e){this.windowBorder.setStyle("opacity",e),y.setValue(C,e)},n.prototype._handleEvent=function(e){e=e.replace("event:","");var t=e.split(","),i=t[0];switch(i){case"player":var n={playerName:t[1],playerId:t[2]};window.gui.openContextualMenu(i,n);break;case"admin":var o="true"===t[1],s=window.atob(t[2]);o?this.runCommand(s):this.cmdInput.setValue(s);break;case"guild":window.dofus.sendMessage("GuildFactsRequestMessage",{guildId:t[1]})}},n.prototype._formatLinks=function(e){function t(e,t){var n=t.match(/^event:/);e.addEventListener("click",function(e){e.preventDefault()}),e.addEventListener(v.end,function(e){n?i._handleEvent(t):g.openUrlInAppBrowser(t),e.preventDefault()})}var i=this,n=new _("div");n.setHtml(e);for(var o,s,a=n.rootElement.getElementsByTagName("a"),r=0;r<a.length;r++)o=a[r],s=o.href,t(o,s);return n},n.prototype.logMessage=function(e,t){if(this._createDom(),this.log.getChildCount()>M){var i=this.log.getChildren();Array.isArray(i)&&i[0]&&i[0].destroy()}var n="message"+(t||"Info"),o=this.log.createChild("div",{className:["message",n]});e=e.replace(/\n/g,"<br/>"),e=this._formatLinks(e),o.appendChild(e),this.logScroller.refresh(),this.autoScroll&&this.logScroller.goToBottom()},n.prototype.runMultipleCommands=function(e){e=e.trim();for(var t=e.split(";"),i=0;i<t.length;i+=1){var n=t[i];this.runCommand(n)}},n.prototype.runCommand=function(e){e=e.trim();var t=!1;if(this.logMessage(e,"Command"),"help"===e||"/help"===e||""===e)return this.logMessage("\n"+this.helpInfo.descriptions.join(""),"Debug"),this.logMessage("<hr/>Client admin commands:","Debug"),void this.logMessage("\n"+this._adminCmdManager.helpList().join("\n"),"Debug");this.addToHistory(e);var i=e.split(" ");if(t=this._adminCmdManager.runCommand.apply(this._adminCmdManager,i),!t&&window.gui.playerData.isAdmin()){var n;if("preload"===i[0]){i.shift(),this.cmdInput.disable(),this._buttonSend.disable(),this._preloadBox.show(),this._preloadPB.setValue(0);var s=i[0];return s=s===A?S:parseInt(s,10),I.preloadAreas([s])}if("joris"===i[0])return i.shift(),n=h.adminCommand(i),this.logMessage(n,"Debug");if("tutorial"===i[0])return i.shift(),n=window.gui.tutorialManager.adminCommand(i),this.logMessage(n,"Debug");if("autotest"===i[0]&&o.run)return i.shift(),o.run(i.join(" "));if("gridcolor"===i[0])return i.shift(),4!==i.length?this.logMessage("4 arguments required: gridcolor [red] [green] [blue] [alpha]","Debug"):i[0]>1?this.logMessage("Red   component has to be in range [0, 1]","Debug"):i[1]>1?this.logMessage("Green component has to be in range [0, 1]","Debug"):i[2]>1?this.logMessage("Blue  component has to be in range [0, 1]","Debug"):i[3]>1?this.logMessage("Alpha has to be in range [0, 1]","Debug"):(window.isoEngine.background.setGridColor(i),this.logMessage("Grid color changed!","Debug"));if("haapi"===i[0])return this.logMessage(window.Config.haapi.url,"Debug");if("setanimation"===i[0]){i.shift();var a=this,r={animationString:i[0],direction:i[1]};return void window.actorManager.userActor.testAnimation(r,function(e){a.logMessage(e,"Debug")})}}if(!t&&window.gui.playerData.isModeratorOrMore()&&"setadminmenu"===i[0]){var l=!1,c=i[1];return l=!c||"help"===c||!window.gui.playerData.adminMenu.setAdminMenuId(c),void(l&&(this.logMessage("setadminmenu &lt;menuId&gt;: menuId must be one of the following:","Debug"),this.logMessage(window.gui.playerData.adminMenu.helpToString(),"Debug")))}t||window.dofus.sendMessage("AdminCommandMessage",{content:e})},n.prototype.runQuietCommand=function(e){window.dofus.sendMessage("AdminQuietCommandMessage",{content:e})},n.prototype._reset=function(){this.log.clearContent(),this.logScroller.refresh()},n.prototype.getAdminTitle=function(){var e=[],t=window.gui.serversData,i=window.gui.playerData.characterBaseInformations,n=t.getMyServerName();return n&&e.push(n+" ("+t.connectedServerId+")"),i.id&&i.name&&e.push(i.name+" ("+i.id+")"),0===e.length&&e.push(T),e.join(", ")}},function(e,t){},function(e,t,i){function n(){d.call(this),this._reset()}function o(e,t){if(!e)return null;var i=Date.now(),n=(i-t)/1e3,o=n/e;return~~(o-n)}function s(e,t){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}function a(e,t){var i=g+e+".json";p.loadJson(i,function(i){if(i===m.EMPTY_JSON)return t("emptyMapJson");var n=[_+e+".jpg"];i.foreground&&n.push(v+e+".png");for(var o=i.midgroundLayer,a=Object.keys(o),r=0;r<a.length;r++)for(var l=a[r],c=o[l],u=0;u<c.length;u++){var d=c[u],h=d.g;if(h){var g=d.jpg?"jpg":"png",y=g+"/"+h+"."+g;n.push(f+y)}}p.preloadAssets(n,!1,null,function(e){return s(null,e)?t("emptyMapImage"):t(null,e)})})}function r(e,t){for(var i=0;i<e.length;i++)t.hasOwnProperty(e[i])||(t[e[i]]=!0)}function l(e,t){return e.length?void h.getAllDataMap("SubAreas",function(i,n){if(i)return t(i);var o={};for(var s in n)if(n.hasOwnProperty(s)){var a=n[s],l=a.mapIds||[];if(e.indexOf(a.areaId)===-1)continue;r(l,o)}return t(null,o)}):this._onError("noArea:"+e)}var c=i(31),u=i(191).inherits,d=i(209).EventEmitter,h=i(30),p=i(202),m=i(184),f=m.IMG_PATH,g=m.MAP_PATH,_=m.BACKGROUND_PATH,v=m.FOREGROUND_PATH,y="MapPreloaderInterrupt";u(n,d),e.exports=n,n.prototype._reset=function(){this._isStopped=!1,this._shouldStop=!1,this._remainingMaps={},this._lastCount=0},n.prototype._onError=function(e){this._isStopped=!0,this.emit("error",e)},n.prototype._onEnd=function(e){this._isStopped=!0,this.emit("end",e)},n.prototype._onStop=function(){this._isStopped=!0,this.emit("stop")},n.prototype._onStep=function(e){this.emit("step",e)},n.prototype._preload=function(e,t){var i=this,n=Object.keys(e),s=n.length;if(!s)return i._onEnd({elapsedSecond:0});var r=0,l=Date.now();return c.forEachSeries(n,function(n,u){return i._shouldStop?c.setImmediate(function(){return u(y)}):a(n,function(a){if(a)return u(a);delete e[n],r++;var c=r/s,d=o(c,l),h=r+t,p=s+t,m=h/p,f=Math.round(100*m)/100;return i._onStep({count:h,nbTotalMaps:p,percent:f,secondLeft:d}),u()})},function(t){return i._remainingMaps=e,i._lastCount+=r,t?t===y?i._shouldStop?i._onStop():i._restart():i._onError(t):i._onEnd({elapsedSecond:~~((Date.now()-l)/1e3)})})},n.prototype.preloadAreas=function(e){var t=this;this._reset(),this._isStopped=!1,l(e,function(e,i){return e?t._onError(e):void t._preload(i,0)})},n.prototype.stop=function(){this._shouldStop=!0,this._isStopped&&this._onStop()},n.prototype.restart=function(){this._shouldStop=!1,this._isStopped&&this._restart()},n.prototype._restart=function(){this._isStopped=!1,this._preload(this._remainingMaps,this._lastCount)}},function(e,t){function i(){this._cmdMap={}}e.exports=i,i.prototype.addCommand=function(e,t,i){this._cmdMap["/"+e]={fn:t,description:i}},i.prototype.runCommand=function(){var e=Array.prototype.slice.call(arguments),t=e[0];e.shift();var i=this._cmdMap[t];if(!i)return!1;var n=i.fn;return n.apply(null,e),!0},i.prototype.helpList=function(){var e=[];for(var t in this._cmdMap)if(this._cmdMap.hasOwnProperty(t)){var i=this._cmdMap[t];e.push("<b>"+t+"</b>: "+i.description)}return e}},function(e,t,i){function n(){s.call(this,{className:"ArenaWindow",title:l("ui.common.koliseum"),positionInfo:{left:"c",top:"c",width:500,height:500}}),this.mustReload=!0,this.on("open",function(){this.statusTitle||(this.createContent(),this.setupListeners()),this.mustReload&&this.reloadPartyData()})}i(914);var o=i(191).inherits,s=i(233),a=i(246).DofusButton,r=i(735),l=i(29).getText,c=i(794),u=i(915);o(n,s),e.exports=n,n.prototype.createContent=function(){this.messageContainerSetup(),this.tableSetup(),this.informationSetup(),this.buttonsSetup()},n.prototype.messageContainerSetup=function(){var e=this.windowBody.createChild("div",{className:"wrapper",name:"status"});this.statusTitle=e.createChild("div",{className:"title"}),this.statusText=e.createChild("div",{className:"text"})},n.prototype.tableSetup=function(){this.table=this.windowBody.appendChild(new r({colIds:["icon","name","status"],headerContent:["",l("ui.common.team")],minRows:3,defaultRowContent:["",l("ui.common.randomCharacter")]}))},n.prototype.informationSetup=function(){var e=this.windowBody.createChild("div",{className:"wrapper",name:"informations"});e.createChild("div",{className:"title",text:l("ui.common.myInformations")}),e.createChild("div",{className:"text",name:"currentRating"}),e.createChild("div",{className:"text",name:"dailyRating"}),e.createChild("div",{className:"text",name:"maxRating"}),e.createChild("div",{className:"text",name:"fightsWon"})},n.prototype.registerInArena=function(){window.dofus.sendMessage("GameRolePlayArenaRegisterMessage",{battleMode:u.ARENA_TYPE_3VS3})},n.prototype.buttonsSetup=function(){var e=this,t=this.windowBody.createChild("div",{className:"buttons"});this.unregisterBtn=t.appendChild(new a(l("ui.teamSearch.unregistration"))),this.registerBtn=t.appendChild(new a(l("ui.teamSearch.registration"))),this.leaveArenaBtn=t.appendChild(new a(l("ui.party.arenaQuit"))),this.registerBtn.on("tap",function(){e.registerInArena()}),this.unregisterBtn.on("tap",function(){window.dofus.sendMessage("GameRolePlayArenaUnregisterMessage")}),this.leaveArenaBtn.on("tap",function(){window.dofus.sendMessage("PartyLeaveRequestMessage",{partyId:e.partyId})})},n.prototype.setLeaderRow=function(e,t){e.getChild("icon").toggleClassName("leaderIcon",t)},n.prototype.addMemberRow=function(e,t){var i=this.table.addRow({name:e},{id:t});return t===this.leaderId&&this.setLeaderRow(i,!0),this.memberCount++,i},n.prototype.addThisPlayerRow=function(){var e=window.gui.playerData,t=e.characterBaseInformations.name;return this.addMemberRow(t,e.id)},n.prototype.findMemberRow=function(e){if(!e)return-1;for(var t=this.table.getRows(),i=0;i<t.length;i++)if(t[i].id===e)return i;return-1},n.prototype.removeMemberRow=function(e){var t=this.findMemberRow(e);return t===-1?console.warn("Cannot remove unknown arena member #"+e):(this.table.delRow(t),void this.memberCount--)},n.prototype.enableOrDisableLeaveArenaButton=function(){this.partyId?this.leaveArenaBtn.enable():this.leaveArenaBtn.disable()},n.prototype.enableOrDisableRegisterButton=function(){this.isLeader||!this.leaderId?(this.registerBtn.enable(),this.unregisterBtn.enable()):(this.registerBtn.disable(),this.unregisterBtn.disable())},n.prototype.showOrHideRegisterButton=function(e){e.arenaRegistered?(this.registerBtn.hide(),this.unregisterBtn.show()):(this.registerBtn.show(),this.unregisterBtn.hide())},n.prototype.setNewLeader=function(e){var t=this.findMemberRow(this.leaderId);t>=0&&this.setLeaderRow(this.table.getRow(t),!1),t=this.findMemberRow(e),t>=0&&this.setLeaderRow(this.table.getRow(t),!0),this.leaderId=e,this.isLeader=e===window.gui.playerData.id,this.enableOrDisableRegisterButton()},n.prototype.updateArenaStats=function(e){var t=e.arenaStats,i=this.windowBody.getChild("informations");i.getChild("currentRating").setText(l("ui.party.arenaRank",t.rank)),i.getChild("dailyRating").setText(l("ui.party.arenaRankMaxToday",t.bestDailyRank)),i.getChild("maxRating").setText(l("ui.party.arenaRankMax",t.bestRank)),i.getChild("fightsWon").setText(l("ui.party.arenaFightsOfTheDay",t.victoryCount,t.arenaFightCount))},n.prototype.reloadPartyData=function(){this.mustReload=!1;var e=window.gui.playerData.partyData;this.updateArenaStats(e),this._updatePartyData(e),this.updateRegistrationStatus(e)},n.prototype._updatePartyData=function(e){this.memberCount=0,this.table.clearContent();var t=e.getArenaParty();if(!t)return this.setNewLeader(null),this.partyId=null,void this.addThisPlayerRow();this.setNewLeader(t.getLeaderId()),this.partyId=t.getPartyId(),this.isLeader&&this.addThisPlayerRow();var i=t.getMembers();for(var n in i)this.addMemberRow(i[n].name,~~n);this.isLeader||this.addThisPlayerRow()};var d=["ui.party.arenaInfoSearch","ui.party.arenaInfoWaiting","ui.party.arenaInfoFighting","ui.party.arenaInfoInvite"],h=l;n.prototype.getStepText=function(e,t){return h(d[e],t)},n.prototype.updateRegistrationStatus=function(e){var t=e.arenaStep;switch(this.statusTitle.setText(l("ui.common.step",(t+1)%4+1,4)),this.statusText.setText(this.getStepText(t,0)),this.showOrHideRegisterButton(e),t){case c.ARENA_STEP_REGISTRED:this.enableOrDisableLeaveArenaButton();break;case c.ARENA_STEP_WAITING_FIGHT:case c.ARENA_STEP_STARTING_FIGHT:this.leaveArenaBtn.disable(),this.registerBtn.disable();break;case c.ARENA_STEP_UNREGISTER:this.enableOrDisableLeaveArenaButton(),this.enableOrDisableRegisterButton();break;default:console.error("Unknown arena step #"+t)}},n.prototype.onFightEnd=function(){if(this.enableOrDisableLeaveArenaButton(),this.isLeader){this.registerBtn.enable();var e=this;window.gui.openConfirmPopup({title:l("ui.common.confirm"),message:l("ui.party.arenaPopupReinscription"),cb:function(t){t&&e.registerInArena()}})}},n.prototype.setupListeners=function(){var e=this,t=window.gui.playerData.partyData;window.gui.on("disconnect",function(){e.mustReload=!0}),t.on("arenaRegistrationStatus",function(){e.updateRegistrationStatus(t)}),t.on("arenaFightEnd",function(){e.onFightEnd()}),t.on("arenaStatsUpdated",function(){e.updateArenaStats(t)}),t.on("arenaJoined",function(){e._updatePartyData(t)}),t.on("arenaNewMember",function(t){return e.findMemberRow(t.id)>=0?console.error("Dupe arena member #"+t.name):void e.addMemberRow(t.name,t.id)}),t.on("arenaMemberLeaving",function(t){e.removeMemberRow(t)}),t.on("playerLeftParty",function(t){t===e.partyId&&e.reloadPartyData()}),t.on("arenaLeaderUpdate",function(t){e.setNewLeader(t)}),t.on("arenaFighterReady",function(t){e.statusText.setText(e.getStepText(1,t))})}},function(e,t){},function(e,t){e.exports={ARENA_TYPE_3VS3:3,ARENA_TYPE_5VS5:5}},function(e,t,i){function n(){p.call(this,{title:s("ui.charcrea.more"),className:"BreedDetailWindow",positionInfo:{left:"c",top:"c",width:912,height:"90%",maxHeight:683,isModal:!0,isFullScreen:!0}}),this.loadedSpells={},this.favSpells=[],this.on("open",this._initialize)}function o(){h.showNotification(s("tablet.common.longTapForTooltip"),this)}i(917);var s=i(29).getText,a=i(191).inherits,r=i(483),l=i(252).showProgressively,c=i(840),u=i(459),d=i(838),h=i(248),p=i(233),m=i(207).logger,f=[[],[4706,7,3],[4716,4720,4752],[60,58,50],[72,80,67],[88,81,95],[105,101,109],[126,130,140],[142,159,153],[179,168,174],[191,190,186],[434,446,431],[686,705,696],[2778,2806,2810],[2890,2897,2872],[3212,3211,3218]],g={spellTooltipAll:!0},_={visibilityOptions:{spellTooltipName:!0,spellTooltipDescription:!0}};a(n,p),e.exports=n,n.prototype.freeContent=function(){this.windowBody.clearContent(),this.loadedSpells={},this.favSpells=[]},n.prototype._initialize=function(e){this.breedData=e.breedData,this._createContent(this.windowBody),this._updateBreedDescription(),this._updateSpells()},n.prototype._createContent=function(e){var t=this.scroller=e.appendChild(new r({},{showHintArrows:!0})),i=t.content;this.breedDescription=i.createChild("div",{className:"breedDescription",hidden:!0});var n=this.breedDescription.createChild("div",{className:"descriptionZone"}),o=n.createChild("div",{className:"descriptionText"});this.breedName=o.createChild("div",{className:"breedName",text:"."}),this.breedName.setText(""),this.breedStory=o.createChild("div",{className:"breedStory"});var a=this.favoriteSpells=i.createChild("div",{className:"favSpells",hidden:!0});a.createChild("div",{className:"title",text:s("tablet.charCrea.popularSpells")});for(var l=f[this.breedData.id]||[],c=0;c<l.length;c++){var u=this.favSpells[c]=a.createChild("div",{className:"spell",hidden:!0});u.spellId=l[c]}var d=this.allSpells=i.createChild("div",{className:"spells",hidden:!0});d.createChild("div",{className:"title",text:s("tablet.charCrea.allSpells")}),this.spellsContainer=d.createChild("div",{className:"spellsContainer"})},n.prototype._appearWhenReady=function(){l(this.breedDescription),l(this.favoriteSpells),l(this.allSpells),this.scroller.refresh(),this.scroller.notify()},n.prototype._updateBreedDescription=function(){var e=this.breedData;this.breedName.setText(e.longNameId),this.breedStory.setText(e.descriptionId)},n.prototype._updateSpells=function(){this.windowBody.addClassNames("spinner");var e=this.breedId,t=this.breedData.breedSpellsId,i=this;this._loadSpellsData(t,function(n){return n?console.error(n):void(i.openState&&i.breedId===e&&i._updateSpellSlots(t))})},n.prototype._loadSpellsData=function(e,t){for(var i=[],n=this.loadedSpells,o=0;o<e.length;o+=1)n[e[o]]||i.push(e[o]);return i.length?void u.createSpells(i,function(e,i){if(e)return t(e);i=u.sortSpells(i,"minPlayerLevel");for(var o=0;o<i.length;o+=1){var s=i[o];n[s.id]=s}t()}):t()},n.prototype._updateSpellSlots=function(e){for(var t,i=0;i<e.length;i+=1){var n=this.spellsContainer.appendChild(new d);t=this.loadedSpells[e[i]],n.setSpell(t,g),n.toggleDisplay(Boolean(t)),n.on("tap",o)}this.windowBody.delClassNames("spinner");for(var s=0;s<this.favSpells.length;s+=1){var a=this.favSpells[s];t=this.loadedSpells[a.spellId],t?(a.slot=a.appendChild(new d),a.slot.setSpell(t,g),a.slot.on("tap",o),a.appendChild(new c({spell:t},_)),a.show()):m.error(new Error("Cannot find spell id "+a.spellId+" for breed id "+this.breedData.id))}this._appearWhenReady()}},function(e,t){},function(e,t,i){function n(){T.call(this,{className:"BreedingWindow",positionInfo:{left:"0",bottom:"0",width:"100%",height:"100%"},noTitle:!0}),this.mountDataFromCertifId={},this.babyMap={},this._reset(),this._setupEvents()}function o(){var e=this.room.breedingWindow;e._setFilterBoxVisible(!1),e._selectTile(this.room,this)}i(919);var s=i(246),a=i(676),r=i(920),l=i(383),c=i(922),u=i(924),d=i(598),h=i(29).getText,p=i(191).inherits,m=i(596),f=i(925),g=i(927),_=i(931),v=i(503),y=i(932),b=i(586),w=i(934),M=i(936),T=i(233),C=i(225),I=i(235),A=r.DRAG_ID,S="c",E=150,x=1,L=200,N="paddock",O=m.EFFECT_INVALID_CERTIF,D=996,R=997,P=998,B={id:!0,name:!0,model:!0},k=2,F=!0,z=6e5;p(n,T),e.exports=n,n.prototype._reset=function(){this.isWindowSizeFull=!1,this.isMultiselect=!1,this.selectionRoom=null,this.focusedTile=null,this.openedRoom=null,this.dropZones={},this.certificateQueue=[],this.certificateTilePendingSelection=null,this.nonLoadedCertifCount=0,this.waitingGaugeGoal=0,this.certifAreRequested=!1,this.numMassRemove=0,this.numMassAdd=0,this.filters=new _,this.isFilterEmpty=!0,this.isWaitingForInventory=!1,this.isAscending=!0,this._purgeNewbornList()},n.prototype.freeContent=function(){this.windowBody.clearContent(),this.equipBox=null,this.focusedMountDetails=null,this.rooms=null,this.roomBoxes=null,this.roomTabs=null,this.displayedRooms=null,this.roomDropZones=null,this.mountFilterBox=null,this.filterButtonBar=null,this.allNoneCheckbox=null,this.waitingGauge=null},n.prototype._resetDom=function(){for(var e in this.rooms)this.rooms[e].reset();this._hideMountDetails(),this.equipBox.updateMount(null),this._setFilterBoxVisible(!1),this.mountFilterBox?this.mountFilterBox.resetFilters():console.error("_resetDom: mountFilterBox was "+this.mountFilterBox),window.clearTimeout(this.debugCheckTimeout),this.allNoneCheckbox.toggleActivation(!1,!0),this.waitingGauge.hideGauge(),f.freeContent()},n.prototype._createDom=function(){this._createRooms();var e=this.windowBody.createChild("div",{className:"leftCol"});this._setupMountDetails(e),this._setupEquipBox(e),this._hideMountDetails();var t=this.windowBody.createChild("div",{className:"rightCol"});this._setupFilterMenuBox(t),this.rooms.paddock.capacity=this.paddockCapacity,this._setupRoomBoxes(t),this.waitingGauge=this.windowBody.appendChild(new M),this._setupMountFilterBox(t),this._setupDropZones()},n.prototype._setupEvents=function(){function e(e){if(t.waitingGauge.hideGauge(),e===u.MOUNT_PADDOCK_ERROR){var i=h("ui.exchange.cantExchangeMountPaddockError");window.gui.openSimplePopup(i)}}var t=this,i=window.gui,n=window.dofus.connectionManager,o=i.playerData,s=o.inventory;i.on("disconnect",function(){t.mountDataFromCertifId={}}),this.on("close",function(){this._resetDom(),this._reset(),i.uiLocker.unlockFeature("mount","breedingOpened")}),this.on("opened",function(){this.isWindowSizeFull=!0}),n.on("ExchangeStartOkMountMessage",function(e){t._initDisplay(e)}),o.on("setMount",this.localizeEvent(function(){t._updateEquipBox(),
t.waitingGauge.hideGauge()})),o.on("unsetMount",this.localizeEvent(function(){t.numMassRemove&&t.numMassRemove--,t._updateEquipBox()})),i.on("ExchangeMountStableBornAddMessage",function(e){var i=e.mountDescription;t.babyMap[i.id]=Date.now(),t.equipBox&&t._addMountsToRoom(t.rooms.shed,i)}),i.on("ExchangeMountStableAddMessage",this.localizeEvent(function(e){t._addMountsToRoom(t.rooms.shed,e.mountDescription)})),i.on("ExchangeMountStableRemoveMessage",this.localizeEvent(function(e){t._removeMountsFromRoom(t.rooms.shed,e.mountId)})),i.on("ExchangeMountPaddockAddMessage",this.localizeEvent(function(e){t._addMountsToRoom(t.rooms.paddock,e.mountDescription)})),i.on("ExchangeMountPaddockRemoveMessage",this.localizeEvent(function(e){t._removeMountsFromRoom(t.rooms.paddock,e.mountId)})),i.on("PaddockPropertiesMessage",this._updatePaddockProperties.bind(this)),s.on("listUpdate",function(e){t.isWaitingForInventory&&t._loadCertificatesAfterInventoryLoads(e)}),s.on("itemAdded",this.localizeEvent(function(e){t._addCertificates([e])})),s.on("itemsAdded",this.localizeEvent(function(e){t._addCertificates(e)})),s.on("itemDeleted",this.localizeEvent(function(e,i){t._removeCertificates([i])})),s.on("itemsDeleted",this.localizeEvent(function(e,i){t._removeCertificates(i)})),n.on("MountDataMessage",this.localizeEvent(function(e){t._receiveMountData(e.mountData)})),n.on("MountRenamedMessage",this.localizeEvent(function(e){var i=t._findTileInRooms(e.mountId);i.mountData.name=e.name,t._refreshTile(i)})),n.on("MountSterilizedMessage",this.localizeEvent(function(e){var i=t._findTileInRooms(e.mountId);i.mountData.reproductionCount=-1,t._refreshTile(i)})),i.on("ExchangeMountStableErrorMessage",function(){e(u.MOUNT_PADDOCK_ERROR)}),n.on("ExchangeErrorMessage",this.localizeEvent(function(t){e(t.errorType)})),l.on("dragStart",this.localizeEvent(function(e,i,n){i===A&&t._startDragging(e,n)})),l.on("dragEnd",this.localizeEvent(function(e,i){i===A&&t._endDragging(e)}))},n.prototype._initDisplay=function(e){window.gui.uiLocker.lockFeature("mount","breedingOpened",h("tablet.mount.uiLocker.breeding")),C.openDialog(this.id),this.equipBox?this._resetDom():this._createDom(),this._updateEquipBox(!0),this.roomBoxes.hide(),this._addMountsToRoom(this.rooms.shed,e.stabledMountsDescription),this._addMountsToRoom(this.rooms.paddock,e.paddockedMountsDescription),this._loadCertificatesFromInventory(),this.roomBoxes.show(),this.roomTabs.openTab(N,null,{forceOpen:!0})},n.prototype._loadCertificatesFromInventory=function(){var e=window.gui.playerData.inventory;return e.isLoaded?this._addCertificates(Object.keys(e.objects)):(this.waitingGauge.showGauge(1),void(this.isWaitingForInventory=!0))},n.prototype._loadCertificatesAfterInventoryLoads=function(e){this.isWaitingForInventory=!1,this._addCertificates(Object.keys(e)),this.waitingGauge.hideGauge()},n.prototype._createRooms=function(){var e=[{id:"paddock",name:h("ui.common.mountPark")},{id:"shed",name:h("ui.mount.barn"),capacity:E},{id:"certificate",name:h("ui.mount.certificates")},{id:"equip",name:h("ui.common.equip"),capacity:x,hidden:!0}];this.rooms={},this.displayedRooms={};for(var t=0;t<e.length;t+=1){var i=e[t],n=i.id,o=this.rooms[n]=new y(this,n,i.name,i.capacity);i.hidden||(this.displayedRooms[n]=o)}this.numTabs=Object.keys(this.displayedRooms).length},n.prototype._updatePaddockProperties=function(e){this.paddockCapacity=e.properties.maxOutdoorMount,this.openState&&this._updateRoomTab(this.rooms.paddock)},n.prototype._setupMountDetails=function(e){var t=e.createChild("div",{className:"mountDetailsBox"}),i=this.focusedMountDetails=t.appendChild(new m),n=i.getIllustrationElement();i.placeholder=new v(t),i.dragInfo=new r(this,n)},n.prototype._setupEquipBox=function(e){this.equipBox=new c(e,this.rooms.equip,o)},n.prototype._selectTab=function(e){this.openedRoom=this.rooms[e],this._updateDisplayedRoom();var t=this.isMultiselect&&this.openedRoom===this.selectionRoom;this.allNoneCheckbox.toggleActivation(t,!0)},n.prototype._setupRoomBoxes=function(e){var t=this.roomBoxes=e.createChild("div",{className:"roomBoxes"}),i=t.createChild("div",{className:"roomBoxWrapper"}),n=i.createChild("div",{className:"tileSpace"});this.roomPlaceholder=new v(n);var o=this.roomTabs=t.appendChild(new w({className:"roomTabs"})),s=i.rootElement.clientHeight/this.numTabs,a=0;o.on("openTab",this._selectTab.bind(this));for(var r in this.rooms)if(this.displayedRooms[r]){var l=this.rooms[r],c=l.createBox(n);o.addTab(l.name,c,r);var u=o.getTabsMap()[r].tab;u.setStyles({width:s+"px",top:a+"px"}),a+=s,u.title=u.createChild("div",{className:"title",text:l.name}),u.statusLabel=u.createChild("div",{className:"statusLabel"}),this._updateRoomTab(l)}},n.prototype._setupFilterMenuBox=function(e){var t=e.createChild("div",{className:"filterMenuBox"}),i=t.createChild("div",{className:"filterMenu"});this._createFilterButton(i),this._createSortSelector(i),this._createSelectAndFilterInfo(i),this._createSelectAllOrNone(i),this.filterButtonBar=t.createChild("div",{className:"filterButtonBar"})},n.prototype._createFilterButton=function(e){var t=this;this.filterBtn=e.appendChild(new s({text:h("tablet.mount.filter"),className:["button","filterButton"],addIcon:"before"},function(){t._setFilterBoxVisible(!t.isFilterBoxVisible)}))},n.prototype._createSortSelector=function(e){var t=e.appendChild(new b({className:"sortSelector"}));this.sorters=[{name:h("ui.common.sort")+h("ui.common.colon"),property:"id"},{name:h("tablet.mount.type"),property:"model"},{name:h("ui.common.sex"),property:"sex"},{name:h("ui.common.name"),property:"name"},{name:h("ui.common.level"),property:"level"},{name:h("tablet.mount.expiration"),property:"expiration"}];for(var i=0;i<this.sorters.length;i+=1){var n=this.sorters[i];t.addOption(n.name,n.property),t.toggleOption(i,!0)}t.on("change",this._changeSorter.bind(this)),this.selectedSorter=t.selectFirst(!0)},n.prototype._createSelectAndFilterInfo=function(e){this.selectAndFilterInfo=e.createChild("div",{className:"selectAndFilterInfo"})},n.prototype._createSelectAllOrNone=function(e){var t=this,i=h("ui.common.all")+" / "+h("ui.common.none"),n=this.allNoneCheckbox=e.appendChild(new a(i));n.addClassNames("allNoneCheckbox"),n.on("change",function(e){t._setMultiselect(e,!0)})},n.prototype._setupDropZones=function(){function e(e,t,i){n._droppedMount(this,e,i)}function t(){n._handleDragEnter(this.id,!0)}function i(){n._handleDragEnter(this.id,!1)}var n=this,o=[];for(var s in this.rooms){o.push(s);var a=this.roomTabs.getTabsMap()[s];if(a){var r=this.roomTabs.getTabsMap()[s].tab;l.setDroppable(r,[A]),r.id=s,r.on("drop",e),r.on("dragEnter",t),r.on("dragLeave",i)}}this.roomDropZones=this.roomBoxes.createChild("div",{className:"roomDropZones"});for(var c=0;c<o.length;c+=1){s=o[c];var u=this.dropZones[s]=new I("div",{className:["dropZone",s,"transition"]});u.id=s;var d=this.rooms[s];"equip"===s?(this.equipBox.box.appendChild(u),u.addClassNames("equip")):(this.roomDropZones.appendChild(u),u.addClassNames("room")),u.createChild("div",{className:"amount",name:"amount"}),u.createChild("div",{className:"label",text:d.name,name:"label"}),l.setDroppable(u,[A]),u.on("drop",e),u.on("dragEnter",t),u.on("dragLeave",i)}},n.prototype._setupMountFilterBox=function(e){if(!this.isWindowSizeFull)return this.debugCheckTimeout=window.setTimeout(function(e){e.mountFilterBox||console.error("Absence of MountFilterBox after 2 seconds")},2e3,this),this.once("opened",this._setupMountFilterBox.bind(this,e));this.mountFilterBox=e.appendChild(new g(this.filters)),this.mountFilterBox.setButtonBar(this.filterButtonBar);var t=this;this.mountFilterBox.on("activeFiltersUpdated",function(){t.isFilterEmpty=t.filters.isEmpty(),t._setMultiselect(!1),t._updateDisplayedRoom(),t.filterBtn.toggleClassName("hasFilter",!t.isFilterEmpty)})},n.prototype._receiveMountData=function(e){var t,i=e.id;if(!this.certificateQueue.length)return(t=this._findTileInRooms(i))?(t.mountData=this._prepareMountForRoom(e,t.room),this._refreshTile(t),void(t===this.focusedTile&&this._displayMountDetails(e))):console.error("Received data about unknown mount ",e);var n=this.certificateQueue.shift(),o=S+n.objectUID;if(this.mountDataFromCertifId[o]=this._prepareMountForRoom(e,this.rooms.certificate),e.isNewborn&&(this.babyMap[o]=this.babyMap[i]),t=this.rooms.certificate.getTile(o),t.mountData.receivedData=e,this._refreshTile(t),t.setSpinnerVisible(!1),this.certificateTilePendingSelection===t&&(this.certificateTilePendingSelection=null,this._selectTile(this.rooms.certificate,t)),this.nonLoadedCertifCount--,this.certifAreRequested&&this.waitingGauge.refreshGauge(this.nonLoadedCertifCount),!F){var s=this.certificateQueue[0];if(s)return this._requestMountData(s)}0===this.nonLoadedCertifCount&&this.certifAreRequested&&(this.certifAreRequested=!1,"certificate"===this.openedRoom.id&&this._updateDisplayedRoom())},n.prototype._requestOneCertificate=function(e){this.certificateQueue.indexOf(e)>=0||(this.certificateQueue.push(e),!F&&this.certificateQueue.length>1||this._requestMountData(e))},n.prototype._requestAllCertificates=function(){this.certifAreRequested=!0,this.waitingGauge.showGauge(this.nonLoadedCertifCount,h("tablet.mount.loadingCertif",this.nonLoadedCertifCount));var e=this.rooms.certificate.mountMap;for(var t in e)this.mountDataFromCertifId[t]||this._requestOneCertificate(e[t].certificate)},n.prototype.tileTapHandler=function(e){return this._setFilterBoxVisible(!1),e.mountData.certificate&&!e.mountData.receivedData?(e.setSpinnerVisible(!0),this.certificateTilePendingSelection=e,this._requestOneCertificate(e.mountData.certificate)):(e.selected&&!this.isMultiselect&&this._setMultiselect(!0),void this._selectTile(e.room,e))},n.prototype._purgeNewbornList=function(){var e=Date.now();for(var t in this.babyMap)e-this.babyMap[t]>z&&delete this.babyMap[t]},n.prototype._prepareMountForRoom=function(e,t){return e.mountLocation=t.id,e.isNewborn=!!(this.babyMap[e.id]||e.receivedData&&this.babyMap[e.receivedData.id]),e.expiration=e.certificate&&e.certificate.mountInfo&&e.certificate.mountInfo.date,e.receivedData&&e.expiration&&(e.receivedData.expiration=e.expiration),e},n.prototype._addMountsToRoom=function(e,t){t=Array.isArray(t)?t:[t];for(var i=t.length,n=0;n<i;n++)e.addMount(this._prepareMountForRoom(t[n],e));this.numMassAdd&&(this.numMassAdd-=i,this.waitingGauge.refreshGauge(this.numMassAdd+this.numMassRemove)),0===this.numMassAdd&&(this._updateRoomTab(e),e===this.openedRoom&&this._updateDisplayedRoom())},n.prototype._removeMountsFromRoom=function(e,t){t=Array.isArray(t)?t:[t];var i=t.length,n=this.focusedTile&&this.focusedTile.id;t.indexOf(n)!==-1&&(this._hideMountDetails(),this.focusedTile=null);for(var o=0;o<t.length;o+=1)e.removeMount(t[o]);this.numMassRemove&&(this.numMassRemove-=i,this.waitingGauge.refreshGauge(this.numMassAdd+this.numMassRemove)),0===this.numMassRemove&&(e===this.selectionRoom&&0===e.getNumSelected()&&this._setMultiselect(!1),this._updateRoomTab(e),e===this.openedRoom&&this._updateDisplayedRoom())},n.prototype._addCertificates=function(e){for(var t=this._extractCertificates(e),i=[],n=0;n<t.length;n++){var o=t[n],s=o.mountInfo,a=S+o.objectUID,r=this.mountDataFromCertifId[a];r||this.nonLoadedCertifCount++,i.push({id:a,certificate:o,model:s.modelId,name:s.name,receivedData:r})}this._addMountsToRoom(this.rooms.certificate,i)},n.prototype._removeCertificates=function(e){for(var t=[],i=0;i<e.length;i+=1){var n=S+e[i].objectUID,o=this.mountDataFromCertifId[n];o?delete this.mountDataFromCertifId[n]:this.nonLoadedCertifCount--,t.push(n)}this._removeMountsFromRoom(this.rooms.certificate,t)},n.prototype._extractCertificates=function(e){for(var t=window.gui.playerData.inventory,i=[],n=0;n<e.length;n+=1){var o=e[n],s=o.objectUID?o:t.objects[o],a=m.getMountInfoFromCertificate(s);a&&(s.effectsMap[O]||(this._enrichCertificateData(s,a),i.push(s)))}return i},n.prototype._enrichCertificateData=function(e,t){var i={mountId:t.mountId,date:t.date,modelId:t.modelId},n=e.effectsMap,o=n[R];o&&(i.name=o.text);var s=n[P];s&&(i.validityDays=s.days,i.validityHours=s.hours,i.validityMinutes=s.minutes,i.validityDesc=s.description);var a=n[D];a&&(i.ownerDesc=a.description),e.mountInfo=i},n.prototype._requestMountData=function(e){var t=e.mountInfo;window.dofus.sendMessage("MountInformationRequestMessage",{id:t.mountId,time:t.date})},n.prototype._updateRoomTab=function(e){var t=this.roomTabs.getTabsMap()[e.id];if(t){var i=t.tab.statusLabel,n='(<span class="highlight">'+e.numMounts;n+=void 0!==e.capacity&&e.capacity!==Number.POSITIVE_INFINITY?"</span> / "+e.capacity+")":"</span>)",i.setHtml(n)}},n.prototype._showRoomPlaceholderIfNeeded=function(){var e=this.openedRoom,t=e.getNumHiddenMounts(),i=e.numMounts,n=null;0===i?n=h("tablet.mount.emptyRoom"):i===t&&(n=h("tablet.mount.filteredMounts",i)),e.toggleDisplay(!n),this.roomPlaceholder.setText(n)},n.prototype._updateRoomStats=function(){var e=this.openedRoom,t=e.getNumHiddenMounts(),i=e.numMounts,n="";this.isFilterEmpty||(n=h("tablet.mount.filter")+h("ui.common.colon")+(i-t)+" / "+i+"\n");var o="";if(this.selectionRoom){var s=this.selectionRoom.getNumSelected();s>0&&(o=h("tablet.common.selection")+h("ui.common.colon")+s)}this.selectAndFilterInfo.setText(n+o)},n.prototype._updateDisplayedRoom=function(){var e=this.openedRoom;e&&("certificate"===e.id&&!this.isFilterEmpty&&this._initLoadAllCertificates()||(e.refreshDisplay(this.filters,this.selectedSorter,this.isAscending),this._showRoomPlaceholderIfNeeded(),this._updateRoomStats()))},n.prototype._refreshTile=function(e){e.refreshDisplay(),e.room===this.openedRoom&&this._updateDisplayedRoom()},n.prototype._clearSelection=function(){var e=this.focusedTile;e&&(e.room.setMountSelected(e.id,!1),this.focusedTile=null),this.selectionRoom&&(this.selectionRoom.unselectAll(),this.selectionRoom=null),this._updateRoomStats()},n.prototype._setMultiselect=function(e,t){this.allNoneCheckbox.toggleActivation(e,!0),this.isMultiselect=e,this._clearSelection(),this._hideMountDetails(),e&&(this.selectionRoom=this.openedRoom,t&&(this.openedRoom.selectAll(),this._updateRoomStats()))},n.prototype._selectTile=function(e,t){var i=this.focusedTile;if(this.isMultiselect&&t.room!==this.selectionRoom&&this._setMultiselect(!1),this.isMultiselect){if(e.setMountSelected(t.id,!t.selected),0===e.getNumSelected())return this._setMultiselect(!1)}else{if(t===i)return;i&&i.room.setMountSelected(i.id,!1),e.setHightlightedMount(t.id)}this.focusedTile=t,this._displayMountDetails(t.mountData),this._updateRoomStats()},n.prototype._updateEquipBox=function(e){var t=window.gui.playerData.equippedMount;if(t&&this._prepareMountForRoom(t,this.rooms.equip),this.equipBox.updateMount(t),!e){var i=this.focusedTile===this.equipBox.tile;t?i?this._displayMountDetails(t):this._selectTile(this.rooms.equip,this.equipBox.tile):i&&this._hideMountDetails()}},n.prototype._hideMountDetails=function(){var e=this.focusedMountDetails;e.hide(),e.placeholder.toggleDisplay(!0);var t=h(this.isMultiselect?"tablet.mount.pendingMultiselect":"tablet.mount.selectMount");e.placeholder.setText(t)},n.prototype._displayMountDetails=function(e){if(e.certificate&&(e=e.receivedData,!e))return this._hideMountDetails();var t=this.focusedMountDetails;t.show(),t.placeholder.toggleDisplay(!1),t.dragInfo.setMount(e),t.setMount(e,{context:"breeding"})},n.prototype._requestExchangeBetweenRooms=function(e,t,i){var n=d[e][t];n&&window.dofus.sendMessage("ExchangeHandleMountStableMessage",{actionType:n,rideId:i})},n.prototype._getIdForExchange=function(e,t){return"certificate"!==e?t:~~t.substr(1)},n.prototype._moveMounts=function(e,t,i,n){void 0===n&&(n=i.length);var o=k*n;for(this.waitingGauge.showGauge(o,h("tablet.mount.moving",n),k),this.numMassRemove=this.numMassAdd=n;n>0;n--){var s=this._getIdForExchange(e,i.pop());this._requestExchangeBetweenRooms(e,t,s)}},n.prototype.prepareDraggedTiles=function(e){var t=this.rooms[e.mountLocation],i=t.getTile(e.id);return i.selected||this._selectTile(t,i),t.getNumSelected()},n.prototype._startDragging=function(e,t){var i=this;this.roomDropZones.addClassNames("enable"),e.addClassNames("dragging");var n=t.mount,o=this.rooms[n.mountLocation],s=o.getNumSelected();this.dragTimeout=setTimeout(function(){for(var e in i.dropZones){var t=i.dropZones[e];if(t.isEnabled=e!==o.id&&("equip"!==t.id||s<=1),t.toggleClassName("enable",t.isEnabled),t.isEnabled){var n=i.rooms[e],a=n.capacity-n.numMounts,r="";s>a&&(r=a>0?h("tablet.mount.roomLeft",a):h("tablet.mount.roomFullShort")),t.toggleClassName("warning",!!r&&a>0),t.toggleClassName("full",!!r&&a<=0),t.getChild("amount").setText(r)}}},L)},n.prototype._endDragging=function(e){clearTimeout(this.dragTimeout),e.delClassNames("dragging");for(var t in this.dropZones){var i=this.dropZones[t];i.delClassNames("enable","dragEnter");var n=this.roomTabs.getTabsMap()[t];if(n){var o=n.tab;o.delClassNames("dragEnter")}}if(this.roomDropZones.delClassNames("enable"),l.isLostDrop&&this.focusedTile){var s=this.focusedTile.mountData;s.certificate&&!s.receivedData&&this._clearSelection()}},n.prototype._handleDragEnter=function(e,t){var i=this.dropZones[e];i.toggleClassName("dragEnter",t);var n=this.roomTabs.getTabsMap()[e];if(n){var o=n.tab;o.toggleClassName("dragEnter",t&&i.isEnabled)}},n.prototype._droppedMount=function(e,t,i){var n=i.mount,o=n.mountLocation,s=e.id;if(o!==s){var a=this.rooms[o],r=this.rooms[s],l="equip"!==s?r.capacity-r.numMounts:r.capacity,c="equip"!==s?a.getSelection():[n.id],u=c.length;if(l<=0)window.gui.openSimplePopup(h("tablet.mount.roomFull"));else if(l<u){var d=this;window.gui.openConfirmPopup({title:h("ui.popup.warning"),message:h("tablet.mount.partialMoveMounts",l),cb:function(e){e&&d._moveMounts(o,s,c,l)}})}else this._moveMounts(o,s,c)}},n.prototype._findTileInRooms=function(e){for(var t in this.rooms){var i=this.rooms[t].getTile(e);if(i)return i}return null},n.prototype._initLoadAllCertificates=function(){return 0!==this.nonLoadedCertifCount&&(this.rooms.certificate.lockRoom(),this.roomPlaceholder.setText(" "),this._requestAllCertificates(),!0)},n.prototype._changeSorter=function(e){this.isAscending=this.selectedSorter!==e||!this.isAscending,this.selectedSorter=e,"certificate"===this.openedRoom.id&&!B[e]&&this._initLoadAllCertificates()||this._updateDisplayedRoom()},n.prototype._setFilterBoxVisible=function(e){this.isFilterBoxVisible=e,this.filterBtn.toggleClassName("enabled",e),this.mountFilterBox&&this.mountFilterBox.toggleClassName("enable",e)}},function(e,t){},function(e,t,i){function n(e){var t=Math.min(e-1,l),i=new a("div",{className:"emptyFrame"});i.setStyles({left:t*c+"px",top:t*u+"px"});for(var n=i,o=t-1;o>=0;o--)n=n.createChild("div",{className:"emptyFrame"});return n.createChild("div",{className:"number",text:e}),i}function o(e,t){this.sourceData={mount:null},this.styles={},this.onDragClassName="draggedMount",this.wElement=t,this.imgElement=t,this.breedingWindow=e;var i={dragInsteadOfScroll:!0,containerWidth:d,containerHeight:h};s.setDraggable(t,this,r,this.sourceData,i)}i(921);var s=i(383),a=i(235),r="mountRoom",l=7,c=-4,u=4,d=138,h=118;e.exports=o,o.DRAG_ID=r,o.prototype.setMount=function(e,t){this.sourceData.mount=e,this.imgElement=t||this.imgElement},o.prototype.setStyle=function(e,t){this.styles[e]=t},o.prototype.prepareForDrag=function(e,t){this.setStyle("backgroundImage",this.imgElement.getStyle("backgroundImage"));var i=this.breedingWindow.prepareDraggedTiles(this.sourceData.mount);if(i>1){t.addClassNames("multiselect");var o=n(i);t.insertAsFirstChild(o),this.wElement.once("dragEnd",function(){t.removeChild(o),t.delClassNames("multiselect")})}return!0}},function(e,t){},function(e,t,i){function n(e,t,i){this.mountData=null,this.box=e.createChild("div",{className:"equipBox"}),this._createTile(t,i),this.placeholder=new r(this.box),this.placeholder.setText(a("tablet.mount.noEquipped"))}i(923);var o=i(202),s=i(920),a=i(29).getText,r=i(503),l=i(228);e.exports=n,n.prototype._createTile=function(e,t){var i=this.tile=this.box.createChild("div",{className:["mount","neutralTile"]});e.getTile=function(e){return i.id===e?i:null},i.createChild("div",{className:"title",text:a("tablet.mount.equipped")}),this.mountImg=i.createChild("div",{className:"mountImg"});var n=i.createChild("div",{className:"nameAndLevel"});this.mountName=n.createChild("div",{className:"mountName"}),this.mountLevel=n.createChild("div",{className:"level"}),l(i),i.on("tap",t),i.setTileSelected=this._setTileSelected.bind(this),i.refreshDisplay=this._refreshTile.bind(this),i.highlightTile=function(){},i.id=null,i.mountData=null,i.selected=!1,i.room=e,i.equipBox=this,this.dragInfo=new s(e.breedingWindow,i)},n.prototype.updateMount=function(e){var t=this.mountData,i=!!e;return this.tile.toggleDisplay(i),this.placeholder.toggleDisplay(!i),e?(this.mountData=e,this._refreshTile(),this.dragInfo.setMount(e,this.mountImg)):(this.mountData=null,this.tile.addClassNames("neutralTile"),this.tile.delClassNames("focusedTile")),t},n.prototype._setTileSelected=function(e){e=void 0===e||e,this.tile.toggleClassName("focusedTile",e),this.tile.toggleClassName("neutralTile",!e),this.tile.selected=e},n.prototype._refreshTile=function(){var e=this.mountData;this.tile.mountData=e,this.tile.id=e.id,this.mountName.setText(e.name||a("ui.common.noName")),this.mountLevel.setText(a("ui.common.short.level")+" "+e.level);var t=this;o.preloadImage("gfx/mounts/"+e.model+".png",function(e){t.mountImg&&t.mountImg.rootElement&&t.mountImg.setStyle("backgroundImage",e)})}},function(e,t){},function(e,t){e.exports={REQUEST_IMPOSSIBLE:1,REQUEST_CHARACTER_OCCUPIED:2,REQUEST_CHARACTER_JOB_NOT_EQUIPED:3,REQUEST_CHARACTER_TOOL_TOO_FAR:4,REQUEST_CHARACTER_OVERLOADED:5,REQUEST_CHARACTER_NOT_SUSCRIBER:6,REQUEST_CHARACTER_RESTRICTED:7,BUY_ERROR:8,SELL_ERROR:9,MOUNT_PADDOCK_ERROR:10,BID_SEARCH_ERROR:11,REQUEST_RESTRICTED_AREA:12}},function(e,t,i){function n(e,t){var i=e.id;v.call(this,"div",{className:"mountBox",name:i,hidden:!0}),"certificate"===t.id&&this.addClassNames("certificate");var n=this;this._hasBeenDestroyed=!1,this.on("destroy",function(){n._hasBeenDestroyed=!0}),this.id=i,this.room=t,this.mountData=e,this.selected=!1,this.renderingForeground=null,this.detailLevel=M}function o(){var e=this.mountBox;e.room.breedingWindow.tileTapHandler(e)}function s(){return o.call(this.foreground)}function a(){var e=this.foreground.mountBox.mountData.certificate.mountInfo,t=e.ownerDesc+"\n"+e.validityDesc;_.showNotification(t,this)}function r(e){var t="certificate"===e.id,i=t?["fg","certificate"]:"fg",n=new v("div",{className:i,hidden:!0});if(n.mountBox=null,g(n,{doubletapTimeout:1}),n.on("tap",o),n.dragInfo=new c(e.breedingWindow,n),n._mountName=n.createChild("div",{className:"mountName"}),n._mountImg=n.createChild("div",{className:"mountImg"}),t){n._certifValidity=n.createChild("div",{className:"certifValidity"});var r=n.createChild("div",{className:"certifImg"});g(r,{doubletapTimeout:1}),r.foreground=n,r.on("tap",s),r.on("longtap",a)}else{n._level=n.createChild("div",{className:"level"}),n._fertileIcon=n.appendChild(new f("fertile"));var l=n.gaugeDiv=n.createChild("div",{className:["gaugeDiv","partial"]}),d=l.createChild("div",{className:"iconGaugeBar"});n._staminaGauge=d.appendChild(new u("stamina",null,{size:y,withoutLabel:!0})),n._maturityGauge=d.appendChild(new u("maturity",null,{size:y,withoutLabel:!0})),n._loveGauge=d.appendChild(new u("love",null,{size:y,withoutLabel:!0})),n._serenityGauge=l.appendChild(new m({isMini:!0})),n._serenityGauge.resize()}return n}i(926);var l=i(202),c=i(920),u=i(599),d=i(29).getText,h=i(191).inherits,p=i(596),m=i(607),f=i(609),g=i(228),_=i(248),v=i(235),y=27,b=4,w=2,M=0,T=1,C=2,I={};I.shed=[],I.paddock=[],I.certificate=[];var A={};h(n,v),e.exports=n,n.freeContent=function(){I.shed=[],I.paddock=[],I.certificate=[]},n.prototype.setSpinnerVisible=function(e){this.renderingForeground&&this.renderingForeground.toggleClassName("spinner",!!e)},n.prepareTilePool=function(e,t){for(var i=I[e.id],n=t-i.length,o=0;o<n;o++){var s=e.box.appendChild(r(e));i.push(s)}},n.prototype._createTile=function(){var e=this.room,t=I[e.id],i=t.pop();i||(i=e.box.appendChild(r(e))),i.mountBox=this,this.renderingForeground=i},n.prototype._moveTile=function(e){var t=this.renderingForeground;if(t.index!==e){var i=this.room,n=i.numColumns,o=Math.floor(e/n)*i.rowHeight,s=e%n*i.columnWidth;t.index=e,t.setStyle("webkitTransform","translate3d("+s+"px, "+o+"px, 0)")}},n.prototype._releaseTileContent=function(){var e=I[this.room.id];e.push(this.renderingForeground),this.renderingForeground=null,this.detailLevel=M},n.prototype._updateTileContent=function(e){var t=this.renderingForeground;if(t){this.detailLevel=e;var i=this.mountData;if(t._mountName.setText(i.name||d("ui.common.noName")),t._mountName.toggleClassName("noName",!i.name),i.certificate){var n=i.receivedData;t._mountName.toggleClassName("sexUnknown",!n),t._mountName.toggleClassName("female",!!n&&n.sex);var o=i.certificate.mountInfo;this._setValidity(t._certifValidity,o.validityDays,o.validityHours,o.validityMinutes)}else{t._mountName.toggleClassName("female",!!i.sex),t._level.setText(d("ui.common.short.level")+" "+i.level);var s=p.getFertilityState(i);t._fertileIcon.setFertileIcon(s),e===C?(t._staminaGauge.setValue(i.stamina,i.staminaMax),t._maturityGauge.setValue(i.maturity,i.maturityForAdult),t._loveGauge.setValue(i.love,i.loveMax),t._serenityGauge.setValue(i.serenity),t.gaugeDiv.delClassNames("partial")):t.gaugeDiv.addClassNames("partial")}t.dragInfo.setMount(i,t._mountImg),this._retrieveMountImgUrl(t._mountImg,i.model),t.show()}},n.prototype._retrieveMountImgUrl=function(e,t){if(t!==e.currentModel){e.currentModel=t;var i=this,n=A[t];return n?e.setStyle("backgroundImage",n):void l.preloadImage("gfx/mounts/"+t+".png",function(n){A[t]=n,e.currentModel===t&&(i._hasBeenDestroyed||e.setStyle("backgroundImage",n))})}},n.prototype._setValidity=function(e,t,i,n){var o=d("tablet.common.validity")+d("ui.common.colon");o+=t>0?t+" "+d("ui.time.days",t):i>0?i+" "+d("ui.time.hours",i):n+" "+d("ui.time.minutes",n),e.toggleClassName("expiringSoon",t<b&&t>=w),e.toggleClassName("expiringVerySoon",t<w),e.setText(o)},n.prototype.refreshDisplay=function(){this._updateTileContent(C)},n.prototype.setTileSelected=function(e){this.selected=e,this.toggleClassName("selected",e),this.delClassNames("focusedTile")},n.prototype.highlightTile=function(){this.selected=!0,this.addClassNames("focusedTile")},n.prototype.prepareToShow=function(e,t){if(this.renderingForeground&&this.renderingForeground.index<0&&this._moveTile(e),1===t){if(this.detailLevel>=T)return!1;this._createTile(),this._moveTile(e),this._updateTileContent(T)}else if(2===t){if(this.detailLevel===C)return!1;this._updateTileContent(C)}return!0},n.prototype.prepareToGoOffScreen=function(){this.renderingForeground&&this._releaseTileContent()},n.prototype.showTile=function(){this.show()},n.prototype.hideTile=function(){this.hide(),this.renderingForeground&&(this.renderingForeground.hide(),this._releaseTileContent())},n.hidePoolTiles=function(e){for(var t=I[e.id],i=t.length-1;i>=0;i--)t[i].hide()},n.prototype.markForReorder=function(){this.renderingForeground&&(this.renderingForeground.index=-1)}},function(e,t){},function(e,t,i){function n(e){M.call(this,"div",{className:"MountFilterBox"}),this.isReady=!1,this.buttonBar=null,this.filterButtons=[],this.batchUpdateLevel=0,this.mountFilters=e,e.isReady?this._createDom():e.once("mountFiltersReady",this._createDom.bind(this))}function o(e,t){e.createChild("div",{className:"barTitle",text:t.toUpperCase()})}function s(){var e=this.mountFilterBox,t=!e.serenityFlagMap[this.zoneName];e.serenityFlagMap[this.zoneName]=t,e.numSerenityZonesOn+=t?1:-1,e._updateSerenityFilter()}function a(e){var t=e&&e.id,i=e&&e.caption;this.mountFilterBox._setColorButtonValue(this,t,i),this.mountFilterBox._updateFilter()}function r(e,t){t?(this.selectState(E),window.gui.openContextualMenuAround("generic",this,{actions:this.menuActions})):a.call(this,null)}function l(e){var t=e&&e.id,i=e&&e.caption;if(t!==this.abilityId){var n=this.filterName,o=this.mountFilterBox;this.abilityId&&(o._delFilterButton(n),o.mountFilters.removeFilter(n)),this.abilityId=t,t?(o.mountFilters.addBehaviorFilter(n,t,!0),o._addFilterButton(n,i),this.setLabel(i),this.selectState(x)):(this.setLabel(this.emptyLabel),this.selectState(E)),o._updateFilter()}}function c(e,t){t?(this.selectState(E),window.gui.openContextualMenuAround("generic",this,{actions:this.menuActions})):l.call(this,null)}function u(){this.mountFilterBox[this.filterName].reset()}i(928);var d,h=i(246),p=i(489),m=i(506),f=i(29).getText,g=i(191).inherits,_=i(277),v=i(580),y=i(607),b=i(228),w=i(929),M=i(235),T=[["maleBtn","femaleBtn"],["newbornBtn","rideableBtn"],["fertileBtn","sterilizedBtn"],["pregnantBtn","fertileBtn"],["pregnantBtn","sterilizedBtn"]],C={maleBtn:{filterId:"sex",isReversed:!0,label:"ui.common.animalMale",addIcon:!0},femaleBtn:{filterId:"sex",label:"ui.common.animalFemale",addIcon:!0},newbornBtn:{filterId:"baby",isReversible:!0,label:"tablet.mount.filterNewborn"},pregnantBtn:{filterId:"pregnant",isReversible:!0,label:"tablet.mount.filterPregnant"},fertileBtn:{filterId:"fruitful",isReversible:!0,label:"tablet.mount.filterFertile"},sterilizedBtn:{filterId:"sterilized",isReversible:!0,label:"tablet.mount.filterSterilized"},rideableBtn:{filterId:"mountable",isReversible:!0,label:"tablet.mount.filterMountable"},loveBtn:{filterId:"love",isReversible:!0,label:"ui.common.love",addIcon:!0},staminaBtn:{filterId:"stamina",isReversible:!0,label:"ui.common.stamina",addIcon:!0},maturityBtn:{filterId:"maturity",isReversible:!0,label:"ui.common.maturity",addIcon:!0},energyBtn:{filterId:"energy",isReversible:!0,label:"ui.common.energy",addIcon:!0}},I=[["tired0Btn","tiredInf50Btn"],["tired0Btn","tiredSup50Btn"],["tired0Btn","tiredInf100Btn"],["tired0Btn","tired100Btn"],["tiredInf50Btn","tiredSup50Btn"],["tiredInf50Btn","tiredInf100Btn"],["tiredInf50Btn","tired100Btn"],["tiredSup50Btn","tired100Btn"],["tiredInf100Btn","tired100Btn"]],A={tired0Btn:{label:"= 0%",equal:0},tiredInf50Btn:{label:"< 50%",max:49.99},tiredSup50Btn:{label:">= 50%",min:50},tiredInf100Btn:{label:"< 100%",max:99.99},tired100Btn:{label:"= 100%",min:100}},S=-1,E=0,x=1,L=2,N=[{value:null},{value:!0,className:"active"},{value:!1,className:"reversed"}],O=[{value:null},{value:!1,className:"active"}];g(n,M),e.exports=n,n.prototype.getFilters=function(){return this.mountFilters},n.prototype.setButtonBar=function(e){this.buttonBar=e},n.prototype.resetFilters=function(){this.isReady&&this._resetFilters(!0)},n.prototype._resetFilters=function(e){this._enterBatchUpdate(),this._clearSearchBox();for(var t in C)this[t].reset();for(t in A)this[t].reset();this._resetSerenityFilter(),this.colorA.reset(),this.colorB.reset(),this.abilityA.reset(),this.abilityB.reset(),this.minFatigue=0,this.maxFatigue=100,this._leaveBatchUpdate(e)},n.prototype._enterBatchUpdate=function(){this.batchUpdateLevel++},n.prototype._leaveBatchUpdate=function(e){this.batchUpdateLevel--,0!==this.batchUpdateLevel||e||this._updateFilter()},n.prototype._updateFilter=function(){this.batchUpdateLevel>0||(this._updateButtonBar(),this.emit("activeFiltersUpdated",this.mountFilters))},n.prototype._createDom=function(){d=f("tablet.mount.pureColor"),this._setupNameBar(),this._setupToggles(),this._setupSerenityBar(),this._setupFatigueBar(),this._setupColorBar(),this._setupAbilityBar(),this.appendChild(new h({text:f("ui.common.reset"),className:["button","resetButton"]},this._resetFilters.bind(this,!1))),this._resetFilters(!0),this.isReady=!0},n.prototype._setupNameBar=function(){var e=this.createChild("div",{className:"nameBar"}),t=this.searchBox=e.appendChild(new v({isLiveSearch:!0,maxLength:_.MAX_RIDE_NAME_LEN}));t.setPlaceholder(f("ui.common.name")),t.on("search",this._searchBoxChanged.bind(this)),t.reset=this._clearSearchBox.bind(this)},n.prototype._searchBoxChanged=function(e){this._delFilterButton("searchBox"),e?(this.mountFilters.setFilter("name",e.toLowerCase()),
this._addFilterButton("searchBox",'"'+e+'"')):this.mountFilters.removeFilter("name"),this._updateFilter()},n.prototype._clearSearchBox=function(){this.searchBox.setValue(""),this._searchBoxChanged("")},n.prototype._deactivateOppositeToggles=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(!(n.indexOf(e)<0))for(var o=0;o<n.length;o++)n[o]!==e&&this[n[o]].reset()}},n.prototype._toggleBtnHandler=function(e,t,i){this._enterBatchUpdate();var n=C[e],o=n.filterId;switch(i){case E:this._delFilterButton(e),this.mountFilters.removeFilter(o);break;case x:this._deactivateOppositeToggles(e,T),this._addFilterButton(e,f(n.label)),this.mountFilters.setFilter(o,t);break;case L:this._delFilterButton(e),this._addFilterButton(e,f(n.label),"reversed"),this.mountFilters.setFilter(o,t);break;default:console.error("invalid valueIndex: "+i)}this._leaveBatchUpdate()},n.prototype._newToggleButton=function(e,t,i){var n,o=C[t],s=f(o.label),a=o.addIcon;o.isReversible?n=N:o.isReversed&&(n=O),this[t]=e.appendChild(new w(t,i,{text:s,addIcon:a,states:n}))},n.prototype._setupToggles=function(){var e=this._toggleBtnHandler.bind(this),t=this.createChild("div",{className:"sexBar"});this._newToggleButton(t,"maleBtn",e),this._newToggleButton(t,"femaleBtn",e),t=this.createChild("div",{className:"sexBar"}),this._newToggleButton(t,"newbornBtn",e),this._newToggleButton(t,"rideableBtn",e),t=this.createChild("div",{className:"fertileBar"}),this._newToggleButton(t,"pregnantBtn",e),this._newToggleButton(t,"fertileBtn",e),this._newToggleButton(t,"sterilizedBtn",e);var i=this.createChild("div",{className:"hasOrNeedsBar"});t=i.createChild("div",{className:"hasOrNeedsDiv"}),this._newToggleButton(t,"staminaBtn",e),this._newToggleButton(t,"loveBtn",e),t=i.createChild("div",{className:"hasOrNeedsDiv"}),this._newToggleButton(t,"maturityBtn",e),this._newToggleButton(t,"energyBtn",e)},n.prototype._updateSerenityFilter=function(){for(var e in this.serenityFlagMap)this.serenity[e].toggleClassName("active",this.serenityFlagMap[e]);this.serenity.toggleClassName("allOff",0===this.numSerenityZonesOn);var t=y.SERENITY_MIN,i=y.SERENITY_MAX,n=this.numSerenityZonesOn,o=this.serenityFlagMap.stamina,s=this.serenityFlagMap.love,a=this.serenityFlagMap.maturity;0===n||3===n||2===n&&!a?this.mountFilters.removeFilter("serenity"):(1===n&&o?i=0:(1===n&&a||2===n&&!s)&&(i=y.GOOD_SERENITY_MAX),1===n&&s?t=0:(1===n&&a||2===n&&!o)&&(t=y.GOOD_SERENITY_MIN),this.mountFilters.setFilter("serenity",[t,i])),this._delFilterButton("serenity"),n&&this._addFilterButton("serenity",f("ui.common.serenity")),this._updateFilter()},n.prototype._resetSerenityFilter=function(){this.serenityFlagMap={stamina:!1,maturity:!1,love:!1},this.numSerenityZonesOn=0,this._updateSerenityFilter()},n.prototype._addSerenityButton=function(e){var t=new M("div",{className:e});return b(t),t.on("tap",s),t.mountFilterBox=this,t.zoneName=e,this.serenity[e]=t,t},n.prototype._setupSerenityBar=function(){var e=this.createChild("div",{className:"serenityBar"});this.serenity=e,e.reset=this._resetSerenityFilter.bind(this),e.createChild("div",{className:["bigIcon","bigIcon_mad"]});var t=e.createChild("div",{className:"bigButton"});e.createChild("div",{className:["bigIcon","bigIcon_happy"]}),t.appendChild(this._addSerenityButton("stamina")),t.appendChild(this._addSerenityButton("maturity")),t.appendChild(this._addSerenityButton("love")),t.createChild("div",{className:"bigButtonShape"})},n.prototype._setColorButtonValue=function(e,t,i){var n=e.filterName,o=this.mountFilters;if(e.colorId&&(this._delFilterButton(n),o.removeFilter(n)),e.colorId=t,t){var s=null;t!==S?(s=o.getSingleColorMap()[t].colors[0],o.addColorFilter(n,t)):(i=d,o.addPureColorFilter(n)),this._addFilterButton(n,i),e.colorTile.setStyle("backgroundColor",s),e.setLabel(i),e.setIcon(t!==S?e.colorTile:null),e.selectState(x);var a=e===this.colorB?this.colorA:this.colorB;t===a.colorId&&o.isRealColor(t)&&this._setColorButtonValue(a,S,d)}else e.setLabel(e.emptyLabel),e.setIcon(null),e.selectState(E)},n.prototype._newColorList=function(e,t,i){var n=f("tablet.common.color")+" "+i,o=e.appendChild(new w(t,r,{text:n}));o.addClassNames(t),o.colorTile=new M("div",{className:"colorTile"}),o.emptyLabel=n,o.mountFilterBox=this,o.filterName=t;var s=this.mountFilters.getSingleColorMap(),l=a.bind(o),c=o.menuActions=[];for(var u in s)c.push({id:~~u,caption:s[u].singleColorName,cb:l});return p.sortMenuActions(c),c.unshift({id:S,caption:"("+d+")",cb:l}),o},n.prototype._setupColorBar=function(){var e=this.createChild("div",{className:"colorBar"}),t=e.createChild("div",{className:"colorDiv"});this.colorA=this._newColorList(t,"colorA",1),this.colorB=this._newColorList(t,"colorB",2)},n.prototype._newAbilityList=function(e,t,i){var n=f("ui.common.capacity",1)+" "+i,o=e.appendChild(new w(t,c,{text:n}));o.addClassNames(t),o.emptyLabel=n,o.mountFilterBox=this,o.filterName=t;var s=window.gui.databases.MountBehaviors,a=l.bind(o),r=o.menuActions=[];for(var u in s)r.push({id:~~u,caption:s[u].nameId,cb:a});return p.sortMenuActions(r),o},n.prototype._setupAbilityBar=function(){var e=this.createChild("div",{className:"abilityBar"}),t=e.createChild("div",{className:"abilityDiv"});this.abilityA=this._newAbilityList(t,"abilityA",1),this.abilityB=this._newAbilityList(t,"abilityB",2)},n.prototype._fatigueBtnHandler=function(e,t){this._enterBatchUpdate(),t&&this._deactivateOppositeToggles(e,I);var i=A[e];t?(this._addFilterButton(e,i.label),void 0!==i.equal&&(this.minFatigue=this.maxFatigue=i.equal),void 0!==i.min&&(this.minFatigue=i.min),void 0!==i.max&&(this.maxFatigue=i.max)):(this._delFilterButton(e),void 0===i.min&&void 0===i.equal||(this.minFatigue=0),void 0===i.max&&void 0===i.equal||(this.maxFatigue=100)),0!==this.minFatigue||100!==this.maxFatigue?this.mountFilters.setFilter("fatigue",[this.minFatigue,this.maxFatigue]):this.mountFilters.removeFilter("fatigue"),this._leaveBatchUpdate()},n.prototype._setupFatigueBar=function(){var e=this._fatigueBtnHandler.bind(this),t=this.createChild("div",{className:"fatigueBar"});o(t,f("ui.common.tire"));var i=t.createChild("div",{className:"fatigueDiv"});this.tired0Btn=i.appendChild(new w("tired0Btn",e,{text:"0%"})),this.tiredInf50Btn=i.appendChild(new w("tiredInf50Btn",e,{text:"< 50%"})),this.tiredSup50Btn=i.appendChild(new w("tiredSup50Btn",e,{text:">= 50%"})),this.tiredInf100Btn=i.appendChild(new w("tiredInf100Btn",e,{text:"< 100%"})),this.tired100Btn=i.appendChild(new w("tired100Btn",e,{text:"100%"}))},n.prototype._addFilterButton=function(e,t,i){var n=new m(t,u,e);i&&n.addClassNames(i),n.mountFilterBox=this,this.filterButtons.push(n)},n.prototype._delFilterButton=function(e){for(var t=0;t<this.filterButtons.length;t++){var i=this.filterButtons[t];if(i.filterName===e)return void this.filterButtons.splice(t,1)}},n.prototype._updateButtonBar=function(){if(this.buttonBar){for(var e=new M("div"),t=0;t<this.filterButtons.length;t++){var i=this.filterButtons[t];e.appendChild(i)}this.buttonBar.clearContent(),this.buttonBar.appendChild(e)}}},function(e,t){},function(e,t,i){function n(e,t,i){a.call(this,"div"),this.name=e,this.tapHandler=t,this.states=i.states||r,this._createDom(i),this._setValueByIndex(0),s(this),this.on("tap",this._changeToNextValue)}i(930);var o=i(191).inherits,s=i(228),a=i(235),r=[{value:!1},{value:!0,className:"active"}];o(n,a),e.exports=n,n.prototype._createDom=function(e){e.addIcon&&(this.icon=this.createChild("div",{className:"btnIcon"})),e.text&&(this.labelElement=this.createChild("div",{className:"label",text:e.text}))},n.prototype._changeToNextValue=function(){var e=(this.valueIndex+1)%this.states.length;this._setValueByIndex(e),this._notifyOfUpdate()},n.prototype._notifyOfUpdate=function(){this.tapHandler(this.name,this.states[this.valueIndex].value,this.valueIndex)},n.prototype._setValueByIndex=function(e){this.valueIndex=e;var t=this.icon?"withIcon":"";this.setClassNames(["toggleButton",this.name,t,this.states[e].className])},n.prototype.setIcon=function(e){e!==this.icon&&(this.icon&&this.removeChild(this.icon),this.icon=e,this.toggleClassName("withIcon",!!e),e&&this.insertAsFirstChild(e))},n.prototype.setLabel=function(e){this.labelElement.setText(e)},n.prototype.reset=function(){0!==this.valueIndex&&(this._setValueByIndex(0),this._notifyOfUpdate())},n.prototype.selectState=function(e){return e<0||e>=this.states.length?console.error("Bad state index for toggle: "+e):void this._setValueByIndex(e)}},function(e,t){},function(e,t,i){function n(e,t,i,n){this.id=e,this.name=t,this["do"]=i,this.args=n}function o(){c.call(this),this.activeFilters={},this.singleColorMap={},this.filterMap={};for(var e=this._getFilterDefinitions(),t=0;t<e.length;t++){var i=e[t];this.filterMap[i.id]=i}this.isReady=!1;var n=this;this._setupTypes(function(){n.isReady=!0,n.emit("mountFiltersReady")})}function s(e,t){var i=this.behaviors.indexOf(e)!==-1;return i&&t||!i&&!t}function a(e){var t=T[this.model]||this.model,i=w[t];if(i.singleColorName)return t===e;var n=-1;return C.hasOwnProperty(t)?n=C[t].indexOf(e):console.error("composedColorMap[mountColorId] is undefined for mountColorId:",t),n!==-1}function r(){var e=w[this.model];return p.isSingleColor(e.colors)}function l(e){var t=u("tablet.mount.dragoturkey").toLowerCase(),i=e.toLowerCase().replace(t,"").trim(),n=i.length-1;return"-"===i[n]&&(i=i.substr(0,n-1)),i[0].toUpperCase()+i.substr(1)}var c=i(194).EventEmitter,u=i(29).getText,d=i(191).inherits,h=i(205).isEmptyObject,p=i(603),m=i(30),f=5,g=7500,_=p.ARMOURED_MOUNT_ID,v=p.FEATHERY_MOUNT_ID,y=p.ROYAL_MOUNT_ID,b=p.BARBARIAN_MOUNT_ID,w={},M=[3,10,15,16,17,18,19,20,21,22,23,_,v,y,b],T={1:20,6:10,74:18},C={9:[3,16],11:[16,10],12:[3,10],33:[20,18],34:[20,3],35:[20,21],36:[20,17],37:[20,16],38:[20,10],39:[20,15],40:[20,22],41:[20,19],42:[18,3],43:[18,21],44:[18,17],45:[18,16],46:[18,10],47:[18,15],48:[18,22],49:[18,19],50:[3,21],51:[3,17],52:[3,15],53:[3,22],54:[3,19],55:[21,17],56:[21,16],57:[21,10],58:[21,15],59:[21,22],60:[21,19],61:[17,16],62:[17,10],63:[17,15],64:[17,22],65:[17,19],66:[16,15],67:[16,22],68:[16,19],69:[15,10],70:[22,10],71:[19,10],72:[15,22],73:[15,19],76:[22,19],77:[23,20],78:[23,18],79:[23,3],80:[23,21],82:[23,17],83:[23,16],84:[23,10],85:[23,15],86:[23,22],87:[23,19]};d(o,c),e.exports=o,o.MountFilter=n,o.prototype._getFilterDefinitions=function(){return[{id:"name","do":function(e){return this.name.toLowerCase().indexOf(e)>-1}},{id:"sex",name:u("ui.common.animalFemale"),antiName:u("ui.common.animalMale"),"do":function(e){return this.sex===e}},{id:"baby",name:u("tablet.mount.filterNewborn"),"do":function(e){var t=!!this.isNewborn;return t===e}},{id:"fruitful",name:u("tablet.mount.filterFertile"),"do":function(e){var t=this.isFecondationReady,i=this.reproductionCount>=0&&this.reproductionCount<this.reproductionCountMax,n=!t&&i&&this.level>=f;return t&&e||n&&!e}},{id:"pregnant",name:u("tablet.mount.filterPregnant"),"do":function(e){return this.fecondationTime>0===e&&void 0!==this.fecondationTime}},{id:"mountable",name:u("tablet.mount.filterMountable"),"do":function(e){return this.isRideable===e}},{id:"sterilized",name:u("tablet.mount.filterSterilized"),"do":function(e){var t=this.reproductionCount<0||this.reproductionCount>=this.reproductionCountMax;return t===e}},{id:"love",name:u("tablet.mount.filterNeedLove"),"do":function(e){return this.love>=g===e}},{id:"stamina",name:u("tablet.mount.filterNeedStamina"),"do":function(e){return this.stamina>=g===e}},{id:"maturity",name:u("tablet.mount.filterNeedMaturity"),"do":function(e){return this.maturity>=this.maturityForAdult===e}},{id:"energy",name:u("tablet.mount.filterNeedEnergy"),"do":function(e){return this.energy>=this.energyMax===e}},{id:"serenity",name:u("ui.common.serenity"),"do":function(e,t){return this.serenity>=e&&this.serenity<=t}},{id:"fatigue",name:u("ui.common.tire"),"do":function(e,t){var i=this.boostLimiter/this.boostMax*100;return i>=e&&i<=t}}]},o.prototype.isEmpty=function(){return h(this.activeFilters)},o.prototype.isMatch=function(e){var t=this.activeFilters;for(var i in t){var n=t[i];if(!n["do"].apply(e,n.args))return!1}return!0},o.prototype.setFilter=function(e,t){var i=this.filterMap[e];return i.args=Array.isArray(t)?t:[t],this.activeFilters[e]=i,i},o.prototype.removeFilter=function(e){delete this.activeFilters[e]},o.prototype.addBehaviorFilter=function(e,t,i){var o=window.gui.databases.MountBehaviors[t];this.activeFilters[e]=new n("behavior"+t,o.nameId,s,[t,i])},o.prototype.addColorFilter=function(e,t){var i=this.singleColorMap[t];this.activeFilters[e]=new n("color"+t,i.singleColorName,a,[t])},o.prototype.addPureColorFilter=function(e){this.activeFilters[e]=new n("colorPure","",r)},o.prototype.getSingleColorMap=function(){return this.singleColorMap},o.prototype.isRealColor=function(e){return e!==_&&e!==v},o.prototype._setupTypes=function(e){var t=this.singleColorMap;m.getAllDataTable("Mounts",function(i,n){if(i)return console.error(i);for(var o=0;o<n.length;o++){var s=n[o];w[s.id]=s,s.colors=p.parseColorsFromLook(s.id,s.look),M.indexOf(s.id)!==-1&&(s.singleColorName=l(s.nameId),t[s.id]=s)}return e&&e()})}},function(e,t,i){function n(e,t,i,n){this.breedingWindow=e,this.id=t,this.name=i||"",this.capacity=n||Number.POSITIVE_INFINITY,this.box=null,this.reset()}function o(){var e=this.room;e.scrollStartTime=Date.now(),e.isScrolling=!0,e.refreshInterval||(e.refreshInterval=window.setInterval(r,f,e))}function s(){this.room.isScrolling=!1}function a(){var e=this.room;e.isScrolling=!1,e._stopTicker()}function r(e){Date.now()-e.scrollStartTime<g||(e._refreshView(),e.isRefreshComplete&&!e.isScrolling&&e._stopTicker())}function l(e,t,i,n,o,s){if(n<=i)return 0;var a,r,l;o?(l=-1,a=n-1,r=i-1):(l=1,a=i,r=n);for(var c=0,u=a;u!==r&&(!t[u].prepareToShow(u,e)||(c++,!s||c!==s));u+=l);return c}i(933);var c=i(925),u=i(483),d=4,h=37,p=14,m=1.5,f=90,g=100,_=2;e.exports=n,n.prototype.reset=function(){this.delayedSetup=0,this._stopTicker(),this.refreshInterval=null,this.lastRenderedScrollY=-1,this.scrollStartTime=0,this.isScrolling=!1,this.isRefreshComplete=!0,this.numMounts=0,this.mountMap={},this.selectedTiles={},this.numSelected=0,this.isLocked=!1,this.needsScrollerRefresh=!1,this.needRefilter=!1,this.hasNoFilter=!0,this.hasNoSorter=!0,this.tilesPerPage=0,this.allTiles=[],this.allVisibleTiles=[],this.box&&(this.box.clearContent(),this.scroller.goToTop())},n.prototype.createBox=function(e){var t=this.scroller=e.appendChild(new u(null,{maxSpeed:m,bounce:!0}));t.room=this,t.setStyle("maxHeight",e.rootElement.clientHeight+"px"),t.on("scrollStart",o),t.on("scrollEnd",s),t.on("scrollCancel",a);var i=t.content.createChild("div",{className:["roomBox",this.id]});return this.box=i.createChild("div",{className:"tileRoom"}),this.scrollGrip=i.createChild("div",{className:"scrollGrip"}),t},n.prototype.getTile=function(e){return this.box.getChild(e)},n.prototype.setMountSelected=function(e,t){var i=this.getTile(e);return i?(t?i.selected||(this.selectedTiles[e]=i,this.numSelected++):i.selected&&(delete this.selectedTiles[e],this.numSelected--),i.setTileSelected(t),i):console.error("Invalid tileId:",e)},n.prototype.setHightlightedMount=function(e){var t=this.setMountSelected(e,!0);t.highlightTile()},n.prototype.selectAll=function(){for(var e=this.allVisibleTiles,t=0;t<e.length;t++){var i=e[t];i.selected||(this.selectedTiles[i.id]=i,i.setTileSelected(!0))}this.numSelected=e.length},n.prototype.unselectAll=function(){for(var e in this.selectedTiles){var t=this.selectedTiles[e];t.setTileSelected(!1)}this.selectedTiles={},this.numSelected=0},n.prototype.getSelection=function(){return Object.keys(this.selectedTiles)},n.prototype.getNumSelected=function(){return this.numSelected},n.prototype.getNumHiddenMounts=function(){return this.allTiles.length-this.allVisibleTiles.length},n.prototype.addMount=function(e){this.mountMap[e.id]=e,this.numMounts++;var t=new c(e,this);this.box.appendChild(t),this.allTiles.push(t),this.hasNoSorter&&this.allVisibleTiles.push(t),this.needsScrollerRefresh=!0},n.prototype.removeMount=function(e){var t=this.mountMap[e];if(!t)return console.warn("removeMount: invalid ID:",e);var i=this.box.getChild(e);delete this.mountMap[e],this.numMounts--,i.selected&&(delete this.selectedTiles[e],this.numSelected--);var n=this.allTiles.indexOf(i);this.allTiles.splice(n,1);var o=this.allVisibleTiles;n=o.indexOf(i),o.splice(n,1);for(var s=o.length-1;s>=n;s--)o[s].markForReorder();i.hideTile(),this.box.removeChild(e),this.needsScrollerRefresh=!0},n.prototype._sortByProperty=function(e,t){function i(t,i){var o=t.mountData,s=i.mountData;return o.receivedData&&(o=o.receivedData),s.receivedData&&(s=s.receivedData),o[e]>s[e]?n:o[e]<s[e]?-n:o.id>s.id?n:-n}this.hasNoSorter=!1;var n=t?-1:1;this._hideAllTiles(),this.needRefilter=!0,this.allTiles.sort(i);for(var o=this.allTiles,s=0;s<o.length;s++)this.box.appendChild(o[s])},n.prototype._filter=function(e){var t=e.isEmpty();if(!t||!this.hasNoFilter||this.needRefilter){this.needsScrollerRefresh=!0,this.hasNoFilter=t,this.needRefilter=!1,this._hideAllTiles(),this.allVisibleTiles=[];for(var i=this.allTiles,n=0;n<i.length;n++){var o=i[n],s=o.mountData;s.receivedData&&(s=s.receivedData),e.isMatch(s)&&(this.allVisibleTiles.push(o),o.showTile())}}},n.prototype.toggleDisplay=function(e){this.scroller.toggleDisplay(e)},n.prototype.lockRoom=function(){this.isLocked=!0,this.scroller.hide(),this._hideAllTiles()},n.prototype.refreshDisplay=function(e,t,i){return this.isLocked&&(this.isLocked=!1,this._showAllTiles()),this.scroller.show(),t&&this._sortByProperty(t,i),this._filter(e),this.tilesPerPage?(this.needsScrollerRefresh&&(this.scroller.refresh(),this.needsScrollerRefresh=!1),void this._refreshView(!0)):this._setupLayout()},n.prototype._setupLayout=function(){if(this.allVisibleTiles.length){var e=this.scroller.getParent().rootElement,t=e.clientWidth,i=e.clientHeight,n=this.allVisibleTiles[0];n.setStyle("opacity",0);var o=n.rootElement.clientWidth,s=this.columnWidth=o+2*d;this.rowHeight=n.rootElement.clientHeight+2*d,n.setStyle("opacity",null);var a=Math.floor(t/s),r=t-a*s-p;r<h&&a>1&&(a--,r+=s),this.numColumns=a;var l=Math.ceil(i/this.rowHeight)+1;this.tilesPerPage=l*this.numColumns,this.extraTilesTopOrBottom=this.tilesPerPage,c.prepareTilePool(this,Math.min(this.numMounts,this.tilesPerPage+2*this.extraTilesTopOrBottom)),this.scrollGrip.setStyle("width",r+"px"),this.scroller.refresh(),this._refreshView(!0)}},n.prototype._stopTicker=function(){window.clearInterval(this.refreshInterval),this.refreshInterval=null},n.prototype._refreshView=function(e){var t=Math.min(0,this.scroller.iScroll.y);if(!(this.isRefreshComplete&&!e&&Math.abs(t-this.lastRenderedScrollY)<this.rowHeight)){var i=t-this.lastRenderedScrollY>0;this.isRefreshComplete=!1;for(var n=this.allVisibleTiles,o=n.length,s=Math.floor(-t/this.rowHeight)*this.numColumns,a=s,r=Math.min(s+this.tilesPerPage,o),c=this.extraTilesTopOrBottom,u=Math.max(0,s-c),d=Math.min(s+this.tilesPerPage+c,o),h=0;h<o;h++)h>=u&&h<d||n[h].prepareToGoOffScreen();var p=e?1/0:this.numColumns*_,m=l(1,n,a,r,i,p);p-=m,m&&!e||(m=l(2,n,a,r,i,p)),e&&(m+=l(1,n,u,d)),0===m&&(this.isRefreshComplete=!0,this.lastRenderedScrollY=t)}},n.prototype._hideAllTiles=function(){for(var e=this.allVisibleTiles,t=0;t<e.length;t++)e[t].hideTile();c.hidePoolTiles(this)},n.prototype._showAllTiles=function(){for(var e=this.allVisibleTiles,t=0;t<e.length;t++)e[t].showTile()}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"tabs"}),e=e||{},this.addClassNames(e.className),this.options=e,this.tabsMap={},this.tabsOrderIds=[],this.curentTabId=null,this.nextId=0}i(935);var o=i(191).inherits,s=i(235),a=i(228),r=i(258).playUiSound;o(n,s),e.exports=n,n.prototype.addTab=function(e,t,i){var n=this,o=i,s=!1;o||(o=this.nextId,this.nextId+=1,s=!0);var l=s?"tab"+o:o,c=this.createChild("div",{className:["tab",l],text:e});return a(c),c.on("tap",function(){n.options.closable&&o===n.curentTabId?n.close():(n.openTab(o),r("TAB"))}),c.on("enable",function(e){this._isDisable=!e,this.toggleClassName("disabled",!e),e||n.curentTabId!==o||n.openFirstTab()}),this.tabsMap[o]={tab:c,target:t},this.tabsOrderIds.push(o),t&&t.hide(),o},n.prototype.toggleTabDisplay=function(e,t){var i=this.tabsMap[e];if(i&&i.tab.toggleDisplay(t),this.curentTabId===e&&!i.tab.isVisible()){var n=this.tabsOrderIds[0];e===n?this.close():this.openTab(n)}},n.prototype.openTab=function(e,t,i){i=i||{},t=t||{};var n=this.curentTabId===e;if(i.forceOpen||!n){"number"==typeof e&&(e=this.tabsOrderIds[e]);var o=this.tabsMap[e];if(!o)return console.error("openTab - invalid tab ID given: "+e);n||this.close(),o.tab.addClassNames("on"),this.toggleTabNotification(e,!1);var s=o.target;s&&(s.emit("open",t),s.show(),i.delayOpenedEvent||s.emit("opened",t)),this.curentTabId=e,this.emit("openTab",e)}},n.prototype.openFirstTab=function(){this.openTab(this.tabsOrderIds[0])},n.prototype.getTabsMap=function(){return this.tabsMap},n.prototype.getFirstTab=function(){return this.tabsMap[this.tabsOrderIds[0]]},n.prototype.getCurrentTabId=function(){return this.curentTabId},n.prototype.getCurrentTab=function(){return this.tabsMap[this.curentTabId]},n.prototype.getTabTarget=function(e){var t=this.tabsMap[e]||{};return t.target},n.prototype.close=function(){if(this.curentTabId||"number"==typeof this.curentTabId){var e=this.tabsMap[this.curentTabId];e.tab.delClassNames("on");var t=e.target;t&&(t.hide(),t.emit("close"))}this.curentTabId=null},n.prototype.setClosable=function(e){this.options.closable=e},n.prototype.toggleTabNotification=function(e,t){var i=this.tabsMap[e];i&&i.tab.toggleClassName("notification",t)},n.prototype.toggleTabAvailability=function(e,t){var i=this.tabsMap[e];if(i){var n=i.tab;void 0===t&&(t=!n._isDisable),n.setEnable(t)}},n.prototype.emitOnCurrentTab=function(e,t){t=t||{};var i=this.getCurrentTab();i&&i.target.emit(e,t)}},function(e,t){},function(e,t,i){function n(e){a.call(this,"div",{className:["waitingGauge","spinner"],hidden:!0}),e=e||{};var t=this.createChild("div",{className:"verticalCenterDiv"}),i=this.gauge=t.createChild("div",{className:"gauge"});this.progressCircle=i.appendChild(new s({size:e.size||r,thickness:e.thickness||l,color:e.color||c,bgColor:e.bgColor||u})),this.valueElement=i.createChild("div",{className:"value",text:""}),this.labelElt=t.createChild("div",{className:"label",text:""})}i(937);var o=i(191).inherits,s=i(601),a=i(235),r=70,l=7,c="#58b",u="#555";o(n,a),e.exports=n,n.prototype.setLabel=function(e){this.labelElt.setText(e)},n.prototype.showGauge=function(e,t,i){this.goal=e,i=i||1,e>i?(this.progressCircle.setValue(0,1),this.valueElement.setText("0%"),this.labelElt.setText(t?t:""),this.delClassNames("spinner"),this.gauge.show(),this.labelElt.show()):this.labelElt.hide(),this.show()},n.prototype.refreshGauge=function(e){if(this.gauge.isVisible()){var t=(this.goal-e)/this.goal;this.progressCircle.setValue(t,1),this.valueElement.setText(Math.round(100*t)+"%")}0===e&&this.hideGauge()},n.prototype.hideGauge=function(){this.goal=0,this.addClassNames("spinner"),this.gauge.hide(),this.hide()}},function(e,t){},function(e,t,i){function n(){_.call(this,{title:b("ui.common.caracteristics"),className:"characteristics",positionInfo:{left:40,top:"c",width:320,height:630}});var e=this;this.on("open",this.alignWithEquipment),this.infos=this.windowBody.createChild("div",{className:"infos"}),this.logoWrapper=this.infos.createChild("div",{className:"logoWrapper"}),this.logo=this.logoWrapper.appendChild(new A({className:"logo"},function(){M.open("grimoire",{tabId:"alignment"})})),this.playerName=this.infos.createChild("div",{className:"playerName"}),this.infosSup=this.infos.createChild("div",{className:"infosSup"}),this.stats=this.windowBody.createChild("div",{className:"stats"}),window.gui.playerData.on("characteristicsUpdated",function(){window.gui.playerData.characterBreed&&e.updateStats(window.gui.playerData.characters.mainCharacter.characteristics)}),f={maxLifePoints:b("ui.help.life"),actionPoints:b("ui.help.AP"),movementPoints:b("ui.help.MP"),initiative:b("ui.help.initiative"),prospecting:b("ui.help.prospecting"),range:b("ui.help.range"),summonableCreaturesBoost:b("ui.help.summonableCreatures"),vitality:b("ui.help.vitality"),wisdom:b("ui.help.wisdom"),strength:b("ui.help.strength"),intelligence:b("ui.help.intelligence"),chance:b("ui.help.chance"),agility:b("ui.help.agility"),level:b("ui.help.level"),red:b("ui.help.energy"),blue:b("ui.help.xp"),characteristics:b("ui.help.boostPoints")},window.gui.playerData.alignment.on("alignmentChanged",function(){var t=window.gui.playerData.characterBaseInformations,i=window.gui.playerData.alignment;i.getAlignmentImageUrl(function(t){e.logo.setStyle("backgroundImage",t)}),e.playerName.setText(t.name),window.gui.playerData.characterBreed&&e.infosSup.setText(window.gui.playerData.characterBreed.shortNameId+", "+b("ui.common.level")+" "+t.level),T(e.infosSup,f.level)})}function o(e){return e.createChild("div",{className:"panel"})}function s(e,t){return e.createChild("table",{className:t})}function a(e,t,i,n,o){var s=e.createChild("div",{className:"barWrapper"}),a=s.createChild("div",{className:"label",text:t}),r=s.appendChild(new y({className:i,value:n/o}));T(a,f[i]),T(r,n+" / "+o)}function r(e){return e||"-"}function l(e,t,i){var n;T(t,function(){if(!n){var t=e[i],o=b("ui.common.base")+"+"+b("tablet.common.additional");o+=b("ui.common.colon"),o+=t.getBaseWithoutAdditionalPts()+"+"+t.getAdditionalPts();var s=b("ui.common.equipement")+b("ui.common.colon");s+=r(t.getEquipmentPts());var a=b("ui.common.gifts")+"+"+b("ui.common.boost")+b("ui.common.colon");a+=r(t.getBonusPts()),n=new C("div",{className:"toolTipLabelBlock"}),n.createChild("div",{className:"toolTipLabel",text:o}),n.createChild("div",{className:"toolTipLabel",text:s}),n.createChild("div",{className:"toolTipLabel",text:a})}return n})}function c(e,t,i,n,o){var s=e.createChild("tr"),a=s.createChild("td",{className:["label",o],text:t});T(a,f[i]),s.createChild("td",{className:"value",text:r(n)})}function u(e,t,i){i=i||4;var n=e.createChild("tr");return n.createChild("td",{className:"tableTitle",text:t,attr:{colspan:i}}),n}function d(e,t,i,n){var o=r(i.getBasePts()),s=r(i.getBonusPts()+i.getEquipmentPts()),a=r(i.getTotalStat()),l=e.createChild("tr");l.createChild("td",{className:["label",n],text:t}),l.createChild("td",{className:"base",text:o}),l.createChild("td",{className:"bonus",text:s}),l.createChild("td",{className:"total",text:a})}function h(e,t,i,n,o){var s=e.createChild("tr"),a=s.createChild("td",{className:["label",o],text:i});T(a,f[n]);var c=t[n],u=s.createChild("td",{className:"value",text:r(c.getTotalStat())});l(t,u,n);var d=s.createChild("td",{className:"upgrade"}),h=d.createChild("div",{className:"upgradeButton"});w(h);var p="statsPointsFor"+n[0].toUpperCase()+n.substr(1),m=window.gui.playerData.characterBreed[p];h.on("tap",function(){I("PLUS_BUTTON"),M.open("characUpdate",{additionalPtsRemaining:t.getRemainingAdditionalPts(),characteristicName:n,costSteps:m,initialLevel:t[n].getBaseWithoutAdditionalPts(),initialAdditionalPts:t[n].getAdditionalPts(),label:i,pointsRemaining:t.statsPoints})})}function p(e,t,i,n){var o=e.createChild("tr");o.createChild("td",{className:["label","pointCapital"],text:t}),o.createChild("td",{className:["value","pointCapital"],text:String(i+n)});var s=t+" "+String(i);if(n>0&&(s+=" + "+String(n)),s+="\n\n"+f.characteristics,T(o,s),o.toggleClassName("haveAdditionalPts",n>0),n>0){var a=e.createChild("tr"),r=a.createChild("td",{className:["haveAdditionalPts","additionalPtsLineHelp"],attr:{colspan:3}});r.setHtml(b("tablet.characteristics.help"))}}function m(e){var t=e.createChild("tr");t.createChild("td",{className:"label",text:b("ui.common.caracteristics")}),t.createChild("td",{className:"base",text:b("ui.common.base")}),t.createChild("td",{className:"bonus",text:b("ui.fightend.bonus")}),t.createChild("td",{className:"total",text:b("ui.common.total")})}i(939);var f,g=i(191).inherits,_=i(233),v=i(934),y=i(605),b=i(29).getText,w=i(228),M=i(225),T=i(248).addTooltip,C=i(235),I=i(258).playUiSound,A=i(246);g(n,_),e.exports=n,n.prototype.alignWithEquipment=function(){var e=M.getWindow("equipment");e.openState&&(this.setStyles({top:e.getStyle("top"),height:e.getStyle("height")}),M.arrangeOpeningWindow(this.id,{leftOf:e.id}))},n.prototype.updateStats=function(e){this.stats.clearContent(),this.tabs=new v,this.stats.appendChild(this.tabs),this.panels=this.stats.createChild("div",{className:"panels"}),this.panelSummary=o(this.panels),a(this.panelSummary,b("ui.common.energy"),"red",e.energyPoints,e.maxEnergyPoints),a(this.panelSummary,b("ui.common.experiment"),"blue",e.experience-e.experienceLevelFloor,e.experienceNextLevelFloor-e.experienceLevelFloor);var t=s(this.panelSummary,"summaryTable");c(t,b("ui.stats.lifePoints"),"maxLifePoints",e.lifePoints+" / "+e.maxLifePoints,"iconLifePoints"),c(t,b("ui.stats.shortAP"),"actionPoints",e.actionPoints.getTotalStat(),"iconActionPoints"),c(t,b("ui.stats.shortMP"),"movementPoints",e.movementPoints.getTotalStat(),"iconMovementPoints");var i=e.initiative.getTotalStat(),n=Math.floor(i*e.lifePoints/e.maxLifePoints);c(t,b("ui.stats.initiative"),"initiative",n+" / "+i,"iconInitiative"),c(t,b("ui.stats.prospecting"),"prospecting",e.prospecting.getTotalStat(),"iconProspecting"),c(t,b("ui.stats.range"),"range",e.range.getTotalStat(),"iconRange"),c(t,b("ui.stats.summonableCreatures"),"summonableCreaturesBoost",e.summonableCreaturesBoost.getTotalStat(),"iconSummon");var r=s(this.panelSummary,"characTable");u(r,b("ui.common.caracteristics"),3),h(r,e,b("ui.stats.vitality"),"vitality","iconVitality"),h(r,e,b("ui.stats.wisdom"),"wisdom","iconWisdom"),h(r,e,b("ui.stats.strength"),"strength","iconStrength"),h(r,e,b("ui.stats.intelligence"),"intelligence","iconIntelligence"),h(r,e,b("ui.stats.chance"),"chance","iconChance"),h(r,e,b("ui.stats.agility"),"agility","iconAgility"),p(r,b("ui.stats.statPoints"),e.statsPoints,e.getRemainingAdditionalPts()),this.panelAdvanced=o(this.panels);var l=s(this.panelAdvanced,"advancedTable");m(l),u(l,b("ui.charaSheet.primaryStats")),d(l,b("ui.stats.vitality"),e.vitality,"iconVitality"),d(l,b("ui.stats.wisdom"),e.wisdom,"iconWisdom"),d(l,b("ui.stats.strength"),e.strength,"iconStrength"),d(l,b("ui.stats.intelligence"),e.intelligence,"iconIntelligence"),d(l,b("ui.stats.chance"),e.chance,"iconChance"),d(l,b("ui.stats.agility"),e.agility,"iconAgility"),d(l,b("ui.stats.shortAP"),e.actionPoints,"iconActionPoints"),d(l,b("ui.stats.shortMP"),e.movementPoints,"iconMovementPoints"),d(l,b("ui.stats.initiative"),e.initiative,"iconInitiative"),d(l,b("ui.stats.prospecting"),e.prospecting,"iconProspecting"),d(l,b("ui.stats.range"),e.range,"iconRange"),d(l,b("ui.stats.summonableCreatures"),e.summonableCreaturesBoost,"iconSummon"),u(l,b("ui.charaSheet.secondaryStats")),d(l,b("ui.stats.PAAttack"),e.PAAttack,"iconAttackAP"),d(l,b("ui.stats.dodgeAP"),e.dodgePALostProbability,"iconDodgeAP"),d(l,b("ui.stats.PMAttack"),e.PMAttack,"iconAttackMP"),d(l,b("ui.stats.dodgeMP"),e.dodgePMLostProbability,"iconDodgeMP"),d(l,b("ui.stats.criticalHit"),e.criticalHit,"iconCriticalHit"),d(l,b("ui.stats.healBonus"),e.healBonus,"iconHeal"),d(l,b("ui.stats.takleBlock"),e.tackleBlock,"iconTackle"),d(l,b("ui.stats.takleEvade"),e.tackleEvade,"iconEvade"),u(l,b("ui.stats.damagesBonus")),d(l,b("ui.stats.damagesBonus"),e.allDamagesBonus,"iconDamage"),d(l,b("ui.stats.damagesBonusPercent"),e.damagesBonusPercent,"iconDamagePercent"),d(l,b("ui.stats.criticalDamageBonus"),e.criticalDamageBonus,"iconCriticalDamage"),d(l,b("ui.stats.neutralDamageBonus"),e.neutralDamageBonus,"iconYinyang"),d(l,b("ui.stats.earthDamageBonus"),e.earthDamageBonus,"iconStrength"),d(l,b("ui.stats.fireDamageBonus"),e.fireDamageBonus,"iconIntelligence"),d(l,b("ui.stats.waterDamageBonus"),e.waterDamageBonus,"iconChance"),d(l,b("ui.stats.airDamageBonus"),e.airDamageBonus,"iconAgility"),d(l,b("ui.stats.return"),e.reflect,"iconReturn"),d(l,b("ui.stats.weaponDamagesPercent"),e.weaponDamagesBonusPercent,"iconWeaponDamage"),
d(l,b("ui.stats.trapBonus"),e.trapBonus,"iconTrap"),d(l,b("ui.stats.trapBonusPercent"),e.trapBonusPercent,"iconTrapPercent"),d(l,b("ui.stats.pushDamageBonus"),e.pushDamageBonus,"iconPushDamage"),u(l,b("ui.common.resistances")),d(l,b("ui.stats.neutralReduction"),e.neutralElementReduction,"iconYinyang"),d(l,b("ui.stats.neutralReductionPercent"),e.neutralElementResistPercent,"iconYinyang"),d(l,b("ui.stats.earthReduction"),e.earthElementReduction,"iconStrength"),d(l,b("ui.stats.earthReductionPercent"),e.earthElementResistPercent,"iconStrength"),d(l,b("ui.stats.fireReduction"),e.fireElementReduction,"iconIntelligence"),d(l,b("ui.stats.fireReductionPercent"),e.fireElementResistPercent,"iconIntelligence"),d(l,b("ui.stats.waterReduction"),e.waterElementReduction,"iconChance"),d(l,b("ui.stats.waterReductionPercent"),e.waterElementResistPercent,"iconChance"),d(l,b("ui.stats.airReduction"),e.airElementReduction,"iconAgility"),d(l,b("ui.stats.airReductionPercent"),e.airElementResistPercent,"iconAgility"),d(l,b("ui.stats.criticalDamageReduction"),e.criticalDamageReduction,"iconCriticalReduction"),d(l,b("ui.stats.pushDamageReduction"),e.pushDamageReduction,"iconPushDamageReduction"),u(l,b("ui.common.resistancesPvp")),d(l,b("ui.stats.neutralReduction"),e.pvpNeutralElementReduction,"iconYinyang"),d(l,b("ui.stats.neutralReductionPercent"),e.pvpNeutralElementResistPercent,"iconYinyang"),d(l,b("ui.stats.earthReduction"),e.pvpEarthElementReduction,"iconStrength"),d(l,b("ui.stats.earthReductionPercent"),e.pvpEarthElementResistPercent,"iconStrength"),d(l,b("ui.stats.fireReduction"),e.pvpFireElementReduction,"iconIntelligence"),d(l,b("ui.stats.fireReductionPercent"),e.pvpFireElementResistPercent,"iconIntelligence"),d(l,b("ui.stats.waterReduction"),e.pvpWaterElementReduction,"iconChance"),d(l,b("ui.stats.waterReductionPercent"),e.pvpWaterElementResistPercent,"iconChance"),d(l,b("ui.stats.airReduction"),e.pvpAirElementReduction,"iconAgility"),d(l,b("ui.stats.airReductionPercent"),e.pvpAirElementResistPercent,"iconAgility"),this.tabs.addTab(b("ui.stats.summary"),this.panelSummary),this.tabs.addTab(b("ui.stats.advanced"),this.panelAdvanced),this.tabs.openTab(0)}},function(e,t){},function(e,t,i){function n(){function e(e){c.close("deleteCharacterConfirm");var t=e.data;n.setText(t.name),o.setText(u("ui.common.level")+" "+t.level),r.selectedCharacter=t,r.characterDisplay.setLook(t.entityLook,{boneType:"characters/",skinType:"characters/"}),r.xpSticker.setClassNames(["xpSticker","x"+t.bonusXp])}function t(){var e=M.playerData.identification.secretQuestion,t=r.selectedCharacter.level,i=r.selectedCharacter.id,n=r.selectedCharacter.name;t>=b&&e?c.open("deleteCharacterConfirm",{id:i,name:n,secretQuestion:e}):M.openConfirmPopup({title:u("ui.popup.warning"),message:u("ui.popup.warnBeforeDelete",n),cb:function(e){if(e){var t=d(i+"~000000000000000000");window.dofus.sendMessage("CharacterDeletionRequestMessage",{characterId:i,secretAnswerHash:t})}}})}function i(e){var t="default",i={TooManyDeletion:u("ui.charSel.deletionErrorTooManyDeletion"),WrongAnswer:u("ui.charSel.deletionErrorWrongAnswer"),UnsecureMode:u("ui.charSel.deletionErrorUnsecureMode"),"default":u("ui.charSel.deletionError")};e.reason===_.DEL_ERR_TOO_MANY_CHAR_DELETION?t="TooManyDeletion":e.reason===_.DEL_ERR_BAD_SECRET_ANSWER?t="WrongAnswer":e.reason===_.DEL_ERR_RESTRICED_ZONE&&(t="UnsecureMode"),M.openSimplePopup(i[t])}l.call(this,{className:"CharacterSelectionWindow",title:u("ui.charsel.title"),positionInfo:{left:"c",top:"c",width:650,height:520,isFullScreen:!0}});var n,o,r=this,y=7,b=20,w=this.windowBody,M=window.gui;this.selectedCharacter=null;var T=this.leftColumn=w.createChild("div",{className:"leftColumn"});this.charactersTable=T.appendChild(new m({className:"characterTable",minRows:y,highlightable:!0,colIds:["name","bonusXp"],headerContent:[""],onRowTap:function(t){t.data&&e(t)}}));var C=T.createChild("div",{className:"buttonsDiv"});this.btnCreate=C.appendChild(new h({text:u("ui.charsel.createCharacter"),className:["newCharacterBtn","button"],sound:"OK_BUTTON"},function(){c.close("deleteCharacterConfirm"),c.close(r.id),c.open("characterCreation")})),C.createChild("div",{className:"xpBubble"});var I=C.appendChild(new h({text:u("ui.charsel.changeServer"),className:["changeServerBtn","button"],sound:"CANCEL_BUTTON"},function(){c.close(r.id),f.goBackToSelectionOf("server")})),A=w.createChild("div",{className:"centerPanel"}),S=A.createChild("div",{className:["line","nameLine"]}),E=S.createChild("div",{className:"nameDiv"});n=E.createChild("div",{className:"name"}),this.btnDelete=E.appendChild(new h({className:"delCharacterBtn",text:"X"},t));var x=A.createChild("div",{className:["line","levelLine"]});o=x.createChild("div",{className:"level"});var L=A.appendChild(new g({scale:2.3}));this.characterDisplay=L;var N=L.createChild("div",{className:"leftButton"});p(N,{repeatDelay:100}),N.on("tap",function(){L.rotateCharacter(!1)});var O=L.createChild("div",{className:"rightButton"});p(O,{repeatDelay:100}),O.on("tap",function(){L.rotateCharacter(!0)}),this.xpSticker=L.createChild("div",{className:"xpSticker"}),s(this.xpSticker,u("ui.information.xpFamilyBonus"));var D=this.btnPlay=A.appendChild(new h({text:u("ui.common.play"),className:["btnPlay","button"],sound:"PLAY_BUTTON"},function(){this.disable(),r.btnCreate.disable(),I.disable(),a.selectCharacter(r.selectedCharacter.id)}));this.closeButton.on("tap",function(){I.emit("tap")}),this._consoleButton=w.appendChild(new h({className:["consoleButton"],hidden:!0},function(){c["switch"]("adminConsole")})),this.on("open",function(e){return e=e.length?e:null,r._consoleButton.toggleDisplay(window.gui.playerData.hasRight(v.SHOW_ADMIN_CONSOLE_BUTTON)),this.charactersList=e||this.charactersList,this.charactersList?(r.updateCharacterList(this.charactersList),D.enable(),r.btnCreate.enable(),void I.enable()):console.error("CharacterSelectionWindow opened without character list info")}),this.on("close",function(){c.close("deleteCharacterConfirm"),L.release()}),M.on("CharacterDeletionErrorMessage",this.localizeEvent(i))}function o(e){for(var t=1,i=0,n=e.length;i<n;i++){for(var o=1,s=0;s<n;s++)e[s].id!==e[i].id&&e[s].level>e[i].level&&o<4&&o++;e[i].bonusXp=o,e[i].level>1&&t++}return Math.min(t,4)}i(941);var s=i(248).addTooltip,a=i(661),r=i(191).inherits,l=i(233),c=i(225),u=i(29).getText,d=i(942),h=i(246),p=i(228),m=i(735),f=i(282),g=i(415),_=i(946),v=i(493);r(n,l),e.exports=n,n.prototype.updateCharacterList=function(e){var t=o(e);this.leftColumn.setClassNames(["leftColumn","x"+t+"Bubble"]),this.charactersTable.clearContent();var i=this.charactersTable.header.getChildren()[0].getChild("name");i.setHtml(u("ui.connection.listCharacterLabel",e.length));for(var n=window.gui.databases.Breeds,s=0;s<e.length;s++){var a=e[s],r=a.breed||0,l=a.name+" ("+n[r].shortNameId+" "+a.level+")",c=this.charactersTable.addRow({name:l},{data:a}),d=a.bonusXp;d>1&&c.getChildren()[1].addClassNames(["x"+d])}}},function(e,t){},function(e,t,i){!function(){var t=i(943),n=i(944).utf8,o=i(945),s=i(944).bin,a=function(e,i){e.constructor==String?e=i&&"binary"===i.encoding?s.stringToBytes(e):n.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var r=t.bytesToWords(e),l=8*e.length,c=1732584193,u=-271733879,d=-1732584194,h=271733878,p=0;p<r.length;p++)r[p]=16711935&(r[p]<<8|r[p]>>>24)|4278255360&(r[p]<<24|r[p]>>>8);r[l>>>5]|=128<<l%32,r[(l+64>>>9<<4)+14]=l;for(var m=a._ff,f=a._gg,g=a._hh,_=a._ii,p=0;p<r.length;p+=16){var v=c,y=u,b=d,w=h;c=m(c,u,d,h,r[p+0],7,-680876936),h=m(h,c,u,d,r[p+1],12,-389564586),d=m(d,h,c,u,r[p+2],17,606105819),u=m(u,d,h,c,r[p+3],22,-1044525330),c=m(c,u,d,h,r[p+4],7,-176418897),h=m(h,c,u,d,r[p+5],12,1200080426),d=m(d,h,c,u,r[p+6],17,-1473231341),u=m(u,d,h,c,r[p+7],22,-45705983),c=m(c,u,d,h,r[p+8],7,1770035416),h=m(h,c,u,d,r[p+9],12,-1958414417),d=m(d,h,c,u,r[p+10],17,-42063),u=m(u,d,h,c,r[p+11],22,-1990404162),c=m(c,u,d,h,r[p+12],7,1804603682),h=m(h,c,u,d,r[p+13],12,-40341101),d=m(d,h,c,u,r[p+14],17,-1502002290),u=m(u,d,h,c,r[p+15],22,1236535329),c=f(c,u,d,h,r[p+1],5,-165796510),h=f(h,c,u,d,r[p+6],9,-1069501632),d=f(d,h,c,u,r[p+11],14,643717713),u=f(u,d,h,c,r[p+0],20,-373897302),c=f(c,u,d,h,r[p+5],5,-701558691),h=f(h,c,u,d,r[p+10],9,38016083),d=f(d,h,c,u,r[p+15],14,-660478335),u=f(u,d,h,c,r[p+4],20,-405537848),c=f(c,u,d,h,r[p+9],5,568446438),h=f(h,c,u,d,r[p+14],9,-1019803690),d=f(d,h,c,u,r[p+3],14,-187363961),u=f(u,d,h,c,r[p+8],20,1163531501),c=f(c,u,d,h,r[p+13],5,-1444681467),h=f(h,c,u,d,r[p+2],9,-51403784),d=f(d,h,c,u,r[p+7],14,1735328473),u=f(u,d,h,c,r[p+12],20,-1926607734),c=g(c,u,d,h,r[p+5],4,-378558),h=g(h,c,u,d,r[p+8],11,-2022574463),d=g(d,h,c,u,r[p+11],16,1839030562),u=g(u,d,h,c,r[p+14],23,-35309556),c=g(c,u,d,h,r[p+1],4,-1530992060),h=g(h,c,u,d,r[p+4],11,1272893353),d=g(d,h,c,u,r[p+7],16,-155497632),u=g(u,d,h,c,r[p+10],23,-1094730640),c=g(c,u,d,h,r[p+13],4,681279174),h=g(h,c,u,d,r[p+0],11,-358537222),d=g(d,h,c,u,r[p+3],16,-722521979),u=g(u,d,h,c,r[p+6],23,76029189),c=g(c,u,d,h,r[p+9],4,-640364487),h=g(h,c,u,d,r[p+12],11,-421815835),d=g(d,h,c,u,r[p+15],16,530742520),u=g(u,d,h,c,r[p+2],23,-995338651),c=_(c,u,d,h,r[p+0],6,-198630844),h=_(h,c,u,d,r[p+7],10,1126891415),d=_(d,h,c,u,r[p+14],15,-1416354905),u=_(u,d,h,c,r[p+5],21,-57434055),c=_(c,u,d,h,r[p+12],6,1700485571),h=_(h,c,u,d,r[p+3],10,-1894986606),d=_(d,h,c,u,r[p+10],15,-1051523),u=_(u,d,h,c,r[p+1],21,-2054922799),c=_(c,u,d,h,r[p+8],6,1873313359),h=_(h,c,u,d,r[p+15],10,-30611744),d=_(d,h,c,u,r[p+6],15,-1560198380),u=_(u,d,h,c,r[p+13],21,1309151649),c=_(c,u,d,h,r[p+4],6,-145523070),h=_(h,c,u,d,r[p+11],10,-1120210379),d=_(d,h,c,u,r[p+2],15,718787259),u=_(u,d,h,c,r[p+9],21,-343485551),c=c+v>>>0,u=u+y>>>0,d=d+b>>>0,h=h+w>>>0}return t.endian([c,u,d,h])};a._ff=function(e,t,i,n,o,s,a){var r=e+(t&i|~t&n)+(o>>>0)+a;return(r<<s|r>>>32-s)+t},a._gg=function(e,t,i,n,o,s,a){var r=e+(t&n|i&~n)+(o>>>0)+a;return(r<<s|r>>>32-s)+t},a._hh=function(e,t,i,n,o,s,a){var r=e+(t^i^n)+(o>>>0)+a;return(r<<s|r>>>32-s)+t},a._ii=function(e,t,i,n,o,s,a){var r=e+(i^(t|~n))+(o>>>0)+a;return(r<<s|r>>>32-s)+t},a._blocksize=16,a._digestsize=16,e.exports=function(e,i){if("undefined"!=typeof e){var n=t.wordsToBytes(a(e,i));return i&&i.asBytes?n:i&&i.asString?s.bytesToString(n):t.bytesToHex(n)}}}()},function(e,t){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&i.rotl(e,8)|4278255360&i.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=i.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],i=0,n=0;i<e.length;i++,n+=8)t[n>>>5]|=e[i]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],i=0;i<32*e.length;i+=8)t.push(e[i>>>5]>>>24-i%32&255);return t},bytesToHex:function(e){for(var t=[],i=0;i<e.length;i++)t.push((e[i]>>>4).toString(16)),t.push((15&e[i]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],i=0;i<e.length;i+=2)t.push(parseInt(e.substr(i,2),16));return t},bytesToBase64:function(e){for(var i=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],s=0;s<4;s++)8*n+6*s<=8*e.length?i.push(t.charAt(o>>>6*(3-s)&63)):i.push("=");return i.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var i=[],n=0,o=0;n<e.length;o=++n%4)0!=o&&i.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(e.charAt(n))>>>6-2*o);return i}};e.exports=i}()},function(e,t){var i={utf8:{stringToBytes:function(e){return i.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(i.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],i=0;i<e.length;i++)t.push(255&e.charCodeAt(i));return t},bytesToString:function(e){for(var t=[],i=0;i<e.length;i++)t.push(String.fromCharCode(e[i]));return t.join("")}}};e.exports=i},function(e,t){e.exports=function(e){return!(null==e||!e.constructor||"function"!=typeof e.constructor.isBuffer||!e.constructor.isBuffer(e))}},function(e,t){e.exports={DEL_ERR_NO_REASON:1,DEL_ERR_TOO_MANY_CHAR_DELETION:2,DEL_ERR_BAD_SECRET_ANSWER:3,DEL_ERR_RESTRICED_ZONE:4}},function(e,t,i){function n(){s.call(this,{className:"GiftSelectionWindow",title:a("ui.connection.giftReceived"),noCloseButton:!0,positionInfo:{left:"c",top:"c",width:800,height:520}});var e=this;this._giftList=[],this._giftListIndex=0,this._hasDom=!1,this._itemSpace=null,this._charactersSpace=null,this._selectedCharaId=null,this.on("open",function(t){e._characterList=window.gui.gifts.getCharaListMinusDeadPeople(),e._giftList=t||[],e._createDom(),e._setupEvents(),e._updateCharactersSpace(),e._updateGift()}),this.on("open",function(){window.foreground.lock("giftAttribution")}),this.on("close",function(){window.foreground.unlock("giftAttribution"),e._reset()})}i(948);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(949),l=i(955),c=i(246).DofusButton,u=i(227);o(n,s),e.exports=n,n.prototype._reset=function(){this._charactersSpace&&this._charactersSpace.reset(),this.windowBody.clearContent(),this._hasDom=!1,this._giftListIndex=0,this._giftList=[],this._itemSpace=null,this._charactersSpace=null,this._selectedCharaId=null},n.prototype._setupEvents=function(){var e=this;window.gui.gifts.on("giftAssignRequestResult",function(t){if(e.openState){var i=e._giftList[e._giftListIndex];i&&t.actionId===i.uid&&(e._charactersSpace.setAssignLoading(!1),e._nextGift())}})},n.prototype._createDom=function(){var e=this;if(!this._hasDom){var t=this.windowBody,i=t.createChild("div",{className:"left"});this._itemSpace=i.appendChild(new r);var n=t.createChild("div",{className:"right"});this._charactersSpace=n.appendChild(new l),this._charactersSpace.on("selectTile",function(t){e._selectedCharaId=t});var o=t.createChild("div",{className:"buttonSpace"});o.appendChild(new c(a("ui.connection.notNow"),{scaleOnPress:!0,className:"buttonSpaceButton"},function(){e._nextGift()})),this._assignBtn=o.appendChild(new c(a("ui.connection.assignGift"),{scaleOnPress:!0,className:"buttonSpaceButton"},function(){e._charactersSpace.setAssignLoading(!0),e._assignGift()})),this._hasDom=!0}},n.prototype._nextGift=function(){var e=this,t=this._giftListIndex+1>=this._giftList.length;if(t)return this.close();this._giftListIndex+=1;var i=this.position.x,n=this.position.y;u.tween(this,{opacity:0,webkitTransform:"translate3d("+i+"px,"+n+"px,0) scale(0.8)"},{time:150,delay:0,easing:"ease-out"},function(){u.tween(e,{opacity:1,webkitTransform:"translate3d("+i+"px,"+n+"px,0)  scale(1)"},{time:150,delay:0,easing:"ease-out"},function(){e._updateGift()})})},n.prototype._assignGift=function(){if(this._selectedCharaId){var e=this._giftList[this._giftListIndex];e&&window.gui.gifts.assignGift(e.uid,this._selectedCharaId)}},n.prototype._updateGift=function(){var e=this._giftList[this._giftListIndex]||{};this._itemSpace.update(e)},n.prototype._updateCharactersSpace=function(){this._charactersSpace.update(this._characterList)}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"ItemSpace"});var e=this,t=this.createChild("div",{className:"topContainer"}),i=t.createChild("div",{className:"top"});this._title=i.createChild("div",{className:"title"}),this._description=i.createChild("div",{className:"description"}),i.createChild("div",{className:"contentText",text:l("ui.connection.contents")}),this._rewardBoxes=i.appendChild(new r({nbRewards:8})),this._itemBox=this.appendChild(new a({showTitle:!0})),this._rewardBoxes.on("tapSlot",function(t){e._updateItemBox(t)})}i(950);var o=i(191).inherits,s=i(235),a=i(951),r=i(953),l=i(29).getText;o(n,s),e.exports=n,n.prototype.update=function(e){e=e||{},this._title.setText(e.title);var t=e.text;"null"===t.trim().toLowerCase()&&(t=""),this._description.setText(t);var i=e.items||[],n=i[0];n?this._updateItemBox(n):this._itemBox.hide(),this._rewardBoxes.reset();for(var o=0,s=i.length;o<s;o+=1){var a=i[o];this._rewardBoxes.addItemInstance(a)}},n.prototype._updateItemBox=function(e){this._itemBox.displayItem(e),this._itemBox.show()}},function(e,t){},function(e,t,i){function n(){window.gui.openContextualMenuAround("item",this,{item:this.myWindow.itemInstance||this.myWindow.item,enableActions:!0,enableDestroy:!1,enableSet:!1,enableRecipe:!1,enableInsertRecipe:!0,enableSell:!1,enableBestiary:!1})}function o(){this.myWindow.itemInstance?_.openBidHouse(!0,null,this.myWindow.itemInstance):_.openBidHouse(!1,null,this.myWindow.itemId)}function s(){return M(this.myWindow.itemInstance?"tablet.itemSellInBidHouse":"tablet.itemSearchInBidHouse")}function a(){var e=this.myWindow.item;B.open("grimoire",{tabId:"bestiary",tabParams:{monsterIds:e.getProperty("dropMonsterIds"),label:e.getRawName()}})}function r(){B.open("itemRecipes",{itemData:this.myWindow.item})}function l(){var e=this.myWindow,t=e.itemInstance;return 1===t.quantity?void window.gui.playerData.inventory.confirmDestroyItem(t,1):void e._minMaxSelector.openAround(this,{min:1,max:t.quantity})}function c(){B.open("itemSets",this.myWindow.itemInstance)}function u(e){P.call(this,"div",{className:"ItemBox"}),this.itemInstance=null,this.item=null,this._mountData=null;var t=this;e=e||{},this._parentWindow=e.parent,this.showTitle=!!e.showTitle,this.showItemActions=!!e.hasOwnProperty("showItemActions")&&e.showItemActions,this.showDescription=!!e.hasOwnProperty("showDescription")&&e.showDescription;var i=this._itemTitle=this.createChild("div",{className:"itemBox-title"});this._name=i.createChild("div",{className:"itemBox-name"}),this._level=i.createChild("div",{className:"itemBox-level"});var u=this.createChild("div",{className:"infoContainer"}),d=u.createChild("div",{className:"topLeftInfoContainer"});this.weight=d.createChild("div",{className:"weight"}),this.twoHandedIcon=d.createChild("div",{className:"twoHandedIcon"}),f(this.twoHandedIcon,M("ui.common.twoHandsWeapon"));var h=d.createChild("div",{className:"itemContainer"});this.image=h.createChild("div",{className:"itemImage"}),this.durabilityBar=h.appendChild(new E({className:["durabilityBar","red"]})),this.durabilityBarDescription=new P("div"),f(this.durabilityBar,this.durabilityBarDescription),this.tooltipItemDescription=new T,f(this.image,this.tooltipItemDescription),F(this.image),this.image.on("tap",function(){return t._mountData?B.open("mount"):void(t.item&&window.gui.openContextualMenuAround("item",this,{item:t.item.getItemInstance()||t.item.getItem(),location:t._parentWindow?t._parentWindow.constructor.name:"",enableCertificate:!0}))});var p=[{title:M("ui.common.effects",2),name:"effects"},{title:M("ui.common.conditions"),name:"conditions"},{title:M("ui.common.short.caracteristic"),name:"characteristics"}];this.panelCollection={},this.topRightInfoContainer=u.createChild("div",{className:"topRightInfoContainer"}),this.itemInfoTabs=new N,this.topRightInfoContainer.appendChild(this.itemInfoTabs),this.itemInfoPanels=this.topRightInfoContainer.createChild("div",{className:"itemInfoPanels"});for(var m={colIds:["info"],minRows:isNaN(e.minRows)?q:e.minRows},g=0,_=p.length;g<_;g+=1){var v=p[g];this.panelCollection[v.name]=this.itemInfoPanels.appendChild(new L(m)),this.itemInfoTabs.addTab(v.title,this.panelCollection[v.name])}var y=this.itemActionContainer=this.createChild("div",{className:"actionContainer"}),b=this.actionBtn=y.appendChild(new O({text:M("tablet.itemAction"),className:"actionButton"},n));b.myWindow=this,b=this.bidHouseBtn=y.appendChild(new O({className:["bidHouseActionButton","greenButton"],addIcon:!0,tooltip:s},o)),b.myWindow=this,b=this.bestiaryBtn=y.appendChild(new O({className:["bestiaryButton","greenButton"],addIcon:!0,tooltip:M("ui.common.bestiary")},a)),b.myWindow=this,b=this.setButton=y.appendChild(new O({className:"setButton",tooltip:M("ui.common.set")},c)),b.myWindow=this;var C=e.withCraftBtn?this.image:y;b=this.recipeButton=C.appendChild(new O({className:"recipeButton",tooltip:M("ui.craft.associateReceipts")},r)),b.myWindow=this,e.withBidHouseBtn&&(b=this.image.appendChild(new O({className:["bidHouseButton","greenButton"],addIcon:!0,tooltip:s},o)),b.myWindow=this);var I=this._minMaxSelector=window.gui.windowsContainer.appendChild(new k);I.on("confirm",function(e){window.gui.playerData.inventory.confirmDestroyItem(t.itemInstance,e)}),b=this.destroyButton=y.appendChild(new O({className:"destroyButton",tooltip:M("ui.common.destroyThisItem")},l)),b.myWindow=this,this.itemDescriptionContainer=this.appendChild(new R({className:"itemDescriptionContainer"})),this.categoryText=this.itemDescriptionContainer.content.createChild("div",{className:"category"}),this.descriptionText=this.itemDescriptionContainer.content.createChild("div",{className:"description"}),this.itemInfoTabs.openTab(0),this._listener=new w,this._listener.listenTo(window.gui.playerData.inventory,"itemModified",function(e){t.itemInstance&&t.itemInstance.objectUID===e.objectUID&&t.displayItem(e)}),this.on("destroy",function(){this._listener.stopListening()})}function d(e,t){if(t)for(var i=y.exoticEffects,n=0;n<t.length;n+=1){var o=t[n],s=o.effect;if(s.id!==z){var a=o.description;if(a){var r=o.monsterCount;r&&(a+=r);var l=e.addRow([a]);i[s.id]?l.addClassNames("exotic"):s.bonusType===-1?l.addClassNames("malus"):1===s.bonusType&&l.addClassNames("bonus")}}}}function h(e,t,i){var n=i.addRow([e]);t&&n.addClassNames("malus")}function p(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=n.text;if("string"==typeof o)h(o,n.isMalus,t);else for(var s=0;s<o.length;s++){var a=o[s];h(a,n.isMalus,t)}}}function m(e,t){for(var i=0;i<e.length;i++)t.addRow([e[i]])}i(952);var f=i(248).addTooltip,g=i(202),_=i(496),v=i(400),y=i(592),b=i(248).enableTooltip,w=i(647),M=i(29).getText,T=i(588),C=i(509),I=C.Item,A=C.ItemInstance,S=i(596),E=i(605),x=i(30),L=i(735),N=i(934),O=i(246),D=i(191),R=i(483),P=i(235),B=i(225),k=i(386),F=i(228),z=S.EFFECT_MOUNT,H=812,q=5;D.inherits(u,P),u.prototype._toggleItemActions=function(e){this.showItemActions&&e?(this.itemActionContainer.show(),this.bestiaryBtn.toggleDisplay(!!e.getProperty("dropMonsterIds").length),this.setButton.toggleDisplay(e.getProperty("itemSetId")!==-1),this.destroyButton.toggleDisplay(!!e.isItemInstance)):this.itemActionContainer.hide()},u.prototype._canDisplayDescription=function(){return this.showDescription&&("auto"!==this.showDescription||this.itemDescriptionContainer.rootElement.clientHeight>30)},u.prototype.displayMount=function(e,t){if(e!==this._mountData){t=t||{},this._mountData=e,this.item=null,this.itemInstance=null,this.showTitle=t.hasOwnProperty("showTitle")?t.showTitle:this.showTitle,this.showDescription=t.hasOwnProperty("showDescription")?t.showDescription:this.showDescription,this.weight.setText(M("ui.common.short.weight",0)),this.twoHandedIcon.hide(),this.durabilityBar.hide();var i=this;if(g.preloadImage("gfx/mounts/"+e.model+".png",function(t){e===i._mountData&&i.image.setStyle("backgroundImage",t)}),b(this.image,!1),this._toggleItemActions(null),this._canDisplayDescription()){this.categoryText.setText(M("ui.common.category")+M("ui.common.colon")+M("ui.common.ride"));var n=M("ui.mount.description",e.name,e.level,e.xpRatio);this.descriptionText.setText(n),this.itemDescriptionContainer.show(),this.itemDescriptionContainer.refresh()}else this.itemDescriptionContainer.hide();this._itemTitle.toggleDisplay(!!this.showTitle),this.showTitle&&(x.getData("Mounts",e.model,function(t,n){return t?console.error(t):void(e===i._mountData&&i._name.setText(n.nameId))}),this._level.setText(M("ui.common.short.level")+" "+e.level));for(var o in this.panelCollection)this.panelCollection[o].clearContent();this.itemInfoTabs.toggleTabDisplay(2,!1),v.createEffectInstances(e.effectList,function(t,n){if(t)return console.error(t);if(e===i._mountData){var o=y.sortEffects(n);d(i.panelCollection.effects,o)}})}},u.prototype.displayItem=function(e,t){var i=this;if(!(e instanceof I||e instanceof A))return console.error(new Error("ItemBox: item is not Item nor ItemInstance"));if(t=t||{},this.showTitle=t.hasOwnProperty("showTitle")?t.showTitle:this.showTitle,this.showDescription=t.hasOwnProperty("showDescription")?t.showDescription:this.showDescription,this.itemInstance=e.getItemInstance(),this.item=e,this._mountData=null,e.isItemInstance&&!e.isInitialised)return e.once("initialised",function(){i.item===e&&i.displayItem(e,t)});if(this.itemId=e.getProperty("id"),this.weight.setText(M("ui.common.short.weight",e.getProperty("weight"))),this.twoHandedIcon.toggleDisplay(!!e.getProperty("twoHanded")),this.image.setStyle("backgroundImage",e.getProperty("image")),b(this.image,!0),this.tooltipItemDescription.updateUI(e),this._toggleItemActions(e),this._canDisplayDescription()){var n=C.getItemTypeMap()[e.getProperty("typeId")].nameId;this.categoryText.setText(M("ui.common.category")+M("ui.common.colon")+n),this.descriptionText.setText(e.getProperty("descriptionId")),this.itemDescriptionContainer.show(),window.setTimeout(function(){i.itemDescriptionContainer.refresh()},0)}else this.itemDescriptionContainer.hide();this._itemTitle.toggleDisplay(!!this.showTitle),this.showTitle&&(this._name.setText(e.getProperty("nameId")),this._level.setText(M("ui.common.short.level")+" "+e.getProperty("level")));for(var o in this.panelCollection)this.panelCollection[o].clearContent();var s=null!==window.gui.playerData.inventory.getGenericItem(this.itemId),a=e.getProperty("hideEffects")&&!s;if(a)this.panelCollection.effects.addRow([M("ui.set.secretBonus")]);else{var r=y.getSortedEffectInstances(e);d(this.panelCollection.effects,r)}p(e.getProperty("conditionsFormatted"),this.panelCollection.conditions),p(e.getProperty("targetConditionsFormatted"),this.panelCollection.conditions),e.getProperty("isWeapon")?(m(e.getProperty("statsFormatted"),this.panelCollection.characteristics),this.itemInfoTabs.toggleTabDisplay(2,!0)):this.itemInfoTabs.toggleTabDisplay(2,!1);var l=this.itemInstance&&this.itemInstance.effectsMap[H];this.durabilityBar.toggleDisplay(!!l),l&&(this.durabilityBar.setValue(l.diceNum/l.value),this.durabilityBarDescription.setText(l.description))},e.exports=u},function(e,t){},function(e,t,i){function n(e){a.call(this,"div",{className:"RewardBoxes"}),e=e||{},this._NB_REWARDS=e.nbRewards||6,this._slotList=[],this._rewardNextSlot=0,this._content=this.createChild("div",{className:"rewardContent"}),this.reset()}i(954);var o=i(834),s=i(233),a=i(235),r=i(191).inherits,l=i(832);r(n,s),e.exports=n,n.prototype.reset=function(){this._slotList=[],this._rewardNextSlot=0,this._content.clearContent();for(var e=0;e<this._NB_REWARDS;e+=1)this._slotList.push(this._content.appendChild(new o))},n.prototype.addItemInstance=function(e){var t=this;if(!(this._rewardNextSlot>=this._NB_REWARDS)){var i=this._slotList[this._rewardNextSlot];i.addClassNames("spinner"),this._rewardNextSlot+=1;var n=new l({itemData:e,quantity:e.quantity});n.on("tap",function(){t.emit("tapSlot",e)}),n.insertBefore(i),i.destroy()}}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"CharactersSpace"}),this._tiles=[],this.createChild("div",{className:"title",text:l("ui.connection.whosGift")});var e=this.createChild("div",{className:"content"});this._scroll=e.appendChild(new r({className:"scroll"})),this._scrollContent=this._scroll.content.createChild("div",{className:"scrollContent"});var t=this.createChild("div",{className:"characterContainer"});this._characterDisplayWebGL=t.appendChild(new c({scale:"fitin",horizontalAlign:"center"})),this._loadingOverlay=t.createChild("div",{className:"loadingOverlay",hidden:!0,text:l("ui.connection.assignGift")})}i(956);var o=i(191).inherits,s=i(235),a=i(957),r=i(483),l=i(29).getText,c=i(415);o(n,s),e.exports=n,n.prototype.update=function(e){function t(){i._deselecteAll(),this.addClassNames("selected"),i.emit("selectTile",this.id),i._characterDisplayWebGL.release(),i._characterDisplayWebGL.setLook(this.entityLook,{boneType:"characters/",skinType:"characters/"})}var i=this;this._scrollContent.clearContent(),this._tiles=[];for(var n=0,o=e.length;n<o;n+=1){var s=e[n],r=this._scrollContent.appendChild(new a(s.id,s.name,s.level,s.entityLook));i._tiles.push(r),r.on("select",t)}this._scroll.refresh(),this._tiles[0]&&t.call(this._tiles[0])},n.prototype._deselecteAll=function(){for(var e=0,t=this._tiles.length;e<t;e+=1){var i=this._tiles[e];i.delClassNames("selected")}},n.prototype.setAssignLoading=function(e){this._loadingOverlay.toggleDisplay(e),this._loadingOverlay.addClassNames("spinner")},n.prototype.reset=function(){this._deselecteAll(),this._characterDisplayWebGL.release()}},function(e,t){},function(e,t,i){function n(e,t,i,n){s.call(this,{className:"CharacterTile",scaleOnPress:!0},function(){o.emit("select")});var o=this;this.id=e,this.entityLook=n;var r=t;this.createChild("div",{className:"name",text:r});var l="("+a("ui.common.level")+" "+i+")";this.createChild("div",{className:"level",text:l})}i(958);var o=i(191).inherits,s=i(246),a=i(29).getText;o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"DeleteCharacterConfirmWindow",title:l("ui.popup.delete"),positionInfo:{left:"c",top:"c",width:p.w,height:p.h},noCloseButton:!0});var e,t,i,n,o=50,m=this,f=this.windowBody,g="";this.once("open",function(){f.createChild("div",{text:l("ui.charSel.secretQuestion"),className:"explications"});var s=function(){window.gui.openConfirmPopup({title:l("ui.popup.warning"),message:l("ui.popup.warnBeforeDelete",n),cb:function(e){e&&window.dofus.sendMessage("CharacterDeletionRequestMessage",{characterId:i,secretAnswerHash:u(i+"~"+g)}),a.close(m.id)}})};t=f.createChild("div",{className:"secretQuestionDiv"}),e=f.appendChild(new c({attr:{maxlength:o,value:""},onEnter:function(){e.blur(),s()}})),e.addClassNames("inputSecretAnswer"),e.on("change",function(e){g=e});var h=f.createChild("div",{className:"buttonContainer"}),p=h.appendChild(new r(l("ui.common.ok")));p.on("tap",s);var _=h.appendChild(new r(l("ui.common.cancel")));_.on("tap",function(){a.close(m.id)}),this.keyboardHeight=.6*d.screenHeight}),this.on("open",function(e){h.disableScroll(!0),e=e||{},i=e.id,n=e.name,e.secretQuestion||console.error("DeleteCharacterConfirmWindow: missing secretQuestion for characterId",i),t.setText(e.secretQuestion)}),this.on("opened",function(){e.focus()}),this.on("close",function(){e.setValue(""),g="",e.blur(),h.disableScroll(!1)}),h.on("show",function(e){m.setPosition(e)})}i(960);var o=i(191).inherits,s=i(233),a=i(225),r=i(246).DofusButton,l=i(29).getText,c=i(582),u=i(942),d=i(183).dimensions,h=i(482),p={w:380,h:250};o(n,s),e.exports=n,n.prototype.setPosition=function(e){var t=d.screenHeight-e,i={left:"c",top:(t-p.h)/2,width:p.w,height:p.h};a.positionWindow(this.id,i)}},function(e,t){},function(e,t,i){function n(){h.call(this,{className:"characUpdateWindow",title:"Characteristic Update",positionInfo:{top:"c",left:"c",width:410,height:300}}),this.on("open",function(e){var t=p.getWindow("characteristics");t.openState&&(p.arrangeOpeningWindow(this.id,{rightOf:t.id}),this.updateContent(e))}),this.on("close",function(){l.hide()}),this.closeButton.on("tap",function(){u("CANCEL_BUTTON")})}i(962);var o=i(246),s=i(963),a=i(29).getText,r=i(191).inherits,l=i(482),c=i(388),u=i(258).playUiSound,d=i(735),h=i(233),p=i(225),m={vitality:11,wisdom:12,strength:10,intelligence:15,chance:13,agility:14},f=0,g=1;r(n,h),e.exports=n,n.prototype.updateContent=function(e){var t=this,i={basePtsToAssign:e.pointsRemaining,additionalPtsToAssign:e.additionalPtsRemaining,initialLevel:e.initialLevel,initialAdditionalPts:e.initialAdditionalPts,isAdditionalPtsAssignMode:e.isAdditionalPtsAssign,costSteps:e.costSteps};this._charaUpdateModule=new s(i),this._previousCostStep=void 0,this.windowTitle.setText(e.label),this.windowBody.clearContent();var n=a("ui.charaSheet.boostPoints")+a("ui.common.colon"),r=null,l=null,d=this._charaUpdateModule.getPtsToAssign();if(t._charaUpdateModule.canAssignAdditionalPts()){var h=a("tablet.charaSheet.boostAdditionnalPoints")+a("ui.common.colon"),f=this.windowBody.appendChild(new o({
scaleOnPress:!1},function(){t.updateContent({label:e.label,characteristicName:e.characteristicName,additionalPtsRemaining:e.additionalPtsRemaining,pointsRemaining:e.pointsRemaining,initialLevel:e.initialLevel,initialAdditionalPts:e.initialAdditionalPts,isAdditionalPtsAssign:!t._charaUpdateModule.isAdditionalPtsAssignMode(),costSteps:e.costSteps})}));r=f.createChild("div",{className:["points","pointsRemainingLine"]}),r.createChild("span",{text:n}),l=f.createChild("div",{className:["points","additionalPtsRemainingLine"]}),l.createChild("span",{text:h});var g=this._charaUpdateModule.isAdditionalPtsAssignMode();r.toggleClassName("on",!g),l.toggleClassName("on",g)}else r=this.windowBody.createChild("div",{className:"points"}),r.createChild("span",{text:n});r&&(this._pointsRemainingElt=r.createChild("span",{className:"pointsRemaining",text:d.base})),l&&(this._additionalPtsRemainingElt=l.createChild("span",{className:"pointsRemaining",text:d.additional})),this._container=this.windowBody.createChild("div",{className:"containerBlock"});var _=this._container.createChild("div",{className:"additionBlock"});_.appendChild(new o({className:"minusButton",repeatDelay:50,scaleOnPress:!0},function(){t._charaUpdateModule.decrementPts()&&t.displayValues()})),this._pointsLineAdded=new c({className:"pointsInput",minValue:0,maxValue:this._charaUpdateModule.getMaxRemainingPts()}),this._pointsLineAdded.on("change",function(e){t._charaUpdateModule.spendPointsUntil(e),t.displayValues()}),_.appendChild(this._pointsLineAdded),_.appendChild(new o({className:"plusButton",repeatDelay:50,scaleOnPress:!0},function(){t._charaUpdateModule.incrementPts()&&t.displayValues()}));var v=_.createChild("div",{className:"additionLine"});v.createChild("span",{text:"+ "}),this._levelAddedElt=v.createChild("span",{text:0}),v.createChild("span",{text:" "+e.label});var y=_.createChild("div",{className:"totalLine"});this._finalLevelElt=y.createChild("span",{text:this._charaUpdateModule.getInitialLevel()}),y.createChild("span",{text:" "+e.label}),this.createCostLevelTable(),this._container.appendChild(new o({text:a("ui.common.validation"),className:"button"},function(){if(t._charaUpdateModule.getSpentPts()<=0)return u("GEN_BUTTON");u("OK_BUTTON");var i=m[e.characteristicName];window.dofus.sendMessage("StatsUpgradeRequestMessage",{statId:i,boostPoint:t._charaUpdateModule.getSpentPts(),useAdditionnal:t._charaUpdateModule.isAdditionalPtsAssignMode()}),p.close(t.id)})),this.displayValues()},n.prototype.createCostLevelTable=function(){for(var e=["title"],t=["Level"],i=["Cost"],n=this._charaUpdateModule.getCostSteps(),o=0;o<n.length;o++)e.push("l"+o),t.push("> "+n[o][f]),i.push(n[o][g]);this._table=this._container.appendChild(new d({colIds:e,colCount:n.length,headerContent:t})),this._table.addRow(i)},n.prototype.displayValues=function(){var e=this._charaUpdateModule,t=e.getPtsToAssign(),i=e.getSpentPts(),n=e.getCurrentCostStep();if(this._charaUpdateModule.isAdditionalPtsAssignMode()?this._additionalPtsRemainingElt.setText(String(t.additional-i)):this._pointsRemainingElt.setText(String(t.base-i)),this._pointsLineAdded.setValue(i),this._levelAddedElt.setText(String(e.getCharacIncreasePts())),this._finalLevelElt.setText(String(e.getInitialLevel()+e.getCharacIncreasePts())),n!==this._previousCostStep){if(void 0!==this._previousCostStep){var o=this._table.getHeaderCol("l"+this._previousCostStep),s=this._table.getCol(0,"l"+this._previousCostStep);o.delClassNames("selected"),s.delClassNames("selected")}this._previousCostStep=n;var a=this._table.getHeaderCol("l"+n),r=this._table.getCol(0,"l"+n);a.addClassNames("selected"),r.addClassNames("selected")}}},function(e,t){},function(e,t,i){function n(e){e=e||{},this._basePtsToAssign=e.basePtsToAssign||0,this._initialLevel=e.initialLevel||0,this._additionalPtsToAssign=e.additionalPtsToAssign||0,this._initialAdditionalPts=e.initialAdditionalPts||0,this._isAdditionalPtsAssignMode=e.isAdditionalPtsAssignMode||!1,this._costSteps=e.costSteps,this._isAdditionalPtsAssignMode=e.isAdditionalPtsAssignMode||!1,this._canAssignAdditionalPts=!0,(this._additionalPtsToAssign<=0||this._initialAdditionalPts>=s.MAX_ADDITIONNAL_PER_CARAC)&&(this._canAssignAdditionalPts=!1),this._costSteps||(this._costSteps=[],o.error(new Error("CharaUpdateModule: params costSteps is missing"))),this._currentCostStep=0,this._pointsSpent=0,this._addedLevel=0,this._initializeSteps()}var o=i(207).logger,s=i(277),a=0,r=1;e.exports=n,n.prototype._initializeSteps=function(){var e=this.getCostSteps();this._currentCostStep=0;for(var t=0;t<e.length;t++)this.getInitialLevel()>=e[t][a]&&(this._currentCostStep=t)},n.prototype.getPtsToAssign=function(){return{base:this._basePtsToAssign,additional:this._additionalPtsToAssign}},n.prototype.getMaxRemainingPts=function(){return this._isAdditionalPtsAssignMode?this._additionalPtsToAssign:this._basePtsToAssign},n.prototype.canAssignAdditionalPts=function(){return this._canAssignAdditionalPts},n.prototype.isAdditionalPtsAssignMode=function(){return this._isAdditionalPtsAssignMode},n.prototype.getCostSteps=function(){return this._costSteps},n.prototype.getInitialLevel=function(){return this._isAdditionalPtsAssignMode?this._initialAdditionalPts:this._initialLevel},n.prototype.getCurrentCostStep=function(){return this._currentCostStep},n.prototype.getSpentPts=function(){return this._pointsSpent},n.prototype.getCharacIncreasePts=function(){return this._addedLevel},n.prototype.incrementPts=function(){return this._updatePoints(1)},n.prototype.decrementPts=function(){return this._updatePoints(-1)},n.prototype.spendPointsUntil=function(e){var t=this.getCostSteps();if(e-this._pointsSpent>0)for(;this._pointsSpent<e;){var i=t[this._currentCostStep][r];if(this._pointsSpent+i>e)break;if(!this.incrementPts())break}else for(;this._pointsSpent>e&&this.decrementPts(););},n.prototype._updatePoints=function(e){var t=this.getCostSteps(),i=t[this._currentCostStep],n=i[r];if(e>0){if(this._pointsSpent+n>this.getMaxRemainingPts())return!1;if(this._isAdditionalPtsAssignMode&&this.getInitialLevel()+this._addedLevel>=s.MAX_ADDITIONNAL_PER_CARAC)return!1;this._pointsSpent+=n,i.length>2?this._addedLevel+=i[2]:this._addedLevel++;var o=t[this._currentCostStep+1];o&&this.getInitialLevel()+this._addedLevel>=o[a]&&this._currentCostStep++}else{if(!this._pointsSpent)return!1;this.getInitialLevel()+this._addedLevel<=i[a]&&(this._currentCostStep--,i=t[this._currentCostStep],n=i[r]),this._pointsSpent-=n,i.length>2?this._addedLevel-=i[2]:this._addedLevel--}return!0}},function(e,t,i){function n(){function e(){r.close(o.id),l("CLOSE_DOCUMENT")}function t(e){r.openDialog(o.id),a.getData("Documents",e.documentId,function(e,t){return e?(r.close(o.id),console.warn("Documents error",e)):(t.typeId===u&&n.open(t),t.typeId===d&&c.open(t),void l("OPEN_DOCUMENT"))})}s.call(this,{className:"documentWindow",noTitle:!0,noCloseButton:!0,positionInfo:{left:"c",top:"c",width:"90%",height:"90%"}});var n,o=this;window.gui.once("DocumentReadingBeginMessage",function(s){n=i(969),o.windowBody.appendChild(c),o.windowBody.appendChild(n),c.on("close",e),n.on("close",e),window.gui.on("DocumentReadingBeginMessage",t),t(s)})}i(965);var o=i(191).inherits,s=i(233),a=i(30),r=i(225),l=i(258).playUiSound,c=i(966),u=1,d=2;o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"Scroll"}),this.setClassNames("Scroll"),this.btnClose=this.appendChild(new r({className:"btnClose"})),this.lblTitle=this.createChild("div",{className:"lblTitle"}),this.createChild("div",{className:"scrollOrnament"}),this.lblContent=this.createChild("div",{className:"lblContent"}),this.txIllu=this.createChild("div",{className:"scrollImage"}),this._image=null,this._illuUri=null,this._styleSheet=new l,this._hasText=!0;var e=this;this.btnClose.on("tap",function(){e.close()})}function o(e){var t=new RegExp(u).exec(e);return null!==t}var s=i(191).inherits,a=i(967),r=i(246),l=i(968),c=i(202),u=/(<[a-zA-Z]+\s*[^>]*>)+([^<].*?)/gi,d=365;s(n,a),e.exports=new n,n.prototype.open=function(e){if(this._title=e.titleId,this._page=e.contentId,this._image=this._getImageData(this._page),this.toggleClassName("zombieIsland",e.id===d),!this._page)return console.error("Scroll content is empty for document id",e.id),this.close();e.contentCSS&&this._styleSheet.create(this._formatText(e.contentCSS),".Scroll");var t=this;this._preInitData(function(){t.show()})},n.prototype._preInitData=function(e){if(this._hasText=o(this._page),!this._image)return this._initScroll(),e();var t=this;c.preloadImage(this._image.imageId,function(i){return t._image&&(t._image.src=i,t._initScroll()),e()})},n.prototype.close=function(){this.hide(),this.lblTitle.clearContent(),this.lblContent.clearContent(),this._image=null,this.txIllu.setStyle("backgroundImage",""),this._styleSheet.destroy(),a.prototype.close.call(this)},n.prototype._initScroll=function(){this.lblTitle.setHtml(this._title);var e="";e=this._styleSheet?this._formatText(this._page):this._page,this.lblContent.clearContent();var t=!!this._image;!this._hasText&&t?(this.lblContent.hide(),this.txIllu.setStyles({backgroundImage:this._image.src,backgroundPosition:"center center",width:"100%"})):(this.lblContent.show(),this.lblContent.toggleClassName("small",t),this.txIllu.toggleDisplay(t),t&&(e=e.replace(this._image.regExpResult,""),this.txIllu.setStyles({backgroundImage:this._image.src,backgroundPosition:"center top",width:""})),this.lblContent.appendChild(this._formatLinks(e)))}},function(e,t,i){function n(){o.call(this,"div",{hidden:!0}),this._styleSheet=null,this._title=null,this._author=null,this._subTitle=null,this._pages=null}var o=i(235),s=i(679),a=i(191).inherits,r=i(229).events,l=i(252),c=/(.*?)(<img.*?\/?>)/gi,u=/#+/g,d=/<a\shref=['"](.*?)['"]\s*>(.*?)<\/a>/gi,h=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))/g,p="startquest",m="validateobjective",f="map",g="url";a(n,o),e.exports=n,n.prototype._linkHandler=function(e){var t=e.split(",");t[0]===p?(window.dofus.sendMessage("QuestStartRequestMessage",{questId:t[1]}),this.close()):t[0]===m?(window.dofus.sendMessage("QuestObjectiveValidationMessage",{questId:t[1],objectiveId:t[2]}),this.close()):t[0]===f&&window.gui.emit("CompassUpdateMessage",{type:s.COMPASS_TYPE_SIMPLE,worldX:~~t[1],worldY:~~t[2]})},n.prototype.close=function(){this.emit("close")},n.prototype._getImageData=function(e){var t=new RegExp(c),i=t.exec(e);if(!i)return null;for(var n,o=i[2],s=new RegExp(h),a={};null!==(n=s.exec(o));)n.index===s.lastIndex&&s.lastIndex++,a[n[1]]=n[2]||n[3];var r={};r.regExpResult=i[0],r.before=i[1];var l=a.src.replace(u,""),d=l.split(",");return l="swf"===d[0]?"gfx/documents/swf/"+d[1]+".png":"gfx/documents/"+d[1]+"."+d[0],r.imageId=l,r.width=parseInt(a.width,10),r.height=parseInt(a.height,10),r.hspace=parseInt(a.hspace,10),r.align=a.align||"",r},n.prototype._getAllImagesData=function(e){for(var t,i=[],n=new RegExp(c);null!==(t=n.exec(e));)i.push(this._getImageData(t[0]));return i},n.prototype._getAllLinks=function(e){for(var t,i=[],n=new RegExp(d);null!==(t=n.exec(e));)i.push({text:t[2],href:t[1].replace("event:",""),original:t[0]});return i},n.prototype._formatText=function(e){var t=e;return t=t.replace(/\n/g," "),t=t.replace(/\r/g," "),t=t.replace(/\t/g,""),t=t.replace(/<p><\/p>/g,"<br/>")},n.prototype._formatLinks=function(e){function t(e,t,n){n?e.addEventListener(r.end,function(e){l.openUrlInAppBrowser(t),e.preventDefault()}):e.addEventListener(r.end,function(e){i._linkHandler(t),e.preventDefault()})}var i=this,n=new o("div");n.setHtml(e);for(var s=n.rootElement.getElementsByTagName("a"),a=0,c=s.length;a<c;a++){var u=s[a],d=u.href.replace("event:","");d.indexOf(g)!==-1?t(u,d.split(",")[1],!0):(t(u,d),u.href="#")}return n}},function(e,t){function i(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e}function n(e,t,i,n){"insertRule"in e?e.insertRule(t+"{"+i+"}",n):"addRule"in e&&e.addRule(t,i,n)}function o(){this.styleTag=null}var s=/(\.*?[a-z0-9_-]+?)[ ]*{[ ]*(.*?\/?)[ ]*}/gi;e.exports=o,o.prototype.destroy=function(){this.styleTag&&(document.head.removeChild(this.styleTag),this.styleTag=null)},o.prototype.create=function(e,t){this.styleTag||(this.styleTag=i());for(var o,a=this.styleTag.sheet,r=new RegExp(s);null!==(o=r.exec(e));)o.index===r.lastIndex&&r.lastIndex++,t&&("body"===o[1]?o[1]=t:o[1]=t+" "+o[1]),n(a,o[1],o[2],0)}},function(e,t,i){function n(){o.call(this),this.setClassNames("ReadingBook"),this.btnClose=this.appendChild(new r({className:"btnClose"})),this.btnHome=this.appendChild(new r({className:"btnHome"})),this.pageLeft=this.createChild("div",{className:["page","pageLeft"]}),this.pageRight=this.createChild("div",{className:["page","pageRight"]}),this.pageTitle=this.createChild("div",{className:["pageTitle","page","pageRight"]}),this.lblTitle=this.pageTitle.createChild("div",{className:"lblTitle"}),this.lblSubtitle=this.pageTitle.createChild("div",{className:"lblSubtitle"}),this.pageTitle.createChild("div",{className:"bookOrnament"}),this.lblAuthor=this.pageTitle.createChild("div",{className:"lblAuthor"}),this.txDeco={},this.lblPageNumberLeft=this.appendChild(new r({className:["pageNumber","left"]})),this.lblPageNumberRight=this.appendChild(new r({className:["pageNumber","right"]})),this.btnPrevious=this.appendChild(new r({className:["btnNav","previous"]})),this.btnNext=this.appendChild(new r({className:["btnNav","next"]})),this._lastIndex=null,this._currentIndex=null,this._nbPages=null,this._styleSheet=new s;var e=this,t=this.appendChild(new l);this.btnClose.on("tap",function(){e.close()}),this.btnHome.on("tap",function(){e._currentIndex=-1,e._updateButtons(),e._updateBook(),u("BACK_TO_BEGINNING_DOCUMENT")}),this.btnPrevious.on("tap",function(){e._currentIndex-=2,e._updateButtons(),e._updateBook(),u("TURN_PAGE_DOCUMENT_1")}),this.btnNext.on("tap",function(){e._currentIndex+=2,e._updateButtons(),e._updateBook(),u("TURN_PAGE_DOCUMENT_2")}),this.lblPageNumberLeft.on("tap",function(){t.setStyles({left:"15%",right:"initial"}),t.open({min:1,max:e._nbPages+1,placeholder:e._currentIndex+1})}),this.lblPageNumberRight.on("tap",function(){t.setStyles({right:"15%",left:"initial"}),t.open({min:1,max:e._nbPages+1,placeholder:e._currentIndex+2})}),t.on("confirm",function(t){e._selectPage(parseInt(t,10)-2),u("TURN_PAGE_DOCUMENT_3")})}var o=i(967),s=i(968),a=i(191).inherits,r=i(246),l=i(386),c=i(202),u=i(258).playUiSound,d="linkpage",h=840;a(n,o),e.exports=new n,n.prototype.open=function(e){this._title=e.titleId||"",this._author=e.authorId||"",this._subTitle=e.subTitleId||"",e.contentCSS&&this._styleSheet.create(this._formatText(e.contentCSS),".ReadingBook");var t=e.contentId||"";this._pages=t.split("<pagefeed/>"),this._lastIndex=-1,this._currentIndex=-1,this._nbPages=this._pages.length,this._initBook();var i=this._getAllImagesData(e.contentId);this.imageMap={};var n=i.map(function(e){return e.imageId});this.show();var o=this;c.preloadImages(n,function(e){for(var t=0;t<i.length;t++)o.imageMap[i[t].imageId]=e[t];o._selectPage(o._currentIndex)})},n.prototype.close=function(){this._clearPages(),this.hide(),this._styleSheet.destroy(),o.prototype.close.call(this)},n.prototype._clearPages=function(e){e&&"left"!==e||this.pageLeft.clearContent(),e&&"right"!==e||this.pageRight.clearContent()},n.prototype._initBook=function(){this.lblTitle.setHtml(this._title),this.lblSubtitle.setHtml(this._subTitle),this.lblAuthor.setHtml(this._author||"")},n.prototype._updateBook=function(){var e=this._currentIndex===-1;this.pageTitle.toggleDisplay(e),this.pageRight.toggleDisplay(!e),this.lblPageNumberLeft.toggleDisplay(!e),this.lblPageNumberRight.show(),this._clearPages(),e?(this._updatePageLeft(),this.lblPageNumberRight.setText(this._currentIndex+2)):(this._updatePageLeft(),this._updatePageRight()),this._lastIndex=this._currentIndex},n.prototype._updatePageLeft=function(){var e="";e=this._styleSheet&&this._currentIndex!==-1?this._formatText(this._pages[this._currentIndex-1]):this._pages[this._currentIndex-1]||"",this._insertContent(this.pageLeft,e),this.lblPageNumberLeft.setText(this._currentIndex+1)},n.prototype._updatePageRight=function(){if(this._currentIndex<this._nbPages){this.pageRight.isVisible()||this.pageRight.show();var e="";e=this._styleSheet&&this._currentIndex!==-1?this._formatText(this._pages[this._currentIndex]):this._pages[this._currentIndex],this._insertContent(this.pageRight,e),this.lblPageNumberRight.setText(this._currentIndex+2)}else this.pageRight.hide(),this.lblPageNumberRight.setText("")},n.prototype._updateButtons=function(){var e=this._currentIndex===-1,t=this._currentIndex+1>=this._nbPages;this.btnHome.toggleDisplay(!e),this.btnPrevious.toggleDisplay(!e),this.btnNext.toggleDisplay(!t)},n.prototype._selectPage=function(e){this._currentIndex=e%2?e:e+1,this._updateButtons(),this._updateBook()},n.prototype._linkHandler=function(e){if(e.indexOf(d)!==-1){var t=parseInt(e.substr(d.length),10);return this._selectPage(t)}o.prototype._linkHandler.call(this,e)},n.prototype._insertContent=function(e,t){var i=this._getAllImagesData(t);if(i.length){for(var n=0;n<i.length;n++){var o=i[n];o.before&&e.appendChild(this._formatLinks(o.before)),this._addTextureOnPage(e,o),t=t.replace(o.regExpResult,"")}t&&e.appendChild(this._formatLinks(t))}else e.appendChild(this._formatLinks(t))},n.prototype._addTextureOnPage=function(e,t){var i=e.createChild("div",{className:"image"}),n=parseInt(this.getComputedStyle("height"),10),o=t.height/h*n,s={height:o+"px",width:"100%",backgroundImage:this.imageMap[t.imageId]};"center"===t.align&&(s.backgroundPosition=t.align),i.setStyles(s)}},function(e,t,i){function n(e){u.call(this,{title:a("ui.common.inventory"),className:"EquipmentWindow",freeContentDelay:5e3,plusButton:!1,positionInfo:{left:"10%",top:"c",width:636,height:"90%",minHeight:550},openingSound:"OPEN_INVENTORY",closingSound:"CLOSE_INVENTORY"}),this.hasDom=!1,this.isListening=!1,this.drawerNeedsUpdate=!0,this.storageView=e,this.storageView.registerView(this,{manualOpening:!0,enableAveragePrice:!1,enableSlotContext:!1,filters:{quest:!0,preset:!0}}),this.on("open",this._onOpen)}i(971);var o=i(383),s=i(972),a=i(29).getText,r=i(191).inherits,l=i(509),c=o.setDroppable,u=i(233),d=i(225);r(n,u),e.exports=n,n.prototype.freeContent=function(){this.storageView.storageUI.getParent()===this.storageBox&&(this.storageView.unloadContent(),this.storageBox.removeChild(this.storageView.storageUI)),this.storageBox=null,this.drawer.clearCharacter(),this.windowBody.removeChild(this.drawer),this.drawerNeedsUpdate=!0,this.windowBody.clearContent(),this.hasDom=!1},n.prototype._onOpen=function(){this.hasDom||this._createDom(),this.isListening||this._setupEvents(),this.alignWithCharacteristics(),this.storageBox.appendChild(this.storageView.storageUI),this.drawer.resetItem()},n.prototype.alignWithCharacteristics=function(){var e=d.getWindow("characteristics");e.openState&&(this.setStyle("top",e.getStyle("top")),d.arrangeOpeningWindow(this.id,{rightOf:e.id,sameHeight:!0}))},n.prototype.getEquipmentSlotsForTuto=function(){if(this.drawer)return this.drawer.getSlots()},n.prototype._setupEvents=function(){function e(){t.drawer.removePossiblePositionsHighlight()}this.isListening=!0;var t=this,i=window.gui;this.on("opened",function(){this.drawerNeedsUpdate&&(this.drawerNeedsUpdate=!1,this.drawer.updateCharacter(),this.drawer.setEquipment())}),this.on("slot-tap",function(e){var t=e.itemInstance;t&&(this.drawer.displayItem(t),this.emit("itemSelected",t))}),this.on("slot-doubletap",function(e){e.itemInstance.doDefaultAction()}),this.on("slot-dragStart",function(t){var i=t.dbItem.type.possiblePositions;i.length&&this.drawer.highlightPossiblePositions(i),o.once("dragEnd",e)}),this.on("focus",function(){i.shortcutBar.openPanel("item")}),this.drawer.on("equippableHighlighted",function(e){t.emit("equippableHighlighted",e)}),this.drawer.on("itemDropped",function(e,i){t.emit("itemDropped",e,i)}),this.drawer.on("itemSelect",function(){t.storageView.unSelectSlot()})},n.prototype._createDom=function(){this.hasDom=!0,this.storageBox=this.windowBody.createChild("div",{className:"storageBox"}),c(this.storageBox,["characterBox"]),this.storageBox.on("drop",function(e){window.dofus.sendMessage("ObjectSetPositionMessage",{objectUID:e.itemInstance.objectUID,position:l.positions.notEquipped,quantity:1})}),this.drawer=this.windowBody.appendChild(this.drawer||new s)}},function(e,t){},function(e,t,i){function n(){g.call(this,"div",{className:"EquipmentDrawer"}),this.content=this.createChild("div",{className:"drawerContent"}),this._slots={},this._createDom(),this._setupEvents()}function o(){if(this.data)if(this.data.mountLocation)window.dofus.sendMessage("MountToggleRidingRequestMessage");else{if(!this.data.isInitialised)return;window.gui.playerData.inventory.unEquipItem(this.data.objectUID)}}function s(e,t){var i=e.item;if(!i)return!1;var n={foodItems:i.foodItems,foodTypes:i.foodTypes},o=window.gui.playerData.inventory.isPetFood(n,t),s=t.getProperty("typeId")===v;return o||s}function a(e,t){window.dofus.sendMessage("ObjectFeedMessage",{objectUID:e.getProperty("objectUID"),foodUID:t.getProperty("objectUID"),foodQuantity:1})}i(973);var r=i(415),l=i(228),c=i(383),u=i(29).getText,d=i(191).inherits,h=i(951),p=i(509),m=i(832),f=i(202),g=i(235),_=i(252),v=116,y=p.positions.pets,b=p.positions,w={bottom:[b.amulet,b.ringLeft,b.ringRight,b.belt,b.boots,b.mount],left:[b.dofus1,b.dofus2,b.dofus3,b.dofus4,b.dofus5,b.dofus6],right1:[b.cosmeticHat,b.cosmeticWeapon,b.cosmeticShield,b.cosmeticCape,b.cosmeticPets],right2:[b.hat,b.weapon,b.shield,b.cape,b.pets]},M=_.createFifo();d(n,g),e.exports=n,n.prototype._createSlot=function(e,t){function i(e){var t=this.data||{},i=this.position===y,o=t.model;!o&&i&&s(t,e.data)?a(t,e.data):window.gui.playerData.inventory.equipItem(e.data.objectUID,this.position),n.emit("itemDropped",e.data,this.position)}var n=this,r=this._slots[t]=e.appendChild(new m({scaleOnPress:!0}));r.addClassNames("pos"+t),r.position=t,c.setDroppable(r,["characterBox","equipment"],{matchPositionOnDrop:!0}),r.on("drop",i),r.itemUI={},c.setDraggable(r,r.itemUI,"characterBox"),r.on("tap",function(){this.data&&(this.data.mountLocation||this.data.isInitialised)&&(n.displayItem(this.data),n.emit("itemSelect",this.data))}),r.on("doubletap",o)},n.prototype._createDom=function(){function e(e){window.gui.playerData.inventory.equipItem(e.itemInstance.objectUID)}var t=this.content.createChild("div",{className:"characterBox"}),i={};i.left=t.createChild("div",{className:"leftSlotBox"});var n=t.createChild("div",{className:"rightContainer"}),o=n.createChild("div",{className:"topBox"}),s=this._character=o.appendChild(new r({scale:"fitin",horizontalAlign:"center"})),a=o.createChild("div",{className:"rightBoxes"});c.setDroppable(s,["equipment"]),s.on("drop",e);var d=s.createChild("div",{className:"leftButton"});l(d,{repeatDelay:100}),d.on("tap",function(){s.rotateCharacter(!1)});var p=s.createChild("div",{className:"rightButton"});l(p,{repeatDelay:100}),p.on("tap",function(){s.rotateCharacter(!0)}),i.right1=a.createChild("div",{className:"rightSlotBox1"}),i.right2=a.createChild("div",{className:"rightSlotBox2"}),i.bottom=n.createChild("div",{className:"bottomSlotBox"});for(var m in w)for(var f=w[m],g=i[m],_=0,v=f.length;_<v;_+=1)this._createSlot(g,f[_]);this._placeHolder=this.content.createChild("div",{className:"itemBoxPlaceHolder",text:u("ui.common.selectItem")}),this._itemBox=this.content.appendChild(new h({showTitle:!0,showItemActions:!0,minRows:7}))},n.prototype._setSlot=function(e,t){var i=this._slots[e];if(i)if(t.mountLocation)i.setData(t),f.preloadImage("gfx/mounts/"+t.model+".png",function(e){i.setImage(e)});else{i.setItem(t),i.itemUI.backgroundImage=i.getImage(),c.enableDrag(i);var n=this._slots[b.weapon],o=this._slots[b.shield],s=n.itemInstance&&n.itemInstance.item;s&&s.twoHanded?o.lock():o.itemInstance||o.unset()}},n.prototype._unsetSlot=function(e){var t=this._slots[e];t&&(t.unset(),c.disableDrag(t))},n.prototype.updateCharacterLook=function(e){var t=this;M.push(function(i){t._character.setLook(e,{riderOnly:!1,boneType:"characters/",skinType:"characters/",keepDirection:!0,keepModels:!0},i)})},n.prototype.updateCharacter=function(){var e=window.gui.playerData.characterBaseInformations;this.updateCharacterLook(e.entityLook);var t=this._character;f.preloadImage("gfx/illusUi/symboles_classe/FichePerso_tx_symboleClasse_frame"+(e.breed-1)+".png",function(e){t.setStyle("backgroundImage",e)})},n.prototype.clearCharacter=function(){this._character.release()},n.prototype._getItemBoxActionButton=function(){return this._itemBox.actionBtn},n.prototype.setEquipment=function(){var e,t=window.gui.playerData,i=t.inventory.equippedItems;for(e in this._slots){var n=i[e];n?this._setSlot(e,n):this._unsetSlot(e)}t.isRiding&&this._setSlot(b.mount,t.equippedMount)},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=t.playerData,n=i.inventory;n.on("itemMoved",function(t,i,n){n===b.notEquipped?e._unsetSlot(i):e._setSlot(n,t)}),n.on("itemAdded",function(t){t.position!==b.notEquipped&&e._setSlot(t.position,t)}),n.on("itemDeleted",function(t,i){var n=e._itemBox.item;n&&n===i&&e.resetItem(),i.position!==b.notEquipped&&e._unsetSlot(i.position)}),n.on("itemModified",function(t){t.position!==b.notEquipped&&e._setSlot(t.position,t)}),n.on("listUpdate",function(){e.setEquipment()}),i.on("lookUpdate",function(t){e.updateCharacterLook(t)}),i.on("mountRiding",function(){i.isRiding?e._setSlot(b.mount,i.equippedMount):e._unsetSlot(b.mount),e.updateCharacter()}),i.on("setMount",function(){i.isRiding&&e._setSlot(b.mount,i.equippedMount)})},n.prototype.displayItem=function(e){this._placeHolder.hide(),this._itemBox.show(),e.mountLocation?this._itemBox.displayMount(e):this._itemBox.displayItem(e)},n.prototype.resetItem=function(){this._placeHolder.show(),this._itemBox.hide()},n.prototype.getSlots=function(){return this._slots},n.prototype.highlightPossiblePositions=function(e){e=e||[];for(var t=0;t<e.length;t+=1){var i=e[t];this._slots[i].addClassNames("selected")}this.emit("equippableHighlighted",e)},n.prototype.removePossiblePositionsHighlight=function(){for(var e in this._slots)this._slots[e].delClassNames("selected")}},function(e,t){},function(e,t,i){function n(){l.call(this,{className:"EstateForSellWindow",title:g("ui.estate.agency"),positionInfo:{top:"c",left:"c",width:"82%",height:"94%",maxHeight:660}});var e=this;this.once("open",function(){e.setupContainer1(),e.setupContainer2(),e.setupContainer3()}),this.on("open",function(){e.resetFilterData()}),this.on("close",function(){e.table.clearContent(),h.close("estateInformation")}),this.setupSocketEvents()}function o(e,t){for(var i={},n={},o=0;o<e.length;o++)i[e[o].modelId]=!0,n[e[o].subAreaId]=!0;d.getDataMap("Houses",Object.keys(i),function(i,o){return i?t(i):void d.getDataMap("SubAreas",Object.keys(n),function(i,n){if(i)return t(i);for(var s=window.gui.databases.Areas,a=[],r=0;r<e.length;r++){var l=e[r],c=n[l.subAreaId],u=o[l.modelId];a.push({type:"house",gfxId:u.gfxId,name:u.nameId,areaName:s[c.areaId].nameId,price:p.kamasToString(l.price),rooms:l.nbRoom,chests:l.nbChest,skillsCount:l.skillListIds.length,subAreaName:c.nameId,ownerName:l.ownerName,ownerConnected:l.ownerConnected,worldX:l.worldX,worldY:l.worldY})}return t(null,a)})})}function s(e,t){for(var i={},n=0;n<e.length;n++)i[e[n].subAreaId]=!0;d.getDataMap("SubAreas",Object.keys(i),function(i,n){if(i)return t(i);for(var o=[],s=window.gui.databases.Areas,a=0;a<e.length;a++){var r=e[a],l=n[r.subAreaId];o.push({type:"paddock",name:g("ui.mount.paddockWithRoom",r.nbObject),areaName:s[l.areaId].nameId,price:p.kamasToString(r.price),mounts:r.nbMount,objects:r.nbObject,subAreaName:l.nameId,ownerName:r.guildOwner?r.guildOwner:"?",worldX:r.worldX,worldY:r.worldY})}return t(null,o)})}function a(){h.open("estateInformation",this.data)}i(975);var r=i(191).inherits,l=i(233),c=i(246).DofusButton,u=i(388),d=i(30),h=i(225),p=i(252),m=i(586),f=i(976),g=i(29).getText,_=i(593);r(n,l),e.exports=n,n.prototype.setupRoomSelector=function(){var e=this,t=4;this.roomSelector.addOption(g("ui.estate.filter.atLeastNbRoom"),0);for(var i=1;i<=t;i++)this.roomSelector.addOption(g("ui.estate.filter.nbRoom",i),i);this.roomSelector.on("change",function(t){e.houseToSellFilter.atLeastNbRoom=parseInt(t,10)})},n.prototype.setupChestSelector=function(){var e=this,t=4;this.chestSelector.addOption(g("ui.estate.filter.atLeastNbChest"),0);for(var i=1;i<=t;i++)this.chestSelector.addOption(g("ui.estate.filter.nbChest",i),i);this.chestSelector.on("change",function(t){e.houseToSellFilter.atLeastNbChest=parseInt(t,10)})},n.prototype.setupMountSelector=function(){var e=this,t=20,i=5;this.mountSelector.addOption(g("ui.estate.filter.atLeastNbMount"),0);for(var n=i;n<=t;n+=i)this.mountSelector.addOption(g("ui.estate.filter.nbMount",n),n);this.mountSelector.on("change",function(t){e.paddockToSellFilter.atLeastNbMount=parseInt(t,10)})},n.prototype.setupBreedingSelector=function(){var e=this,t=20,i=5;this.breedingSelector.addOption(g("ui.estate.filter.atLeastNbMachine"),0);for(var n=i;n<=t;n+=i)this.breedingSelector.addOption(g("ui.estate.filter.nbMachine",n),n);this.breedingSelector.on("change",function(t){e.paddockToSellFilter.atLeastNbMachine=parseInt(t,10)})},n.prototype.setupHousingAreaSelector=function(){var e=this;this.housingAreaSelector.addOption(g("ui.estate.filter.areaRequested"),-1);for(var t=f.getAreasWithHouseOrPaddock("house"),i=0;i<t.length;i++)e.housingAreaSelector.addOption(t[i].nameId,t[i].id);this.housingAreaSelector.on("change",function(t){e.houseToSellFilter.areaId=parseInt(t,10)})},n.prototype.setupPaddockAreaSelector=function(){var e=this;this.paddocksAreaSelector.addOption(g("ui.estate.filter.areaRequested"),-1);for(var t=f.getAreasWithHouseOrPaddock("paddock"),i=0;i<t.length;i++)e.paddocksAreaSelector.addOption(t[i].nameId,t[i].id);this.paddocksAreaSelector.on("change",function(t){e.paddockToSellFilter.areaId=parseInt(t,10)})},n.prototype.setupSkillSelector=function(){var e=this;this.skillSelector.addOption(g("ui.estate.filter.skillRequested"),0),f.getSkillsAvailableInHouse(function(t,i){if(t)return console.error("Failed to retrieve skill list",t);for(var n=0;n<i.length;n++)e.skillSelector.addOption(i[n].nameId,i[n].id)}),this.skillSelector.on("change",function(t){e.houseToSellFilter.skillRequested=parseInt(t,10)})},n.prototype.changeDialogType=function(e){this.dialogType=e,"house"===e?(this.roomSelector.show(),this.chestSelector.show(),this.housingAreaSelector.show(),this.skillSelector.show(),this.mountSelector.hide(),this.breedingSelector.hide(),this.paddocksAreaSelector.hide()):(this.roomSelector.hide(),this.chestSelector.hide(),this.housingAreaSelector.hide(),this.skillSelector.hide(),this.mountSelector.show(),this.breedingSelector.show(),this.paddocksAreaSelector.show())},n.prototype.setupContainer1=function(){var e=this,t=this.windowBody.createChild("div",{className:"container1"});t.createChild("div",{className:["text","inline"],text:g("ui.estate.typeChoice")}),this.propertySelector=t.appendChild(new m({className:"propertySelector"})),this.propertySelector.addOption(g("ui.common.housesWord"),"house"),this.propertySelector.addOption(g("ui.common.mountPark"),"paddock"),this.propertySelector.on("change",function(t){e.changeDialogType(t),e.searchButton.emit("tap")})},n.prototype.setupContainer2=function(){var e=this,t=this.windowBody.createChild("div",{className:["wrapper","container2"]});t.createChild("div",{className:"text",text:g("ui.search.criteria")});var i=t.createChild("div",{className:"priceContainer"});i.createChild("div",{className:["text","inline"],text:g("ui.estate.filter.maxPrice")});var n=i.createChild("div",{className:"inputContainer"});this.priceInput=n.appendChild(new u({minValue:0,title:g("ui.estate.filter.maxPrice")})),n.createChild("div",{className:"kamaUnit",text:g("ui.common.short.kama")});var o=t.createChild("div",{className:"col1"});this.roomSelector=o.appendChild(new m({
className:"roomSelector"})),this.setupRoomSelector(),this.chestSelector=o.appendChild(new m({className:"chestsSelector"})),this.setupChestSelector(),this.mountSelector=o.appendChild(new m({className:"mountsSelector"})),this.setupMountSelector(),this.breedingSelector=o.appendChild(new m({className:"breedingSelector"})),this.setupBreedingSelector(),this.housingAreaSelector=o.appendChild(new m({className:"areaSelector"})),this.setupHousingAreaSelector(),this.paddocksAreaSelector=o.appendChild(new m({className:"areaSelector"})),this.setupPaddockAreaSelector(),this.skillSelector=o.appendChild(new m({className:"skillSelector"})),this.setupSkillSelector(),this.searchButton=t.appendChild(new c(g("ui.search.search"),{className:["searchButton","inline"]})),this.searchButton.on("tap",function(){var t=e.priceInput.getValue();return"house"===e.dialogType?(e.houseToSellFilter.maxPrice=t,window.dofus.sendMessage("HouseToSellFilterMessage",e.houseToSellFilter),void window.dofus.sendMessage("HouseToSellListRequestMessage",{pageIndex:1})):(e.paddockToSellFilter.maxPrice=t,window.dofus.sendMessage("PaddockToSellFilterMessage",e.paddockToSellFilter),void window.dofus.sendMessage("PaddockToSellListRequestMessage",{pageIndex:1}))})},n.prototype.setupContainer3=function(){function e(e){var t=new c("",{className:"info"});return t.data=e.button,t.on("tap",a),t}var t=this,i=this.windowBody.createChild("div",{className:["wrapper","container3"]}),n=[{id:"name",header:g("ui.common.name"),sort:!0},{id:"subarea",header:g("ui.map.subarea"),sort:!0},{id:"price",header:g("ui.common.price"),sort:!0},{id:"button",format:e}],o={clickable:!1};this.table=i.appendChild(new _(n,null,o));var s=i.createChild("div",{className:"navigator"});this.leftButton=s.appendChild(new c("",{className:["leftButton","inline"]})),this.pages=s.createChild("div",{className:["pages","inline"]}),this.rightButton=s.appendChild(new c("",{className:["rightButton","inline"]})),this.leftButton.on("tap",function(){var e={pageIndex:t.currentPageIndex-1};return"house"===t.dialogType?void window.dofus.sendMessage("HouseToSellListRequestMessage",e):void window.dofus.sendMessage("PaddockToSellListRequestMessage",e)}),this.rightButton.on("tap",function(){var e={pageIndex:t.currentPageIndex+1};return"house"===t.dialogType?void window.dofus.sendMessage("HouseToSellListRequestMessage",e):void window.dofus.sendMessage("PaddockToSellListRequestMessage",e)})},n.prototype.updateList=function(e){var t=this;this.table.clearContent();var i="house"===t.dialogType?o:s;i(e,function(e,i){if(e)return console.error("Failed to retrieve data",e);for(var n=[],o=0;o<i.length;o++){var s=i[o];n.push({name:s.name,subarea:s.areaName,price:s.price,button:s})}t.table.addList(n)})},n.prototype.resetFilterData=function(){this.houseToSellFilter={areaId:-1,atLeastNbRoom:0,atLeastNbChest:0,skillRequested:0,maxPrice:0},this.paddockToSellFilter={areaId:-1,atLeastNbMount:0,atLeastNbMachine:0,maxPrice:0},this.roomSelector.setValue(0),this.chestSelector.setValue(0),this.mountSelector.setValue(0),this.breedingSelector.setValue(0),this.housingAreaSelector.setValue(-1),this.paddocksAreaSelector.setValue(-1),this.skillSelector.setValue(0),this.priceInput.setValue(0),window.dofus.sendMessage("HouseToSellFilterMessage",this.houseToSellFilter),window.dofus.sendMessage("PaddockToSellFilterMessage",this.paddockToSellFilter)},n.prototype.updateDisplay=function(e,t){this.currentPageIndex=t.pageIndex,this.currentPageIndex<=1?this.leftButton.disable():this.leftButton.enable(),this.currentPageIndex>=t.totalPage?this.rightButton.disable():this.rightButton.enable(),this.pages.setText(t.pageIndex+"/"+t.totalPage),this.propertySelector.setValue(e),this.changeDialogType(e)},n.prototype.setupSocketEvents=function(){var e=this;window.gui.on("HouseToSellListMessage",function(t){h.openDialog(e.id),e.updateDisplay("house",t),e.updateList(t.houseList)}),window.gui.on("PaddockToSellListMessage",function(t){h.openDialog(e.id),e.updateDisplay("paddock",t),e.updateList(t.paddockList)})}},function(e,t){},function(e,t,i){var n=i(252),o=i(30),s=null,a=null,r=null;e.exports.getAreasWithHouseOrPaddock=function(e){var t="paddock"===e;if(s)return t?a:s;var i=window.gui.databases.Areas;a=[],s=[];for(var o in i){var r=i[o];if(r.containPaddocks||r.containHouses){var l={id:o,nameId:r.nameId};r.containPaddocks&&a.push(l),r.containHouses&&s.push(l)}}return n.sortObjectInArray(a,"nameId"),n.sortObjectInArray(s,"nameId"),t?a:s},e.exports.getSkillsAvailableInHouse=function(e){return r?e(null,r):void o.getAllDataMap("Skills",function(t,i){if(t)return e(t);r=[];for(var o in i){var s=i[o];s.availableInHouse&&r.push({id:s.id,nameId:s.nameId})}return n.sortObjectInArray(r,"nameId"),e(null,r)})}},function(e,t,i){function n(){r.call(this,{className:"EstateInformationWindow",title:a("ui.popup.information"),positionInfo:{top:"c",left:"c",width:580,height:355}});var e=this;this.worldX=0,this.worldY=0,this.once("open",function(){e.setupDom()}),this.on("open",function(t){return t?(e.windowBody.show(),void e.updateData(t)):void e.windowBody.hide()})}i(978);var o=i(191).inherits,s=i(246).DofusButton,a=i(29).getText,r=i(233),l=i(225),c=i(202);o(n,r),e.exports=n,n.prototype.setupDom=function(){var e=this,t=this.windowBody.createChild("div",{className:["container","container1"]}),i=t.createChild("div",{className:"imageContainer"});this.image=i.createChild("div",{className:"image"});var n=t.createChild("div",{className:"houseDetails"});this.name=n.createChild("div",{className:"name"});var o=n.createChild("div",{className:["textContainer","price"]});o.createChild("div",{className:"left",text:a("ui.common.price")}),this.price=o.createChild("div",{className:"right"}),n.createChild("div",{className:"message",text:a("ui.estate.visit")}),this.roomsContainer=n.createChild("div",{className:["textContainer","clear"]}),this.roomsContainer.createChild("div",{className:"left",text:a("ui.estate.nbRoom")}),this.roomCount=this.roomsContainer.createChild("div",{className:"right"}),this.chestContainer=n.createChild("div",{className:"textContainer"}),this.chestContainer.createChild("div",{className:"left",text:a("ui.estate.nbChest")}),this.chestCount=this.chestContainer.createChild("div",{className:"right"}),this.mountsContainer=n.createChild("div",{className:["textContainer","clear"]}),this.mountsContainer.createChild("div",{className:"left",text:a("ui.estate.nbMount")}),this.mountCount=this.mountsContainer.createChild("div",{className:"right"}),this.breedingContainer=n.createChild("div",{className:"textContainer"}),this.breedingContainer.createChild("div",{className:"left",text:a("ui.estate.nbMachine")}),this.breedingCount=this.breedingContainer.createChild("div",{className:"right"}),this.skills=n.createChild("div",{className:"message"});var r=this.windowBody.createChild("div",{className:["container","container2"]}),c=r.createChild("div",{className:"textContainer"});c.createChild("div",{className:["titleText","text"],text:a("ui.common.localisation")}),this.coordinate=c.createChild("div",{className:"text"});var u=c.appendChild(new s("",{className:"positionBtn"}));this.locationName=r.createChild("div",{className:"locationName"});var d=this.windowBody.createChild("div",{className:["container","container3"]}),h=d.createChild("div",{className:"textContainer"});h.createChild("div",{className:["titleText","text"],text:a("ui.common.ownerWord")}),this.ownerName=h.createChild("div",{className:"text"}),this.ownerStatus=h.createChild("div",{className:"text"}),this.chatButton=h.appendChild(new s("",{className:"chatBtn"})),u.on("tap",function(){isNaN(e.worldX)||isNaN(e.worldY)||(window.gui.emit("CompassUpdateMessage",{type:"estate",worldX:e.worldX,worldY:e.worldY,name:e.nameTxt}),l.open("worldMap",{x:e.worldX,y:e.worldY}))}),this.chatButton.on("tap",function(){window.gui.chat.startPrivateMessage(e.ownerName.getText(),!0)})},n.prototype.updateData=function(e){var t=this;if(this.worldX=e.worldX,this.worldY=e.worldY,this.price.setText(e.price),this.coordinate.setText(e.worldX+","+e.worldY),this.ownerName.setText("?"===e.ownerName?a("ui.common.none"):e.ownerName),"?"!==e.ownerName&&e.hasOwnProperty("ownerConnected")){var i=a(e.ownerConnected?"ui.server.state.online":"ui.server.state.offline");this.ownerStatus.setText(" ("+i+")")}else this.ownerStatus.setText("");this.locationName.setText(e.areaName+" ( "+e.subAreaName+" )"),this.chatButton.toggleDisplay("?"!==e.ownerName&&e.ownerConnected);var n="gfx/illusUi/enclos_tx_illuEnclos.png",o="house"===e.type?"gfx/houses/"+e.gfxId+".png":n;if(this.image.setStyle("backgroundImage","none"),c.preloadImage(o,function(e){t.image.setStyle("backgroundImage",e)}),"house"===e.type){this.mountsContainer.hide(),this.breedingContainer.hide(),this.roomsContainer.show(),this.chestContainer.show(),this.nameTxt=e.name,this.name.setText(e.name),this.roomCount.setText(e.rooms),this.chestCount.setText(e.chests);var s;return s=e.skillsCount>0?a("ui.estate.houseSkills",e.skillsCount):a("ui.estate.noSkill"),this.skills.setText(s),void this.skills.show()}this.nameTxt=a("ui.common.mountPark"),this.name.setText(a("ui.common.mountPark")),this.skills.hide(),this.roomsContainer.hide(),this.chestContainer.hide(),this.mountsContainer.show(),this.breedingContainer.show(),this.mountCount.setText(e.mounts),this.breedingCount.setText(e.objects)}},function(e,t){},function(e,t,i){function n(){m.call(this,{className:"FightEndWindow",title:b("ui.fightend.gameResult"),positionInfo:{left:"c",top:"c",width:780,height:E+"%"}});var e=this;this.once("open",function(){function t(e,t){var i=e.outcome,n=[];if(i===v.RESULT_LOST||i===v.RESULT_VICTORY?(n.push("outcome","outcome"+i),t.addClassNames("title")):"dead"===i&&n.push(i),n.length)return new f("div",{className:n})}function i(e){var t=new f("div",{className:"nameBox"});return t.createChild("div",{className:"nameText",text:e.name}),o(e)&&t.createChild("div",{className:"isMeArrow"}),t}function n(e){var t="";return e.showExperienceFightDelta&&(t+=b("ui.fightend.xp")+b("ui.common.colon")+M.intToString(e.experienceFightDelta),e.isIncarnationExperience&&(t+=" ("+b("ui.common.incarnation")+")")),e.showExperienceForGuild&&(t+="\n"+b("ui.common.guild")+b("ui.common.colon")+M.intToString(e.experienceForGuild)),e.showExperienceForMount&&(t+="\n"+b("ui.common.ride")+b("ui.common.colon")+M.intToString(e.experienceForMount)),t}function c(e){var t=o(e),i=e.additional||[];if(i.length&&i[0]){var a=i[0],r=a.experienceFightDelta,c=a.experienceLevelFloor,d=a.experience-c,h=a.experienceNextLevelFloor-c,p=Math.floor(r*(u.BONUS_PACK_XP/100)),m=t&&p>1&&!window.gui.playerData.isSubscriber(),_=Math.max(0,(d-r)/h),v=d/h,y=m?(d+p)/h:0,w=new f("div",{className:"xpBox"}),T=w.appendChild(new g({valueClassNames:["oldXp","gainedXp","extraXp"]}));t?(T.setValues([_,v,y]),y>=1&&T.createChild("div",{className:"reached100"})):T.setValues([_,v]);var C=Math.floor(100*v)+"% ("+M.intToString(d)+" / "+M.intToString(h)+")";l(T,C);var I=w.createChild("div",{className:"underGauge"}),A=I.createChild("div",{className:"xpTextDiv"});if(A.createChild("div",{className:"gainedXpText",text:M.intToString(r)}),m){var S=A.createChild("div",{className:"extraXpDiv"}),E=M.intToString(p),x=b("tablet.shop.xpBonusPoints",E);S.createChild("div",{className:"ifBonusPack",text:" + "+E}),S.createChild("div",{className:"unlockIcon"}),l(w,x),w.on("tap",s),w.getMorePointsMsg=x}else l(A,n(a));var L=a.rerollExperienceMul;if(L>1){I.addClassNames("withXpBonusIcon");var N=I.createChild("div",{className:["xpBonusIcon","bonus"+L]});l(N,b("ui.common.experiencePoint")+" x "+L+"\n\n"+b("ui.information.xpFamilyBonus"))}return w}}function d(e){var t=e.drops||[];if(t.length){for(var i,n,o=[],s={},a=0;a<t.length;a+=1)a%2===0&&(i=t[a],n=t[a+1]||0,o.push(i),s[i]=n);if(o.length){var r=new f("div",{className:["dropRow","spinner"]});return y(o,function(t,i){if(t)return console.warn("Error while getting items",t);if(r.rootElement){i.sort(function(e,t){var i=e.averagePrice*s[e.id],n=t.averagePrice*s[t.id];return n-i});var n,o;for(n=0;n<i.length&&(o=i[n],n!==S);n+=1)r.appendChild(new T({itemData:o,quantity:s[o.id],tooltipOptions:{openOnTap:!0}}));if(i.length>S){var a=r.appendChild(new I({className:"moreButton"},function(){_.getWindow("fightEndRewards").updateContent(e.name,i,s),_.open("fightEndRewards")})),c="";for(n=0;n<i.length;n+=1)o=i[n],c+=s[o.id]+" x "+o.nameId+"\n";l(a,c)}r.delClassNames("spinner")}}),r}}}a={0:b("ui.fightend.losers"),2:b("ui.fightend.winners"),5:b("ui.common.taxCollector")},r={0:b("ui.fightend.loss"),2:b("ui.fightend.victory")},e.summary=e.windowBody.createChild("div",{className:"summary"});var h=e.summary.createChild("div",{className:["summaryBlock","block1"]}),p=e.summary.createChild("div",{className:["summaryBlock","block2"]});e.block3=e.summary.createChild("div",{className:["summaryBlock","block3"]}),e.outcomeSummary=h.createChild("div",{className:"outcomeSummary"});var m=p.createChild("div",{className:"labels"});m.createChild("div",{text:b("ui.fightend.duration")+b("ui.common.colon")}),m.createChild("div",{text:b("ui.fightend.bonus")+b("ui.common.colon")});var A=p.createChild("div",{className:"values"});e.duration=A.createChild("div",{className:"duration"}),e.starCounter=A.appendChild(new w),l(e.starCounter,function(){var t=e.ageBonus||0;return t?b("ui.fightend.bonus")+b("ui.common.colon")+t+"%":b("ui.fightend.noBonus")}),e.table=e.windowBody.appendChild(new C([{id:"icon",format:t},{id:"name",header:b("ui.common.name"),format:i},{id:"level",header:b("ui.common.short.level")},{id:"xp",header:b("ui.fightend.xp"),format:c},{id:"kamas",header:b("ui.common.kamas")},{id:"drops",header:b("ui.fightend.objects"),format:d}],null,{clickable:!1}))}),this.on("open",function(t){e._updateResultList(t.msg,t.fighters),e._resize()}),this.on("close",function(){p.closeNotifications(),e._reset()})}function o(e){return e.id&&e.id===window.gui.playerData.id}function s(){var e=this.getMorePointsMsg,t=new f("div",{className:"getBonusPack"});t.createChild("div",{className:"msg",text:e});var i=t.appendChild(new I({className:["getPackBtn","greenButton"]}));i.createChild("div",{className:"text",text:b("tablet.shop.getBonusPack")}),i.createChild("div",{className:"icon"}),i.on("tap",function(){_.open("market",{tabId:"shop",tabParams:{category:"bonuspack"}})}),p.showClosableNotification(t,this)}i(980);var a,r,l=i(248).addTooltip,c=i(258),u=i(184),d=i(183).dimensions,h=i(191).inherits,p=i(584),m=i(233),f=i(235),g=i(981),_=i(225),v=i(867),y=i(509).getItems,b=i(29).getText,w=i(464),M=i(252),T=i(832),C=i(593),I=i(246),A={0:29099,2:29098},S=5,E=80;h(n,m),e.exports=n,n.prototype.addChallenge=function(e,t,i,n,o,s,a){function r(){var e=[805,815],t=window.gui.playerData.position.subArea,i=t&&t.id,n=e.indexOf(i)!==-1;return a&&n}function c(){d.clearContent(),d.createChild("div",{className:"challengeName",text:i}),d.createChild("div",{className:"challengeDesc",text:n}),d.createChild("div",{className:"challengeLoot",text:b("ui.common.loot")+" +"+o+"%"}),d.createChild("div",{className:"challengeXp",text:b("ui.common.xp")+" +"+s+"%"}),r()&&d.createChild("div",{className:"challengePoints",text:a+" "+b("ui.common.point",a)});var e=d.createChild("div",{className:"challengeStatus"});return t?(e.addClassNames("success"),e.setText(b("ui.fight.challenge.complete"))):(e.addClassNames("fail"),e.setText(b("ui.fight.challenge.failed"))),d}var u=this.block3.createChild("div",{className:["challenge",t?"success":"fail"]});u.setStyle("backgroundImage",e);var d=new f("div",{className:"challengeDetails",name:"challengeDetails"});l(u,c)},n.prototype._updateResultList=function(e,t){var i=M.durationToString(e.duration/1e3),n=" ("+b("ui.fight.turnCount",window.gui.fightManager.getTurnCount()+1)+")";this.duration.setText(i+n),this.ageBonus=e.ageBonus||0,this.starCounter.setValue(e.ageBonus);var o=window.gui.challengeIndicator.iconDetailsListByChallengeId;for(var s in o)this.addChallenge(o[s].iconUrl,o[s].success,o[s].name,o[s].description,o[s].dropBonus,o[s].xpBonus,o[s].points);M.sortObjectInArray(e.results,"outcome",!0);for(var l,u,d,h=[],p=[],m=0;m<e.results.length;m+=1)if(l=e.results[m],u=l.id,d=l.outcome,d!==v.RESULT_DEFENDER_GROUP){if(u===window.gui.playerData.id){this.outcomeSummary.setText(r[d]||"");var f=A[d];if(f&&c.playSound("ui",f),d===v.RESULT_VICTORY){var g=void 0!==e.score&&null!==e.score?e.score:-1;g>-1&&window.gui.openPopup({title:b("ui.common.score"),message:b("tablet.toa.scoreInChat",g)})}}h[d]||(p.push({outcome:d,name:a[d]}),h[d]=!0);var _=t[u];if(_){var y=_.name;p.push({id:l.id,outcome:l.alive?"":"dead",name:y,level:l.level||t[l.id].level,additional:l.additional,kamas:M.intToString(l.rewards.kamas),drops:l.rewards.objects})}}else console.warn("Hardcode loots not handled (skipped)",l.rewards);this.table.addList(p)},n.prototype._resize=function(){var e=this.table,t=e.rows.rootElement.offsetHeight,i=e.header.rootElement.offsetHeight,n=123,o=Math.round(d.windowFullScreenHeight*E/100),s=t+i+n;s=s<o?s:o,_.positionWindow(this.id,{left:"c",top:"c",width:this.position.width,height:s}),e.scroller.refresh();var a=window.device;a&&"iOS"===a.platform&&0===a.version.indexOf("10.")&&(this.hide(),M.forceReflow(this),this.show())},n.prototype._reset=function(){this.block3.clearContent(),this.table.clearContent()}},function(e,t){},function(e,t,i){function n(e){e=e||{},this.isVertical=e.vertical||!1,this.pixelValue=1/p,this.hasTriedToGetPixelValue=!1,this.shouldGetPixelValue=!1,this.mustRecompute=!1,c.call(this,"div",{className:"ProgressBarMultiple",name:e.name}),this.barBg=this.createChild("div",{className:"barBg"}),this.currentValues=[],this.previousValues=[],this.colorBars=[],this.maskSizes=[];for(var t=e.valueClassNames||[""],i=t.length-1;i>=0;i--)this.currentValues[i]=this.previousValues[i]=0,this.colorBars[i]=this._newColorBar(t[i]);e.tooltip&&(this.tooltipText=e.tooltip,r.addTooltip(this,this._tooltipHandler.bind(this))),this.on("destroy",function(){this.tweener&&this.tweener.cancel(),this.colorBars=null})}i(982);var o=i(29).getText,s=i(252),a=i(191).inherits,r=i(248),l=i(227),c=i(235),u=0,d=2,h=4,p=100,m="webkitMaskSize";a(n,c),e.exports=n,n.prototype._newColorBar=function(e){var t=this.createChild("div",{className:"barFill"});return this.isVertical&&t.addClassNames("vertical"),t.createChild("div",{className:["barColor",e]}),t},n.prototype.setValue=function(e,t,i){this.maxValue=t,this._setGaugeLogicalValue(u,e,i),this._computeGaugePhysicalValue(u),this.shouldGetPixelValue?this._tryAndGetPixelValue(this._refresh):this._refresh()},n.prototype._setGaugeLogicalValue=function(e,t,i){this.maxValue?(e===u&&(this.humanValue=t),void 0!==i?t=i:t/=this.maxValue):e===u&&(this.humanValue=Math.round(100*t)),this.currentValues[e]=t},n.prototype._computeGaugePhysicalValue=function(e){var t=this.currentValues[e],i=e?this.currentValues[e-1]:0,n=d*this.pixelValue,o=t>i&&t-i<n,s=t<1&&1-t<n;!o&&!s||this.hasTriedToGetPixelValue||(this.shouldGetPixelValue=!0);var a;if(o){var r=d+(0===i?h:0);a="calc("+Math.round(100*i)+"% + "+r+"px)"}else a=s?"calc(100% - "+(d+h)+"px)":Math.round(100*t)+"%";this.maskSizes[e]=a},n.prototype._tryAndGetPixelValue=function(e){this.shouldGetPixelValue=!1,window.setTimeout(function(t){if(t.colorBars){var i=t.colorBars[0].rootElement,n=t.isVertical?i.offsetHeight:i.offsetWidth;0!==n&&(t.pixelValue=1/n,t.mustRecompute=!0),t.hasTriedToGetPixelValue=!0,e.call(t)}},50,this)},n.prototype._getMaskSizeStyle=function(e){return"0%"===e&&(e="1px"),this.isVertical?"100% "+e:e+" 100%"},n.prototype._setColorBarPos=function(e,t){e.setStyle(m,this._getMaskSizeStyle(t))},n.prototype._tooltipHandler=function(){var e=this.tooltipText+o("ui.common.colon");return this.maxValue?e+this.humanValue+" / "+this.maxValue:e+this.humanValue+"%"},n.prototype.setValues=function(e){for(var t=0;t<this.colorBars.length;t++)this._setGaugeLogicalValue(t,Math.max(Math.min(e[t]||0,1),0)),this._computeGaugePhysicalValue(t);this.shouldGetPixelValue?this._tryAndGetPixelValue(this._refresh):this._refresh()},n.prototype._recompute=function(){for(var e=0;e<this.colorBars.length;e++)this._computeGaugePhysicalValue(e);this.mustRecompute=!1},n.prototype._refresh=function(){this.mustRecompute&&this._recompute();for(var e=0;e<this.colorBars.length;e++)this._setColorBarPos(this.colorBars[e],this.maskSizes[e]),this.previousValues[e]=this.currentValues[e]},n.prototype.setValuesWithAnimation=function(e,t,i){this.animTimeInMs=t;for(var n=0;n<this.colorBars.length;n++)this._setGaugeLogicalValue(n,Math.max(Math.min(e[n]||0,1),0)),this._computeGaugePhysicalValue(n);if(this.shouldGetPixelValue){var o=this;return this._tryAndGetPixelValue(function(){o._recompute(),o._startAnim(i)})}this._startAnim(i)},n.prototype._startAnim=function(e){this.currentAnimBarIndex=0,this.nextAnimFunc=this.nextAnimFunc||this._startNextAnim.bind(this),this.endAnimCb=e,this._startNextAnim()},n.prototype._startNextAnim=function(){if(this.colorBars){var e=this.currentAnimBarIndex;this.currentAnimBarIndex++;var t=this.colorBars[e],i=this.maskSizes[e],n=e===this.currentValues.length-1?this.endAnimCb:this.nextAnimFunc,o=e>=1?this.currentValues[e-1]:0,a=Math.max(this.previousValues[e],o),r=this.currentValues[e],c=this.previousValues[e];this.previousValues[e]=r;var u=~~(Math.abs(r-a)*this.animTimeInMs);if(u<15)return this._setColorBarPos(t,i),n&&n();a!==c&&(this._setColorBarPos(t,Math.round(100*a)+"%"),s.forceReflow(t));var d={};d[m]=this._getMaskSizeStyle(i),this.tweener=l.tween(t,d,{time:u,easing:"linear"},n)}}},function(e,t){},function(e,t,i){function n(){function e(e,t){var i="gfx/heads/SmallHead_"+e.breed+(e.sex?1:0)+".png";t.setStyle("backgroundImage","none"),v.preloadImage(i,function(e){t.rootElement&&t.setStyle("backgroundImage",e)})}function t(e,t){var i="";if(t.teamSide>=0)switch(t.teamSide){case r.ALIGNMENT_NEUTRAL:i+="Neutre";break;case r.ALIGNMENT_ANGEL:i+="Bonta";break;case r.ALIGNMENT_EVIL:i+="Brakmar";break;case r.ALIGNMENT_MERCENARY:i+="Seriane"}else switch(t.teamTypeId){case f.TEAM_TYPE_MONSTER:i+="Monstre";break;case f.TEAM_TYPE_TAXCOLLECTOR:i+="Perco";break;default:i+="Neutre"}i+=0===t.teamId?"G":"D",i="gfx/illusUi/fightersType/spectator_tx_Picto"+i+".png",v.preloadImage(i,function(t){e.rootElement&&e.setStyle("backgroundImage",t)})}function i(){for(var e=U.fightListTable.getRows(),t=0;t<e.length;t+=1)e[t].durationTimeoutId&&clearTimeout(e[t].durationTimeoutId)}function n(e,t){var i=e.getChild("duration");if(!t)return i.setText("-");var o=~~(Date.now()/1e3)-t,s=p.durationToString(o),a=s.split(":"),r=a[0]+":"+a[1];i.setText(r);var l=~~o%60,c=60-l;e.durationTimeoutId=setTimeout(function(){n(e,t)},1e3*(c+1))}function o(e){for(var t=U.fightListTable.getRows(),i=0;i<t.length;i+=1){var n=t[i].fight||{};if(e===n.fightId)return i}}function y(e){var t=o(e);return U.fightListTable.getRow(t)}function b(e,i){var n=e.createChild("div",{className:"nbPlayers"});n.createChild("div",{className:"num",text:i.teamMembersCount});var o=new s("div",{className:"fighterTypeIcon"});0===i.teamId?n.insertAsFirstChild(o):n.appendChild(o),t(o,i)}function w(e,t){var i=new s("div",{className:"relation"});return i.addClassNames(e),a(i,t),i}function M(e){var t=e.fightTeams[0],i=e.fightTeams[1],n="",o=e.fightType,r="";o===u.FIGHT_TYPE_PVP_ARENA?(n+=" fightType1",r+=h("ui.common.koliseum")):o===u.FIGHT_TYPE_CHALLENGE?(n+=" fightType2",r+=h("ui.fight.challenge")):o===u.FIGHT_TYPE_AGRESSION?(n+=" fightType3",r+=h("ui.alert.event.11")):o===u.FIGHT_TYPE_PvT&&(n+=" fightType3",r+=h("ui.spectator.taxcollectorAttack"));var l=("nbPlayersLine"+n).split(" "),c=new s("div",{className:l});b(c,t),b(c,i),r&&a(c,r);var d,p=t.meanLevel*t.teamMembersCount+i.meanLevel*i.teamMembersCount,m=Math.round(p/(t.teamMembersCount+i.teamMembersCount));t.hasGroupMember||i.hasGroupMember?d=w("relation1",h("ui.spectator.isGroup")):t.hasFriend||i.hasFriend?d=w("relation2",h("ui.spectator.isFriend")):(t.hasGuildMember||i.hasGuildMember)&&(d=w("relation3",h("ui.spectator.isGuild")));var f=new s("div",{className:"spectatorLocked",name:"spectatorLocked"});return f.toggleDisplay(e.fightSpectatorLocked),{spectatorLocked:f,nbPlayers:c,level:m,duration:new s("div",{name:"duration"}),friend:d||""}}function T(t,i){var n;i.breed>0&&(n=new s("div",{className:"classIcon"}),e(i,n));var o=i.enrichData.name,a=i.id,r={playerName:o,playerId:a};t.table.addRow({name:o,"class":n||"",level:i.level},r)}function C(e){var t=new s("div",{className:["option","option"+e],hidden:!0}),i="";return e===c.FIGHT_OPTION_SET_TO_PARTY_ONLY?i=h("ui.fight.option.blockJoinerExceptParty"):e===c.FIGHT_OPTION_SET_CLOSED?i=h("ui.fight.option.blockJoiner"):e===c.FIGHT_OPTION_ASK_FOR_HELP&&(i=h("ui.fight.option.help")),i&&a(t,i),t}function I(e,t,i){function n(e){if(!(e.playerId<0)){var t={playerName:e.playerName,playerId:e.playerId};window.gui.openContextualMenu("player",t)}}var o=new s("div",{className:t}),a=o.createChild("div",{className:"colTop"}),r=a.createChild("div",{className:"titleContainer"});r.createChild("div",{className:"title",text:i});var c=r.createChild("div",{className:"gameFightOptions"});o.gameFightOptions={};for(var u=0;u<j.length;u+=1){var d=j[u],p=C(d);c.appendChild(p),o.gameFightOptions[d]=p}o.averageLevelContainer=a.createChild("div",{className:"averageLevelContainer"});var f=h("ui.common.averageLevel")+h("ui.common.colon");return o.averageLevelContainer.createChild("span",{text:f}),o.averageLevel=o.averageLevelContainer.createChild("span",{className:"averageLevel"}),o.table=o.appendChild(new m({colIds:["name","class","level"],colCount:3,highlightable:!0,disableAutoSelect:!0,headerContent:[h("ui.common.name"),h("ui.charcrea.breed"),h("ui.common.short.level")],onRowTap:n})),o.joinBtn=o.appendChild(new l(h("ui.common.join"))),o.joinBtn.on("tap",function(){if(Y&&Y.fightId){var e=Y.fightTeams[o.teamId].leaderId;window.dofus.sendMessage("GameFightJoinRequestMessage",{fightId:Y.fightId,fighterId:e}),_.close(U.id)}}),o.teamId=e,o}function A(e){var t=e.gameFightOptions;for(var i in t)R(e.teamId,i,!1)}function S(){i(),U.fightListTable.clearContent()}function E(){U.col1.table.clearContent(),U.col1.averageLevelContainer.hide(),U.col2.table.clearContent(),U.col2.averageLevelContainer.hide(),A(U.col1),A(U.col2)}function x(){U.col1.joinBtn.disable(),U.col2.joinBtn.disable(),U.buttonSpectate.disable()}function L(){Y=null,S(),E(),x()}function N(e){var t=e.joinBtn;if(!Y)return void t.disable();var i=e.teamId,n=Y.fightTeamsOptions[i]||{},o=n.isClosed,s=(i+1)%2,a=Y.fightTeams[i]||{},r=Y.fightTeams[s]||{},l=o||Y.fightStart||a.teamTypeId===f.TEAM_TYPE_MONSTER||a.teamTypeId===f.TEAM_TYPE_TAXCOLLECTOR&&!a.hasMyTaxCollector||r.teamTypeId===f.TEAM_TYPE_TAXCOLLECTOR&&r.hasMyTaxCollector;l?t.disable():t.enable()}function O(){var e=window.gui.playerData.identification.hasRights;!e&&Y&&Y.fightSpectatorLocked?U.buttonSpectate.disable():U.buttonSpectate.enable()}function D(){N(U.col1),N(U.col2),O()}function R(e,t,i){if(t){var n=U["col"+(e+1)],o=n.gameFightOptions[t];o&&n&&o.toggleDisplay(i)}}function P(e,t,i){if(Y)for(var n in G)if(G[n]===t){var o=Y.fightTeamsOptions[e];o[n]=i;break}}function B(e){var t=o(e.fightId);if(t>=0){var i=U.fightListTable.getRow(t);i.fight.fightSpectatorLocked=e.state;var n=U.fightListTable.getCol(t,"spectatorLocked"),s=n.getChild("spectatorLocked");s.toggleDisplay(e.state)}}function k(e){0===e.option&&B(e),Y&&Y.fightId===e.fightId&&(P(e.teamId,e.option,e.state),R(e.teamId,e.option,e.state),D())}function F(e,t){if(t=t||[],e.table.clearContent(),e.averageLevelContainer.toggleDisplay(!!t.length),A(e),t.length){var i=e.teamId,n=Y.fightTeamsOptions[i];for(var o in n)if(G.hasOwnProperty(o)){var s=G[o],a=n[o];R(i,s,a)}for(var r=0,l=t.length,c=0;c<l;c++){var u=t[c];T(e,u),r+=u.level}e.averageLevel.setText(Math.round(r/l))}}function z(e){e=e||{},F(U.col1,e.attackers),F(U.col2,e.defenders)}function H(e){e=e||{};var t=e.fights||[];if(t.length<1)return void L();i();var s,a,r,l=U.fightListTable.getRows(),c=[];l.forEach(function(e){c.push(e.fight.fightId)});var u=[];for(t.forEach(function(e){u.push(e.fightId)}),s=0;s<c.length;s+=1){var d=c[s];u.indexOf(d)<0&&(r=o(d),U.fightListTable.delRow(r))}for(s=0;s<t.length;s++){var h=t[s],p=M(h);r=o(h.fightId),a=r>=0?U.fightListTable.updateRow(r,p,{fight:h}):U.fightListTable.addRow(p,{fight:h}),n(a,h.fightStart)}if(Y&&Y.fightId){var m=y(Y.fightId);if(m)return void m.tap()}var f=U.fightListTable.getRows()[0];f.tap()}function q(){window.dofus.sendMessage("MapRunningFightDetailsRequestMessage",{fightId:Y.fightId})}function W(){window.dofus.sendMessage("MapRunningFightListRequestMessage")}var U=this;g.call(this,{className:"FightListWindow",title:h("ui.spectator.fightList"),positionInfo:{left:"c",top:"c",width:"680px",height:"96%",maxHeight:630}});var Y,G=d.FIGHT_OPTION_KEY_TO_ENUM,j=d.FIGHT_OPTION_ICON_ID;this.once("open",function(){this.fightListTable=this.windowBody.appendChild(new m({colIds:["spectatorLocked","nbPlayers","level","duration","friend"],colCount:4,highlightable:!0,disableAutoSelect:!0,headerContent:["",h("ui.common.numberOfPlayers"),h("ui.common.level"),h("ui.fightend.duration"),h("ui.common.friends")],onRowTap:function(e){Y=e.fight,q()}})),this.fightListTable.addClassNames("fightListTable");var e=this.windowBody.createChild("div",{className:"colsWrapper"});this.col1=I(0,["colTeam","col1"],h("ui.common.attackers")),this.col2=I(1,["colTeam","col2"],h("ui.common.defenders")),e.appendChild(this.col1),e.appendChild(this.col2),this.buttonSpectate=new l(h("ui.common.tospectate"),{className:"buttonSpectate"}),this.buttonSpectate.on("tap",function(){Y&&Y.fightId&&(window.dofus.sendMessage("GameFightJoinRequestMessage",{fightId:Y.fightId,fighterId:0}),_.close(U.id))}),this.windowBody.appendChild(this.buttonSpectate)}),this.on("open",function(){L(),W()}),this.on("close",function(){window.dofus.sendMessage("StopToListenRunningFightRequestMessage")});var V=window.gui;V.on("MapFightCountMessage",function(){U.isVisible()&&W()}),V.on("MapRunningFightListMessage",H),V.on("MapRunningFightDetailsMessage",function(e){z(e),D()}),V.on("GameRolePlayRemoveChallengeMessage",function(){U.isVisible()&&W()}),V.on("GameFightOptionStateUpdateMessage",function(e){U.isVisible()&&k(e)}),V.playerData.position.on("mapChanged",function(){_.close(U.id)})}i(984);var o=i(191).inherits,s=i(235),a=i(248).addTooltip,r=i(472),l=i(246).DofusButton,c=i(396),u=i(752),d=i(394),h=i(29).getText,p=i(252),m=i(735),f=i(985),g=i(233),_=i(225),v=i(202);o(n,g),e.exports=n},function(e,t){},function(e,t){e.exports={TEAM_TYPE_PLAYER:0,TEAM_TYPE_MONSTER:1,TEAM_TYPE_MUTANT:2,TEAM_TYPE_TAXCOLLECTOR:3,TEAM_TYPE_BAD_PLAYER:4}},function(e,t,i){function n(){a.call(this,{className:"globalWindow",title:c("ui.common.mainMenu"),positionInfo:{left:"c",top:"c",width:300,height:235}}),this.once("open",function(){this._createContent()}),this.on("open",function(){this._buildVersion.setText(window.gui.getBuildVersion()),this._setupCharacterChange()})}i(987);var o=i(191).inherits,s=i(282),a=i(233),r=i(225),l=i(246).DofusButton,c=i(29).getText,u=i(586),d=i(661);o(n,a),e.exports=n,n.prototype._createContent=function(){this.buttonOptions=this.windowBody.appendChild(new l(c("ui.common.options"))),this.buttonOptions.on("tap",function(){r.close("global"),r.open("options")}),this.container=this.windowBody.createChild("div",{className:"container"}),this.multiCharacterSelector=new u({className:"multiCharacterSelector"}),this.container.appendChild(this.multiCharacterSelector),this.multiCharacterSelector.on("change",function(e){s.reconnectByCharId(e),r.close("global")}),this.buttonChangeCharacter=this.container.appendChild(new l(c("ui.common.changeCharacter"),{className:"changeCharacterButton"})),this.buttonChangeCharacter.on("tap",function(){window.gui.openConfirmPopup({title:c("ui.common.confirm"),message:c("ui.common.confirmChangeCharacter"),cb:function(e){e&&(r.close("global"),s.goBackToSelectionOf("character"))}})}),this.buttonDisconnect=this.windowBody.appendChild(new l(c("ui.common.disconnect"))),this.buttonDisconnect.on("tap",function(){window.gui.openConfirmPopup({
title:c("ui.common.confirm"),message:c("ui.common.confirmDisconnect"),cb:function(e){if(e){r.close("global");var t=!window.gui.playerData.isModeratorOrMore();window.dofus.disconnect(),!window.developmentMode&&t&&window.location.reload()}}})}),this.buttonReturnToGame=this.windowBody.appendChild(new l(c("ui.common.returnToGame"))),this.buttonReturnToGame.on("tap",function(){r.close("global")}),this._buildVersion=this.windowBody.createChild("div",{className:"buildVersion"})},n.prototype._setupCharacterChange=function(){var e=d.getCharacterList(),t=window.gui.playerData.isFighting;this.buttonChangeCharacter.setEnable(!t);var i=!t&&e.length>=2;if(this.multiCharacterSelector.setEnable(i),i){var n=window.gui.databases.Breeds;this.multiCharacterSelector.clearContent();for(var o=0;o<e.length;o++){var s=e[o],a=s.name+" ("+n[s.breed].shortNameId+" "+s.level+")";this.multiCharacterSelector.addOption(a,s.id)}var r=!0;this.multiCharacterSelector.select(window.gui.playerData.id,r)}}},function(e,t){},function(e,t,i){function n(){s.call(this,{window:{className:"GrimoireWindow",positionInfo:{top:"c",left:"c+20px",width:"90%",height:"97%",maxWidth:905,maxHeight:620,mustAvoidToolbar:!0}}}),this.addTab("spells",new p,a("ui.grimoire.mySpell")),this.addTab("quests",new h,a("ui.common.quests")),this.addTab("alignment",new r,a("ui.common.alignment")),this.addTab("jobs",new m,a("ui.common.myJobs")),this.addTab("almanax",new l,a("ui.almanax.almanax")),this.addTab("achievements",new c,a("ui.achievement.achievement")),this.addTab("ornaments",new d,a("ui.common.titles")),this.addTab("bestiary",new u,a("ui.common.bestiary")),this.on("open",function(e){this.openTab(e.tabId,e.tabParams,{delayOpenedEvent:!0,forceOpen:!0})})}i(989);var o=i(191).inherits,s=i(990),a=i(29).getText,r=i(993),l=i(995),c=i(997),u=i(1e3),d=i(1004),h=i(1006),p=i(1009),m=i(1011);o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(e){function t(e){i.tabs.emitOnCurrentTab("opened",e)}r.call(this,e.window);var i=this;this.tabs=this.windowBody.appendChild(new c),this.once("open",this._initTabsListeners),this.on("open",o),this.on("opened",function(e){t(e)}),this.on("close",s),this.on("focus",function(){this.tabs.emitOnCurrentTab("focus")}),window.gui.on("disconnect",function(){i._resetTabs(),i._initTabs()})}function o(){var e=this;this._initTabs(),window.gui.uiLocker.on("updated",function(t){if(t.windowId===e.id&&t.tabId)return e.tabs.getTabsMap()[t.tabId]?void e.tabs.toggleTabAvailability(t.tabId,!t.locked):console.error(new Error("Unknown tab id `"+t.tabId+"` in `"+e.id+"` window."))})}function s(){this._resetTabs()}var a=i(191).inherits,r=i(233),l=i(28),c=i(991);a(n,r),e.exports=n,n.prototype.addTab=function(e,t,i){function n(){o.setTitle(i)}if(i=i||"",!e||!t)return console.error("Missing informations to add a tab");var o=this,s=this.windowBody.appendChild(t);s.tabId=e,this.tabs.addTab("",s,e),s.on("open",n)},n.prototype.openTab=function(e,t,i){this.tabs.openTab(e,t,i)},n.prototype._initTabs=function(){if(this.tabs)for(var e in this.tabs.getTabsMap()){var t=window.gui.uiLocker.isTabAvailable(this.id,e);this.tabs.toggleTabAvailability(e,t)}},n.prototype._resetTabs=function(){this.tabs.close()},n.prototype.getOpenedTabId=function(){return this.tabs.getCurrentTabId()},n.prototype._initWindowKPI=function(){},n.prototype._sendWindowKPI=function(){},n.prototype._resetWindowKPI=function(e){return e?void(this._openedTimestampTabs[e]=this._scBalanceWhenOpenTabs[e]=this._hcBalanceWhenOpenTabs[e]=0):this._openedTimestamp=this._scBalanceWhenOpen=this._hcBalanceWhenOpen=0},n.prototype._initTabsListeners=function(){if(this.tabs){var e=this,t=window.gui.playerData;this._openedTimestampTabs={},this._scBalanceWhenOpenTabs={},this._hcBalanceWhenOpenTabs={},this.tabs.tabsOrderIds.forEach(function(i){e.tabs.tabsMap[i].target.on("open",function(){e._openedTimestampTabs[i]=l.now(),e._scBalanceWhenOpenTabs[i]=t.inventory.kamas,e._hcBalanceWhenOpenTabs[i]=t.inventory.goultines}),e.tabs.tabsMap[i].target.on("close",function(){e.prepareKPI(i,e._openedTimestampTabs[i],e._scBalanceWhenOpenTabs[i],e._hcBalanceWhenOpenTabs[i]),e._resetWindowKPI(i)})})}}},function(e,t,i){function n(){s.call(this,{className:"WindowSideTabs"}),this.delClassNames("tabs")}i(992);var o=i(191).inherits,s=i(934);o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"AlignmentWindow",name:"alignment"});var e=this;this._setupEvents(),this.once("opened",function(){e._createDom(),e._updateDisplay(),e.on("open",function(){e._updateDisplay()}),e.on("opened",function(){e.updateCharacter()})}),this.on("closed",function(){this.characterDisplay.release()})}i(994);var o=i(191).inherits,s=i(235),a=i(735),r=i(605),l=i(246).DofusButton,c=i(29).getText,u=i(415),d=i(457),h=i(248).addTooltip;o(n,s),e.exports=n,n.prototype.updateCharacter=function(){var e=window.gui.playerData.characterBaseInformations.entityLook;this.characterDisplay.setLook(e,{riderOnly:!0,direction:d.DIRECTION_SOUTH,animation:"AnimStatique",boneType:"characters/",skinType:"characters/"})},n.prototype._createDom=function(){function e(){return window.gui.playerData.isPvpAggressable()?window.gui.playerData.alignment.alignmentInfos.honor+" / "+window.gui.playerData.alignment.alignmentInfos.honorNextGradeFloor:"0"}var t=this.createChild("div",{className:"leftColumn"}),i=this.rightColumn=this.createChild("div",{className:"rightColumn"}),n=t.createChild("div",{className:"topRow"}),o=n.createChild("div",{className:"thumbnail"});this.alignmentImage=o.createChild("div",{className:"alignmentImage"}),this.characterDisplay=n.appendChild(new u({scale:2,verticalAlign:"top",horizontalAlign:"center"}));var d=new s("div",{className:"alignmentWingsWrapper"});this.characterDisplay.insertAsFirstChild(d),this.alignmentWingsContainer=d.createChild("div",{className:"alignmentWingsContainer"});var p=t.createChild("div",{className:"alignmentInfo"});this.alignmentName=p.createChild("div",{className:"title"}),this.alignmentLevel=p.createChild("div",{className:"level"});var m=t.createChild("div",{className:"pvpBox"});m.createChild("div",{className:"title",text:c("ui.pvp.pvpMode")});var f=this.pvpContainer=m.createChild("div",{className:"pvpContainer"}),g=f.createChild("div",{className:"rankContainer"});g.createChild("div",{className:"rank",text:c("ui.pvp.rank")}),this.alignmentGrade=g.createChild("div",{className:"value"});var _=f.createChild("div",{className:"progress"});_.createChild("div",{className:"text",text:c("ui.pvp.honourPoints")}),this.honorPoints=_.appendChild(new r({className:"yellow"})),h(this.honorPoints,e),f.createChild("div",{className:"text"}),f.appendChild(new a({className:"balance",headerContent:[c("ui.pvp.alignedAreaModificators")],colIds:["modifier"]})),this.pvpButton=m.appendChild(new l(c("ui.pvp.enabled",{className:"pvpButton"}))),this.pvpButton.on("tap",function(){window.dofus.sendMessage("SetEnablePVPRequestMessage",{enable:!window.gui.playerData.isPvpAggressable()})});var v=i.createChild("div",{className:"headerRow"});this.icon=v.createChild("div",{className:["icon","image"]}),this.title=v.createChild("div",{className:"title"}),this.specialisations=i.appendChild(new a({className:"specialisations",headerContent:[c("ui.pvp.allSpecializations")],colIds:["spec","minimumAlignment"]})),i.createChild("div",{className:"arrow"}),i.appendChild(new a({className:"abilities",headerContent:[c("ui.common.feats")],colIds:["ability"]}))},n.prototype._displayPvpInformations=function(){var e=this,t=window.gui.playerData.alignment,i=window.gui.playerData.isPvpAggressable();i?(this.pvpButton.setText(c("ui.pvp.disabled")),this.pvpContainer.delClassNames("disabled"),t.getTopWings(t.alignmentInfos,function(t){e.alignmentWingsContainer.setStyles({backgroundImage:t.backgroundImage,left:t.left,top:t.top,width:t.width,height:t.height})}),this.alignmentGrade.setText(t.getAlignmentGradeString()),this.honorPoints.setValue(t.getHonor())):(this.pvpButton.setText(c("ui.pvp.enabled")),this.pvpContainer.addClassNames("disabled"),this.alignmentWingsContainer.setStyle("backgroundImage","none"),this.alignmentGrade.setText("-"),this.honorPoints.setValue(0))},n.prototype._displaySpecialisations=function(e){var t=window.gui.playerData.alignment,i=t.alignmentInfos;if(this.specialisations.clearContent(),0!==i.alignmentSide)for(var n=0;n<t.alignmentRanks.length;n++){var o=t.alignmentRanks[n];o.orderId===e&&this.specialisations.addRow([o.nameId,o.minimumAlignment])}},n.prototype._updateDisplay=function(){var e=window.gui.playerData.alignment,t=e.alignmentInfos;if(this.characterDisplay){var i=this;0===t.alignmentSide?(this.rightColumn.addClassNames("disabled"),this.pvpButton.hide()):(this.rightColumn.delClassNames("disabled"),this.pvpButton.show()),this._displayPvpInformations();var n=e.getNameId();i.alignmentName.setText(c("ui.common.alignment")+" "+n),e.getRank(function(n,o){return n?console.error("Failed to get alignment rank",n):(i.alignmentLevel.setText(o.nameId+" - "+c("ui.common.level")+" "+t.alignmentValue),i._displaySpecialisations(o.orderId),void e.getOrder(o,function(t,n){return t?console.error("Failed to get AlignmentOrder",t):(i.title.setText(n.nameId),e.getAlignmentImageUrl(function(e){i.alignmentImage.setStyle("backgroundImage",e)}),void e.getOrderImageUrl(n.id,function(e){i.icon.setStyle("backgroundImage",e)}))}))})}},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=window.gui.playerData.alignment;i.on("alignmentChanged",function(){e._updateDisplay()}),t.playerData.on("lookUpdate",function(){e.characterDisplay&&e.updateCharacter()})}},function(e,t){},function(e,t,i){function n(){l.call(this,"div",{className:"AlmanaxWindow",name:"almanax"}),this._calendarDate=-1,this._lastUpdate=0,this._isRefreshPending=!1;var e=window.dofus.connectionManager,t=this;this.on("open",this._refreshIfNeeded),e.on("AlmanachCalendarDateMessage",function(e){t._calendarDate=e.date,t._showAlmanaxNotification(e.date,e._merydeName)})}function o(e){return e&&"false"!==e}i(996);var s=i(191).inherits,a=i(605),r=i(246),l=i(235),c=i(252),u=i(248),d=u.addTooltip,h=u.enableTooltip,p=i(29).getText,m=i(509),f=i(679),g=i(678),_=i(30),v=i(202),y=i(225),b=i(195),w=i(205).formatUrlToCssUrl,M=i(283),T=365,C=954,I=-4,A=-24,S=13344,E=13345;s(n,l),e.exports=n,n.prototype._refreshIfNeeded=function(){var e=this,t=(new Date).getUTCDate();return t===this._lastUpdate?this._updateQuestProgress():void(this._isRefreshPending||(this._isRefreshPending=!0,this.clearContent(),this.addClassNames("spinner"),M.getAlmanax(function(t,i){if(t)return void e._handleError();var n=window.gui.databases.AlmanaxCalendars[e._calendarDate],o=n.npcId;_.getDataArray("Npcs",[o],function(t,n){var s=n&&n[0];t&&(console.error("_refreshIfNeeded for npcId:",o,"date:",e._calendarDate,"error:",t),s={}),e._setDefaultData(i,function(t,i){return t?void console.error("_refreshIfNeeded cannot set default","error:",t):(e._lastUpdate=(new Date).getUTCDate(),e._createContent(),e._updateQuestProgress(),e._updateAlmanaxData(i,s.nameId||""),e.delClassNames("spinner"),void(e._isRefreshPending=!1))})})})))},n.prototype._handleError=function(){this._createRetryButton(),this.delClassNames("spinner"),this._isRefreshPending=!1},n.prototype._createRetryButton=function(){var e=this.createChild("div",{className:"failureBox"});e.createChild("div",{text:p("ui.common.error")+"..."});var t=e.appendChild(new r({className:"greenButton",text:p("tablet.common.retry")})),i=this;t.on("tap",function(){i._refreshIfNeeded()})},n.prototype._createContent=function(){var e=this.createChild("div",{className:"col1"}),t=e.createChild("div",{className:"dateBlock"});this.monthText=t.createChild("div",{className:"monthText"});var i=t.createChild("div",{className:"dayBg"});this.dayNumber=i.createChild("div",{className:"dayNumber"}),this.yearText=t.createChild("div",{className:"yearText"});var n=t.createChild("div",{className:"illusWrapper"});this.astro=n.createChild("div",{className:"smallIllus"}),this.monthGod=n.createChild("div",{className:"smallIllus"});var o=t.createChild("div",{className:"bottomIllusWrapper"});this.bottomIllus=o.createChild("div",{className:"bottomIllus"}),this.linkToCalendar=e.appendChild(g.process('<a href="'+p("ui.almanax.link")+'">'+p("ui.almanax.calendar")+"</a>"));var s,c=this.createChild("div",{className:"col2"});s=c.createChild("div");var u=s.createChild("div",{className:["block","saintBlock"]}),h=u.createChild("div",{className:"saintBg"});this.merydeIllus=h.createChild("div",{className:"saintIllus"}),this.merydeTitle=u.createChild("div",{className:"title"}),this.merydeDesc=u.createChild("div",{className:"description"}),this.instructionText=u.createChild("div",{className:"instructionText"}),s=c.createChild("div");var _=s.createChild("div",{className:["block","bonusBlock"]});_.createChild("div",{className:["smallIllus","bonusIllus"]}),this.bonusTitle=_.createChild("div",{className:"title"}),this.bonusDesc=_.createChild("div",{className:"description"}),s=c.createChild("div");var v=s.createChild("div",{className:["block","questBlock"]}),y=v.createChild("div",{className:"questContent"}),b=y.createChild("div",{className:"dolmanaxBg"}),w=b.createChild("div",{className:"dolmanaxIllus"});m.getItems([S],function(e){return e?console.error(e):void w.setStyle("backgroundImage",m.items[S].image)}),y.createChild("div",{className:"title",text:p("ui.almanax.dolmanaxQuest")}),this.questDesc=y.createChild("div",{className:"description"}),y.appendChild(new r({className:["locateButton","greenButton"],text:p("ui.almanax.localizeSanctuary")},function(){window.gui.emit("CompassUpdateMessage",{type:f.COMPASS_TYPE_SIMPLE,worldX:I,worldY:A})}));var M=y.createChild("div",{className:"progression"});this.questProgressTitle=M.createChild("div",{className:"questProgressTitle"}),this.questProgressBar=M.appendChild(new a({className:"questProgressBar"})),this.astroTooltipTx=new l("div"),d(this.astro,this.astroTooltipTx),this.monthGodTooltipTx=new l("div"),d(this.monthGod,this.monthGodTooltipTx),this.merydeTootipTx=new l("div"),d(this.merydeIllus,this.merydeTootipTx),this.questTooltipTx=new l("div"),d(this.questProgressBar,this.questTooltipTx),d(this.linkToCalendar,p("ui.almanax.goToWebsite"))},n.prototype._setDefaultData=function(e,t){var i={},n=e.event,s=e.zodiac,a=e.month;if(i.event={imageurl:n.image_url,bosstext:n.boss_text||p("ui.almanax.default.boss"),ephemeris:n.ephemeris||p("ui.almanax.default.ephemeris"),bossimageurl:n.boss_image_url},i.zodiac={imageurl:s.image_url,description:s.description||p("ui.almanax.default.zodiac")},i.month={protectorimageurl:a.protector_image_url,protectordesc:a.protector_description||p("ui.almanax.default.protector")},o(i.event.imageurl)&&o(i.month.protectorimageurl)&&o(i.zodiac.imageurl))return t(null,i);var r=["gfx/almanax/jour.jpg","gfx/almanax/protecteur.jpg","gfx/almanax/constellation.jpg"];v.preloadImageUrls(r,function(e){return o(i.event.imageurl)||(i.event.imageurl=e[0]),o(i.month.protectorimageurl)||(i.month.protectorimageurl=e[1]),o(i.zodiac.imageurl)||(i.zodiac.imageurl=e[2]),t(null,i)})},n.prototype._updateAlmanaxData=function(e,t){var i=window.gui.databases.AlmanaxCalendars[this._calendarDate],n=c.getAlmanaxDate();this.dayNumber.setText(n.day),this.monthText.setText(n.monthName),this.yearText.setText(p("ui.common.year",n.year));var o=e.event,s=e.zodiac,a=e.month;o||console.error(new Error("_updateAlmanaxData: event data missing")),s||console.error(new Error("_updateAlmanaxData: zodiac data missing")),a||console.error(new Error("_updateAlmanaxData: month data missing")),s.imageurl||console.error(new Error("_updateAlmanaxData: zodiac image missing")),this.astro.setStyle("backgroundImage",w(s.imageurl)),a.protectorimageurl||console.error(new Error("_updateAlmanaxData: month image missing")),this.monthGod.setStyle("backgroundImage",w(a.protectorimageurl)),o.imageurl||console.error(new Error("_updateAlmanaxData: event image missing")),this.bottomIllus.setStyle("backgroundImage",w(o.imageurl)),this.merydeTitle.setText(p("ui.almanax.dayMeryde",t)),o.ephemeris||console.error(new Error("_updateAlmanaxData: event ephemeris missing")),this.merydeDesc.setText(o.ephemeris),this.instructionText.setText(p("ui.almanax.offeringTo",t)),this.bonusTitle.setText(p("ui.almanax.dayBonus")+p("ui.common.colon")+i.nameId),this.bonusDesc.setHtml(i.descId),o.bossimageurl||console.error(new Error("_updateAlmanaxData: event bossimageurl missing")),this.merydeIllus.setStyle("backgroundImage",w(o.bossimageurl)),s.description||console.error(new Error("_updateAlmanaxData: zodiac description missing")),this.astroTooltipTx.setText(s.description),h(this.astro,Boolean(s.description)),a.protectordesc||console.error(new Error("_updateAlmanaxData: month protector desc missing")),this.monthGodTooltipTx.setText(a.protectordesc),h(this.monthGod,Boolean(a.protectordesc)),o.bosstext||console.error(new Error("_updateAlmanaxData: event bosstext missing")),this.merydeTootipTx.setText(o.bosstext),h(this.merydeIllus,Boolean(o.bosstext))},n.prototype._updateQuestProgress=function(){if(window.gui.playerData.quests.finished[C])return this.questDesc.setText(p("ui.almanax.dolmanaxQuestDone")),this.questProgressTitle.setText(p("ui.almanax.questDone")),void this.questProgressBar.setValue(1);this.questDesc.setText(p("ui.almanax.dolmanaxQuestDesc")),this.questProgressTitle.setText(p("ui.almanax.questProgress"));var e=window.gui.playerData.inventory.quantityList[E]||0,t=Math.min(e,T);this.questProgressBar.setValue(t/T),this.questTooltipTx.setText(p("ui.almanax.calendarSheetsCollected",t,T))},n.prototype._showAlmanaxNotification=function(e,t){if(b.getValue("almanaxLastNotif")!==e){b.setValue("almanaxLastNotif",e);var i=c.getAlmanaxDate(),n=window.gui.notificationBar;n.newNotification("almanax_"+e,{type:n.notificationType.INVITATION,title:i.day+" "+i.monthName+" "+i.year,text:p("ui.almanax.offeringTo",t),buttons:[{label:p("ui.almanax.almanax"),action:function(){y.open("grimoire",{tabId:"almanax"})}}]})}}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"AchievementsWindow",name:"achievements"});var e=null;this.on("open",function(t){e=t&&t.achievementId?t.achievementId:null});var t=this;this.once("open",function(){this._createDOM(),window.gui.on("AchievementDetailsMessage",function(e){var i=t.achievementsList.getItem(e.achievement.id);i&&i.data&&(i.data.displayDetails(e.achievement.startedObjectives,e.achievement.finishedObjective),t.achievementsList.refresh(),t.achievementsList.scrollToElement(i,0))});var e=window.gui.playerData.achievements;e.on("achievementFinished",function(e){t._updateBarsAndPercentages(e.enrichData.categoryID,e.parentCategoryID,e.id)}),e.on("achievementListUpdated",function(){var i=t._getOrderedCategories(),n=[];i.forEach(function(i){0===i.parentId?(e.getCategoryPercentage(i.id),t._updateBarsAndPercentages(i.id,null)):n.push(i)}),n.forEach(function(e){t._updateBarsAndPercentages(e.id,e.parentId)});var o=t.summary.getChild("mainProgressBar").getChild("progressBar");o.setValue(window.gui.playerData.achievements.getAchievementPercent()/100),t.progressBarTooltip.mainProgressBar.setText(window.gui.playerData.achievements.finishedAchievementsIds.length+" / "+window.gui.playerData.achievements.maximumNumberOfAchievements),t.categoriesList.selectItem("mainProgressBar")})}),this.once("opened",function(){this.categoriesList.selectItem("mainProgressBar")}),this.on("opened",function(){e&&this._activateAchievement(e),this.total.setText(window.gui.playerData.achievements.points.toString()),this._resize()})}i(998);var o=i(191).inherits,s=i(235),a=i(30),r=i(500).SingleSelectionList,l=i(246),c=i(999),u=i(228),d=i(676),h=i(605),p=i(29).getText,m=i(202),f=i(252),g=i(580),_=i(248);o(n,s),e.exports=n,n.prototype._updateBarsAndPercentages=function(e,t,i){var n=window.gui.playerData.achievements,o=null;t?(o=this.categoriesList.getItem(t),o.sublist&&o.sublist.getItem(e).getChild("label").getChild("percentage").setText((100*n.subCategoriesPercentage[e]).toFixed()+"%")):(o=this.categoriesList.getItem(e),t=e),o&&n.categoriesAchievementCount[t]&&o.getChild("label").getChild("percentage").setText((100*n.categoriesPercentage[t]).toFixed()+"%");var s=this.summary.getChild(t).getChild("progressBar");if(s.setValue(n.categoriesTotalPercentage[t]),this.progressBarTooltip[t].setText(n.categoriesTotalCurrentAchievementCount[t]+" / "+n.categoriesTotalAchievementCount[t]),i){var a=this.achievementsList.getItem(i);a&&a.getChild(i).addClassNames("completed")}},n.prototype._resize=function(){var e=this.col2.rootElement.clientWidth,t=Math.round(e/8),i=Math.round(e/12);this.total.setStyles({height:i+"px",fontSize:Math.round(e/26)+"px",lineHeight:i+"px"});for(var n=0;n<this.banners.length;n+=1)this.banners[n].setStyles({height:t+"px"})},n.prototype._displayRightSideContent=function(e){this._cleanRightSideContent(),"mainProgressBar"===e&&(this.achievementsScroll.hide(),this.summary.show())},n.prototype._cleanRightSideContent=function(){this.achievementsScroll.show(),this.noResult.hide(),this.summary.hide(),this.hideUnlockedCheckbox.hide(),this.achievementsList.clearContent()},n.prototype._getOrderedCategories=function(){return window.gui.playerData.achievements.achievementCategories.sort(function(e,t){return e.order-t.order})},n.prototype._createDOM=function(){var e=this;this.col1=this.createChild("div",{className:"col1"}),this.col2=this.createChild("div",{className:"col2"}),this._createCategoryList(),this._createSearchBlock(),this.noResult=this.col2.createChild("div",{className:"noResult",text:p("ui.search.noResult")}),this.noResult.hide(),this._createSummaryContent(),this.achievementsScroll=this.col2.createChild("div",{className:"achievementsScroll"}),this.achievementsList=this.achievementsScroll.appendChild(new r),this.achievementsList.addClassNames("achievementsList"),this.achievementsList.on("selected",function(t){window.dofus.sendMessage("AchievementDetailsRequestMessage",{achievementId:t.id}),t.data.moreContent.show(),e.achievementsList.refresh(),e.achievementsList.scrollToElement(t,0)}),this.achievementsList.on("deselected",function(t){t.data.moreContent.hide(),e.achievementsList.refresh()}),this.hideUnlockedChecked=!1,this.hideUnlockedCheckbox=this.col2.appendChild(new d(p("ui.achievement.hideAchieved"))),this.hideUnlockedCheckbox.on("activate",function(){e.addClassNames("hideUnlocked"),e.achievementsList.refresh(),e.hideUnlockedChecked=!0;var t=!0,i=e.achievementsList.getItems();i.forEach(function(e){t&&!e.data.completedData.isCompleted&&(t=!1)}),t&&(e.noResult.show(),e.noResult.show())}),this.hideUnlockedCheckbox.on("deactivate",function(){e.delClassNames("hideUnlocked"),e.achievementsList.refresh(),e.hideUnlockedChecked=!1,e.noResult.hide()})},n.prototype._createSearchBlock=function(){var e=this;this.searchBlock=this.col2.createChild("div",{className:"searchBlock"}),this.searchBox=this.searchBlock.appendChild(new g),this.searchBox.on("search",function(){e._search()}),this.searchName=!0,this.searchDescription=!0,this.searchObjective=!0,this.optionButton=this.searchBox.appendChild(new l({className:"optionButton",addIcon:!0},function(){window.gui.openContextualMenu("generic",{title:p("ui.search.criteria"),actions:[{caption:p("ui.common.name"),cb:function(){e.searchName=!e.searchName,e._search()},ticked:e.searchName},{caption:p("ui.common.description"),cb:function(){e.searchDescription=!e.searchDescription,e._search()},ticked:e.searchDescription},{caption:p("ui.grimoire.quest.objectives"),cb:function(){e.searchObjective=!e.searchObjective,e._search()},ticked:e.searchObjective}]})}))},n.prototype._createCategoryList=function(){var e=this,t=this.col1.createChild("div",{className:"scroll"});this.categoriesList=t.appendChild(new r),this.categoriesList.addClassNames("tree"),this.categoriesList.on("selected",function(t){e._displayRightSideContent(t.id),t.sublist&&t.sublist.show(),t.data&&t.data.achievementIds.length>0&&e._addAchievements(t.data.achievementIds),e.achievementsList.refresh(),e.categoriesList.refresh(),e.categoriesList.scrollToElement(t,0),e.searchBox.clear()}),this.categoriesList.on("deselected",function(t){t.sublist&&(t.sublist.deselectAll(),t.sublist.hide()),e.categoriesList.refresh(),t.tappedOnMe?e.categoriesList.selectItem("mainProgressBar"):e._cleanRightSideContent()});var i=new s("div",{className:["label","noPadding"]});i.createChild("div",{className:"icon"}),i.createChild("div",{className:"text",text:p("ui.achievement.synthesis")});var n=this.categoriesList.addItem({id:"mainProgressBar",element:i},{noRefresh:!0});n.addClassNames("mainProgressBar");var o=[],a=this._getOrderedCategories(),l={};a.forEach(function(t){if(0===t.parentId){window.gui.playerData.achievements.getCategoryPercentage(t.id);var i=new s("div",{className:["label","noPadding"],name:"label"});i.createChild("div",{className:["icon",t.icon]}),i.createChild("div",{className:"text",text:t.nameId}),window.gui.playerData.achievements.categoriesAchievementCount[t.id]&&i.createChild("div",{className:"percentage",name:"percentage",text:(100*window.gui.playerData.achievements.categoriesPercentage[t.id]).toFixed()+"%"}),l[t.id]=e.categoriesList.addItem({id:t.id,element:i,data:t})}else o.push(t)}),o.forEach(function(t){var i=new s("div",{className:"label",name:"label"});i.createChild("div",{className:"text",text:t.nameId}),i.createChild("div",{className:"percentage",name:"percentage",text:(100*window.gui.playerData.achievements.subCategoriesPercentage[t.id]).toFixed()+"%"});var n=l[t.parentId]||{},o=n.sublist;o||(n.sublist=n.appendChild(new r({className:["tree","subCategoryList"]})),n.sublist.hide(),n.sublist.on("selected",function(t){e.searchBox.clear(),t.data&&t.data.achievementIds.length>0&&e._addAchievements(t.data.achievementIds)}),n.sublist.on("deselected",function(i){i.tappedOnMe?e.categoriesList.selectItem(t.parentId):e._cleanRightSideContent()}),o=n.sublist),o.addItem({id:t.id,element:i,data:t})})},n.prototype._createSummaryContent=function(){var e=this._getOrderedCategories();this.summary=this.col2.createChild("div",{className:"summary"}),this.total=this.summary.createChild("div",{className:"total"}),this.banners=[],this.progressBarTooltip={},this._addSummaryBar({id:"mainProgressBar",nameId:p("ui.tutorial.progress")});var t="gfx/illusUi/illu_",i=[t+"cat_0.png"],n=this;e.forEach(function(e){0===e.parentId&&(i.push(t+e.icon+".png"),n._addSummaryBar(e))}),m.preloadImages(i,function(e){for(var t=0;t<n.banners.length;t+=1)n.banners[t].setStyle("backgroundImage",e[t])})},n.prototype._addSummaryBar=function(e){var t=this.summary.createChild("div",{className:"summaryBar",name:e.id}),i=t.createChild("div",{className:"banner"});this.banners.push(i),i.createChild("div",{className:"text",text:e.nameId});var n="yellow";switch(e.id){case 15:n="light-orange";break;case 6:n="green";break;case 3:n="blue";break;case 25:n="red";break;case 8:n="aqua";break;case 7:n="pink";break;case 5:n="orange";break;case 9:n="purple"}var o=t.appendChild(new h({className:n,name:"progressBar"}));if("mainProgressBar"===e.id){var a=this.progressBarTooltip[e.id]=new s("div",{text:window.gui.playerData.achievements.finishedAchievementsIds.length+" / "+window.gui.playerData.achievements.maximumNumberOfAchievements});return o.setValue(window.gui.playerData.achievements.getAchievementPercent()/100),_.addTooltip(o,a),t.addClassNames("mainProgressBar")}a=this.progressBarTooltip[e.id]=new s("div",{text:window.gui.playerData.achievements.categoriesTotalCurrentAchievementCount[e.id]+" / "+window.gui.playerData.achievements.categoriesTotalAchievementCount[e.id]}),o.setValue(window.gui.playerData.achievements.categoriesTotalPercentage[e.id]),_.addTooltip(o,a),u(i);var r=this;i.on("tap",function(){r.categoriesList.selectItem(e.id)})},n.prototype._addAchievements=function(e,t){if(e.length>100&&t)return window.gui.openSimplePopup(p("tablet.ui.search.tooManyResults"));var i=this,n=[];a.getDataArray("Achievements",e,function(e,t){if(e)return console.error("Achievements with achievementIds error",e);t.sort(function(e,t){return e.order-t.order}),i._cleanRightSideContent(),i.hideUnlockedCheckbox.show();for(var o=[],s=0;s<t.length;s++)for(var r=t[s].objectiveIds,l=0;l<r.length;l++)o.push(r[l]);n=t,a.getDataMap("AchievementObjectives",o,function(e,t){if(e)return console.error("unable to retrieve data from AchievementObjectives",e);for(var o=[],s=[],a=i.hideUnlockedChecked,r=0,l=n.length;r<l;r++){o.push("gfx/achievements/"+n[r].iconId+".png");var c=i._addAchievement(n[r],t);s.push(c),a&&!c.hasClassName("completed")&&(a=!1)}a&&i.noResult.show(),m.preloadImages(o,function(e){for(var t=0,i=e.length;t<i;t+=1){var n=s[t].icon;n?n.setImage(e[t]):console.warn("Missing icon for achievement #"+t,s[t])}})})})},n.prototype._addAchievement=function(e,t){var i=new c(e,t);return this.achievementsList.addItem({id:e.id,element:i,data:i}),this.openAchievementWithID===e.id&&(this.achievementsList.selectItem(this.openAchievementWithID),this.openAchievementWithID=null),i},n.prototype._activateAchievement=function(e){var t=this;e=parseInt(e,10),a.getObject("Achievements",e,function(i,n){if(i||!n)return console.error("Failed getting Achievements #"+e+" error: "+i+" res: "+n);var o=!1,s=t.categoriesList,a=s.getItem(n.categoryId);if(a)a.isSelected?t.achievementsList.selectItem(e):(t.openAchievementWithID=e,s.selectItem(n.categoryId));else{var r=s.getItems();for(var l in r)if(r.hasOwnProperty(l)){var c=r[l],u=c.sublist;if(u&&(o=u.getItem(n.categoryId))){o.isSelected?t.achievementsList.selectItem(e):(c.isSelected||s.selectItem(c.id),c.sublist.show(),t.openAchievementWithID=e,u.selectItem(n.categoryId));break}}}})},n.prototype._search=function(){var e=this.searchBox.searchInput.getValue();if(null!==e&&""!==e){if(e.length<3)return _.showNotification(p("ui.common.searchFilterTooltip"),this.searchBox);e=f.simplifyString(e);var t=this;this.searchAchievementIds=[];var i=function(e,i){for(var n in e)if(e.hasOwnProperty(n)){var o=e[n],s=i?o.achievementId:o.id;t.searchAchievementIds.indexOf(s)===-1&&t.searchAchievementIds.push(s)}};this.searchName?a.searchDataMap("Achievements",{match:e},function(e,n){return t.hasSearchedName=!0,e?console.error("AchievementsWindow achievements search",e):(i(n),void t._searchResult())}):this.hasSearchedName=!0,this.searchDescription?a.searchDataMap("Achievements",{match:e,matchProp:"descriptionId"},function(e,n){return t.hasSearchedDescription=!0,e?console.error("AchievementsWindow description search",e):(i(n),void t._searchResult())}):this.hasSearchedDescription=!0,this.searchObjective?a.searchDataMap("AchievementObjectives",{match:e},function(e,n){return t.hasSearchedObjectives=!0,e?console.error("AchievementsWindow objectives search",e):(i(n,!0),void t._searchResult())}):this.hasSearchedObjectives=!0,t._searchResult()}},n.prototype._searchResult=function(){this.hasSearchedName&&this.hasSearchedDescription&&this.hasSearchedObjectives&&(this.hasSearchedName=this.hasSearchedDescription=this.hasSearchedObjectives=!1,this.categoriesList.deselectAll(),this.searchAchievementIds.length>0?this._addAchievements(this.searchAchievementIds,!0):(this._cleanRightSideContent(),this.noResult.show()))}},function(e,t){},function(e,t,i){function n(e){return e.nameId+(window.gui.playerData.isModeratorOrMore()?" ("+e.id+")":"")}function o(e){return window.gui.playerData.characterBaseInformations.sex?e.nameFemaleId:e.nameMaleId}function s(){_.open("grimoire",{tabId:"achievements",tabParams:{achievementId:this.achievementID}})}function a(e,t,i,n,o,s){return t.length?void p.getDataMap(e,t,function(e,a){function r(e){if(l.length!==e.length)return s("Achievement: Missing rewards data or images");var t=l.map(function(t,i){var n=c[t]||{};return{url:e[i],quantity:n.quantity,data:n.data}});return s(null,t)}if(e)return s(e);for(var l=[],c={},u=0;u<t.length;u+=1){var d=a[t[u]],h=null!==n?i+"/"+d[n]+".png":i;c[h]={data:d,quantity:o[u]||null},l.push(h)}return f.preloadImages(l,r)}):s(null,[])}function r(e,t){l.call(this,"div",{name:e.id,className:"achievement"}),this.achievement=e,
this.completedData=window.gui.playerData.achievements.completedData(e.id);var i=this;this._hasBeenDestroyed=!1,this.on("destroy",function(){i._hasBeenDestroyed=!0}),window.gui.playerData.achievements.completedData(e.id).isCompleted&&this.addClassNames("completed"),this.completedData.isAccountCompleted&&this.addClassNames("accountCompleted"),this.icon=new c({name:"icon"});var o=this.createChild("div",{className:"infos"});o.appendChild(this.icon);var a=o.createChild("div",{className:"infosGroupRight"}),r=a.createChild("div",{className:"cf"});a.createChild("div",{className:"description",text:e.descriptionId}),r.createChild("div",{className:"title",text:n(e)}),r.createChild("div",{className:"points",text:e.points}),this.moreContent=this.createChild("div",{className:"more",name:"more"}),this.moreContent.hide(),this.progression=this.moreContent.createChild("div",{className:"progression",name:"progression"}),this.progression.hide(),this.objectivesBox=this.moreContent.createChild("div",{className:"objectives",name:"objectives"}),this.objectivesBox.hide(),this.spinner=this.moreContent.createChild("div",{className:"spinner",name:"spinner"}),this.progressionBar=this.progression.appendChild(new u({className:"green",name:"progressBar"})),this.progressionText=this.progression.createChild("div",{className:"text",name:"text"});for(var h=0;h<e.objectiveIds.length;h++){var p=e.objectiveIds[h],f=t[p];if(f&&this.objectivesBox.rootElement){var g=this.objectivesBox.createChild("div",{className:["objective",f.id],name:f.id}),_=0===f.criterion.indexOf("OA"),v=g.createChild("span",{className:"text"});if(v.setHtml(n(f)+(_?" "+d("ui.common.fakeLinkSee"):"")),_){var b=Number(f.criterion.substr(3,f.criterion.length));isNaN(b)?console.warn("Failed parsing achievementId of objective.criterion: "+f.criterion):(g.achievementID=b,m(g),g.on("tap",s))}}}var w=this.moreContent.createChild("div",{className:"rewards",name:"rewards"}),M=w.createChild("div",{className:"rewardTitle"});M.createChild("span",{className:"text",text:d("ui.grimoire.quest.rewards")});var T=M.createChild("div",{className:"warning"});for(y(T,d("ui.achievement.achievedBySomeoneElse"),{}),this.rewardList=w.createChild("div",{className:"rewardList"}),h=0;h<6;h++)this.rewardList.appendChild(new c({name:"icon"+h}));var C=w.createChild("div",{className:"kamasXP"}),I=C.createChild("div",{className:"line"}),A=C.createChild("div",{className:"line"});this._xpValue=I.createChild("div",{className:"text",text:"0"}),I.createChild("div",{className:["icon","xp"]}),this._kamaValue=A.createChild("div",{className:"text",text:"0"}),A.createChild("div",{className:["icon","kamas"]})}var l=i(235),c=i(834),u=i(605),d=i(29).getText,h=i(252),p=i(30),m=i(228),f=i(202),g=i(191).inherits,_=i(225),v=i(509),y=i(248).addTooltip;g(r,l),e.exports=r,r.prototype.displayDetails=function(e,t){for(var i=0;i<e.length;i+=1){var n=e[i];1===n.maxValue?(this.progression.hide(),this.objectivesBox.show()):(this.progression.show(),this.objectivesBox.hide(),this.progressionText.setText(n.value+"/"+n.maxValue),this.progressionBar.setValue(n.value/n.maxValue))}for(i=0;i<t.length;i+=1)if(n=t[i],1===n.maxValue){this.progression.hide(),this.objectivesBox.show();var s=this.objectivesBox.getChild(n.id);s&&s.addClassNames("completed")}else this.progression.show(),this.objectivesBox.hide(),this.progressionText.setText(n.maxValue+"/"+n.maxValue),this.progressionBar.setValue(1);var a=this;this._loadRewards(this.achievement,function(e,t){if(e){if(console.error("Loaded static achievement data error",e),a._hasBeenDestroyed)return;return void a.spinner.hide()}for(var i=[],n=[],s=0,r=t.length;s<r;s+=1)t[s]&&t[s].data&&t[s].data._type&&(n.push(t[s].data.id),i.push(t[s]));for(s=0,r=t.length;s<r;s+=1)t[s]&&t[s].data&&!t[s].data._type&&(n.push(t[s].data.id),i.push(t[s]));v.getItems(n,function(e){if(e){if(console.error("Failed to get items",e),a._hasBeenDestroyed)return;return void a.spinner.hide()}if(!a._hasBeenDestroyed){for(var t=0,s=n.length;t<s;t+=1){var r=n[t],c=v.items[r],u=a.rewardList.getChild("icon"+t),p=i[t];if(!u)return a.spinner.hide(),console.warn("Achievement: Missing icon"+t);if(c&&"Item"===p.data._type){var m=d("ui.item.averageprice")+" : ",f=c.getProperty("averagePrice");m+=f===-1?d("ui.item.averageprice.unavailable"):h.kamasToString(f),u.setContextMenu("item",{item:c})}var g=p.url,_=p.quantity,y=p.data;u.setImage(g),_&&u.setQuantity(_);var b=new l("div");b.createChild("div",{text:y.nameId||o(y)}),m&&"Item"===p.data._type&&b.createChild("div",{text:m}),y.descriptionId&&b.createChild("div",{text:y.descriptionId,className:"details"}),u.setTooltip(b)}a.spinner.hide()}})})},r.prototype._loadRewards=function(e,t){if(!e.rewardIds.length)return t(null,[]);var i=this,n=e.rewardIds;p.getDataMap("AchievementRewards",n,function(o,s){function r(e,i){if(!p)return e?(p=!0,t(e)):(m=m.concat(i),u+=i.length,d+=1,u===c||d===l.length?t(null,m):void 0)}if(o)return t(o);for(var l=["Ornaments","Items","Spells","Titles","Emoticons"],c=0,u=0,d=0,p=!1,m=[],f=window.gui.playerData.achievements.completedData(e.id),g=f.finishedlevel||window.gui.playerData.characterBaseInformations.level,_=e.level,v=0;v<n.length;v+=1){var y=n[v],b=s[y];if(b){var w=b.isLinkedToAccount&&f.isAccountCompleted;if(b.experienceRatio){var M="0";if(!w){var T=window.gui.playerData.achievements.getAchievementExperienceReward(b,_,g);M=h.intToString(T)}i._xpValue.setText(M)}else if(b.kamasRatio){var C="0";if(!w){var I=window.gui.playerData.achievements.getAchievementKamasReward(b,_,g);C=h.intToString(I)}i._kamaValue.setText(C)}if(!(w||g&&(b.levelMin!==-1&&g<b.levelMin||b.levelMax!==-1&&g>b.levelMax))){var A=b.itemsReward,S=b.ornamentsReward,E=b.spellsReward,x=b.titlesReward,L=b.emotesReward;c+=A.length+S.length+E.length+x.length+L.length,a(l[0],S,"gfx/ornaments","iconId",[],r),a(l[1],A,"gfx/items","iconId",b.itemsQuantityReward,r),a(l[2],E,"gfx/spells","iconId",[],r),a(l[3],x,"gfx/illusUi/genericTitleIcon.png",null,[],r),a(l[4],L,"gfx/emotes","id",[],r)}}else console.error("Unable to find reward id "+y+" in AchievementRewards DB")}return 0===c?t(null,[]):void 0})}},function(e,t,i){function n(e,t,i){(void 0===i.min[e]||i.min[e]>t[e])&&(i.min[e]=t[e]),(void 0===i.max[e]||i.max[e]<t[e])&&(i.max[e]=t[e])}function o(e){for(var t={min:{},max:{}},i=["level","lifePoints","actionPoints","movementPoints","earthResistance","airResistance","fireResistance","waterResistance","neutralResistance"],o=i.length,s=0,a=e.length;s<a;s+=1)for(var r=e[s],l=0;l<o;l+=1){var c=i[l];n(c,r,t)}return t}function s(e){for(var t={},i=["percentDropForGrade1","percentDropForGrade2","percentDropForGrade3","percentDropForGrade4","percentDropForGrade5"],n=0,o=i.length;n<o;n+=1){var s=e[i[n]];(void 0===t.min||t.min>s)&&(t.min=s),(void 0===t.max||t.max<s)&&(t.max=s)}return t}function a(){function e(){t.emit("initialized"),t.subAreaList.delClassNames("spinner"),t.raceList.delClassNames("spinner")}h.call(this,"div",{className:"BestiaryWindow",name:"bestiary"});var t=this;this.subAreas={},this.races={},this.monsters={};var i=!1,n=!1;this.selectedSubAreaElement=null,this.updateRequired=!0,this.params={},this._sortByName=w.createStringCompareFunc(),this.once("open",function(){this._createDom(),this._setupEvents(),this._getAreaStaticData(function(){t._createAreaCategories(),i=!0,n&&e()}),this._getMonsterFamilyStaticData(function(){t._createMonsterFamilyCategories(),n=!0,i&&e()})}),this.on("open",function(e){var t=i&&n;return this.subAreaList.toggleClassName("spinner",!t),this.raceList.toggleClassName("spinner",!t),t?void this._onOpen(e):this.once("initialized",this._onOpen.bind(this,e))})}function r(e,t){return e===t?e:e+" "+v("ui.chat.to")+" "+t}function l(e){return Math.round(1e3*e)/1e3}function c(){var e=this.data.nameId,t=v("ui.item.averageprice")+" : ",i=this.itemDataElement.getProperty("averagePrice");t+=i===-1?v("ui.item.averageprice.unavailable"):w.kamasToString(i),e+="\n"+t;var n=window.gui.playerData.characters.mainCharacter.characteristics.prospecting.getTotalStat(),o=n;o<100&&(n=100);var s=l(this.dropInfo.dropMinPercent),a=l(this.dropInfo.dropMaxPercent),c=Math.min(100,l(this.dropInfo.dropMinPercent*n/100)),u=Math.min(100,l(this.dropInfo.dropMaxPercent*n/100));return e+="\n"+v("ui.monster.obtaining"),e+=" ("+o+" "+v("ui.short.prospection")+") : ",e+=r(c,u)+"%",e+="\n"+v("ui.monster.obtaining"),e+=" ("+v("ui.common.base")+") : ",e+=r(s,a)+"%",this.dropInfo.findCeil&&(e+="\n"+v("ui.monster.prospectionThreshold")+" : "+this.dropInfo.findCeil),e}i(1001);var u=i(191).inherits,d=i(934),h=i(235),p=i(30),m=i(500).SingleSelectionList,f=i(509),g=i(832),_=i(1002),v=i(29).getText,y=i(202),b=i(258).playUiSound,w=i(252),M=i(580),T=i(676),C=i(228),I=[],A=[],S=[],E=[];u(a,h),e.exports=a,a.prototype._search=function(e){var t=this;if(""===e)return void(this.searching=!1);var i=w.simplifyString(e);this.searching=!0,this.monsterList.clearContent(),this.monsterList.addClassNames("spinner"),t.errorText.hide(),t.noResultText.hide(),p.searchDataMap("Items",{match:i},function(n,o){if(t.searching){if(n)return t.monsterList.delClassNames("spinner"),t.errorText.show(),console.error("BestiaryWindow items search",n);var s=[];for(var a in o)if(o.hasOwnProperty(a)){var r=o[a];if(r.dropMonsterIds.length)for(var l=0;l<r.dropMonsterIds.length;l++){var c=r.dropMonsterIds[l];s.indexOf(c)===-1&&s.push(c)}}p.searchDataMap("Monsters",{match:i},function(i,n){if(t.searching){if(i)return t.monsterList.delClassNames("spinner"),t.errorText.show(),console.error("BestiaryWindow monsters search",i);for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];s.indexOf(a.id)===-1&&s.push(a.id)}t._showMonsters(s,e)}})}})},a.prototype._showMonsters=function(e,t){var i=this;this.searchBox.setValue(t||""),this.searching=!1,this.errorText.hide(),this.noResultText.hide(),this.monsterList.addClassNames("spinner"),p.getDataArray("Monsters",e,{},function(e,t){if(e)return i._clearAndRemoveSpinner(),i.errorText.show(),i.monsterList.refresh(),console.error("BestiaryWindow showMonsters error",e);t.sort(i._sortByName);var n=t.length;if(0===n)return i._clearAndRemoveSpinner(),i.noResultText.show(),void i.monsterList.refresh();for(var o=[],s=0;s<n;s+=1)o.push("gfx/monsters/"+t[s].id+".png");y.preloadImages(o,function(e){i._clearAndRemoveSpinner();for(var o=0;o<n;o+=1)i.addMonster(t[o],e[o]);i.monsterList.refresh()})})},a.prototype._clearAndRemoveSpinner=function(){this.monsterList.clearContent(),this.monsterList.delClassNames("spinner")},a.prototype.addMonster=function(e,t){var i=new h("div",{className:"infos"}),n=i.createChild("div",{className:"gfx"});n.setStyle("backgroundImage",t);var s=i.createChild("div",{className:"infosGroupRight"}),a=s.createChild("div",{className:"cf"}),r=["name"];e.isBoss&&r.push("boss"),e.isMiniBoss&&r.push("miniBoss"),e.isQuestMonster&&r.push("questMonster");var l=window.gui.playerData.isModeratorOrMore(),c=e.nameId;l&&(c+=" ("+e.id+")"),a.createChild("div",{className:r,text:c});var u=o(e.grades),d=u.min.level,p=u.max.level,m=v("ui.common.short.level")+" "+d;d!==p&&(m+=" "+v("ui.chat.to")+" "+p),a.createChild("div",{className:"level",text:m}),s.appendChild(_.createMapLocation(e.subareas,this.subAreas,e.favoriteSubareaId));var f=this.monsterList.addItem({id:e.id,element:i,data:e},{noRefresh:!0});f.addClassNames("monster"),f.monsterData=e,f.gradeMinMaxInfo=u},a.prototype._onOpen=function(e){var t=this;if(this.params=e||{},this.updateRequired&&this._updateSubAreaList(),e.search)this._search(e.search);else if(e.monsterIds)this._showMonsters(e.monsterIds,e.label);else if(!e.monsterIds){var i=window.gui.playerData.position.area.id,n=window.gui.playerData.position.subAreaId;t.subAreas[n].monsters.length>0&&setTimeout(function(){t._selectSubArea(i,n),t._showMonsters(t.subAreas[n].monsters,"")},0)}},a.prototype._createDom=function(){var e=this,t=this.col1=this.createChild("div",{className:"col1"});this.col2=this.createChild("div",{className:"col2"});var i=this.tabs=t.appendChild(new d);this.searchBlock=this.col2.createChild("div",{className:"searchBlock"}),this.searchBox=this.searchBlock.appendChild(new M),this.searchBox.on("search",function(t){e._search(t)}),window.subAreaList=this.subAreaList=t.appendChild(new m({className:"tree"})),this.subAreaList.on("selected",function(t){t.sublist.show(),b("TAB"),e.subAreaList.refresh(),e.subAreaList.scrollToElement(t)}),this.subAreaList.on("deselected",function(t){t.sublist.hide(),e.subAreaList.refresh()}),window.raceList=this.raceList=t.appendChild(new m({className:"tree"})),this.raceList.on("selected",function(t){t.sublist.show(),b("TAB"),e.raceList.refresh(),e.raceList.scrollToElement(t)}),this.raceList.on("deselected",function(t){t.sublist.hide(),e.raceList.refresh()});var n=i.addTab(v("ui.monster.areas"),this.subAreaList,"areas"),o=i.getTabTarget(n);o.on("opened",function(){e.subAreaList.refresh()}),n=i.addTab(v("ui.monster.families"),this.raceList,"families");var s=i.getTabTarget(n);s.on("opened",function(){e.raceList.refresh()}),i.openFirstTab(),this.monsterList=new m,this.monsterList=this.col2.appendChild(this.monsterList),this.monsterList.on("selected",function(t){t.more?(t.more.show(),this.refresh()):e._createMonsterMoreInfo(t)}),this.monsterList.on("deselected",function(e){e.more.hide(),this.refresh()}),this.noResultText=this.monsterList.createChild("div",{className:"noResultText",text:v("ui.search.noResult")}),this.errorText=this.monsterList.createChild("div",{className:"errorText",text:v("ui.secureMode.error.default")}),e.errorText.hide();var a=this.col2.appendChild(new T(v("ui.monster.showCriteriaDrop")));a.on("change",function(t){e.toggleClassName("showCriteriaDrop",t),e.monsterList.refresh()})},a.prototype._setupEvents=function(){var e=this;window.gui.on("disconnect",function(){e.selectedSubAreaElement=null,e.selectedRaceElement=null,e.updateRequired=!0,e.params={}})},a.prototype._getAreaStaticData=function(e){var t=this;p.getAllDataTable(["Areas","SubAreas"],function(i,n){return i?console.error(i):(I=n.Areas||[],A=n.SubAreas||[],I.sort(t._sortByName),A.sort(t._sortByName),void e())})},a.prototype._getMonsterFamilyStaticData=function(e){var t=this;p.getAllDataTable(["MonsterSuperRaces","MonsterRaces"],function(i,n){return i?console.error(i):(S=n.MonsterSuperRaces||[],E=n.MonsterRaces||[],S.sort(t._sortByName),E.sort(t._sortByName),void e())})},a.prototype._createAreaCategories=function(){for(var e=this,t=0,i=I.length;t<i;t+=1){var n=I[t],o=new h("div",{className:"label"});o.createChild("div",{className:"arrow"}),o.createChild("div",{className:"text",text:n.nameId});var s=e.subAreaList.addItem({id:n.id,element:o},{noRefresh:!0});s.hide(),s.sublist=s.appendChild(new h("div",{className:"sublist"})),s.sublist.hide()}},a.prototype._createMonsterFamilyCategories=function(){for(var e=this,t=0,i=S.length;t<i;t+=1){var n=S[t],o=new h("div",{className:"label"});o.createChild("div",{className:"arrow"}),o.createChild("div",{className:"text",text:n.nameId});var s=e.raceList.addItem({id:n.id,element:o},{noRefresh:!0});s.hide(),s.sublist=s.appendChild(new h("div",{className:"sublist"})),s.sublist.hide()}},a.prototype._updateSubAreaList=function(){this.updateRequired=!1,this._reset(),this._generateSubAreaList(),this._generateRaceList()},a.prototype._reset=function(){this._resetSelectedSubAreaElement(),this._resetSelectedRaceElement()},a.prototype._resetSelectedSubAreaElement=function(){this.selectedSubAreaElement&&(this.selectedSubAreaElement.delClassNames("selected"),this.selectedSubAreaElement=null)},a.prototype._resetSelectedRaceElement=function(){this.selectedRaceElement&&(this.selectedRaceElement.delClassNames("selected"),this.selectedRaceElement=null)},a.prototype._generateSubAreaList=function(){var e=this;A.forEach(function(t){if(e.subAreas[t.id]=t,0!==e.subAreas[t.id].monsters.length&&e.subAreaList.getItem(t.areaId)){var i=new h("div",{className:"label",name:t.id});i.createChild("div",{className:"text",text:t.nameId}),e.subAreaList.getItem(t.areaId).sublist.appendChild(i),C(i),i.on("tap",function(){e._resetSelectedSubAreaElement(),i.addClassNames("selected"),e.selectedSubAreaElement=i,e._showMonsters(e.subAreas[t.id].monsters,"")})}}),A=[],this._showAllListItems(this.subAreaList)},a.prototype._generateRaceList=function(){var e=this;E.forEach(function(t){if(t.monsters.length>0){var i=new h("div",{className:"label",name:t.id});i.createChild("div",{className:"text",text:t.nameId}),e.raceList.getItem(t.superRaceId).sublist.appendChild(i),C(i),i.on("tap",function(){e._resetSelectedRaceElement(),i.addClassNames("selected"),e.selectedRaceElement=i,e._showMonsters(e.races[t.id].monsters,"")}),e.races[t.id]=t}}),E=[],this._showAllListItems(e.raceList)},a.prototype._selectSubArea=function(e,t){if(0===e||e){var i=this.subAreaList.getItem(e);if(i){this.subAreaList.selectItem(e);var n=i.sublist.getChild(t);n.tap(),this.subAreaList.showElement(n)}}},a.prototype._showAllListItems=function(e){for(var t,i,n,o=e.getItems(),s=!0,a=0;a<o.length;a+=1){t=o[a],i=t.sublist.getChildren(),s=!0;for(var r=0;r<i.length;r+=1)n=i[r],s=!1,n.show();s?t.hide():t.show()}e.refresh()},a.prototype._createMonsterMoreInfo=function(e){function t(e,t){var i=s.min[t],n=s.max[t],o=e+": "+i;i!==n&&(o+=" "+v("ui.chat.to")+" "+n),a.createChild("div",{className:"stat",text:o})}function i(e){var t=s.min[e],i=s.max[e],n=t;t!==i&&(n+=" "+v("ui.chat.to")+" "+i),r.createChild("div",{className:["stat","resistance",e],text:n})}e.more=e.createChild("div",{className:"more"});var n=e.more.createChild("div",{className:"cf"}),o=e.monsterData,s=e.gradeMinMaxInfo,a=n.createChild("div",{className:["col","colLeft"]});a.createChild("div",{className:"subtitle",text:v("ui.common.caracteristics")}),t(v("ui.short.lifePoints"),"lifePoints"),t(v("ui.short.actionPoints"),"actionPoints"),t(v("ui.short.movementPoints"),"movementPoints");var r=n.createChild("div",{className:["col","colRight"]});r.createChild("div",{className:"subtitle",text:v("ui.common.resistances")}),i("neutralResistance"),i("earthResistance"),i("fireResistance"),i("waterResistance"),i("airResistance"),this._createMonsterDrops(e,o.drops)},a.prototype._createMonsterDrops=function(e,t){if(0!==t.length){e.more.createChild("div",{className:"subtitle",text:v("ui.common.loot")}),this.monsterList.refresh();var i=t.map(function(e){return e.objectId}),n=this;f.getItems(i,function(o){if(o)return console.error("Failed to get items",o);for(var a=0;a<i.length;a+=1){var r=i[a],l=f.items[r];if(l){var u=new g;e.more.appendChild(u),u.itemDataElement=l;var d=s(t[a]);u.dropInfo={findCeil:t[a].findCeil,dropMinPercent:d.min,dropMaxPercent:d.max},u.setTooltip(c),u.toggleClassName("special",t[a].hasCriteria),u.setItem(l),u.setContextMenu("item",{item:l}),u.dropInfo.dropMinPercent<2?u.addClassNames("rareDrop"):u.dropInfo.dropMinPercent<10&&u.addClassNames("okDrop")}else console.warn("monster",e.monsterData.id,"contains invalid drop item in pos ",a)}n.monsterList.refresh()})}}},function(e,t){},function(e,t,i){function n(e,t,i){for(var n=window.gui.databases.SuperAreas,o=window.gui.databases.Areas,s=window.gui.playerData.position.worldmapId,r=[],l=0,c=0;c<e.length;c++){var u=t[e[c]],m=o[u.areaId],f=n[m.superAreaId].worldmapId;f===s?r.push(e[c]):l++}var g=r.length>0?r.length:l,_="";g&&(_=a("ui.monster.presentInAreas",g),_=_[0].toUpperCase()+_.substr(1));var v=o[p].nameId;if(l){var y;s===h?y=r.length>0?"tablet.area.andOutside":"tablet.area.outside":s===d&&(y=r.length>0?"tablet.area.andInside":"tablet.area.inside"),y&&(_+=" ("+a(y,v)+")")}if(i&&r.indexOf(i)!==-1){u=t[i];var b=window.gui.databases.Areas[u.areaId].nameId,w=u.nameId;u.nameId.indexOf(b)===-1&&b!==v&&(w+=" ("+b+")"),_+=e.length>=2?" - "+a("tablet.area.favorite")+a("ui.common.colon")+w:a("ui.common.colon")+w}else i=null;return{text:_,subareasInMyWorld:r,countOutsideMyWorld:l,favorite:i,centerOn:"nearest"}}function o(e){s.call(this,{className:"mapLocationBtn"}),this.type=e.type,this.subareaId=e.subareaId,this.subareaIds=e.subareaIds,this.favorite=e.favorite,this.centerOn=e.centerOn,this.x=e.x,this.y=e.y,this.on("tap",this._tapHandler)}i(1003);var s=i(246),a=i(29).getText,r=i(191).inherits,l=i(225),c=i(235),u=i(679),d=1,h=2,p=45;t.createMapLocation=function(e,t,i){var s=new c("div",{className:"mapLocation"}),a=n(e,t,i);return a.subareasInMyWorld&&a.subareasInMyWorld.length?(s.createChild("div",{text:a.text,className:"mapLocationText"}),s.appendChild(new o({subareaIds:a.subareasInMyWorld,favorite:a.favorite,centerOn:a.centerOn})),s):(s.setText(a.text),s)},r(o,s),t.MapLocationButton=o,o.prototype._tapHandler=function(){"zaap"===this.type&&window.gui.emit("CompassUpdateMessage",{type:"zaap",worldX:this.x,worldY:this.y}),"quest"===this.type&&window.gui.emit("CompassUpdateMessage",{type:u.COMPASS_TYPE_QUEST,worldX:this.x,worldY:this.y}),void 0!==this.x?l.open("worldMap",{x:this.x,y:this.y}):this.subareaId?l.open("worldMap",{subarea:this.subareaId}):this.subareaIds&&l.open("worldMap",{subareas:this.subareaIds,favorite:this.favorite,centerOn:this.centerOn})}},function(e,t){},function(e,t,i){function n(){function e(e){return t._ornamentIdToSelect=~~e.ornamentId,t._titleIdToSelect=~~e.titleId,t._titlesAndOrnamentsListRequested?void t._selectOnceReady():(t._displayLoading(!0),t._titlesAndOrnamentsListRequested=!0,void window.dofus.sendMessage("TitlesAndOrnamentsListRequestMessage"))}f.call(this,"div",{className:"OrnamentsWindow",name:"ornaments"});var t=this;this._titlesAndOrnaments=null,this._currentTitleId=null,this._currentOrnamentId=null,this._titlesAndOrnamentsListRequested=!1,this.once("open",function(i){t._createDom(),t._displayLoading(!0),t._loadContent(function(){t._setupEvents(),t.on("opened",e),e(i)});var n=window.gui.playerData.characterBaseInformations.entityLook;t._updateCharacter(n)})}i(1005);var o=i(202),s=i(246).DofusButton,a=i(415),r=i(676),l=i(29).getText,c=i(191).inherits,u=i(467),d=i(500).SingleSelectionList,h=i(30),p=i(934),m=i(195),f=i(235);c(n,f),e.exports=n,n.prototype._selectOnceReady=function(){this._ornamentIdToSelect?(this.tabs.openTab("ornaments"),this.ornamentList.selectItem(this._ornamentIdToSelect)):this._titleIdToSelect?(this.tabs.openTab("titles"),this.titleList.selectItem(this._titleIdToSelect)):this._selectActiveTitleAndOrnament()},n.prototype._setupEvents=function(){var e=this;window.gui.on("disconnect",function(){e._titlesAndOrnamentsListRequested=!1,e.tabs&&e.tabs.openFirstTab()}),window.gui.on("TitlesAndOrnamentsListMessage",function(t){e._titlesAndOrnaments=t,e._titlesAndOrnaments.titles.push(0),e._titlesAndOrnaments.ornaments.push(0),e._updateOrnamentList(),e._updateTitleList(),e._displayLoading(!1);var i=m.getValue("dofus_titleOrnaments_display_all",!1);e.showAllCheckbox.toggleActivation(i),e._selectOnceReady()}),window.gui.on("OrnamentSelectedMessage",function(t){e._titlesAndOrnaments&&(e._titlesAndOrnaments.activeOrnament=t.ornamentId)}),window.gui.on("TitleSelectedMessage",function(t){e._titlesAndOrnaments&&(e._titlesAndOrnaments.activeTitle=t.titleId)}),window.gui.on("OrnamentSelectErrorMessage",function(){}),window.gui.on("TitleSelectErrorMessage",function(){}),window.gui.on("TitleGainedMessage",function(t){var i=t.titleId;e._titlesAndOrnaments.titles.push(i),e._updateTitleList(),e._displayObtainedTitles()}),window.gui.on("TitleLostMessage",function(t){var i=t.titleId,n=e._titlesAndOrnaments.titles.indexOf(i);n!==-1&&e._titlesAndOrnaments.titles.splice(n,1),e._updateTitleList(),e._displayObtainedTitles()}),window.gui.on("OrnamentGainedMessage",function(t){var i=t.ornamentId;e._titlesAndOrnaments.ornaments.push(i),e._updateOrnamentList(),e._displayObtainedOrnaments()}),window.gui.playerData.on("lookUpdate",function(t){e.character&&e._updateCharacter(t)})},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"col1"});this.col2=this.createChild("div",{className:"col2"});var i=this.tabs=t.appendChild(new p);this.titleList=t.appendChild(new d({className:"titleList"},{disableSelectionToggle:!0})),this.titleList.on("selected",function(t){e._setCharacterTitle(t.data.id),this.showElement(t)}),this.ornamentList=t.appendChild(new d({className:"ornamentList"},{disableSelectionToggle:!0})),this.ornamentList.on("selected",function(t){e._setCharacterOrnament(t.data.id),this.showElement(t)});var n=i.addTab(l("ui.ornament.titles"),this.titleList,"titles"),o=i.getTabTarget(n);o.on("opened",function(){e.titleList.refresh()}),n=i.addTab(l("ui.ornament.ornaments"),this.ornamentList,"ornaments");var c=i.getTabTarget(n);c.on("opened",function(){e.ornamentList.refresh()}),i.openFirstTab(),this.showAllCheckbox=t.appendChild(new r(l("ui.ornament.displayAll"))),this.showAllCheckbox.on("change",function(t){m.setValue("dofus_titleOrnaments_display_all",t),e._displayObtainedTitlesOrnaments()}),this.container=this.col2.createChild("div",{className:"container"}),this.character=this.container.appendChild(new a({scale:"cover",verticalAlign:"bottom"})),this.ornamentContainer=this.container.createChild("div",{className:"ornamentContainer"}),this.ornament=this.ornamentContainer.appendChild(new u),this.ornament.on("sizeChanged",function(){e.ornament.setStyle("marginTop","0px");var t=e.ornamentContainer.rootElement.offsetHeight-this.getHeight();t<0&&(t=0),e.ornament.setStyle("marginTop",t+"px"),e.ornament.setStyle("marginLeft","0px");var i=0,n="50%";e.ornament.getCanvasOffsetWidth()>e.ornamentContainer.rootElement.offsetWidth&&(i=.5*-(e.ornament.getCanvasOffsetWidth()-e.ornamentContainer.rootElement.offsetWidth),n=Math.round(e.ornament.getCanvasOffsetWidth()/2)+"px"),e.ornament.alignmentWingsWrapper.setStyle("left",n),e.ornament.alignmentTailWrapper.setStyle("left",n),e.ornament.setStyle("marginLeft",i+"px")}),this.warningWings=this.col2.createChild("div",{className:"warningWings",text:l("ui.ornament.warningWings"),hidden:!0});var h=this.col2.createChild("div",{className:"buttons"}),f=h.appendChild(new s(l("ui.common.reset")));this.saveButton=h.appendChild(new s(l("ui.common.save"))),this.saveButton.disable(),f.on("tap",function(){e._selectActiveTitleAndOrnament(),e.saveButton.disable()}),this.saveButton.on("tap",function(){var t=e._getActiveTitleId(),i=e._getActiveOrnamentId();t!==e._currentTitleId&&window.dofus.sendMessage("TitleSelectRequestMessage",{titleId:e._currentTitleId}),i!==e._currentOrnamentId&&window.dofus.sendMessage("OrnamentSelectRequestMessage",{ornamentId:e._currentOrnamentId}),this.disable()})},n.prototype._addTitleElement=function(e){var t=this._getTitleText(e),i=new f("div",{className:"row",text:t||l("ui.common.none")});this.titleList.addItem({id:e.id,element:i,data:e},{noRefresh:!0})},n.prototype._getTitleText=function(e){var t=window.gui.playerData.characterBaseInformations.sex;return t?e.femaleText:e.maleText},n.prototype._addOrnamentElement=function(e,t){var i=new f("div",{className:"row"}),n=i.createChild("div",{className:"icon"});n.setStyle("backgroundImage",t),i.createChild("div",{text:e.nameId||l("ui.common.none"),className:"name"}),this.ornamentList.addItem({id:e.id,element:i,data:{id:e.id,assetId:e.assetId,visible:e.visible}},{noRefresh:!0})},n.prototype._loadContent=function(e){var t=this;h.getAllDataTable(["Titles","Ornaments"],function(i,n){if(i)return console.error("Titles and Ornaments: failed getting data",i),e(i);for(var s=n.Titles,a=n.Ornaments,r=["ui/slot.png","gfx/illusUi/tx_bgTitleOrnament.png"],l={},c=0;c<a.length;c++){var u=a[c].iconId;void 0===l[u]&&(r.push("gfx/ornaments/"+u+".png"),l[u]=r.length-1)}o.preloadImages(r,function(i){t.container.setStyle("backgroundImage",i[1]),t._addTitleElement({id:0}),t._addOrnamentElement({id:0},i[0]);var n,o;for(n=0;n<s.length;n+=1)o=s[n],t._addTitleElement({id:o.id,maleText:o.nameMaleId,femaleText:o.nameFemaleId,visible:o.visible});for(n=0;n<a.length;n++)o=a[n],t._addOrnamentElement(o,i[l[o.iconId]]);e()})})},n.prototype._displayLoading=function(e){this.titleList.toggleClassName("spinner",e),this.ornamentList.toggleClassName("spinner",e),this.titleList.getContentElement().toggleDisplay(!e),this.ornamentList.getContentElement().toggleDisplay(!e)},n.prototype._getActiveOrnamentId=function(){return this._titlesAndOrnaments&&this._titlesAndOrnaments.activeOrnament},n.prototype._getActiveTitleId=function(){return this._titlesAndOrnaments&&this._titlesAndOrnaments.activeTitle},n.prototype._getOwnedOrnaments=function(){return this._titlesAndOrnaments&&this._titlesAndOrnaments.ornaments},n.prototype._getOwnedTitles=function(){return this._titlesAndOrnaments&&this._titlesAndOrnaments.titles},n.prototype._updateCharacter=function(e){console.log("Setting character's look",e),this.character.setLook(e,{riderOnly:!0,direction:2,boneType:"characters/",skinType:"characters/"})},n.prototype._selectActiveTitleAndOrnament=function(){if(this._titlesAndOrnaments){var e=this._getActiveTitleId(),t=this._getActiveOrnamentId();this._currentTitleId=e,this._currentOrnamentId=t,this.titleList.deselectAll(),this.ornamentList.deselectAll(),this.titleList.selectItem(e,{noEvent:!0,noSound:!0}),this.ornamentList.selectItem(t,{noEvent:!0,noSound:!0}),this._setCharacterTitleAndOrnament(e,t)}},n.prototype._displayObtainedTitles=function(){for(var e=m.getValue("dofus_titleOrnaments_display_all",!1),t=this.titleList.getItems(),i=0,n=0;n<t.length;n+=1){var o=t[n],s=e&&o.data.visible;o.toggleDisplay(s||o.data.isAvailable),o.isVisible()&&(o.toggleClassName("odd",i%2===0),i+=1)}if(this.titleList.refresh(),null!==this._currentTitleId){var a=this.titleList.getItem(this._currentTitleId);a.data.isAvailable||this.titleList.selectItem(this._getActiveTitleId(),{noSound:!0})}},n.prototype._displayObtainedOrnaments=function(){for(var e=m.getValue("dofus_titleOrnaments_display_all",!1),t=this.ornamentList.getItems(),i=0,n=0;n<t.length;n+=1){var o=t[n],s=e&&o.data.visible;o.toggleDisplay(s||o.data.isAvailable),o.isVisible()&&(o.toggleClassName("odd",i%2===0),i+=1)}if(this.ornamentList.refresh(),null!==this._currentOrnamentId){var a=this.ornamentList.getItem(this._currentOrnamentId);a.data.isAvailable||this.ornamentList.selectItem(this._getActiveOrnamentId(),{noSound:!0})}},n.prototype._displayObtainedTitlesOrnaments=function(){this._displayObtainedTitles(),this._displayObtainedOrnaments()},n.prototype._updateTitleList=function(){for(var e=this._getOwnedTitles(),t=this.titleList.getItems(),i=0;i<t.length;i+=1){var n=t[i],o=n.data.id,s=this._getTitleText(n.data);if(s){var a=n.getChildren();a[0].setText(s)}var r=e.indexOf(o)>=0;n.data.isAvailable=r,n.toggleClassName("unavailable",!r)}},n.prototype._updateOrnamentList=function(){for(var e=this._getOwnedOrnaments(),t=this.ornamentList.getItems(),i=0;i<t.length;i+=1){var n=t[i],o=n.data.id,s=e.indexOf(o)>=0;n.data.isAvailable=s,n.toggleClassName("unavailable",!s)}},n.prototype._isSavable=function(e,t){var i=this._getOwnedTitles(),n=this._getOwnedOrnaments(),o=this._getActiveTitleId(),s=this._getActiveOrnamentId();return(o!==e||s!==t)&&i.indexOf(e)>=0&&n.indexOf(t)>=0},n.prototype._setCharacterTitle=function(e){var t=this.titleList.getItem(e);this._currentTitleId=e;var i=this._isSavable(this._currentTitleId,this._currentOrnamentId);this.saveButton.setEnable(i),this.ornament.changeAttributes({title:this._getTitleText(t.data)||""}),this.ornament.display()},n.prototype._setCharacterOrnament=function(e){var t=this.ornamentList.getItem(e);this._currentOrnamentId=e;var i=this._isSavable(this._currentTitleId,this._currentOrnamentId);this.saveButton.setEnable(i),this.ornament.changeAttributes({ornamentAssetId:t.data.assetId}),this.ornament.display()},n.prototype._setCharacterTitleAndOrnament=function(e,t){var i,n=window.gui.playerData,o=this.titleList.getItem(e),s=this.ornamentList.getItem(t);o&&(i=this._getTitleText(o.data)),this.ornament.setAttributes({charName:window.gui.playerData.characterBaseInformations.name,title:i,ornamentAssetId:s&&s.data&&s.data.assetId,guild:n.guild&&n.guild.current,alliance:n.alliance&&n.alliance.current,alignmentInfos:window.gui.playerData.alignment.alignmentInfos}),this.ornament.display(),0!==window.gui.playerData.alignment.alignmentInfos.alignmentGrade?this.warningWings.show():this.warningWings.hide();
}},function(e,t){},function(e,t,i){function n(){A.call(this,"div",{className:"QuestsWindow",name:"quests"});var e=this,t=!1;E=window.gui.playerData.quests,this.currentQuest=null,this.selectedQuestElement=null,this.updateRequired=!0,this.questsListUpdated=!1,this.params={},this.locateButtonMap={},E.on("listUpdated",function(){e.updateRequired=!0,e.questsListUpdated=!0,e.isVisible()&&(e.emit("open",e.params),e.questsList.delClassNames("spinner"))}),this.once("open",function(){this._createDom(),this._getQuestCategoryStaticData(function(i){return i?console.error(i):(e._createQuestCategories(),e._setupEvents(),t=!0,void e.emit("initialized"))})}),this.on("open",function(e){return this.questsList.toggleClassName("spinner",!this.questsListUpdated),t?void this._onOpen(e):this.once("initialized",this._onOpen.bind(this,e))})}function o(e,t){return window.gui.playerData.isAdmin()&&t?e+" ["+t+"]":e}function s(){var e=window.gui.GPS,t=this.id,i=this.questsWindow,n=this.questId;e.isActivePOI(t)?(e.removePOI(t),e.isAtLeastOneQuestObjectiveFollowed(n)||i._updateQuestFollow(n,!1,!1)):(e.addQuestObjectiveFromObjective({objectiveDb:this.objectiveDb,objectiveId:this.objective.objectiveId,questId:n}),e.questFollower.isQuestFollowed(n)||i._updateQuestFollow(n,!0,!1))}function a(e,t){if(t.length){for(var i={},n=0,o=t.length;n<o;n+=1){var s=t[n];i[s[0]]=s[1]}var a=Object.keys(i);m.getItems(a,function(t,n){return t?console.error("Failed to retrieve items",a):void n.forEach(function(t){if(t){var n=e.appendChild(new f);n.addClassNames("rewardSlot"),n.setItem(t),n.setQuantity(i[t.id]),n.on("tap",function(){I.open("itemBox",{itemData:t})})}})})}}function r(e,t){t.length&&M.getData("Emoticons",t,function(t,i){if(t)return console.error(t);var n=[],o=[];i.forEach(function(t){if(t){var i=e.appendChild(new w);i.addClassNames("rewardSlot"),o.push(i),i.icon.addClassNames("spinner"),n.push("gfx/emotes/"+t.id+".png"),i.setTooltip(t.nameId)}}),l.preloadImages(n,function(e){for(var t=0,i=e.length;t<i;t+=1){var n=o[t];n.rootElement&&(n.icon.delClassNames("spinner"),n.setImage(e[t]))}})})}i(1007);var l=i(202),c=i(246),u=i(676),d=i(29).getText,h=i(678),p=i(191).inherits,m=i(509),f=i(832),g=i(500),_=i(258).playUiSound,v=i(1008),y=i(483),b=i(586),w=i(834),M=i(30),T=i(228),C=i(195),I=i(225),A=i(235),S=i(248).addTooltip,E={},x=[];p(n,A),e.exports=n,n.prototype._onOpen=function(e){var t=this;this.params=e||{};var i=!0,n=C.getValue("showCompletedQuest",!1);this.showCompletedCheckbox.toggleActivation(n,i),this.updateRequired&&this._updateQuestList();var o=this.params.categoryId||this.currentQuest&&this.currentQuest.dbQuest.categoryId,s=this.params.questId||this.currentQuest&&this.currentQuest.questId;setTimeout(function(){t._selectQuest(o,s)},0)},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"col1"}),i=this.createChild("div",{className:"col2"});this.counter=t.createChild("div",{className:["header","counter"]}),this.questsList=t.appendChild(new g({className:"tree"})),this.showCompletedCheckbox=t.appendChild(new u(d("ui.grimoire.displayFinishedQuests")));var n=i.createChild("div",{className:["header","steps"]}),o=n.createChild("div",{className:"followedQuest"});S(o,d("tablet.ui.grimoire.followQuest")),T(o),this.questFollowed=o.appendChild(new c({className:"followedQuestButton"}));var s=this._questFollowedToggle.bind(this);o.on("tap",s),this.questFollowed.on("tap",s),this.questFollowed.toggleClassName("selected",!0),this.questFollowed.hide(),this.stepTitle=n.createChild("div",{className:"stepTitle"}),this.stepSelector=n.appendChild(new b({className:"stepSelector"}));var a=i.createChild("div",{className:"descWrapper"});a.createChild("div",{className:"image"}),this.description=a.createChild("div",{className:"description"}),i.createChild("div",{className:"header",text:d("ui.grimoire.quest.objectives")}),this.objectivePlaceHolder=new A("div",{text:d("ui.grimoire.quest.objectivesNonAvailable"),name:"objectivePlaceHolder",className:"objectiveRow"}),this.objectivesScroller=i.appendChild(new y({className:"objectiveList"})),this.objectives=this.objectivesScroller.content;var r=this.rewardHeader=i.createChild("div",{className:"header"});r.createChild("div",{className:"rewardTitle",text:d("ui.grimoire.quest.rewards")});var l=this.xpPoint=r.createChild("div",{className:"point"});this.xp=l.createChild("div",{className:"text"}),l.createChild("div",{className:["xp","icon"]}),l.hide();var h=this.kamasPoint=r.createChild("div",{className:"point"});this.kamas=h.createChild("div",{className:"text"}),h.createChild("div",{className:["kamas","icon"]}),h.hide(),this.rewardList=i.createChild("div",{className:"rewardList"}),this.stepSelector.on("change",function(t){var i=e.currentQuest.dbSteps[t],n=e.currentQuest.dbQuest.stepIds.indexOf(parseInt(t,10));n<=this.index?e._displayStepData(i):e._displayUnknownStep(i)}),this.questsList.on("selected",function(t){t.sublist.show(),e._updateQuestItemsStyle(),e.questsList.refresh(),e.questsList.scrollToElement(t)}),this.questsList.on("deselected",function(t){t.sublist.hide(),e._updateQuestItemsStyle(),e.questsList.refresh()}),this.showCompletedCheckbox.on("change",function(t){C.setValue("showCompletedQuest",t),e._showCompletedQuest()})},n.prototype._setupEvents=function(){var e=this,t=window.gui,i=t.GPS;E.on("questUpdate",function(t){e.isVisible()&&e.currentQuest&&t===e.currentQuest.questId&&e._selectQuest(e.currentQuest.dbQuest.categoryId,e.currentQuest.questId)}),E.on("questFinished",function(t){e._endQuest(t.questId),e._sortSublist(t.questId),e._showCompletedQuest(),e._updateQuestCounter(),e.currentQuest&&t.questId===e.currentQuest.questId&&e._reset()}),E.on("questStarted",function(t){e._addQuest(t),e._sortSublist(t),e._showCompletedQuest(),e._updateQuestCounter(),e.currentQuest||(e.currentQuest=E.all[t],e.isVisible()&&e._selectQuest(e.currentQuest.dbQuest.categoryId,e.currentQuest.questId))}),t.on("disconnect",function(){e.currentQuest=null,e.selectedQuestElement=null,e.updateRequired=!0,e.questsListUpdated=!1,e.params={},e.locateButtonMap={}}),i.on("addDestination",function(t){var i=e.locateButtonMap[t.id];i&&i.rootElement&&i.addClassNames("selected")}),i.on("removeDestination",function(t){var i=e.locateButtonMap[t.id];i&&i.rootElement&&i.delClassNames("selected")})},n.prototype._getQuestCategoryStaticData=function(e){M.getAllDataTable("QuestCategory",function(t,i){return t?e(t):(x=i||[],x.sort(function(e,t){return e.order-t.order}),void e())})},n.prototype._createQuestCategories=function(){for(var e=this,t=0,i=x.length;t<i;t+=1){var n=x[t],o=new A("div",{className:"label"});o.createChild("div",{className:"arrow"}),o.createChild("div",{className:"text",text:n.nameId});var s=e.questsList.addItem({id:n.id,element:o},{noRefresh:!0});s.hide(),s.sublist=s.appendChild(new A("div",{className:"sublist"})),s.sublist.hide()}},n.prototype._updateQuestList=function(){this.updateRequired=!1,this._reset(),this._generateQuestList(),this._updateQuestCounter()},n.prototype._reset=function(){this.currentQuest=null,this._resetSelectedQuestElement(),this.stepTitle.setText(""),this.description.setText(""),this._resetObjectives(),this.rewardList.clearContent(),this.kamas.setText(""),this.kamasPoint.hide(),this.xp.setText(""),this.xpPoint.hide(),this.questsList.deselectAll(),this.stepSelector.clearContent(),this.stepSelector.hide(),this.questFollowed.hide()},n.prototype._resetSelectedQuestElement=function(){this.selectedQuestElement&&(this.selectedQuestElement.delClassNames("selected"),this.selectedQuestElement=null)},n.prototype._generateQuestList=function(){for(var e=this.questsList.getItems(),t=0;t<e.length;t+=1){var i=e[t].sublist;i.clearContent()}var n=Object.keys(E.active).sort(),o=Object.keys(E.finished).sort();for(t=0;t<n.length;t+=1)this._addQuest(n[t]);for(t=0;t<o.length;t+=1)this._addQuest(o[t]);this._showCompletedQuest()},n.prototype._updateQuestCounter=function(){var e=d("ui.grimoire.pendingQuests",Object.keys(E.active).length),t=d("ui.grimoire.completedQuests",Object.keys(E.finished).length);this.counter.setText(e+" - "+t)},n.prototype._selectQuest=function(e,t){if(e){var i=this.questsList.getItem(e);if(i){this.questsList.selectItem(e);var n=i.sublist.getChild(t);n&&(n.hasClassName("completed")||(n.tap(),this.questsList.scrollToElement(n)))}}},n.prototype._updateQuestItemsStyle=function(){for(var e,t,i,n=this.questsList.getItems(),o=0,s=0;s<n.length;s+=1)if(e=n[s],e.isVisible()&&(e.toggleClassName("odd",o%2===0),o+=1,e.sublist.isVisible())){t=e.sublist.getChildren();for(var a=0;a<t.length;a+=1)i=t[a],i.isVisible()&&(i.toggleClassName("odd",o%2===0),o+=1)}},n.prototype._showCompletedQuest=function(){for(var e,t,i,n,o=C.getValue("showCompletedQuest",!1),s=this.questsList.getItems(),a=!0,r=0;r<s.length;r+=1){t=s[r],i=t.sublist.getChildren(),a=!0;for(var l=0;l<i.length;l+=1)n=i[l],e=n.getWuiName(),o||!E.finished[e]?(a=!1,n.show()):n.hide();a?t.hide():t.show()}this._updateQuestItemsStyle(),this.questsList.refresh()},n.prototype._resetObjectives=function(){this.locateButtonMap={},this._removeObjectivePlaceHolder(),this.objectives.clearContent(),this.objectives.appendChild(this.objectivePlaceHolder),this.objectivesScroller.refresh()},n.prototype._removeObjectivePlaceHolder=function(){var e=this.objectives.getChild("objectivePlaceHolder");e&&this.objectives.removeChild(e)},n.prototype._createObjectiveElement=function(e,t,i){var n=new A("div",{className:"objectiveRow"}),s=n.createChild("div",{className:"description"}),a=t.hypertext||t.text;s.appendChild(h.process(o(a,t.objectiveId)));var r=t.objectiveStatus;n.toggleClassName("complete",!r),n.toggleClassName("disabled",!r);var l=e.coords;return r&&(e.mapId||l&&void 0!==l.x)&&this._createLocateButton(n,s,e,t,i),n},n.prototype._createLocateButton=function(e,t,i,n,o){var a=window.gui.GPS,r=a.getQuestObjectivePoiId(n.objectiveId),l=e.appendChild(new c({className:"locateButton"},s));this.locateButtonMap[r]=l,l.toggleClassName("selected",a.isActivePOI(r)),l.questsWindow=this,l.id=r,l.objectiveDb=i,l.objective=n,l.questId=o,T(t),t.on("tap",s.bind(l))},n.prototype._questFollowedToggle=function(){var e=window.gui.GPS,t=this.currentQuest.questId,i=!e.questFollower.isQuestFollowed(t);this._updateQuestFollow(t,i,!0)},n.prototype._displayStepObjectives=function(e){this._resetObjectives();var t=this.currentQuest.objectives;if((!this.currentQuest||this.currentQuest.questId!==e.questId||this.currentQuest.stepId===e.id)&&t.length){this._removeObjectivePlaceHolder();for(var i,n=0,o=t.length;n<o;n+=1)i=t[n],this.objectives.appendChild(this._createObjectiveElement(this.currentQuest.dbObjectives[i.objectiveId],i,e.questId));this.objectivesScroller.refresh()}},n.prototype._displayStepRewards=function(e){this.rewardList.clearContent();for(var t=window.gui.playerData.characterBaseInformations.level,i=0,n=e.length;i<n;i+=1){var o=this.currentQuest.dbRewards[e[i]];!o||o.levelMin!==-1&&t<o.levelMin||o.levelMax!==-1&&t>o.levelMax||(a(this.rewardList,o.itemsReward),r(this.rewardList,o.emotesReward))}},n.prototype._setKamas=function(e){var t=v.calculateStepKamasRatio(e);return t?(this.kamasPoint.show(),void this.kamas.setText(t)):void this.kamasPoint.hide()},n.prototype._setXp=function(e){var t=v.calculateStepXpRatio(e);return t?(this.xpPoint.show(),void this.xp.setText(t)):void this.xpPoint.hide()},n.prototype._displayStepData=function(e){var t=window.gui.GPS;this.stepTitle.setText(o(e.nameId,e.id)),this.description.clearContent(),this.description.appendChild(h.process(e.descriptionId)),this.questFollowed.show(),this.questFollowed.toggleClassName("selected",t.questFollower.isQuestFollowed(this.currentQuest.questId)),this._displayStepObjectives(e),this._displayStepRewards(e.rewardsIds),this._setKamas(e),this._setXp(e)},n.prototype._displayUnknownStep=function(e){this.stepTitle.setText(o(e.nameId,e.id)),this.description.setText(d("ui.grimoire.quest.descriptionNonAvailable")),this._resetObjectives(),this._displayStepRewards(e.rewardsIds),this._setKamas(e),this._setXp(e)},n.prototype._updateStepList=function(){var e=this.currentQuest;this.stepSelector.clearContent(),this.stepSelector.index=0;for(var t=e.dbQuest.stepIds,i=0,n=t.length;i<n;i+=1){var o=t[i];this.stepSelector.addOption(d("ui.grimoire.quest.step")+" "+(i+1),o),e.stepId===o&&(this.stepSelector.index=i)}this.stepSelector.select(e.stepId),this.stepSelector.show()},n.prototype._getQuestCategoryElement=function(e){var t=E.all[e];return this.questsList.getItem(t.dbQuest.categoryId)},n.prototype._sortSublist=function(e){var t=this._getQuestCategoryElement(e),i=t.sublist.getChildren();i.sort(function(e,t){return parseInt(e.getWuiName(),10)-parseInt(t.getWuiName(),10)}),i.sort(function(e,t){return e.hasClassName("completed")?1:t.hasClassName("completed")?-1:0});for(var n=0;n<i.length;n+=1)t.sublist.appendChild(i[n])},n.prototype._addQuest=function(e){var t=this,i=window.gui.GPS,n=E.all[e],s=this._getQuestCategoryElement(e);if(!s)return void console.error(new Error("CategoryElement cannot be found to add questId "+e));s.show();var a=s.sublist.getChild(e);if(!a){var r=new A("div",{className:"label",name:e});r.hourglass=r.createChild("div",{className:"icon"}),i.questFollower.isQuestFollowed(e)||r.hourglass.addClassNames("notFollowed"),r.createChild("div",{className:"text",text:o(n.dbQuest.nameId,e)}),T(r),r.on("tap",function(){var e=r.getWuiName();return E.active[e]?(_("GEN_BUTTON"),t.currentQuest=E.all[e],t._updateStepList(),t._resetSelectedQuestElement(),r.addClassNames("selected"),void(t.selectedQuestElement=r)):_("NO_ACTION")}),a=s.sublist.appendChild(r)}E.active[e]?a.delClassNames("completed"):a.addClassNames("completed")},n.prototype._endQuest=function(e){var t=window.gui.GPS,i=this._getQuestCategoryElement(e),n=i.sublist.getChild(e);n&&(n.addClassNames("completed"),t.questFollower.unfollowQuest(e,!1))},n.prototype._updateQuestFollow=function(e,t,i){var n=window.gui.GPS,o=n.questFollower.isQuestFollowed(e);t&&!o?n.questFollower.followQuest(e,i):!t&&o&&n.questFollower.unfollowQuest(e,i),this.questFollowed.toggleClassName("selected",t),this._updateHourglass(e,t)},n.prototype._updateHourglass=function(e,t){var i=this._getQuestCategoryElement(e),n=i.sublist.getChild(e);n&&n.hourglass.toggleClassName("notFollowed",!t)}},function(e,t){},function(e,t){function i(e,t){return Math.floor(e*Math.pow(100+2*e,2)/20*t.duration*t.xpRatio)}t.calculateStepKamasRatio=function(e){var t=window.gui.playerData.characterBaseInformations.level,i=e.kamasScaleWithPlayerLevel?t:e.optimalLevel;return Math.floor((Math.pow(i,2)+20*i-20)*e.kamasRatio*e.duration)},t.calculateStepXpRatio=function(e){var t=1.5,n=.7,o=window.gui.playerData.characterBaseInformations.level,s=1+window.gui.playerData.experienceFactor/100,a=e.optimalLevel;if(o>a){var r=Math.floor(Math.min(o,a*t)),l=(1-n)*i(a,e),c=n*i(r,e);return Math.floor((l+c)*s)}return Math.floor(i(o,e)*s)}},function(e,t,i){function n(e,t){if(e.isItem)return-1;if(t.isItem)return 1;var i=e.getProperty("minPlayerLevel",1),n=t.getProperty("minPlayerLevel",1);return i<n?-1:i>n?1:e.id>t.id?1:e.id<t.id?-1:0}function o(e,t){return e.isItem?-1:t.isItem?1:e.level>t.level?1:e.level<t.level?-1:e.id>t.id?1:e.id<t.id?-1:0}function s(e,t){return e.id===_.WEAPON_SPELL_ID||(void 0===t&&(t=e.level),e.getProperty("minPlayerLevel",t)<=window.gui.playerData.characterBaseInformations.level)}function a(){m.call(this,"div",{className:"SpellsWindow",name:"spells"}),this.mustRefreshAll=!0,this.once("open",function(){this._createDom(),this._setupEvents()});var e=null,t=window.gui;this.on("open",function(i){e=i&&i.spellId?i.spellId:null,this.updateRemainingPoints(),this._refreshAllContent(),t.shortcutBar.openPanel("spell")}),this.on("focus",function(){t.shortcutBar.openPanel("spell")});var i=this;this.on("opened",function(){if(e){var t=window.gui.playerData.characters.mainCharacter.spellData.spells[e];if(!t)return console.error(new Error("spell is not loaded"));this.table.selectRow(t.id),this.table.scrollToSelectedRow(),i.displaySpell({spell:t,imageUri:t.getIconUrl()})}})}i(1010);var r=i(248).addTooltip,l=i(191).inherits,c=i(228),u=i(29).getText,d=i(246).DofusButton,h=i(593),p=i(586),m=i(235),f=i(840),g=i(383),_=i(459),v=i(202),y=i(258).playUiSound,b=i(462).SpellData.SPELL_STATUS,w=i(483);l(a,m),e.exports=a,a.prototype._createDom=function(){function e(e){var t=new m("div",{className:"icon"}),i=e.getIconUrl();return i&&t.setStyle("backgroundImage",i),t}function t(e){var t=new d("",{name:"addButton"});return t.spell=e,window.gui.playerData.isIncarnation()?(r(t,u("ui.spell.incarnationSpellWarning")),t.addClassNames("disabled")):(t.on("tap",function(){var e=this.rootElement.getBoundingClientRect();window.gui.openContextualMenu("spellUpgrade",{spell:this.spell,remainingPoints:i.remainingPoints},{x:e.left+e.width,y:e.top}),y("PLUS_BUTTON")}),i._refreshAddButtonState(t)),t}var i=this,s=this.createChild("div",{className:"col1"});this.col2=this.createChild("div",{className:"col2"}),this.selector=s.appendChild(new p),this.table=s.appendChild(new h([{id:"icon",format:e,sort:n},{id:"name",header:u("ui.common.spellName"),getContent:function(e){return e.getName()},sort:!0},{id:"rank",header:u("ui.common.level"),format:function(e){return e.isItem||e.id===_.WEAPON_SPELL_ID?"-":e.level},sort:o},{id:"add",format:t}],"id")),this.table.on("rowTap",function(e,t){i.displaySpell({spell:t,imageUri:e.icon.content.getStyle("backgroundImage")}),y("GEN_BUTTON")});var a,l=!0;this.table.addFilter(function(e){return l||e.getProperty("typeId")===a}),this.selector.on("change",function(e){l=!1,"-"===e?l=!0:a=parseInt(e,10),i.table.filter()});var c=s.createChild("div",{className:"pointsBox"});c.createChild("div",{text:u("ui.grimoire.spellCapital"),className:"label"}),this.remainingPointsBox=c.createChild("div",{className:"remainingPoints"})},a.prototype._setupEvents=function(){var e=this,t=window.gui;t.on("SpellUpgradeFailureMessage",function(){window.gui.openPopup({title:u("ui.common.error"),message:u("ui.grimoire.popup.upgradeSpellFailMessage")})}),t.on("CharacterLevelUpMessage",function(){e.enableSpellsOnLevelUp()}),t.on("disconnect",function(){e.mustRefreshAll=!0}),t.playerData.characters.mainCharacter.on("weaponChanged",function(){e.updateWeaponSpell()});var i=t.playerData.characters;i.mainCharacter.on("spellUpgrade",function(t,i){return e.table.getRow(t)?void e._updateDisplayedSpellLevel(t,i):console.error(new Error("spell "+t+" does not exist in spell window"))}),i.mainCharacter.on("newSpellLearned",function(t){if(!e.table.getRow(t)){var i=window.gui.playerData.characters.mainCharacter.spellData.spells[t];if(!i)return console.error(new Error("spell "+t+" is not loaded"));var n={};n[i.id]=i,e.table.addMap(n),i.getIconUrl()||v.preloadImage(i.getIconUri(),function(t){i.spell.image=t;var n=e.table.getCell(i.id,"icon");n.setStyle("backgroundImage",t),e.currentSpellId===i.id&&e.displaySpell({spell:i,imageUri:t}),e.refreshAllSpellState()})}}),t.playerData.on("spellsPointsUpdated",function(){e.updateRemainingPoints(),e._refreshAllAddButtonState()}),i.on("spellList",function(){e._askForRefresh()}),i.on("switchControlledCharacter",function(){g.cancelDragFromSource("spellsWindow")})},a.prototype._refreshAllContent=function(){this.mustRefreshAll=!1;var e=window.gui.playerData.characters,t=e.getControlledCharacter();this._onMainCharacter=e.isMainCharacterControlled(),this.table.setSorter(n),this._loadAllSpells(t.spellData.getSpells(b.VISIBLE)),this.setupSelectorOptions(),this.table.selectFirstRow()},a.prototype._askForRefresh=function(){this.isVisible()?this._refreshAllContent():this.mustRefreshAll=!0},a.prototype.updateRemainingPoints=function(){var e=window.gui.playerData.characters.getControlledCharacter(),t=e.characteristics.spellsPoints;this.remainingPoints!==t&&(this.remainingPointsBox.setText(t),this.remainingPoints=t)},a.prototype.setupSelectorOptions=function(){var e=this;this.selector.clearContent(),this.selector.addOption(u("ui.common.allTypes"),"-"),this.selector.setValue("-");var t={},i=window.gui.playerData.characters.getControlledCharacter(),n=i.spellData.getSpells(b.VISIBLE);for(var o in n){var s=n[o],a=s.getProperty("typeId");t[a]||(e.selector.addOption(s.getHumanReadableSpellType(),a),t[a]=!0)}},a.prototype.updateWeaponSpell=function(){var e=this,t=window.gui.playerData.characters.mainCharacter.spellData.spells[_.WEAPON_SPELL_ID];v.preloadImage(t.getIconUri(),function(i){e.table.updateRow(t);var n=e.table.getCell(t.id,"icon");n.setStyle("backgroundImage",i),e.refreshSpellState(t.id),e.currentSpellId===t.id&&e.displaySpell({spell:t,imageUri:i})})},a.prototype._loadAllSpells=function(e){this.spellMap=e,this.table.clearContent(),this.table.addMap(e);var t=[],i=[];for(var n in e){var o=e[n];o.getIconUrl()||(i.push(o),t.push(o.getIconUri()))}var s=this;v.preloadImages(t,function(e){for(var t=0;t<e.length;t++){var n=i[t],o=n.spell.image=e[t],a=s.table.getCell(n.id,"icon");a.setStyle("backgroundImage",o),s.currentSpellId===n.id&&s.displaySpell({spell:n,imageUri:o})}s.refreshAllSpellState()})},a.prototype.setSpellDraggable=function(e,t){var i=this.table.getCell(e,"icon");if(g.isDraggable(i))return void(t?g.enableDrag(i):g.disableDrag(i));if(t){var n=this.spellMap[e].getIconUrl();n&&g.setDraggable(i,{backgroundImage:n},"spellsWindow",{spellId:e},{dragOnTouchstart:!0})}},a.prototype.setSpellEnabled=function(e,t){this.table.getRow(e).toggleClassName("grayed",!t)},a.prototype.refreshSpellState=function(e){var t=this.spellMap[e],i=t&&(t.isItem||s(t)),n=i&&this._onMainCharacter;this.setSpellEnabled(e,i),this.setSpellDraggable(e,n)},a.prototype.refreshAllSpellState=function(){for(var e in this.spellMap)this.refreshSpellState(e)},a.prototype._updateDisplayedSpellLevel=function(e,t){if(this.table.hasRow(e)){var i=this.table.getCell(e,"rank");i.setText(t)}},a.prototype.enableSpellsOnLevelUp=function(){this.table.getRowCount()&&(this.refreshAllSpellState(),this._refreshAllAddButtonState())},a.prototype._refreshAllAddButtonState=function(){for(var e in this.spellMap)if(this.table.hasRow(e)){var t=this.table.getCell(e,"add");this._refreshAddButtonState(t)}},a.prototype._refreshAddButtonState=function(e){var t=e.spell,i=t.level;if(0===i||i===t.getMaxLevel())return void e.hide();if(!s(t,i+1))return void e.hide();e.show();var n=t.getUpgradeCost();return this.remainingPoints<n?void e.disable():void e.enable()},a.prototype.displaySpell=function(e){function t(t,o){var a=Number(o)+1,r=t.createChild("div",{className:"tab",text:a});r.rankNum=o,i.getSpellLevelId(a)===s&&r.addClassNames("on"),c(r),r.on("tap",function(){n.displaySpell({spell:e.spell,imageUri:e.imageUri,spellLevel:a}),y("TAB")})}var i,n=this;e.spellLevel&&e.spellLevel!==e.spell.level?(i=e.spell.clone(),i.setLevel(e.spellLevel)):i=e.spell;var o=i.level,s=i.getSpellLevelId(o),a=e.imageUri;if(this.currentSpellLevelId===s)return void this.tabIcon.setStyle("backgroundImage",a);this.col2.clearContent(),this.currentSpellLevelId=s,this.currentSpellId=i.id;for(var r=n.col2.createChild("div",{className:"tabs"}),l=i.getMaxLevel(),d=0;d<l;d++)t(r,d.toString());var h=n.col2.createChild("div",{className:"panel"}),p=h.createChild("div",{className:"header"}),m=this.tabIcon=p.createChild("div",{className:"icon"});m.setStyle("backgroundImage",a);var g=p.createChild("div",{className:"panelTop"});g.createChild("div",{className:"spellName",text:i.getName()}),g.createChild("div",{className:"minPlayerLevel",text:u("ui.spell.requiredLevel")+" "+(i.getProperty("minPlayerLevel",o)||1)});var _=h.appendChild(new w({className:"spellDescScroller"}));_.content.appendChild(new f({spell:i,level:o},{spellTooltipAll:!0})),_.refresh()}},function(e,t){},function(e,t,i){function n(){l.call(this,"div",{className:"jobsWindow",name:"jobs"});var e=this;this.jobButtons=[],this.jobSelectButtons=[],this.jobSelectSpecialButtons=[],this._expBarTooltip=new l("div"),this.mustRefreshJobs=!0,this.numRefreshTasks=0,this._setupEvents(),this.on("open",function(t){e.jobListElement||e._createDom();var i=t?t.jobId:null;return e.mustRefreshJobs?e._refreshJobs(i):void(i&&e.selectJob(i))}),this.on("close",function(){e.mustRefreshJobs=!0,_.getWindow("jobOptions").openState&&_.close("jobOptions"),e.recipeList.reset()})}function o(e,t){var i=e.getChild("level");i&&(t=t?p("ui.common.short.level")+" "+t:"",i.setText(t))}function s(e){var t=e.jobId?C[e.jobId]:null;e.getChild("jobIcon").setImage(t)}function a(e,t){var i,n;null===t?(i=null,n=null):(i=t.id,n=t.experience?t.experience.jobLevel:1),e.jobId=i,s(e),o(e,n)}i(1012);var r=i(191).inherits,l=i(235),c=i(30),u=i(605),d=i(246),h=i(1013),p=i(29).getText,m=i(509),f=i(834),g=i(832),_=i(225),v=i(1015),y=i(202),b=i(248).addTooltip,w=i(184),M=3,T=3,C={};r(n,l),e.exports=n,n.prototype._reset=function(){this.mustRefreshJobs=!0,this.numRefreshTasks=0},n.prototype._refreshJobs=function(e){this.mustRefreshJobs=!1,window.gui.playerData.isSubscriber()?(this._bonusPackText.setHtml(p("tablet.shop.xpBonusActive",w.BONUS_PACK_XPJOB)),this._linkToShop.hide()):(this._bonusPackText.setHtml(p("tablet.shop.xpBonusInactive",w.BONUS_PACK_XPJOB)),this._linkToShop.show());var t=window.gui.playerData.jobs;this.jobMap=t.list;var i=Object.keys(this.jobMap);if(i.length){this._updateJobButtons(t.jobOriginalOrder);var n=this;this._getJobImages(function(){n._updateJobIcons()}),e=e||t.jobOriginalOrder[0],this.selectJob(e,!0)}},n.prototype._getJobImages=function(e){var t=[],i=[],n=this.jobMap;for(var o in n){var s=n[o];s.info.iconId===-1||C[o]||(t.push("gfx/jobs/"+s.info.iconId+".png"),i.push(o))}return t.length?void y.preloadImages(t,function(t){for(var n=0;n<t.length;n++)C[i[n]]=t[n];return e()}):e()},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"col1"}),i=this.createChild("div",{className:"col2"});this.jobListElement=t.createChild("div",{className:"jobsList"});for(var n=0;n<M;n++)this._createJobIcon(n);var o=this.jobListElement.createChild("div",{className:"specialisation"});for(o.createChild("div",{className:"text",text:p("ui.common.specializations")});n<M+T;n++)this._createJobIcon(n,o);this.jobExpBlock=t.createChild("div",{className:"jobExpBlock"}),this.jobWrapper=this.jobExpBlock.createChild("div",{className:"jobWrapper"}),this.jobName=this.jobWrapper.createChild("div",{className:"jobName"}),this.jobLevel=this.jobWrapper.createChild("div",{className:"jobLevel"}),this._jobExpBar=this.jobExpBlock.appendChild(new u({className:"jobExpBar"})),b(this._jobExpBar,this._expBarTooltip),this.skillsBlock=t.createChild("div",{className:"skillsBlock"}),this.skillsTitle=this.skillsBlock.createChild("div",{className:"skillsTitle",text:p("ui.common.abilities")});var s=t.appendChild(new d({text:p("ui.craft.jobOptions"),className:["greenButton"]}));s.on("tap",function(){_.open("jobOptions",{jobId:e.selectedJobId})}),this.skillsList=this.skillsBlock.appendChild(new h({className:"skillsList",cannotActivate:!0})),this.recipeList=i.appendChild(new v({shouldNotSelect:!0}));var a=i.createChild("div",{className:"bonusPackMessage"});this._bonusPackText=a.createChild("span"),this._linkToShop=a.appendChild(new d({className:"linkToShop",scaleOnPress:!1})),this._linkToShop.on("tap",function(){_.open("market",{tabId:"shop",tabParams:{category:"bonuspack"}})})},n.prototype._createJobIcon=function(e,t){var i=this,n=t||this.jobListElement,o=n.createChild("div",{className:"job"});o.itemSlot=o.appendChild(new f({name:"jobIcon"})),this.jobButtons.push(o),t?this.jobSelectSpecialButtons.push(o):(this.jobSelectButtons.push(o),o.createChild("div",{className:"level",name:"level"})),o.itemSlot.on("tap",function(){o.jobId&&i.selectJob(o.jobId)})},n.prototype._updateJobButtons=function(e){for(var t=0;t<this.jobButtons.length;t++)a(this.jobButtons[t],null);var i=0,n=0;for(t=0;t<e.length;t++){var o=this.jobMap[e[t]],s=o.info.specializationOfId?this.jobSelectSpecialButtons[n++]:this.jobSelectButtons[i++];a(s,o)}},n.prototype._updateJobIcons=function(){for(var e=0;e<this.jobButtons.length;e++)s(this.jobButtons[e])},n.prototype._getJobButton=function(e){for(var t=this.jobButtons,i=0;i<t.length;i++)if(t[i].jobId===e)return t[i];return console.error("_getJobButton: invalid Job ID: "+e),null},n.prototype._setupEvents=function(){var e=this,t=window.gui.playerData.jobs;window.gui.on("disconnect",function(){e._reset()}),t.on("jobListUpdated",function(){var i=0!==Object.keys(t.list).length;i&&(e.mustRefreshJobs=!0,e.isVisible()&&e._refreshJobs())}),t.on("jobLevelUp",function(t,i){if(!e.mustRefreshJobs){var n=e._getJobButton(t.id);if(n)return o(n,i),e.isVisible()&&t.id===e.selectedJobId?e._refreshJobs(t.id):void 0}}),t.on("jobExperienceUpdate",function(t){e.isVisible()&&t.jobId===e.selectedJobId&&e._updateJobInfo(t)})},n.prototype._updateJobInfo=function(e){var t="";t=100!==e.currentLevel?e.percentage+"% ("+e.currentExperience+" / "+e.levelExperienceCeil+")":e.percentage+"% ("+e.currentExperience+")",this._expBarTooltip.setText(t),this._jobExpBar.setValue(e.percentage/100),this.jobName.setText(this.jobMap[e.jobId].info.nameId),this.jobLevel.setText(p("ui.common.level")+" "+e.currentLevel)},n.prototype._selectJobButton=function(e){var t=this._getJobButton(e);if(!t)return!1;if(this.currentJobBtn){if(this.currentJobBtn.jobId===e)return!1;this.currentJobBtn.itemSlot.unselect()}return t.itemSlot.select(),this.currentJobBtn=t,!0},n.prototype.selectJob=function(e,t){if(this._selectJobButton(e)||t){var i=this;window.setTimeout(function(){i._refreshCurrentJob(e)},50)}},n.prototype._afterRefreshTask=function(){if(this.numRefreshTasks--,this.numRefreshTasks>0)return!this.lastJobIdRequested;if(!this.lastJobIdRequested)return!0;var e=this.lastJobIdRequested;return this.lastJobIdRequested=null,this._refreshCurrentJob(e),!1},n.prototype._refreshCurrentJob=function(e){if(this.numRefreshTasks)return void(this.lastJobIdRequested=e);this.selectedJobId=e;var t=window.gui.playerData.jobs,i=2,n=[],o=this.jobMap[e],s=o.description.skills;this._updateJobInfo(t.getJobExperience(e)),this.skillsList.empty();for(var a=[],r=[],u=[],d=[],h=[],f=0;f<s.length;f++){var _=s[f],v=_.skillId,y=_.info;if(y){var b=new l("div",{className:"label"});this.skillsList.addItem(v,b);var w=b.appendChild(new g);w.addClassNames("skillIcon"),h.push(w);var M=b.createChild("div",{className:"skillLeft"});M.createChild("div",{className:"skillName",text:y.nameId}),u.push(M.createChild("div",{className:"skillDetail"})),d.push(y.interactiveId);var T=b.createChild("div",{className:"skillRight"}),C=T.createChild("div",{className:"skillStats"});if("SkillActionDescriptionCollect"===_._type){C.setText(p("ui.jobs.collectSkillInfos",_.time/10,_.min,_.max)),r.push(y.gatheredRessourceItem);var I=T.appendChild(new g({descriptionOptions:{effects:!1}}));a.push(I)}if("SkillActionDescriptionCraft"===_._type){var A=p("ui.jobs.slotPercents",_.maxSlots,_.probability);C.setText(A),n=n.concat(y.recipes),C.addClassNames("bottom")}}}this.numRefreshTasks+=4;var S=this;window.gui.playerData.jobs.getToolFromJob(e,function(t,i){if(t)return S._afterRefreshTask(),console.error("JobsWindow: Failed to get tools image for jobId",e,t);if(S._afterRefreshTask())for(var n=0,o=h.length;n<o;n+=1){var s=h[n];s.setItem(i)}}),m.getItems(r,function(e,t){if(e)return S._afterRefreshTask(),console.error("JobsWindow: Failed to get ingredients",e);if(S._afterRefreshTask())for(var i=0;i<t.length;i++){var n=t[i];a[i].setItem(n)}}),c.getDataMap("Interactives",d,function(e,t){if(e)return S._afterRefreshTask(),console.error("JobsWindow: Failed to get interactive data",e);if(S._afterRefreshTask())for(var i=0;i<d.length;i++){var n=d[i],o=t[n];o?u[i].setText(o.nameId):console.error(new Error("JobsWindow: no interactive for id "+n))}}),this.recipeList.reset();var E=window.gui.playerData.jobs.getMaxSlotsByJobId(e)||i;this.recipeList.addRecipes(n,{nbCase:E},function(){S._afterRefreshTask()})}},function(e,t){},function(e,t,i){function n(e){e=e||{},s.call(this,"ul",e),this.addClassNames("List"),e.cannotActivate&&(this._cannotActivate=e.cannotActivate),this.activeItem=null,this.items={}}i(1014);var o=i(191).inherits,s=i(235),a=i(252),r=i(228),l=i(258).playUiSound;
o(n,s),e.exports=n,n.prototype.addItem=function(e,t,i){var n=this,o=this.createChild("li",{name:e,className:e});return o.appendChild(t),o.element=t,i&&(o.data=i),r(t),t.on("tap",function(){o===n.activeItem?n.deactivate():n.activate(o)}),this.items[e]=o,o},n.prototype.removeItem=function(e){var t=this.items[e];t&&(t.destroy(),delete this.items[e])},n.prototype.selectItem=function(e){var t=this.items[e];if(t)return this.activate(t),t},n.prototype.activate=function(e){this._cannotActivate||(this.deactivate(!0),e.addClassNames("on"),this.emit("activate",e),this.activeItem=e,l("GEN_BUTTON"))},n.prototype.deactivate=function(e){this.activeItem&&(this.activeItem.delClassNames("on"),this.emit("deactivate",this.activeItem),this.activeItem=null,e||l("GEN_BUTTON"))},n.prototype.empty=function(){this.clearContent(),this.activeItem=null,this.items={}},n.prototype.sort=function(e,t){a.sortObjectInArray(this.items,e,t)}},function(e,t){},function(e,t,i){function n(e){function t(e,t){function n(e){i.filterNbSlots[o.slotNumber]=e,A&&(i._currentPage=0,i.pagination.setCurrent(0),i._search())}var o=i.filterCheckboxes.appendChild(new h(e,t));return o.slotNumber=e,o.on("change",n),o}e=e||{};var i=this;c.call(this,"div",{className:"RecipeList"}),A=!1,this._filterCraftableOnly=!1,this.isInCraft=!!e.isInCraft,this.shouldNotSelect=!!e.shouldNotSelect,this.isMenuOnItemDisabled=!!e.isMenuOnItemDisabled,this.selectedRecipe=null,this.tappedRecipe=null,this.usingItemId=null,this._currentPage=-1,this._isItemDataPending=!1,this._recipesData=[],this._currentFilteredRecipesList=[];var n=this._searchBar=this.createChild("div",{className:"searchBar"}),o=this._searchLine=n.createChild("div",{className:"searchLine"});o.createChild("div",{className:"label",text:d("ui.common.recipes",2)}),this._searchInput=o.appendChild(new b),this._searchInput.on("search",function(){i._currentPage=0,i.pagination.setCurrent(0),i._search()});var s=this._ingredientsLine=n.createChild("div",{className:"ingredientsLine"});s.createChild("div",{className:"label",text:d("ui.common.ingredients")}),this.filterNbSlots={},this.filterText="",this.filterCheckboxes={},this.filterCheckboxes=s.createChild("div",{className:"filterCheckboxes"});for(var a=1;a<=T;a+=1)this.filterCheckboxes[a]=t(a,!0),i.filterNbSlots[a]=!0;this.recipesWrapper=this.appendChild(new u({className:["recipesWrapper","spinner"]})),this._recipesPlaceholder=this.recipesWrapper.createChild("div",{className:"recipesPlaceholder",hidden:!0}),this._recipesPlaceholder.createChild("div",{className:"recipesPlaceholderText",text:d("ui.craft.noCraftAvailable")}),this.recipesList=this.recipesWrapper.content,this.isInCraft&&(this._checkboxWrapper=this.createChild("div",{className:"checkboxWrapper"}),this._showCraftableCheckbox=this._checkboxWrapper.appendChild(new h(d("ui.craft.possibleRecipes"))),this._showCraftableCheckbox.addClassNames("possibleRecipeCheckbox"),this._showCraftableCheckbox.on("change",function(e){i.filterCraftable(e)})),this.pagination=this.appendChild(new v),this.pagination.on("previous",function(){i._displayPage(i._currentPage-1)}),this.pagination.on("next",function(){i._displayPage(i._currentPage+1)}),this.pagination.on("page",function(e){i._displayPage(e)})}function o(){this.recipeBox.recipeList._selectRecipe(this.recipeBox)}function s(){this.recipeList._tapOnRecipeBoxHandler(this)}function a(e,t){this.recipeList._tapOnRecipeBoxItemHandler(this,e,t)}function r(){this.recipeList._selectRecipe(this)}i(1016);var l=i(191).inherits,c=i(235),u=i(483),d=i(29).getText,h=i(676),p=i(509),m=i(31),f=i(228),g=i(1017),_=i(383),v=i(828),y=i(248),b=i(580),w=i(252).simplifyString,M=0,T=8,C=3,I=25,A=!1;l(n,c),e.exports=n,n.prototype._setPageCount=function(e){var t=Math.ceil(e.length/I)||1;t!==this._pageCount&&(this._pageCount=t,this._currentPage=0,this.pagination.setCurrent(0),this.pagination.setPageCount(this._pageCount))},n.prototype._updatePageCount=function(e){var t=Math.ceil(e.length/I)||1;t!==this._pageCount&&(this._pageCount=t,this._displayPage(0),this.pagination.setPageCount(this._pageCount))},n.prototype._displayPage=function(e){this._currentPage!==e&&(e<0||e>this._pageCount-1||(this._currentPage=e,this.pagination.setCurrent(e),this._search()))},n.prototype.addRecipes=function(e,t,i){this.recipesList.clearContent(),this.recipesWrapper.addClassNames("spinner"),t=t||{},this.usingItemId=t.usingItemId,this.tappedRecipe=null;var n=this;if(i=i||function(){},0===e.length)return this._recipesPlaceholder.show(),this.recipesWrapper.delClassNames("spinner"),this._setPageCount(e),this.recipesWrapper.refresh(),i();this._recipesPlaceholder.hide(),this._nbCase=t.nbCase||this._nbCase,this._isItemDataPending||(this._ingredientsLine.hide(),this._searchLine.hide(),this._searchBar.addClassNames("spinner"),this.isInCraft&&(this._showCraftableCheckbox.hide(),this._checkboxWrapper.addClassNames("spinner")));var o=(new Date).getTime();this._timestamp=o;var s=[];t.nbCase&&t.nbCase<T?e.forEach(function(e){e.ingredientIds.length<=t.nbCase&&s.push(e)}):e.forEach(function(e){s.push(e)});for(var a={},r=[],l=this._currentPage===-1?0:this._currentPage,c=(l+1)*I<s.length,u=c?(l+1)*I:s.length,d=l*I;d<u;d+=1){var h=s[d];if(h){r.push(h);var f=h.ingredientIds;a[h.resultId]=!0;for(var g=0,_=f.length;g<_;g+=1){var v=f[g];a[v]=!0}}}a=Object.keys(a),p.getItems(a,function(a){return a?(console.error("Failed to get ingredients",a),i(a)):n._timestamp!==o?i():m.eachSeries(r,function(e,t){n._addRecipe(e,t)},function(o){if(o)return console.error(o),i(o);if(n._hasBeenReset())return i();if(t.nbCase){A=!1;for(var a=1;a<=T;a+=1){var r=a<=n._nbCase;n.filterNbSlots[a]=r,n.filterCheckboxes[a].toggleActivation(r)}A=!0}0===n._recipesData.length&&(n._recipesData=e),n.recipesWrapper.delClassNames("spinner"),n.recipesList.show(),n.recipesWrapper.refresh(),n.recipesWrapper.goToTop(),n._setPageCount(s),n._isItemDataPending||(n._isItemDataPending=!0,m.eachLimit(e,50,function(e,t){var i=[e.resultId].concat(e.ingredientIds);p.getItems(i,t)},function(e){return e?(console.error(e),i(e)):n._hasBeenReset()?i():(A=!0,n._searchLine.show(),n._ingredientsLine.show(),n._searchBar.delClassNames("spinner"),n.isInCraft&&(n._showCraftableCheckbox.show(),n._checkboxWrapper.delClassNames("spinner")),i())}))})})},n.prototype._addRecipe=function(e,t){var i=this;if(!p.items[e.resultId])return console.error(new Error("Recipe "+e.resultId+" is missing")),t();if(this._hasBeenReset())return t();var n=new g(e,{isInCraft:this.isInCraft,nbCases:this._nbCase,isMenuOnItemDisabled:this.isMenuOnItemDisabled});n.recipeList=this,i.recipesList.appendChild(n),f(n,{doubletapTimeout:1}),n.on("tap",s),n.on("itemTapped",a),n.on("craftButtonTapped",r),n.setupRecipe(function(e,s){if(e)return console.error(new Error("Cannot setup recipe for recipeId "+n.recipeId)),t(e);if(i.isInCraft&&n.craftableCount){var a=n.getItemSlot();_.setDraggable(a,{backgroundImage:a.image},"recipeList",{source:"recipeList",selectRecipe:o,recipeBox:n})}t(null,s)})},n.prototype._tapOnRecipeBoxItemHandler=function(e,t,i){this.shouldNotSelect||this.isInCraft||this.tappedRecipe||t.id!==this.usingItemId&&(this.tappedRecipe=e,i.select(),setTimeout(function(e){e.emit("itemTapped",t)},0,this))},n.prototype._tapOnRecipeBoxHandler=function(e){if(!this.shouldNotSelect)if(this.isInCraft)this.tappedRecipe&&this.tappedRecipe===e?this._selectRecipe(e):this._setTappedRecipe(e);else{if(this.tappedRecipe)return;this.tappedRecipe=e,e.addClassNames("tapped"),setTimeout(function(t){t.emit("itemTapped",p.items[e.recipeId])},0,this)}},n.prototype._setTappedRecipe=function(e){if(this.tappedRecipe&&this.tappedRecipe.rootElement){if(this.tappedRecipe===e)return;this.tappedRecipe.delClassNames("tapped")}e.addClassNames("tapped"),this.tappedRecipe=e},n.prototype._selectRecipe=function(e){this._setTappedRecipe(e),this.emit("recipeSelected",e.recipeId)},n.prototype.isRecipeCraftableFromInventory=function(e){var t=this.recipesList.getChild(e);return t.isCraftableFromBelongings(0)},n.prototype.filterCraftable=function(e){this._filterCraftableOnly=e,this._search()},n.prototype._search=function(){var e=this,t=this._searchInput.getValue();if(this._currentFilteredRecipesList=[],null===t||""===t)return this._recipesData.forEach(function(t){var i=e._filterCraftableOnly&&e._canUseThisRecipe(t.resultId),n=i||!e._filterCraftableOnly;e.filterNbSlots[t.ingredientIds.length]&&n&&e._currentFilteredRecipesList.push(t)}),this.addRecipes(this._currentFilteredRecipesList,{usingItemId:this.usingItemId});if(t.length<C)return y.showNotification(d("ui.common.searchFilterTooltip"),this._searchInput);t=w(t);var i=new RegExp(t,"i");this._recipesData.forEach(function(t){var n=e._filterCraftableOnly&&e._canUseThisRecipe(t.resultId),o=n||!e._filterCraftableOnly,s=p.items[t.resultId];if(!s)return console.error("item",t.resultId,"is missing");var a=w(s.nameId).search(i)!==-1;a&&e.filterNbSlots[t.ingredientIds.length]&&o&&e._currentFilteredRecipesList.push(t)}),this.addRecipes(this._currentFilteredRecipesList,{usingItemId:this.usingItemId})},n.prototype.highlightRecipe=function(e){if(this.selectedRecipe&&this.selectedRecipe.rootElement&&this.selectedRecipe.delClassNames("selected"),null!==e){var t=this.recipesList.getChild(e);t&&(t.addClassNames("selected"),this.selectedRecipe=t)}},n.prototype.reset=function(){this._isItemDataPending=!1,this._pageCount=null,this._currentPage=-1,this._recipesData=[],this.selectedRecipe=null,this.tappedRecipe=null,this.usingItemId=null,this._recipesPlaceholder.hide(),this.recipesList.hide(),this.recipesList.clearContent(),this.filterText="",this._searchInput.clear(),this._currentFilteredRecipesList=[],this._showCraftableCheckbox&&this._showCraftableCheckbox.deactivate()},n.prototype.refreshDisplayedRecipes=function(){this._search();for(var e=this.recipesList.getChildren(),t=0;t<e.length;t++){var i=e[t];i.refreshQuantities()}},n.prototype._canUseThisRecipe=function(e){for(var t=null,i=0;i<this._recipesData.length;i++)if(this._recipesData[i].resultId===e){t=this._recipesData[i];break}if(!t)return!1;for(i=0;i<t.ingredientIds.length;i++){var n=window.gui.playerData.belongings.getItemCounts(t.ingredientIds[i]),o=n[M];if(t.quantities&&t.quantities[i]>o)return!1}return!0},n.prototype._hasBeenReset=function(){return!this.recipesList||!this.recipesList.rootElement}},function(e,t){},function(e,t,i){function n(e,t){var i=this;u.call(this,"div",{className:"RecipeBox",name:e.resultId}),t=t||{},this.rawRecipe=e,this.recipeId=e.resultId,this.nbCases=t.nbCases||0,this.isMenuOnItemDisabled=!!t.isMenuOnItemDisabled,this._hasBeenDestroy=!1;var n=i.createChild("div",{className:"recipeTitle"});this._item=n.appendChild(new l({noDoubleTap:!0,forceQuantity:!0})),this.isMenuOnItemDisabled||this._item.setContextMenu("item",{}),this._recipeLeft=n.createChild("div",{className:"recipeLeft"});var o=n.createChild("div",{className:"recipeRight"});o.createChild("div",{className:"recipeLevel",text:a("ui.common.short.level")+" "+e.resultLevel});var s=e.ingredientIds.length;this.ingredients=[];var r=t.nbCases-s>=4,c=r?0:y[s];if(c>0&&window.gui.playerData.isSubscriber()){var p=Math.floor(c*h.BONUS_PACK_XPJOB/100);c+=' <span class="bonusXP">(+'+p+")</span>"}var m=o.createChild("div",{className:"recipeXP"});m.setHtml(a("ui.tooltip.monsterXpAlone",c)),r&&m.addClassNames("warningText"),this._ingredientsList=i.createChild("div",{className:"ingredientsList"}),t.isInCraft&&(this.craftButton=this._ingredientsList.appendChild(new d({addIcon:!0,className:["greenButton","recipeButton"],scaleOnPress:!0})),this.craftButton.on("tap",function(){i.emit("craftButtonTapped")})),this.on("destroy",function(){i._hasBeenDestroy=!0})}function o(e,t){var i="";if(1!==e.jobId){var n=1;if(t.type.id===v&&e.jobId===_&&t.recipeSlots>1)n=50;else switch(t.recipeSlots){case 3:n=10;break;case 4:n=20;break;case 5:n=40;break;case 6:n=60;break;case 7:n=80;break;case 8:n=100}i=a("ui.craft.recipesJobDetails",e.jobName,n)}return i}function s(){this.recipeBox.emit("itemTapped",this.dbItem,this)}i(1018);var a=i(29).getText,r=i(509),l=i(832),c=i(191).inherits,u=i(235),d=i(246),h=i(184),p=i(252).simplifyString,m=0,f=1,g=2,_=25,v=42,y={1:1,2:10,3:25,4:50,5:100,6:250,7:500,8:1e3};c(n,u),e.exports=n,n.prototype.setupRecipe=function(e){var t=this,i=this.rawRecipe,n=[this.recipeId].concat(i.ingredientIds),a=i.ingredientIds.length;r.getItems(n,function(n){if(n)return e(n);if(t._hasBeenDestroy)return e();var l=r.items[t.recipeId];if(!l)return e();t._item.setItem(l),t._item.recipeBox=t,t._item.on("tap",s),t.craftDetails=o(i,l),t._recipeLeft.createChild("div",{className:"recipeName",text:l.nameId}),t._recipeLeft.createChild("div",{className:"recipeSkillName",text:t.craftDetails});for(var c=l.nameId,u=0,d=0;d<a;d+=1){var h=i.ingredientIds[d],m=r.items[h];m?(c+=" "+m.nameId,t._createIngredientSlot(m,i.quantities[d]),u+=1):console.error("RecipeBox#setupRecipe: ingredientId",h,"from recipeId",t.recipeId,"is missing, just continue")}return t.nbIngredients=u,t.searchString=p(c),t.refreshQuantities(),e(null,t)})},n.prototype._createIngredientSlot=function(e,t){var i=this._ingredientsList.appendChild(new l({itemData:e,forceQuantity:!0,noDoubleTap:!0}));i.recipeBox=this,i.qtyNeeded=t,i.on("tap",s),this.isMenuOnItemDisabled||i.setContextMenu("item",{}),this.ingredients.push(i),this._refreshIngredientSlot(i)},n.prototype.refreshQuantities=function(){this.craftableCount=1/0,this.craftableRemoteCount=1/0,this.missingIngredientCount=0;for(var e=0;e<this.nbIngredients;e++)this._refreshIngredientSlot(this.ingredients[e]);this._item.setQuantity(this.craftableCount>0?"(x"+this.craftableCount+")":""),this.craftButton&&this.craftButton.toggleDisplay(this.craftableCount>0)},n.prototype._refreshIngredientSlot=function(e){var t=e.data.id,i=e.qtyNeeded,n=window.gui.playerData.belongings.getItemCounts(t),o=n[m],s=n[f],a=n[g],r=!!window.gui.playerData.equippedMount,l=o+(s||0)+(a||0);i>l&&this.missingIngredientCount++,this.craftableCount=Math.min(this.craftableCount,Math.floor(o/i)),this.craftableRemoteCount=Math.min(this.craftableRemoteCount,Math.floor(l/i));var c=o>=i?o:l,u="";u=o>=i?"quantityGood":l>=i?"quantityRemote":null===s||null===a&&r?"quantityUnknown":"quantityNoGood",e.setClassNames(["Slot","ItemSlot",u]),c=(c>99?"99+":c)+"/"+i,e.setQuantity(c)},n.prototype.getItemSlot=function(){return this._item},n.prototype.isCraftableFromBelongings=function(e){return this.craftableRemoteCount>0||this.missingIngredientCount<=e}},function(e,t){},function(e,t,i){function n(){c.call(this,{title:s("ui.zaap.prism"),className:"PrismVulnerabilityDateWindow",positionInfo:{left:"c",top:"c",width:400,height:256}});var e,t,i,n,o,p,m,f,g;this.once("open",function(){e=this.windowBody.createChild("div",{className:"subAreaName"}),t=this.windowBody.createChild("div",{className:"explanation"});var r=this.windowBody.createChild("div",{className:"selectorBox"});i=r.appendChild(new a({className:"hours"})),i.on("change",function(e){f=e});for(var c=0;c<10;c+=1)i.addOption("0"+c,c);for(c=10;c<24;c+=1)i.addOption(c,c);n=r.appendChild(new a({className:"minutes"})),n.on("change",function(e){g=e}),n.addOption("00",h[0]),n.addOption("30",h[30]);var _=this,v=this.windowBody.createChild("div",{className:"buttonBox"});o=v.appendChild(new l(s("ui.common.save"))),o.on("tap",function(){var e=u.time.timezoneOffset,t=e/1e3*60%60,i=e/36e5%24,n=4*(f-i)+(g-t);n<0&&(n+=96),window.dofus.sendMessage("PrismSettingsRequestMessage",{subAreaId:m.subAreaId,startDefenseTime:n}),d.close(_.id)}),p=v.appendChild(new l(s("ui.common.cancel"))),p.on("tap",function(){d.close(_.id)})}),this.on("open",function(o){m=o.prism;var a=o.vulnerableTime.getServerDate(),l=a.toString(),c=m.enrichData;e.setText(c.subAreaName+" ("+c.areaName+")");var u=window.gui.serversData.sessionConstants[r.SERVER_CONST_KOH_DURATION];t.setText(s("ui.prism.vulnerabilityHourInfos",Math.round(u/1e3/360)/10,l.hour,l.minute)),i.select(a.hour),n.select(h[a.minute]||h[0])})}i(1020);var o=i(191).inherits,s=i(29).getText,a=i(586),r=i(730).serverConstants,l=i(246).DofusButton,c=i(233),u=i(28),d=i(225),h={0:0,30:2};o(n,c),e.exports=n},function(e,t){},function(e,t,i){function n(){r.call(this,{className:"SocialGroupCreationWindow",title:"",positionInfo:{left:"c",top:"c",width:"80%",height:"90%"}});var e=this;this._isModeratorOrMore=!1,this.once("open",function(){e.addClassNames("spinner"),e.windowBody.hide(),e._createDom(),w.preloadImage("ui/slot.png",function(t){e.slotIconImage=t}),f.getAllDataTable(["EmblemSymbolCategories","EmblemSymbols","EmblemBackgrounds"],function(t,i){return t?console.error("SocialGroupCreationWindow: Failed to retrieve emblem data",t):(e.emblemBackgrounds=i.EmblemBackgrounds,e.emblemSymbols=i.EmblemSymbols,e.emblemSymbolCategories=i.EmblemSymbolCategories,e._generateSelectorOptions(),e._displayEmblemBackgrounds(i.EmblemBackgrounds),e._displayEmblemSymbols(i.EmblemSymbols),e._setupUI(),e.delClassNames("spinner"),e.windowBody.show(),e._updateUISize(),e.on("open",function(){e.addClassNames("spinner"),e._generateSelectorOptions(),e.windowBody.hide(),e.tabs.openTab("background"),e._setupUI(),e.delClassNames("spinner"),e.windowBody.show()}),void e.on("opened",function(){e._updateUISize()}))})});var t=window.gui;t.on("GuildCreationStartedMessage",function(){e.mode="guild",e.modification=!1,u.openDialog(e.id)}),t.on("GuildModificationStartedMessage",function(t){e.mode="guild",t.canChangeName&&t.canChangeEmblem?e.modification="all":t.canChangeName?e.modification="name":e.modification="emblem",u.openDialog(e.id)}),t.on("AllianceCreationStartedMessage",function(){e.mode="alliance",e.modification=!1,u.openDialog(e.id)}),t.on("AllianceModificationStartedMessage",function(t){e.mode="alliance",t.canChangeName&&t.canChangeEmblem&&t.canChangeTag?e.modification="all":t.canChangeName?e.modification="name":e.modification="emblem",u.openDialog(e.id)})}function o(e,t,i,n){var o=e.length;return!(o<t||o>i)||(window.gui.openSimplePopup(c(n,t,i)),!1)}i(1022);var s=i(248).addTooltip,a=i(191).inherits,r=i(233),l=i(29).getText,c=i(29).processText,u=i(225),d=i(586),h=i(246).DofusButton,p=i(1023),m=i(582),f=i(30),g=i(246),_=i(483),v=i(611),y=i(469),b=i(277),w=i(202),M=i(235),T=250,C=110,I=20;a(n,r),e.exports=n,n.prototype._setupUI=function(){if("alliance"===this.mode?(this.tagNameBox.show(),this.tagInput.show(),this.nameLabel.setText(l("ui.alliance.name")+l("ui.common.colon")),this.setTitle(l("ui.alliance.creation"))):(this.tagNameBox.hide(),this.tagInput.hide(),this.nameLabel.setText(l("ui.social.guildName")+l("ui.common.colon")),this.setTitle(l("ui.social.guildCreation"))),!this.modification)return this._generateRandomEmblem(),this.nameInput.enable(),this.nameInput.setValue(""),this.tagInput.enable(),this.tagInput.setValue(""),void this.cover.hide();var e=window.gui.playerData[this.mode].current;switch("alliance"===this.mode?(this.nameInput.setValue(e.allianceName),this.tagInput.setValue(e.allianceTag),this._setEmblem(e.allianceEmblem)):(this.nameInput.setValue(e.guildName),this._setEmblem(e.guildEmblem)),this.modification){case"all":this.nameInput.enable(),this.tagInput.enable(),this.cover.hide();break;case"name":this.nameInput.enable(),this.tagInput.enable(),this.cover.show();break;case"emblem":this.nameInput.disable(),this.tagInput.disable(),this.cover.hide()}},n.prototype._setEmblem=function(e){this.emblem.setValue(e,!0),this.bgColor=e.backgroundColor,this.bgId=e.backgroundShape,this.symbolColor=e.symbolColor,this.symbolId=e.symbolShape;for(var t=null,i=0;i<this.emblemSymbols.length;i+=1){var n=this.emblemSymbols[i];if(n.id===this.symbolId){t=n;break}}t?this.selector.select(t.categoryId):console.error("SocialGroupCreationWindow._setEmblem: emblemSymbol is null for symbolId",this.symbolId)},n.prototype._generateSelectorOptions=function(){if(this.emblemSymbolCategories){this.selector.clearContent(),this._isModeratorOrMore=window.gui.playerData.isModeratorOrMore();for(var e=0;e<this.emblemSymbolCategories.length;e++){var t=this.emblemSymbolCategories[e];(this._isModeratorOrMore||13!==t.id)&&this.selector.addOption(t.nameId,t.id)}this.selector.select(1)}},n.prototype._generateRandomEmblem=function(){this.bgColorPicker.generateRandomColor(),this.motifColorPicker.generateRandomColor();var e=Math.round(Math.random()*(this.emblemBackgrounds.length-1)),t=Math.round(Math.random()*(this.emblemSymbols.length-(this._isModeratorOrMore?2:1)));this._setBackgroundShape(this.emblemBackgrounds[e].id),this._setSymbolShape(this.emblemSymbols[t].iconId)},n.prototype._setBackgroundShape=function(e){this.emblem.setValue({backgroundShape:e}),this.bgId=e},n.prototype._setSymbolShape=function(e){this.emblem.setValue({symbolShape:e}),this.symbolId=e},n.prototype._displayEmblemBackgrounds=function(e){function t(){i._setBackgroundShape(this.id)}for(var i=this,n=[],o=0;o<e.length;o++)n.push("gfx/emblems/icons/back/"+e[o].id+".png");w.preloadImages(n,function(n){for(var o=0;o<n.length;o++){var s=i.backgroundScroller.content.appendChild(new g({className:"icon"},t));s.setStyle("backgroundImage",n[o]+", "+i.slotIconImage),s.id=e[o].id}i.backgroundScroller.refresh()})},n.prototype._displayEmblemSymbols=function(e){function t(){i._setSymbolShape(this.id)}var i=this,n=[];i.notColorizable=[];for(var o=0;o<e.length;o++)n.push("gfx/emblems/icons/up/"+e[o].iconId+".png"),e[o].colorizable||i.notColorizable.push(e[o].id);w.preloadImages(n,function(n){for(var o=0;o<n.length;o++){var s=i.symbolScroller.content.appendChild(new g({className:["icon","white"]},t));s.setStyle("backgroundImage",n[o]+", "+i.slotIconImage),s.categoryId=e[o].categoryId,s.id=e[o].id}i.selector.select(1)})},n.prototype._createDom=function(){function e(e){i.bgColor!==e.hex.substr(1)&&(i.bgColor=parseInt(e.hex.substr(1),16),i.emblem.setValue({backgroundColor:e.rgb}))}function t(e){i.symbolColor!==e.hex.substr(1)&&(i.symbolColor=parseInt(e.hex.substr(1),16),i.notColorizable.indexOf(i.symbolId)===-1&&i.emblem.setValue({symbolColor:e.rgb}))}var i=this,n=this.windowBody.createChild("div",{className:"guildNameBox"});this.nameLabel=n.createChild("div",{className:"label"});var a=n.createChild("div",{className:"info"});s(a,l("ui.social.nameRules"),{openOnTap:!0});var r=this.nameInput=this.windowBody.appendChild(new m({className:"socialInputBox",attr:{type:"text",maxlength:30}})),c=this.tagNameBox=this.windowBody.createChild("div",{className:"tagNameBox"});c.createChild("div",{className:"label",text:l("ui.alliance.tagInfo")+l("ui.common.colon")}),a=c.createChild("div",{className:"info"}),s(a,l("ui.alliance.tagRules"),{openOnTap:!0});var u=this.tagInput=this.windowBody.appendChild(new m({className:"socialInputBox",attr:{type:"text",maxlength:30}}));this.emblem=this.windowBody.appendChild(new y),this.windowBody.createChild("div",{className:"text",text:l("ui.social.createEmblem")+l("ui.common.colon")});var f=this.tabs=this.windowBody.appendChild(new v);this.cover=f.content.createChild("div",{className:"cover"});var g=new M("div",{className:"backgroundTab"}),w=new M("div",{className:"motifTab"});f.addTab(l("ui.social.emblemBack"),g,"background"),f.addTab(l("ui.social.emblemUp"),w,"motif"),f.openTab("background"),this.backgroundScroller=g.appendChild(new _({className:"iconScroller"})),this.bgColorPicker=g.appendChild(new p({tintWidth:T,tintHeight:C,lumWidth:I})),this.bgColorPicker.on("colorChanged",e),this.bgColorPicker.on("newColor",e);var A=w.createChild("div",{className:"motifContainer"});this.selector=A.appendChild(new d),this.selector.on("change",function(e){var t=i.symbolScroller.content.getChildren();e=parseInt(e,10);for(var n=0;n<t.length;n++)e!==t[n].categoryId?t[n].hide():t[n].show();i.symbolScroller.refresh()}),this.symbolScroller=A.appendChild(new _({className:"iconScroller"})),w.once("opened",function(){i.symbolScroller.refresh()}),this.motifColorPicker=w.appendChild(new p({tintWidth:T,tintHeight:C,lumWidth:I})),this.motifColorPicker.on("colorChanged",t),this.motifColorPicker.on("newColor",t);var S=this.windowBody.createChild("div",{className:"buttonContainer"}),E=S.appendChild(new h(l("ui.common.validation")));E.on("tap",function(){var e=r.getValue(),t={symbolShape:i.symbolId,symbolColor:i.symbolColor,backgroundShape:i.bgId,backgroundColor:i.bgColor};if("alliance"===i.mode){if(!o(e,b.MIN_ALLIANCENAME_LEN,b.MAX_ALLIANCENAME_LEN,l("ui.alliance.invalidLengthName")))return;var n=u.getValue();if(!o(n,b.MIN_ALLIANCETAG_LEN,b.MAX_ALLIANCETAG_LEN,l("ui.alliance.invalidLengthTag")))return;if(!i.modification)return window.dofus.sendMessage("AllianceCreationValidMessage",{allianceName:e,allianceTag:n,allianceEmblem:t});switch(i.modification){case"all":window.dofus.sendMessage("AllianceModificationValidMessage",{allianceName:e,allianceTag:n,Alliancemblem:t});break;case"emblem":window.dofus.sendMessage("AllianceModificationEmblemValidMessage",{Alliancemblem:t});break;case"name":window.dofus.sendMessage("AllianceModificationNameAndTagValidMessage",{allianceName:e,allianceTag:n})}}else{if(!o(e,b.MIN_GUILDNAME_LEN,b.MAX_GUILDNAME_LEN,l("ui.alliance.invalidLengthName")))return;if(!i.modification)return window.dofus.sendMessage("GuildCreationValidMessage",{guildName:e,guildEmblem:t});switch(i.modification){case"all":window.dofus.sendMessage("GuildModificationValidMessage",{guildName:e,guildEmblem:t});break;case"emblem":window.dofus.sendMessage("GuildModificationEmblemValidMessage",{guildEmblem:t});break;case"name":window.dofus.sendMessage("GuildModificationNameValidMessage",{guildName:e})}}})},n.prototype._updateUISize=function(){var e=this.bgColorPicker.rootElement.clientHeight,t=this.bgColorPicker.rootElement.clientWidth;0!==e&&0!==t&&(this.bgColorPicker.updateDimensions(t,e,I),this.motifColorPicker.updateDimensions(t,e,I))}},function(e,t){},function(e,t,i){function n(e){function t(e,t){this.deltaX=e.x-t.left-this.picker.x,this.deltaY=e.y-t.top-this.picker.y,this.box=t}function i(){p.emit("colorChanged",p.getCurrentColor())}function n(e){var t=e.x-this.box.left,n=e.y-this.box.top;p._cursorMove({x:t,y:n},this.box,this.panelType),i()}function o(e){var t=e.x-this.box.left-this.deltaX,i=e.y-this.box.top-this.deltaY;p._cursorMove({x:t,y:i},this.box,this.panelType)}function r(){m.open({x:0,y:0,defaultValue:""})}var d=void 0===e;e=e||{};var p=this;l.call(this,"div",{className:"ColorPicker"});var m=this.appendChild(new c);m.on("confirm",function(e){var t=u.hexToRgb(e);t&&(p.setCurrentColor([t.r,t.g,t.b]),i())}),this.params={tintWidth:e.tintWidth||162,tintHeight:e.tintHeight||110,lumWidth:e.lumWidth||16,lumHeight:e.lumHeight||110},this.currentTint=[255,0,0],this.currentColor=[255,0,0],this.tintWrapper=this.createChild("div",{className:"tintWrapper"}),this.tintCanvas=this.tintWrapper.createChild("canvas",{className:"tintCanvas"}),this.tintCanvas.rootElement.width=this.params.tintWidth,this.tintCanvas.rootElement.height=this.params.tintHeight,s(this.tintCanvas),a(this.tintCanvas),this.tintCanvas.panelType="tint",this.tintCanvas.on("slideStart",t),this.tintCanvas.on("slide",o),this.tintCanvas.on("slideEnd",i),this.tintCanvas.on("tapstart",t),this.tintCanvas.on("tap",n),this.tintCanvas.on("doubletap",r),this.tintPicker=this.tintWrapper.createChild("div",{className:"tintPicker"}),this.tintCanvas.picker=this.tintPicker,this.lumWrapper=this.createChild("div",{className:"lumWrapper"}),this.lumCanvas=this.lumWrapper.createChild("canvas",{className:"lumCanvas"}),this.lumCanvas.rootElement.width=1,this.lumCanvas.rootElement.height=this.params.lumHeight,s(this.lumCanvas),a(this.lumCanvas),this.lumCanvas.panelType="lum",this.lumCanvas.on("slideStart",t),this.lumCanvas.on("slide",o),this.lumCanvas.on("slideEnd",i),this.lumCanvas.on("tapstart",t),this.lumCanvas.on("tap",n);var f=this.lumPicker=this.lumWrapper.createChild("div",{className:"lumPicker"});this.lumCanvas.picker=f,f.dark=f.createChild("div",{className:["triangle","black"]}),f.bright=f.createChild("div",{className:["triangle","white"]}),d||this.updateDimensions(this.params.tintWidth+this.params.lumWidth+h,this.params.tintHeight,this.params.lumWidth)}i(1024);var o=i(424),s=i(232),a=i(228),r=i(191).inherits,l=i(235),c=i(1025),u=i(424),d=40,h=10,p=1e-5,m=127.5,f=[[255,0,0],[255,255,0],[0,255,0],[0,255,255],[0,0,255],[255,0,255],[255,0,0]];r(n,l),e.exports=n,n.prototype.updateDimensions=function(e,t,i){this.params.lumWidth=i||Math.min(e/5,d);var n=e-this.params.lumWidth-h;n=n>0?n:this.params.tintWidth,this.params.tintWidth=n,this.params.tintHeight=t,this.tintCanvas.rootElement.width=n,this.tintCanvas.rootElement.height=t,this.tintCanvas.setStyles({width:n+"px",height:t+"px"}),this.params.lumHeight=t,this.lumCanvas.rootElement.height=t,this.lumCanvas.setStyles({width:this.params.lumWidth+"px",height:this.params.lumHeight+"px"}),this.fillTint(),this.updateLuminosity(),this._setPickerPosition(this.tintPicker,0,0),this._setPickerPosition(this.lumPicker,0,t/2)},n.prototype._lumCoordinatesToColor=function(e){var t=e/(this.params.lumHeight/2),i=t<1?[255,255,255]:this.currentTint,n=t<1?this.currentTint:[0,0,0],o=t%1;return[i[0]*(1-o)+n[0]*o,i[1]*(1-o)+n[1]*o,i[2]*(1-o)+n[2]*o]},n.prototype._tintCoordinatesToColor=function(e,t){var i=this.params.tintWidth/(f.length-1),n=Math.floor(e/i),o=e/i%1,s=f[n][0],a=f[n+1][0],r=f[n][1],l=f[n+1][1],c=f[n][2],u=f[n+1][2],d=s*(1-o)+a*o,h=r*(1-o)+l*o,p=c*(1-o)+u*o,g=t/this.params.tintHeight,_=d*(1-g)+m*g,v=h*(1-g)+m*g,y=p*(1-g)+m*g;return[_,v,y]},n.prototype._colorToTintAndLum=function(e){var t=this.params.tintWidth,i=this.params.tintHeight,n=i/2,o=Math.min.apply(Math,e),s=Math.max.apply(Math,e),a=e.indexOf(o),r=e.indexOf(s);if(a===r){var l=(1-o/255)*i-p;return[0,i-p,l]}var c;c=0!==a&&0!==r?0:1!==a&&1!==r?1:2;var u,d=e[r],h=e[c],g=e[a],_=[[null,3,2],[4,null,5],[1,0,null]],v=_[a][c],y=(h-g)/(d-g),b=v%2?1-y:y,w=t/(f.length-1),M=w*(v+b)%t,T=(g+d)/255;u=T<=1?255*g/m/(d+g):(255*d-65025)/(m*(d+g)-65025);var C=u*i,I=n+(1-T)/2*i;return[M,C,I]},n.prototype.setCurrentColor=function(e){var t=this._colorToTintAndLum(e);this.cursorMoveTo(t[0],t[1],"tint",!0),this.cursorMoveTo(0,t[2],"lum",!0)},n.prototype.updateLuminosity=function(){for(var e=this.lumCanvas.rootElement,t=e.getContext("2d"),i=t.getImageData(0,0,e.width,e.height),n=0;n<this.params.lumHeight;n++){var o=this._lumCoordinatesToColor(n),s=4*n;i.data[s]=Math.round(o[0]),i.data[s+1]=Math.round(o[1]),i.data[s+2]=Math.round(o[2]),i.data[s+3]=255}t.putImageData(i,0,0)},n.prototype.cursorMoveTo=function(e,t,i,n){this._setPickerPosition(this[i+"Picker"],e,t),"tint"===i&&(this.currentTint=this._tintCoordinatesToColor(e,t),this.updateLuminosity()),this.currentColor=this._lumCoordinatesToColor(this.lumPicker.y),n||this.emit("newColor",this.getCurrentColor())},n.prototype.randomize=function(e,t){var i=this[e+"Canvas"].rootElement,n=Math.random()*i.width,o=Math.random()*i.height;this.cursorMoveTo(n,o,e,t)},n.prototype.generateRandomColor=function(e){this.randomize("tint",e),this.randomize("lum",e)},n.prototype._cursorMove=function(e,t,i){var n=this[i+"Canvas"].rootElement,o=e.x,s=e.y,a=n.width/t.width,r=n.height/t.height;o=Math.round(o*a),s=Math.round(s*r),o=Math.max(0,Math.min(o,n.width-1)),s=Math.max(0,Math.min(s,n.height-1)),this.cursorMoveTo(o,s,i)},n.prototype.fillTint=function(){for(var e=this.tintCanvas.rootElement,t=e.getContext("2d"),i=t.getImageData(0,0,e.width,e.height),n=0;n<this.params.tintWidth;n++)for(var o=0;o<this.params.tintHeight;o++){var s=this._tintCoordinatesToColor(n,o),a=4*(o*this.params.tintWidth+n);i.data[a]=Math.round(s[0]),i.data[a+1]=Math.round(s[1]),i.data[a+2]=Math.round(s[2]),i.data[a+3]=255}t.putImageData(i,0,0)},n.prototype.getCurrentColor=function(){var e=this.currentColor,t=[Math.round(e[0]),Math.round(e[1]),Math.round(e[2])];return{rgb:t,hex:o.colorArrayToHexa(t)}},n.prototype._setPickerPosition=function(e,t,i){if(e.setStyle("webkitTransform","translate3d("+t+"px,"+i+"px,0)"),e.x=t,e.y=i,e===this.lumPicker){var n=i/this.params.lumHeight>.5?1:0;e.bright.setStyle("opacity",n),e.dark.setStyle("opacity",1-n)}},n.prototype.reset=function(){this._setPickerPosition(this.tintPicker,0,0),this.currentTint=this._tintCoordinatesToColor(0,0),
this.updateLuminosity(),this._setPickerPosition(this.lumPicker,0,this.params.lumHeight/2),this.currentColor=this._lumCoordinatesToColor(this.lumPicker.y)},n.prototype.getCursorPosition=function(e){var t=this[e+"Picker"];return{x:t.x,y:t.y}}},function(e,t){},function(e,t,i){function n(){function e(){t.closeHex(),t.emit("confirm",t.currentValue)}var t=this;c.call(this,"div",{className:"HexSelector",hidden:!0}),this.close=this.appendChild(new a({className:["simpleButton","closeBtn"]})),this.createChild("div",{className:"hexLabel",text:"0x"}),this.inputBox=this.appendChild(new r({className:"hexInputBox",attr:{maxlength:6}},e)),this.confirm=this.appendChild(new a({className:["simpleButton","confirmBtn"]})),this.currentValue=0,this.confirm.on("tap",e),this.close.on("tap",function(){t.closeHex()}),this.inputBox.on("change",function(e){t.currentValue=e})}i(1026);var o=i(250).getElementPositionAt,s=i(191).inherits,a=i(246),r=i(582),l=i(227),c=i(235),u={opacity:0,webkitTransform:"scale(0.8)"},d={opacity:1,webkitTransform:"scale(1)"};s(n,c),e.exports=n,n.prototype.position=function(e,t){var i=o(this,e,t);this.setStyles({left:i.x+"px",top:i.y+"px"})},n.prototype.open=function(e){function t(){delete i.openTweener,i.inputBox.focus(),i.emit("opened")}var i=this;return e=e||{},void 0!==e.placeholder&&void 0===e.defaultValue?(this.inputBox.setPlaceholder(e.placeholder),this.currentValue=""):void 0!==e.defaultValue&&(this.currentValue=e.defaultValue),this.inputBox.setValue(this.currentValue),this.show(),e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&this.position(e.x,e.y),this.setStyles(u),this.openTweener?(this.openTweener.cancel(),t()):void(this.openTweener=l.tween(this,d,{time:150,delay:0,easing:"ease-out"},t))},n.prototype.closeHex=function(){function e(){delete t.closeTweener,t.hide(),t.emit("closed"),t.inputBox.blur()}var t=this;return this.closeTweener?(this.closeTweener.cancel(),e()):void(this.closeTweener=l.tween(this,u,{time:150,delay:0,easing:"ease-out"},e))}},function(e,t){},function(e,t,i){function n(){d.call(this,{className:"AllianceCardWindow",positionInfo:{top:"c",left:"c",width:400,height:380}}),this.once("open",function(){this._createDom()}),this.on("open",function(e){this._setAlliance(e)})}function o(e){var t=new a({width:25,height:25});t.setValue(e.guildEmblem,!0);var i=new h("div",{text:e.guildName});return m(i),i.on("tap",function(){r.openGuildCard(e.guildId)}),[t,i,e.guildLevel]}i(1028);var s=i(28).DofusDate,a=i(469),r=i(526),l=i(29).getText,c=i(191).inherits,u=i(735),d=i(233),h=i(235),p=i(225),m=i(228);c(n,d),n.prototype._createDom=function(){var e=this.windowBody.createChild("div",{className:"description"});this.emblem=e.appendChild(new a({width:70,height:70}));var t=e.createChild("div",{className:"labelBox"});t.createChild("div",{className:"label",text:l("ui.alliance.tag")+l("ui.common.colon")}),t.createChild("div",{className:"label",text:l("ui.social.guilds")+l("ui.common.colon")}),t.createChild("div",{className:"label",text:l("ui.common.members")+l("ui.common.colon")}),t.createChild("div",{className:"label",text:l("ui.common.creationDate")+l("ui.common.colon")});var i=e.createChild("div",{className:"valueBox"});this.tag=i.createChild("div",{className:"value"}),this.guilds=i.createChild("div",{className:"value"}),this.members=i.createChild("div",{className:"value"}),this.creationDate=i.createChild("div",{className:"value"}),this.prisms=this.windowBody.createChild("div",{className:"prisms"}),this.guildList=this.windowBody.appendChild(new u({colCount:3,headerContent:["",l("ui.common.name"),l("ui.common.level")]}))},n.prototype.display=function(e){this.openState?(this._setAlliance(e),p.focusWindow("allianceCard")):p.open("allianceCard",e)},n.prototype._setAlliance=function(e){var t=e.infos,i=e.guilds;this.setTitle(l("ui.common.alliance")+" - "+t.allianceName),this.emblem.setValue(t.allianceEmblem,!0),this.tag.setText("["+t.allianceTag+"]"),this.guilds.setText(i.length);var n=new s(t.creationDate).getServerDate().toString(!1);this.creationDate.setText(n.date),this.prisms.setText(l("ui.prism.nbPrisms",e.controlledSubareaIds.length)),this.guildList.clearContent();for(var a=0,r=0,c=i.length;r<c;r+=1){var u=i[r];a+=u.nbMembers,this.guildList.addRow(o(u))}this.members.setText(a)},e.exports=n},function(e,t){},function(e,t,i){function n(){p.call(this,{className:"GuildCardWindow",positionInfo:{top:"c",left:"c",width:400,height:420}}),this.once("open",function(){this._createDom()}),this.on("open",function(e){this._setGuild(e)})}function o(e){var t=new m("div",{text:e.name});return g(t),t.on("tap",function(){window.gui.openContextualMenu("player",{playerName:e.name,playerId:e.id,hasGuild:!0})}),[t,e.level]}i(1030);var s=i(630),a=i(248).addTooltip,r=i(28).DofusDate,l=i(469),c=i(29).getText,u=i(191).inherits,d=i(1031),h=i(735),p=i(233),m=i(235),f=i(225),g=i(228);u(n,p),n.prototype._createDom=function(){var e=this.windowBody.createChild("div",{className:"description"});this.emblem=e.appendChild(new l({width:70,height:70}));var t=e.createChild("div",{className:"labelBox"});t.createChild("div",{className:"label",text:c("ui.common.level")+c("ui.common.colon")}),t.createChild("div",{className:"label",text:c("ui.guild.right.leader")+c("ui.common.colon")}),t.createChild("div",{className:"label",text:c("ui.common.members")+c("ui.common.colon")}),t.createChild("div",{className:"label",text:c("ui.common.creationDate")+c("ui.common.colon")});var i=this,n=e.createChild("div",{className:"valueBox"});this.level=n.createChild("div",{className:"value"}),this.leader=n.createChild("div",{className:["value","link"]}),g(this.leader),this.leader.on("tap",function(){window.gui.openContextualMenu("player",{playerName:i._leaderName,playerId:i._leaderId,hasGuild:!0})}),this.members=n.createChild("div",{className:"value"}),this.creationDate=n.createChild("div",{className:"value"}),this.perceptors=this.windowBody.createChild("div",{className:"perceptors"}),this._publicMsg=new d(this.windowBody,{className:"publicMsg"}),this.memberList=this.windowBody.appendChild(new h({colCount:2,headerContent:[c("ui.common.name"),c("ui.common.level")]}));var o=this.windowBody.createChild("div",{className:"alliance"}),r=o.createChild("div",{className:"value"});this.allianceLabel=r.createChild("span"),this.allianceName=r.createChild("span",{className:"link"}),g(r),r.on("tap",function(){s.openAllianceCard(i._allianceId)}),this.allianceInvite=o.createChild("div",{className:"inviteBtn"}),this.allianceInviteTooltip=new m("div"),a(this.allianceInvite,this.allianceInviteTooltip),this.allianceInvite.on("tap",function(){window.dofus.sendMessage("AllianceInvitationMessage",{targetId:i._leaderId})})},n.prototype.display=function(e){this.openState?(this._setGuild(e),f.focusWindow("guildCard")):f.open("guildCard",e)},n.prototype._setGuild=function(e){var t=e.infos,i=e.members;this.setTitle(c("ui.common.guild")+" - "+t.guildName),this.emblem.setValue(t.guildEmblem,!0),this.level.setText(t.guildLevel),this.members.setText(t.nbMembers);var n=new r(e.creationDate).getServerDate().toString(!1);this.creationDate.setText(n.date),this._leaderId=t.leaderId,this._leaderName=i[0].name,this.leader.setText(this._leaderName),this.perceptors.setText(c("ui.guild.taxcollectorsCurrentlyCollecting",e.nbTaxCollectors,e.nbTaxCollectors)),this._publicMsg.setText(e.publicMsg),this.memberList.clearContent();for(var s=0,a=i.length;s<a;s+=1)this.memberList.addRow(o(i[s]));var l=e.allianceInfos;if(l)this.allianceLabel.setText(c("ui.common.alliance")+c("ui.common.colon")),this.allianceName.setText(l.allianceName),this._allianceId=l.allianceId,this.allianceInvite.hide();else{this.allianceLabel.setText(c("ui.alliance.noAllianceForThisGuild")),this.allianceName.setText("");var u=window.gui.playerData.alliance;this.allianceInviteTooltip.setText(c("ui.alliance.inviteLeader",this._leaderName)),this.allianceInvite.toggleDisplay(u.hasAlliance()&&u.isBoss())}},e.exports=n},function(e,t){},function(e,t,i){function n(e,t){t=t||{},this._text="",this._isPartHidden=!1,this._displayDiv=e.createChild("div",{className:["longTextDisplay",t.className]}),s(this._displayDiv,o),this._displayDiv.longText=this,this._textDiv=this._displayDiv.createChild("div",{className:"longTextContent"}),this._showAllBtn=this._displayDiv.createChild("div",{className:"longTextBtn"}),r(this._displayDiv);var i=this._tapHandler.bind(this);this._displayDiv.on("tap",i),this._displayDiv.on("longTap",i)}function o(){return this.longText._text}i(1032);var s=i(248).addTooltip,a=i(584),r=i(228),l=i(235);e.exports=n,n.prototype.setText=function(e){this._text=e,this._textDiv.setText(e),this.refresh()},n.prototype.refresh=function(){this._isPartHidden=this._textDiv.rootElement.clientHeight>this._displayDiv.rootElement.clientHeight,this._showAllBtn.toggleDisplay(this._isPartHidden)},n.prototype._tapHandler=function(){if(this._isPartHidden){var e=new l("div",{className:"longTextTooltip",text:this._text});a.showClosableNotification(e,this._displayDiv,{centerOnTarget:!0})}}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"guildHouseInfoWindow",positionInfo:{top:"c",left:"c",width:450,height:380}}),this.rights=[],this.rightsText=[a("ui.guildHouse.Right1"),a("ui.guildHouse.Right2"),a("ui.guildHouse.Right4"),a("ui.guildHouse.Right8"),a("ui.guildHouse.Right16"),a("ui.guildHouse.Right32"),a("ui.guildHouse.Right64"),a("ui.guildHouse.Right128"),a("ui.guildHouse.Right256")],this.setupDom(),this.on("open",this.open)}i(1034);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(934),l=i(735),c=i(30),u=9;o(n,s),e.exports=n,n.prototype.setupDom=function(){this.tabs=this.windowBody.appendChild(new r({className:"tabs"}));var e={colIds:["content"],minRows:10};this.rights=this.windowBody.appendChild(new l(e)),this.skills=this.windowBody.appendChild(new l(e)),this.tabs.addTab(a("ui.social.guildHouseRights"),this.rights),this.tabs.addTab(a("ui.common.abilities"),this.skills),this.tabs.openTab(0)},n.prototype.open=function(e){var t,i=this,n=e.guildshareParams,o=e.skillListIds;for(this.windowTitle.setText(e.houseName),this.tabs.openTab(0),this.rights.clearContent(),this.skills.clearContent(),t=0;t<u;t++)n>>t&1&&this.rights.addRow({content:this.rightsText[t]});c.getData("Skills",o,function(e,n){for(e&&console.error("Failed to retrieve skills data",e),t=0;t<n.length;t++)i.skills.addRow([n[t].nameId])})}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"GuildHouseSettingWindow",positionInfo:{left:"c",top:"c",width:500,height:490}});var e=this;this.checkboxes=[],this.once("open",function(){e._setupDom(),e.setupSockets()}),this.on("open",function(){var t=window.gui.playerData.guild.current;t&&e.emblemLogo.setValue({guild:t})})}i(1036);var o=i(191).inherits,s=i(233),a=i(225),r=i(246).DofusButton,l=i(676),c=i(29).getText,u=i(469),d=i(483);o(n,s),e.exports=n,n.prototype._setupDom=function(){var e=this,t=this.windowBody.createChild("div",{className:["container","topContainer"]});this.emblemLogo=t.appendChild(new u({width:100,height:100}));var i=t.createChild("div",{className:"content"});this.checkboxes.push(i.appendChild(new l(c("ui.common.guildHouseEnabledForThisHouse")))),i.createChild("div",{className:"description",text:c("ui.common.guildHouseNotice")});var n=this.windowBody.createChild("div",{className:["container","bottomContainer"]}),o=n.appendChild(new d({className:"scroller"})),s=o.content,h=this.doorEmblem=s.createChild("div",{className:"section"});h.createChild("div",{className:"title",text:c("ui.common.guildHouseDisplayEmblemOnDoorTitle")+":"}),this.checkboxes.push(h.appendChild(new l(c("ui.common.guildHouseDisplayEmblemForGuild")))),this.checkboxes.push(h.appendChild(new l(c("ui.common.guildHouseDisplayEmblemForOthers")))),h=this.houseAccess=s.createChild("div",{className:"section"}),h.createChild("div",{className:"title",text:c("ui.common.guildHouseHouseAccessTitle")+":"}),this.checkboxes.push(h.appendChild(new l(c("ui.common.guildHouseAccessHouseAllowGuildmates")))),this.checkboxes.push(h.appendChild(new l(c("ui.common.guildHouseAccessHouseDenyOthers")))),h=this.chests=s.createChild("div",{className:"section"}),h.createChild("div",{className:"title",text:c("ui.common.guildHouseSafesAccessTitle")+":"}),this.checkboxes.push(h.appendChild(new l(c("ui.common.guildHouseRight32")))),this.checkboxes.push(h.appendChild(new l(c("ui.common.guildHouseRight64")))),h=this.miscellaneous=s.createChild("div",{className:"section"}),h.createChild("div",{className:"title",text:c("ui.common.guildHouseOtherTitle")+":"}),this.checkboxes.push(h.appendChild(new l(c("ui.common.guildHouseAllowTeleport")))),this.checkboxes.push(h.appendChild(new l(c("ui.common.guildHouseAllowRespawn"))));var p=this.windowBody.createChild("div",{className:"buttonContainer"}),m=p.appendChild(new r(c("ui.common.validation")));m.on("tap",function(){for(var t=0,i=0;i<e.checkboxes.length;i++)e.checkboxes[i].isActivate()&&(t+=1<<i);var n=e.checkboxes[0].isActivate();window.dofus.sendMessage("HouseGuildShareRequestMessage",{enable:n,rights:t}),a.close(e.id)}),this.checkboxes[0].on("activate",function(){e.enableContainers()}),this.checkboxes[0].on("deactivate",function(){e.disableContainers()}),o.refresh()},n.prototype.updateCheckboxes=function(e){for(var t=0;t<this.checkboxes.length;t++)e>>t&1?this.checkboxes[t].activate():this.checkboxes[t].deactivate()},n.prototype.enableContainers=function(){this.doorEmblem.delClassNames("disabled"),this.houseAccess.delClassNames("disabled"),this.chests.delClassNames("disabled"),this.miscellaneous.delClassNames("disabled");for(var e=0;e<this.checkboxes.length;e++)this.checkboxes[e].enable()},n.prototype.disableContainers=function(){this.doorEmblem.addClassNames("disabled"),this.houseAccess.addClassNames("disabled"),this.chests.addClassNames("disabled"),this.miscellaneous.addClassNames("disabled");for(var e=1;e<this.checkboxes.length;e++)this.checkboxes[e].disable()},n.prototype.setupSockets=function(){var e=this;window.gui.on("HouseGuildRightsMessage",function(t){e.windowTitle.setText(c("ui.common.houseOwnerName",t.guildInfo.guildName));var i=t.guildInfo.guildEmblem;e.emblemLogo.setValue(i,!0),e.updateCheckboxes(t.rights),e.enableContainers()}),window.gui.on("HouseGuildNoneMessage",function(){for(var t=0;t<e.checkboxes.length;t++)e.checkboxes[t].deactivate();e.disableContainers()})}},function(e,t){},function(e,t,i){function n(){function e(e){t.windowTitle.setText(e.name+" - "+a("ui.common.short.level")+" "+e.level),t._updateContent(e)}var t=this;o.call(this,{className:"GuildMemberRightsWindow",positionInfo:{left:"c",top:"c",width:450,height:490}}),this.rightCheckboxes=[],this.rightNames=[{right:m.GUILD_RIGHT_BOSS,label:a("ui.social.guildRightsAllRights")},{right:m.GUILD_RIGHT_MANAGE_GUILD_BOOSTS,label:a("ui.social.guildRightsBoost")},{right:m.GUILD_RIGHT_MANAGE_RIGHTS,label:a("ui.social.guildRightsRights")},{right:m.GUILD_RIGHT_INVITE_NEW_MEMBERS,label:a("ui.social.guildRightsInvit")},{right:m.GUILD_RIGHT_BAN_MEMBERS,label:a("ui.social.guildRightsBann")},{right:m.GUILD_RIGHT_MANAGE_XP_CONTRIBUTION,label:a("ui.social.guildRightsPercentXP")},{right:m.GUILD_RIGHT_MANAGE_MY_XP_CONTRIBUTION,label:a("ui.social.guildRightManageOwnXP")},{right:m.GUILD_RIGHT_MANAGE_RANKS,label:a("ui.social.guildRightsRank")},{right:m.GUILD_RIGHT_DEFENSE_PRIORITY,label:a("ui.social.guildRightsPrioritizeMe")},{right:m.GUILD_RIGHT_HIRE_TAX_COLLECTOR,label:a("ui.social.guildRightsHiretax")},{right:m.GUILD_RIGHT_COLLECT,label:a("ui.social.guildRightsCollect")},{right:m.GUILD_RIGHT_COLLECT_MY_TAX_COLLECTOR,label:a("ui.social.guildRightsCollectMy")},{right:m.GUILD_RIGHT_USE_PADDOCKS,label:a("ui.social.guildRightsMountParkUse")},{right:m.GUILD_RIGHT_ORGANIZE_PADDOCKS,label:a("ui.social.guildRightsMountParkArrange")},{right:m.GUILD_RIGHT_TAKE_OTHERS_MOUNTS_IN_PADDOCKS,label:a("ui.social.guildRightsManageOtherMount")},{right:m.GUILD_RIGHT_SET_ALLIANCE_PRISM,label:a("ui.social.guildRightsSetAlliancePrism")},{right:m.GUILD_RIGHT_TALK_IN_ALLIANCE_CHAN,label:a("ui.social.guildRightsTalkInAllianceChannel")}],this.minXpGivenPercentage=0,this.maxXpGivenPercentage=90,this.once("open",function(i){var n=[],o=window.gui.databases.RankNames;for(var s in o)n.push(o[s]);u.sortObjectInArray(n,"order"),t.rankNames=n,t._setupDom(),e(i),this.on("open",e)})}i(1038);var o=i(233),s=i(191).inherits,a=i(29).getText,r=i(246).DofusButton,l=i(676),c=i(586),u=i(252),d=i(735),h=i(386),p=i(225),m=i(526).GuildRightsBitEnum;s(n,o),e.exports=n,n.prototype._updateContent=function(e){var t=this.selector;if(t){var i=this.rank,n=window.gui.playerData,o=n.guild,s=e.id===n.id,a=e.id===o.current.leaderId,r=n.id===o.current.leaderId,l=!s&&!a;this.memberInfo={memberId:e.id,experienceGivenPercent:e.experienceGivenPercent,name:e.name,rank:e.rank},t.toggleOption(0,r),t.setValue(e.rank),i.setText(window.gui.databases.RankNames[e.rank].nameId),this.xpContributionLabel.setText(e.experienceGivenPercent+"%");for(var c,u=o.checkRight(m.GUILD_RIGHT_BOSS,e.rights),d=o.hasRight(m.GUILD_RIGHT_MANAGE_RIGHTS),h=0;h<this.rightNames.length;h++){var p=this.rightNames[h].right;c=this.rightCheckboxes[h],c&&(a||u||o.checkRight(p,e.rights)?c.activate():c.deactivate(),c.disable(),(p!==m.GUILD_RIGHT_MANAGE_RIGHTS||r)&&(r||d&&l&&o.hasRight(p))&&c.enable())}if(this.setXpButton.disable(),(o.hasRight(m.GUILD_RIGHT_MANAGE_XP_CONTRIBUTION)||o.hasRight(m.GUILD_RIGHT_MANAGE_MY_XP_CONTRIBUTION))&&this.setXpButton.enable(),!a&&o.hasRight(m.GUILD_RIGHT_MANAGE_RANKS)||u)return t.show(),i.hide(),void this.rankTitleText.delClassNames("noMargin");t.hide(),i.show(),this.rankTitleText.addClassNames("noMargin")}},n.prototype._setupDom=function(){var e,t,i=this,n=this.windowBody.createChild("div",{className:"upperPanel"}),o=n.createChild("div",{className:"container"});this.rankTitleText=o.createChild("div",{className:"text",text:a("ui.social.guildRank")}),this.rank=o.createChild("div",{className:"rank"}),this.selector=o.appendChild(new c);var s=this.rankNames;for(e=0,t=s.length;e<t;e+=1)this.selector.addOption(s[e].nameId,s[e].id);this.selector.on("change",function(e,t){return 1===parseInt(e,10)?window.gui.openConfirmPopup({title:a("ui.popup.warning"),message:a("ui.social.doUGiveRights",i.memberInfo.name),cb:function(n){return n?void(i.memberInfo.rank=e):void i.selector.setValue(t)}}):void(i.memberInfo.rank=e)});var u=n.createChild("div",{className:["container","XpToGuild"]});u.createChild("div",{className:"text",text:a("ui.social.percentXpFull")}),this.setXpButton=u.appendChild(new r("",{className:"setXpButton"}));var m=u.appendChild(new h);m.on("confirm",function(e){i.xpContributionLabel.setText(e+"%"),i.memberInfo.experienceGivenPercent=e}),this.setXpButton.on("tap",function(){m.open({min:i.minXpGivenPercentage,max:i.maxXpGivenPercentage,defaultValue:parseInt(i.xpContributionLabel.getText(),10)})}),this.xpContributionLabel=u.createChild("div",{className:"xpLabel",text:"0%"});for(var f=this.windowBody.appendChild(new d({colIds:["name","checkbox"]})),g=0;g<this.rightNames.length;g++){var _=this.rightNames[g],v=new l("");this.rightCheckboxes.push(v),f.addRow({name:_.label,checkbox:v})}var y=this.windowBody.createChild("div",{className:"buttonContainer"}),b=y.appendChild(new r(a("ui.common.validation")));b.on("tap",function(){i.memberInfo.rights=i.getRightsMask(),window.dofus.sendMessage("GuildChangeMemberParametersMessage",i.memberInfo),p.close(i.id)}),this.on("close",function(){m.hide()})},n.prototype.getRightsMask=function(){for(var e=0,t=0;t<this.rightNames.length;t++){var i=this.rightCheckboxes[t];i&&i.isActivate()&&(e+=this.rightNames[t].right)}return e}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"houseBuySellWindow",title:"house",positionInfo:{left:"c",top:"c",width:450,height:335}});var e=this;this.currency=g,this.once("open",function(){var t=this.windowBody.createChild("div",{className:"container"}),i=t.createChild("div",{className:"imageContainer"});e.image=i.createChild("div",{className:"image"}),e.image.setStyle("backgroundImage",e.imageUrl),e.title=t.createChild("div",{className:["text","title"],text:e.titleText}),e.description=t.createChild("div",{className:["text","description"],text:e.descriptionText});var n=this.windowBody.createChild("div",{className:"priceContainer"});n.createChild("div",{className:"priceText",text:u("ui.common.price")+u("ui.common.colon")}),e.price=n.appendChild(new r({title:u("ui.common.price")})),e.price.hide(),e.price.on("change",function(t){e.proposedPrice=t}),e.priceTextOnly=n.createChild("div",{className:"priceText"}),e.priceTextOnly.hide(),e.currencyIcon=n.createChild("div",{className:["currencyIcon","soft"]});var o=this.windowBody.createChild("div",{className:"footer"});e.cancelSaleButton=o.appendChild(new a(u("ui.common.cancelTheSale"),{className:"cancelSaleButton"})),e.confirmButton=o.appendChild(new a(u("ui.common.validation"),{className:"confirmButton"})),e.switchButton=o.appendChild(new p),e.switchButton.on("switchToHard",function(){e._setCurrency(_),e.updateDisplay(e.houseInfo)}),e.switchButton.on("switchToSoft",function(){e._setCurrency(g),e.updateDisplay(e.houseInfo)}),e.cancelSaleButton.on("tap",function(){if(!e.houseInfo||!e.houseInfo.buyOrSell)return e.fromInside?(window.dofus.sendMessage("HouseSellFromInsideRequestMessage",{amount:0}),void l.close(e.id)):void window.dofus.sendMessage("HouseSellRequestMessage",{amount:0})}),e.confirmButton.on("tap",function(){if(e.houseInfo&&e.houseInfo.buyOrSell){var t;return t=e.currency===_?u("tablet.price.hard",e.priceTextOnly.getText()):u("tablet.price.soft",e.priceTextOnly.getText()),window.gui.openConfirmPopup({title:u("ui.common.housePurchase"),message:u("tablet.ui.common.doUBuyHouse",e.houseOwner,t),cb:function(t){if(t){if(e.currency===g)return window.dofus.sendMessage("HouseBuyRequestMessage",{proposedPrice:e.proposedPrice});var i=e.proposedPriceHard-window.gui.playerData.inventory.goultines;return i>0?f.openNotEnoughHardCurrencyPopup(i):window.dofus.send("houseBuyRequest",{houseId:e.houseInfo.purchasableId,amountHard:e.proposedPriceHard,amountSoft:e.proposedPrice})}}},{isModal:!0})}return e.fromInside?(window.dofus.sendMessage("HouseSellFromInsideRequestMessage",{amount:e.proposedPrice}),void l.close(e.id)):void window.dofus.sendMessage("HouseSellRequestMessage",{amount:e.proposedPrice})})}),this.on("open",function(t){return t=t||{},e.fromInside=t.fromInside,e.switchButton.setCurrency(g),e.fromInside?void e.fromInsideUpdateDisplay(t.myHouse):void e.updateDisplay(t.msg)}),this.setupSocketEvents()}i(1040);var o=i(191).inherits,s=i(233),a=i(246).DofusButton,r=i(388),l=i(225),c=i(252),u=i(29).getText,d=i(30),h=i(202),p=i(1041),m=i(806),f=i(805),g="soft",_="hard";o(n,s),e.exports=n,n.prototype.setupSocketEvents=function(){var e=this,t=window.gui,i=window.dofus.connectionManager;t.on("PurchasableDialogMessage",function(t){l.openDialog(e.id,{fromInside:!1,msg:t})}),t.on("HouseBuyResultMessage",function(i){i.bought?t.openPopup({title:u("ui.popup.information"),message:u("ui.common.houseBuy",e.houseOwner,c.kamasToString(i.realPrice,""))}):t.openPopup({title:u("ui.popup.information"),message:u("ui.common.cantBuyHouse",c.kamasToString(i.realPrice,""))})}),t.on("HouseSoldMessage",function(e){if(t.playerData.identification.nickname===e.buyerName){var i=u("ui.house.homeOf",e.buyerName);0===e.realPrice?t.openPopup({title:u("ui.popup.information"),message:u("ui.common.houseNosell","'"+i+"'")}):t.openPopup({title:u("ui.popup.information"),message:u("ui.common.houseSell","'"+i+"'",c.kamasToString(e.realPrice,""))})}}),m.on("computedHardPricesChange",function(){e.currency===_&&e.updateDisplay(e.houseInfo)}),i.on("houseBuyError",function(){this.send("moneyGoultinesAmountRequest")}),i.on("houseBuySuccess",function(){this.send("moneyGoultinesAmountRequest")})},n.prototype._setCurrency=function(e){if(this.currency!==e){var t=this.currency;this.currency=e,this.currencyIcon&&this.currencyIcon.replaceClassNames([t],[e])}},n.prototype.prepareDialog=function(e){var t=this;d.getData("Houses",e.modelId,function(i,n){return i||!n?console.warn("Houses Id: "+e.modelId+" not found!",i):void h.preloadImage("gfx/houses/"+n.gfxId+".png",function(i){t.houseOwner="?"===e.ownerName?u("ui.common.houseWithNoOwner"):u("ui.house.homeOf",e.ownerName);var o=n.nameId;return t.image?(delete t.imageUrl,delete t.titleText,delete t.descriptionText,t.image.setStyle("backgroundImage",i),t.title.setText(t.houseOwner),void t.description.setText(o)):(t.imageUrl=i,t.titleText=t.houseOwner,void(t.descriptionText=o))})})},n.prototype.updateDisplay=function(e){if(!e)return console.warn("Missing purchaseMsg from PurchasableDialogMessage.");this.proposedPrice=e.price,this.proposedPriceHard=m.computeHardPrice(e.price),this.houseInfo=e;var t=this.currency===_,i=t?this.proposedPriceHard:e.price;if(this.priceTextOnly.toggleDisplay(e.buyOrSell),this.price.toggleDisplay(!e.buyOrSell),e.buyOrSell){this.windowTitle.setText(u("ui.common.housePurchase")),this.cancelSaleButton.disable();var n=window.gui.playerData.inventory,o=t||i&&i<=n.kamas;o?this.confirmButton.enable():this.confirmButton.disable()}else this.windowTitle.setText(u("ui.common.houseSale")),this.cancelSaleButton.enable(),this.confirmButton.enable();return this.switchButton.toggleDisplay(e.buyOrSell&&!window.gui.playerData.isShopDisabled()),i?void(e.buyOrSell?this.priceTextOnly.setText(c.kamasToString(i,"")):this.price.setValue(c.kamasToString(i,""))):e.buyOrSell?this.priceTextOnly.setText(u("ui.item.averageprice.unavailable")):this.price.setValue(u("ui.item.averageprice.unavailable"))},n.prototype.fromInsideUpdateDisplay=function(e){var t=this;return this.switchButton.hide(),this.confirmButton.enable(),e?(this.priceTextOnly.hide(),this.price.show(),this.windowTitle.setText(u("ui.common.houseSale")),e.price?(this.cancelSaleButton.enable(),this.proposedPrice=e.price,void this.price.setValue(c.kamasToString(e.price,""))):(this.cancelSaleButton.disable(),void d.getData("Houses",e.modelId,function(i,n){return i||!n?console.warn("Houses Id: "+e.modelId+" not found!",i):(t.proposedPrice=n.defaultPrice,void t.price.setValue(c.kamasToString(t.proposedPrice,"")))}))):console.warn("Missing current house info.")}},function(e,t){},function(e,t,i){function n(e){var t=this;e=e||{},this.currency=a,s.call(this,e,function(){t.toggleCurrency()}),this.addClassNames("button","SwitchCurrencyButton",a)}i(1042);var o=i(191).inherits,s=i(246),a="soft",r="hard";o(n,s),e.exports=n,n.prototype.toggleCurrency=function(){this.setCurrency(this.currency===a?r:a)},n.prototype.setCurrency=function(e){if(this.currency!==e){var t=this.currency;return this.currency=e,this.replaceClassNames([t],[this.currency]),this.currency===r?this.emit("switchToHard"):this.emit("switchToSoft")}}},function(e,t){},function(e,t,i){function n(){function e(){u.close("itemAppearance")}function t(){var t=a.itemSlots.indexOf(a.selectedSlot)+1;return a.itemInstance.livingObjectSkin===t?e():(this.disable(),void window.dofus.sendMessage("LivingObjectChangeSkinRequestMessage",{livingUID:a.itemInstance.objectUID,livingPosition:a.itemInstance.position,skinId:t}))}function i(){a.delClassNames("spinner"),a.confirmButton.enable(),a.selectedSlot&&(a.selectedSlot.unselect(),delete a.selectedSlot)}function n(){var e=a.itemSlots.indexOf(this)+1;this===a.selectedSlot||a.itemInstance.livingObjectLevel<e||(a.selectedSlot&&a.selectedSlot.unselect(),this.select(),a.selectedSlot=this)}c.call(this,{className:"ItemAppearanceWindow",title:s("ui.item.chooseSkin"),positionInfo:{left:"c",top:"c",width:450,height:200}});var a=this;this.itemSlots=[],this.selectedSlot=null,this.itemInstance=null,this.once("open",function(){this.itemSlotsBox=this.windowBody.createChild("div",{className:"itemSlotsBox"});for(var i=0;i<h;i+=1){var l=this.itemSlotsBox.appendChild(new r);l.on("tap",n),a.itemSlots.push(l)}this.confirmButton=this.windowBody.appendChild(new o(s("ui.common.validation"))),this.confirmButton.on("tap",t),window.gui.playerData.inventory.on("itemModified",function(t){a.itemInstance&&t.objectUID===a.itemInstance.objectUID&&e()})}),this.on("open",function(e){return e.itemInstance&&e.itemInstance.livingObjectCategory?void this._displayItem(e.itemInstance):console.error("Must provide a living object or living object associated itemInstance")}),this.on("close",function(){i()})}i(1044);var o=i(246).DofusButton,s=i(29).getText,a=i(191).inherits,r=i(834),l=i(30),c=i(233),u=i(225),d=i(202),h=20;a(n,c),e.exports=n,n.prototype._displayItem=function(e){this.itemInstance=e;var t=this;this.addClassNames("spinner"),this.confirmButton.disable(),t.itemSlots[e.livingObjectSkin-1].emit("tap");var i=e.livingObjectId||e.objectGID;l.getData("LivingObjectSkinJntMood",i,function(i,n){if(i)return console.error(i);var o,s=[];for(o=0;o<n.moods[e.livingObjectMood].length;o+=1){var a=n.moods[e.livingObjectMood][o];s.push("gfx/items/"+a+".png")}d.preloadImages(s,function(e){for(var i=0;i<t.itemSlots.length;i+=1){var n=t.itemSlots[i];i>=t.itemInstance.livingObjectLevel?n.unset():n.setImage(e[i])}t.delClassNames("spinner"),t.confirmButton.enable()})})}},function(e,t){},function(e,t,i){function n(){function e(e,t){return t=t||{},t.showDescription=!0,t.showTitle=!0,e?(n.setTitle(e.getName()),n._itemBox.displayItem(e,t),n._itemBox.show(),void n.windowBody.delClassNames("spinner")):console.error("ItemBoxWindow: openWithItemData have not itemData")}function t(t,i){r.getItems([t],function(n,o){return n||!o[0]?console.error("ItemBoxWindow: error openWithDbItem",n,t):void e(o[0],i)})}function i(t,i){r.createItemInstances(t,function(t,n){return t?console.error("ItemBoxWindow: error createItemInstances",t):void e(n.array[0],i)})}s.call(this,{className:"ItemBoxWindow",title:"",positionInfo:{top:"c",left:"c",width:500,height:420}});var n=this,o=window.gui;this._itemBox=null,this._domCreated=!1,this.on("open",function(s){s=s||{},n._domCreated||n._createDom();var a=s.itemData,r=s.objectUID,l=s.objectGID,c=s.objectItem,u=s.options||{};return n.setTitle(""),n._itemBox.hide(),n.windowBody.addClassNames("spinner"),!a&&r&&(a=o.playerData.inventory.objects[r]),!a&&c?i(c,u):void(a?e(a,u):l?t(l,u):console.error("ItemBoxWindow need itemData or objectUID or objectGID"))}),this.on("close",function(){n._itemBox.hide(),n.windowBody.delClassNames("spinner")})}i(1046);var o=i(191).inherits,s=i(233),a=i(951),r=i(509);o(n,s),e.exports=n,n.prototype._createDom=function(){var e=this.windowBody;this._itemBox=e.appendChild(new a({showItemActions:!0})),this._itemBox.hide(),this._domCreated=!0}},function(e,t){},function(e,t,i){function n(){function e(){var e=d.getWindow("feed");return e.feedingBox.possessFeedItemForLivingObject(n.itemInstance)?void d.open("feed",{mode:"livingObject",item:n.itemInstance}):window.gui.openSimplePopup(a("ui.item.errorNoFoodLivingItem",n.itemInstance.item.nameId))}function t(){n.lastLivingObjectId=n.itemInstance.livingObjectId,window.dofus.sendMessage("LivingObjectDissociateMessage",{livingUID:n.itemInstance.objectUID,livingPosition:n.itemInstance.position})}function i(){d.open("itemAppearance",{itemInstance:n.itemInstance})}u.call(this,{className:"ItemManageWindow",title:a("ui.item.manageItem"),positionInfo:{left:"c",top:"c",width:300,height:300}});var n=this;this.itemInstance=null,this.lastLivingObjectId="",this.once("open",function(){var r=this.windowBody.createChild("div",{className:"topRow"});this.itemSlot=r.appendChild(new l);var u=r.createChild("div",{className:"buttons"});this.feedButton=u.appendChild(new s(a("ui.item.feed"))),this.feedButton.on("tap",e),this.dissociateButton=u.appendChild(new s(a("ui.item.dissociate"))),this.dissociateButton.on("tap",t),this.appearanceButton=u.appendChild(new s(a("ui.item.skin"))),this.appearanceButton.on("tap",i);var d=this.windowBody.createChild("div",{className:"botRow"}),p=d.createChild("div",{className:"statsBox"});p.createChild("div",{className:"label",text:a("ui.common.state")+a("ui.common.colon")}),this.moodBox=p.createChild("div",{className:"value"}),this.lastFedBox=p.createChild("div",{className:["label","lastFedBox"]
});var m=a("ui.common.level")+a("ui.common.colon");p.createChild("div",{className:"label",text:m}),this.levelBox=p.createChild("div",{className:"value"}),m=a("ui.common.experiment")+a("ui.common.colon"),p.createChild("div",{className:"label",text:m}),this.expBar=p.appendChild(new c),this.expBar.addClassNames("expBar","blue","value"),this.expTooltip=new h("div",{className:"expTooltip"}),o(this.expBar,this.expTooltip),window.gui.playerData.inventory.on("itemAdded",function(e){if(e.objectGID===n.lastLivingObjectId){var t=window.gui.playerData.inventory.objects[e.objectUID];n._displayItem(t)}}),window.gui.playerData.inventory.on("itemModified",function(e){e&&n.itemInstance&&(e.livingObjectId&&e.livingObjectId===n.itemInstance.objectGID?n._displayItem(e):e.objectUID===n.itemInstance.objectUID&&n._displayItem(e))})}),this.on("open",function(e){return e.itemInstance&&e.itemInstance.livingObjectCategory?void this._displayItem(e.itemInstance):console.error("Must provide a living object or living object associated itemInstance")})}i(1048);var o=i(248).addTooltip,s=i(246).DofusButton,a=i(29).getText,r=i(191).inherits,l=i(832),c=i(605),u=i(233),d=i(225),h=i(235),p={MOOD_LEAN:0,MOOD_SATISFIED:1,MOOD_FAT:2};r(n,u),e.exports=n,n.prototype._updateMood=function(e){var t;switch(e.livingObjectMood){case p.MOOD_LEAN:t=a("ui.common.lean");break;case p.MOOD_SATISFIED:t=a("ui.common.satisfied");break;case p.MOOD_FAT:t=a("ui.common.fat")}this.moodBox.setText(t)},n.prototype._updateLastFed=function(e){this.lastFedBox.setText(e.livingObjectFoodDate)},n.prototype._updateExp=function(e){this.levelBox.setText(e.livingObjectLevel);var t=e.livingObjectXp,i=e.livingObjectMaxXp;this.expBar.setValue(0!==i?t/i:1),this.expTooltip.setText(t+" / "+i)},n.prototype._displayItem=function(e){this.itemInstance=e,this.itemSlot.setItem(e),this.itemSlot.setQuantity(1),e.livingObjectId&&e.objectGID?(this.feedButton.enable(),this.dissociateButton.enable()):(this.feedButton.disable(),this.dissociateButton.disable()),this._updateMood(e),this._updateLastFed(e),this._updateExp(e)}},function(e,t){},function(e,t,i){function n(){f.call(this,{className:"ItemRecipesWindow",positionInfo:{left:"c",top:"c",width:800,height:525}}),this.dbItemId=null,this.itemBox=null,this.itemHistory=[],this._isReloading=!1,this.on("open",this._onOpen),this.on("close",this._onClose)}function o(e){this.myWindow._displayNextItem(e)}function s(e){this.myWindow._displayNextItem(d.items[e])}function a(){var e=this.myWindow;e.itemHistory.pop();var t=d.items[e.itemHistory[e.itemHistory.length-1]];e._displayItem(t)}function r(e,t){this.myWindow._isReloading||(this.myWindow._isReloading=!0,t.select(),setTimeout(function(t){t._displayNextItem(e)},0,this.myWindow))}i(1050);var l=i(29).getText,c=i(191).inherits,u=i(951),d=i(509),h=i(1017),p=i(1015),m=i(30),f=i(233),g=i(246),_=i(235);c(n,f),e.exports=n,n.prototype._onOpen=function(e){this.itemBox||this._createContent();var t=e.itemData&&e.itemData.item?e.itemData.item:e.itemData;this._displayNextItem(t)},n.prototype._onClose=function(){this.dbItemId=null,this.itemHistory=[],this.windowBody.clearContent(),this.itemBox=null,this.itemRecipeBox=null,this.recipeList=null,this.windowHeadWrapper.removeChild(this.backButton),this.backButton=null},n.prototype._displayNextItem=function(e){e.id!==this.dbItemId&&(this.itemHistory.push(e.id),this._displayItem(e))},n.prototype._createContent=function(){var e=this.windowBody.createChild("div",{className:"leftCol"});this.itemBox=new u({showDescription:!0,showTitle:!0,withBidHouseBtn:!0}),e.appendChild(this.itemBox),this.itemRecipeBox=e.createChild("div",{className:"itemRecipeBox"}),this.itemRecipeBox.createChild("div",{className:"title",name:"title"}),this.itemRecipeBox.on("itemTapped",o),this.itemRecipeBox.myWindow=this;var t=this.windowBody.createChild("div",{className:"rightCol"});this.recipeList=new p({isMenuOnItemDisabled:!0}),this.recipeList.on("itemTapped",o),this.recipeList.on("recipeSelected",s),this.recipeList.myWindow=this,t.appendChild(this.recipeList);var i=this.backButton=new g({className:"backButton"},a);i.insertBefore(this.windowTitle),i.myWindow=this},n.prototype._displayItem=function(e){this.recipeList.reset(),this.dbItemId=e.id,this._isReloading=!1;var t=this;this.windowTitle.setText(e.nameId),this.backButton.toggleDisplay(this.itemHistory.length>1),this.itemBox.displayItem(e);var i=[e.id].concat(e.recipeIds);m.getDataMap("Recipes",i,function(n,o){if(n)return console.error(n);if(t.recipeList){for(var s=o[i[0]],a=[],c=1;c<i.length;c++){var u=o[i[c]];u&&a.push(u)}t.recipeBox&&(t.recipeBox.destroy(),t._craftDetails.destroy());var d=!e.getProperty("secretRecipe");t.itemRecipeBox.toggleClassName("empty",!s||d),s?(t.itemRecipeBox.getChild("title").setText(l("ui.item.utilityReceipt")),t.recipeBox=new h(s,{isMenuOnItemDisabled:!0}),t._craftDetails=new _("div",{"class":"craftDetails"}),t.recipeBox.on("itemTapped",r),t.recipeBox.myWindow=t,t.recipeBox.setupRecipe(function(e){return e?void console.error(new Error("setupRecipe error: "+e)):void(t.itemRecipeBox&&(t.itemRecipeBox.appendChild(t.recipeBox),t._craftDetails.setText(t.recipeBox.craftDetails),t.itemRecipeBox.appendChild(t._craftDetails)))}),t.recipeBox.myWindow=t):d?t.itemRecipeBox.getChild("title").setText(l("ui.item.secretReceipt")):t.itemRecipeBox.getChild("title").setText(l("ui.item.utilityNoReceipt")),t.recipeList.addRecipes(a,{usingItemId:e.id})}})}},function(e,t){},function(e,t,i){function n(){function e(){i.selectedItemIds=[];for(var e=i.itemListBox.getChildren(),t=0;t<e.length;t+=1){var n=e[t];n.unselect()}}function t(){for(var e,t=[].concat(i.itemSet.items),n=i.itemListBox.getChildren(),o=0;o<n.length;o+=1)e=n[o],e.select();i.selectedItemIds=t}f.call(this,{className:"ItemSetsWindow",positionInfo:{left:"c",top:"c",width:800,height:525}});var i=this;this.selectedItemIds=[],this.once("open",function(){function n(){i._updateItemSlotsOwned()}this.currentSetId=null;var s=this.windowBody.createChild("div",{className:"leftCol"});this.itemListBox=s.createChild("div",{className:"itemListBox"}),this.itemBox=new c({parent:this,showDescription:!0,showTitle:!0,withBidHouseBtn:!0}),s.appendChild(this.itemBox);var a=this.windowBody.createChild("div",{className:"rightCol"}),l=a.createChild("div",{className:"selectorContainer"});l.createChild("div",{className:"tableTitle",text:r("ui.set.bonus")}),this.bonusSelector=l.appendChild(new h),this.bonusSelector.on("change",function(e){i._updateBonusTable(e,i.combineBonusesCheckbox.isActivate())}),this.combineBonusesCheckbox=l.appendChild(new o(r("ui.set.addObjectBonus"))),this.combineBonusesCheckbox.on("change",function(n){n?t():e();var o=i.selectedItemIds.length;i.bonusSelector.select(n?o:g),i.bonusSelector.toggleOption(o,n),i.bonusSelector.setEnable(!n),i.bonusSelector.toggleClassName("disabled",n)}),this.bonusTable=a.appendChild(new m([{id:"description"}],null,{noHeader:!0,clickable:!1})),window.gui.on("SetUpdateMessage",function(e){i.openState&&e.setId===i.currentSetId&&i._updateEquippedItems(e.setObjects)});var u=window.gui.playerData.inventory;u.on("itemAdded",n),u.on("itemsAdded",n),u.on("itemDeleted",n),u.on("itemsDeleted",n)}),this.on("open",function(e){var t=e.item?e.item:e;this._displayItemSet(t)}),this.on("close",function(){this.currentSetId=null})}i(1052);var o=i(676),s=i(400),a=i(401),r=i(29).getText,l=i(191).inherits,c=i(951),u=i(832),d=i(509),h=i(586),p=i(30),m=i(593),f=i(233),g=1,_=-1;l(n,f),e.exports=n,n.prototype._getEquippedItemById=function(e){var t=window.gui.playerData.inventory.equippedItems;for(var i in t){var n=t[i];if(n.isInitialised&&n.objectGID===e)return n}},n.prototype._updateItemSlotsOwned=function(){for(var e=this.itemListBox.getChildren(),t=window.gui.playerData.inventory.quantityList,i=0;i<e.length;i+=1){var n=e[i];n.delClassNames("notOwned"),t.hasOwnProperty(n.dbItem.id)||n.addClassNames("notOwned")}},n.prototype._updateEquippedItems=function(e){for(var t=this.itemListBox.getChildren(),i=0,n=0;n<t.length;n+=1){var o=t[n];o.delClassNames("equipped"),e.indexOf(o.dbItem.id)>-1&&(o.addClassNames("equipped"),i++),o.dbItem.id===this.itemBox.itemId&&this._updateItemBox(d.items[o.dbItem.id]);var s=this._getEquippedItemById(o.dbItem.id);o.setItem(s||o.dbItem)}this.bonusSelector.select(i)},n.prototype._displayItemSet=function(e){if(e.itemSetId){var t=this;this.currentSetId=e.itemSetId,this._updateItemBox(e),p.getData("ItemSets",e.itemSetId,function(e,i){return e?console.error(e):(t.itemSet=i,t.windowTitle.setText(i.nameId),t.itemListBox.clearContent(),t.bonusSelector.clearContent(),void d.getItems(i.items,function(e){if(e)return console.error(e);var n=0;t.bonusSelector.addOption("0 "+r("ui.common.objects"),0),t.bonusSelector.toggleOption(0,!1);for(var o,s,a,l,c=window.gui.playerData.inventory.quantityList,u=0;u<i.items.length;u+=1)a=i.items[u],s=d.items[a],o=t._getEquippedItemById(a),o&&(n+=1),l=t._createItemSlot(o||s),c.hasOwnProperty(a)||l.addClassNames("notOwned"),t.itemListBox.appendChild(l),t.bonusSelector.addOption(u+1+" "+r("ui.common.objects"),u+1);t.combineBonusesCheckbox.deactivate(),t.bonusSelector.select(n)}))})}},n.prototype._createItemSlot=function(e){var t=this,i=new u({itemData:e});return i.createChild("div",{className:"equippedIcon"}),i.toggleClassName("equipped",!!i.itemInstance),i.on("tap",function(){var e=this.itemInstance&&this.itemInstance.isInitialised?this.itemInstance:null,n=window.gui.playerData.inventory.getGenericItem(this.dbItem.id);if(n&&!n.isInitialised&&(n=null),t.itemBox.displayItem(e||n||this.dbItem),t.combineBonusesCheckbox.isActivate()){var o=t.selectedItemIds.indexOf(i.dbItem.id);o<0?(t.selectedItemIds.push(i.dbItem.id),this.select()):(t.selectedItemIds.splice(o,1),this.unselect()),t.bonusSelector.select(t.selectedItemIds.length)}}),i},n.prototype._updateItemBox=function(e){var t=this._getEquippedItemById(e.id),i=window.gui.playerData.inventory.getGenericItem(e.id);this.itemBox.displayItem(t||i||e)},n.prototype._getEffectInstanceIntegerOrDie=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t.diceNum=t.diceNum||0,t.diceSide=t.diceSide||0,t.value=t.value||0,void 0!==e.min&&void 0!==e.max?(t._type="EffectInstanceDice",t.diceNum=t.min,t.diceSide=t.max):e.diceSide?e.diceNum&&e.diceSide&&(t._type="EffectInstanceDice",t.diceNum+=t.value,t.diceSide+=t.value,t.value=0):(t._type="ObjectEffectInteger",e.diceNum&&(t.value+=e.diceNum),t.diceNum=0,t.diceSide=0),t},n.prototype._mergeEffectInstances=function(e,t){for(var i=[],n={},o=[],r=0;r<e.length;r+=1){var l=e[r];l&&(l.effect.category===a.special?o.push(l):n[l.effectId]?n[l.effectId].effect.useDice&&(n[l.effectId].diceNum+=l.diceNum||0,n[l.effectId].diceSide+=l.diceSide||0,n[l.effectId].value+=l.value||0):n[l.effectId]=this._getEffectInstanceIntegerOrDie(l))}for(var c in n)n.hasOwnProperty(c)&&i.push(this._getEffectInstanceIntegerOrDie(n[c]));i=i.concat(o),s.createEffectInstances(i,t)},n.prototype._updateBonusTable=function(e,t){var i=this;this.bonusTable.clearContent();var n,o,a=[],r=i.itemSet.bonusIsSecret,l=Math.max(e-1,0);if(i.itemSet.effects.length&&!r){var c=i.itemSet.effects[l];for(n=0;n<c.length;n+=1)o=c[n],o&&Object.keys(o).length&&a.push(o)}var u=i.itemSet.id,h=window.gui.playerData.inventory.itemSets[u]||{},p=h.setEffects||[],m=h.setObjects||[],f=e===m.length;if(p.length&&f&&r)for(n=0;n<p.length;n+=1)o=p[n],o&&Object.keys(o).length&&a.push(o);if(t&&i.selectedItemIds.length){var g=[];for(n=0;n<i.selectedItemIds.length;n+=1){var _=i.selectedItemIds[n],v=i._getEquippedItemById(_),y=v?v.effectsMap:d.items[_].possibleEffects;for(var b in y)y[b].effect.showInSet&&g.push(y[b])}a=a.concat(g)}for(n=0;n<a.length;n+=1){var w=a[n];w.effectCaller||(w.effectCaller="itemSet "+u)}s.createEffectInstances(a,function(e,t){return e?console.error("_updateBonusTable createEffectInstances",e):void i._mergeEffectInstances(t,function(e,t){return e?console.error("_updateBonusTable _mergeEffectInstances",e):(i.bonusTable.clearContent(),void i._addEffectsToTable(t))})})},n.prototype._addEffectsToTable=function(e){if(this.itemSet.bonusIsSecret&&!e.length)return void this.bonusTable.addRow({description:r("ui.set.secretBonus")});for(var t=0;t<e.length;t+=1){var i=e[t];if(i){var n=this.bonusTable.addRow({description:i.description});n.toggleClassName("negative",i.effect.bonusType===_)}}}},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"LevelUpWindow",positionInfo:{left:"c",top:"c",width:535,height:260}}),this.hasDom=!1,this._setupEvents()}function o(e){e.sort(function(e,t){var i=e.getProperty("minPlayerLevel"),n=t.getProperty("minPlayerLevel");return i<n?-1:i>n?1:0})}i(1054);var s=i(191).inherits,a=i(233),r=i(225),l=i(29).getText,c=i(840),u=i(248).addTooltip,d=i(415),h=i(457),p=i(202),m=i(439).Delay;s(n,a),e.exports=n,n.prototype._setupSpellData=function(){var e=window.gui.playerData.characters.mainCharacter.spellData.spells,t=window.gui.playerData.characterBaseInformations.level;this.spells=[];for(var i in e)t<=e[i].getProperty("minPlayerLevel")&&this.spells.push(e[i]);o(this.spells)},n.prototype._createDom=function(){this._characterDisplay=this.windowBody.appendChild(new d({scale:"fitin",horizontalAlign:"center"}));var e=this.windowBody.createChild("div",{className:"info"}),t=e.createChild("div",{className:"spellBlock"}),i=e.createChild("div",{className:"pointBlock"}),n=t.createChild("div",{className:"spellTextBox"});this.spellText=n.createChild("div",{className:"spellText"}),this.spellIcon=t.createChild("div",{className:"spellIcon"}),this.spellDescription=new c,u(this.spellIcon,this.spellDescription,{openOnTap:!0});var o=i.createChild("div",{className:["healthPoints","points"]}),s=i.createChild("div",{className:["spellPoints","points"]}),a=i.createChild("div",{className:["charaPoints","points"]});o.createChild("div",{className:"icon"}),o.createChild("div",{className:"text",text:l("ui.levelUp.LifePoints")}),this.health=o.createChild("div",{className:"point"}),s.createChild("div",{className:"icon"}),s.createChild("div",{className:"text",text:l("ui.levelUp.SpellPoints")}),this.spell=s.createChild("div",{className:"point"}),a.createChild("div",{className:"icon"}),a.createChild("div",{className:"text",text:l("ui.levelUp.CaracPoints")}),this.charac=a.createChild("div",{className:"point"}),this.hasDom=!0},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._characterDisplay=null,this.spellText=this.spellIcon=this.spellDescription=null,this.health=this.spell=this.charac=null,this.hasDom=!1},n.prototype.updateSpellIcon=function(e){var t=this;this.spellDescription.updateUI({spell:e});var i=e.spell.iconId;i<0&&console.error(new Error("iconId < 0 for spellId "+e.spell.id+": "+i)),p.preloadImage("gfx/spells/sort_"+i+".png",function(e){t.hasDom&&t.spellIcon.setStyle("backgroundImage",e)})},n.prototype._setupEvents=function(){var e=this,t=window.gui.playerData;t.on("characterLevelUp",function(t){window.gui.tutorialManager.inTutorial||new m(37,function(){e._levelUp(t.newLevel,t.previousLevel)}).start()}),this.on("open",this._onOpen)},n.prototype._onOpen=function(){this.hasDom||this._createDom();var e=window.gui.playerData.characterBaseInformations.entityLook;this._characterDisplay.setLook(e,{direction:h.DIRECTION_SOUTH_EAST,animation:"AnimStatique",boneType:"characters/",skinType:"characters/"})},n.prototype._levelUp=function(e,t){r.open(this.id),this._setupSpellData(),this.windowTitle.setText(l("ui.levelUp.TitleLevel",e));for(var i=this.spells,n=0;n<i.length;n++){var o=i[n],s=o.getProperty("minPlayerLevel");if(e===s){this.updateSpellIcon(o),this.spellText.setText(l("ui.levelUp.newSpell"));break}if(e<s){this.updateSpellIcon(o),this.spellText.setText(l("ui.levelUp.nextSpell")+" "+l("ui.levelUp.nextSpellLevel",s));break}}var a=e-t;this.health.setText("+ "+5*a),this.spell.setText("+ "+a),this.charac.setText("+ "+5*a)}},function(e,t){},function(e,t,i){function n(){g.call(this,{title:u("ui.mimicry.associate"),className:"MimicryWindow",positionInfo:{left:"c",top:"c",width:450,height:326}}),this._reset(),this.on("open",this._onOpen),this.on("close",this._onClose),this._setListeners()}function o(e,t,i){var n=e.createChild("div",{className:["slotDiv",t]});n.createChild("div",{className:"icon"});var o=n.appendChild(new p);return o.mySlotDiv=n,i&&f.addTooltip(n,i),o}function s(){this.backgroundImage=null}function a(e,t,i){var n=this.mySlot;return"mimicry"!==i||e.slot!==n}i(1056);var r=i(383),l=i(246),c=i(1057),u=i(29).getText,d=i(191).inherits,h=i(509),p=i(832),m=i(784),f=i(248),g=i(233),_=i(225);d(n,g),e.exports=n,n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._reset=function(){this.mimicryItem=null,this.foodItem=null,this.hostItem=null,this.previewItem=null,this.hasDom=!1,this.hostSlot=this.foodSlot=this.mimicrySlot=this.previewSlot=null,this.selectedSlot=null},n.prototype._onOpen=function(e){var t=window.gui.playerData.inventory.objects;this.mimicryItem=t[e],this.mimicryItem||console.error("Missing mimicry. UID="+e),this.hasDom||this._createDom(),this._prepareItemPickingWindow(),this.mimicrySlot.setItem(this.mimicryItem,1),this._showHelp(u("tablet.mimicry.help")),this.mergeBtn.disable()},n.prototype._onClose=function(){this.itemPicking&&(this.itemPicking.removeAllListeners("close"),this.itemPicking.removeAllListeners("unpickItem"),this.itemPicking.removeAllListeners("slot-doubletap"),this.itemPicking=null),_.close("itemPicking")},n.prototype._prepareItemPickingWindow=function(){var e=this.itemPicking=_.open("itemPicking");e.once("close",function(){_.close("mimicry")}),e.on("unpickItem",this._dragItemAwayFromSlot.bind(this)),e.on("slot-doubletap",this._addItemByDoubleTap.bind(this)),e.showEquippableItems(),_.arrangeOpeningWindow(this.id,{leftOf:e.id})},n.prototype._createDom=function(){this.hasDom=!0;var e=this.windowBody.createChild("div",{className:"content"}),t=e.createChild("div",{className:"workDiv"}),i=t.createChild("div",{className:"slotsZone"});this.mimicrySlot=o(i,"mimicrySlot",u("ui.mimicry.mimicry")+" "+u("ui.mimicry.toBeDestroyed")),i.createChild("div",{className:"plusOrEqualSign",text:"+"}),this.hostSlot=o(i,"hostSlot",u("tablet.mimicry.host")),i.createChild("div",{className:"plusOrEqualSign",text:"+"}),this._setActiveSlot(this.hostSlot),this.foodSlot=o(i,"foodSlot",u("tablet.mimicry.food")+" "+u("ui.mimicry.toBeDestroyed")),i.createChild("div",{className:"plusOrEqualSign",text:"="}),this._setActiveSlot(this.foodSlot),this.previewSlot=o(i,"previewSlot",u("ui.craft.itemCreated")),this.messageBox=t.createChild("div"),this.messageText=this.messageBox.createChild("div",{className:"msgText"}),this.mergeBtn=e.appendChild(new l({text:u("ui.common.merge"),className:["greenButton","mergeBtn"]},this._mergeBtnAction.bind(this)))},s.prototype.prepareForDrag=function(e){var t=e.slot;return!!t.data&&(this.backgroundImage=t.getImage(),!0)},n.prototype._setActiveSlot=function(e){var t=e.mySlotDiv,i={isDropAllowed:a};r.setDroppable(t,["itemPicking","mimicry"],i),t.mySlot=e;var n=this;t.on("drop",function(t,i){n._dropItem(t.getItem(),e,i)});var o=new s,l={dragElement:!1};r.setDraggable(e,o,"mimicry",{slot:e},l),e.on("tap",function(){n._simpleTapOnSlot(e)}),e.on("doubletap",function(){n._simpleTapOnSlot(e),n._simpleTapOnSlot(e)})},n.prototype._simpleTapOnSlot=function(e){e.getItem()&&(e===this.selectedSlot?(e.unselect(),e.unset(),this._refreshAfterSlotChange()):(this.selectedSlot&&this.selectedSlot.unselect(),this.selectedSlot=e,e.select()))},n.prototype._dragItemAwayFromSlot=function(e,t){"mimicry"===t&&(e.unset(),this._refreshAfterSlotChange())},n.prototype._dropItem=function(e,t,i){if("mimicry"===i){var n=t===this.hostSlot?this.foodSlot:this.hostSlot,o=t.getItem();n.setItem(o,1),t.setItem(e,1)}else t.setItem(e,1);this._refreshAfterSlotChange()},n.prototype._addItemByDoubleTap=function(e){var t=e.getItem();if(this.hostItem)if(this.foodItem)t.objectUID===this.foodItem.objectUID||t.objectUID===this.hostItem.objectUID?(this.hostSlot.setItem(t,1),this.foodSlot.unset()):this.foodSlot.setItem(t,1);else{if(t.objectUID===this.hostItem.objectUID)return;this.foodSlot.setItem(t,1)}else this.hostSlot.setItem(t,1);this._refreshAfterSlotChange()},n.prototype._refreshAfterSlotChange=function(){this._clearPreviewSlot(),this.mergeBtn.disable(),this.selectedSlot&&(this.selectedSlot.unselect(),this.selectedSlot=null);var e=this.hostItem=this.hostSlot.getItem(),t=this.foodItem=this.foodSlot.getItem();return e&&!e.item.isEquippable()?this._showError(u("tablet.mimicry.errorEquippable")):t&&!t.item.isEquippable()?this._showError(u("tablet.mimicry.errorEquippable")):e&&t?e.getProperty("iconId")===t.getProperty("iconId")?this._showError(u("ui.mimicry.error.sameSkin")):e.getProperty("typeId")!==t.getProperty("typeId")?this._showError(u("ui.mimicry.error.foodType")):t.getProperty("level")>e.getProperty("level")?this._showError(u("ui.mimicry.error.foodLevel")):void this._requestMergeOrPreview(!0):e?this._showHelp(u("tablet.mimicry.helpFood")):this._showHelp(u("tablet.mimicry.help"))},n.prototype._requestMergeOrPreview=function(e){window.dofus.sendMessage("MimicryObjectFeedAndAssociateRequestMessage",{mimicryUID:this.mimicryItem.objectUID,mimicryPos:this.mimicryItem.position,foodUID:this.foodItem.objectUID,foodPos:this.foodItem.position,hostUID:this.hostItem.objectUID,hostPos:this.hostItem.position,preview:e})},n.prototype._mergeBtnAction=function(){var e=this;window.gui.openConfirmPopup({message:u("ui.mimicry.confirmPopup",this.hostItem.getName(),this.foodItem.getName(),this.mimicryItem.getName()),cb:function(t){t&&(e.mergeBtn.disable(),e._requestMergeOrPreview(!1))}})},n.prototype._clearPreviewSlot=function(){this.previewItem=null,this.previewSlot.unset(),this.previewSlot.delClassNames("success")},n.prototype._showPreviewItem=function(e){this.previewItem=e,this.previewSlot.setItem(e),this.previewSlot.addClassNames("success"),this.mergeBtn.enable(),e.item.isChangingCharacterLookWhenEquipped()?this._showHelp(u("tablet.mimicry.helpMerge")):this._showWarning(u("tablet.mimicry.fixedAppearance"))},n.prototype._showHelp=function(e){this.messageBox.setClassNames(["msgBox","help"]),this.messageText.setText(e)},n.prototype._showWarning=function(e){this.messageBox.setClassNames(["msgBox","warn"]),this.messageText.setText(e)},n.prototype._showError=function(e){this.messageBox.setClassNames(["msgBox","error"]),this.messageText.setText(e)},n.prototype._setListeners=function(){var e=window.dofus.connectionManager,t=this;e.on("ClientUIOpenedByObjectMessage",function(e){e.type===c.CLIENT_UI_OBJECT_MIMICRY&&_.open(t.id,e.uid)}),e.on("MimicryObjectPreviewMessage",function(e){h.createItemInstances(e.result,function(e,i){return e?console.error("Failed creating preview item:"+e):void t._showPreviewItem(i.array[0])})}),e.on("MimicryObjectAssociatedMessage",function(e){var i=window.gui.playerData.inventory.objects,n=i[e.hostUID],o="{itemStats,"+n.objectGID+","+n.objectUID+"}";window.gui.chat.logMsg(u("ui.mimicry.success",o)),_.close(t.id)}),e.on("MimicryObjectErrorMessage",function(e){if(e.reason===m.MIMICRY_OBJECT_ERROR){var i,n=!1;switch(e.errorCode){case-1:i=u("ui.error.state");break;case-2:i=u("ui.charSel.deletionErrorUnsecureMode");break;case-7:i=u("ui.mimicry.error.foodType");break;case-8:i=u("ui.mimicry.error.foodLevel");break;case-9:i=u("ui.mimicry.error.noValidMimicry");break;case-10:i=u("ui.mimicry.error.noValidHost");break;case-11:i=u("ui.mimicry.error.noValidFood");break;case-16:i=u("ui.mimicry.error.noMimicryAssociated");break;case-17:i=u("ui.mimicry.error.sameSkin");break;case-3:case-4:case-5:case-6:case-12:case-13:case-14:case-15:i=u("ui.popup.impossible_action"),n=!0;break;default:i=u("ui.common.unknownFail"),n=!0}n&&console.error("Abnormal mimicry error: "+e.errorCode),t._showError(i)}})}},function(e,t){},function(e,t){e.exports={CLIENT_UI_UNDEFINED:0,CLIENT_UI_TELEPORT_GUILD_HOUSE:1,CLIENT_UI_TELEPORT_GUILD_PADDOCK:2,CLIENT_UI_OBJECT_MIMICRY:3}},function(e,t,i){function n(e){l.call(this,{title:s("ui.common.inventory"),className:"ItemPickingWindow",plusButton:!1,positionInfo:{right:"10%",top:"c",width:280,height:564},openingSound:"OPEN_INVENTORY",closingSound:"CLOSE_INVENTORY"}),this.storageView=e,this.storageView.registerView(this,{manualOpening:!0,enableAveragePrice:!1,enableSlotContext:!1,tapSelectedEmitsDoubleTap:!0,filters:{quest:!0,preset:!0}}),this.hasDom=!1,this.on("open",this._onOpen)}i(1059);var o=i(383),s=i(29).getText,a=i(191).inherits,r=o.setDroppable,l=i(233);a(n,l),e.exports=n,n.prototype._onOpen=function(){this.hasDom||this._createDom(),this.storageBox.appendChild(this.storageView.storageUI),this.isReadyForUserInteraction=!1;var e=this;this.storageView.once("StorageViewerOpen",function(){e.isReadyForUserInteraction=!0})},n.prototype._createDom=function(){var e=this;this.hasDom=!0,this.storageBox=this.windowBody.createChild("div",{className:"storageBox"}),r(this.storageBox,["mimicry"]),this.storageBox.on("drop",function(t,i){e.emit("unpickItem",t,i)})},n.prototype.showEquippableItems=function(){this.storageView.showEquippableItems()}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"padLockWindow",title:l("ui.common.typeCode"),positionInfo:{left:"c",top:"c",width:400,height:360}});var e=this;this.padlockInfo={codeSize:8},this.once("open",function(){function t(){e.enterCode(this.id)}var i,n=9,o={};e.currentCodeDigit=0,e.codeDigitContainer=[],e.codeDigit=[];var s=e.windowBody.createChild("div",{className:"codeContainer"});for(i=0;i<e.padlockInfo.codeSize;i++)e.codeDigitContainer.push(s.createChild("div",{className:"codeDigitContainer"})),e.codeDigit.push(e.codeDigitContainer[i].createChild("div",{className:"codeDigit"}));var c=e.windowBody.createChild("div",{className:"container"}),u=c.createChild("div",{className:"leftPanel"});e.messageText=u.createChild("div",{className:"text"}),e.resetButton=u.createChild("div",{className:"resetButton"}),e.resetButton.createChild("div",{className:"resetButtonIcon"}),e.resetButton.createChild("div",{className:"resetButtonText",text:l("ui.common.resetCode")}),a(e.resetButton);var d=c.createChild("div",{className:"keypadContainer"});for(i=n;i>=0;i--)o[i]=d.appendChild(new r(i,{className:["keypad","num"+i]})),o[i].id=i,o[i].on("tap",t);var h=this.windowBody.createChild("div",{className:"confirmPanel"});e.confirmButton=h.appendChild(new r(l("ui.common.validation"),{className:"confirmButton"})),e.setupButtonEvents()}),this.on("open",function(t){t=t||{},e.fromInside=t.fromInside,e.resetCode();var i=e.padlockInfo.changeOrUse||t.fromInside;e.messageText.setText(l(i?"ui.common.lockInfos":"ui.common.unlockInfos"))}),e.setupListeners()}i(1061);var o=i(191).inherits,s=i(233),a=i(228),r=i(246).DofusButton,l=i(29).getText,c=i(225);o(n,s),e.exports=n,n.prototype.setupButtonEvents=function(){var e=this;this.confirmButton.on("tap",function(){for(var t="",i=0;i<e.padlockInfo.codeSize;i++)t+=isNaN(parseInt(e.codeDigit[i].getText(),10))?"_":e.codeDigit[i].getText();var n={code:t};return e.fromInside?(window.dofus.sendMessage("HouseLockFromInsideRequestMessage",n),void c.close(e.id)):void(e.padlockInfo.changeOrUse?window.dofus.sendMessage("LockableChangeCodeMessage",n):window.dofus.sendMessage("LockableUseCodeMessage",n))}),this.resetButton.on("tap",function(){e.resetCode()}),this.resetButton.on("tapstart",function(){this.addClassNames("pressed")}),this.resetButton.on("tapend",function(){this.delClassNames("pressed")})},n.prototype.setupListeners=function(){var e=this,t={0:l("ui.house.codeChanged"),1:l("ui.error.badCode")};window.gui.on("LockableShowCodeDialogMessage",function(t){e.padlockInfo=t,c.openDialog(e.id,{fromInside:!1})}),window.gui.on("LockableCodeResultMessage",function(e){window.gui.openPopup({title:l("ui.common.code"),message:t[e.result]})})},n.prototype.enterCode=function(e){var t=this.currentCodeDigit%this.padlockInfo.codeSize;this.codeDigit[t].setText(e),this.codeDigit[t].show(),this.currentCodeDigit++,this.highlightDigit()},n.prototype.resetCode=function(){for(var e=0;e<this.codeDigit.length;e++)this.codeDigit[e].setText(""),this.codeDigit[e].hide();this.currentCodeDigit=0,this.highlightDigit()},n.prototype.highlightDigit=function(){for(var e=this.currentCodeDigit%this.padlockInfo.codeSize,t=0;t<this.codeDigitContainer.length;t++)t===e?this.codeDigitContainer[t].addClassNames("highlight"):this.codeDigitContainer[t].delClassNames("highlight")}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"PartyInviteDetailsWindow",positionInfo:_}),this.partyMap={},this.numParties=0,this.partyId=null;var e=this;window.gui.on("disconnect",function(){e._closeAll()})}i(1063);var o=i(191).inherits,s=i(233),a=i(225),r=i(246).DofusButton,l=i(228),c=i(29).getText,u=i(792),d=i(623),h=i(415),p=i(457),m=i(483),f=563,g=904,_={left:"c",top:"c",minWidth:f,height:375};o(n,s),e.exports=n,n.prototype.showPartyDetails=function(e){return e===this.partyId?a.open(this.id):(window.dofus.sendMessage("PartyInvitationDetailsRequestMessage",{partyId:e}),this.partyMap[e]||(this.partyMap[e]=!0,this.numParties++,1===this.numParties&&this._setupListeners(!0)),void(this.text?this._resetDom():this._setupDom()))},n.prototype._closeAll=function(){for(var e in this.partyMap)this._closePartyInvitation(e);this.partyMap={},this.numParties=0,this.partyId=null},n.prototype._closePartyInvitation=function(e){this.partyMap[e]&&(delete this.partyMap[e],this.numParties--,0===this.numParties&&this._setupListeners(!1),window.gui.notificationBar.removeNotification("party"+e),e===this.partyId&&(this.partyId=null,a.close(this.id),this.windowBody.clearContent(),this.text=null,this.characters=[],this.members=null,this.scroller=null,this.slotList=null))},n.prototype._setupDom=function(){var e=this;this.text=this.windowBody.createChild("div",{className:"text"});var t=this.windowBody.createChild("div",{className:"container"});this.scroller=t.appendChild(new m({className:"slotList"},{isHorizontal:!0})),this.slotList=this.scroller.content,this.characters=[];var i=this.windowBody.createChild("div",{className:"buttons"}),n=i.appendChild(new r(c("ui.common.accept"),{className:"acceptButton"})),o=i.appendChild(new r(c("ui.common.refuse"),{className:"refuseButton"})),s=i.appendChild(new r(c("ui.social.blackListTemporarly"),{className:"ignoreButton"}));n.on("tap",function(){window.dofus.sendMessage("PartyAcceptInvitationMessage",{partyId:e.partyId}),e._closePartyInvitation(e.partyId)}),o.on("tap",function(){window.dofus.sendMessage("PartyRefuseInvitationMessage",{partyId:e.partyId}),e._closePartyInvitation(e.partyId)}),s.on("tap",function(){window.dofus.sendMessage("IgnoredAddRequestMessage",{name:e.fromName,session:!0}),e._closePartyInvitation(e.partyId)})},n.prototype._newCharacterSlot=function(){var e=this.slotList.createChild("div",{className:"character"});e.createChild("div",{className:"background",name:"background"}),e.appendChild(new h({name:"characterDisplay",scale:1.4,verticalAlign:"bottom"})),e.createChild("div",{className:"name",name:"name"}),e.createChild("div",{className:"breed",name:"breed"}),e.createChild("div",{className:"level",name:"level"}),l(e);var t=this;return e.on("tap",function(){if(e.characterId){var i=t.members[e.characterId];window.gui.openContextualMenu("player",{playerId:i.id,playerName:i.name})}}),e},n.prototype._resetDom=function(){this.characters=[],this.slotList.clearContent()},n.prototype._removeMember=function(e,t){if(e===this.partyId){var i=this.members[t];if(i){var n=i.index,o=this.characters.splice(n,1)[0];this.slotList.removeChild(o),this.characters.push(this._newCharacterSlot());for(var s in this.members)i=this.members[s],i.index>n&&i.index--;delete this.members[t],this.scroller.refresh()}}};var v=["PartyGuestInformations","PartyInvitationMemberInformations","PartyMemberInformations"];n.prototype._addOrUpdateMember=function(e,t,i){if(e===this.partyId){if(v.indexOf(t._type)===-1)return console.error("Unhandled type for character: "+t._type);var n=this.members[t.id];n?t.index=n.index:t.index=Object.keys(this.members).length,
this.members[t.id]=t,this._updateCharacterSlot(t),i||this.scroller.refresh()}},n.prototype._updateCharacterSlot=function(e){var t=this.characters[e.index];t||(t=this.characters[e.index]=this._newCharacterSlot()),t.characterId=e.id,t.getChild("name").setText(e.name),t.getChild("level").setText(c("ui.common.level")+" "+e.level),t.getChild("breed").setText(window.gui.databases.Breeds[e.breed].shortNameId);var i=t.getChild("characterDisplay");i.setLook(e.entityLook,{direction:p.DIRECTION_SOUTH_EAST,animation:"AnimStatique",boneType:"characters/",skinType:"characters/",riderOnly:!0}),this._toggleGuest(e.id,e.isGuest)},n.prototype._toggleGuest=function(e,t){var i=this.members[e];if(i){var n=this.characters[i.index];n.getChild("background").toggleClassName("guestFrame",!!t)}},n.prototype._toggleLeader=function(e,t){var i=this.members[e];if(i){var n=this.characters[i.index];n.getChild("background").toggleClassName("leaderIcon",!!t)}},n.prototype._setLeader=function(e,t){e===this.partyId&&(this._toggleLeader(this.leaderId,!1),this._toggleLeader(t,!0),this.leaderId=t)},n.prototype._joinParty=function(e){var t=e.partyId;this.partyId=t;var i=e.partyType===d.PARTY_TYPE_ARENA;_.width=i?f:g,this.position=null,a.open(this.id),this.windowTitle.setText(c(i?"ui.common.invitationArena":"ui.common.invitationGroupe")),this.slotList.toggleClassName("arena",i),this.slotList.toggleClassName("classic",!i);for(var n=i?u.NUM_SLOTS_ARENA:u.NUM_SLOTS_CLASSIC,o=n;o>0;o--)this.characters.push(this._newCharacterSlot());for(this.text.setText(c("ui.common.invitationPresentation",e.fromName)+"."),this.fromName=e.fromName,this.members={},o=0;o<e.members.length;o++)this._addOrUpdateMember(t,e.members[o],!0);for(o=0;o<e.guests.length;o++)this._addOrUpdateMember(t,e.guests[o],!0);this._setLeader(t,e.leaderId),this.scroller.refresh()},n.prototype._setupListeners=function(e){var t=window.gui.playerData.partyData;this.joinPartyHandler||(this.joinPartyHandler=this._joinParty.bind(this),this.closePartyInvitationHandler=this._closePartyInvitation.bind(this),this.setLeaderHandler=this._setLeader.bind(this),this.addOrUpdateMemberHandler=this._addOrUpdateMember.bind(this),this.removeMemberHandler=this._removeMember.bind(this)),e?(t.on("partyInvitationDetails",this.joinPartyHandler),t.on("partyInvitationCancelled",this.closePartyInvitationHandler),t.on("partyLeaderUpdate",this.setLeaderHandler),t.on("partyNewGuest",this.addOrUpdateMemberHandler),t.on("partyNewMember",this.addOrUpdateMemberHandler),t.on("partyUpdateMember",this.addOrUpdateMemberHandler),t.on("partyMemberLeaving",this.removeMemberHandler),t.on("partyGuestLeaving",this.removeMemberHandler)):(t.removeListener("partyInvitationDetails",this.joinPartyHandler),t.removeListener("partyInvitationCancelled",this.closePartyInvitationHandler),t.removeListener("partyLeaderUpdate",this.setLeaderHandler),t.removeListener("partyNewGuest",this.addOrUpdateMemberHandler),t.removeListener("partyNewMember",this.addOrUpdateMemberHandler),t.removeListener("partyUpdateMember",this.addOrUpdateMemberHandler),t.removeListener("partyMemberLeaving",this.removeMemberHandler),t.removeListener("partyGuestLeaving",this.removeMemberHandler))}},function(e,t){},function(e,t,i){function n(){function e(){l.close("presetChooseIcon",c.YES)}r.call(this,{className:"PresetChooseIconWindow",title:s("ui.option.tabPic"),positionInfo:{left:"c",top:"c",width:460,height:250}}),this.once("open",function(t){this.windowBody.appendChild(t),this.saveButton=this.windowBody.appendChild(new o(s("ui.common.save"))),this.saveButton.on("tap",function(){e()})})}var o=i(246).DofusButton,s=i(29).getText,a=i(191).inherits,r=i(233),l=i(225),c=i(907).actionsEnum;a(n,r),e.exports=n},function(e,t,i){function n(){var e=this;a.call(this,{title:r("ui.achievement.rewardsWaiting"),className:"rewardsPending",positionInfo:{left:"c",top:"c-32px",width:500,height:300}}),this.rewards={},this._rewardItems=[],this.isInFight=!1,this.isInTutorial=!1,this.rewardsList=this.windowBody.createChild("div",{className:"rewardsList"}),this.counter=this.windowBody.createChild("div",{className:"counter"}),this.acceptAllButton=this.windowBody.appendChild(new l(r("ui.common.acceptAll"))),this.acceptAllButton.on("tap",function(){e.collectAll()});var t=window.gui;t.playerData.achievements.on("achievementFinished",function(t){e.addReward(t.id,t.finishedlevel)}),t.playerData.achievements.on("achievementListUpdated",function(t){for(var i=0;i<t.rewardableAchievements.length;i+=1){var n=t.rewardableAchievements[i];e.addReward(n.id,n.finishedlevel)}}),t.playerData.achievements.on("achievementRewardSuccess",function(t){e.removeReward(t);for(var i=e._rewardItems.length-1;i>=0;i--)if(e._rewardItems[i].id===t){for(var n=0;n<e._rewardItems[i].itemsReward.length;n++)window.gui.chat.logMsg(r("ui.common.newItem",e._rewardItems[i].itemsQuantityReward[n],e._rewardItems[i].itemsReward[n]));e._rewardItems.splice(i,1)}}),t.on("disconnect",function(){e.reset()}),t.fightManager.on("fightStart",function(){e.isInFight=!0,e.handleRewardsIndicatorDisplay()}),t.fightManager.on(p.FIGHT_END,function(){e.isInFight=!1,e.handleRewardsIndicatorDisplay()}),t.tutorialManager.on("inTutorialStateChanged",function(t){e.isInTutorial=t,e.handleRewardsIndicatorDisplay()})}i(1066);var o=i(31),s=i(191).inherits,a=i(233),r=i(29).getText,l=i(246).DofusButton,c=i(834),u=i(228),d=i(225),h=i(30),p=i(395),m=i(202),f=i(252),g=i(509);s(n,a),e.exports=n,n.prototype.addReward=function(e,t){function i(t){h.getData("Achievements",e,function(e,i){return e?t(e):(I=i.nameId,E=i.categoryId,L=i.rewardIds,A=i,t())})}function n(e){h.getData("AchievementCategories",E,function(t,i){return t?e(t):(S=i.parentId,x=i.nameId,e())})}function s(e){return 0===S?e():void h.getData("AchievementCategories",S,function(t,i){return t?e(t):(x=i.nameId,e())})}function a(e){return 0===L.length?e():void h.getData("AchievementRewards",L,function(i,n){if(i)return e(i);if(!y.rootElement)return e();for(var o=!0,s=0;s<n.length;s+=1){var a=n[s],r=window.gui.playerData.achievements.completedData(A.id),l=a.isLinkedToAccount&&r.isAccountCompleted,c=r.finishedlevel||window.gui.playerData.characterBaseInformations.level;if(a.experienceRatio){var u=0;l||(u=window.gui.playerData.achievements.getAchievementExperienceReward(a,A.level,c)),y.xp.setText(f.kamasToString(u,""))}else if(a.kamasRatio){var d=0;l||(d=window.gui.playerData.achievements.getAchievementKamasReward(a,A.level,c)),y.kamas.setText(f.kamasToString(d,""))}!l&&(a.levelMin===-1||a.levelMin<=t)&&(a.levelMax===-1||a.levelMax>=t)&&(a.itemsReward&&a.itemsReward.length>0&&Array.prototype.push.apply(N,a.itemsReward),a.itemsQuantityReward&&a.itemsQuantityReward.length>0&&Array.prototype.push.apply(O,a.itemsQuantityReward),v._rewardItems.push({id:A.id,itemsReward:a.itemsReward,itemsQuantityReward:a.itemsQuantityReward}),a.emotesReward&&a.emotesReward.length>0&&Array.prototype.push.apply(D,a.emotesReward),a.titlesReward&&a.titlesReward.length>0&&Array.prototype.push.apply(R,a.titlesReward),a.ornamentsReward&&a.ornamentsReward.length>0&&Array.prototype.push.apply(P,a.ornamentsReward),o=!1)}return e(o?new Error("rewardNotFound"):null)})}function r(e){return 0===N.length?e():void g.getItems(N,function(t){if(t)return e(t);for(var i=0;i<N.length;i+=1){var n=g.items[N[i]];n||(n=g.items[g.FALLBACK_DB_ITEM_ID]),B.push("gfx/items/"+n.iconId+".png")}return e()})}function l(e){for(var t=0;t<D.length;t+=1)B.push("gfx/emotes/"+D[t]+".png");return e()}function d(e){for(var t=0;t<R.length;t+=1)B.push("gfx/illusUi/genericTitleIcon.png");return e()}function p(e){return 0===P.length?e():void h.getData("Ornaments",P,function(t,i){if(t)return e(t);for(var n=0;n<i.length;n+=1)B.push("gfx/ornaments/"+i[n].iconId+".png");return e()})}function _(e){return 0===B.length?e():void m.preloadImages(B,function(t){for(var i=0;i<t.length;i+=1){var n=T[i];n&&n.rootElement&&(n.setImage(t[i]),n.setQuantity(O[i]))}return e()})}var v=this,y=this.rewardsList.createChild("div",{className:"reward"});y.id=e,y.left=y.createChild("div",{className:"rewardLeft"}),y.right=y.createChild("div",{className:"rewardRight"}),y.nameText=y.left.createChild("div",{className:"rewardName"}),y.category=y.right.createChild("div",{className:"rewardCategory"}),y.numbers=y.right.createChild("div",{className:"rewardNumbers"}),y.xp=y.numbers.createChild("div",{className:"rewardXp"}),y.kamas=y.numbers.createChild("div",{className:"rewardKamas"}),y.collectButton=y.right.createChild("div",{className:"collectButton"}),u(y.collectButton),y.collectButton.on("tap",function(){v.collectReward(y.id)});for(var b=y.left.createChild("div",{className:"rewards",name:"rewards"}),w=b.createChild("div",{className:"rewardList"}),M=6,T=[],C=0;C<M;C+=1)T[C]=w.appendChild(new c({name:"icon"+C}));this.rewards[e]=y,this.updateCounter(),this.handleRewardsIndicatorDisplay();var I,A,S,E,x,L,N=[],O=[],D=[],R=[],P=[],B=[];o.series([i,n,s,a,r,l,d,p,_],function(e){return e?console.error(e):void(y.rootElement&&(y.nameText.setText(I),y.category.setText(x)))})},n.prototype.removeReward=function(e){var t=this.rewards[e];t.destroy(),delete this.rewards[e],this.updateCounter(),this.handleRewardsIndicatorDisplay()},n.prototype.collectAll=function(){window.dofus.sendMessage("AchievementRewardRequestMessage",{achievementId:-1})},n.prototype.collectReward=function(e){window.dofus.sendMessage("AchievementRewardRequestMessage",{achievementId:e})},n.prototype.updateCounter=function(){var e=Object.keys(this.rewards).length;this.counter.setText(r("ui.achievement.rewardsRemaining",e))},n.prototype.handleRewardsIndicatorDisplay=function(){var e=Object.keys(this.rewards).length;0===e&&d.close("rewardsPending"),window.gui.rewardsIndicator.toggleDisplay(e>0&&!this.isInFight&&!this.isInTutorial)},n.prototype.reset=function(){this.rewards={},this.isInFight=!1,this.isInTutorial=!1,this.rewardsList.clearContent()}},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"ServerDetailsWindow",title:c("ui.sersel.suggestedServer"),positionInfo:{left:"c",top:"c",width:350,height:350},hidden:!0});var e,t=this,i=this.windowBody,n=i.appendChild(new s),o=i.createChild("div",{className:"buttonsDiv"}),u=o.appendChild(new l(c("ui.common.ok"),{className:"okBtn"})),d=o.appendChild(new l(c("ui.common.cancel"),{className:"cancelBtn"}));u.on("tap",function(){return e?(u.disable(),window.gui.serversData.selectServer(e.id),void r.close(t.id)):console.error("No server")}),d.on("tap",function(){r.close(t.id)}),this.on("open",function(t){e=t,n.setServer(e),3===e.status?u.enable():u.disable()})}i(1068);var o=i(191).inherits,s=i(1069),a=i(233),r=i(225),l=i(246).DofusButton,c=i(29).getText;o(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(e){var t=c.createChild("div",{className:["detail",e]});t.createChild("div",{className:["line","label"],text:n[e]}),i._detailsBlock[e]=t.createChild("div",{className:["line","text"]})}function t(e){u!==e&&("description"===e?(h.addClassNames("selected"),p.delClassNames("selected"),u="description",i._descContent.show(),i._rulesContent.hide()):(h.delClassNames("selected"),p.addClassNames("selected"),u="rules",i._descContent.hide(),i._rulesContent.show()))}s.call(this,"div",{className:"ServerDetails"});var i=this,n={name:r("ui.common.name")+":",community:r("ui.sersel.community")+":",population:r("ui.sersel.population")+":",type:r("ui.sersel.type")+":",status:r("ui.sersel.state")+":",openingDate:r("ui.sersel.date")+":"},o=this.createChild("div",{className:"content"}),l=o.createChild("div",{className:"top"});this._image=l.createChild("div",{className:"image"});var c=l.createChild("div",{className:"details"});this._detailsBlock={},e("name"),e("empty"),e("community"),e("population"),e("type"),e("status"),e("openingDate");var u="description",d=o.createChild("div",{className:"bottom"}),h=d.createChild("div",{className:"descBtn",text:r("ui.common.description")}),p=d.createChild("div",{className:"rulesBtn",text:r("ui.sersel.rules")});a(h),a(p),h.on("tap",function(){t("description")}),p.on("tap",function(){t("rules")});var m=d.createChild("div",{className:"bottomContent"});this._descContent=m.createChild("div",{className:"descContent"}),this._rulesContent=m.createChild("div",{className:"rulesContent"}),h.addClassNames("selected"),this._rulesContent.hide()}i(1070);var o=i(191).inherits,s=i(235),a=i(228),r=i(29).getText,l=i(730);o(n,s),e.exports=n,n.prototype.setServer=function(e){var t=this,i={0:r("ui.server.state.unknown"),1:r("ui.server.state.offline"),2:r("ui.server.state.starting"),3:r("ui.server.state.online"),4:r("ui.server.state.nojoin"),5:r("ui.server.state.saving"),6:r("ui.server.state.stoping"),7:r("ui.server.state.full")},n={0:r("ui.server.rules.0"),1:r("ui.server.rules.1")};window.gui.serversData.syncServerStaticData(function(o){if(o)return console.error("ServerDetails setServer error",o);l.getServerImage(e.id,function(e,i){return e?console.error(e):void t._image.setStyle("backgroundImage",i)}),t._detailsBlock.status.setText(i[e.status]);var s=window.gui.serversData.staticContent,a=s.data[e.id]||{},r=s.gameTypes[a.gameTypeId]||{},c=s.populations[a.populationId]||{},u=s.communities[a.communityId]||{};t._detailsBlock.name.setText(a.nameId||e.id),t._detailsBlock.community.setText(u.nameId||"n/a"),t._detailsBlock.population.setText(c.nameId||"n/a"),t._detailsBlock.type.setText(r.nameId||"n/a");var d=new Date(a.openingDate||0);t._detailsBlock.openingDate.setText(d.getDate()+"/"+(d.getMonth()+1)+"/"+d.getFullYear()),t._descContent.setText(a.commentId),t._rulesContent.setText(n[a.gameTypeId]||"")})}},function(e,t){},function(e,t,i){function n(){function e(e,t,i){var n=e.createChild("div",{className:t});return a(n),n.on("tap",i),n}function t(){M&&(M.delClassNames("selected"),M=null),P.hide(),H.disable()}function i(){t();var e=f;e=e.filter(function(e){return e.id!==p}),b&&(e=e.filter(function(e){return e.charactersCount>0})),y||(e=e.filter(function(e){return T.indexOf(e.id)!==-1})),v&&(e=e.filter(function(e){return v.indexOf(e.id)!==-1})),window.gui.serversData.syncServerStaticData(function(t){if(t)return console.error("ServerRow getServerStaticData error",t);var i=window.gui.serversData.staticContent;e.sort(function(e,t){if(!i.data[e.id])return 1;if(!i.data[t.id])return-1;var n=i.data[e.id].populationId,o=i.data[t.id].populationId,s=i.populations[n].weight,a=i.populations[o].weight,r=s-a;return 0!==r?r:t.id-e.id});for(var o=0,s=Math.max(e.length,C.length);o<s;o+=1){var a=e[o],r=C[o];a?r?(r.setServer(a),r.show()):n(a,C.length%2):r&&r.hide()}!M&&e[0]&&C[0].emit("tap")})}function n(e,t){var i=O.appendChild(new r(e,t));C.push(i),i.on("tap",function(){M&&M.delClassNames("selected"),i.addClassNames("selected"),M=i,P.setServer(i.data),P.show(),3===i.data.status?H.enable():H.disable()})}function o(){y?(y=!1,k.delClassNames("selected")):(y=!0,k.addClassNames("selected"))}function m(){b?(b=!1,F.delClassNames("selected")):(b=!0,F.addClassNames("selected"))}s.call(this,{className:"ServerListSelectionWindow",title:u("ui.sersel.choseServer"),positionInfo:{left:"c",top:"c",width:700,height:510},hidden:!0});var f,g,_,v,y,b,w=this,M=null,T=[],C=[],I={0:u("ui.sersel.searchError.unknown"),1:u("ui.sersel.searchError.unavailable"),2:u("ui.sersel.searchError.no_result"),3:u("ui.sersel.searchError.flood")},A=this.windowBody,S=A.createChild("div",{className:"findFriendDiv"});S.createChild("div",{className:"findFriendLabel",text:u("ui.sersel.findFriend")+": "});var E=S.appendChild(new h({className:"inputFriend",attr:{type:"text",id:"inputFriend"}}));e(S,["okBtn","btn"],function(){E.rootElement.value&&(g=E.rootElement.value,window.dofus.sendMessage("AcquaintanceSearchMessage",{nickname:g}))}),e(S,["clearBtn","btn"],function(){E.rootElement.value="",v=null,i()});var x=A.createChild("div",{className:"middleDiv"}),L=x.createChild("div",{className:"leftFrame"}),N=L.createChild("div",{className:"serverList"}),O=N.createChild("div",{className:"div-table"}),D=O.createChild("div",{className:["listHead","listRow","odd"]});D.createChild("div",{className:["listHeadBox","empty"]}),D.createChild("div",{className:["listHeadBox","name"],text:u("ui.common.name")}),D.createChild("div",{className:["listHeadBox","population"],text:u("ui.sersel.population")}),D.createChild("div",{className:["listHeadBox","status"],text:u("ui.sersel.state")});var R=x.createChild("div",{className:"rightFrame"});R.createChild("div",{className:"title",text:u("ui.sersel.suggestedServer")+":"});var P=R.appendChild(new l),B=L.createChild("div",{className:"filtersBtn"}),k=e(B,"allServersBtn",function(){o(),i()}),F=e(B,"myServersBtn",function(){m(),i()}),z=A.createChild("div",{className:"topBtnDiv"}),H=z.appendChild(new c(u("ui.common.validation"),{className:"confirmBtn"}));H.on("tap",function(){M&&(H.disable(),window.gui.serversData.selectServer(M.data.id))});var q=A.createChild("div",{className:"bottomLeftBtnDiv"}),W=q.appendChild(new c(u("ui.common.back"),{className:"returnBtn"}));W.on("tap",function(){d.close(w.id)});var U=A.createChild("div",{className:"bottomRightBtnDiv"}),Y=U.appendChild(new c(u("ui.sersel.autochoice"),{className:"autochooseBtn"}));Y.on("tap",function(){window.gui.serversData.pickUpOneServerForMe()}),this.on("open",function(){f=window.gui.serversData.serversRawData,t(),window.gui.serversData.getAutoChosenServers(function(e,t){e&&console.warn(e),_=t||[],y=!1,k.delClassNames("selected"),b=!1,F.delClassNames("selected"),T=[];for(var n=0,o=_.length;n<o;n+=1)T.push(_[n].id);i(),window.gui.serversData.on("serversUpdate",i)})}),this.on("close",function(){window.gui.serversData.removeListener("serversUpdate",i)}),window.gui.on("AcquaintanceSearchErrorMessage",function(e){var t=e.reason;t&&window.gui.openPopup({title:u("ui.common.error"),message:I[t].replace("%1",g)})}),window.gui.on("AcquaintanceServerListMessage",function(e){v=e.servers,i()}),window.gui.on("TrustStatusMessage",function(){d.close(w.id)})}i(1072);var o=i(191).inherits,s=i(233),a=i(228),r=i(1073),l=i(1069),c=i(246).DofusButton,u=i(29).getText,d=i(225),h=i(582),p=407;o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(e,t){s.call(this,"div",{className:["ServerRow","listRow"]}),a(this),t&&this.addClassNames("odd"),this._DEFAULT_POPULATION_CLASSES=["listBox","listCell","population"],this._DEFAULT_NAME_CLASSES=["listBox","listCell","name"];var i=this.createChild("div",{className:["listBox","listCell","flag"]});this._flag=i.createChild("div",{className:"flagImage"}),this._serverName=this.createChild("div",{className:this._DEFAULT_NAME_CLASSES}),this._population=this.createChild("div",{className:this._DEFAULT_POPULATION_CLASSES});var n=this.createChild("div",{className:["listBox","listCell","status"]});this._status=n.createChild("div",{className:"statusImage"}),this.setServer(e)}i(1074);var o=i(191).inherits,s=i(235),a=i(228),r=i(202);o(n,s),e.exports=n,n.prototype.setServer=function(e){if(!e)return this._flag.hide(),this._serverName.setText(""),this._population.setText(""),void this._status.hide();var t=this;this.id=e.id,this.data=e;var i=window.gui.serversData.staticContent,n=window.gui.serversData.staticContent.data[this.id]||{};this._flag.show(),this._status.show(),this._serverName.setText(n.nameId||e.id),this._serverName.setClassNames(this._DEFAULT_NAME_CLASSES),1===n.gameTypeId&&this._serverName.setClassNames(this._DEFAULT_NAME_CLASSES,"heroic"),this._population.setClassNames(this._DEFAULT_POPULATION_CLASSES,"popu_",n.populationId);var o=i.populations[n.populationId]||{};this._population.setText(o.nameId||"n/a"),this._status.setClassNames(["statusImage","status_"+e.status]),r.preloadImage("gfx/flags/flag_"+n.communityId+".png",function(e){t._flag.setStyle("backgroundImage",e)})}},function(e,t){},function(e,t,i){function n(){function e(e){n&&n.delClassNames("selected"),n=e,e&&(e.addClassNames("selected"),h=e.data.id,o.selectBtn.enable(),o.createCharBtn.enable())}function t(){var t=window.gui.serversData.serversWithMyCharacter;e(null);for(var i=0;i<d;i+=1){var n=m[i],o=t[i+p];n.setServer(o),o&&o.id===h&&o.status===u.ONLINE&&e(n)}p<=0?g.disable():g.enable(),p>=t.length-d?v.disable():v.enable()}function i(t){var i=_.appendChild(new l(t));i.on("tap",function(){e(this)}),m.push(i)}a.call(this,{className:"ServerSelectionWindow",title:c("ui.sersel.choseServer"),positionInfo:{left:"c",top:"c",width:700,height:445},hidden:!0});var n,o=this,d=4,h=null,p=0,m=[];this.closeButton.on("tap",function(){window.dofus.disconnect()});var f=this.windowBody,g=f.appendChild(new s({className:["arrow","arrowLeft"]},function(){p<=0||(g.disable(),p-=1,t())}));g.on("disabled",function(){this.addClassNames("disabled")}),g.on("enabled",function(){this.delClassNames("disabled")});var _=f.createChild("div",{className:"serverBoxesDiv"}),v=f.appendChild(new s({className:["arrow","arrowRight"]},function(){var e=window.gui.serversData.serversWithMyCharacter;p>=e.length-d||(v.disable(),p+=1,t())}));v.on("disabled",function(){this.addClassNames("disabled")}),v.on("enabled",function(){this.delClassNames("disabled")});for(var y=0;y<d;y+=1)i();var b=f.appendChild(new s({className:["greenButton","selectServerBtn"],text:c("ui.common.select")},function(){b.disable(),o.createCharBtn.disable(),window.gui.serversData.connectedServerId===h?(window.dofus.sendMessage("CharactersListRequestMessage"),r.close(o.id)):window.gui.serversData.selectServer(h)}));this.selectBtn=b,b.disable();var w=f.createChild("div",{className:"createCharacterDiv"});this.createCharBtn=w.appendChild(new s({className:["greenButton","createCharacterBtn"],text:c("ui.charsel.createCharacter")},function(){r.close(o.id),r.open("serverSimpleSelection")})),window.gui.on("TrustStatusMessage",function(){r.close(o.id)}),this.on("open",function(){var e=window.gui.serversData.serversWithMyCharacter;if(!h){var i=e[0]||{};h=i.id}p=0,g.disable(),e.length<=d&&v.disable(),t(),window.gui.serversData.on("serversUpdate",t),o.consoleButton.toggleDisplay(window.gui.playerData.identification.hasConsoleRight)}),this.on("close",function(){window.gui.serversData.removeListener("serversUpdate",t)}),this.consoleButton=f.appendChild(new s({className:["consoleButton"],hidden:!0},function(){r["switch"]("adminConsole")}))}i(1076);var o=i(191).inherits,s=i(246),a=i(233),r=i(225),l=i(1077),c=i(29).getText,u=i(731);o(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"ServerBox"}),a(this),this._SERVER_STATUS={0:r("ui.server.state.unknown"),1:r("ui.server.state.offline"),2:r("ui.server.state.starting"),3:r("ui.server.state.online"),4:r("ui.server.state.nojoin"),5:r("ui.server.state.saving"),6:r("ui.server.state.stoping"),7:r("ui.server.state.full")},this._completions=[],this._title=this.createChild("div",{className:"title"}),this._content=this.createChild("div",{className:"content"}),this._placeholder=this.createChild("div",{className:"placeholderDiv"}),this._content.createChild("div",{className:"selection"}),this._image=this._content.createChild("div",{className:"image"});for(var t=0;t<5;t+=1)this._completions.push(this._content.createChild("div",{className:"completion"}));this._heroicIcon=this._content.createChild("div",{className:"heroicIcon"});var i=this._content.createChild("div",{className:"statusBlock"});this._statusIcon=i.createChild("div",{className:"statusIcon"}),this._statusText=i.createChild("div",{className:"statusText"}),this.setServer(e)}i(1078);var o=i(191).inherits,s=i(235),a=i(228),r=i(29).getText,l=i(730),c=i(731);o(n,s),e.exports=n,n.prototype.setServer=function(e){var t=this;if(this.delClassNames("placeHolder"),this._placeholder.hide(),!e)return this.addClassNames("placeHolder"),this.disable(),this._content.hide(),this._placeholder.show(),void this._title.setText("");this._title.setText(e._name||e.id);for(var i=0,n=this._completions.length;i<n;i+=1){var o=this._completions[i];i<e.charactersCount?o.addClassNames("on"):o.delClassNames("on")}var s=1===e._gameTypeId;this._heroicIcon.toggleDisplay(s),this.data=e,e.status===c.ONLINE?this.enable():this.disable(),this._statusIcon.setClassNames(["statusIcon","status_"+e.status]),this._statusText.setText(this._SERVER_STATUS[e.status||0]),this._content.show(),l.getServerImage(e.id,function(e,i){return e?console.error(e):void t._image.setStyle("backgroundImage",i)})}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"ServerSimpleSelectionWindow",title:c("ui.sersel.choseServer"),positionInfo:{left:"c",top:"c",width:700,height:400},hidden:!0}),this.once("open",n.prototype._createContent)}i(1080);var o=i(191).inherits,s=i(233),a=i(225),r=i(246),l=r.DofusButton,c=i(29).getText,u=i(202);o(n,s),e.exports=n,n.prototype._createContent=function(){var e=this,t=this.windowBody,i=t.createChild("div",{className:"bg"});u.preloadImage("gfx/illusUi/simpleServerChoiceIllu.png",function(e){i.setStyle("backgroundImage",e)});var n=t.appendChild(new l(c("ui.sersel.autoChoice"),{className:"autoSelectServerBtn"}));n.on("tap",function(){window.gui.serversData.pickUpOneServerForMe()});var o=t.createChild("div",{className:"manualCreationDiv"}),s=o.appendChild(new l(c("ui.sersel.manualChoice"),{className:"manualCreationBtn"}));s.on("tap",function(){a.open("serverListSelection")}),this.on("close",function(e){e&&e.validated||a.open("serverSelection")}),window.gui.on("TrustStatusMessage",function(){a.close(e.id,{validated:!0})}),this.consoleButton=t.appendChild(new r({className:["consoleButton"],hidden:!window.gui.playerData.identification.hasConsoleRight},function(){a["switch"]("adminConsole")}))}},function(e,t){},function(e,t,i){function n(){c.call(this,{className:"teleporterListWindow",title:"_",positionInfo:{left:"c",top:"c",width:"600",height:"440"}});var e=this;this.parentBody=null,this.zaapBody=this.windowBody.createChild("div",{className:["teleporterBody","zaapBody"]}),this.subwayBody=this.windowBody.createChild("div",{className:["teleporterBody","subwayBody"]}),this.createTabs(this.zaapBody,[{title:m("ui.zaap.zaap"),name:"Zaap"},{title:m("ui.zaap.prism"),name:"Prism"}]),this.createTabs(this.subwayBody,[{title:m("ui.map.craftHouse"),name:"CraftHouse"},{title:m("ui.map.bidHouse"),name:"BidHouse"},{title:m("ui.common.misc"),name:"Misc"}]),this.createFooter(),window.gui.on("ZaapListMessage",function(t){e.setContent(t)}),window.gui.on("TeleportDestinationsListMessage",function(t){e.setContent(t)})}function o(){this.myTable.highlightRow(this.myRow)}i(1082);var s,a,r,l=i(191).inherits,c=i(233),u=i(235),d=i(246),h=i(1002).MapLocationButton,p=i(225),m=i(29).getText,f=i(252),g=i(934),_=i(735),v=i(1083),y=3,b=2;l(n,c),e.exports=n,n.prototype.createTabs=function(e,t){e.tabs=new g,e.appendChild(e.tabs),e.panels=e.createChild("div",{className:"panels"}),e.panelCollection={};for(var i=0,n=t.length;i<n;i+=1){var o=t[i].name;e.panelCollection[o]=e.panels.createChild("div",{className:["panel"]}),e.tabs.addTab(t[i].title,e.panelCollection[o]),this.createTable(e.panelCollection[o])}},n.prototype.createTable=function(e){function t(t){e.selectedTeleporterType=t.teleporterType,e.selectedMapId=t.mapId}var i=m("ui.zaap.destination")+m("ui.common.colon"),n=m("ui.common.area")+" ("+m("ui.common.subarea")+")";e.table=e.appendChild(new _({colIds:["saved","destination","coordinates","cost"],colCount:4,highlightable:!0,headerContent:["",i+n,m("ui.common.coordinatesSmall"),m("ui.common.cost")],onRowTap:t}))},n.prototype.createFooter=function(){var e=this,t=this.windowBody.createChild("div",{className:"footer"}),i=t.appendChild(new d({className:"greenButton",text:m("ui.common.validation")}));i.on("tap",function(){var t=e.parentBody.tabs.getCurrentTab().target;window.dofus.sendMessage("TeleportRequestMessage",{teleporterType:t.selectedTeleporterType,mapId:t.selectedMapId})}),this.nbKamas=t.createChild("div",{className:"nbKamas"})},n.prototype.setContent=function(e){switch(p.openDialog(this.id),this.setClassNames("window","teleporterListWindow"),s=window.gui.playerData.inventory.kamas,a=window.gui.playerData.position.mapId,r=window.gui.playerData.position.subArea.nameId,e.teleporterType){case v.TELEPORTER_ZAAP:case v.TELEPORTER_PRISM:this.setupZaapBody(e);break;case v.TELEPORTER_SUBWAY:this.setupSubwayBody(e)}this.nbKamas.setText(f.kamasToString(s,""))},n.prototype.setupZaapBody=function(e){var t,i,n;n=m(e.teleporterType===v.TELEPORTER_ZAAP?"ui.zaap.zaap":"ui.zaap.prism"),this.windowTitle.setText(n+" - "+r),a===e.spawnMapId?this.windowTitle.addClassNames("saved"):this.windowTitle.delClassNames("saved"),this.parentBody=this.zaapBody,this.zaapBody.show(),this.subwayBody.hide();for(t in this.zaapBody.panelCollection)i=this.zaapBody.panelCollection[t],i.table&&i.table.clearContent();var o=e._subAreas.length,s=[];for(t=0;t<o;t+=1){var l=e._subAreas[t],c=e._maps[t],u=e.destTeleporterType[t];s.push({name:l.areaName+" ("+l.name+")",type:u,posX:c.posX,posY:c.posY,mapId:c.id,teleporterCost:e.costs[t],saved:c.id===e.spawnMapId})}for(s.sort(function(e,t){return e.name>t.name?1:-1}),t=0;t<o;t+=1){var d=s[t],h=d.type===v.TELEPORTER_ZAAP||d.type===v.TELEPORTER_PRISM;if(d.mapId!==a&&h){var p;d.type===v.TELEPORTER_ZAAP&&(p=this.zaapBody.panelCollection.Zaap),d.type===v.TELEPORTER_PRISM&&(p=this.zaapBody.panelCollection.Prism),this._addTeleporter({parentPanel:p,teleporterType:d.type,destinationName:d.name,posX:d.posX,posY:d.posY,mapId:d.mapId,teleporterCost:d.teleporterCost,saved:d.saved})}}this.setupTabs()},n.prototype.setupSubwayBody=function(e){var t,i,n;this.windowTitle.setText(m("ui.zaap.zaapi")+" - "+r),a===e.spawnMapId?this.windowTitle.addClassNames("saved"):this.windowTitle.delClassNames("saved"),this.parentBody=this.subwayBody,this.zaapBody.hide(),this.subwayBody.show();for(t in this.subwayBody.panelCollection)i=this.subwayBody.panelCollection[t],i.table&&i.table.clearContent();var o=e._hints.length,s=[];for(t=0;t<o;t+=1)n=e._hints[t],s.push({name:n.nameId,category:n.categoryId,posX:n.x,posY:n.y,mapId:n.realMapId||n.mapId,teleporterCost:n.teleporterCost,saved:n.mapId===e.spawnMapId});for(s.sort(function(e,t){return e.name>t.name?1:-1}),t=0;t<o;t+=1)if(n=s[t],n.mapId!==a){var l;l=n.category===y?this.subwayBody.panelCollection.CraftHouse:n.category===b?this.subwayBody.panelCollection.BidHouse:this.subwayBody.panelCollection.Misc,this._addTeleporter({parentPanel:l,teleporterType:v.TELEPORTER_SUBWAY,destinationName:n.name,posX:n.posX,posY:n.posY,mapId:n.mapId,teleporterCost:n.teleporterCost,saved:n.saved})}this.setupTabs()},n.prototype._addTeleporter=function(e){var t=e.parentPanel.table,i=e.teleporterCost,n=new u("div");n.createChild("div",{className:"destinationName",text:e.destinationName});var a=n.appendChild(new h({type:"zaap",x:e.posX,y:e.posY})),r=t.addRow({saved:e.saved?new u("div",{className:"saved"}):"",destination:n,coordinates:e.posX+","+e.posY,cost:f.kamasToString(i)},{teleporterType:e.teleporterType,mapId:e.mapId});s<i&&r.addClassNames("disabled"),a.myTable=t,a.myRow=r,a.on("tap",o)},n.prototype.setupTabs=function(){var e=this.parentBody.tabs,t=e.getTabsMap(),i=!1;for(var n in t){var o=t[n];o.target.table.getRows().length<=0?o.tab.disable():(o.tab.enable(),i||(e.openTab(n),i=!0))}if(!i){var s=e.getFirstTab();s.tab.enable(),e.openFirstTab()}}},function(e,t){},function(e,t){e.exports={TELEPORTER_ZAAP:0,TELEPORTER_SUBWAY:1,TELEPORTER_PRISM:2}},function(e,t,i){function n(e){function t(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:n.objectUID,quantity:m?-e:e})}function i(e,i,o,s){return m=s||!1,n=e.itemInstance,1===n.quantity?t(1,m):(r="items",void f.open({min:1,max:n.quantity,x:i,y:o}))}h.call(this,{title:a("ui.common.inventory"),className:"ExchangeInventoryWindow",positionInfo:{right:"0.5%",bottom:"3%",width:"30%",height:"94%"}});var n,r,m;e.registerView(this,{contextParams:{enableDestroy:!0},leftArrow:!0});var f=this.minMaxSelector=window.gui.windowsContainer.appendChild(new c);f.on("confirm",function(e){"items"===r?t(e):window.dofus.sendMessage("ExchangeObjectMoveKamaMessage",{quantity:e})});var g=this.windowBody.appendChild(new o(a("tablet.exchange.deposit")));g.addClassNames("depositButton"),
g.on("tap",function(){var t=e.kamasValue;if(t){var i=p.getWindow("exchangeStorage");i.closeMinMaxSelector(),u.positionNextTo(f,g),r="kamas",f.open({min:1,max:t})}}),this.on("open",function(t){this.exchangeType=t.exchangeType,this.exchangeType===s.STORAGE&&e.addFilters([l.unlinkedItemsFilter]),e.filterList(),e.resetDisplay(),this.windowBody.appendChild(g),g.toggleDisplay(t.exchangeType!==s.MOUNT),g.setEnable(!!e.kamasValue)}),this.on("close",function(){this.exchangeType===s.STORAGE&&e.removeFilter(l.unlinkedItemsFilter),f.closeMinMax(),this.exchangeType=-1}),this.on("kamasUpdated",function(e){g.isVisible()&&g.setEnable(!!e)}),this.on("slot-doubletap",i),this.on("leftArrow-tap",function(t){window.gui.openContextualMenu("storage",{toInventory:!1,viewer:e},{x:t.x,y:t.y})}),d(this,["exchangeStorage"]),this.on("drop",function(e,t,n){i(e,n.x,n.y,!0)})}i(1085);var o=i(246).DofusButton,s=i(280),a=i(29).getText,r=i(191).inherits,l=i(509),c=i(386),u=i(250),d=i(383).setDroppable,h=i(233),p=i(225);r(n,h),e.exports=n,n.prototype.closeMinMaxSelector=function(){this.minMaxSelector.closeMinMax()}},function(e,t){},function(e,t,i){function n(){function e(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:g.objectUID,quantity:v?e:-e})}function t(t,i,n,o){return v=o||!1,g=t.itemInstance,1===g.quantity?e(1):(_="items",void M.open({min:1,max:g.quantity,x:i,y:n}))}function i(e){switch(b.exchangeType){case r.STORAGE:y&&c.updateBankItems(e);break;case r.MOUNT:c.updateMountItems(e)}u.createItemInstances(e,function(e,t){return e?console.error(e):(w.addItems(t.map),void(b.exchangeType!==r.MOUNT&&w.refreshSlotGauge()))})}function n(e){switch(b.exchangeType){case r.STORAGE:y&&c.removeBankItems(e);break;case r.MOUNT:c.removeMountItems(e)}w.removeItems(e),b.exchangeType!==r.MOUNT&&w.refreshSlotGauge()}m.call(this,{className:"ExchangeStorageWindow",positionInfo:{left:"0.5%",bottom:"3%",width:"30%",height:"94%"}});var c,g,_,v,y=!1,b=this,w=new p({enablePresets:!1,dataHandler:null});w.registerView(this,{rightArrow:!0});var M=this.minMaxSelector=window.gui.windowsContainer.appendChild(new d);M.on("confirm",function(t){"items"===_?e(t):window.dofus.sendMessage("ExchangeObjectMoveKamaMessage",{quantity:-t})});var T=this.windowBody.appendChild(new o({className:"greenButton",text:l("tablet.exchange.withdraw")}));T.addClassNames("withdrawButton"),T.on("tap",function(){var e=w.kamasValue;if(e){var t=f.getWindow("exchangeInventory");t.closeMinMaxSelector(),h.positionNextTo(M,T),_="kamas",M.open({min:1,max:e})}}),this.on("open",function(e){this.exchangeType=e.exchangeType,c=window.gui.playerData.belongings;var t;switch(this.exchangeType){case r.TAXCOLLECTOR:t=l("ui.common.taxCollector");break;case r.STORAGE:w.setBarLabel(l("tablet.common.slots")+":"),t=l("ui.common.storage");break;case r.MOUNT:t=l("ui.common.ride");break;default:console.error("Unexpected exchangeType value:",e.exchangeType),t=l("ui.common.storage")}this.setTitle(t),this.windowBody.appendChild(T),T.setEnable(!!w.kamasValue),T.toggleDisplay(e.exchangeType!==r.MOUNT)}),this.on("close",function(){this.exchangeType=-1,M.closeMinMax(),w.unloadContent()}),this.on("kamasUpdated",function(e){T.isVisible()&&T.setEnable(!!e)}),this.on("rightArrow-tap",function(e){window.gui.openContextualMenu("storage",{toInventory:!0,viewer:w},{x:e.x,y:e.y})}),this.on("slot-doubletap",t),a(this,["exchangeInventory"]),this.on("drop",function(e,i,n){t(e,n.x,n.y,!0)}),s.on("ExchangeStartedWithStorageMessage",function(e){w.setMaxWeight(e.storageMaxSlot),y=e.exchangeType===r.STORAGE&&e.storageMaxSlot>2e9,f.openDialog(["exchangeInventory","exchangeStorage"],e)}),s.on("ExchangeStartedMountStockMessage",function(e){f.openDialog(["exchangeInventory","exchangeStorage"],{exchangeType:r.MOUNT}),c.setMountItems(e.objectsInfos),u.createItemInstances(e.objectsInfos,function(e,t){return e?console.error(e):void w.setItemList(t.map)})}),s.on("ExchangeStartedMessage",function(e){e.exchangeType===r.TAXCOLLECTOR&&f.openDialog(["exchangeInventory","exchangeStorage"],e)}),s.on("StorageInventoryContentMessage",function(e){y&&c.setBankItems(e.objects),w.setKamas(e.kamas),u.createItemInstances(e.objects,function(e,t){return e?console.error(e):(w.setItemList(t.map),void w.refreshSlotGauge())})}),s.on("StorageKamasUpdateMessage",function(e){w.setKamas(e.kamasTotal)}),s.on("ExchangeWeightMessage",function(e){w.setWeight(e.currentWeight,e.maxWeight)}),s.on("StorageObjectUpdateMessage",function(e){i([e.object])}),s.on("StorageObjectsUpdateMessage",function(e){i(e.objectList)}),s.on("StorageObjectRemoveMessage",function(e){n([e.objectUID])}),s.on("StorageObjectsRemoveMessage",function(e){n(e.objectUIDList)})}i(1087);var o=i(246),s=i(271),a=i(383).setDroppable,r=i(280),l=i(29).getText,c=i(191).inherits,u=i(509),d=i(386),h=i(250),p=i(903),m=i(233),f=i(225);c(n,m),e.exports=n,n.prototype.closeMinMaxSelector=function(){this.minMaxSelector.closeMinMax()}},function(e,t){},function(e,t,i){function n(){_.call(this,{className:"tradeItemWindow",noCloseButton:!0,fixed:!0,positionInfo:{width:w,height:M}}),this._setupEvents(),this.mode="",this.item=null,this.msg=null,this.itemDescription=null,this.settingBox=null,this.selection=null,this.tradeItemConfirm=null,this.isTradePending=!1,this.tradeTimeout=null,this.on("open",function(e){switch(this.tradeItemConfirm=null,this.isTradePending=!1,this.tradeTimeout=null,this.itemDescription||this._createDom(),this.buyHardSoftDiv.hide(),this.msg._messageType){case"ExchangeStartOkNpcShopMessage":case"ExchangeStartOkHumanVendorMessage":case"ExchangeShopStockStartedMessage":this.settingBox=this.exchangeBox,"buy-human"===e.mode&&this.buyHardSoftDiv.show(),v.arrangeOpeningWindow(this.id,{rightOf:"tradeStorage",height:M});break;case"ExchangeStartedBidSellerMessage":this.settingBox=this.bidHouseSellerBox,this.settingBox.setDescriptorData(this.msg.sellerDescriptor),v.arrangeOpeningWindow(this.id,{rightOf:"tradeStorage",height:T});break;case"ExchangeStartedBidBuyerMessage":this.settingBox=this.bidHouseBuyerBox,this.settingBox.setDescriptorData(this.msg.buyerDescriptor),this.buyHardSoftDiv.show(),v.arrangeOpeningWindow(this.id,{rightOf:"bidHouseShop",height:"100%"});break;default:return}this._setContent(e.mode,e.item,e.currency)}),this.on("close",function(){this.item=null,this.selection=null,this.isTradePending=!1,window.clearTimeout(this.tradeTimeout),this._closeTradeConfirmWindow()}),this.on("closed",function(){this.settingBox.hide()})}function o(e,t){return e?void m.getItems([e],function(i,n){return i?console.error("Failed to get token "+e+" for trade: "+i):t(n[0])}):t(null)}i(1089);var s=i(1090),a=i(1091),r=i(246),l=i(271),c=i(1093),u=i(29).getText,d=i(252),h=i(191).inherits,p=i(951),m=i(509),f=i(784),g=i(924),_=i(233),v=i(225),y=i(805),b=i(7),w=410,M=392,T=480,C=1e4;h(n,_),e.exports=n,n.minWidth=w,n.prototype._setupEvents=function(){var e=this,t=window.gui;l.on("ExchangeStartOkNpcShopMessage",function(t){e.msg=t,o(t.tokenId,function(e){e&&(t.token=e),v.openDialog(["tradeInventory","tradeStorage"],t)})}),l.on("ExchangeStartOkHumanVendorMessage",function(t){e.msg=t,v.openDialog(["wallet","tradeStorage"],t)}),l.on("ExchangeShopStockStartedMessage",function(t){e.msg=t,v.openDialog(["tradeInventory","tradeStorage","tradeMode"],t)}),l.on("ExchangeStartedBidSellerMessage",function(t){e.msg=t,v.openDialog(["tradeInventory","tradeStorage"],t)}),l.on("ExchangeStartedBidBuyerMessage",function(t){e.msg=t,v.openDialog(["wallet","bidHouseShop"],t)});var i={};i[g.REQUEST_IMPOSSIBLE]=u("ui.exchange.cantExchange"),i[g.REQUEST_CHARACTER_OCCUPIED]=u("ui.exchange.cantExchangeCharacterOccupied"),i[g.REQUEST_CHARACTER_JOB_NOT_EQUIPED]=u("ui.exchange.cantExchangeCharacterJobNotEquiped"),i[g.REQUEST_CHARACTER_TOOL_TOO_FAR]=u("ui.craft.notNearCraftTable"),i[g.REQUEST_CHARACTER_OVERLOADED]=u("ui.exchange.cantExchangeCharacterOverloaded"),i[g.REQUEST_CHARACTER_NOT_SUSCRIBER]=u("ui.exchange.cantExchangeCharacterNotSuscriber"),i[g.REQUEST_CHARACTER_RESTRICTED]=u("ui.exchange.cantExchangeCharacterRestricted"),i[g.BUY_ERROR]=u("ui.exchange.cantExchangeBuyError"),i[g.SELL_ERROR]=u("ui.exchange.cantExchangeSellError"),i[g.MOUNT_PADDOCK_ERROR]=u("ui.exchange.cantExchangeMountPaddockError"),i[g.BID_SEARCH_ERROR]=u("ui.bidhouse.itemNotInBigStore"),i[g.REQUEST_RESTRICTED_AREA]=u("ui.popup.bidhouseDenied"),l.on("ExchangeErrorMessage",function(n){var o=i[n.errorType];if(!e._concludeTrade(!1,o)){if(!o)return console.error("ExchangeErrorMessage: no error message for type",n.errorType);t.openSimplePopup(o)}}),l.on("ObjectErrorMessage",function(t){t.reason===f.INVENTORY_FULL&&e._concludeTrade(!1)}),l.on("exchangeBidHouseBuyError",function(){e._concludeTrade(!1,u("tablet.purchaseInHardCcyError"))}),l.on("exchangeHumanBuyError",function(){e._concludeTrade(!1,u("tablet.purchaseInHardCcyError"))}),l.on("exchangeBidHouseBuySuccess",function(){this.send("moneyGoultinesAmountRequest")}),l.on("exchangeHumanBuySuccess",function(){this.send("moneyGoultinesAmountRequest")}),l.on("ExchangeBidHouseBuyResultMessage",function(t){e._concludeTrade(t.bought,u("tablet.tradeItemFailed")),e._sendKpi(t)}),l.on("ExchangeBuyOkMessage",function(){e._concludeTrade(!0),v.close(e.id)}),l.on("ExchangeSellOkMessage",function(){e._concludeTrade(!0),v.close(e.id)}),l.on("ExchangeBidHouseItemAddOkMessage",function(){e._concludeTrade(!0)})},n.prototype._beginTrade=function(){this.isTradePending=!0,this.tradeTimeout=window.setTimeout(function(e){e._tradeTimedOut()},C,this)},n.prototype._concludeTrade=function(e,t){return!!this.tradeTimeout&&(this.isTradePending=!1,window.clearTimeout(this.tradeTimeout),this.tradeTimeout=null,this._closeTradeConfirmWindow(),!e&&t&&window.gui.openSimplePopup(t),!0)},n.prototype._tradeTimedOut=function(){this._concludeTrade(!1,u("tablet.tradeItemTimeout"))},n.prototype.getCurrentItem=function(){return this.selection?this.selection.item:this.item},n.prototype.updateSelection=function(e){if(e){var t=window.gui.playerData.inventory;this.buySoftBtn.setEnable(t.kamas>=e.amountSoft),this.buySoftBtnLabel.setText(d.intToString(e.amountSoft)),this.buyHardBtn.setEnable(!!e.amountHard),this.buyHardBtnLabel.setText(e.amountHard?d.intToString(e.amountHard):""),e.item!==this.itemDescription.item&&this.itemDescription.displayItem(e.item)}else{this.buySoftBtn.disable(),this.buyHardBtn.disable();var i=u("ui.common.buy");this.buySoftBtnLabel.setText(i),this.buyHardBtnLabel.setText(i),this._closeTradeConfirmWindow()}this.selection=e},n.prototype.updateHumanBuyQuantityRealtime=function(e){if(!(this.isTradePending||e>=this.selection.qty)){var t=this.selection.item;window.gui.chat.logMsg(u("tablet.tradeItemQtyChanged",t.getName(),e)),e?(t.quantity=e,this.settingBox.updateSettingBox(this,t),this._closeTradeConfirmWindow()):v.close(this.id)}},n.prototype.updateBidHouseBuyPriceRealtime=function(e,t){if(this.tradeItemConfirm&&!this.isTradePending){var i=this.isHardCcyTrade?t:e;if(i>this.initialPrice)return this._closeTradeConfirmWindow();this.currentPrice=i,this.tradeItemConfirm.updatePriceRealtime(i)}},n.prototype._confirmTrade=function(e,t){this.isHardCcyTrade=!!e.amountHard,this.initialPrice=this.currentPrice=e.amountHard||e.amountSoft,this.tradeItemConfirm=v.getWindow("tradeItemConfirm");var i=this;this.tradeItemConfirm.confirmTrade(e,function(e){e&&(i._beginTrade(),t())})},n.prototype._closeTradeConfirmWindow=function(){this.tradeItemConfirm&&(this.tradeItemConfirm=null,v.close("tradeItemConfirm"))},n.prototype._buyInGoultines=function(){var e=this,t=this.selection,i=t.item,n=t.amountHard,o=t.amountSoft,s=t.qty,a="buy-human"===this.mode,r=n-window.gui.playerData.inventory.goultines;return r>0?y.openNotEnoughHardCurrencyPopup(r):void this._confirmTrade({itemInstance:i,amountHard:n,qty:s},function(){window.dofus.send(a?"exchangeHumanBuyRequest":"exchangeBidHouseBuyRequest",{id:i.getProperty("id"),uid:i.objectUID,qty:s,amountHard:n,amountSoft:o}),a||e._prepareKpi("ExchangeBidHouseBuyResultMessage")})},n.prototype._buyInKamas=function(){var e=this.selection,t=e.item,i=e.qty,n="buy-human"===this.mode,o=this;this._confirmTrade({itemInstance:t,amountSoft:e.amountSoft,qty:i},function(){n?window.dofus.sendMessage("ExchangeBuyMessage",{objectToBuyId:t.objectUID,quantity:i}):(window.dofus.sendMessage("ExchangeBidHouseBuyMessage",{uid:t.objectUID,qty:i,price:o.currentPrice}),o._prepareKpi("ExchangeBidHouseBuyResultMessage"))})},n.prototype.buyItemFromNpc=function(e,t,i){i=i||e.item.price,this._confirmTrade({itemInstance:e,amountSoft:i*t,qty:t,token:this.msg.token},function(){window.dofus.sendMessage("ExchangeBuyMessage",{objectToBuyId:e.item.id,quantity:t})})},n.prototype.sellItemToNpc=function(e,t,i){i=i||e.item.price,this._confirmTrade({isSell:!0,itemInstance:e,amountSoft:i*t,qty:t},function(){window.dofus.sendMessage("ExchangeSellMessage",{objectToSellId:e.objectUID,quantity:t})})},n.prototype.sellItemInMyShop=function(e,t,i){window.dofus.sendMessage("ExchangeObjectMovePricedMessage",{objectUID:e.objectUID,quantity:t,price:i})},n.prototype.removeItemQuantityFromMyShop=function(e,t){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e.objectUID,quantity:-t})},n.prototype.modifyItemPriceInMyShop=function(e,t,i){window.dofus.sendMessage("ExchangeObjectModifyPricedMessage",{objectUID:e.objectUID,quantity:t,price:i})},n.prototype.sellInBidHouse=function(e,t,i,n){return t<=0?window.gui.openSimplePopup(u("ui.error.invalidPrice")):void this._confirmTrade({isSell:!0,itemInstance:e,amountSoft:t,qty:i,fee:n},function(){window.dofus.sendMessage("ExchangeObjectMovePricedMessage",{objectUID:e.objectUID,quantity:i,price:t})})},n.prototype.removeFromBidHouse=function(e,t,i){window.gui.openConfirmPopup({title:u("ui.popup.warning"),message:u("ui.bidhouse.doUWithdrawItemBigStore",i+" x "+e.item.nameId,d.kamasToString(t/i)),cb:function(n){n&&window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e.objectUID,quantity:-i,price:t})}})},n.prototype._createDom=function(){this.itemDescription=this.windowBody.appendChild(new p({showTitle:!0,withCraftBtn:!0})),v.makeMovable(this,this.itemDescription.getChildren()[0]),this.exchangeBox=this.windowBody.appendChild(new c),this.bidHouseSellerBox=this.windowBody.appendChild(new s),this.bidHouseBuyerBox=this.windowBody.appendChild(new a),this._createBuyHardSoftButtons(),this.errorBox=this.windowBody.createChild("div",{className:"errorBox"}),this.errorText=this.errorBox.createChild("div",{className:"errorText"})},n.prototype._createBuyHardSoftButtons=function(){var e=this.buyHardSoftDiv=this.windowBody.createChild("div",{className:"buyHardSoftButtons"}),t=this;this.buyHardBtn=e.appendChild(new r({className:["button","buyHardBtn"],text:u("ui.common.buy"),addIcon:!0},function(){t._buyInGoultines()})),this.buyHardBtnLabel=this.buyHardBtn.getChildren()[0],this.buySoftBtn=e.appendChild(new r({className:["greenButton","buySoftBtn"],text:u("ui.common.buy"),addIcon:!0},function(){t._buyInKamas()})),this.buySoftBtnLabel=this.buySoftBtn.getChildren()[0]},n.prototype.displayItem=function(e,t,i){this.openState?this._setContent(e,t,i):v.open(this.id,{mode:e,item:t,currency:i})},n.prototype._setContent=function(e,t,i){if(e!==this.mode||t!==this.item){this.mode=e,this.item=t;var n=t.item||t,o=n.nameId+" ("+n.id+") "+u("ui.common.short.level")+" "+n.level;this.errorBox.hide(),this.setTitle(o),this.itemDescription.displayItem(t),this.settingBox.updateSettingBox(this,t,i),this.errorBox.isVisible()||this.settingBox.show()}},n.prototype.showError=function(e){this.errorText.setHtml(e),this.errorBox.show(),this.settingBox.hide()},n.prototype._prepareKpi=function(e){if("ExchangeBidHouseBuyResultMessage"===e){if(!this.selection||!this.selection.item)return console.error("TradeItemWindow._prepareKpi: this.selection is not valid");b.wKpi.bidHouseBuyPrepare({itemInstance:this.selection.item,quantity:this.selection.qty,isHardCurrency:this.isHardCcyTrade,spent:this.isHardCcyTrade?this.selection.amountHard:this.selection.amountSoft})}},n.prototype._sendKpi=function(e){"ExchangeBidHouseBuyResultMessage"===e._messageType&&e.bought&&b.wKpi.bidHouseBuySuccess()}},function(e,t){},function(e,t,i){function n(){_.call(this,"div",{className:"BidHouseSellerBox",hidden:!0}),this.tradeItemWindow=null,this.item=null,this.mode=null,this.descriptor=null,this.quantity=0,this.price=0,this.fees=0,this.minPricesCache={},this.isDomCreated=!1}function o(e,t,i){v[e.objectGID+"x"+t]=i,y[e.objectGID]=t}function s(e,t){return v[e.objectGID+"x"+t]||0}function a(){this.bidHouseSellerBox._useMinPriceAndQuantity(this.index)}var r=i(191).inherits,l=i(388),c=i(29).getText,u=i(246),d=i(252),h=i(509),p=i(258).playUiSound,m=i(586),f=i(228),g=i(248),_=i(235),v={},y={},b=12e4,w="-";r(n,_),e.exports=n,n.prototype._onHide=function(){this.item=null,this.minPricesCache={}},n.prototype.updateSettingBox=function(e,t){var i=this;this.tradeItemWindow=e;var n=this.mode=e.mode;switch(this.item=t,this._hideAll(),n){case"modify-bidHouse":this.priceLabel.setText(d.kamasToString(t.objectPrice)),this.priceLabel.show(),this.quantityLabel.setText(d.intToString(t.quantity)),this.quantityLabel.show(),this.quantity=t.quantity,this.removeBtn.show(),this.timeLeft.setText(t.unsoldDelay+" "+c("ui.common.hourShort")),this.timeLeftBox.show();break;case"sell-bidHouse":if(this.descriptor.types.indexOf(t.item.typeId)===-1)return e.showError(c("ui.bidhouse.badType"));if(t.isLinked())return e.showError(c("ui.bidhouse.badExchange"));if(t.item.level>this.descriptor.maxItemLevel)return e.showError(c("ui.bidhouse.badLevel"));this.sellBtn.show(),this.sellBtn.disable();var o=this.descriptor.quantities;this.quantitySelect.clearContent();for(var a=1,r=0,l=o.length;r<l;r+=1){var u=o[r];t.quantity>=u&&(this.quantitySelect.addOption(u,u),a=u)}var p=y[t.objectGID],m=p?Math.min(p,a):a;this.quantitySelect.select(m),this.quantitySelect.show();var f=s(t,m);this.priceInput.setValue(f),this.price=f,this.priceInput.show(),this._updateFees()}this.quantityBox.show(),this.averagePriceBox.show(),this.priceBox.show(),this._refreshMinPrice(),this._displayAveragePrice(t.item.averagePrice),h.getFreshAveragePrice(t.objectGID,function(e){i._displayAveragePrice(e)})},n.prototype._hideAll=function(){this.quantityBox.hide(),this.averagePriceBox.hide(),this.quantitySelect.hide(),this.quantityLabel.hide(),this.priceBox.hide(),this.priceLabel.hide(),this.priceInput.hide(),this.timeLeftBox.hide(),this.saleFeeBox.hide(),this.sellBtn.hide(),this.removeBtn.hide()},n.prototype.setDescriptorData=function(e){this.descriptor=e,this.isDomCreated||(this.isDomCreated=!0,this._createDom(),this._setupEvents())},n.prototype._displayAveragePrice=function(e){e===-1?this.averagePrice.setText(c("ui.item.averageprice.unavailable")):this.averagePrice.setText(d.kamasToString(e))},n.prototype._updateFees=function(){this.fees=Math.max(1,Math.round(this.descriptor.taxPercentage*(this.price-(this.item.objectPrice||0))/100)),this.saleFee.setText(this.price>0?d.kamasToString(this.fees):"-"),this.saleFeeBox.show();var e=window.gui.playerData.inventory.kamas>=this.fees;this.saleFee.toggleClassName("red",!e),this.sellBtn.setEnable(e)},n.prototype._setupEvents=function(){var e=window.dofus.connectionManager,t=this;this.on("hide",this._onHide),window.gui.on("disconnect",function(){v={},y={}}),e.on("ExchangeBidhouseMinimumItemPriceListMessage",function(e){null!==t.item&&t._updateMinSellingPrice(e.objectGID,e.prices)})},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"settingBox"}),i=this.quantityBox=t.createChild("div",{className:["setting","quantity"]});i.createChild("div",{className:"label",text:c("ui.common.quantity")+c("ui.common.colon")}),this.quantitySelect=i.appendChild(new m),this.quantitySelect.on("change",function(t){e.quantity=t,e.price=s(e.item,t),e.priceInput.setValue(e.price),e._updateFees()}),this.quantityLabel=i.createChild("div",{className:"value"});var n=this.priceBox=t.createChild("div",{className:["setting","batchPrice"]});n.createChild("div",{className:"label",text:c("ui.bidhouse.setPrice")+c("ui.common.colon")}),this.priceLabel=n.createChild("div",{className:"value"}),this.priceInput=n.appendChild(new l({title:c("ui.bidhouse.setPrice"),attr:{placeholder:c("tablet.price.placeHolder")}})),this.priceInput.on("change",function(t){e.price=t,e._updateFees()}),t.createChild("div",{className:"minPriceLabel",text:c("tablet.sellPrice")+c("ui.common.colon")});var a=t.createChild("div",{className:"minPrice"});g.addTooltip(a,c("tablet.sellPriceTooltip")),this.minPriceValues=[];for(var r=this.descriptor.quantities,d=0;d<r.length;d++)this.minPriceValues[d]=this._createMinPriceValueBox(a,"x"+r[d],d);var h=this.averagePriceBox=t.createChild("div",{className:["setting","averagePrice"]});h.createChild("div",{className:"label",text:c("ui.bidhouse.bigStoreAveragePrice")+c("ui.common.colon")}),this.averagePrice=h.createChild("div",{className:"value"});var p=this.saleFeeBox=t.createChild("div",{className:["setting","saleFee"]});p.createChild("div",{className:"label",text:c("ui.bidhouse.bigStoreTax")+c("ui.common.colon")}),this.saleFee=p.createChild("div",{className:["value","text"]});var f=this.timeLeftBox=t.createChild("div",{className:["setting","timeLeft"]});f.createChild("div",{className:"label",text:c("ui.bidhouse.bigStoreTime")+c("ui.common.colon")}),this.timeLeft=f.createChild("div",{className:"value"});var _=this.createChild("div",{className:"buttonBox"});this.sellBtn=_.appendChild(new u({className:"greenButton",text:c("ui.common.putOnSell")},function(){return 0===e.price?e.priceInput.promptForValue():(o(e.item,e.quantity,e.price),void e.tradeItemWindow.sellInBidHouse(e.item,e.price,e.quantity,e.fees))})),this.removeBtn=_.appendChild(new u({className:"greenButton",text:c("ui.common.remove")},function(){e.tradeItemWindow.removeFromBidHouse(e.item,e.item.objectPrice,e.quantity)}))},n.prototype._createMinPriceValueBox=function(e,t,i){var n=e.createChild("div",{className:"valueBox"});return f(n),n.on("tap",a),n.bidHouseSellerBox=this,n.index=i,n.createChild("div",{className:"title",text:t}),n.createChild("div",{className:"value",text:w})},n.prototype._refreshMinPrice=function(){var e=this.item.objectGID,t=this.minPricesCache[e];!t||Date.now()-t.timestamp>b?window.dofus.sendMessage("ExchangeBidHouseListMessage",{id:e}):this._displayMinPrice()},n.prototype._displayMinPrice=function(){for(var e=this.minPricesCache[this.item.objectGID],t=this.descriptor.quantities,i=0;i<t.length;i++){var n=e&&e[i]?d.intToString(e[i]):w;this.minPriceValues[i].setText(n)}},n.prototype._useMinPriceAndQuantity=function(e){if("sell-bidHouse"!==this.mode)return p("NO_ACTION");var t=this.descriptor.quantities[e];if(t>this.item.quantity)return p("NO_ACTION");p("GEN_BUTTON"),this.quantitySelect.select(t);var i=this.minPricesCache[this.item.objectGID],n=i?i[e]:0;this.priceInput.setValue(n),this.price=n,this._updateFees(),this.priceInput.promptForValue()},n.prototype._updateMinSellingPrice=function(e,t){this.minPricesCache[e]=t,t.timestamp=Date.now(),this._displayMinPrice()}},function(e,t,i){function n(){M.call(this,"div",{className:"BidHouseBuyerBox",hidden:!0}),this.tradeItemWindow=null,this.item=null,this.currentOffer=null,this.descriptor=null,this.table=null,this.actions=[],this.mountWindow=null,this.serverAveragePrice=-1,this.displayedUnitCount=0,this.displayedUnitPrice=0,this.isDomCreated=!1}function o(e,t){return t.myTable.bidHouseBuyerBox.isItemSearchable?e.item.shortName:null}function s(e){return e.amountHard=g.computeHardPrice(e.amountSoft),e.amountHard?p.intToString(e.amountHard):null}function a(e,t){return w.addTooltip(t,l),p.intToString(e.amountSoft)}function r(e,t){var i=this.id;switch(i){case"icon":var n=e.qty-t.qty;return 0!==n?n:e.unitPrice-t.unitPrice;case"shortName":var o=e.item.shortName,s=t.item.shortName;return"string"==typeof o?o.localeCompare(s):-1;case"amountSoft":case"amountHard":var a=e.unitPrice-t.unitPrice;return 0!==a?a:e.qty-t.qty;default:return 0}}function l(){var e=this.myTable.bidHouseBuyerBox,t=this.rowContent,i=t.amountSoft/t.qty;i>=100?i=Math.round(i):i>=10&&(i=Math.round(10*i)/10);var n="",o=e._computeAveragePrice(),s=100*(i/o-1);s<=-1?(s<-99&&(s=-99),n=" -"+Math.round(-s)+"%"):s>=1&&(n=" +"+Math.round(s)+"%");var a=h("ui.bidhouse.bigStoreAveragePrice");return a=a[0].toLowerCase()+a.substr(1),h("tablet.unitPrice")+h("ui.common.colon")+p.intToString(i)+"\n("+a+n+")"}function c(e,t){v("GEN_BUTTON");var i=this.bidHouseBuyerBox;i.currentOffer=t,i.tradeItemWindow.updateSelection(t),i._showSpecialItemInfo(t.item)}function u(e){var t=this.bidHouseBuyerBox.searchedText;if(!t)return!0;var i=e.item;if(p.simplifyString(i.shortName).indexOf(t)!==-1)return!0;for(var n=i.effects,o=0;o<n.length;o++)if(p.simplifyString(n[o].description).indexOf(t)!==-1)return!0;return!1}i(1092);var d=i(924),h=i(29).getText,p=i(252),m=i(191).inherits,f=i(509),g=i(806),_=i(596),v=i(258).playUiSound,y=i(580),b=i(593),w=i(248),M=i(235),T=i(225),C=2,I=.5,A=0,S=1,E=2,x=3,L=500,N=30,O=300,D=100;m(n,M),e.exports=n,n.prototype.updateSettingBox=function(e,t){var i=this;this.tradeItemWindow=e,this.item=t,e.updateSelection(null),window.dofus.sendMessage("ExchangeBidHouseListMessage",{id:t.id}),this._setAveragePrice(t.averagePrice),f.getFreshAveragePrice(t.id,function(e){i._setAveragePrice(e)}),this.displayedUnitCount=0,this.displayedUnitPrice=0,this.pendingItemGid=null,this.expectedItems=null,window.clearTimeout(this.chunkLoadTimeout),this.searchedText="",this.searchBox.clear(),this.table.clearContent(),this.addClassNames("spinner")},n.prototype._updateOffer=function(e,t){if(this.currentOffer&&e===this.currentOffer.id){if(t>this.currentOffer.amountSoft)return this.tradeItemWindow.updateSelection(null);this.table.selectRow(e,!0),this.tradeItemWindow.updateBidHouseBuyPriceRealtime(t,g.computeHardPrice(t))}},n.prototype._removeOffer=function(e){this.currentOffer&&e===this.currentOffer.id&&this.tradeItemWindow.updateSelection(null)},n.prototype._hideMountPreview=function(){this.mountWindow&&(this.mountWindow.close(),this.mountWindow=null)},n.prototype._showSpecialItemInfo=function(e){_.getMountInfoFromCertificate(e)?(this.mountWindow=T.getWindow("mount"),this.mountWindow.showCertificateMount(e)):this._hideMountPreview()},n.prototype.setDescriptorData=function(e){function t(e){var t=new M("div",{className:"icon"});return t.setStyle("backgroundImage",e.item.getProperty("image")),t.createChild("div",{className:"quantity",text:"x"+e.qty}),t}this.descriptor=e,this.isDomCreated||(this.isDomCreated=!0,this._createDom(),this._setupEvents());var i=new M("div",{className:["currencyIcon","soft"]}),n=new M("div",{className:["currencyIcon","hard"]}),l=[{id:"icon",format:t,sort:r},{id:"shortName",header:h("ui.common.name"),format:o,sort:r},{id:"amountHard",header:n,format:s,sort:r},{id:"amountSoft",header:i,format:a,sort:r,defaultSorter:!0,order:"descending"}];this.item=null,this.expectedItems=null,this.itemCache={monstersCache:{}},this.tableBox.clearContent(),this.table=this.tableBox.appendChild(new b(l,"id")),this.table.bidHouseBuyerBox=this,this.table.on("rowTap",c),this.table.addFilter(u)},n.prototype._onHide=function(){this._hideMountPreview(),window.clearTimeout(this.chunkLoadTimeout),window.clearTimeout(this.actionTimeout),this.actionTimeout=null,this.actions=[],this.itemCache=null,this.item=null},n.prototype._setupEvents=function(){var e=this,t=window.dofus.connectionManager;this.on("hide",this._onHide),t.on("ExchangeErrorMessage",function(t){t.errorType===d.BID_SEARCH_ERROR&&e.delClassNames("spinner")}),t.on("ExchangeBidHouseInListUpdatedMessage",function(t){var i={objectUID:t.itemUID,objectGID:t.objGenericId,prices:t.prices,effects:t.effects,quantity:1};e._queueAction({type:E,GID:t.objGenericId,rawItem:i})}),t.on("ExchangeBidHouseInListAddedMessage",function(t){var i={objectUID:t.itemUID,objectGID:t.objGenericId,prices:t.prices,effects:t.effects,quantity:1};e._queueAction({type:S,GID:t.objGenericId,rawItems:[i]})}),t.on("ExchangeTypesItemsExchangerDescriptionForUserMessage",function(t){null!==e.item&&e._loadItemList(t.itemTypeDescriptions)}),t.on("ExchangeBidHouseInListRemovedMessage",function(t){e._queueAction({type:x,GID:e.pendingItemGid,UID:t.itemUID})}),g.on("computedHardPricesChange",function(){e.table&&e.table.refreshRows()})},n.prototype._loadItemList=function(e){this.pendingItemGid=this.item.id,window.clearTimeout(this.chunkLoadTimeout),this.table.clearContent(),this._queueAction({type:A,GID:this.pendingItemGid,bidExchangerObjectInfos:e})},n.prototype._queueAction=function(e){this.actions.push(e),this.actionTimeout||this._processNextAction()},n.prototype._processNextAction=function(){for(var e;;){if(!this.actions.length)return;if(e=this.actions.shift(),e.GID===this.pendingItemGid)break}switch(e.type){case A:return this._addItemListChunk(this.pendingItemGid,e.bidExchangerObjectInfos,0);case S:return this._addItems(e.rawItems,S,this._scheduleNextAction.bind(this));case x:return this._removeItem(e.UID,x),this._scheduleNextAction();case E:return this._updateItem(e.rawItem,this._scheduleNextAction.bind(this));default:console.error("Invalid action: "+e.type)}},n.prototype._scheduleNextAction=function(){!this.actionTimeout&&this.actions.length&&(this.actionTimeout=window.setTimeout(function(e){e.actionTimeout=null,e._processNextAction()},D,this))},n.prototype._addItemListChunk=function(e,t,i){if(e===this.pendingItemGid){for(var n=0===i,o=Math.min(i+(n?N:L),t.length),s=[],a=i;a<o;a++){var r=t[a];s.push({objectUID:r.objectUID,objectGID:e,prices:r.prices,effects:r.effects,quantity:1})}this._addItems(s,n?A:S,this._nextItemListChunk.bind(this,e,t,o))}},n.prototype._nextItemListChunk=function(e,t,i){e===this.pendingItemGid&&(i!==t.length?(this.rowCount.show(),this.rowCount.setText(i+" / "+t.length),this.chunkLoadTimeout=window.setTimeout(function(n){n._addItemListChunk(e,t,i)},O,this)):(this.rowCount.hide(),this.delClassNames("spinner")))},n.prototype._adaptTableToItemType=function(e){this.isItemSearchable=e&&e.getRawName()!==e.shortName,this.isItemSearchable?(this.searchDiv.toggleDisplay(!0),this.rowCount.setText("..."),this.rowCount.show(),this.table.sortByColumnId("shortName","ascending"),this.table.delClassNames("noShortName")):(this.searchDiv.toggleDisplay(!1),this.table.resetSort(),this.table.addClassNames("noShortName"))},n.prototype._removeItem=function(e,t){for(var i=this.descriptor.quantities,n=0;n<i.length;n++){var o=e+"x"+i[n];this.table.delRow(o),t===x&&this._removeOffer(o)}},n.prototype._updateItem=function(e,t){this._removeItem(e.objectUID,E),this._addItems([e],E,t)},n.prototype._addItems=function(e,t,i){this.expectedItems=e;var n=this;f.createItemInstances(e,this.itemCache,function(o,s){if(o)return console.error(o),i&&i(o);if(e===n.expectedItems){n.expectedItems=null,t===A&&n._adaptTableToItemType(s.array[0]);var a=s.map,r=[];for(var l in a)n._separateItemBulks(a[l],r);if(n.table.addList(r),t===E)for(var c=0;c<r.length;c++){var u=r[c];n._updateOffer(u.id,u.amountSoft)}return n._updatePriceHighlighting(),i&&i()}})},n.prototype._separateItemBulks=function(e,t){for(var i=this.descriptor.quantities,n=0;n<i.length;n++){var o=e.prices[n];if(o){var s=i[n];t.push({id:e.getProperty("objectUID")+"x"+s,item:e,qty:s,amountSoft:o,unitPrice:o/s,amountHard:null}),this.displayedUnitCount+=s,this.displayedUnitPrice+=o}}},n.prototype._setAveragePrice=function(e){if(this.serverAveragePrice=e,e===-1)return this.averagePriceElement.setText(h("ui.item.averageprice.unavailable"));var t=g.computeHardPrice(e);this.averagePriceElement.setText(p.hardAndSoftToString(t,e))},n.prototype._createDom=function(){var e=this;this.searchDiv=this.createChild("div",{className:"searchDiv"}),this.searchBox=this.searchDiv.appendChild(new y({label:h("ui.common.search")+h("ui.common.colon")})),this.searchBox.on("search",function(t){e._search(t)}),this.rowCount=this.searchDiv.createChild("div",{className:"rowCount"}),this.tableBox=this.createChild("div",{className:"tableBox"});var t=this.createChild("div",{className:["setting","averagePrice"]
});t.createChild("div",{className:"label",text:h("ui.bidhouse.bigStoreAveragePrice")+h("ui.common.colon")}),this.averagePriceElement=t.createChild("div",{className:"value"})},n.prototype._search=function(e){this.searchedText=p.simplifyString(e),this.addClassNames("spinner"),window.setTimeout(function(e){e.table.filter(),e.delClassNames("spinner")},0,this)},n.prototype._computeAveragePrice=function(){return this.serverAveragePrice!==-1?this.serverAveragePrice:this.displayedUnitPrice/this.displayedUnitCount},n.prototype._updatePriceHighlighting=function(){for(var e=this._computeAveragePrice(),t=this.table.rows.getChildren(),i=0;i<t.length;i++){var n=t[i],o=n.rowContent;n.toggleClassName("expensive",o.unitPrice>=e*C),n.toggleClassName("cheap",o.unitPrice<=e*I)}}},function(e,t){},function(e,t,i){function n(){u.call(this,"div",{className:"ExchangeBox",hidden:!0}),this._createDom(),this.mode=null,this.current={},this.tradeItemWindow=null,this.currency="",this.tokenItem=null}var o=i(191).inherits,s=i(388),a=i(29).getText,r=i(246),l=i(252),c=i(806),u=i(235),d=10;o(n,u),e.exports=n,n.prototype._createDom=function(){function e(){var e=t.current.quantity,i=t.current.unitPrice;t._updatePrices();var n=t.current.quantity!==e||t.current.unitPrice!==i;t.modifyButton.setEnable(n)}var t=this,i=this.createChild("div",{className:"settingBox"}),n=i.createChild("div",{className:"setting"});n.createChild("div",{className:"label",text:a("ui.common.quantity")+a("ui.common.colon")});var o=this.quantityValue=n.appendChild(new s({minValue:1,title:a("ui.common.quantity")}));o.on("focus",function(){o.maxValue=t._getMaxQuantity()}),o.on("change",e);var l=i.createChild("div",{className:"setting"});l.createChild("div",{className:"label",text:a("ui.common.unitPrice")+a("ui.common.colon")}),this.unitPriceInput=l.appendChild(new s({minValue:1,title:a("ui.common.unitPrice")})),this.unitPriceInput.on("change",e),this.unitPriceValue=l.createChild("div",{className:"value"});var c=this.totalPrice=i.createChild("div",{className:"setting"});c.createChild("div",{className:"label",text:a("ui.common.totalPrice")+a("ui.common.colon")}),this.totalPriceValue=c.createChild("div",{className:"value"});var u=this.createChild("div",{className:"buttonBox"});this.removeButton=u.appendChild(new r({text:a("ui.common.remove"),className:["greenButton","removeButton"]},function(){this.disable(),t._updatePrices();var e=t.current;t.tradeItemWindow.removeItemQuantityFromMyShop(e.item,e.quantity)})),this.modifyButton=u.appendChild(new r({text:a("ui.common.modify"),className:"greenButton"},function(){this.disable(),t._updatePrices();var e=t.current;t.tradeItemWindow.modifyItemPriceInMyShop(e.item,e.quantity,e.unitPrice)})),this.onSaleButton=u.appendChild(new r({text:a("ui.common.putOnSell"),className:"greenButton"},function(){var e=t.current;return 0===e.unitPrice?t.unitPriceInput.promptForValue():void t.tradeItemWindow.sellItemInMyShop(e.item,e.quantity,e.unitPrice)})),this.sellButton=u.appendChild(new r({text:a("ui.common.sell"),className:"greenButton"},function(){var e=t.current;t.tradeItemWindow.sellItemToNpc(e.item,e.quantity,e.unitPrice)})),this.buyButton=u.appendChild(new r({text:a("ui.common.buy"),className:"greenButton"},function(){var e=t.current;t.tradeItemWindow.buyItemFromNpc(e.item,e.quantity,e.unitPrice)}))},n.prototype._updatePrices=function(){var e="sell-myShop"===this.mode||"modify-myShop"===this.mode,t="buy-human"===this.mode,i=e?this.unitPriceInput.getValue():this.pricePerUnit,n=this.quantityValue.getValue();this.current.quantity=n,this.current.unitPrice=i;var o=n*i,s=null;if(this.totalPrice.toggleDisplay(!t),t?(s=c.computeHardPrice(o),this.totalPrice.hide(),this.tradeItemWindow.updateSelection({item:this.current.item,amountHard:s,amountSoft:o,qty:n})):(this.totalPrice.show(),this.currency?this.totalPriceValue.setText(this.currency+" x "+l.intToString(o)):this.totalPriceValue.setText(l.kamasToString(o))),this.buyButton.isVisible()){var a=window.gui.playerData.inventory,r=this.tokenItem?a.getGenericItemCount(this.tokenItem.id):a.kamas;o>r?(this.buyButton.disable(),this.totalPriceValue.addClassNames("red")):(this.buyButton.enable(),this.totalPriceValue.delClassNames("red"))}},n.prototype._getMaxQuantity=function(){var e=window.gui.playerData,t=this.current.item;return"modify-myShop"===this.mode?e.myShop.getItemSellableAmount(t.objectGID):t.quantity},n.prototype.updateSettingBox=function(e,t,i){this.tradeItemWindow=e,this.current.item=t;var n=this.mode=e.mode;this.tokenItem=e.msg.token,this.currency=i;var o=!1,s=!1;this.totalPriceValue.delClassNames("red"),this._hideButtons();var r,c=t.getProperty("quantity"),u=1;switch(n){case"modify-myShop":o=!0,this.removeButton.show(),this.removeButton.enable(),this.modifyButton.show(),this.modifyButton.disable(),r=t.getProperty("objectPrice"),u=c;break;case"sell-myShop":s=!0,o=!0,this.onSaleButton.show(),r=0,u=c;break;case"sell-npc":s=!0,this.sellButton.show();var h=t.getProperty("price");r=h>0?Math.max(1,Math.floor(h/d)):0;break;case"buy-npc":this.buyButton.show(),r=t.getProperty("objectPrice")||t.getProperty("price");break;case"buy-human":r=t.getProperty("objectPrice");break;default:console.error(new Error("Invalid exchange mode: "+n))}return s&&t.isLinked()?e.showError(a("ui.bidhouse.badExchange")):(this.pricePerUnit=r,this.quantityValue.setValue(u),this.quantityValue.setReadonly(1===c),o?this.unitPriceInput.setValue(r):this.unitPriceValue.setText(i?i+" x "+l.intToString(r):l.kamasToString(r)),this.unitPriceInput.toggleDisplay(o),this.unitPriceValue.toggleDisplay(!o),void this._updatePrices())},n.prototype._hideButtons=function(){this.removeButton.hide(),this.modifyButton.hide(),this.onSaleButton.hide(),this.sellButton.hide(),this.buyButton.hide()}},function(e,t,i){function n(){l.call(this,{title:s("ui.common.confirm"),className:"TradeItemConfirmWindow",positionInfo:{left:"c",top:"c",width:350,height:300,isModal:!0}}),this._reset(),this.on("open",this._onOpen),this.on("close",this._onClose)}i(1095);var o=i(246),s=i(29).getText,a=i(252),r=i(191).inherits,l=i(233),c=i(225),u=i(235);r(n,l),e.exports=n,n.prototype._reset=function(){this.cb=null,this.itemLabel=null,this.itemImg=null,this.itemQuantity=null,this.buyBtn=null,this.buyBtnLabel=null},n.prototype._onOpen=function(){this.itemLabel||this._createContent()},n.prototype._onClose=function(){this.cb(!1)},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._createContent=function(){var e=this.windowBody.createChild("div",{className:"itemLabelBox"}),t=this.windowBody.createChild("div",{className:"twoColumns"});this.itemLabel=e.createChild("div",{className:"itemLabel"});var i=t.createChild("div",{className:"leftCol"}),n=i.createChild("div",{className:"itemContainer"});this.itemImg=n.createChild("div",{className:"itemImg"}),this.itemQuantity=n.createChild("div",{className:"itemQuantity"});var s=t.createChild("div",{className:"rightCol"}),a=this,r=s.createChild("div",{className:"btnAndFee"});this.buyBtn=r.appendChild(new o({addIcon:!0,className:["buyBtn","greenButton"]},function(){this.disable(),a.cb(!0)}));var l=this.buyBtnIcon=this.buyBtn.getChildren()[0];this.buyBtnLabel=this.buyBtn.insertChildBefore(new u("div",{className:"btnLabel"}),l),this.buyBtnAmount=this.buyBtn.insertChildBefore(new u("div",{className:"btnAmount"}),l),this.feeAmount=r.createChild("div",{className:"feeAmount"})},n.prototype.confirmTrade=function(e,t){c.open(this.id);var i=e.itemInstance;this.itemLabel.setText(i.getName()),this.itemImg.setStyle("backgroundImage",i.getProperty("image")),this.itemQuantity.setText("x"+e.qty),this.buyBtnLabel.setText(s(e.isSell?"ui.common.sell":"ui.common.buy").toUpperCase()),this.buyBtnAmount.setText(a.intToString(e.amountHard||e.amountSoft)),this.buyBtn.toggleClassName("hardCcy",!!e.amountHard),this.buyBtn.toggleClassName("softCcy",!e.amountHard);var n=e.token?e.token.getProperty("image"):null;this.buyBtnIcon.setStyle("backgroundImage",n),this.feeAmount.setText(e.fee?s("tablet.salesFee")+s("ui.common.colon")+a.kamasToString(e.fee):""),this.cb=t},n.prototype.updatePriceRealtime=function(e){this.buyBtnAmount.setText(a.intToString(e))}},function(e,t){},function(e,t,i){function n(){r.call(this,{className:"TradeModeWindow",noCloseButton:!0,noTitle:!0});var e;this.once("open",function(){e=this.windowBody.appendChild(new u({className:"greenButton",text:c("ui.humanVendor.switchToMerchantMode")})),e.on("tap",function(){window.dofus.sendMessage("ExchangeShowVendorTaxMessage")})}),this.on("open",function(e){switch(e._messageType){case"ExchangeShopStockStartedMessage":var t=a.minWidth-h,i=o.minWidth+h/2;l.positionWindow(this.id,{left:i,bottom:"5%",width:t,height:70});break;default:throw new Error("Invalid open msg: "+e._messageType)}}),window.gui.on("ExchangeReplyTaxVendorMessage",function(e){return window.gui.openConfirmPopup({title:c("ui.humanVendor.poupTitleTaxMessage"),message:c("ui.humanVendor.taxPriceMessage",d.kamasToString(e.totalTaxValue)),cb:function(e){e&&(l.close("tradeStorage"),window.dofus.sendMessage("ExchangeStartAsVendorMessage"),window.gui.connectionGonnaBeClosed("SWITCHING_TO_HUMAN_VENDOR"))}})})}i(1097);var o=i(496),s=i(191).inherits,a=i(1088),r=i(233),l=i(225),c=i(29).getText,u=i(246),d=i(252),h=20;s(n,r),e.exports=n},function(e,t){},function(e,t,i){function n(e){function t(e){return f.types.indexOf(e.item.typeId)!==-1&&(!e.isLinked()&&!(e.item.level>f.maxItemLevel))}function i(i){i!==g&&(g=i,i?e.addFilters([t]):e.removeFilter(t),e.filterList())}function n(e){m.mode&&u.getWindow("tradeItem").displayItem(m.mode,e.itemInstance)}function r(e){m._selectItem(e)}c.call(this,{title:d("ui.common.inventory"),className:"TradeInventoryWindow"});var m=this;this.mode=null,this.openOnItem=null,this.storageView=e,e.registerView(this,{tapSelectedEmitsDoubleTap:!0,contextParams:{enableDestroy:!0}});var f,g=!1,_=new s(d("ui.bidhouse.bigStoreFilter"));_.on("change",function(e){i(e)}),this.on("open",function(t){var n=this.mode=h[t._messageType],s=a.windowFullScreenWidth-o.minWidth-l.minWidth;s=Math.max(s,p),u.positionWindow(this.id,{right:0,top:0,width:s,height:"100%"}),"sell-bidHouse"===n&&(e.storageUI.appendChild(_),f=t.sellerDescriptor||t.buyerDescriptor,i(!0),_.activate(!0),this.openOnItem&&this.navigateToItem(this.openOnItem)),t.token&&e.showTokens(t.token.type.category)}),this.on("closed",function(){"sell-bidHouse"===this.mode&&(e.storageUI.removeChild(_),i(!1))}),this.on("slot-tap",n),this.on("slot-doubletap",n),this.on("itemAdded",r),this.on("itemQuantity",r),this.on("itemRemoved",function(e){var t=u.getWindow("tradeItem"),i=t.getCurrentItem();i&&e===i.getProperty("objectUID")&&u.close("tradeItem")})}i(1099);var o=i(496),s=i(676),a=i(183).dimensions,r=i(191).inherits,l=i(1088),c=i(233),u=i(225),d=i(29).getText,h={ExchangeStartOkNpcShopMessage:"sell-npc",ExchangeShopStockStartedMessage:"sell-myShop",ExchangeStartedBidSellerMessage:"sell-bidHouse"},p=198;r(n,c),e.exports=n,n.prototype.isMyShopOpen=function(){return this.openState&&"sell-myShop"===this.mode},n.prototype.navigateToItem=function(e){this.openOnItem=null;var t,i;return"number"==typeof e?t=e:(t=e.getProperty("id"),i=e.getItemInstance()),!(!i||!this._selectItem(i,!0))||!!(i=this.storageView.selectAndShowSlotByGID(t))&&(this._selectItem(i,!0),!0)},n.prototype._selectItem=function(e,t){return!(!this.mode||"sell-myShop"===this.mode)&&(!!this.storageView.selectAndShowSlotByUID(e.objectUID)&&(t&&u.getWindow("tradeStorage").setFilter(e.getProperty("typeId")),u.getWindow("tradeItem").displayItem(this.mode,e),u.focusWindow("tradeItem"),u.focusWindow("tradeInventory"),!0))}},function(e,t){},function(e,t,i){function n(){h.call(this,{className:"TradeStorageWindow",positionInfo:g}),this.openOnItem=null,this.mode=null,this.currentItem=null,this.on("open",this._onOpen),this.on("closed",this._onClose)}i(1101);var o=i(496),s=i(246),a=i(29).getText,r=i(252),l=i(191).inherits,c=i(509),u=i(576),d=i(248),h=i(233),p=i(225),m=i(235),f={ExchangeStartOkNpcShopMessage:"buy-npc",ExchangeShopStockStartedMessage:"modify-myShop",ExchangeStartedBidSellerMessage:"modify-bidHouse",ExchangeStartOkHumanVendorMessage:"buy-human"},g={left:0,top:0,width:300,height:"100%",mustAvoidToolbar:!0};l(n,h),e.exports=n,n.prototype.navigateToItem=function(e){this.openOnItem=null;var t,i;"number"==typeof e?t=e:(t=e.getProperty("id"),i=e.getItemInstance());var n=p.getWindow("tradeInventory");if(n.navigateToItem(e))return!0;if(i&&this._selectItemByUID(i.objectUID,!0))return!0;var o=this.shopViewer.findItemByGID(t);return!(!o||!this._selectItemByUID(o,!0))},n.prototype._onOpen=function(e){if(this.mode=f[e._messageType],!this.mode)return console.error(new Error("Unexpected msg type for TradeStorageWindow: "+e._messageType));this.shopViewer||(this._createContent(),this._setupEventListeners());var t=this,i=!1,n=!1;switch(this.mode){case"buy-npc":this.setTitle(a("ui.common.shop")),this.shopViewer.table.setSlideEnable(!1);break;case"modify-myShop":this.setTitle(a("ui.common.shop")),this.shopViewer.table.setSlideEnable(!0),this._slideBack.modify.show(),this._slideBack.remove.hide();break;case"modify-bidHouse":this.setTitle(a("ui.common.shopStock"));var o=this.descriptor=e.sellerDescriptor;this.npcId=o.npcContextualId,i=!0,this.infoContent.setHtml(this._getBidHouseInfoHtml(o)),this._totalItemsPrice=0,this._itemCount=e.objectsInfos.length,this._updatePlayerInformation(),this.switchToBuyModeBtn.enable(),this.shopViewer.table.setSlideEnable(!0),this._slideBack.modify.hide(),this._slideBack.remove.show();break;case"buy-human":n=!0,window.actorManager.getActorData(e.sellerId,function(e,i){return e?(console.error(e),t.setTitle("")):void t.setTitle(i.name)}),this.shopViewer.table.setSlideEnable(!1)}n?p.arrangeOpeningWindowVertically(this.id,{below:"wallet",fullHeight:!0}):p.positionWindow(this.id,g),this.headerRow.toggleDisplay(i),this.shopViewer.table.setContentLoading(!0),this.lastOpenMode!==this.mode&&(this.lasOpenMode&&this.delClassNames(this.lasOpenMode),this.addClassNames(this.mode)),this.lasOpenMode=this.mode,c.createItemInstances(e.objectsInfos,function(i,n){return t.shopViewer.table.setContentLoading(!1),i?console.error(i):(t.currency=e.tokenId,t.token=e.token||null,t.shopViewer.setItemList(n.array,"modify-bidHouse"===t.mode),void(t.openOnItem&&t.navigateToItem(t.openOnItem)))})},n.prototype._onClose=function(){this.currentItem=null,this.shopViewer.clearContent(),p.close("tradeItem")},n.prototype._createContent=function(){this._createHeader(),this._createViewer()},n.prototype._createHeader=function(){var e=this.headerRow=this.windowBody.createChild("div",{className:"headerRow"});this._playerInfoElt=e.createChild("div",{className:"playerInfoElt"}),this._itemCountElt=this._playerInfoElt.createChild("div",{className:"itemCountElt"}),this._totalItemsPriceElt=this._playerInfoElt.createChild("div",{className:"totalItemsPriceElt"}),this._playerInfoTooltop=new m("div"),this._itemCountTooltip=this._playerInfoTooltop.createChild("div",{className:"itemCount"}),this._totalItemsPriceTooltip=this._playerInfoTooltop.createChild("div",{className:"totalItemsPrice"}),d.addTooltip(this._playerInfoElt,this._playerInfoTooltop),this._createInfoButton(),this._createSwitchToBuyModeButton()},n.prototype._updatePlayerInformation=function(){this._itemCountElt.setText(this._itemCount+"/"+this.descriptor.maxItemPerAccount),this._itemCountTooltip.setText(a("ui.bidhouse.quantityObjectSold",this._itemCount,this.descriptor.maxItemPerAccount)),this._totalItemsPriceElt.setText(r.intToString(this._totalItemsPrice)+" K"),this._totalItemsPriceTooltip.setText(a("ui.bidhouse.quantityKamas",r.intToString(this._totalItemsPrice)))},n.prototype._getBidHouseInfoHtml=function(e){var t=a("ui.common.colon"),i="";return e.maxItemLevel<1e3&&(i+=a("ui.common.maxLevel")+t+e.maxItemLevel+"<br/>"),i+a("ui.bidhouse.bigStoreTax")+t+e.taxPercentage+"%<br/>"+a("ui.bidhouse.bigStoreMaxSellTime")+t+e.unsoldDelay+" "+a("ui.time.hours",e.unsoldDelay)},n.prototype._createInfoButton=function(){var e=this.infoContent=new m("div"),t=this.headerRow.createChild("div",{className:"infoButton"});d.addTooltip(t,e,{openOnTap:!0})},n.prototype._createSwitchToBuyModeButton=function(){var e=this;this.switchToBuyModeBtn=this.headerRow.appendChild(new s({addIcon:!0,className:["buyModeBtn","greenButton"],tooltip:a("ui.bidhouse.bigStoreModeBuy")},function(){o.switchBuySellMode(!1,e.npcId),this.disable()}))},n.prototype._createViewer=function(){function e(e,t){return e.objectPrice-t.objectPrice}function t(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e.objectUID,quantity:-e.quantity})}var i=this,n=[{id:"icon",format:function(e){var t=new m("div",{className:"slot"}),i=t.createChild("div",{className:"icon"});return i.setStyle("backgroundImage",e.getProperty("image")),i.createChild("div",{className:"quantity",text:e.quantity>1?e.quantity:""}),t}},{id:"name",header:a("ui.common.name"),getContent:function(e){return e.item.nameId},sort:!0},{id:"price",header:a("ui.common.price"),format:function(e){var t;if(i.currency){t=new m("div",{className:"token"});var n=t.createChild("div",{className:"icon"});n.setStyle("backgroundImage",i.token.image),t.createChild("div",{className:"quantity",text:"x"+e.objectPrice})}else t=r.kamasToString(e.objectPrice);return t},sort:e,defaultSorter:!0}],o=this._slideBack=new m("div",{className:"slideBack"});o.modify=o.createChild("div",{className:"modify",text:a("ui.common.modify")}),o.remove=o.createChild("div",{className:"remove",text:a("ui.common.remove")}),o.createChild("div",{className:["remove","right"],text:a("ui.common.remove")}),this.shopViewer=this.windowBody.appendChild(new u(n,function(e){return e.hasOwnProperty("objectUID")?e.objectUID:e.hasOwnProperty("objectGID")?e.objectGID:0},{tableOption:{slidable:o}})),this.shopViewer.on("itemSelected",function(e){i._showCurrentItem(e)}),this.shopViewer.on("rowSlidedRight",function(e,i){t(i)}),this.shopViewer.on("rowSlidedLeft",function(e,n){"modify-myShop"===i.mode?(i._showCurrentItem(n),e.slideBack()):t(n)}),this.shopViewer.on("totalPriceUpdated",function(e){i._totalItemsPrice=e,i._updatePlayerInformation()})},n.prototype._showCurrentItem=function(e){this.currentItem=e,p.getWindow("tradeItem").displayItem(this.mode,e,this.token&&this.token.nameId)},n.prototype._selectItemByUID=function(e,t){var i=this.shopViewer.getItem(e);return!!i&&(t&&this.setFilter(i.getProperty("typeId")),this.shopViewer.selectItem(e),this._showCurrentItem(i),!0)},n.prototype.setFilter=function(e){return this.shopViewer.selectFilter(e)},n.prototype._updateHumanBuyQuantity=function(e){var t=p.getWindow("tradeItem");t.updateHumanBuyQuantityRealtime(e),e||(this.currentItem=null)},n.prototype._setupEventListeners=function(){function e(e,t){if("buy-human"===n.mode&&n.currentItem)for(var i=n.currentItem.objectUID,o=0;o<e.length;o++)if(e[o].objectUID===i){n._updateHumanBuyQuantity(e[o].quantity);break}c.createItemInstances(e,function(e,i){return e?console.error(e):void(t?n.shopViewer.addItemsAndHighlightThem(i.array,"modify-bidHouse"===n.mode):n.shopViewer.addItems(i.array,"modify-bidHouse"===n.mode))})}function t(e){n.currentItem&&e.indexOf(n.currentItem.objectUID)>=0&&("buy-human"===n.mode?n._updateHumanBuyQuantity(0):"modify-bidHouse"!==n.mode&&"modify-myShop"!==n.mode||p.close("tradeItem"));for(var t=0;t<e.length;t++)n.shopViewer.table.endSlide(e[t]);n.shopViewer.removeItems(e,"modify-bidHouse"===n.mode)}var i=window.dofus.connectionManager,n=this;i.on("ExchangeShopStockMultiMovementUpdatedMessage",function(t){e(t.objectInfoList)}),i.on("ExchangeShopStockMovementUpdatedMessage",function(t){var i="modify-myShop"===n.mode;e([t.objectInfo],i)}),i.on("ExchangeShopStockMultiMovementRemovedMessage",function(e){t(e.objectIdList)}),i.on("ExchangeShopStockMovementRemovedMessage",function(e){t([e.objectId])}),i.on("ExchangeBidHouseItemAddOkMessage",function(t){e([t.itemInfo],!1),n._itemCount++,n._updatePlayerInformation()}),i.on("ExchangeBidHouseItemRemoveOkMessage",function(e){t([e.sellerId]),n._itemCount--,n._updatePlayerInformation()})}},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"WalletWindow",positionInfo:{left:0,top:0,width:r,height:l},noCloseButton:!0,noTitle:!0}),this.wallet=null,this.on("open",this._onOpen)}i(1103);var o=i(191).inherits,s=i(1104),a=i(233),r=300,l=62;o(n,a),e.exports=n,n.height=l,n.width=r,n.prototype._onOpen=function(){this.wallet||(this.wallet=this.windowBody.appendChild(new s({className:"small"})))}},function(e,t){},function(e,t,i){function n(e){e=e||{},c.call(this,"div",e),this.addClassNames("wallet"),this._isFakingGoultine=!1,this.goultineAmount=0,this.kamaAmount=0,this.emitTap=e.emitTap,this._createContent(),this._initialize()}function o(){var e=this.myWallet;return e.emitTap?e.emit("moreGoultinesTap"):void l.open("market",{tabId:"shop",tabParams:{category:"goultines"}})}i(1105);var s=i(246),a=i(252),r=i(191).inherits,l=i(225),c=i(235);r(n,c),e.exports=n,n.prototype._initialize=function(){this._setupListeners();var e=window.gui.playerData.inventory;this._setSoftAmount(e.kamas),this._setHardAmount(e.goultines)},n.prototype._setHardAmount=function(e){this.goultineAmount=e,this._isFakingGoultine||this.hardAmountElt.setText(a.intToString(e))},n.prototype._setSoftAmount=function(e){this.kamaAmount=e,this.softAmountElt.setText(a.intToString(e))},n.prototype._createContent=function(){var e=this.createChild("div",{className:["currency","goultines"]});this.hardAmountElt=e.createChild("div",{className:"text"}),e.createChild("div",{className:"currencyIcon"}),this.goultinesBtn=e.appendChild(new s({className:"moreButton"},o)),this.goultinesBtn.myWallet=this;var t=this.createChild("div",{className:["currency","kamas"]});this.softAmountElt=t.createChild("div",{className:"text"}),t.createChild("div",{className:"currencyIcon"})},n.prototype._setupListeners=function(){function e(e){n._setHardAmount(e)}function t(e){n._setSoftAmount(e)}var i=window.gui.playerData.inventory,n=this;i.on("goultinesUpdated",e),i.on("kamasUpdated",t),this.on("destroy",function(){i.removeListener("goultinesUpdated",e),i.removeListener("kamasUpdated",t)})},n.prototype.setFakeHardAmount=function(e){this._isFakingGoultine=!0,this.hardAmountElt.setText(a.intToString(e))},n.prototype.resetFakeHardAmount=function(){this._isFakingGoultine=!1,this.hardAmountElt.setText(a.intToString(this.goultineAmount))}},function(e,t){},function(e,t,i){function n(){u.call(this,{className:["WorldMapWindow","withoutLeftColumn"],plusButton:!0,minusButton:!0,positionInfo:{width:"w",height:"h",isDefault:!0},title:d("ui.cartography.title")}),this.status={isWorldMapRefreshing:!1,isLoading:!1,openAtInfo:{},lastWindowInfo:{x:null,y:null,w:null,h:null}},this._worldMap=null;var e={hidden:!0,className:"tree"};this._conquestUIList=new y(e),this._conquestPresenter=new g(new v,this._conquestUIList),this._taxCollectors=new w,this._poiUpdater=null,this._optionButtonsLoaded=!1,this._buttonBox=null,this._optionButtons=null,this._maxContentSize=null,this.minusButton.hide(),this.plusButton.hide(),this._isOpened=!1,this.once("open",function(e){this._addSpinner();var t={x:p.mapLeft,y:p.mapTop,width:Math.round(p.mapWidth/2),height:Math.round(p.mapHeight/2)};m.positionWindow(this.id,t),this.status.lastWindowInfo.x=this.position.x,this.status.lastWindowInfo.y=this.position.y,this.status.lastWindowInfo.w=this.position.width,this.status.lastWindowInfo.h=this.position.height;var i=this;this._createWorldMap(function(t){return t?(i._removeSpinner(),console.error(t)):(i._createDom(),i._setEvents(),i._poiUpdater=new c(i._worldMap),i.on("open",i._onOpen),void i._onOpen(e))})}),this.on("close",this._onClose),window.gui.on("disconnect",this._onDisconnect.bind(this)),this._isConquestListDisplayed=!1,this._isMaximized=!1}function o(e,t){var i=T+e;return b.getValue(i,t)}function s(e,t){var i=T+e;b.setValue(i,t)}i(1107);var a=i(248).addTooltip,r=i(191).inherits,l=i(1108),c=i(1123),u=i(233),d=i(29).getText,h=i(246),p=i(183).dimensions,m=i(225),f=i(705),g=i(1124),_=i(580),v=i(1127),y=i(1013),b=i(195),w=i(1128),M=216,T="mapButtons-",C=[0,1,0,.25],I=[0,.2,1,.25],A={temples:1,markets:2,workshops:3,miscellaneous:4,dungeons:6,possessions:7,lairs:9};r(n,u),e.exports=n,n.prototype._onDisconnect=function(){this._conquestPresenter.clear(),this._worldMap&&this._worldMap.clear(),this._optionButtonsLoaded&&this._resetOptionsButtons()},n.prototype._onClose=function(){this.status.isWorldMapRefreshing&&this._worldMap.stopRefreshing(),this._buttonBox&&this._buttonBox.addClassNames("hidden"),this._searchBox.setValue(""),this._conquestPresenter.search(""),this._isOpened=!1},n.prototype._centerAndHighlight=function(){var e=this.status.openAtInfo;if(e.subareaConquest)this._conquestPresenter.selectSubarea(e.subareaConquest);else if(e.subarea)this._worldMap.clearSubAreaHighlights(),this._worldMap.addSubAreaHighlight(e.subarea,C),this._worldMap.centerOnSubArea(e.subarea);else if(e.subareas){var t=e.subareas;if(t.length>=1){this._worldMap.clearSubAreaHighlights();for(var i=0;i<t.length;i++){var n=t[i]===e.favorite?I:C;this._worldMap.addSubAreaHighlight(t[i],n)}var o;switch(e.centerOn){case"favorite":o=e.favorite;break;case"nearest":o=this._worldMap.getNearestSubarea(t);break;default:o=t[0]}this._worldMap.centerOnSubArea(o)}}else this._worldMap.centerToPosition(e.coords)},n.prototype._onOpen=function(e){var t=this,i=window.gui;e=e||{},this._cropWorldMapToWindow();var n={posX:i.playerData.position.coordinates.posX,posY:i.playerData.position.coordinates.posY};return void 0!==e.subarea?this.status.openAtInfo={subarea:e.subarea}:void 0!==e.subareas?this.status.openAtInfo={subareas:e.subareas,favorite:e.favorite,centerOn:e.centerOn}:void 0!==e.subareaConquest?this.status.openAtInfo={subareaConquest:e.subarea}:(void 0!==e.x&&void 0!==e.y&&(n.posX=e.x,n.posY=e.y),this.status.openAtInfo={coords:n}),this._isOpened&&i.playerData.position.worldmapId===this._worldMap.getDisplayedWorldmapId()?this._centerAndHighlight():void(this.status.isLoading||(this.status.isLoading=!0,this._addSpinner(),this._worldMap.initialize(n,function(){if(t.status.isWorldMapRefreshing=!0,t._removeSpinner(),t.status.isLoading=!1,t._isOpened=!0,!t.openState)return t._onClose();t._centerAndHighlight();var e=i.playerData.position.coordinates;t._worldMap.setIconPosition("userPosition",e.posX,e.posY),t._poiUpdater.updatePois(),t._conquestPresenter.setWorldMap(t._worldMap),t._taxCollectors.setWorldMap(t._worldMap),t._optionButtonsLoaded?t._refreshOptionsButtonsSelections():(t._createOptionsButtons(),t._createConquestButton()),1===t._worldMap.getDisplayedWorldmapId()?t.conquestButton.show():t.conquestButton.hide()})))},n.prototype._addSpinner=function(){this.windowBodyWrapper.addClassNames("spinner")},n.prototype._removeSpinner=function(){this.windowBodyWrapper.delClassNames("spinner")},n.prototype._getMaxContentSize=function(){if(!this._maxContentSize){var e=this._getCurrentInnerBoundaries();this._maxContentSize={width:p.windowFullScreenWidth-(this.position.width-e.width),height:p.windowFullScreenHeight-(this.position.height-e.height)}}return this._maxContentSize},n.prototype._getCurrentInnerBoundaries=function(){var e=this.rightColumn.getComputedStyles("width","height");return{width:parseInt(e.width,10),height:parseInt(e.height,10)}},n.prototype._cropWorldMapToWindow=function(){var e=this._getMaxContentSize(),t=this._getCurrentInnerBoundaries();this._worldMap.crop((e.width-t.width)/2,(e.height-t.height)/2,t.width,t.height)},n.prototype._exitFullScreen=function(){this.setStyles({width:this.status.lastWindowInfo.w+"px",height:this.status.lastWindowInfo.h+"px",webkitTransform:"translate3d("+this.status.lastWindowInfo.x+"px,"+this.status.lastWindowInfo.y+"px,0)"}),this.position.x=this.status.lastWindowInfo.x,this.position.y=this.status.lastWindowInfo.y,this.position.width=this.status.lastWindowInfo.w,this.position.height=this.status.lastWindowInfo.h,this.emit("resize",!1)},n.prototype._setEvents=function(){var e=this,t=window.gui;t.playerData.position.on("mapUpdate",function(){if(e.openState){if(e._worldMap.isLoading()){var t=this.coordinates.posX,i=this.coordinates.posY;e._worldMap.once("loaded",function(){e._worldMap.setIconPosition("userPosition",t,i),e._worldMap.centerToMyPosition()})}else e._worldMap.setIconPosition("userPosition",this.coordinates.posX,this.coordinates.posY),e._worldMap.centerToMyPosition();e.status.isLoading&&(e.status.openAtInfo={coords:this.coordinates})}}),this.on("repositioned",function(){e.emit("resize",!0)}),this.on("positioned",function(){e.status.lastWindowInfo.x=e.position.x,e.status.lastWindowInfo.y=e.position.y,e._updateMySize()}),t.playerData.position.on("worldMapUpdate",function(){e._onOpen(),e._poiUpdater.updatePois()})},n.prototype._createWorldMap=function(e){var t=this;this.leftColumn=this.createChild("div",{className:"leftColumn"}),this.rightColumn=this.createChild("div",{className:"rightColumn"}),this.searchBlock=this.leftColumn.createChild("div",{className:"searchBlock"}),this._searchBox=this.searchBlock.appendChild(new _),this._searchBox.on("search",function(e){t._conquestPresenter.search(e)}),this._worldMap=new l,this._leftColumScroll=this.leftColumn.createChild("div",{className:"scroll"}),this._leftColumScroll.appendChild(this._conquestUIList),this.rightColumn.appendChild(this._worldMap),this.windowBody.appendChild(this.leftColumn),this.windowBody.appendChild(this.rightColumn),this._worldMap.setupUI(this);var i=this._getMaxContentSize();this._worldMap.setDimensions(i.width,i.height),this._cropWorldMapToWindow(),this._worldMap.addClassNames("centerMap"),this._worldMap.preloadGenericAssets(e)},n.prototype._createOptionsButtons=function(){var e=this;this._optionButtons={},this._buttonBox=this.windowBody.createChild("div",{className:["buttonBox","hidden"]});var t=o("grid",!1);this._worldMap.setGridVisibility(t),this._buttonBox.appendChild(this._createToggleButton("grid",t,d("ui.option.displayGrid"),function(){e._worldMap.setGridVisibility(this.selected),s("grid",this.selected)}));var i=o("landmarks",!0);this._worldMap.setVisibilityOfIconType("customFlag",i),this._worldMap.setVisibilityOfIconType("userPosition",i),this._worldMap.setVisibilityOfIconType("questObjective",i),this._worldMap.setVisibilityOfIconType("hint",i),this._buttonBox.appendChild(this._createToggleButton("landmarks",i,d("ui.cartography.flags"),function(){e._worldMap.setVisibilityOfIconType("customFlag",this.selected),e._worldMap.setVisibilityOfIconType("userPosition",this.selected),e._worldMap.setVisibilityOfIconType("questObjective",this.selected),e._worldMap.setVisibilityOfIconType("hint",this.selected),s("landmarks",this.selected)}));var n=o(A.possessions,!0);this._worldMap.setVisibilityOfIconType(A.possessions,n),this._buttonBox.appendChild(this._createToggleButton("possessions",n,d("ui.common.possessions"),function(){e._setIconsVisibleAndSaveUserPref(A.possessions,this.selected)}));var r=o(A.temples,!0);this._worldMap.setVisibilityOfIconType(A.temples,r),this._buttonBox.appendChild(this._createToggleButton("temples",r,d("ui.map.temple"),function(){e._setIconsVisibleAndSaveUserPref(A.temples,this.selected)}));var l=o(A.markets,!0);this._worldMap.setVisibilityOfIconType(A.markets,l),this._buttonBox.appendChild(this._createToggleButton("markets",l,d("ui.map.bidHouse"),function(){e._setIconsVisibleAndSaveUserPref(A.markets,this.selected)}));var c=o(A.workshops,!0);this._worldMap.setVisibilityOfIconType(A.workshops,c),this._buttonBox.appendChild(this._createToggleButton("workshops",c,d("ui.map.craftHouse"),function(){e._setIconsVisibleAndSaveUserPref(A.workshops,this.selected)}));var u=o(A.miscellaneous,!0);this._worldMap.setVisibilityOfIconType(A.miscellaneous,u),this._buttonBox.appendChild(this._createToggleButton("miscellaneous",u,d("ui.common.misc"),function(){e._setIconsVisibleAndSaveUserPref(A.miscellaneous,this.selected)}));var p=o("prisms",!0);this._worldMap.setVisibilityOfIconType("prisms",p),this._buttonBox.appendChild(this._createToggleButton("conquests",p,d("ui.map.conquest"),function(){
e._setIconsVisibleAndSaveUserPref("prisms",this.selected)}));var m=o(A.dungeons,!0);this._worldMap.setVisibilityOfIconType(A.dungeons,m),this._buttonBox.appendChild(this._createToggleButton("dungeons",m,d("ui.map.dungeon"),function(){e._setIconsVisibleAndSaveUserPref(A.dungeons,this.selected)}));var f=o(A.lairs,!0);this._worldMap.setVisibilityOfIconType(A.lairs,f),this._buttonBox.appendChild(this._createToggleButton("lairs",f,d("tablet.ui.map.lair"),function(){e._setIconsVisibleAndSaveUserPref(A.lairs,this.selected)})),this.optionButton=new h({className:"optionButton",scaleOnPress:!0},function(){e._buttonBox.toggleClassName("hidden")}),this.optionButton.insertBefore(this.windowTitle),this.centerButton=new h({className:"centerButton",scaleOnPress:!0},function(){e._worldMap.centerToMyPosition()}),a(this.centerButton,d("ui.map.player")),this.centerButton.insertBefore(this.windowTitle),e._optionButtonsLoaded=!0},n.prototype._createToggleButton=function(e,t,i,n){var o=new h({className:["mapBtn",e]},function(){o.selected=!o.selected,o.toggleClassName("selected",this.selected),n.call(this)});return t?(o.selected=!0,o.addClassNames("selected")):o.selected=!1,o.defaultSelected=t,this._optionButtons[e]=o,a(o,i),o},n.prototype._createConquestButton=function(){var e=this;this.conquestButton=new h({className:"conquestButton",text:d("ui.common.conquest")},function(){e._isConquestListDisplayed?(e._conquestPresenter.hideConquestList(),e._isConquestListDisplayed=!1,e.toggleClassName("withoutLeftColumn",!0)):(e._conquestPresenter.showConquestList(),e._isConquestListDisplayed=!0,e.toggleClassName("withoutLeftColumn",!1)),e.emit("resize",e._isMaximized)}),this.conquestButton.insertBefore(e.optionButton)},n.prototype._setIconsVisibleAndSaveUserPref=function(e,t){s(e,t),this._worldMap.setVisibilityOfIconType(e,t)},n.prototype._setIconsVisibleFromUserPref=function(e,t){var i=o(e,t);this._worldMap.setVisibilityOfIconType(e,i)},n.prototype._refreshOptionsButtonsSelections=function(){this._setIconsVisibleFromUserPref("grid",!1);var e=o("landmarks",!0);this._worldMap.setVisibilityOfIconType("customFlag",e),this._worldMap.setVisibilityOfIconType("userPosition",e),this._worldMap.setVisibilityOfIconType("questObjective",e),this._worldMap.setVisibilityOfIconType("hint",e),this._setIconsVisibleFromUserPref(A.possessions,!0),this._setIconsVisibleFromUserPref(A.temples,!0),this._setIconsVisibleFromUserPref(A.markets,!0),this._setIconsVisibleFromUserPref(A.workshops,!0),this._setIconsVisibleFromUserPref(A.miscellaneous,!0),this._setIconsVisibleFromUserPref("prisms",!0),this._setIconsVisibleFromUserPref(A.dungeons,!0),this._setIconsVisibleFromUserPref(A.lairs,!0)},n.prototype._createDom=function(){var e=this;f(this,{minWidth:M,minHeight:M}),this.on("resizeStart",function(){var t=e._getMaxContentSize();e._worldMap.crop(0,0,t.width,t.height)}),this.on("resize",function(t){e._cropWorldMapToWindow(),e._updateMySize(t)}),this.plusButton.on("tap",function(){m.positionWindow("worldMap")}),this.plusButton.show(),this.minusButton.on("tap",function(){e._exitFullScreen()})},n.prototype._updateMySize=function(e){if(this.plusButton.toggleDisplay(!e),this.minusButton.toggleDisplay(!!e),this._isMaximized=e,!e){var t=parseInt(this.getStyle("width"),10),i=parseInt(this.getStyle("height"),10);t>.9*p.windowFullScreenWidth&&i>.9*p.windowFullScreenHeight||(this.status.lastWindowInfo.w=t,this.status.lastWindowInfo.h=i)}},n.prototype._resetOptionsButtons=function(){for(var e in this._optionButtons){var t=this._optionButtons[e];t.selected=t.defaultSelected,t.toggleClassName("selected",t.selected)}},n.prototype.isMaximized=function(){return this._isMaximized}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"WorldMap"}),this.canvas=this.createChild("canvas",{className:["WorldMap","canvas"]}).rootElement,this._scene=new r({canvas:this.canvas,name:"worldMapScene",l:0,t:0,w:1,h:1,pixelRatio:l.PIXEL_RATIO,textureRatio:l.PRERENDER_RATIO_WORLDMAP,nbCacheableSprites:l.MAX_SPRITES_BUFFER_WORLDMAP,textureMemoryCacheSize:l.MAX_TEXTURE_MEMORY_WORLDMAP,prerenderQualityRatio:l.PRERENDER_RATIO_WORLDMAP}),this._nZonesHorizontally=0,this._nZonesVertically=0,this._worldMapWidth=1,this._worldMapHeight=1,this.cropPosition={x:0,y:0,width:1,height:1},this._topLeftZoneCoordinate=null,this._worldMapId=0,this._worldMapData=null,this._isLoadingWorldMapData=!1,this._zoomLevels=[],this._chunkSprites={},this._chunkBatchIndexes={},this._chunkBatchCurrent=0,this._fullMapSprite=null,this._subAreaSprites={},this._subAreaData={},this._subAreaIdPerCoordinate={},this._gridSprite=null,this._zoneHighlight=null,this.dimensions={width:0,height:0},this._iconsInfo={},this._iconsImage=null,this._iconBatchData=new A(this)}i(1109);var o=i(31),s=i(191).inherits,a=i(235),r=i(1110),l=i(184),c=i(759),u=i(1112),d=i(757),h=i(1113),p=i(758),m=i(430),f=i(471),g=i(30),_=i(439),v=i(1114),y=i(1115),b=i(1116),w=b.SUBAREA_COLOR,M=b.VIEW_MARGIN,T=b.CHUNK_WIDTH,C=b.CHUNK_HEIGHT,I=i(1117),A=i(1118),S=i(1122),E=i(1121),x=i(248).addTooltip,L=i(523),N=i(478),O=i(229).getPosition,D=i(252),R=i(466),P=i(228),B=i(615),k=_.Tween,F=_.easing,z=30;s(n,a),e.exports=n,n.prototype.preloadGenericAssets=function(e){var t=this;g.getAllDataMap(["SubAreaIdPerCoordinate","SubAreasWorldMapData","Hints"],function(i,n){return i?e(i):(t._subAreaIdPerCoordinate=n.SubAreaIdPerCoordinate,t._subAreaData=n.SubAreasWorldMapData,t._iconsInfo=n.Hints,void f.loadModel("icon","assets",function(i,n){var o=1;i.meta&&i.symbols&&(o=i.meta.scale/b.ICONS_ORIGINAL_EXPORT_SCALE,i=i.symbols),t._iconsImage=n;var s=t._scene.createTexture(n,"worldMapIcons","linear","permanent");t._iconBatchData.createIconModels(i,s,o),e()}))})},n.prototype.stopMovingWorldMap=function(){this._scene.camera.stopMoving(),this._loadChunksInView()},n.prototype.centerToPosition=function(e){if(this._worldMapData){if(!e)return console.error("centerToPosition:",e);if(void 0===e.posX||void 0===e.posY)return console.error("centerToPosition:",e.constructor.name);var t=this._convertGridToSceneCoordinate(e.posX,e.posY);this._scene.camera.follow(t),this._loadChunksInView()}},n.prototype.centerOnSubArea=function(e){var t=this.getSubAreaBounds(e);return!!t&&(this.centerToPosition({posX:t.x+t.width/2,posY:t.y+t.height/2}),!0)},n.prototype.getNearestSubarea=function(e){for(var t,i=window.gui.playerData.position.coordinates,n=1/0,o=0;o<e.length;o++){var s=e[o],a=this.getSubAreaBounds(s);if(a){var r=a.x+a.width/2,l=a.y+a.height/2,c=Math.abs(r-i.posX)+Math.abs(l-i.posY);c>=n||(n=c,t=s)}}return t},n.prototype.centerToMyPosition=function(){if(this._worldMapData){var e=window.gui.playerData.position.coordinates;this.centerToPosition(e)}},n.prototype.setDimensions=function(e,t){this.dimensions.width=e,this.dimensions.height=t,this.cropPosition.width=e,this.cropPosition.height=t,this.setStyles({width:e+"px",height:t+"px"}),this.setCanvasDimensions(e,t)},n.prototype.getDisplayedWorldmapId=function(){return this._worldMapId},n.prototype.initialize=function(e,t){var i=window.gui.playerData.position.worldmapId;if(this._worldMapId===i)return this._isLoadingWorldMapData?console.error("[WorldMap.initialize]","Initialisation already launched"):this._display(),t();if(this._isLoadingWorldMapData)return console.error("[WorldMap.initialize]","Initialisation of a world map of another id is already launched","Asked ",i,"Loading",this._worldMapId),t();null!==this._fullMapSprite&&this.clear(),this._worldMapId=i||1,this._isLoadingWorldMapData=!0;var n=window.gui.databases.WorldMaps[this._worldMapId];if(window.gui.playerData.position.worldmapId!==this._worldMapId)return this.initialize(e,t);this._worldMapData=n,3===this._worldMapId?(this._worldMapWidth=n.totalWidth/2,this._worldMapHeight=n.totalHeight/2):(this._worldMapWidth=n.totalWidth,this._worldMapHeight=n.totalHeight),this._zoneWidth=n.mapWidth,this._zoneHeight=n.mapHeight;var o=window.gui.playerData.position.coordinates,s=e.posX||o.posX,a=e.posY||o.posY,r=this._convertGridToSceneCoordinate(s,a),u=n.zoom,d=parseFloat(u[0]),h=parseFloat(u[1]);this._zoomLevels=[d];for(var p=2;p<u.length;p+=1){var f=parseFloat(u[p]);2*f<d?(this._zoomLevels.push(h),d=h,h=f):h=f}this._zoomLevels.push(h),this._scene.camera.setZoomMax(this._zoomLevels[0]),this._scene.setDimensions(0,0,this._worldMapWidth,this._worldMapHeight),this._scene.camera.setZoom(this._zoomLevels[0]),this._scene.camera.setPosition(r.x,r.y),this._topLeftZoneCoordinate=this.convertSceneToGridCoordinate(0,0);var g=this,_=l.WORLDMAP_PATH+this._worldMapId+"-full.jpg";m.loadTexture(_,function(e){return g._fullMapSprite=new c({scene:g._scene,x:0,y:0,w:g._worldMapWidth,h:g._worldMapHeight,layer:-1},e),g._prepareGrid(),g._prepareIcons(),g._display(),g._isLoadingWorldMapData=!1,g.emit("loaded"),t()},this._scene.renderer,"linear")},n.prototype.isLoading=function(){return this._isLoadingWorldMapData},n.prototype._display=function(){this._loadChunksInView(),v.addScene(this._scene)},n.prototype._prepareGrid=function(){null!==this._gridSprite&&this._gridSprite.remove();var e=this._zoneWidth,t=this._zoneHeight,i=0,n=0;this._worldMapData?(i=this._worldMapData.origineX%e,n=this._worldMapData.origineY%t):console.error(new Error("worldMapData are not ready yet!"));var o=Math.floor((this._worldMapWidth-i)/e),s=Math.floor((this._worldMapHeight-n)/t);this._nZonesHorizontally=o,this._nZonesVertically=s;for(var a=o+1,r=s+1,c=a*e,d=r*t,p=[],m=0;m<a;m+=1){var f=m*e;p.push(new u(f,(-n),f,d-n))}for(var g=0;g<r;g+=1){var _=g*t;p.push(new u((-i),_,c-i,_))}this._gridSprite=new h({scene:this._scene,x:i,y:n,lines:p,alpha:0,lineWidth:1*l.PIXEL_RATIO,hue:[.85,.85,.85,.8],layer:2,id:"worldMapGrid"+this._worldMapId}),this._gridSprite.hide(),this._gridTween=new k(this._gridSprite,["alpha"]);var v=window.gui.playerData.position.coordinates,y=this._convertGridToSceneCoordinate(v.posX,v.posY),b=[{x0:-e/2,y0:-t/2,x1:-e/2,y1:-t/4},{x0:-e/2,y0:-t/2,x1:-e/4,y1:-t/2},{x0:e/2,y0:t/4,x1:e/2,y1:t/2},{x0:e/4,y0:t/2,x1:e/2,y1:t/2},{x0:e/2,y0:-t/4,x1:e/2,y1:-t/2},{x0:e/2,y0:-t/2,x1:e/4,y1:-t/2},{x0:-e/2,y0:t/4,x1:-e/2,y1:t/2},{x0:-e/4,y0:t/2,x1:-e/2,y1:t/2}];this._zoneHighlight=new h({scene:this._scene,x:y.x,y:y.y,w:e,h:t,lines:b,lineWidth:4*l.PIXEL_RATIO,hue:[.1,.1,.1,1],layer:3,id:"worldMapHighlight"+this._worldMapId}),this._zoneHighlight.hide(),this._zoneHighlightTween=new k(this._zoneHighlight,["x","y"])},n.prototype.setHighlightOn=function(e,t){if(!this._isLoadingWorldMapData){var i=this._convertGridToSceneCoordinate(e,t);this._zoneHighlight.isDisplayed?((this._zoneHighlightTween.starting||this._zoneHighlightTween.playing)&&this._zoneHighlightTween.stop(),this._zoneHighlightTween.reset().from({x:this._zoneHighlight.x,y:this._zoneHighlight.y}).to({x:i.x,y:i.y},16,F.polyOut,9).start()):(this._zoneHighlight.show(),this._zoneHighlight.x=i.x,this._zoneHighlight.y=i.y)}},n.prototype.hideHighlight=function(){this._zoneHighlight&&((this._zoneHighlightTween.starting||this._zoneHighlightTween.playing)&&this._zoneHighlightTween.stop(),this._zoneHighlight.hide())},n.prototype.setGridVisibility=function(e){if(this._gridTween){this._gridTween.playing&&this._gridTween.stop(),this._gridTween.removeOnFinish();var t=this._gridSprite.isDisplayed?this._gridSprite.alpha:0;if(e)this._gridSprite.show(),this._gridTween.reset().from({alpha:t}).to({alpha:1},4);else{this._gridTween.reset().from({alpha:t}).to({alpha:0},4);var i=this._gridSprite;this._gridTween.onFinish(function(){i.hide()})}this._gridTween.start()}};var H=-100;n.prototype.getSubAreaAtGridCoordinate=function(e,t){for(var i=this._convertGridCoordinateToCompressedCoordinate(e,t),n=this._subAreaIdPerCoordinate[this._worldMapId][i];void 0===n&&t>=H;)i-=1,t--,n=this._subAreaIdPerCoordinate[this._worldMapId][i];if(n)return this._subAreaData[n]},n.prototype.convertGridCoordinateToZoneId=function(e,t){return(t-this._topLeftZoneCoordinate.j)*this._nZonesHorizontally+(e-this._topLeftZoneCoordinate.i)},n.prototype.convertSceneToGridCoordinate=function(e,t){return this._worldMapData?{i:Math.floor((e-this._worldMapData.origineX)/this._zoneWidth),j:Math.floor((t-this._worldMapData.origineY)/this._zoneHeight)}:(console.error(new Error("worldMapData are not ready yet!")),{i:0,j:0})},n.prototype.convertCanvasToGridCoordinate=function(e,t){var i=this._scene.convertCanvasToSceneCoordinate(e,t);return this.convertSceneToGridCoordinate(i.x,i.y)},n.prototype.convertGridToCanvasCoordinate=function(e,t){var i=this._convertGridToSceneCoordinate(e,t);return this._scene.convertSceneToCanvasCoordinate(i.x,i.y)},n.prototype._getZoneGridPositions=function(e){var t=this._subAreaData[e];if(!t)return console.error("SubareaData not found for "+e);var i=t.gridPositions[this._worldMapId];if(!i){for(var n in t.gridPositions){i=t.gridPositions[n];break}if(!i)return console.error("Grid positions missing for subarea "+e)}return i},n.prototype.getSubAreaBounds=function(e){var t=this._getZoneGridPositions(e);if(t){for(var i=1/0,n=1/0,o=-(1/0),s=-(1/0),a=0;a<t.length;a+=2){var r=t[a],l=t[a+1];r<i&&(i=r),r>o&&(o=r),l<n&&(n=l),l>s&&(s=l)}var c=o-i,u=s-n;return{x:i,y:n,width:c,height:u}}},n.prototype.addSubAreaHighlight=function(e,t){var i="subAreaOverlay"+e;if(!this._subAreaSprites[e]||this._subAreaSprites[e].id!==i){var n=this._getZoneGridPositions(e);if(n){for(var o=[],s=1/0,a=1/0,r=-(1/0),l=-(1/0),c={},u=0;u<n.length;u+=2){var h=n[u],m=n[u+1],f=h+":"+m;if(void 0===c[f]){c[f]=!0;var g=this._convertGridToSceneCoordinate(h,m),_=g.x-this._zoneWidth/2,v=g.y-this._zoneHeight/2;o.push(new d(_,v,_+this._zoneWidth,v,_+this._zoneWidth,v+this._zoneHeight,_,v+this._zoneHeight)),_<s&&(s=_),_>r&&(r=_),v<a&&(a=v),v>l&&(l=v)}}null!==this._subAreaSprites[e]&&void 0!==this._subAreaSprites[e]&&this._subAreaSprites[e].remove(),this._subAreaSprites[e]=new p({scene:this._scene,x:0,y:0,boxes:o,hue:t||w,layer:1,id:"subAreaOverlay"+e}),new k(this._subAreaSprites[e],["alpha"]).from({alpha:.4}).to({alpha:1},15,F.polyOut,3).to({alpha:.4},15,F.polyIn,2).start(!0),new k(this._subAreaSprites[e].highlight,["red","green","blue"]).from({red:.3,green:.3,blue:.3}).to({red:1,green:1,blue:1},15,F.polyOut,3).to({red:.3,green:.3,blue:.3},15,F.polyIn,2).start(!0)}}},n.prototype.removeSubAreaHighlight=function(e){if(null!==this._subAreaSprites[e]&&void 0!==this._subAreaSprites[e]){var t=this._subAreaSprites[e];delete this._subAreaSprites[e],new k(t,["alpha"]).from({alpha:1}).to({alpha:0},5).start().onFinish(function(){t.remove()})}},n.prototype.clearSubAreaHighlights=function(e){for(var t in this._subAreaSprites)e!==Number(t)&&this.removeSubAreaHighlight(t)},n.prototype.move=function(e,t,i,n,o){this._scene.move(e,t,i,n,o),this._loadChunksInView()},n.prototype.addInertia=function(e,t){this._scene.camera.addInertia(e,t,.8),this._loadChunksInView()},n.prototype._getZoomLevel=function(e){for(var t,i=this._zoomLevels[0],n=1;n<this._zoomLevels.length&&(t=this._zoomLevels[n],!(e>=1.2*t));n+=1)i=t;return i},n.prototype._loadChunksInView=function(){function e(e,t){var i=W._chunkBatchIndexes[e.id];return i!==W._chunkBatchCurrent?(delete W._chunkBatchIndexes[e.id],t()):void m.loadTexture(e.path,function(i){var n=W._chunkBatchIndexes[e.id];return delete W._chunkBatchIndexes[e.id],n!==W._chunkBatchCurrent?(i.release(),t()):(e.texture=i,W._createChunkGraphic(e),void t())},W._scene.renderer,"linear")}var t=this._scene.camera.zoomTarget;if(void 0!==t){if(0===this._zoomLevels.length||1.5*t<=this._zoomLevels[this._zoomLevels.length-1])return void this._clearChunks();this._chunkBatchCurrent+=1;var i,n,s,a,r=this._getZoomLevel(t),c=this._scene.camera,u=c.followee.x-c.fovW/2*M;if(u<0)i=0,n=Math.min(c.fovW*M,this._worldMapWidth);else{var d=c.followee.x+c.fovW/2*M;d>this._worldMapWidth?(i=Math.max(this._worldMapWidth-c.fovW*M,0),n=this._worldMapWidth):(i=u,n=d)}var h=c.followee.y-c.fovH/2*M;if(h<0)s=0,a=Math.min(c.fovH*M,this._worldMapHeight);else{var p=c.followee.y+c.fovH/2*M;p>this._worldMapHeight?(s=Math.max(this._worldMapHeight-c.fovH*M,0),a=this._worldMapHeight):(s=h,a=p)}var f=this._convertSceneToChunkCoordinate(r,i,s),g=this._convertSceneToChunkCoordinate(r,n,a),_=f.k,v=g.k,b=f.l,w=g.l,I=[],A=r*this._worldMapWidth/T,S=r*this._worldMapHeight/C,E=Math.ceil(A),x=Math.ceil(S);v===A&&A===E&&(v-=1),w===S&&S===x&&(w-=1);var L,N,O,D=Object.keys(this._chunkSprites);for(O=0;O<D.length;O+=1)this._chunkSprites[D[O]].id=null;for(var R=b;R<=w;R+=1)for(var P=_;P<=v;P+=1)if(L=this._worldMapId+"-"+r+"-"+(R*E+P+1).toString(),N=this._chunkSprites[L],void 0===N)if(void 0===this._chunkBatchIndexes[L]){var B=l.WORLDMAP_PATH+L+".jpg",k=R-(b+w)/2,F=P-(_+v)/2,z=Math.sqrt(k*k+F*F),H=this._scene.holdTexture(L),q=new y(P,R,r,L,B,H,this._scene,z);void 0===H?(I.push(q),this._chunkBatchIndexes[L]=this._chunkBatchCurrent):this._createChunkGraphic(q)}else this._chunkBatchIndexes[L]=this._chunkBatchCurrent;else N.id=L;for(O=0;O<D.length;O+=1)L=D[O],N=this._chunkSprites[L],null===N.id&&(N.remove(),delete this._chunkSprites[L]);I.sort(function(e,t){return e.distToViewCenter-t.distToViewCenter});var W=this;o.eachLimit(I,5,e,function(e){e&&console.error("Chunk textures not loaded correctly",e)})}},n.prototype._createChunkGraphic=function(e){e.w*=e.texture.element.width/T,e.h*=e.texture.element.height/C,this._chunkSprites[e.id]=new c(e,e.texture)},n.prototype._clearChunks=function(){for(var e=Object.keys(this._chunkSprites),t=0;t<e.length;t+=1){var i=this._chunkSprites[e[t]];i.remove()}this._chunkSprites={}},n.prototype._convertGridCoordinateToCompressedCoordinate=function(e,t){return((e<0?32768|32767&e:32767&e)<<16)+(t<0?32768|32767&t:32767&t)},n.prototype._convertGridToSceneCoordinate=function(e,t){if(!this._worldMapData)return console.error(new Error("worldMapData are not ready yet!")),{x:0,y:0};var i=this._worldMapData.origineX+e*this._zoneWidth+this._zoneWidth/2,n=this._worldMapData.origineY+t*this._zoneHeight+this._zoneHeight/2;return{x:i,y:n}},n.prototype._convertSceneToChunkCoordinate=function(e,t,i){var n=Math.floor(e*t/T),o=Math.floor(e*i/C);return{k:n,l:o}},n.prototype.setCanvasDimensions=function(e,t){this._scene.setCanvasDimensions(e,t),this._loadChunksInView()},n.prototype.stopRefreshing=function(){v.removeScene(this._scene)},n.prototype.crop=function(e,t,i,n){this.cropPosition.x=e,this.cropPosition.y=t,this.cropPosition.width=i,this.cropPosition.height=n,this._scene.crop(e,t,i,n),this._loadChunksInView()},n.prototype.resetCropping=function(){this.cropPosition.x=this.cropPosition.y=0,this.cropPosition.width=this.dimensions.width,this.cropPosition.height=this.dimensions.height,this._scene.resetCropping(),this._loadChunksInView()},n.prototype.clear=function(){this._scene.clean(),this._scene.clear(),this._worldMapId=0,this._fullMapSprite=null,this._chunkSprites={},this._zoomLevels=[],this._worldMapData=null,this._iconBatchData.clearIconBatch()},n.prototype._prepareIcons=function(){this._iconBatchData.reset(),this._iconBatchData.createIconsFromInfo(this._iconsInfo,this._worldMapId),this._iconBatchData.iconBatch=new S({id:"iconWorldMap_"+this._worldMapId,x:0,y:0,w:this._worldMapWidth,h:this._worldMapHeight,layer:4,scene:this._scene,iconsData:this._iconBatchData});var e=window.gui.playerData.position.coordinates,t=this._convertGridToSceneCoordinate(e.posX,e.posY),i="userPosition",n=new I(i,i,{color:[1,1.1,2,1],clusterId:i},this._iconBatchData.iconDimensions.myPosition),o=new E(i,t.x,t.y);this._iconBatchData.addCluster(o),o.add(n),n.cluster=o,this._iconBatchData.addIcon(n)},n.prototype.hasIcon=function(e){return this._iconBatchData.hasIcon(e)},n.prototype.getIcon=function(e){return this._iconBatchData.getIcon(e)},n.prototype.addIcon=function(e,t){return this._iconBatchData.createIcon(e,t)},n.prototype.removeIcon=function(e){this._iconBatchData.removeIcon(e)},n.prototype.setVisibilityOfIconType=function(e,t){this._iconBatchData.setVisibilityOfIconType(e,t)},n.prototype.setIconPosition=function(e,t,i){this._iconBatchData.setIconPosition(e,t,i)},n.prototype.convertZoneIdToGridCoordinate=function(e){var t=Math.floor(e/this._nZonesHorizontally),i=this._topLeftZoneCoordinate;return{i:e-t*this._nZonesHorizontally+i.i,j:t+i.j}},n.prototype.getSubAreaAtCanvasCoordinate=function(e,t){var i=this.convertCanvasToGridCoordinate(e,t);return this.getSubAreaAtGridCoordinate(i.i,i.j)},n.prototype.getIconsAtCanvasCoordinate=function(e,t){var i=this.convertCanvasToGridCoordinate(e,t),n=this.convertGridCoordinateToZoneId(i.i,i.j);return this._iconBatchData.getClusterIcons(n)},n.prototype.setupUI=function(e){this._setupMapTransform(),this._setupMapTooltip(e)},n.prototype._setupMapTransform=function(){R(this,"HIGH");var e,t=0,i=0;this.on("transformStart",function(){e=Date.now(),t=0,i=0}),this.on("transform",function(n,o,s,a,r){e=Date.now(),t=.5*t+.5*-s,i=.5*i+.5*-a,this.move(n,o,-s,-a,r)}),this.on("transformEnd",function(){Date.now()-e>100||this.addInertia(t,i)})},n.prototype._setupMapTooltip=function(e){function t(e){if(p||(p=g.rootElement.getBoundingClientRect()),r=e.x,l=e.y,c=r-p.left,u=l-p.top,m){var t=null,i=null,n=c-g.cropPosition.x,o=Math.min(.1*g.cropPosition.width,50),s=0;n<o?(t=0,s=n):n>g.cropPosition.width-o&&(t=g._worldMapWidth,s=g.cropPosition.width-n);var a=u-g.cropPosition.y,d=0;if(a<o?(i=0,d=a):a>g.cropPosition.height-o&&(i=g._worldMapHeight,d=g.cropPosition.height-a),null===t&&null===i)w.playing&&(w.stop(),g._loadChunksInView());else{b.x=g._scene.camera.x,b.y=g._scene.camera.y,g._scene.camera.follow(b);var h={x:b.x,y:b.y},f={},v=0,y=M;null===t?f.x=b.x:(f.x=t,Math.abs(t-b.x)>v&&(v=Math.abs(t-b.x),y=M*(o-s)/o)),null===i?f.y=b.y:(f.y=i,Math.abs(i-b.y)>v&&(v=Math.abs(i-b.y),y=M*(o-d)/o)),w.playing||w.start(!1),_.closeTooltip(),w.reset().from(h).to(f,v/y),g._loadChunksInView()}}}function i(){p=g.rootElement.getBoundingClientRect()}function n(e,t){var i=g.convertGridToCanvasCoordinate(e,t),n=g._scene.camera.zoom;return{centerX:i.x+p.left,centerY:i.y+p.top,width:Math.round(g._zoneWidth*n),height:Math.round(g._zoneHeight*n)}}function o(e,t,i){var n=e.subAreaData,o=g.getSubAreaAtGridCoordinate(t,i);if(e.setCoordinates(t,i),o){if(o&&o!==n){n&&g.removeSubAreaHighlight(n.id),e.subAreaData=n=o,e.setSubArea(n);var s=L.entities.prism[n.id];if(s&&s.prism){var a=s.getAlliance();e.setAlliance(a);var r=D.hexToRgb(a.allianceEmblem.backgroundColor.toString(16));g.addSubAreaHighlight(n.id,[r[0]/255,r[1]/255,r[2]/255,.25])}else e.unsetAlliance(),g.addSubAreaHighlight(n.id,[1,0,0,.25])}}else n&&(g.removeSubAreaHighlight(n.id),n=null),e.unsetSubArea();var l=g._iconBatchData.getClusterIcons(g.convertGridCoordinateToZoneId(t,i));l?(e.setIcons(l,g._iconsImage),e.displayIcons()):n?e.displaySubArea():e.displayCoordinates()}function s(){if(!w.playing){var e=g.convertCanvasToGridCoordinate(c,u);if((d!==e.i||h!==e.j)&&m){d=e.i,h=e.j,g.setHighlightOn(d,h),o(v,d,h);var t=n(d,h),i=2*z;_.openTooltipAt(t.centerX,t.centerY,t.width+i,t.height+i)}}}function a(e){t(O(e)),s()}P(this);var r,l,c,u,d,h,p,m,f=window.gui,g=this,_=f.tooltipBox,v=new B;this.on("tap",function(){if(g._worldMapData){var e=g.convertCanvasToGridCoordinate(c,u),t=this.convertGridCoordinateToZoneId(e.i,e.j);e.icons=this._iconBatchData.getClusterIcons(t),f.openContextualMenu("map",e),g.setHighlightOn(e.i,e.j)}});var y=N.getContextMenu("map");y.on("open",function(e){o(y.worldMapTooltip,e.i,e.j)}),y.on("close",function(e){"reopen"!==e&&g.hideHighlight()});var b={},w=new k(b,["x","y"]);w.onFinish(function(){g._loadChunksInView()});var M=50;this.on("dom.touchstart",function(e){this.stopMovingWorldMap(),t(O(e))}),e.on("positioned",i),e.on("resize",i),x(this,v),this.on("tooltipOn",function(){m=!0,_.closeForRecomputing(),s(),f.wBody.on("dom.touchmove",a)}),this.on("tooltipOut",function(){m=!1,f.wBody.removeListener("dom.touchmove",a);var e=v.subAreaData;e&&g.removeSubAreaHighlight(e.id),g.hideHighlight(),w.playing&&w.stop(),e=d=h=null})}},function(e,t){},function(e,t,i){function n(e,t){return e._layer===t._layer?e._position-t._position:e._layer-t._layer}function o(){var e=document.createElement("canvas");e.width=128,e.height=128;var t=e.getContext("2d");return t.fillStyle="rgba(200, 100, 30, 0.27)",t.fillRect(0,0,128,128),t.lineWidth=2,t.strokeStyle="rgba(200, 100, 30, 0.9)",t.strokeRect(0,0,128,128),e}function s(e){void 0===e.name&&console.error("[Scene] Parameter `name` required."),void 0===e.canvas&&console.error("[Scene] Parameter `canvas` required."),void 0===e.pixelRatio&&console.error("[Scene] Parameter `pixelRatio` required."),void 0===e.textureRatio&&e.usePrecisionRendering&&console.error("[Scene] Parameter `textureRatio` required."),void 0===e.w&&console.error("[Scene] Parameter `w` required."),void 0===e.h&&console.error("[Scene] Parameter `h` required."),void 0===e.t&&console.error("[Scene] Parameter `t` required."),void 0===e.l&&console.error("[Scene] Parameter `l` required."),void 0===e.nbCacheableSprites&&console.error("[Scene] Parameter `nbCacheableSprites` required."),void 0===e.textureMemoryCacheSize&&console.error("[Scene] Parameter `textureMemoryCacheSize` required."),void 0===e.prerenderQualityRatio&&console.error("[Scene] Parameter `prerenderQualityRatio` required."),this.name=e.name,this.canvas=e.canvas,this.canvas.id=this.name+"-canvas",this.maxZoom=e.maxZoom||1,this.pixelRatio=e.pixelRatio,this.sceneTextureRatio=e.textureRatio,this.viewWidth=this.canvas.width,this.viewHeight=this.canvas.height,this.adjustToCanvasRatio=e.adjustToCanvasRatio||!1,this.w=e.w,this.h=e.h,this.l=e.l,this.t=e.t,this.r=this.l+this.w,this.b=this.t+this.h;var t=this.w/2+this.l,i=this.h/2+this.t;this.camera=new a(t,i,1,this.l,this.r,this.t,this.b,this.canvas.width,this.canvas.height,this.maxZoom),e.cameraAcceleration&&this.camera.setDefaultAcceleration(e.cameraAcceleration),this.cropping={x:-(1/0),y:-(1/0),w:1/0,h:1/0,isActive:!1},this.displayList=new r(n),this.hudDisplayList=new r(n),this.staticElements={sprite:null,render:function(e,t){null!==this.sprite&&this.sprite.draw(e,t)},add:function(e){return this.sprite=e,e},removeByRef:function(e){return e===this.sprite&&(this.sprite=null,!0)},reposition:function(e){return e},clear:function(){null!==this.sprite&&(this.sprite.remove(),this.sprite=null)}},this.updateList=[],this.renderer=new l(this.canvas,0,0,e.nbCacheableSprites,e.textureMemoryCacheSize,e.prerenderQualityRatio,(!1)),this._debug=!1,this._textureDebug=this.createTexture(o(),"mapDebug","linear","permanent"),this.usePrecisionRendering=e.usePrecisionRendering||!1,this.usePrecisionRendering?(this.areasToRefresh=[],this.sceneRendering=this.renderer.startTextureUsage(this.r-this.l,this.b-this.t,this.sceneTextureRatio,this.name),this.sceneTextureRatio=this.sceneRendering.width/(this.r-this.l),this.renderingProgram=this.renderer._programFiltering,this.renderingParams={ratio:.15,resolution:250},this.refresh=this._refreshPrecisionRendering,this.render=this._compositePrecisionRendering,this.clear=this._clearPrecisionRendering):(this.refresh=this._refresh,this.render=this._composite,this.clear=this._clear),this.setCanvasDimensions(this.canvas.width,this.canvas.height)}var a=i(1111),r=i(450),l=i(445);e.exports=s,s.prototype.togglePixelArt=function(){this.renderingProgram===this.renderer._programPixelArt?this.renderingProgram=this.renderer._programFiltering:this.renderingProgram=this.renderer._programPixelArt},s.prototype.setShader=function(e){switch(e){case"pixelArt":this.renderingProgram=this.renderer._programPixelArt;break;case"mapTransition":this.renderingProgram=this.renderer._programMapTransition;break;default:this.renderingProgram=this.renderer._programFiltering}},s.prototype._setSceneTransform=function(){var e=this.canvas.width/this.w,t=this.canvas.height/this.h,i=Math.max(e,t),n=Math.max(0,this.cropping.x)*this.pixelRatio,o=Math.max(0,this.cropping.y)*this.pixelRatio;this.renderer.setTransform(i,0,0,i,n,o)},s.prototype._setFieldOfView=function(){this.viewWidth=Math.min(this.cropping.w,this.canvas.width/this.pixelRatio),this.viewHeight=Math.min(this.cropping.h,this.canvas.height/this.pixelRatio),this.camera.setFieldOfView(this.viewWidth,this.viewHeight),this._setSceneTransform()},s.prototype.setCanvasDimensions=function(e,t,i,n,o){if(void 0!==o&&(this.canvas.style.position=o),this._viewWidth===e&&this._viewHeight===t&&this._viewLeft===i&&this._viewTop===n)return!1;this._viewWidth=e,this._viewHeight=t,this._viewLeft=i,this._viewTop=n,this.canvas.style.width=e.toString()+"px",this.canvas.style.height=t.toString()+"px",void 0!==i&&(this.canvas.style.left=i+"px"),void 0!==n&&(this.canvas.style.top=n+"px");var s=e*this.pixelRatio,a=t*this.pixelRatio;if(this.canvas.width=s,this.canvas.height=a,this.renderer.resetDimension(s,a),this.adjustToCanvasRatio){var r=this.h*s/a;this.setDimensions(this.l,this.t,r,this.h)}return this._setFieldOfView(),!0},s.prototype.setDimensions=function(e,t,i,n){this.w=i,this.h=n,this.l=e,this.t=t,this.r=this.l+this.w,this.b=this.t+this.h,this.camera.setBounds(this.l,this.r,this.t,this.b),this._setSceneTransform()},s.prototype.requireCompleteRefresh=function(){this.areasToRefresh.push([this.l,this.r,this.t,this.b])},s.prototype._refresh=function(e){var t=this.camera.updatePosition(e);if(0!==this.updateList.length||t!==!1){if(this.renderer.clear(),this.cropping.isActive){var i=this.pixelRatio,n=Math.ceil(i*this.cropping.x),o=Math.ceil(i*this.cropping.y),s=Math.ceil(i*this.cropping.w),a=Math.ceil(i*this.cropping.h);o=this.canvas.height-a-o,this.renderer.enableScissor(n,o,s,a)}this._composite(),this.cropping.isActive&&this.renderer.disableScissor()}},s.prototype._composite=function(){for(var e=0;e<this.updateList.length;e+=1)this.updateList[e].refreshAnimation();this.updateList.length=0;var t=this.pixelRatio*this.camera.zoom*Math.min(this.w/this.canvas.width,this.h/this.canvas.height);this.renderer.save(),this.renderer.translate(t/this.camera.zoom*this.viewWidth/2,t/this.camera.zoom*this.viewHeight/2),this.renderer.scale(t,t),this.renderer.translate(-this.camera.x,-this.camera.y);for(var i=this.displayList.first;null!==i;i=i.next)i.object.render();this._debug&&this._renderDebug(),this.renderer.restore()},s.prototype._renderDebug=function(){for(var e=this.displayList.first;null!==e;e=e.next){var t=e.object;this.renderer.drawImage(this._textureDebug,t.x,t.y,t.w,t.h)}},s.prototype._refreshPrecisionRendering=function(e){var t=this.camera.updatePosition(e);if(0!==this.updateList.length){for(var i=0;i<this.updateList.length;i+=1)this.updateList[i].refreshAnimation(this.areasToRefresh);this.updateList.length=0}if(0!==this.areasToRefresh.length){for(var n=0;n<this.areasToRefresh.length;n+=1){var o=this.areasToRefresh[n];if(o[1]<=o[0]||o[3]<=o[2])this.areasToRefresh.splice(n,1),n-=1;else for(var s=0;s<this.areasToRefresh.length;s+=1)if(n!==s){var a=this.areasToRefresh[s],r=(o[0]-a[1])*(a[0]-o[1])>0,l=(o[2]-a[3])*(a[2]-o[3])>0;r&&l&&(o[0]=Math.min(o[0],a[0]),o[1]=Math.max(o[1],a[1]),o[2]=Math.min(o[2],a[2]),o[3]=Math.max(o[3],a[3]),this.areasToRefresh.splice(s,1),s-=1,s<n&&(n-=1))}}this._refreshAreas(),t=!0}(t||this.hudDisplayList.count>0)&&(this._compositePrecisionRendering(),this._debug&&this._renderDebugPrecisionRendering(this.areasToRefresh),this.areasToRefresh.length=0),this.areasToRefresh.length>0&&(this.areasToRefresh.length=0)};var c={layer:-(1/0)},u={layer:1/0};s.prototype._refreshAreas=function(){this.renderer.startTextureRendering(this.sceneRendering,this.l,this.r,this.t,this.b);for(var e=c,t=0;t<this.areasToRefresh.length;t+=1){var i=this.areasToRefresh[t],n=Math.floor(this.sceneTextureRatio*(i[0]-this.l))-1,o=Math.floor(this.sceneTextureRatio*(i[2]-this.t))-1,s=Math.ceil(this.sceneTextureRatio*(i[1]-i[0]))+2,a=Math.ceil(this.sceneTextureRatio*(i[3]-i[2]))+2;this.renderer.enableScissor(n,o,s,a);for(var r=this.displayList.first;null!==r;r=r.next){var l=r.object,d=l.bbox;if(!(d[0]>=d[1])){var h=(i[0]-d[1])*(d[0]-i[1])>=0,p=(i[2]-d[3])*(d[2]-i[3])>=0;h&&p&&(this.staticElements.render(e,l),e=l,l.render())}}this.staticElements.render(e,u)}this.renderer.stopTextureRendering(),this.renderer.disableScissor()},s.prototype._compositePrecisionRendering=function(){var e=this.pixelRatio*this.camera.zoom*Math.min(this.w/this.canvas.width,this.h/this.canvas.height);
if(this.renderer.disableBlending(),this.renderer.useProgram(this.renderingProgram,this.renderingParams),this.renderer.drawImage(this.sceneRendering.texture,this.w/2-(this.camera.x-this.l)*e,this.h/2-(this.camera.y-this.t)*e,e*this.w,e*this.h),this.renderer.stopProgram(),this.renderer.enableBlending(),this.hudDisplayList.count>0){this.renderer.useProgram(this.renderer._programRegular);for(var t=this.hudDisplayList.first;null!==t;t=t.next)t.object.render();this.renderer.stopProgram()}},s.prototype._renderDebugPrecisionRendering=function(e){var t=this.camera.zoom*this.pixelRatio*this.w/this.canvas.width;this.renderer.save(),this.renderer.translate(this.w/2,this.h/2),this.renderer.scale(t,t),this.renderer.translate(-(this.camera.x-this.l),-(this.camera.y-this.t)),this.renderer.enableBlending();for(var i=0;i<e.length;i+=1){var n=e[i],o=n[0]-this.l,s=n[2]-this.t,a=n[1]-n[0],r=n[3]-n[2];this.renderer.drawImage(this._textureDebug,o,s,a,r)}this.renderer.restore()},s.prototype.crop=function(e,t,i,n){this.cropping.isActive=!0,this.cropping.x=e,this.cropping.y=t,this.cropping.w=i,this.cropping.h=n,this._setFieldOfView()},s.prototype.resetCropping=function(){this.cropping.isActive=!1,this.cropping.x=-(1/0),this.cropping.y=-(1/0),this.cropping.w=1/0,this.cropping.h=1/0,this._setFieldOfView()},s.prototype.convertSceneToCanvasCoordinate=function(e,t){var i=Math.max(0,this.cropping.x),n=Math.max(0,this.cropping.y);return{x:(e-this.camera.x+this.camera.fovW/2)*this.camera.zoom+i,y:(t-this.camera.y+this.camera.fovH/2)*this.camera.zoom+n}},s.prototype.convertCanvasToSceneCoordinate=function(e,t){var i=Math.max(0,this.cropping.x),n=Math.max(0,this.cropping.y);return{x:(e-i)/this.camera.zoom+this.camera.x-this.camera.fovW/2,y:(t-n)/this.camera.zoom+this.camera.y-this.camera.fovH/2}},s.prototype.move=function(e,t,i,n,o){e-=Math.max(0,this.cropping.x),t-=Math.max(0,this.cropping.y),this.camera.transform(e,t,i,n,o)},s.prototype.toggleDebugMode=function(){this._debug=!this._debug},s.prototype.showSprites=function(e){for(var t=0;t<e.length;t++)e[t].show()},s.prototype.hideSprites=function(e){for(var t=0;t<e.length;t++)e[t].hide()},s.prototype.createTexture=function(e,t,i,n){return this.renderer.createTexture(e,t,i,n)},s.prototype.useTexture=function(e){return this.renderer.useTexture(e)},s.prototype.holdTexture=function(e){return this.renderer.holdTexture(e)},s.prototype.clean=function(){for(var e=this.displayList.first;null!==e;){var t=e.next;e.object.remove(),e=t}this.staticElements.clear()},s.prototype._clear=function(e,t,i,n){this.renderer.setClearColor(e,t,i,n),this.renderer.clear(),this.renderer.resetClearColor()},s.prototype._clearPrecisionRendering=function(e,t,i,n){this.renderer.startTextureRendering(this.sceneRendering,this.l,this.r,this.t,this.b),this.renderer.setClearColor(e,t,i,n),this.renderer.clear(),this.renderer.stopTextureRendering(),this.renderer.clear(),this.renderer.resetClearColor()}},function(e,t,i){function n(e,t,i,n,s,a,l,c,u,d){o.call(this),this.l=n,this.r=s,this.t=a,this.b=l,this.w=s-n,this.h=l-a,this.min={x:0,y:0},this.max={x:0,y:0},this.fovWAbsolute=c,this.fovHAbsolute=u,this.setZoomMax(d),this._updateZoomBounds(),this.setZoom(i),this.setPosition(e,t),this.acceleration=r,this.a=this.acceleration,this._frozen=!1,this.emitAtDestination=!1}var o=i(194).EventEmitter,s=i(191).inherits,a=.005,r=1.25,l=3e3,c=.008,u=.013;s(n,o),e.exports=n,n.prototype.setAcceleration=function(e){this.a=e},n.prototype.setDefaultAcceleration=function(e){this.acceleration=e},n.prototype.freeze=function(){this._frozen=!0},n.prototype.unfreeze=function(){this._frozen=!1},n.prototype.stopMoving=function(){this.followee={x:this.x,y:this.y},this.zoomTarget=this.zoom,this.z=l/this.zoom},n.prototype.setZoom=function(e){e=Math.max(this.minZoom,Math.min(this.maxZoom,e)),this.z=l/e,this.zoom=e,this.zoomTarget=e,this._updatePositionBounds()},n.prototype.setZoomMax=function(e){this.maxZoom=e},n.prototype.setPosition=function(e,t){this.x=Math.min(this.max.x,Math.max(this.min.x,e)),this.y=Math.min(this.max.y,Math.max(this.min.y,t)),this.followee={x:e,y:t}},n.prototype._updateZoomBounds=function(){var e=this.fovWAbsolute/this.w,t=this.fovHAbsolute/this.h;this.minZoom=Math.min(Math.max(e,t),this.maxZoom),this.zoom<this.minZoom&&(this.zoom=this.minZoom),this.zoomTarget<this.minZoom&&(this.zoomTarget=this.minZoom),this.z=l/this.zoom},n.prototype._updatePositionBounds=function(){this.fovW=this.fovWAbsolute/this.zoomTarget,this.fovH=this.fovHAbsolute/this.zoomTarget,this.min.x=this.l+this.fovW/2,this.min.y=this.t+this.fovH/2,this.max.x=this.r-this.fovW/2,this.max.y=this.b-this.fovH/2,this.min.x>this.max.x&&(this.min.x=this.max.x=(this.min.x+this.max.x)/2),this.min.y>this.max.y&&(this.min.y=this.max.y=(this.min.y+this.max.y)/2)},n.prototype.zoomTo=function(e){this.zoomTarget=Math.min(Math.max(e,this.minZoom),this.maxZoom),this._updatePositionBounds()},n.prototype.moveTo=function(e,t,i){this.followee={x:e,y:t},null!==i&&void 0!==i&&(this.emitAtDestination=!0)},n.prototype.transform=function(e,t,i,n,o){var s=this.zoomTarget;e/=s,t/=s,i/=s,n/=s;var a=Math.max(this.minZoom,Math.min(this.maxZoom,s*o)),r=1-s/a,l=Math.min(this.max.x,Math.max(this.min.x,this.followee.x)),c=Math.min(this.max.y,Math.max(this.min.y,this.followee.y)),u=l+(e-this.fovW/2)*r+i,d=c+(t-this.fovH/2)*r+n;this.zoomTo(a),this.moveTo(u,d)},n.prototype.addInertia=function(e,t,i){e/=this.zoom,t/=this.zoom;var n=Math.sqrt(e*e+t*t);if(0!==n){this.a=Math.pow(this.acceleration,1-i);var o=Math.log(n/a)/Math.log(this.a)-1,s=a*(1-Math.pow(this.a,o))/(1-this.a);this.moveTo(this.x+s*e/n,this.y+t*s/n)}},n.prototype.setFieldOfView=function(e,t){this.fovWAbsolute=e,this.fovHAbsolute=t,this._updateZoomBounds(),this._updatePositionBounds()},n.prototype.setBounds=function(e,t,i,n){this.l=e,this.r=t,this.t=i,this.b=n,this.w=t-e,this.h=n-i,this._updateZoomBounds(),this._updatePositionBounds()},n.prototype.follow=function(e){this.followee=e},n.prototype.updatePosition=function(e){if(!this._frozen){this.a+=(this.acceleration-this.a)*(u*e);var t=this.min.x,i=this.max.x,n=this.min.y,o=this.max.y,s=Math.min(i,Math.max(t,this.followee.x)),a=Math.min(o,Math.max(n,this.followee.y)),r=l/this.zoomTarget,d=s-this.x,h=a-this.y,p=r-this.z;if(0===d&&0===h&&0===p)return this.emitAtDestination&&(this.emitAtDestination=!1,this.emit("atDestination")),!1;if(Math.abs(d)<.5&&Math.abs(h)<.5&&Math.abs(p)<.5)return this.x=s,this.y=a,this.z=r,this.zoom=this.zoomTarget,this.a+=(1-this.a)*c,!1;var m=1-Math.pow(2-this.a,e);this.x+=m*d,this.y+=m*h,this.z+=m*p,this.zoom=l/this.z;var f=this.fovWAbsolute/this.zoom,g=this.fovHAbsolute/this.zoom;return t=this.l+f/2,n=this.t+g/2,i=this.r-f/2,o=this.b-g/2,this.x<t?this.x=t:this.x>i&&(this.x=i),this.y<n?this.y=n:this.y>o&&(this.y=o),!0}}},function(e,t){function i(e,t,i,n){this.x0=e,this.y0=t,this.x1=i,this.y1=n}e.exports=i},function(e,t,i){function n(e){s.call(this,e),this._lines=e.lines,this._lineWidth=e.lineWidth*a.PIXEL_RATIO,this._lineByteSize=this.renderer.getNbBytesPerLine(),this._bbox=[1/0,-(1/0),1/0,-(1/0)],this._createVertexBuffer()}var o=i(191).inherits,s=i(421),a=i(184);o(n,s),e.exports=n,n.prototype._createVertexBuffer=function(){var e=this._lines.length;this._vertexBuffer=new window.ArrayBuffer(e*this._lineByteSize),this._positions=new window.Float32Array(this._vertexBuffer),this._colorView=new window.Uint32Array(this._vertexBuffer);for(var t=0;t<e;t+=1){var i=this._lines[t];this._expandToFitLine(i);var n=t*this._lineByteSize/4;this._positions[n+0]=i.x0,this._positions[n+1]=i.y0,this._positions[n+5]=i.x1,this._positions[n+6]=i.y1,this._colorView[n+3]=this._colorView[n+8]=1077952576}this.renderer.releaseBuffer(this.id),this.forceRefresh()},n.prototype.draw=function(){this.renderer.drawLineBatch(this.id,this._lineWidth)},n.prototype._expandToFitPoint=function(e,t){this._bbox[0]>e&&(this._bbox[0]=e),this._bbox[2]>t&&(this._bbox[2]=t),this._bbox[1]<e&&(this._bbox[1]=e),this._bbox[3]<t&&(this._bbox[3]=t)},n.prototype._expandToFitLine=function(e){this._expandToFitPoint(e.x0,e.y0),this._expandToFitPoint(e.x1,e.y1)},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this._positions,i=!1;this.renderer.loadLineBuffer(this.id,t,this._bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t,i){var n=i(184),o=i(439),s=1e3/n.FPS,a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,s)},r={gameScenes:[],previousUpdate:Date.now(),addScene:function(e){var t=this.gameScenes.indexOf(e);t===-1?this.gameScenes.push(e):console.warn("[animationController.addScene] Scene already in the animation controller")},removeScene:function(e){var t=this.gameScenes.indexOf(e);t!==-1?this.gameScenes.splice(t,1):console.warn("[animationController.removeScene] Scene not in the animation controller")},start:function(){function e(){o.update();var i=Date.now(),n=Math.min(i-t.previousUpdate,200),r=n>s;if(r){t.previousUpdate=i-n%s,n/=s;for(var l=t.gameScenes,c=0;c<l.length;c+=1)l[c].refresh(n)}a(e)}var t=this;e()},stop:function(){o.stop()}};e.exports=r},function(e,t,i){function n(e,t,i,n,o,r,l,c){var u=s/i,d=a/i;this.x=e*u,this.y=t*d,this.w=u,this.h=d,this.id=n,this.path=o,this.texture=r,this.scene=l,this.distToViewCenter=c}var o=i(1116),s=o.CHUNK_WIDTH,a=o.CHUNK_HEIGHT;e.exports=n},function(e,t,i){t.WORLDMAP_PATH=i(184).WORLDMAP_PATH,t.SUBAREA_COLOR=[16/255,186/255,105/255,.25],t.VIEW_MARGIN=1.1,t.CHUNK_WIDTH=250,t.CHUNK_HEIGHT=250,t.ICON_DIAMETER=28,t.ICONS_ANCHOR_POINT={DEFAULT:{x:-.5,y:-.5},myPosition:{x:-.5,y:-1},flag0:{x:-.5,y:-1},flag1:{x:-.5,y:-1}},t.ICONS_ORIGINAL_EXPORT_SCALE=1.5},function(e,t){function i(e,t,i,n){this.id=e,this.visible=!0,this.color=null,this.categoryId=t,this.infoData=i,this.dimensions=n,this.cluster=null,this.vertexBufferSlot=null}e.exports=i,i.prototype.setVisibility=function(e){return this.visible!==e&&(this.visible=e,this.cluster&&(e?this.cluster.nVisibleIcons+=1:this.cluster.nVisibleIcons-=1),!0)}},function(e,t,i){function n(e){this.texture=null,this.iconDimensions=null,this.iconBatch=null,this.worldMap=e,this.reset()}var o=i(1119).clusterOrdering,s=i(1121),a=i(1117),r=i(1116).ICONS_ANCHOR_POINT;e.exports=n,n.prototype.getClusterIcons=function(e){var t=this.iconClusters[e];if(t)return t.icons},n.prototype.reset=function(){this.icons={},this.iconClusters={},this.iconsPerCategory={},this.zIndexedIconClusters=[]},n.prototype.addCluster=function(e){this.iconClusters[e.id]=e,this.zIndexedIconClusters.push(e),this.zIndexedIconClusters.sort(o)},n.prototype.removeCluster=function(e){var t=this.zIndexedIconClusters.indexOf(e);return t===-1?void console.error(new Error("[IconBatchData.removeCluster] Trying to remove inexistent cluster")):(delete this.iconClusters[e.id],void this.zIndexedIconClusters.splice(t,1))},n.prototype.createIconModels=function(e,t,i){var n={},o=Object.keys(e);i=i||1;for(var s=0;s<o.length;s+=1){var a=e[o[s]];a.w*=i,a.h*=i;var l=r[a.className]||r.DEFAULT;l&&(a.x=a.w*l.x,a.y=a.h*l.y),n[a.className]=a}this.texture=t,this.iconDimensions=n},n.prototype.clearIconBatch=function(){null!==this.iconBatch&&(this.iconBatch.clear(),this.iconBatch=null)},n.prototype.addIcon=function(e){var t=e.id;if(void 0!==this.icons[t])return void console.error("addIcon: An icon of id",t,"already exists.");this.icons[t]=e;var i=e.categoryId;void 0===this.iconsPerCategory[i]?this.iconsPerCategory[i]=[e]:this.iconsPerCategory[i].push(e),null!==this.iconBatch&&this.iconBatch.addIcon(e)},n.prototype.removeIcon=function(e){var t=this.icons[e];if(void 0!==t){delete this.icons[e];var i=t.cluster;i.remove(t),0===i.icons.length&&this.removeCluster(i);var n=this.iconsPerCategory[t.categoryId],o=n.indexOf(t.id);n.splice(o,1),null!==this.iconBatch&&this.iconBatch.removeIcon(t)}},n.prototype._addIconToZoneCluster=function(e,t,i){var n=this.worldMap.convertGridCoordinateToZoneId(t,i),o=this.iconClusters[n];if(void 0===o){var a=this.worldMap._convertGridToSceneCoordinate(t,i);o=new s(n,a.x,a.y),this.addCluster(o)}o.add(e),e.cluster=o},n.prototype.createIcon=function(e,t){if(!this.iconDimensions[t])return console.error("WorldMap (IconBatchData): unknown icon "+t);var i=e.x,n=e.y,o=e.categoryId,s=new a(e.id,o,e,this.iconDimensions[t]);return void 0===this.icons[e.id]?(this._addIconToZoneCluster(s,i,n),this.addIcon(s)):console.warn("createIcon: An icon of id",e.id,"already exists."),s},n.prototype.createIconsFromInfo=function(e,t){for(var i=Object.keys(e),n=0;n<i.length;n+=1){var o=e[i[n]];o.worldMapId===t&&this.createIcon(o,"icon_"+o.gfx)}},n.prototype.hasIcon=function(e){return this.icons.hasOwnProperty(e)},n.prototype.getIcon=function(e){return this.icons[e]},n.prototype.setVisibilityOfIconType=function(e,t){var i=this.iconsPerCategory[e];if(void 0!==i){for(var n=[],o=0;o<i.length;o+=1){var s=i[o],a=s.setVisibility(t);a&&n.push(s)}null!==this.iconBatch&&this.iconBatch.setVisibility(n,t)}},n.prototype.setIconPosition=function(e,t,i){var n=this.icons[e];if(void 0!==n){var s=n.cluster;if("userPosition"===e){var a=this.worldMap._convertGridToSceneCoordinate(t,i);s.position.x=a.x,s.position.y=a.y,this.zIndexedIconClusters.sort(o)}else s.remove(n),this._addIconToZoneCluster(n,t,i);null!==this.iconBatch&&this.iconBatch.updateIconPosition(n)}}},function(e,t,i){var n=i(1116).ICON_DIAMETER,o=i(1120);t.positionOrdering=function(e,t){var i=e.y-t.y;return 0===i?e.x-t.x:i},t.clusterOrdering=function(e,t){var i=e.position,n=t.position,o=i.y-n.y;return 0===o?i.x-n.x:o};var s=[];t.computeRelativePositions=function(e){for(var i=[],a=e<=1?0:n/(2*Math.sin(Math.PI/e)),r=0;r<e;r+=1){var l=2*Math.PI*r/e;i[r]=new o(Math.cos(l)*a,Math.sin(l)*a)}return i.sort(t.positionOrdering),i.push(new o(0,0)),s[e]=i,i},t.getRelativePositions=function(e){var i=s[e];return void 0===i&&(i=t.computeRelativePositions(e)),i}},function(e,t){function i(e,t){this.x=e,this.y=t}e.exports=i,i.prototype.plus=function(e){return new i(this.x+e.x,this.y+e.y)},i.prototype.copy=function(){return new i(this.x,this.y)}},function(e,t,i){function n(e,t,i){this.id=e,this.position=new o(t,i),this.icons=[],this.nVisibleIcons=0}var o=i(1120),s=i(1119).getRelativePositions;e.exports=n,n.prototype.getIconPosition=function(e){var t=s(this.nVisibleIcons);if(!t[e]){var i="";if(this.icons&&this.icons.length>0){var n=this.icons[0];n.infoData&&n.infoData.x&&n.infoData.y&&(i="["+n.infoData.x+","+n.infoData.y+"]")}return console.error(new Error("relativePositions for "+e+" is null, nVisibleIcons on the cluster is "+this.nVisibleIcons+", clusterId is "+this.id+" "+i)),this.position}return this.position.plus(t[e])},n.prototype.add=function(e){this.icons.unshift(e),e.visible&&(this.nVisibleIcons+=1)},n.prototype.remove=function(e){var t=this.icons.indexOf(e);t===-1?console.error(new Error("[IconCluster.remove] Icon not in cluster: "+e.id)):(this.icons.splice(t,1),e.visible&&(this.nVisibleIcons-=1))}},function(e,t,i){function n(e,t){this.icon=e,this.index=t,this.reference=null}function o(e){a.call(this,e),this._bbox=[0,e.w,0,e.h],this._iconsData=e.iconsData,this._texture=this._iconsData.texture,this._textureWidth=this._texture.element.width,this._textureHeight=this._texture.element.height,this._iconByteSize=this.renderer.getNbBytesPerSprite(),this._vertexBufferSlots=new l,this._populateVertexBuffer()}var s=i(191).inherits,a=i(421),r=i(439),l=i(429),c=r.Tween,u=3.3,d=.2,h=9;s(o,a),e.exports=o,o.prototype._createVertexBuffer=function(){this._vertexBuffer=new window.ArrayBuffer(this._vertexBufferSlots.length*this._iconByteSize),this._floatView=new window.Float32Array(this._vertexBuffer),this._longView=new window.Uint32Array(this._vertexBuffer),this._shortView=new window.Uint16Array(this._vertexBuffer),this._byteView=new window.Uint8Array(this._vertexBuffer)},o.prototype._assignVertexBufferSlots=function(){for(var e=0,t=this._iconsData.zIndexedIconClusters,i=0;i<t.length;i+=1)for(var o=t[i],s=o.icons,a=0;a<s.length;a+=1){var r=s[a],l=new n(r,e);l.reference=this._vertexBufferSlots.addBack(l),r.vertexBufferSlot=l,e+=1}},o.prototype._populateVertexBuffer=function(){this._assignVertexBufferSlots(),this._createVertexBuffer();for(var e=this._iconsData.zIndexedIconClusters,t=0;t<e.length;t++)this._populateClusterVertexBuffer(e[t]);this.renderer.releaseBuffer(this.id),this.forceRefresh()},o.prototype._populateClusterVertexBuffer=function(e){for(var t=0,i=e.icons,n=0;n<i.length;n+=1)t=this._populateIconVertexBuffer(i[n],t)},o.prototype._populateIconVertexBuffer=function(e,t){var i=this._floatView,n=this._longView,o=this._longView,s=e.cluster.getIconPosition(t),a=e.vertexBufferSlot.index*this._iconByteSize/4;i[a+0]=i[a+5]=i[a+10]=s.x,i[a+15]=i[a+20]=i[a+25]=s.x,i[a+1]=i[a+6]=i[a+11]=s.y,i[a+16]=i[a+21]=i[a+26]=s.y;var r=e.dimensions,l=r.sx/this._textureWidth,c=r.sy/this._textureHeight,u=(r.sx+r.sw)/this._textureWidth,h=(r.sy+r.sh)/this._textureHeight,p=65535&65535*l,m=65535&65535*u,f=4294901760&4294901760*c,g=4294901760&4294901760*h;n[a+2]=p+f,n[a+7]=p+g,n[a+12]=m+g,n[a+17]=p+f,n[a+22]=m+g,n[a+27]=m+f;var _=e.infoData.color||[1,1,1,1],v=Math.max(-128,Math.min(127,64*_[0])),y=Math.max(-128,Math.min(127,64*_[1])),b=Math.max(-128,Math.min(127,64*_[2])),w=e.visible?Math.max(-128,Math.min(127,64*_[3])):0,M=(w<<24&4278190080)+(b<<16&16711680)+(y<<8&65280)+(255&v);n[a+3]=n[a+8]=n[a+13]=M,n[a+18]=n[a+23]=n[a+28]=M;var T=r.x,C=r.w+T,I=r.y,A=r.h+I,S=255&T,E=255&C,x=(255&I)<<8,L=(255&A)<<8,N=127*(1-d)&255,O=(N<<24)+(N<<16);return o[a+4]=S+x+O,o[a+9]=S+L+O,o[a+14]=E+L+O,o[a+19]=S+x+O,o[a+24]=E+L+O,o[a+29]=E+x+O,e.visible?t+1:t},o.prototype.setVisibility=function(e,t,i,n){for(var o,s,a=n||{},r=0;r<e.length;r+=1)o=e[r],o.visible===t?(s=o.cluster,void 0===a[s.id]&&(a[s.id]=s)):console.error("setVisibility: icon "+o.id+" visibility != "+t);for(var l=[],u={},p=Object.keys(a),m=0;m<p.length;m+=1){var f=p[m];s=a[f];var g=s.icons,_=0;for(r=0;r<g.length;r+=1)if(o=g[r],o.visible){var v=o.vertexBufferSlot.index*this._iconByteSize/4;l.push(o),u[o.id]={origin:{x:this._floatView[v],y:this._floatView[v+1]},destination:s.getIconPosition(_)},_+=1}}var y={ease:0},b=this,w=new c(y,["ease"]);w.onUpdate(function(){var i=b._floatView,n=b._shortView,o=b._byteView,s=y.ease,a=t?s:1-s,r=64*a&255,c=a-1,h=2,p=c*c*((h+1)*c+h)+1-d;p=127*p&255,p+=p<<8;for(var m=0;m<e.length;m+=1){var f=e[m];if(null!==f.vertexBufferSlot){var g=f.vertexBufferSlot.index*b._iconByteSize,_=g/2;n[_+9]=n[_+19]=n[_+29]=p,n[_+39]=n[_+49]=n[_+59]=p,o[g+15]=o[g+35]=o[g+55]=r,o[g+75]=o[g+95]=o[g+115]=r}else console.warn("setVisibility skipping fading icon "+f.id)}var v=1-Math.pow((1-s)/1,4);for(m=0;m<l.length;m+=1){var w=l[m];if(null!==w.vertexBufferSlot){var M=u[w.id],T=M.origin.x*(1-v)+M.destination.x*v,C=M.origin.y*(1-v)+M.destination.y*v,I=w.vertexBufferSlot.index*b._iconByteSize/4;i[I+0]=i[I+5]=i[I+10]=T,i[I+15]=i[I+20]=i[I+25]=T,i[I+1]=i[I+6]=i[I+11]=C,i[I+16]=i[I+21]=i[I+26]=C}else console.error("setVisibility skipping moving icon "+w.id)}b.renderer.releaseBuffer(b.id),b.forceRefresh()}),w.from({ease:0}),w.to({ease:1},h),w.onFinish(i),w.start()},o.prototype.getSlotWhereIconShouldFit=function(e){var t=e.cluster,i=this._iconsData.zIndexedIconClusters,n=i,o=n.indexOf(t);if(o===-1)return void console.error(new Error("[IconBatch.addIconToVertexBuffer] Icon cluster not present in ordered list"));var s=t.icons,a=s.indexOf(e);if(a===-1)return void console.error(new Error("[IconBatch.addIconToVertexBuffer] Icon not present in its cluster"));var r;if(a===s.length-1)if(o===i.length-1)if(0===o){if(!this._vertexBufferSlots.first)return null;r=this._vertexBufferSlots.first.object}else{var l=i[o-1].icons;r=l[l.length-1].vertexBufferSlot}else r=i[o+1].icons[0].vertexBufferSlot;else r=s[a+1].vertexBufferSlot;var c=e.vertexBufferSlot;return null!==e.vertexBufferSlot&&c.index<r.index&&(r=r.reference.previous.object),r},o.prototype.addIcon=function(e){if(null!==e.vertexBufferSlot)return void console.warn("[IconBatch.addIconToVertexBuffer] Trying to add an icon already present in the vertex buffer");var t,i,o=this.getSlotWhereIconShouldFit(e);if(null===o){var s=new n(e,0);s.reference=this._vertexBufferSlots.add(s),e.vertexBufferSlot=s,i=null,t=0}else{t=o.index;var a=new n(e,t);for(a.reference=this._vertexBufferSlots.addBefore(o.reference,a),e.vertexBufferSlot=a,i=o.reference;null!==i&&null!==i.icon;)i.object.index+=1,i=i.next}if(null===i){var r=this._floatView;this._createVertexBuffer();var l=t*this._iconByteSize/4,c=r.subarray(0,l),u=r.subarray(l);this._floatView.set(c,0),this._floatView.set(u,l+this._iconByteSize/4)}else{var d=t*this._iconByteSize/4,h=i.object.index*this._iconByteSize/4;this._vertexBufferSlots.removeByReference(i);var p=this._floatView.subarray(d,h);this._floatView.set(p,d+this._iconByteSize/4)}this._populateIconVertexBuffer(e,0),this.setVisibility([e],!0)},o.prototype.updateIconPosition=function(e){var t=e.vertexBufferSlot;if(null===t)return void console.error(new Error("[IconBatch.updateIconPosition] Given icon is not present in the vertex buffer"));var i=this.getSlotWhereIconShouldFit(e);if(t.index!==i.index){var n,o,s,a,r,l=t.index*this._iconByteSize/4,c=l+this._iconByteSize/4,u=new window.Float32Array(this._floatView.subarray(l,c));if(t.index<i.index)for(n=c,o=i.index*this._iconByteSize/4+this._iconByteSize/4,this._floatView.set(this._floatView.subarray(n,o),l),r=t.reference;null!==r&&r.object!==i;)s=r.object,r=r.next,a=r.object.icon,a&&(a.vertexBufferSlot=s),s.icon=a;else for(n=i.index*this._iconByteSize/4,o=l,this._floatView.set(this._floatView.subarray(n,o),n+this._iconByteSize/4),r=t.reference;null!==r&&r.object!==i;)s=r.object,r=r.previous,a=r.object.icon,a&&(a.vertexBufferSlot=s),s.icon=a;i.icon=e,e.vertexBufferSlot=i,this._floatView.set(u,i.index*this._iconByteSize/4)}var d={},h=e.cluster;d[h.id]=h,this.setVisibility([],!0,null,d)},o.prototype.removeIcon=function(e){e.visible&&(e.visible=!1,this.setVisibility([e],!1,function(){e.visible===!1&&(e.vertexBufferSlot.icon=null,e.vertexBufferSlot=null)}))},o.prototype.render=function(){this.renderer.drawSpriteBatchAbsoluteScale(this.id,u*this.scene.pixelRatio)},o.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=this._floatView,n=this._texture,o=!1;this.renderer.loadSpriteBuffer(t,i,n,this._bbox,o),this.renderer.lockBuffer(this.id)}return this._bbox},o.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t){function i(e){var t=this,i=window.gui,n=i.GPS;this._lastWorld=null,this._worldMap=e,n.on("addPOI",function(e){t._worldMap.hasIcon(e.id)||(t._worldMap.isLoading()?t._worldMap.once("loaded",function(){t._worldMap.addIcon(e,e.iconId)}):t._worldMap.addIcon(e,e.iconId))}),n.on("removePOI",function(e){t._worldMap.hasIcon(e.id)&&t._worldMap.removeIcon(e.id)}),n.on("updatePOI",function(e){t._worldMap.hasIcon(e.id)&&(t._worldMap.removeIcon(e.id),t._worldMap.addIcon(e,e.iconId))})}e.exports=i,i.prototype.updatePois=function(){var e=window.gui,t=e.GPS,i=e.playerData.position.worldmapId;if(this._lastWorld!==i){var n=t.getPOIs(this._lastWorld);for(var o in n)this._worldMap.hasIcon(o)&&this._worldMap.removeIcon(o);n=t.getPOIs();for(o in n)if(!this._worldMap.hasIcon(o)){var s=n[o];this._worldMap.addIcon(s,s.iconId)}this._lastWorld=i}}},function(e,t,i){function n(e,t){this._prisms=e,this._worldMap=null,this._conquestUIList=t,this._worldMapLoaded=!1,this._isUiLoaded=!1,this._subareaToShow=null,this._deferredActionQueue=new m;var i=this;window.gui.on("PrismsListMessage",function(e){function t(){i._prisms.setPrisms(e.prisms),i._updateWorldMapIcons(),i.loadUILists()}i._worldMapLoaded?t():i._deferredActionQueue.enqueue(t)}),window.gui.on("PrismsListUpdateMessage",function(e){function t(){i._prisms.updatePrisms(e.prisms),i._updateWorldMapIcons(),i.loadUILists()}i._worldMapLoaded?t():i._deferredActionQueue.enqueue(t)})}var o=i(30),s=i(235),a=i(1013),r=i(449),l=i(533),c=i(258).playUiSound,u=i(523),d=i(252),h=i(29).getText,p=i(1125),m=i(1126);e.exports=n,n.prototype.clear=function(){this._worldMap=null,this._worldMapLoaded=!1,this._isUiLoaded=!1,this._subareaToShow=null,this._deferredActionQueue.clear(),this._prisms.clear()},n.prototype.setWorldMap=function(e){1===e._worldMapId&&(this._worldMap=e,this._worldMapLoaded=!0,this._deferredActionQueue.signal())},n.prototype.selectSubarea=function(e){if(!this._isUiLoaded)return void(this._subareaToShow=e);this._subareaToShow=null;var t=this._selectSublist("AllTerritories");t.selectItem(e)},n.prototype._selectSublist=function(e){return this._conquestUIList.selectItem(e).sublist},n.prototype._updateWorldMapIcons=function(){var e=this;this._prisms.forEachEmptyPrism(function(t){e._worldMap.removeIcon(t.subAreaId)}),this._prisms.forEachChangingActivePrism(function(t){var i=p.getIconInfo(t);e._worldMapLoaded?(e._worldMap.removeIcon(i.id),e._worldMap.addIcon(i,"icon_"+i.gfx)):console.error("map not loaded!")})},n.prototype.showConquestList=function(){this._conquestUIList.show()},n.prototype.hideConquestList=function(){this._conquestUIList.hide()},n.prototype._matchesSearchTerm=function(e,t){return!e||t.toLowerCase().indexOf(e.toLowerCase())!==-1},n.prototype.loadUILists=function(e){var t=this;o.getAllDataMap("SubAreas",function(i,n){if(i)return console.error("WorldMapWindow: getAllDataAreas error",i);t._conquestUIList.empty();var o=[{id:"AllTerritories",nameId:h("ui.pvp.conquestAllAreas")},{id:"Conquerable",nameId:h("ui.pvp.conquestCapturableAreas")},{id:"Normal",nameId:h("ui.prism.cartography.normal")},{id:"Weakened",nameId:h("ui.prism.cartography.weakened")},{id:"Vulnerable",nameId:h("ui.prism.cartography.vulnerable")}];o.forEach(function(e){t.addToList(t._conquestUIList,e)});var a=d.createStringCompareFunc(),u=new r(a),p=new r(a),m=new r(a),f=new r(a),g=new r(a);t._prisms.forEachPrism(function(e){var t=n[e.subAreaId];t&&u.add(t)}),t._prisms.forEachEmptyPrism(function(e){var t=n[e.subAreaId];t&&p.add(t)}),t._prisms.forEachPrism(function(e){var t=n[e.subAreaId];t&&m.add(t)},l.PRISM_STATE_NORMAL),t._prisms.forEachPrism(function(e){var t=n[e.subAreaId];t&&f.add(t)},l.PRISM_STATE_WEAKENED),t._prisms.forEachPrism(function(e){var t=n[e.subAreaId];t&&g.add(t)},l.PRISM_STATE_VULNERABLE),u.forEach(function(i){var n=new s("div",{className:"label",text:i.nameId});t._matchesSearchTerm(e,i.nameId)&&t._conquestUIList.items.AllTerritories.sublist.addItem(i.id,n,i)}),p.forEach(function(i){var n=new s("div",{className:"label",text:i.nameId});t._matchesSearchTerm(e,i.nameId)&&t._conquestUIList.items.Conquerable.sublist.addItem(i.id,n,i)}),m.forEach(function(i){var n=new s("div",{className:"label",text:i.nameId});t._matchesSearchTerm(e,i.nameId)&&t._conquestUIList.items.Normal.sublist.addItem(i.id,n,i)}),f.forEach(function(i){var n=new s("div",{className:"label",text:i.nameId});t._matchesSearchTerm(e,i.nameId)&&t._conquestUIList.items.Weakened.sublist.addItem(i.id,n,i)}),g.forEach(function(i){var n=new s("div",{className:"label",text:i.nameId});t._matchesSearchTerm(e,i.nameId)&&t._conquestUIList.items.Vulnerable.sublist.addItem(i.id,n,i)}),t._conquestUIList.removeAllListeners(),t._conquestUIList.on("activate",function(e){e.sublist.show(),c("TAB"),t._worldMap.clearSubAreaHighlights();for(var i in e.sublist.items){var n=e.sublist.items[i].data;t._highlightSubArea(n.id)}}),t._conquestUIList.on("deactivate",function(e){e.sublist.hide(),e.sublist.deactivate()}),t._isUiLoaded=!0,null!==t._subareaToShow&&t.selectSubarea(t._subareaToShow)})},n.prototype.addToList=function(e,t){var i=this,n=new s("div",{className:"label"});n.createChild("div",{className:"arrow"}),n.createChild("div",{className:"text",text:t.nameId});var o=e.addItem(t.id,n,t);o.sublist=o.appendChild(new a),o.sublist.addClassNames("tree"),o.sublist.hide(),o.sublist.on("activate",function(e){var t=e.data.id;i._worldMap.clearSubAreaHighlights(t),i._highlightSubArea(t),i._worldMap.centerOnSubArea(t)}),o.sublist.on("deactivate",function(e){i._worldMap.removeSubAreaHighlight(e.data.id)})},n.prototype._highlightSubArea=function(e){var t=u.entities.prism[e];if(t&&t.prism){var i=t.getAlliance(),n=d.hexToRgb(i.allianceEmblem.backgroundColor.toString(16));this._worldMap.addSubAreaHighlight(e,[n[0]/255,n[1]/255,n[2]/255,.5])}else this._worldMap.addSubAreaHighlight(e,[1,0,0,.25])},n.prototype.search=function(e){this.loadUILists(e)}},function(e,t,i){function n(e,t){return function(){var i=new l(e.prism.nextVulnerabilityDate);return t+" "+s(i.getServerDate().date)}}function o(e,t){return function(){var i=new Date;i.setTime(1e3*e.prism.nextVulnerabilityDate);var n={month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"};return t+" "+i.toLocaleString(window.Config.language,n)}}function s(e){return e.getUTCHours().toString()+":"+a(e.getUTCMinutes().toString())+":"+a(e.getUTCSeconds().toString())}function a(e){return("0"+e).slice(-2)}var r=i(533),l=i(28).DofusDate,c=i(29).getText,u=436,d=421,h=420;t.getIconInfo=function(e){var t,i,s,a=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_INVULNERABLE)),l=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_ATTACKED)),p=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_FIGHTING)),m=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_NORMAL)),f=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_WEAKENED)),g=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_VULNERABLE)),_=c("ui.prism.prismInState",c("ui.prism.state"+r.PRISM_STATE_DEFEATED)),v=c("ui.prism.startVulnerability")+c("ui.common.colon"),y=c("ui.prism.vulnerabilityHour");switch(e.prism.state){case r.PRISM_STATE_INVULNERABLE:t=h,i=a+"\n"+y,s=n(e,i);break;case r.PRISM_STATE_NORMAL:t=h,i=m+"\n"+y,s=n(e,i);break;case r.PRISM_STATE_ATTACKED:t=h,i=l+"\n"+y,s=n(e,i);break;case r.PRISM_STATE_FIGHTING:t=h,i=p+"\n"+y,s=n(e,i);break;case r.PRISM_STATE_WEAKENED:t=d,i=f+"\n"+v,s=o(e,i);break;case r.PRISM_STATE_VULNERABLE:t=u,i=g,s=function(e){return function(){return e}}(i);break;case r.PRISM_STATE_DEFEATED:t=u,i=_,s=function(e){return function(){return e}}(i);break;default:t=u,i=_,s=function(e){return function(){return e}}(i)}return{id:"prisms_"+e.subAreaId,x:e.worldX,y:e.worldY,subAreaId:e.subAreaId,categoryId:"prisms",gfx:t,nameIdOverRideFunc:s}}},function(e,t){function i(){this._queue=[],this._isProcessing=!1}e.exports=i,i.prototype.enqueue=function(e){this._queue.push(e)},i.prototype.signal=function(){if(!this._isProcessing){for(this._isProcessing=!0;this._queue.length;){var e=this._queue.shift();e()}this._isProcessing=!1}},i.prototype.hasActions=function(){return this._queue.length>0},i.prototype.clear=function(){this._isProcessing&&console.error(new Error("DeferredActionQueue.clear during signal")),this._queue.length=0,this._isProcessing=!1}},function(e,t){function i(){this.clear()}e.exports=i,i.prototype.clear=function(){this._prisms={},this._emptyPrisms={},this._activePrisms={},this._changingPrisms={}},i.prototype.setPrisms=function(e){this._changingPrisms=e;for(var t=Object.keys(e),i=0;i<t.length;i++){var n=e[t[i]];this._prisms[n.subAreaId]=n,"PrismGeolocalizedInformation"===n._type?this._activePrisms[n.subAreaId]=n:this._emptyPrisms[n.subAreaId]=n}},i.prototype.updatePrisms=function(e){this._changingPrisms={};for(var t=Object.keys(e),i=0;i<t.length;i++){var n=e[t[i]],o=n.subAreaId,s=this._prisms[n.subAreaId];"PrismGeolocalizedInformation"===n._type?((!s||s.mapId!==n.mapId||s.worldX!==n.worldX||s.worldY!==n.worldY||s.subAreaId!==n.subAreaId||s.prism.state!==n.prism.state||s.prism.alliance&&n.prism.alliance&&s.prism.alliance.allianceTag!==n.prism.alliance.allianceTag)&&(this._changingPrisms[n.subAreaId]=n),this._activePrisms[o]=n,delete this._emptyPrisms[o]):(this._emptyPrisms[o]=n,delete this._activePrisms[o]),this._prisms[n.subAreaId]=n}},i.prototype.forEachChangingActivePrism=function(e){for(var t=Object.keys(this._changingPrisms),i=0;i<t.length;i++){
var n=this._changingPrisms[t[i]];this._activePrisms[n.subAreaId]&&e(n)}},i.prototype.forEachPrism=function(e,t){for(var i=Object.keys(this._prisms),n=0;n<i.length;n++){var o=this._prisms[i[n]];o.prism&&(null!==t&&void 0!==t&&o.prism.state!==t||e(this._prisms[i[n]]))}},i.prototype.forEachEmptyPrism=function(e){for(var t=Object.keys(this._emptyPrisms),i=0;i<t.length;i++)e(this._emptyPrisms[t[i]])}},function(e,t,i){function n(){this._deferredActionQueue=new a,this._taxCollectors=null,this._worldmap=null,s.on("taxCollectorList",this.onTaxCollectorsList.bind(this))}function o(e,t){if(!t)return!1;for(var i=e.complements||[],n=0;n<i.length;n+=1){var o=i[n];if("TaxCollectorGuildInformations"===o._type&&o.guild.guildId!==t.guildId)return!1}return!0}var s=i(523),a=i(1126),r=i(29).getText;e.exports=n,n.prototype.onTaxCollectorsList=function(){function e(){t._taxCollectors=s.entities[s.entityType.taxCollector];for(var e in t._taxCollectors){var i=t._taxCollectors[e];if(o(i,window.gui.playerData.guild.current)){var n=t.getIconInfo(i);t._worldmap.addIcon(n,"icon_"+n.gfx)}}}var t=this;this._worldmap?e():this._deferredActionQueue.enqueue(e)},n.prototype.setWorldMap=function(e){this._worldmap=e,this._deferredActionQueue.signal()},n.prototype.getIconInfo=function(e){return{id:"tax_"+e.worldX+"_"+e.worldY,x:e.worldX,y:e.worldY,subAreaId:e.subAreaId,categoryId:7,gfx:"1003",nameId:r("ui.common.taxCollector")}}},function(e,t,i){function n(){s.call(this,{window:{className:"SocialWindow",positionInfo:{top:40,left:80,right:40,bottom:40}}}),this.addTab("friends",new u,a("ui.common.friends")),this.addTab("guild",new d,a("ui.common.guild")),this.addTab("alliance",new l,a("ui.common.alliance")),this.addTab("spouse",new h,a("ui.common.spouse",0)),this.addTab("directory",new p,a("ui.common.directory")),this.closedWithGuildFightLeaveRequest=!1,this.on("open",function(e){this.openTab(e.tabId,e.tabParams,{delayOpenedEvent:!0,forceOpen:!0})}),this.on("close",function(){var e,t=window.gui.playerData.id;e=r.isPlayerDefending(r.entityType.taxCollector,t),e&&r.playerAutoKick(r.entityType.taxCollector,e),e=r.isPlayerDefending(r.entityType.prism,t),e&&r.playerAutoKick(r.entityType.prism,e)}),f.on("gameContextChanged",this.onGameContextChanged.bind(this)),this._setupEvents()}i(1130);var o=i(191).inherits,s=i(990),a=i(29).getText,r=i(523),l=i(1131),c=i(1057),u=i(1142),d=i(1144),h=i(1160),p=i(1162),m=i(225),f=i(269);o(n,s),e.exports=n,n.prototype.onGameContextChanged=function(){f.isFightMode&&m.close(this.id)},n.prototype._setupEvents=function(){var e=this,t=window.dofus.connectionManager;t.on("ClientUIOpenedMessage",function(t){e._clientUiOpen(t.type)}),t.on("ClientUIOpenedByObjectMessage",function(t){e._clientUiOpen(t.type)})},n.prototype._clientUiOpen=function(e){if(window.gui.playerData.guild.hasGuild()){var t;switch(e){case c.CLIENT_UI_TELEPORT_GUILD_PADDOCK:t="paddocks";break;case c.CLIENT_UI_TELEPORT_GUILD_HOUSE:t="houses";break;default:return}this.openState?(this.openTab("guild",{tabId:t}),m.focusWindow(this.id)):m.open(this.id,{tabId:"guild",tabParams:{tabId:t}})}}},function(e,t){},function(e,t,i){function n(){l.call(this,"div",{className:"AllianceTab",name:"alliance"});var e=this;this.once("open",function(){this._createDom(),window.gui.playerData.alliance.on("allianceUpdated",function(t){e._updateAllianceInformation();var i=e.tabs.tabMap;for(var n in i)i[n].content.emit("allianceUpdated",t)})}),this.on("open",function(e){e=e||{};var t=e.tabId||"guilds";this.tabs.openTab(t),this._guilds.emit("allianceUpdateRequested"),window.dofus.sendMessage("AllianceInsiderInfoRequestMessage"),window.dofus.sendMessage("PrismsListRegisterMessage",{listen:d.PRISM_LISTEN_MINE})}),this.on("close",function(){this.tabs.close()})}i(1132);var o=i(630),s=i(191).inherits,a=i(29).getText,r=i(611),l=i(235),c=i(469),u=i(28).DofusDate,d=i(1133),h=i(228),p=i(225),m=i(1134),f=i(1136),g=i(1138);s(n,l),e.exports=n,n.prototype._updateAllianceInformation=function(){var e=window.gui.playerData.alliance.current;this._updateAllianceCreationData(e),this.emblem.setValue(e.allianceEmblem,!0);var t=p.getWindow("social");t.setTitle(a("ui.common.alliance")+" - "+e.allianceName),this.tag.setText("["+e.allianceTag+"]"),this.members.setText(a("ui.alliance.membersInGuilds",e.nbMembers,e.guildCount,e.guildCount))},n.prototype._updateAllianceCreationData=function(e){var t=new u(e.creationDate).getServerDate().toString(!1);this.creationDate.setText(t.date)},n.prototype._createDom=function(){this._buildHeader(),this._buildTabs()},n.prototype._buildHeader=function(){var e=this.createChild("div",{className:"description"}),t=e.createChild("div",{className:["column","title"]}),i=e.createChild("div",{className:["column","content"]}),n=e.createChild("div",{className:["column","emblem"]});this.emblem=n.appendChild(new c({width:70,height:70})),t.createChild("div",{text:a("ui.alliance.tag")+":"}),this.tag=i.createChild("div",{className:"link"}),h(this.tag),this.tag.on("tap",function(){o.openAllianceCard(window.gui.playerData.alliance.current.allianceId)}),t.createChild("div",{text:a("ui.common.creationDate")+":"}),this.creationDate=i.createChild("div"),t.createChild("div",{text:a("ui.common.members")+":"}),this.members=i.createChild("div")},n.prototype._buildTabs=function(){var e=this.tabs=this.appendChild(new r);this._guilds=new m,e.addTab(a("ui.social.guilds"),this._guilds,"guilds"),e.addTab(a("ui.common.conquest"),new f,"conquests"),e.addTab(a("ui.common.attacks"),new g,"attacks")}},function(e,t){},function(e,t){e.exports={PRISM_LISTEN_NONE:0,PRISM_LISTEN_MINE:1,PRISM_LISTEN_ALL:2}},function(e,t,i){function n(){_.call(this,"div",{className:"GuildsTab"}),this._createDom(),this.on("allianceUpdated",function(e){this.table.clearContent(),this.table.addList(e.guilds),this.table.setContentLoading(!1)}),this.on("allianceUpdateRequested",function(){this.table.setContentLoading(!0)});var e=this;window.gui.playerData.alliance.on("guildLeft",function(t){e.table.delRow(t)}),this.on("open",function(){this._updateAvaMode()})}function o(e,t,i){var n=new g({className:"kick"},function(){if(t.allianceLeader&&e.guildCount>1)return window.gui.openSimplePopup(d("ui.alliance.guildLeaderCantBeBanned"));var n=i?d("ui.alliance.quitConfirm"):d("ui.alliance.kickConfirm",t.guildName);window.gui.openConfirmPopup({title:d("ui.popup.warning"),message:n,cb:function(e){e&&window.dofus.sendMessage("AllianceKickRequestMessage",{kickedId:t.guildId})}})});return l(n,d("ui.alliance.kickGuild")),n}function s(e){var t=new g({className:"leader"},function(){window.gui.openConfirmPopup({title:d("ui.popup.warning"),message:d("ui.alliance.giveLeadershipConfirm",e.guildName),cb:function(t){t&&window.dofus.sendMessage("AllianceChangeGuildRightsMessage",{guildId:e.guildId,rights:r.ALLIANCE_RIGHT_BOSS})}})});return l(t,d("ui.alliance.giveLeadership")),t}i(1135);var a=i(522),r=i(536),l=i(248).addTooltip,c=i(676),u=i(469),d=i(29).getText,h=i(526),p=i(191).inherits,m=i(593),f=i(228),g=i(246),_=i(235);p(n,_),e.exports=n,n.prototype._updateAvaMode=function(){var e=window.gui.playerData.characterBaseInformations,t=!1;if(e.level>=50){this.avaMode.enable();var i=window.gui.playerData.characters.mainCharacter.characteristics.alignmentInfos.aggressable;t=i===a.AvA_ENABLED_AGGRESSABLE||i===a.AvA_ENABLED_NON_AGGRESSABLE||i===a.AvA_DISQUALIFIED||i===a.AvA_PREQUALIFIED_AGGRESSABLE;var n=this.avaMode.isActivate();n!==t&&this.avaMode.toggleActivation(t)}else this.avaMode.disable()},n.prototype._createDom=function(){function e(e){var t=new _("div",{className:"nameBox"}),i=t.createChild("div",{text:e.guildName,className:"link"});f(i),i.on("tap",function(){h.openGuildCard(e.guildId)});var n=t.createChild("div");return f(n),n.on("tap",function(){window.gui.openContextualMenu("player",{playerName:e.leaderName,playerId:e.leaderId,hasGuild:!0})}),n.createChild("span",{text:d("ui.guild.leadBy","")}),n.createChild("span",{text:e.leaderName,className:"link"}),t}function t(e){var t=new _("div",{className:"memberBox"}),i=t.createChild("div",{text:d("ui.guild.onlineMembers",e.nbConnectedMembers,e.nbMembers)});if(0===e.nbConnectedMembers&&e.lastActivity>0){var n,o=e.getHoursSinceLastConnection(),s=Math.floor(o/720),a=Math.floor((o-720*s)/24);n=s>0?a>0?d("ui.social.monthsAndDaysSinceLastConnection",s,a,a):d("ui.social.monthsSinceLastConnection",s,s):a>0?d("ui.social.daysSinceLastConnection",a,a):d("ui.social.lessThanADay"),l(i,d("ui.social.lastConnection",n))}return t.createChild("div",{text:e.nbTaxCollectors+" "+d("ui.social.guildTaxCollectors")}),t}function i(e){var t,i=e.leaderId===g;return p?(t=new _("div",{className:"buttonBox"}),t.appendChild(o(r,e,i)),i||t.appendChild(s(e))):i?(t=new _("div",{className:"buttonBox"}),t.appendChild(o(r,e,!0))):t="",t}function n(e){var t=new u({width:50,height:50});return t.setValue({guild:e}),t}var a=window.gui.playerData,r=a.alliance.current,p=a.alliance.isBoss(),g=a.id;this.table=this.appendChild(new m([{id:"emblem",format:n},{id:"guildName",header:d("ui.common.name"),format:e,defaultSorter:!0,sort:!0},{id:"guildLevel",header:d("ui.common.level"),sort:!0},{id:"nbMembers",header:d("ui.common.members"),format:t,sort:!0},{id:"actions",format:i}],"guildId",{clickable:!1})),this.avaMode=this.appendChild(new c(d("ui.alliance.activateAvA"))),this.avaMode.on("change",function(e){window.dofus.sendMessage("SetEnableAVARequestMessage",{enable:e})})}},function(e,t){},function(e,t,i){function n(){g.call(this,"div",{className:"ConquestsTab"}),this.once("open",function(){this._createDom(),this._setupEvents(),this._updateConquests()})}function o(e,t){var i=new f({className:"settings"},function(){m.open("prismVulnerabilityDate",{prism:e,vulnerableTime:t})});return s(i,null,l("ui.prism.changeVulnerabilityHour")),i}i(1137);var s=i(248).addTooltip,a=i(630),r=i(526),l=i(29).getText,c=i(526).GuildRightsBitEnum,u=i(191).inherits,d=i(533),h=i(593),p=i(28),m=i(225),f=i(246),g=i(235);u(n,g),e.exports=n,n.prototype._setupEvents=function(){function e(){var e=window.gui.playerData.position.subAreaId;t.table.hasRow(e)?t.table.selectRow(e):t.table.unSelectRow()}var t=this;this.on("open",e);var i=window.gui.playerData.alliance;i.on("prismUpdatedList",function(i){t.table.updateRows(i),t._updateConquests(),e()}),i.on("prismDeletedList",function(i){t.table.delRows(i),t._updateConquests(),e()}),this.on("allianceUpdated",function(t){this.table.clearContent(),this.table.addMap(t.prisms),this._updateConquests(),this.table.setContentLoading(!1),e()}),this.on("allianceUpdateRequested",function(){this.table.setContentLoading(!0)}),this.table.addMap(i.current.prisms),e()},n.prototype._createDom=function(){function e(e){var t,i=e.prism,a=new p.DofusDate(i.nextVulnerabilityDate),u=a.getServerDate(),h=u.toString().time,m=n.guild.hasRight(c.GUILD_RIGHT_SET_ALLIANCE_PRISM);if(i.state!==d.PRISM_STATE_INVULNERABLE&&i.state!==d.PRISM_STATE_NORMAL||!m)t=h;else{t=new g("div",{className:"timeSetting"});var f=t.createChild("div",{text:h}),_=r.guilds[i.lastTimeSlotModificationAuthorGuildId];_&&s(f,l("ui.prism.lastVulnerabilityChange",new p.DofusDate(i.lastTimeSlotModificationDate).getLocalDate().toString().date,i.lastTimeSlotModificationAuthorName,_.guildName)+"\n"+l("ui.prism.serverVulnerabilityHour")+" : "+h+"\n"+l("ui.prism.localVulnerabilityHour")+" : "+a.getLocalDate().toString().time),t.appendChild(o(e,a))}return t}function t(e){var t=e.prism,i=new g("div",{text:a.prismState[t.state]}),n=a.getPrismStateInfo(t.state,1e3*t.nextVulnerabilityDate-Date.now());return s(i,n),i}function i(e){var t=e.enrichData,i=new g("div",{text:t.subAreaName+" ("+t.areaName+")"});return s(i,l(t.isConquestVillage?"ui.zaap.village":"ui.zaap.prism")),i}this.conquestsInfo=this.createChild("div",{className:"conquestsInfo"});var n=window.gui.playerData;this.table=this.appendChild(new h([{id:"subArea",header:l("ui.map.subarea"),format:i,getContent:function(e){return e.enrichData.subAreaName},sort:!0,defaultSorter:!0},{id:"worldX",header:l("ui.common.coordinatesSmall"),format:function(e){return e.worldX+","+e.worldY},sort:!0},{id:"placementDate",header:l("ui.social.guild.taxStartDate"),format:function(e){return new p.DofusDate(e.prism.placementDate).getServerDate().toString().date},getContent:function(e){return e.prism.placementDate},sort:!0},{id:"state",header:l("ui.common.state"),format:t,getContent:function(e){return e.prism.state},sort:!0},{id:"nextVulnerabilityDate",header:l("ui.prism.startVulnerability"),format:e,getContent:function(e){return e.prism.nextVulnerabilityDate},sort:!0}],"subAreaId",{clickable:!1}))},n.prototype._updateConquests=function(){var e=window.gui.playerData,t=e.alliance.current.prisms,i=0,n=0;for(var o in t){var s=t[o];s.mapId<=-1||(s.enrichData.isConquestVillage?n+=1:i+=1)}0===i&&0===n?this.conquestsInfo.setText(l("ui.alliance.noArea")):i>0&&0===n?this.conquestsInfo.setText(l("ui.alliance.nbAreas",i,i)):0===i&&n>0?this.conquestsInfo.setText(l("ui.alliance.nbVillages",n,n)):this.conquestsInfo.setText(l("ui.alliance.nbAreasAndVillages",i,n,n+i))}},function(e,t){},function(e,t,i){function n(){v.call(this,"div",{className:"AttacksTab"}),this.once("open",function(){this._createDom(),this._setupEvents()}),this.on("open",function(){this._loadCurrentPrismFight(),this._updateFightCount(),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:p.INFO_TAX_COLLECTOR_ALLIANCE})}),this.on("close",function(){this.table.clearContent(),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:p.INFO_TAX_COLLECTOR_LEAVE})})}function o(e){var t=e.remainSeconds,i=e.totalWaitTime,n=i-t;e.setValue(n/i)}function s(e){clearInterval(e.intervalId),e.intervalId=null}function a(e,t){e.totalWaitTime=Math.round(t.waitTimeForPlacement/10)||1,e.remainSeconds=Math.round(t.timeLeftBeforeFight/10)||0,e.intervalId=setInterval(function(){e.remainSeconds-=1,e.remainSeconds>0?o(e):s(e)},1e3),o(e)}function r(e){var t;if(e.type===y.prism){var i=d.getAttackedEntity(e),n=i.enrichData;t=n.isConquestVillage?"village":"prism"}else t=e.type;return new v("div",{className:["type",t]})}function l(e){var t=d.getAttackedEntity(e),i=t.enrichData,n=new v("div",{className:"target"});return n.createChild("div",{text:t.getName()}),n.createChild("div",{text:i.subAreaName+" "+t.getPosition()}),e.type===y.prism?n.createChild("div",{text:h("ui.prism.placed",t.getPlacementDate())}):n.createChild("div",{className:"owner",text:h("ui.common.guild")+h("ui.common.colon")+t.getGuild().guildName}),n}function c(e){var t=new f({vertical:!0,className:["green","timer"]});return e.waitingForHelpInfo&&a(t,e.waitingForHelpInfo),t.on("destroy",function(){s(t)}),t}function u(e){var t=d.getAttackedEntity(e),i=new m;return i.setFight(e.type,e),t.look&&i.setTarget({id:e.id,entityLook:t.look,name:t.getName(),level:t.level}),i.on("slotTap",M[e.type]),i}i(1139);var d=i(523),h=i(29).getText,p=i(725),m=i(1140),f=i(605),g=i(191).inherits,_=i(593),v=i(235),y=d.entityType,b=d.fightingSide,w=d.fightState;g(n,v);var M={};M[y.prism]=function(e){var t=this.fight;if(t.state===d.fightState.waitingForHelp){var i=t.id,n=window.gui.playerData.id;d.isPlayerFightingFor(n,y.prism,i,b.allies)?e&&n===e.id&&window.dofus.sendMessage("PrismFightJoinLeaveRequestMessage",{subAreaId:i,join:!1}):e&&5===t.fighters[b.allies].length?window.dofus.sendMessage("PrismFightSwapRequestMessage",{subAreaId:i,targetId:e.id}):window.dofus.sendMessage("PrismFightJoinLeaveRequestMessage",{subAreaId:i,join:!0})}},M[y.taxCollector]=function(e){var t=this.fight;if(t.state===d.fightState.waitingForHelp){var i=t.id,n=window.gui.playerData.id;d.isPlayerFightingFor(n,y.taxCollector,i,b.allies)?e&&n===e.id&&window.dofus.sendMessage("GuildFightLeaveRequestMessage",{taxCollectorId:i,characterId:n}):e&&5===t.fighters[b.allies].length?window.dofus.sendMessage("GuildFightTakePlaceRequestMessage",{taxCollectorId:i,replacedCharacterId:e.id}):window.dofus.sendMessage("GuildFightJoinRequestMessage",{taxCollectorId:i})}},n.prototype._createDom=function(){this.table=this.appendChild(new _([{id:"type",format:r},{id:"target",header:h("ui.common.name")+" / "+h("ui.common.localisation"),format:l},{id:"timer",format:c},{id:"fightersInfo",header:h("ui.common.defenders")+" / "+h("ui.common.attackers"),format:u}],"id",{clickable:!1})),this.currentFights=this.createChild("div",{className:"currentFights"}),this.createChild("div",{className:"howTo",text:h("ui.alliance.howToDefend")})},n.prototype._updateFightCount=function(){var e=this.table.getRowCount();this.currentFights.setText(h("ui.alliance.currentFights",e,e))},n.prototype._loadCurrentPrismFight=function(){var e=d.fights.prism;for(var t in e){var i=e[t];i.state===w.waitingForHelp&&(this.table.hasRow(i.id)||this.table.addRow(i))}},n.prototype._setupEvents=function(){function e(e){t.isVisible()&&t.table.hasRow(e)&&(t.table.delRow(e),t._updateFightCount())}var t=this;d.on("fightStarted",function(e,i){t.isVisible()&&i.state===w.waitingForHelp&&(t.table.addRow(i),t._updateFightCount())}),d.on("fighting",function(t,i){e(i.id)}),d.on("fightEnded",function(t,i){e(i)}),d.on("fighterList",function(e,i,n,o){t.isVisible()&&t.table.hasRow(i)&&t.table.getCell(i,"fightersInfo").setFighters(n,o)}),d.on("fighterJoined",function(e,i,n,o,s){t.isVisible()&&t.table.hasRow(i)&&t.table.getCell(i,"fightersInfo").setFighter(n,o,s)}),d.on("fightTarget",function(e,i,n){t.isVisible()&&e===y.prism&&t.table.hasRow(i)&&t.table.getCell(i,"fightersInfo").setTarget({id:n.id,entityLook:n.look,name:n.getName(),level:n.level})}),d.on("fighterLeft",function(e,i,n,o,s){t.isVisible()&&t.table.hasRow(i)&&t.table.getCell(i,"fightersInfo").removeFighter(n,s)})},e.exports=n},function(e,t){},function(e,t,i){function n(){l.call(this,"div",{className:"FightersInfo"});var e,t=this.allies={},i=this.enemies={},n=this.createChild("div",{className:"fighterRow"}),o=this.createChild("div",{className:"fighterRow"});e=t.icon=n.createChild("div",{className:["fightMode","defend","hidden"]}),this._addFightModeToolTip(e,d("ui.common.defenders"),"allies"),e=i.icon=o.createChild("div",{className:["fightMode","attack","hidden"]}),this._addFightModeToolTip(e,d("ui.common.attackers"),"enemies");var s=t.slotContainer=n.createChild("div",{className:"fighterList"}),a=i.slotContainer=o.createChild("div",{className:"fighterList"});this.targetSlot=s.appendChild(this._createTargetDisplay());for(var r,c=t.slots=[],u=i.slots=[],h=0;h<m;h+=1)r=s.appendChild(this._createFighterSlot(!0)),c.push(r),r=a.appendChild(this._createFighterSlot()),u.push(r)}function o(e){var t=e.name+" ("+d("ui.common.short.level")+" "+e.level+") ";switch(e._type){case"CharacterMinimalAllianceInformations":t+=e.guild.guildName+" - ["+e.alliance.allianceTag+"]";break;case"CharacterMinimalGuildInformations":t+=e.guild.guildName}return t}function s(e,t){e.fighter=t,h.enableTooltip(e,!0),e.setLook(t.entityLook,{riderOnly:!0,direction:u.DIRECTION_SOUTH_WEST,animation:"AnimArtwork",boneType:"timeline/",skinType:"timeline/"})}function a(e){e.fighter=null,e.clear(),console.log("CLEARING SLOT!"),h.enableTooltip(e,!1)}i(1141);var r=i(191).inherits,l=i(235),c=i(415),u=i(457),d=i(29).getText,h=i(248),p=i(523).fightingSide,m=5;r(n,l),e.exports=n,n.prototype._addFightModeToolTip=function(e,t,i){var n=this;h.addTooltip(e,function(){var e=t+d("ui.common.colon")+"\n",s=n[i].slots;if("allies"===i){var a=n.targetSlot.fighter;e+=a.name+" ("+d("ui.common.short.level")+" "+a.level+")\n"}for(var r=0;r<s.length;r+=1){var c=s[r].fighter;c&&(e+=o(c)+"\n")}return new l("div",{text:e})})},n.prototype._createTargetDisplay=function(){var e=new c({className:"fighterIcon",scale:"fitin"});return h.addTooltip(e,function(){var t=e.fighter;return new l("div",{text:t.name+" ("+d("ui.common.short.level")+" "+t.level+")"})}),h.enableTooltip(e,!1),e},n.prototype._createFighterSlot=function(e){var t=new c({className:"fighterIcon",scale:"fitin"});if(h.addTooltip(t,function(){return new l("div",{text:o(t.fighter)})}),h.enableTooltip(t,!1),!e)return t;var i=this;return t.on("tap",function(){i.fight&&i.emit("slotTap",this.fighter)}),t},n.prototype.reset=function(){this.fight=null,this.allies.icon.addClassNames("hidden"),this.enemies.icon.addClassNames("hidden"),a(this.targetSlot);for(var e=this.allies.slots,t=this.enemies.slots,i=0;i<m;i+=1)a(e[i]),a(t[i])},n.prototype.setTarget=function(e){s(this.targetSlot,e)},n.prototype.setFight=function(e,t){this.type=e,this.fight=t,this.allies.icon.delClassNames("hidden"),this.enemies.icon.delClassNames("hidden");var i=t.fighters;this.setFighters(p.allies,i.allies),this.setFighters(p.enemies,i.enemies)},n.prototype.setFighter=function(e,t,i){s(this[e].slots[i],t)},n.prototype.removeFighter=function(e,t){var i=this[e].slots,n=i.splice(t,1)[0];a(n),this[e].slotContainer.appendChild(n),i.push(n)},n.prototype.setFighters=function(e,t){for(var i=this[e].slots,n=0;n<m;n+=1){var o=t[n];o?s(i[n],o):a(i[n])}}},function(e,t){},function(e,t,i){function n(){function e(e,t,i,n){window.gui.openConfirmPopup({title:h("ui.common.confirm"),message:h("tablet.ui.social.playerRemoveConfirmation",i),cb:function(i){i&&window.dofus.sendMessage(e,{accountId:t,session:n})}})}u.call(this,"div",{className:"FriendsWindow",name:"friends"});var t=this;this.ListAddFailureEnum={0:h("ui.common.unknownFail"),1:h("ui.social.friend.addFailureListFull"),2:h("ui.social.friend.addFailureNotFound"),3:h("ui.social.friend.addFailureEgocentric"),4:h("ui.social.friend.addFailureAlreadyInList")},this.tables={},this.tableParams={colIds:["playerIcon","name","level","guild","achievement","stateIcon","button"],headerContent:["",h("ui.common.name"),h("ui.common.level"),h("ui.common.guild"),h("ui.achievement.achievement")],onRowTap:function(){window.gui.tooltipBox.closeTooltip()}},this.deleteTapCallback={friends:function(t,i){e("FriendDeleteRequestMessage",t,i)},enemies:function(t,i){e("IgnoredDeleteRequestMessage",t,i,!1)},ignored:function(t,i){e("IgnoredDeleteRequestMessage",t,i,!0)}},this.once("open",function(){t._createDom(),t._setupEvents();var e=window.gui.playerData.socialData;for(var i in e.ignoredList)t.addPlayer(e.ignoredList[i],"ignored")}),this.on("open",function(e){e=e||{},t.tabs.openTab(e.tabId||0),t.tables.friends.clearContent(),t.tables.enemies.clearContent(),window.dofus.sendMessage("FriendsGetListMessage"),window.dofus.sendMessage("IgnoredGetListMessage")})}function o(e,t,i){var n=e.createChild("div",{className:"addCharacter"}),o=n.createChild("div",{text:h("ui.common.addSomeone"),className:"addLabel"}),s=n.appendChild(new p({text:h("ui.common.add"),className:["addButton","greenButton"]})),a=n.appendChild(new g({className:"addInput",attr:{type:"text"}}));return s.on("tap",function(){var e=a.rootElement.value;if(e){var n={name:e};i&&(n.session=i),window.dofus.sendMessage(t,n),a.rootElement.value=""}}),{addCharacterArea:n,label:o,textInput:a,button:s}}function s(e,t){if(e.showRows(),!t){for(var i=e.getRowCount(),n=[],o=0;o<i;o++){var s=e.getRow(o);s.isConnected||(s.hide(),n.push(o))}e.hideRows(n)}}function a(e,t){if(!e.hasOwnProperty("breed"))return console.error(new Error("Friends loadHeadImage: player has no breed")),void t.setStyle("backgroundImage",null);var i="gfx/heads/SmallHead_"+e.breed+(e.sex?1:0)+".png";_.preloadImage(i,function(e){t.rootElement&&t.setStyle("backgroundImage",e)})}function r(e){var t="FriendOnlineInformations"===e._type;return{isConnected:t,accountId:e.accountId,characterId:e.playerId,name:e.playerName||e.accountName,nameText:e.accountName+(e.playerName?" ("+e.playerName+")":""),lastConnection:e.lastConnection}}function l(){var e=this.myRow;e.isConnected?window.gui.openContextualMenu("player",{playerId:e.id,accountId:e.accountId,playerName:e.name}):window.gui.openContextualMenu("offlinePlayer",{playerId:e.id,playerName:e.name,hoursSinceLastConnection:e.lastConnection})}i(1143);var c=i(191).inherits,u=i(235),d=i(611),h=i(29).getText,p=i(246),m=i(735),f=i(676),g=i(582),_=i(202),v=i(195),y=i(702),b=i(472);c(n,u),e.exports=n,n.prototype._createDom=function(){var e=this.tabs=this.appendChild(new d);this.friendsPanel=this.createChild("div",{className:["mainPanel","friendsPanel"]}),this.enemiesPanel=this.createChild("div",{className:["mainPanel","enemiesPanel"]}),this.ignoredPanel=this.createChild("div",{className:["mainPanel","ignoredPanel"]}),e.addTab(h("ui.common.friends"),this.friendsPanel,"friends"),e.addTab(h("ui.common.enemies"),this.enemiesPanel,"enemies"),e.addTab(h("ui.common.ignoreds"),this.ignoredPanel,"ignoreds"),e.openTab(0),this._buildFriendsPanel(),this._buildEnemiesPanel(),this._buildIgnoredPanel()},n.prototype._buildFriendsPanel=function(){var e=this,t=this.friendsPanel;o(t,"FriendAddRequestMessage"),this.tables.friends=t.appendChild(new m(this.tableParams));var i=v.getValue("showFriendOffline",!0),n=t.createChild("div",{className:"checkBoxes"});this.showFriendOfflineCheckbox=n.appendChild(new f(h("ui.social.showOfflinePerson"),i));var a=n.appendChild(new f(h("ui.social.warnWhenFriendsComeOnline"),window.gui.playerData.socialData.onConnectNotification));this.showFriendOfflineCheckbox.on("change",function(t){s(e.tables.friends,t),v.setValue("showFriendOffline",t,1)}),a.on("change",function(e){window.dofus.sendMessage("FriendSetWarnOnConnectionMessage",{enable:e})})},n.prototype._buildEnemiesPanel=function(){var e=this,t=this.enemiesPanel;o(t,"IgnoredAddRequestMessage",!1),this.tables.enemies=t.appendChild(new m(this.tableParams));var i=v.getValue("showEnemyOffline",!0),n=t.createChild("div",{className:"checkBoxes"});this.showEnemyOfflineCheckbox=n.appendChild(new f(h("ui.social.showOfflinePerson"),i)),this.showEnemyOfflineCheckbox.on("change",function(t){s(e.tables.enemies,t),v.setValue("showEnemyOffline",t,1)})},n.prototype._buildIgnoredPanel=function(){o(this.ignoredPanel,"IgnoredAddRequestMessage",!0),this.tables.ignored=this.ignoredPanel.appendChild(new m(this.tableParams))},n.prototype._updateStateIcon=function(e,t){var i=e.getChild("stateIcon").getChild("stateIcon");if(i.delClassNames("offline","fight","smiley"),i.getStyle("backgroundImage")&&i.setStyle("backgroundImage",""),i.clearContent(),i.hide(),!e.isConnected)return i.addClassNames("offline"),void i.show();var n;if(t.hasOwnProperty("moodSmileyId")&&t.moodSmileyId>0){n=t.moodSmileyId;var o=window.gui.databases.Smileys[n];if(!o)return console.error("Smiley "+n+" details are not available, it could not be displayed");i.addClassNames("smiley"),_.preloadImage("gfx/smilies/"+o.gfxId+".png",function(e){i.rootElement&&(i.setStyle("backgroundImage",e),i.show())})}t.playerState===y.GAME_TYPE_FIGHT&&(n?i.appendChild(new u("div",{className:"smallFight"})):(i.addClassNames("fight"),i.show()))},n.prototype._updatePlayerRow=function(e,t){for(var i=this.tables[e],n=i.getRows(),o=0;o<n.length;o++){var s=n[o];if(s.accountId===t.accountId){i.updateRow(o,{level:t.level||"?",guild:t.guildInfo?t.guildInfo.guildName:"?",achievement:t.achievementPoints>0?t.achievementPoints:"-"},r(t));var l=s.isConnected;s.toggleClassName("offline",!l);var c=s.getChild("playerIcon").getChild("playerIcon");if(t.status){var u=c.getChild("onlineStatusIcon");u.setClassNames("onlineStatusIcon","status"+t.status.statusId)}var d=s.getChild("name").getChild("name");d.setText(s.nameText);var h=c.getChild("alignmentSide").getChild("headIcon");return l&&!h.getStyle("backgroundImage")&&a(t,h),void this._updateStateIcon(s,t)}}},n.prototype._setupEvents=function(){var e=this,t=window.gui.playerData.socialData;window.gui.on("disconnect",function(){e.tables.ignored.clearContent()}),t.on("friendUpdate",function(t){e._updatePlayerRow("friends",t);var i=v.getValue("showFriendOffline",!0);s(e.tables.friends,i)}),t.on("ignoredUpdate",function(t){e._updatePlayerRow("ignored",t)}),t.on("enemyUpdate",function(t){e._updatePlayerRow("enemies",t)}),t.on("newFriendList",function(){var i=t.friendsList;for(var n in i)e.addPlayer(i[n],"friends");var o=e.showFriendOfflineCheckbox;o.isActivate()?o.activate():o.deactivate()}),t.on("newEnemyList",function(){var i=t.enemiesList;for(var n in i)e.addPlayer(i[n],"enemies");var o=e.showEnemyOfflineCheckbox;o.isActivate()?o.activate():o.deactivate()}),t.on("friendAdded",function(t){e.addPlayer(t,"friends")}),t.on("ignoredAdded",function(t){e.addPlayer(t,"ignored")}),t.on("enemyAdded",function(t){e.addPlayer(t,"enemies")}),t.on("friendDeleted",function(t){e.deletePlayer(t,"friends")}),t.on("ignoredDeleted",function(t){e.deletePlayer(t,"ignored")}),t.on("enemyDeleted",function(t){e.deletePlayer(t,"enemies")})},n.prototype.addPlayer=function(e,t){var i=this,n=this.tables[t],o=e.guildInfo?e.guildInfo.guildName:"?",s=window.gui.playerData.alignment,c=new p({name:"deleteButton",className:"greenButton"});c.on("tap",function(){i.deleteTapCallback[t](this.accountId,this.playerName)}),c.accountId=e.accountId,c.playerName=e.playerName||e.accountName;var d=e.achievementPoints>0?e.achievementPoints:"-",h=new p({name:"playerIcon",className:"playerIcon"},l);h.createChild("div",{name:"onlineStatusIcon",className:["onlineStatusIcon",e.status?"status"+e.status.statusId:""]});var m=h.createChild("div",{name:"alignmentSide",className:"alignmentSide"});e.alignmentSide!==b.ALIGNMENT_ANGEL&&e.alignmentSide!==b.ALIGNMENT_EVIL||s.getSmallWingsUrl(e.alignmentSide,function(e){m.rootElement&&m.setStyle("backgroundImage",e)});var f=m.createChild("div",{className:"playerHead",name:"headIcon"}),g=new p({name:"name",text:" "},l),_=n.addRow({playerIcon:h,name:g,level:e.level?e.level:"?",guild:o,achievement:d,stateIcon:new u("div",{name:"stateIcon",className:"stateIcon"}),button:c},r(e));h.myRow=_,g.myRow=_,g.setText(_.nameText);var v=_.isConnected;_.toggleClassName("offline",!v),this._updateStateIcon(_,e),v&&a(e,f)},n.prototype.deletePlayer=function(e,t){var i=this.tables[t],n=i.getRows();e=parseInt(e,10);for(var o=0;o<n.length;o++)if(n[o].accountId===e)return i.delRow(o)}},function(e,t){},function(e,t,i){function n(){r.call(this,"div",{className:"GuildWindow",name:"guild"});var e=this;this.openedTabId=null,this.once("open",function(){e._setupDom(),e._setupEvents()}),this.on("open",function(t){t=t||{},window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:g.INFO_GENERAL}),this.openedTabId=t.tabId||"members",e.tabs.openTab(this.openedTabId,null,{forceOpen:!0})}),this.on("close",function(){this._resetTabs()})}i(1145);var o=i(191).inherits,s=i(29).getText,a=i(611),r=i(235),l=i(248).addTooltip,c=i(1146),u=i(1148),d=i(1150),h=i(1154),p=i(1156),m=i(605),f=i(469),g=i(725),_=i(252),v=i(225),y=i(28).DofusDate;o(n,r),e.exports=n,n.prototype._buildGuildGeneralInfoArea=function(){var e=this.createChild("div",{className:"guildGeneralInfo"}),t=e.createChild("div",{className:["column","title"]}),i=e.createChild("div",{className:["column","content"]}),n=e.createChild("div",{className:["column","emblem"]});this.emblem=n.appendChild(new f({width:70,height:70})),this.level=t.createChild("div"),t.createChild("div",{className:"member",text:s("ui.common.members")+":"}),t.createChild("div",{text:s("ui.common.creationDate")+":"}),this.levelBar=i.appendChild(new m({className:"yellow"})),l(this.levelBar,function(){var e=window.gui.playerData.guild.current,t=_.intToString(e.experience||0),i=_.intToString(e.expNextLevelFloor||0);return new r("div",{text:t+" / "+i})}),this.membersValue=i.createChild("div",{className:"memberValue"}),this.creationDateValue=i.createChild("div")},n.prototype._setupDom=function(){function e(){window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:this.id})}this._buildGuildGeneralInfoArea(),this.tabs=this.appendChild(new a);var t=new c({className:"panel"}),i=new d,n=new p,o=new h({className:"panel"}),r=new u;t.id=g.INFO_MEMBERS,n.id=g.INFO_TAX_COLLECTOR_GUILD_ONLY,o.id=g.INFO_PADDOCKS,r.id=g.INFO_HOUSES,this.tabs.addTab(s("ui.common.members"),t,"members"),this.tabs.addTab(s("tablet.social.announcements"),i,"customisation"),this.tabs.addTab(s("ui.social.guildTaxCollectors"),n,"perceptors"),this.tabs.addTab(s("ui.common.mountPark"),o,"paddocks"),this.tabs.addTab(s("ui.common.housesWord"),r,"houses"),t.on("open",e),o.on("open",e),
r.on("open",e)},n.prototype._setupEvents=function(){var e=this,t=window.gui.playerData.guild;t.on("guildMemberCountUpdate",function(){e.isVisible()&&e.membersValue.setText(t.current.nbConnectedMembers+" / "+t.current.nbMembers)}),t.on("GuildGeneralInformationUpdate",function(){e.isVisible()&&(e._updateEmblemLogoAndWindowTitle(),e._updateTabNotification())})},n.prototype._resetTabs=function(){null!==this.openedTabId&&(this.openedTabId=null,this.tabs.close()),this._updateTabNotification(!0)},n.prototype._updateTabNotification=function(e){var t=window.gui.playerData.guild.current,i=!e&&!!t.abandonnedPaddock;this.tabs.toggleTabNotification("paddocks",i)},n.prototype._updateGuildCreationData=function(){var e=new y(window.gui.playerData.guild.current.creationDate).getServerDate().toString(!1);this.creationDateValue.setText(e.date)},n.prototype._updateEmblemLogoAndWindowTitle=function(){var e=window.gui.playerData.guild.current,t=e.guildEmblem,i=v.getWindow("social");i.setTitle(s("ui.common.guild")+" - "+e.guildName),this.level.setText(s("ui.common.rank",e.level)),this.levelBar.setValue(e.experiencePercentage),this.membersValue.setText(e.nbConnectedMembers+" / "+e.nbMembers),this._updateGuildCreationData(),this.emblem.setValue(t,!0)}},function(e,t){},function(e,t,i){function n(e,t){return e.name<t.name?-1:1}function o(e,t){return e.rankValue<t.rankValue?-1:1}function s(e,t){return e.hoursSinceLastConnection<t.hoursSinceLastConnection?-1:1}function a(e){e=e||{},r.call(this,"div",{className:"GuildMembers"}),this.addClassNames(e.className),this.once("open",function(){this._setupDom(),this._setupSocketEvents()})}i(1147);var r=i(235),l=i(191).inherits,c=i(593),u=i(29).getText,d=i(246),h=i(225),p=i(676),m=i(702),f=i(526).GuildRightsBitEnum,g=i(202),_=i(472),v=i(195),y={};y[m.NOT_CONNECTED]="offline",y[m.GAME_TYPE_ROLEPLAY]="online",y[m.GAME_TYPE_FIGHT]="online",y[m.UNKNOWN_STATE]="offline";var b=720;l(a,r),e.exports=a,a.prototype._setupDom=function(){var e=this,t=[{id:"playerIcon",sort:s},{id:"nameButton",header:u("ui.common.name"),sort:n},{id:"rankName",header:u("ui.pvp.rank"),sort:o},{id:"level",header:u("ui.common.short.level"),sort:!0},{id:"xpPercentage",header:"%"+u("ui.common.xp"),sort:!0},{id:"xp",header:u("ui.common.xp"),sort:!0},{id:"achievement",header:u("ui.achievement.achievement"),sort:!0},{id:"stateIcon",sort:s},{id:"buttons"}];this.table=this.appendChild(new c(t,null,{clickable:!1})),this.table.addFilter(function(t){return!!e.showOfflineCheckbox.isActivate()||"online"===t.onlineStatus});var i=window.gui.playerData.guild.current.warnMemberOnConnectionState,a=v.getValue("showGuildMembersOffline",!1),r=this.createChild("div",{className:"underTable"});this.showOfflineCheckbox=r.appendChild(new p(u("ui.social.displayOfflineGuildMembers"),a));var l=r.appendChild(new p(u("ui.social.warnWhenGuildMembersComeOnline"),i));this.averageLevel=r.createChild("div",{className:"averageLevel"}),this.showOfflineCheckbox.on("change",function(t){e.table.filter(),v.setValue("showGuildMembersOffline",t)}),l.on("change",function(e){window.dofus.sendMessage("GuildMemberSetWarnOnConnectionMessage",{enable:e}),window.gui.playerData.guild.current.warnMemberOnConnectionState=e})},a.prototype._setupSocketEvents=function(){var e=this;window.gui.playerData.guild.on("guildMember",function(t){e.isVisible()&&e._updateMembersList(t)}),window.gui.playerData.guild.on("guildMemberStatusUpdate",function(t){if(e.isVisible()){var i=e.table.getCell(t.id,"playerIcon"),n=i.getChild("onlineStatusIcon");n.setClassNames("onlineStatusIcon","status"+t.status.statusId)}})},a.prototype._updateMembersList=function(e){function t(){h.open("guildMemberRights",this.memberInfo)}function i(){var e=this.memberInfo.id,t=1===Object.keys(a.members).length;if(e===a.leaderId&&!t)return window.gui.openSimplePopup(u("ui.social.guildBossCantBeBann"),u("ui.popup.warning"));var i=l===e?u("ui.social.doUDeleteYou"):u("ui.social.doUDeleteMember",this.memberInfo.name);window.gui.openConfirmPopup({title:u("ui.popup.warning"),message:i,cb:function(t){t&&window.dofus.sendMessage("GuildKickRequestMessage",{kickedId:e})}})}function n(){this.connected?window.gui.openContextualMenu("player",{playerId:this.id,accountId:this.accountId,playerName:this.name}):window.gui.openContextualMenu("offlinePlayer",{playerId:this.id,playerName:this.name,hoursSinceLastConnection:this.hoursSinceLastConnection})}function o(e,t){c.getSmallWingsUrl(t,function(t){e.rootElement&&e.setStyle("backgroundImage",t)})}var s=window.gui.playerData.guild,a=s.current,l=window.gui.playerData.id,c=window.gui.playerData.alignment,p=l===a.leaderId,m=[],v=[],w=[],M=[];this.table.clearContent(),this.averageLevel.setText(u("ui.social.guildAvgMembersLevel")+": "+a.averageMemberLevel);for(var T=p||s.hasRight(f.GUILD_RIGHT_BOSS)||s.hasRight(f.GUILD_RIGHT_MANAGE_GUILD_BOOSTS)||s.hasRight(f.GUILD_RIGHT_MANAGE_RIGHTS)||s.hasRight(f.GUILD_RIGHT_MANAGE_XP_CONTRIBUTION)||s.hasRight(f.GUILD_RIGHT_MANAGE_RANKS),C=s.checkRight(f.GUILD_RIGHT_BOSS,a.members[l].rights),I=window.gui.databases.RankNames,A=0,S=e.length;A<S;A++){var E=e[A],x=y[E.connected],L=new r("div",{className:"buttons"}),N=l===e[A].id;(N||T||C)&&(L.appendChild(new d({className:["boxSizing","rowButton","rights"]},t)).memberInfo={id:E.id,name:E.name,level:E.level,rank:E.rank,experienceGivenPercent:E.experienceGivenPercent,rights:E.rights}),(N||p||C||s.hasRight(f.GUILD_RIGHT_BAN_MEMBERS))&&(L.appendChild(new d({className:["boxSizing","rowButton","deletion"]},i)).memberInfo={id:E.id,name:E.name});var O=new d({className:"playerIcon",scaleOnPress:!1},n);O.createChild("div",{name:"onlineStatusIcon",className:["onlineStatusIcon","status"+E.status.statusId]});var D=O.createChild("div",{className:"alignmentSide"});E.alignmentSide!==_.ALIGNMENT_ANGEL&&E.alignmentSide!==_.ALIGNMENT_EVIL||o(D,E.alignmentSide),m.push(D.createChild("div",{className:"playerHead"})),v.push("gfx/heads/SmallHead_"+E.breed+(E.sex?1:0)+".png"),O.id=E.id,O.name=E.name,O.accountId=E.accountId,O.isMySelf=N,O.connected=E.connected,O.hoursSinceLastConnection=E.hoursSinceLastConnection;var R=new d({className:"nameButton",text:E.name,scaleOnPress:!1},n);R.id=E.id,R.name=E.name,R.accountId=E.accountId,R.isMySelf=N,R.connected=E.connected,R.hoursSinceLastConnection=E.hoursSinceLastConnection;var P={playerIcon:O,nameButton:R,name:E.name,rankName:I[E.rank].nameId,rankValue:E.rank,level:E.level,xpPercentage:E.experienceGivenPercent+"%",xp:E.givenExperience,achievement:E.achievementPoints,buttons:L,onlineStatus:x,hoursSinceLastConnection:"offline"===x?E.hoursSinceLastConnection:-1};if("offline"===x)if(E.hoursSinceLastConnection>=b){var B=u("ui.common.inactive")+"<br/>",k=Math.floor(E.hoursSinceLastConnection/b);B+=u("ui.social.monthsSinceLastConnection",k,k),P.stateIcon=new r("div",{className:["text"]}),P.stateIcon.setHtml(B)}else P.stateIcon=new r("div",{className:["stateIcon","offline"]});else if(E.hasOwnProperty("moodSmileyId")&&E.moodSmileyId>0){var F=E.moodSmileyId,z=window.gui.databases.Smileys[F];z?(P.stateIcon=new r("div",{className:["stateIcon","smiley"]}),w.push(P.stateIcon),M.push("gfx/smilies/"+z.gfxId+".png")):console.error("Smiley "+F+" details are not available, it could not be displayed")}this.table.addRow(P,E.id).addClassNames(x)}this.table.filter(),g.preloadImages(v,function(e){for(var t=0,i=e.length;t<i;t++){var n=m[t];n&&n.rootElement&&n.setStyle("backgroundImage",e[t])}}),M.length&&g.preloadImages(M,function(e){if(e.length!==w.length)return console.error("Number of smileys preloaded does not match number of state icons");for(var t=0;t<e.length;t++){var i=w[t];i&&i.rootElement&&i.setStyle("backgroundImage",e[t])}})}},function(e,t){},function(e,t,i){function n(e){e=e||{},s.call(this,"div",{className:"GuildHousesWindow"}),this.addClassNames(e.className);var t=this;this.currentSelectedHouseId=null,this.once("open",function(){t._createDom()}),this.on("open",function(){t._resetAll(),t.addClassNames("spinner")})}i(1149);var o=i(191).inherits,s=i(235),a=i(248).addTooltip,r=i(246).DofusButton,l=i(29).getText,c=i(735),u=i(225);o(n,s),e.exports=n,n.prototype._createDom=function(){var e=this,t={colIds:["houseName","coordinate","owner","detail"],headerContent:[l("ui.common.houseWord"),l("ui.common.coordinatesSmall"),l("ui.common.ownerWord")],highlightable:!0,onRowTap:function(t){e.currentSelectedHouseId=t.houseId}};this.table=this.appendChild(new c(t));var i=this.createChild("div",{className:"buttonContainer"});this.joinButton=i.appendChild(new r(l("ui.common.join"),{className:"joinButton"})),this.joinButton.on("tap",function(){window.dofus.sendMessage("GuildHouseTeleportRequestMessage",{houseId:e.currentSelectedHouseId}),u.close("social")}),this.joinButton.disable(),this._setupSocketEvents()},n.prototype._setupSocketEvents=function(){var e=this,t=window.gui.playerData.guild;t.on("guildHouseUpdateAll",function(){e.isVisible()&&(e.delClassNames("spinner"),e._updateHouses(),e._updateJoinButton())}),t.on("guildHouseUpdateInfo",function(t){e.isVisible()&&(e._updateHouse(t),e._updateJoinButton())}),t.on("guildHouseRemoved",function(t){e.isVisible()&&(e._removeHouse(t),e._updateJoinButton())})},n.prototype._createHouseInfoButton=function(e){var t=this,i=new r("?",{name:"button"});return i.on("tap",function(){var i=t._getHouseListRowIndexByHouseId(e.houseId);t.table.highlight(i),u.open("guildHouseInfo",{guildshareParams:e.guildshareParams,skillListIds:e.skillListIds})}),i},n.prototype._resetAll=function(){this.currentSelectedHouseId=null,this.table.clearContent(),this.joinButton.disable()},n.prototype._createHouseListRow=function(e){var t=e.enrichData||{};return{houseName:t.houseName,coordinate:e.worldX+","+e.worldY,owner:e.ownerName,detail:this._createHouseInfoButton(e)}},n.prototype._getHouseListRowIndexByHouseId=function(e){for(var t=this.table.getRows(),i=0;i<t.length;i+=1){var n=t[i].houseId||{};if(e===n)return i}},n.prototype._updateJoinButton=function(){var e=window.gui.playerData.guild.current.houses||[];e.length?this.joinButton.enable():this.joinButton.disable()},n.prototype._updateHouses=function(){var e=window.gui.playerData.guild.current.houses||[];this._resetAll();for(var t=0;t<e.length;t+=1)this._addHouse(e[t])},n.prototype._addHouse=function(e){var t=this._createHouseListRow(e),i=this.table.addRow(t,{houseId:e.houseId});this._addHouseRowToolTip(i,e)},n.prototype._removeHouse=function(e){var t=this._getHouseListRowIndexByHouseId(e);t>=0&&this.table.delRow(t)},n.prototype._updateHouse=function(e){var t=e.houseId,i=this._getHouseListRowIndexByHouseId(t);if(i>=0){var n=this._createHouseListRow(e);this.table.updateRow(i,n,{houseId:t})}else this._addHouse(e)},n.prototype._addHouseRowToolTip=function(e,t){var i=t.enrichData,n=i.areaName+" ("+i.subAreaName+")";a(e,n)}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"GuildCustomizationPanel"}),this._isActive=!1,this.on("open",function(){this._isActive||(this._isActive=!0,this._setupDom())}),this.on("close",this._onClose)}i(1151);var o=i(29).getText,s=i(191).inherits,a=i(235),r=i(781),l=i(1152);s(n,a),e.exports=n,n.prototype._onClose=function(){this.clearContent(),this.motd=null,this.privateMsg=null,this.publicMsg=null,this._isActive=!1},n.prototype._setupDom=function(){var e=this.createChild("div",{className:"contentDiv"}),t=e.createChild("div",{className:"publicDiv"}),i=e.createChild("div",{className:"privateDiv"});t.createChild("div",{className:"image"}),this.publicMsg=new l(t,"publicMsg",r.SOCIAL_INFO_GUILD_PUBLIC_MSG,o("tablet.social.publicMsg"),o("tablet.social.publicMsgHelp")),this.motd=new l(i,"motd",r.SOCIAL_INFO_GUILD_MOTD,o("tablet.social.motd"),o("tablet.social.motdHelp")),this.privateMsg=new l(i,"privateMsg",r.SOCIAL_INFO_GUILD_PRIVATE_MSG,o("tablet.social.privateMsg"),o("tablet.social.privateMsgHelp"))}},function(e,t){},function(e,t,i){function n(e,t,i,n,o){this._infoType=i,this._label=n,this._helpText=o;var s=!1,a=window.gui.playerData,r=a.guildData.getGuildMemberInfo(a.id);if(r){var l=a.guild.checkRight(f.GUILD_RIGHT_BOSS,r.rights);s=l||r.rank===y||r.rank===b}this._iAmThePopup=t===T,this._mustEditInPopup=M&&!this._iAmThePopup;var u=w.indexOf(this._infoType)!==-1;this._maxLength=u?h.MAX_SOCIALINFO_SHORT_LEN:h.MAX_SOCIALINFO_LEN,this._setupDom(e,t,s),this._listener=new c,this._setupEvents(),e.on("destroy",this._onDestroy.bind(this))}function o(e){var t=window.gui.playerData.guildData.getGuildMemberInfo(e);return t?t.name:"?"}i(1153);var s=i(248).addTooltip,a=i(246),r=i(29).getText,l=i(252),c=i(647),u=i(584),d=i(503),h=i(277),p=i(483),m=i(781),f=i(526).GuildRightsBitEnum,g=i(225),_=i(235),v=i(668),y=1,b=2,w=[m.SOCIAL_INFO_GUILD_MOTD,m.SOCIAL_INFO_ALLIANCE_MOTD],M=!0,T="socialInfoPanel",C="SocialInfoEditorPanel",I={allPagesAllowed:!0};e.exports=n,n.prototype._onDestroy=function(){this._listener.stopListening()},n.prototype._setupDom=function(e,t,i){var n=e.createChild("div",{className:["socialInfoEditor",t]}),o=n.createChild("div",{className:"headerDiv"});this._iAmThePopup&&o.hide();var l=o.createChild("div",{className:"btnAndTitle"});this._editBtn=l.appendChild(new a({className:["editBtn","greenButton"],addIcon:!0,tooltip:r("ui.common.modify"),hidden:!0},this._editButtonTapHandler.bind(this))),i&&this._editBtn.show();var c=l.createChild("div",{className:"labelAndLastChange"});c.createChild("div",{className:"label",text:this._label}),this._lastChangeDiv=c.createChild("div",{className:"lastChangeDiv",hidden:!0});var u=n.createChild("div",{className:"editionDiv"});s(u,this._helpText),this._characterCounter=u.createChild("div",{className:"characterCount",hidden:!0}),this._textScroller=u.appendChild(new p({className:"textDiv"},{showHintArrows:!0})),this._textDiv=this._textScroller.content,this._placeholder=new d(u,{noHeight:!0}),this._editDiv=u.createChild("textarea",{className:"editDiv",hidden:!0}),this._editDiv.rootElement.addEventListener("input",this._editDivChangeHandler.bind(this));var h=this._editingBtnDiv=n.createChild("div",{className:"editingBtnDiv",hidden:!0});this._submitButton=h.appendChild(new a({className:["submitBtn","greenButton"],text:r("ui.common.save")},this._submitButtonTapHandler.bind(this))),this._submitButton.disable(),this._cancelButton=h.appendChild(new a({className:["cancelBtn","secondaryButton","greenButton"],text:r("ui.common.cancel")},this._cancelButtonTapHandler.bind(this))),this._iAmThePopup&&h.show()},n.prototype._setupEvents=function(){var e=window.gui.playerData.guildData,t=window.dofus.connectionManager,i=this;e.requestSocialInfo(this._infoType),this._listener.listenTo(e,"socialInfoUpdated",function(e,t){e===i._infoType&&i._onInfoUpdateFromServer(t)}),this._listener.listenTo(t,"SocialInfoEditingRequestReplyMessage",function(e){e.infoType===i._infoType&&i._editRequestReplyHandler(e.result,e.editorCharacterId)})},n.prototype._editButtonTapHandler=function(){window.dofus.sendMessage("SocialInfoEditingRequestMessage",{infoType:this._infoType})},n.prototype._editRequestReplyHandler=function(e,t){e?this._startEditing():u.showNotification(r("tablet.lockedBy",o(t)),this._editBtn)},n.prototype._onInfoUpdateFromServer=function(e){this._updateInfo(e),this._iAmThePopup&&this._startEditing()},n.prototype._startEditing=function(){if(this._mustEditInPopup){var e=g.getPanel(C,1);if(e)return;var t=new _("div",{className:"socialInfoPanelParent"}),i=new n(t,T,this._infoType,"",this._helpText);return e=g.createPanel(C,t,{title:this._label,top:10,width:"60%",height:"40%",isModal:!0,noCloseButton:!0}),void(i._parentEditor=this)}this._lastChangeDiv.hide(),this._textScroller.hide(),this._placeholder.toggleDisplay(!1),this._editBtn.hide(),this._editingBtnDiv.show(),this._editDiv.show();var o=this._editDiv.rootElement;o.value=this._originalText,o.selectionStart=o.selectionEnd=this._originalText.length,o.scrollTop=o.scrollHeight,this._characterCounter.show(),this._editDivChangeHandler(),o.focus()},n.prototype._finishEditing=function(e){if(this._submitButton.disable(),this._cancelButton.disable(),this._iAmThePopup)return this._listener.stopListening(),g.close(g.getPanel(C,1).id),this._parentEditor._finishEditing(e);if(void 0!==e){var t=window.gui.playerData.id;this._updateInfo({timestamp:Date.now(),editorId:t,value:e})}this._lastChangeDiv.toggleDisplay(!!this._lastChangeDiv.getText()),this._editDiv.hide(),this._characterCounter.hide();var i=!!this._textDiv.getText();this._textScroller.toggleDisplay(i),this._editBtn.show(),this._editingBtnDiv.hide(),document.activeElement.blur()},n.prototype._cancelButtonTapHandler=function(){this._finishEditing(),window.dofus.sendMessage("SocialInfoEditingCancelMessage",{infoType:this._infoType})},n.prototype._submitButtonTapHandler=function(){var e=this._editDiv.rootElement.value.trimRight();if(e===this._originalText)return this._cancelButtonTapHandler();var t=v.getUnsendableCharacters(e,I);if(t.length){var i=t[0]+" ("+t[0].codePointAt().toString(16)+")";return window.gui.openPopup({title:r("ui.common.error"),message:r("tablet.chat.unsendableChars",i)})}e=v.encode(e,I),window.dofus.sendMessage("SocialInfoEditingCommitMessage",{infoType:this._infoType,content:e}),this._finishEditing(e)},n.prototype._editDivChangeHandler=function(){var e=v.encode(this._editDiv.rootElement.value,I),t=this._maxLength-e.length;this._characterCounter.setText(t),this._characterCounter.toggleClassName("tooLong",t<0),this._submitButton.setEnable(t>=0)},n.prototype._updateInfo=function(e){if(this._setTextContent(e.value),e.editorId&&e.timestamp){var t=Math.max(Math.round((Date.now()-e.timestamp)/1e3),1);this._lastChangeDiv.setText(r("tablet.lastChangeBy",l.durationToHuman(t),o(e.editorId))),this._lastChangeDiv.show()}else this._lastChangeDiv.hide()},n.prototype._setTextContent=function(e){var t=v.decode(e,I);this._originalText=t,this._textDiv.setText(t),this._textScroller.toggleDisplay(!!t),t&&this._textScroller.refresh(),this._placeholder.toggleDisplay(!t),t||this._placeholder.setText(this._helpText)}},function(e,t){},function(e,t,i){function n(e){e=e||{},a.call(this,"div",{className:"GuildPaddocksWindow"}),this.addClassNames(e.className),this.selectedPaddock=null,this.once("open",function(){this._createDom(),this._setupEvents()}),this.on("open",function(){this._resetAll(),this.locationTable.addClassNames("spinner")})}i(1155);var o=i(191).inherits,s=i(246),a=i(235),r=i(248).addTooltip,l=i(29).getText,c=i(735),u=i(225),d=i(202);o(n,a),e.exports=n,n.prototype._setupEvents=function(){var e=window.gui.playerData.guild,t=this;e.on("guildPaddockUpdate",function(){t.isVisible()&&(t.locationTable.delClassNames("spinner"),t._updatePaddocks(),t._updateJoinButton())}),e.on("guildPaddockBought",function(e){t.isVisible()&&(t._addPaddock(e),t._updateJoinButton())}),e.on("guildPaddockRemoved",function(e){t.isVisible()&&(t._removePaddock(e),t._updateJoinButton())})},n.prototype._createDom=function(){var e=this;this.locationTable=this.appendChild(new c({className:"locationTable",headerContent:[l("ui.common.localisation")],colIds:["location","abandoned"],highlightable:!0,onRowTap:function(t){e._updatePaddockDetails(t)}}));var t=this.createChild("div",{className:"rightColumn"}),i=t.createChild("div",{className:"infos"}),n=i.createChild("div",{className:"image"}),o=i.createChild("div",{className:"details"});this.paddockName=o.createChild("div",{className:"name"}),o.createChild("div",{className:["text","clear"],text:l("ui.common.objects")}),this.maxItems=o.createChild("div",{className:["text","right"],text:"-"}),o.createChild("div",{className:["text","clear"],text:l("ui.common.mounts")}),this.maxMounts=o.createChild("div",{className:["text","right"],text:"-"}),this.joinButton=new s({className:["button","clear"],text:l("ui.common.join")},function(){e.selectedPaddock&&e.selectedPaddock.paddockId&&(window.dofus.sendMessage("GuildPaddockTeleportRequestMessage",{paddockId:e.selectedPaddock.paddockId}),u.close("social"))}),o.appendChild(this.joinButton),this.mountTable=t.appendChild(new c({className:"mountTable",headerContent:[l("ui.common.mountType"),l("ui.common.ownerWord")],colIds:["mount","owner"]})),d.preloadImage("gfx/illusUi/IllusDinde.png",function(e){n.setStyle("backgroundImage",e)})},n.prototype._updatePaddockDetails=function(e){var t=this.selectedPaddock=e.paddock,i=t.enrichData||{};this.paddockName.setText(l("ui.common.mountPark")+" - "+i.subAreaName),this.maxItems.setText(t.maxItems+" "+l("ui.common.maxWord"));var n=t.mountsInformations,o=n.length;if(this.maxMounts.setText(o+" / "+t.maxOutdoorMount),this.mountTable.clearContent(),o)for(var s=0;s<o;s+=1){var a=n[s],c=a.enrichData||{},u=this.mountTable.addRow({mount:c.mountType,owner:a.ownerName}),d=a.name||l("ui.common.noName");r(u,d)}},n.prototype._createLocationTableRow=function(e){var t,i=new a("div",{className:"locationInfo"}),n=i.createChild("div");e.abandonned&&(t=i.createChild("div",{className:"abandonedIcon"}),r(t,l("ui.social.paddockWithNoOwner")));var o=e.enrichData||{},s=isNaN(e.worldX)?o.worldX:e.worldX,c=isNaN(e.worldY)?o.worldY:e.worldY,u="("+s+", "+c+")";return n.setText(o.areaName+" ("+o.subAreaName+") "+u),{location:n,abandoned:t||""}},n.prototype._updateJoinButton=function(){var e=window.gui.playerData.guild.current.paddocks||[];e.length?this.joinButton.enable():this.joinButton.disable()},n.prototype._updatePaddocks=function(){var e=window.gui.playerData.guild.current.paddocks||[];this._resetAll();for(var t=0;t<e.length;t+=1)this._addPaddock(e[t])},n.prototype._addPaddock=function(e){var t=this._createLocationTableRow(e);this.locationTable.addRow(t,{paddock:e})},n.prototype._removePaddock=function(e){for(var t=this.locationTable.getRows(),i=0;i<t.length;i+=1){var n=t[i];if(n.paddock.paddockId===e){this.locationTable.delRow(i);break}}},n.prototype._resetAll=function(){this.locationTable.clearContent(),this.mountTable.clearContent(),this.joinButton.disable(),this.paddockName.setText(""),this.maxItems.setText("-"),this.maxMounts.setText("-")}},function(e,t){},function(e,t,i){function n(){r.call(this,"div",{className:"GuildPerceptorsWindow"}),this.taxCollectorRows={},this.once("open",function(){this._createDom(),this._setupEvents()}),this.on("open",function(){this.table.addClassNames("spinner"),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:u.INFO_TAX_COLLECTOR_GUILD_ONLY})}),this.on("close",function(){this._clearAllFightStartTimers(),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:u.INFO_TAX_COLLECTOR_LEAVE})})}function o(e){var t=this.fight;if(t.state===g.fightState.waitingForHelp){var i=t.id,n=window.gui.playerData.id;g.isPlayerFightingFor(n,y.taxCollector,i,b.allies)?e&&n===e.id&&window.dofus.sendMessage("GuildFightLeaveRequestMessage",{taxCollectorId:i,characterId:n}):e&&5===t.fighters.allies.length?window.dofus.sendMessage("GuildFightTakePlaceRequestMessage",{taxCollectorId:i,replacedCharacterId:e.id}):window.dofus.sendMessage("GuildFightJoinRequestMessage",{taxCollectorId:i})}}i(1157);var s=i(246),a=i(191).inherits,r=i(235),l=i(248).addTooltip,c=i(29).getText,u=i(725),d=i(252),h=i(1140),p=i(1158),m=i(605),f=i(735),g=i(523),_=i(225),v=i(28).DofusDate,y=g.entityType,b=g.fightingSide;a(n,r),e.exports=n,n.prototype._createDom=function(){var e=this.createChild("div",{className:"tableContainer"});this.table=e.appendChild(new f({headerContent:["",c("ui.common.name")+" / "+c("ui.common.localisation"),"",c("ui.common.defenders")+" / "+c("ui.common.attackers")],colIds:["fightState","taxCollectorInfo","timer","fightersInfo"]}));var t=this.createChild("div",{className:"bottomDiv"}),i=t.createChild("div",{className:"leftPart"}),n=t.createChild("div",{className:"rightPart"});i.appendChild(new s({text:c("ui.social.guildBoosts"),className:["boostPanelBtn","greenButton"]},this._openBoostPanel.bind(this))),this.perceptorAmountText=n.createChild("div",{className:"rightAlignText"}),this._setPerceptorsAmount(0,0),n.createChild("div",{className:"rightAlignText",text:c("ui.social.guildHowDefendTax")})},n.prototype._setupEvents=function(){function e(e){return i.taxCollectorRows[e]&&i.taxCollectorRows[e].fightersInfo}function t(e){return i.taxCollectorRows[e]&&i.taxCollectorRows[e].timer}var i=this,n=0;g.on("taxCollectorList",function(e,t,o){if(i.isVisible()&&e===y.taxCollector){i.table.delClassNames("spinner"),i._resetAll();for(var s=0,a=t.length;s<a;s+=1)i._addTaxCollector(t[s]);n=o,i._setPerceptorsAmount(t.length,o)}}),g.on("entityAdded",function(e,t){i.isVisible()&&e===y.taxCollector&&(i._addTaxCollector(t),i._setPerceptorsAmount(i.table.getRowCount(),n))}),g.on("entityRemoved",function(e,t){i.isVisible()&&e===y.taxCollector&&(i._removeTaxCollector(t),i._setPerceptorsAmount(i.table.getRowCount(),n))}),g.on("fightStarted",function(n,o){if(i.isVisible()&&n===y.taxCollector){var s=e(o.id);if(s){var a=g.entities[n][o.id],r=a.enrichData||{};s.setFight(n,o),s.setTarget({id:o.id,entityLook:a.look,name:r.firstName+" "+r.lastName,level:window.gui.playerData.guild.current.level}),i._updateFightState(o.id,o.state);var l=t(o.id);i._registerFightStartTimer(l,o.waitingForHelpInfo)}}}),g.on("fighting",function(e,n){if(i.isVisible()&&e===y.taxCollector){var o=t(n.id);i._updateFightState(n.id,n.state),i._clearFightStartTimer(o)}}),g.on("fightEnded",function(t,n){if(i.isVisible()&&t===y.taxCollector){var o=e(n);o&&(i._updateFightState(n,g.fightState.noFight),o.reset())}}),g.on("fighterList",function(t,n,o,s){if(i.isVisible()&&t===y.taxCollector){var a=e(n);a&&a.setFighters(o,s)}}),g.on("fighterJoined",function(t,n,o,s,a){if(i.isVisible()&&t===y.taxCollector){var r=e(n);r&&r.setFighter(o,s,a)}}),g.on("fighterLeft",function(t,n,o,s,a){if(i.isVisible()&&t===y.taxCollector){var r=e(n);r&&r.removeFighter(o,a)}})},n.prototype._setPerceptorsAmount=function(e,t){this.perceptorAmountText.setText(c("ui.social.guild.taxCollectorCount",e,t))},n.prototype._setNameLocation=function(e,t){var i=t.enrichData||{},n=e.getChild("name");n.setText(i.firstName+" "+i.lastName);var o=" ("+t.worldX+" , "+t.worldY+")",s=e.getChild("location");s.setText(i.subAreaName+o);var a=t.complements||[],r=d.getObjectInArrayById(a,"_type","TaxCollectorLootInformations")||{},l=c("ui.common.short.weight",d.intToString(r.pods||0)),u=c("ui.social.thingsTaxCollectorGet",l,d.intToString(r.experience||0)),h=e.getChild("resources");h.setText(u);var p=e.getChild("owner"),m=t.additionalInfos.collectorCallerName;p.toggleClassName("me",window.gui.playerData.characterBaseInformations.name===m),p.setText(c("ui.common.ownerWord")+c("ui.common.colon")+m)},n.prototype._addFightStateToolTip=function(e,t){l(e,function(){var e="",i=t.state||0;e+=c(1===i?"ui.social.guild.taxInEnterFight":2===i?"ui.social.guild.taxInFight":"ui.social.guild.taxInCollect");var n=t.additionalInfos||{};e+="\n"+c("ui.common.ownerWord")+c("ui.common.colon"),e+=n.collectorCallerName+"\n",e+=c("ui.social.guild.taxStartDate")+c("ui.common.colon");var o=new v(n.date).getServerDate().toString(!1);return e+=o.date+" - "+o.time,e+="\n"+c("ui.social.taxCollector.itemsValue",d.kamasToString(t.complements[0].itemsValue)),new r("div",{text:e})})},n.prototype._updateTimerProgressBar=function(e){var t=e.remainSeconds,i=e.totalWaitTime,n=i-t,o=Math.round(n/i*100)/100;e.setValue(o)},n.prototype._registerFightStartTimer=function(e,t){var i=this;t&&(e.remainSeconds=Math.round(t.timeLeftBeforeFight/10)||0,e.totalWaitTime=Math.round(t.waitTimeForPlacement/10)||1,e.intervalId=setInterval(function(){e.remainSeconds-=1,e.remainSeconds>0?i._updateTimerProgressBar(e):i._clearFightStartTimer(e)},1e3),this._updateTimerProgressBar(e))},n.prototype._clearFightStartTimer=function(e){clearInterval(e.intervalId),e.intervalId=null,e.remainSeconds=0,e.totalWaitTime=0,e.setValue(0)},n.prototype._clearAllFightStartTimers=function(){for(var e=this.table.getRows()||[],t=0;t<e.length;t+=1){var i=e[t].timer;this._clearFightStartTimer(i)}},n.prototype._createTaxCollectorRow=function(e){var t=new r("div",{className:["fightState","state"+e.state]});this._addFightStateToolTip(t,e);var i=new r("div",{className:"taxCollectorInfo"});i.createChild("div",{name:"name"}),i.createChild("div",{name:"location"}),i.createChild("div",{name:"resources"}),i.createChild("div",{name:"owner",className:"taxCollectorInfoOwner"}),this._setNameLocation(i,e);var n=new m({vertical:!0,className:["green","timer"]}),s=new h;return s.on("slotTap",o),{fightState:t,taxCollectorInfo:i,timer:n,fightersInfo:s}},n.prototype._addTaxCollector=function(e){var t=e.uniqueId,i=this.table.addRow(this._createTaxCollectorRow(e),{collectorId:t});this.taxCollectorRows[t]=i},n.prototype._updateFightState=function(e,t){var i=this.taxCollectorRows[e];i&&i.fightState.replaceClassNames(["state0","state1","state2"],["state"+t])},n.prototype._removeTaxCollector=function(e){var t=this.taxCollectorRows[e];if(t){this._clearFightStartTimer(t.timer),delete this.taxCollectorRows[e];var i=this.table.getRows().indexOf(t);this.table.delRow(i)}},n.prototype._resetAll=function(){this.taxCollectorRows={},this._clearAllFightStartTimers(),this.table.clearContent(),this._setPerceptorsAmount(0,0)},n.prototype._openBoostPanel=function(){var e="PerceptorBoostPanel",t=_.getPanel(e,1);t?_.focusWindow(t.id):_.createPanel(e,new p,{title:c("ui.social.guildTaxCollectors")+" - "+c("ui.social.guildBoosts"),width:797,height:497})}},function(e,t){},function(e,t,i){function n(){f.call(this,"div",{className:"PerceptorBoostPanel"}),this._buildDomElements(),window.dofus.sendMessage("GuildGetInformationsMessage",{infoType:p.INFO_BOOSTS}),this._listener=new u,this._listenGameServerEvents(),this.on("destroy",function(){this._listener.stopListening()})}function o(e,t,i){if(t===T)return null;if(i<M)return null;var n=new y({className:"UpgradeButton",tooltip:a},s);return n.spell=e,n.realLevel=t,n}function s(){var e=this.spell,t=this.realLevel+1;window.gui.openConfirmPopup({title:h("ui.grimoire.spellLevel.increase"),message:h("ui.grimoire.popup.confirmation",M,'"'+e.getName()+'"',t),cb:function(t){t&&window.dofus.sendMessage("GuildSpellUpgradeRequestMessage",{spellId:e.id})}})}function a(){return h("ui.spell.requiredPoints",M)}function r(e,t,i,n){function s(t){for(var i=[],n=0,o=e.length;n<o;n++)i.push("gfx/spells/sort_"+e[n]+".png");w.preloadImages(i,function(e){t(null,e)})}function a(t){v.createSpells(e,t)}function r(s,a){if(s)return console.warn(s);for(var r={},l={},c=0;c<e.length;c++){var u=e[c];r[u]=a.spellUrls[c];var d=t[c]?t[c]:1;l[u]=t[c],a.spells[u].setLevel(d)}for(c=0;c<e.length;c++){var h=e[c],p=a.spells[h];if(p){var m=new f("div",{className:"spellIcon"});m.setStyle("backgroundImage",r[h]),i.addRow([m,p.getName(),l[h],o(p,l[h],n)||""]),b(m,new _({spell:p}))}else console.error("Missing poney spell",h)}}i.clearContent(),m.parallel({spells:a,spellUrls:s},r)}function l(){var e=this.characteristicKeyName,t=this.myWindow.guildInfosUpgradeMessage[e],i=I[e];window.gui.openConfirmPopup({message:h("ui.grimoire.popup.confirmation",i.cost,'"'+this.characteristicLabel+'"',t+i.quantity),cb:function(t){t&&window.dofus.sendMessage("GuildCharacsUpgradeRequestMessage",{charaTypeTarget:C[e]})}})}function c(){var e=I[this.characteristicKeyName];return h("ui.social.poneyCost",e.cost,e.quantity,e.max)}i(1159);var u=i(647),d=i(191).inherits,h=i(29).getText,p=i(725),m=i(31),f=i(235),g=i(735),_=i(840),v=i(459),y=i(246),b=i(248).addTooltip,w=i(202),M=5,T=5,C={taxCollectorPods:0,taxCollectorProspecting:1,taxCollectorWisdom:2,maxTaxCollectorsCount:3},I={taxCollectorLifePoints:null,taxCollectorDamagesBonuses:null,taxCollectorProspecting:{cost:1,quantity:1,max:500},taxCollectorWisdom:{cost:1,quantity:1,max:400},taxCollectorPods:{cost:1,quantity:20,max:5e3},maxTaxCollectorsCount:{cost:10,quantity:1,max:50}};d(n,f),e.exports=n,n.prototype._createCharacteristicUpgradeButton=function(e,t){var i=new y({className:"UpgradeButton",name:"button",tooltip:c},l);return i.characteristicKeyName=e,i.characteristicLabel=t,i.myWindow=this,i},n.prototype._listenGameServerEvents=function(){var e=this;this._listener.listenTo(window.gui,"GuildInfosUpgradeMessage",function(t){e.guildInfosUpgradeMessage=t,
e._updateUI(t)})},n.prototype._buildDomElements=function(){var e=this.createChild("div",{className:["sidePanel","leftPanel"],name:"leftPanel"});this.spellsTable=new g({colIds:["icon","name","level","upgrade"],headerContent:["",h("ui.common.name"),h("ui.common.level")],className:["sidePanel","rightPanel"]}),this.appendChild(this.spellsTable);var t=e.createChild("div",{className:"characterImage"}),i=t.createChild("div",{className:"image"});w.preloadImage("gfx/illusUi/SocialGuildePersonnalisation_tx_IlluPerco.png",function(e){i.setStyle("backgroundImage",e)});var n=new g({className:"perceptorCharacteristicsTable",colIds:["label","value","upgrade"],headerContent:[h("ui.social.guildTaxCharacteristics")]});this.perceptorCharacteristicsTable=n,n.addRow([h("ui.common.lifePoints"),"0",""]),n.addRow([h("ui.social.damagesBonus"),"0",""]),this._addCharacteristicRow(h("ui.social.discernment"),"taxCollectorProspecting"),this._addCharacteristicRow(h("ui.stats.wisdom"),"taxCollectorWisdom"),this._addCharacteristicRow(h("ui.common.weight"),"taxCollectorPods"),this._addCharacteristicRow(h("ui.social.taxCollectorCount"),"maxTaxCollectorsCount"),e.appendChild(n);var o=e.createChild("div",{className:"pointsToDistributePanel",name:"pointsToDistributePanel"});o.createChild("div",{className:"pointsToDistributeLabel",name:"pointsToDistributeLabel",text:h("ui.social.guildBonusPoints")}),this.pointsToDistributeValue=o.createChild("div",{className:"pointsToDistributeValue",name:"pointsToDistributeValue",text:"0"})},n.prototype._addCharacteristicRow=function(e,t){this.perceptorCharacteristicsTable.addRow([e,"0",this._createCharacteristicUpgradeButton(t,e)])},n.prototype._updateUI=function(e){var t=e.boostPoints,i=this.perceptorCharacteristicsTable,n=0;for(var o in I){var s=n++;if(i.updateRow(s,{value:e[o]}),I[o]){var a=t>=I[o].cost,l=e[o]<I[o].max,c=i.getCol(s,"upgrade").getChild("button");c.toggleDisplay(a&&l)}}this.pointsToDistributeValue.setText(e.boostPoints),r(e.spellId,e.spellLevel,this.spellsTable,e.boostPoints)}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"SpouseWindow",name:"spouse"});var e=this;window.gui.playerData.socialData.once("spouseUpdate",function(t){e._updateSocialWindowTitle(t)}),this.once("open",function(){e._setupDom(),e._setupEvents()}),this.on("open",function(){window.dofus.sendMessage("SpouseGetInformationsMessage")})}i(1161);var o=i(191).inherits,s=i(29).getText,a=i(235),r=i(246),l=i(30),c=i(415),u=i(457),d=i(225),h=i(202);o(n,a),e.exports=n,n.prototype._setupDom=function(){var e=this,t=this.createChild("div",{className:"col1"}),i=this.createChild("div",{className:"col2"});this.name=t.createChild("div",{className:"name"});var n=this.info=t.createChild("div",{className:"info"}),o=n.createChild("div",{className:"line"});o.createChild("div",{className:"title",text:s("ui.charcrea.breed")+":"}),this["class"]=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),o.createChild("div",{className:"title",text:s("ui.common.averageLevel")+":"}),this.level=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),o.createChild("div",{className:"title",text:s("ui.common.alignment")+":"}),this.alignment=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:["line","guild"]}),o.createChild("div",{className:"title",text:s("ui.common.guild")+":"}),this.guild=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),o.createChild("div",{className:"title",text:s("ui.common.state")+":"}),this.status=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),o.createChild("div",{className:"title",text:s("ui.common.localisation")+":"}),this.location=o.createChild("div",{className:"value"}),o=n.createChild("div",{className:"line"}),this.fightingIcon=o.createChild("div",{className:"fightingIcon",hidden:!0});var a=n.createChild("div",{className:"buttons"});this.inviteButton=a.appendChild(new r({text:s("ui.party.addToParty"),className:"button"},function(){window.dofus.sendMessage("PartyInvitationRequestMessage",{name:e.name.getText()})})),this.followButton=a.appendChild(new r({text:s("ui.common.follow"),className:"button"},function(){window.dofus.sendMessage("FriendSpouseFollowWithCompassRequestMessage",{enable:!0})})),this.stopFollowingButton=a.appendChild(new r({text:s("ui.common.stopFollow"),className:"button",hidden:!0},function(){window.dofus.sendMessage("FriendSpouseFollowWithCompassRequestMessage",{enable:!1})})),this.joinButton=a.appendChild(new r({text:s("ui.common.join"),className:"button"},function(){window.dofus.sendMessage("FriendSpouseJoinRequestMessage")}));var l=i.createChild("div",{className:["image","bird"]});this.character=i.appendChild(new c({scale:3.5,verticalAlign:"center"})),h.preloadImage("gfx/illusUi/tofus_bague.png",function(e){l.setStyle("backgroundImage",e)})},n.prototype._setupEvents=function(){var e=this;window.gui.playerData.socialData.on("spouseUpdate",function(t){e._updateSocialWindowTitle(t),e.updateDomData(t)}),window.gui.on("CompassUpdateMessage",function(){e.stopFollowingButton.show(),e.followButton.hide()}),window.gui.on("CompassResetMessage",function(){e.stopFollowingButton.hide(),e.followButton.show()})},n.prototype.updateDomData=function(e){var t=this,i=window.gui.databases;this.name.setText(e.spouseName),this["class"].setText(i.Breeds[e.breed].shortNameId),this.level.setText(e.spouseLevel),this.alignment.setText(i.AlignmentSides[e.alignmentSide].nameId);var n=e.guildInfo?e.guildInfo.guildName:"";return this.guild.setText("#NONAME#"===n?s("ui.guild.noName"):n),this.stopFollowingButton.toggleDisplay(!!e.followSpouse),this.followButton.toggleDisplay(!e.followSpouse),this.fightingIcon.toggleDisplay(!!e.inFight),t.character.setLook(e.spouseEntityLook,{direction:u.DIRECTION_SOUTH_WEST,boneType:"characters/",skinType:"characters/",riderOnly:!0}),e.subAreaId?(this.status.setText(s("ui.server.state.online")),this.inviteButton.enable(),this.followButton.enable(),this.stopFollowingButton.enable(),this.joinButton.enable(),void l.getData("SubAreas",e.subAreaId,function(e,i){e&&console.warn("Failed to retrieve subArea data",e),t.location.setText(i.nameId)})):(this.status.setText(s("ui.server.state.offline")),this.location.setText("-"),this.inviteButton.disable(),this.followButton.disable(),this.stopFollowingButton.disable(),void this.joinButton.disable())},n.prototype._updateSocialWindowTitle=function(e){var t=d.getWindow("social");t.setTitle(s("ui.common.spouse",e.sex))}},function(e,t){},function(e,t,i){function n(e){r.call(this,"div",{className:"FellowPagesWindow",name:"directory"}),e=e||{},this.addClassNames(e.className),this.on("open",this._onOpen),this.on("close",this._onClose)}i(1163);var o=i(191).inherits,s=i(29).getText,a=i(611),r=i(235),l=i(1164),c=i(1168);o(n,r),e.exports=n,n.prototype._onOpen=function(){var e=this._tabs=this.appendChild(new a({className:"tabs"}));e.addTab(s("ui.social.guilds"),new l,"guilds"),e.addTab(s("ui.alliance.alliances"),new c,"alliances"),e.openTab(0)},n.prototype._onClose=function(){this._tabs.close(),this.clearContent(),this._tabs=null}},function(e,t){},function(e,t,i){function n(){p.call(this,"div",{className:"FellowGuildsWindow"}),this._isListening=!1,this._reset(),this.on("open",this._onOpen),this.on("destroy",this._reset)}function o(e){return d(e.guildName).indexOf(this.searchedText)!==-1}i(1165);var s=i(526),a=i(469),r=i(29).getText,l=i(191).inherits,c=i(258).playUiSound,u=i(1166),d=i(252).simplifyString,h=i(593),p=i(235),m=200,f=99999;l(n,p),e.exports=n,n.prototype._reset=function(){this._hasDom=!1,this._queryTable&&this._queryTable.reset(),this._queryTable=null},n.prototype._onOpen=function(){this._hasDom||this._setupDom(),this._isListening||this._setupListeners()},n.prototype._setupDom=function(){this._hasDom=!0,this._queryTable=new u(this),this._queryTable.createMinAndMaxBox("Level",r("ui.common.level"),m),this._queryTable.createMinAndMaxBox("MemberCount",r("ui.common.members"),f),this._queryTable.createTextSearchBox("text"),this._queryTable.createSearchAndResetButton(this._sendQuery.bind(this));var e=new h([{id:"emblem",format:function(e){var t=new a({width:40,height:40});return t.setValue(e.guildEmblem,!0),t}},{id:"guildName",header:r("ui.common.name"),sort:!0},{id:"guildLevel",header:r("ui.common.level"),sort:!0},{id:"nbMembers",header:r("ui.common.members"),sort:!0}],"guildId");this._queryTable.appendTable(e,o),e.on("rowTap",function(e,t){s.openGuildCard(t.guildId),c("GEN_BUTTON")})},n.prototype._setupListeners=function(){this._isListening=!0;var e=window.dofus.connectionManager,t=this;e.on("_socialDataErrorMessage",function(e){t._hasDom&&"guildList"===e.type&&t._handleError()}),e.on("GuildListMessage",function(e){t._hasDom&&t._receiveList(e.guilds,e.truncated)})},n.prototype._sendQuery=function(e){if(this._hasDom){this._queryTable.prepareForResults();var t=window.gui.serversData.connectedServerId;window.dofus.send("socialDataRequest",{type:"guildList",serverId:t,minLevel:e.minLevel||0,minMemberCount:e.minMemberCount||0,maxLevel:e.maxLevel||0,maxMemberCount:e.maxMemberCount||0,text:e.text||""})}},n.prototype._handleError=function(){this._queryTable.showError(this._sendQuery.bind(this))},n.prototype._receiveList=function(e,t){this._queryTable.loadResults(e,t)}},function(e,t){},function(e,t,i){"use strict";function n(e){this.reset(),this._parent=e,this._queryBox=e.createChild("div",{className:"queryBox"})}function o(e,t,i,n){return e.appendChild(new l({maxValue:n,title:t,attr:{placeholder:i}}))}i(1167);var s=i(246),a=i(29).getText,r=i(582),l=i(388),c=i(580),u=i(252).simplifyString;e.exports=n,n.prototype.reset=function(){this._parent=null,this._queryBox=null,this._buttonBox=null,this._failureBox=null,this._queryBtn=null,this._textFilterBox=null,this._filterBox=null,this._rowCounter=null,this._table=null,this._fieldMap={}},n.prototype.createMinAndMaxBox=function(e,t,i){var n=a("tablet.filter.to"),s=a("ui.common.minWord"),r=a("ui.common.maxWord"),l=this._queryBox.createChild("div",{className:["minMaxDiv",e]});l.createChild("div",{className:"label",text:t+a("ui.common.colon")}),this._fieldMap["min"+e]=o(l,t+" - "+s,s,i),l.createChild("span",{text:n}),this._fieldMap["max"+e]=o(l,t+" - "+r,r,i)},n.prototype.createTextSearchBox=function(e){var t=this._queryBox.createChild("div");t.createChild("div",{className:"label",text:a("ui.common.name")+a("ui.common.colon")}),this._fieldMap[e]=t.appendChild(new r)},n.prototype.createSearchAndResetButton=function(e,t){var i=this._buttonBox=this._queryBox.createChild("div",{className:"buttonBox"}),n=this;this._queryBtn=i.appendChild(new s({className:["searchBtn","greenButton"],text:a("ui.common.search")},function(){return n._checkQuery()?(n._queryBtn.disable(),void e(n.getQuery())):n.loadResults([])})),i.appendChild(new s({className:["resetBtn","secondaryButton"],text:a("ui.common.reset")},function(){n._resetQueryFields(),t&&t()}))},n.prototype._createFilterBox=function(e,t){var i=this._filterBox=e.createChild("div",{className:"filterBox"});i.createChild("div",{className:"filterIcon"}),this._textFilterBox=i.appendChild(new c({isLiveSearch:!0,placeholder:a("tablet.common.filter")})),this._setFilterEnable(!1);var n=this;this._textFilterBox.on("search",function(e){n._table.searchedText=u(e),n._table.filter(t)})},n.prototype._setFilterEnable=function(e){this._textFilterBox.setEnable(e),this._filterBox.toggleClassName("disabled",!e)},n.prototype._checkQuery=function(){var e=!0;for(var t in this._fieldMap)if(t.startsWith("min")){var i=t.substr(3),n=this._fieldMap[t],o=this._fieldMap["max"+i];if(o){var s=n.getRawValue(),a=o.getRawValue(),r=""!==s&&""!==a&&parseInt(s,10)>parseInt(a,10);n.toggleClassName("invalid",r),o.toggleClassName("invalid",r),r&&(e=!1)}}return e},n.prototype.getQuery=function(){var e={};for(var t in this._fieldMap)e[t]=this._fieldMap[t].getValue();return e},n.prototype._resetQueryFields=function(){for(var e in this._fieldMap)this._fieldMap[e].setValue("")},n.prototype.showError=function(e){this._deleteFailureBox(),this._createFailureBox(e),this._table.setContentLoading(!1),this._table.setPlaceholderText(a("tablet.searchError")),this._setFilterEnable(!1)},n.prototype._createFailureBox=function(e){var t=this,i=this._failureBox=this._buttonBox.createChild("div",{className:"failureBox"}),n=i.appendChild(new s({className:["retryBtn","specialButton"],text:a("tablet.common.retry")}));n.on("tap",function(){n.disable(),e(t.getQuery())})},n.prototype._deleteFailureBox=function(){this._failureBox&&(this._buttonBox.removeChild(this._failureBox),this._failureBox=null)},n.prototype.appendTable=function(e,t){var i=this._parent.createChild("div",{className:"aboveTable"});this._createFilterBox(i,t),this._rowCounter=i.createChild("div",{className:"rowCounter"}),this._table=this._parent.appendChild(e),setTimeout(function(e){e._table&&e._table.setPlaceholderText(a("tablet.search"))},0,this)},n.prototype.prepareForResults=function(){this._table.clearContent(),this._table.setContentLoading(!0),this._table.setPlaceholderText(a("ui.loadbar.loading")+"..."),this._rowCounter.setText("")},n.prototype.loadResults=function(e,t){this._deleteFailureBox(),this._setFilterEnable(!0),t?this._rowCounter.setText(a("tablet.firstResults",e.length)):this._rowCounter.setText(a("tablet.nResults",e.length)),this._table.setContentLoading(!1),e.length?(this._table.setPlaceholderText(""),this._table.addList(e,!0,!0)):this._table.setPlaceholderText(a("ui.search.noResult")),this._queryBtn.enable()}},function(e,t){},function(e,t,i){function n(){f.call(this,"div",{className:"FellowAlliancesWindow"}),this._isListening=!1,this._reset(),this.on("open",this._onOpen),this.on("destroy",this._reset)}function o(e){var t=Math.floor(Date.now()/1e3)-e.creationDate;return c.durationToHuman(t)}function s(e){return p(e.allianceName).indexOf(this.searchedText)!==-1||e.allianceTag.toLowerCase().indexOf(this.searchedText)!==-1}i(1169);var a=i(630),r=i(469),l=i(29).getText,c=i(252),u=i(191).inherits,d=i(258).playUiSound,h=i(1166),p=i(252).simplifyString,m=i(593),f=i(235),g=99999,_=9999,v=9999;u(n,f),e.exports=n,n.prototype._reset=function(){this._hasDom=!1,this._queryTable&&this._queryTable.reset(),this._queryTable=null},n.prototype._onOpen=function(){this._hasDom||this._setupDom(),this._isListening||this._setupListeners()},n.prototype._setupDom=function(){this._hasDom=!0,this._queryTable=new h(this),this._queryTable.createMinAndMaxBox("GuildCount",l("ui.social.guilds"),_),this._queryTable.createMinAndMaxBox("MemberCount",l("ui.common.members"),g),this._queryTable.createMinAndMaxBox("Subarea",l("ui.common.territory"),v),this._queryTable.createTextSearchBox("text"),this._queryTable.createSearchAndResetButton(this._sendQuery.bind(this));var e=new m([{id:"emblem",format:function(e){var t=new r({width:40,height:40});return t.setValue(e.allianceEmblem,!0),t}},{id:"allianceName",header:l("ui.common.name"),sort:!0},{id:"allianceTag",header:l("ui.alliance.tag"),sort:!0},{id:"creationDate",header:l("tablet.since"),format:o,sort:function(e,t){return t.creationDate-e.creationDate}},{id:"nbGuilds",header:l("ui.social.guilds"),sort:!0},{id:"nbMembers",header:l("ui.common.members"),sort:!0},{id:"nbSubarea",header:l("ui.common.territory"),sort:!0}],"allianceId");this._queryTable.appendTable(e,s),e.on("rowTap",function(e,t){a.openAllianceCard(t.allianceId),d("GEN_BUTTON")})},n.prototype._setupListeners=function(){this._isListening=!0;var e=window.dofus.connectionManager,t=this;e.on("_socialDataErrorMessage",function(e){t._hasDom&&"allianceList"===e.type&&t._handleError()}),e.on("AllianceListMessage",function(e){t._hasDom&&t._receiveList(e.alliances,e.truncated)})},n.prototype._sendQuery=function(e){if(this._hasDom){this._queryTable.prepareForResults();var t=window.gui.serversData.connectedServerId;window.dofus.send("socialDataRequest",{type:"allianceList",serverId:t,minGuildCount:e.minGuildCount||0,maxGuildCount:e.maxGuildCount||0,minMemberCount:e.minMemberCount||0,maxMemberCount:e.maxMemberCount||0,minSubarea:e.minSubarea||0,maxSubarea:e.maxSubarea||0,text:e.text||""})}},n.prototype._handleError=function(){this._queryTable.showError(this._sendQuery.bind(this))},n.prototype._receiveList=function(e,t){this._queryTable.loadResults(e,t)}},function(e,t){},function(e,t,i){function n(){function e(e,t){t?e.enable():e.disable()}function t(){D||d.preloadImage("gfx/illusUi/enclos_tx_illuEnclos.png",function(e){D=!0,I.setStyle("backgroundImage",e)});var t=M.currency===_,s=t?n:i;if(o)x.replaceClassNames(["buy"],["sell"]),M.windowTitle.setText(l("ui.mount.paddockSell")),L.setText(l("ui.common.cancelTheSale")),E.setReadonly(!1),e(N,b);else{x.replaceClassNames(["sell"],["buy"]),M.windowTitle.setText(l("ui.mount.paddockPurchase")),L.setText(l("ui.common.cancel")),E.setReadonly(!0);var a=window.gui.playerData.inventory,r=t||s&&s<=a.kamas;e(N,r)}return O.toggleDisplay(!o&&!window.gui.playerData.isShopDisabled()),A.setText(l("ui.mount.paddockDescription",v,y)),s?void E.setValue(s):E.setValue(l("ui.item.averageprice.unavailable"))}s.call(this,{className:"PaddockBuyWindow",positionInfo:{left:"c",top:"c",width:350,height:270}}),this.currency=g;var i,n,o,v,y,b,w,M=this,T=this.windowBody.createChild("div",{className:"wrapContainer"}),C=T.createChild("div",{className:"container"}),I=C.createChild("div",{className:"illus"}),A=C.createChild("div",{className:"description"}),S=this.windowBody.createChild("div",{className:"price"}),E=S.appendChild(new c({className:"priceValue",attr:{readonly:!0},title:l("ui.common.price")}));S.createChild("div",{className:"priceLabel",text:l("ui.common.price")+":"});var x=this.windowBody.createChild("div",{className:"buttons"}),L=x.appendChild(new a(null,{className:"cancel"}));L.on("tap",function(){o?(m.hide(),window.dofus.sendMessage("PaddockSellRequestMessage",{price:0})):u.close(M.id)});var N=x.appendChild(new a(l("ui.common.validation"),{className:"confirm"}));N.on("tap",function(){if(o){m.hide(),i=E.getValue();var e=E.getFormattedValue();window.gui.openConfirmPopup({title:l("ui.mount.paddockSell"),message:l("ui.mount.doUSellPaddock",e),cb:function(e){e&&window.dofus.sendMessage("PaddockSellRequestMessage",{price:i})}})}else{var t,s=M.currency===g;t=s?l("tablet.price.soft",r.kamasToString(i,"")):l("tablet.price.hard",r.kamasToString(n,"")),window.gui.openConfirmPopup({title:l("ui.mount.paddockPurchase"),message:l("tablet.ui.mount.doUBuyPaddock",t),cb:function(e){if(e){if(s)return window.dofus.sendMessage("PaddockBuyRequestMessage");var t=n-window.gui.playerData.inventory.goultines;return t>0?f.openNotEnoughHardCurrencyPopup(t):window.dofus.send("paddockBuyRequest",{amountHard:n,amountSoft:i})}}},{isModal:!0})}}),E.on("change",function(t){M.currency===g?e(N,t!==w):e(N,!0)});var O=x.appendChild(new h);O.on("switchToHard",function(){M._setCurrency(_),t()}),O.on("switchToSoft",function(){M._setCurrency(g),t()});var D=!1;window.gui.on("PaddockPropertiesMessage",function(e){v=e.properties.maxOutdoorMount,y=e.properties.maxItems,b=0===e.properties.price}),window.gui.on("PaddockSellBuyDialogMessage",function(e){o=e.bsell,i=w=e.price,n=p.computeHardPrice(i),O.setCurrency(g),t(),u.openDialog("paddockBuy")}),p.on("computedHardPricesChange",function(){n=p.computeHardPrice(i),M.currency===_&&t()});var R=window.dofus.connectionManager;R.on("paddockBuyError",function(){this.send("moneyGoultinesAmountRequest")}),R.on("paddockBuySuccess",function(){this.send("moneyGoultinesAmountRequest")}),this.on("close",function(){m.hide()})}i(1171);var o=i(191).inherits,s=i(233),a=i(246).DofusButton,r=i(252),l=i(29).getText,c=i(388),u=i(225),d=i(202),h=i(1041),p=i(806),m=i(482),f=i(805),g="soft",_="hard";o(n,s),e.exports=n,n.prototype._setCurrency=function(e){if(this.currency!==e){var t=this.currency;this.currency=e,this.currencyIcon&&this.currencyIcon.replaceClassNames([t],[e])}}},function(e,t){},function(e,t,i){function n(){function e(e,i){u.setMount(e,{context:i||"equipped"}),t.windowTitle.setText(u.getName())}r.call(this,{title:"",className:"MountWindow",positionInfo:{right:30,top:"c",width:280,height:525}});var t=this,i=this.windowBody,n=window.gui.playerData,s=window.dofus.connectionManager,u=i.appendChild(new l);s.on("ExchangeStartOkMountMessage",function(){c.close(t.id)}),u.on("freeMount",function(){c.close(t.id)}),u.on("renameMount",function(e){t.windowTitle.setText(e)}),n.on("setMount",this.localizeEvent(function(t){e(t.mountData)})),s.on("MountDataMessage",this.localizeEvent(function(n){if(t.isMountInfoExpected){t.isMountInfoExpected=!1;var o=n.mountData;o.mountLocation="certificate",e(o,"inventory"),i.delClassNames("spinner"),u.show()}})),s.on("MountDataErrorMessage",function(e){if(e.reason===a.SOMEONE_ELSE_PRIVATE_FARM){c.close(t.id);var i=o("ui.mount.impossibleDataPrivateFarm");window.gui.openSimplePopup(i)}}),this.on("open",function(t){if(t=t||{},this.isMountInfoExpected)return u.hide(),void i.addClassNames("spinner");var o=t.mountData||n.equippedMount;e(o)}),this.on("close",function(){c.close("feed")})}i(1173);var o=i(29).getText,s=i(191).inherits,a=i(1174),r=i(233),l=i(596),c=i(225);s(n,r),e.exports=n,n.prototype.showPaddockMount=function(e){this.isMountInfoExpected=!0,c.open(this.id),window.dofus.sendMessage("MountInformationInPaddockRequestMessage",{mapRideId:e})},n.prototype.showCertificateMount=function(e){var t=l.getMountInfoFromCertificate(e);t&&(this.isMountInfoExpected=!0,c.open(this.id),window.dofus.sendMessage("MountInformationRequestMessage",{id:t.mountId,time:t.date}))}},function(e,t){},function(e,t){e.exports={UNKNOWN:0,NOT_FOUND:1,SOMEONE_ELSE_PRIVATE_FARM:2,SOMEONE_ELSE_MOUNT:3}},function(e,t,i){function n(){r.call(this,{title:o("ui.common.feed"),className:"FeedWindow",positionInfo:{right:315,bottom:30,width:400,height:510}}),this.feedingBox=new a(this),this.once("open",function(){this._createDom()}),this.on("open",function(e){this.feedingBox.update(e)}),this.on("close",function(){this.feedingBox.removeFilter()}),this.on("closed",function(){this.feedingBox.unloadContent()}),this.on("slot-tap",function(e){this.feedingBox.selectItem(e.itemInstance)}),this.on("itemQuantity",function(e){this.feedingBox.selectItem(e)}),this.on("itemRemoved",function(){this.feedingBox.reset()})}i(1176);var o=i(29).getText,s=i(191).inherits,a=i(1177),r=i(233);s(n,r),n.prototype._createDom=function(){this.feedingBox.init(this.windowBody)},e.exports=n},function(e,t){},function(e,t,i){function n(e){var t={},i=window.gui.playerData.inventory.objects;for(var n in i){var o=i[n];e(o)&&(t[n]=o)}return t}function o(e){return I.indexOf(e.item.typeId)!==-1}function s(e){return T.indexOf(e.objectGID)!==-1||C.indexOf(e.item.typeId)!==-1}function a(e,t,i){window.dofus.sendMessage("ObjectFeedMessage",{objectUID:i.item?i.item.objectUID:i.itemInstance.objectUID,foodUID:t,foodQuantity:e})}function r(e,t,i){i.itemInstance&&!i.itemInstance.isShieldManageable()||window.dofus.sendMessage("ObjectFeedMessage",{objectUID:i.item?i.item.objectUID:i.itemInstance.objectUID,foodUID:t,foodQuantity:e})}function l(e,t,i){window.dofus.sendMessage("MountFeedRequestMessage",{mountUid:i.mountUid,mountLocation:i.mountLocation,mountFoodUid:t,quantity:e})}function c(){return p("ui.item.confirmFoodLivingItem")}function u(e,t){return p("ui.item.confirmFoodMount",e,t)}function d(e){function t(e){var t=m.params.item;return window.gui.playerData.inventory.isPetFood({foodItems:t.item.foodItems,foodTypes:t.item.foodTypes},e)}function i(e){return!e.livingObjectCategory&&e.item.type.id===h}function n(){m.quantity.show(),m.quantityLabel.setText(p("ui.common.quantity")+p("ui.common.colon")),m.maxBtn.show(),m.minBtn.show()}function d(){m.quantity.hide(),m.quantityLabel.setText(p("ui.common.quantity")+p("ui.common.colon")+" 1"),m.maxBtn.hide(),m.minBtn.hide()}var h,m=this;this.storageViewer=new v({enablePresets:!1}),this.storageViewer.registerView(e,{manualOpening:!0,enableSlotContext:!1}),this._settings={mount:{handleInput:function(){},setupUI:n,filter:s,confirmMessage:u,confirmAction:l,dataHandler:window.gui.playerData.inventory},pet:{handleInput:function(){},setupUI:n,filter:t,confirmMessage:c,confirmAction:a,dataHandler:window.gui.playerData.inventory},livingObject:{handleInput:function(e){h=e.item.livingObjectCategory},setupUI:d,filter:i,confirmMessage:c,confirmAction:a,dataHandler:window.gui.playerData.inventory},shield:{handleInput:function(){},setupUI:n,filter:o,confirmMessage:c,confirmAction:r,dataHandler:window.gui.playerData.inventory},shieldTutorial:{handleInput:function(){},setupUI:n,confirmMessage:c,dataHandler:null}}}var h=i(246),p=i(29).getText,m=i(191).inherits,f=i(951),g=i(388),_=i(503),v=i(903),y=i(509),b=i(233),w=i(399),M=i(575),T=[7903,7904],C=[41,62,63,64],I=[78];m(d,b),d.prototype.init=function(e){this._createDom(e)},d.prototype.update=function(e){e=e||{};var t=this;if(this.reset(),this.mode=e.mode,this.params=e,this.setting=this._settings[this.mode],this.storageViewer.setDataHandler(this.setting.dataHandler),this.setting.handleInput(e),this.setting.setupUI(),"shieldTutorial"===e.mode)y.createItemInstances(M.fakeRune,function(e,i){return e?console.error(e):void t.storageViewer.setItemList(i.map)});else{var i=n(this.setting.filter);this.storageViewer.setItemList(i),this.storageViewer.addFilters([this.setting.filter])}this.quantity.on("change",function(e){t._emitQuantityUpdating(e)})},d.prototype.unloadContent=function(){this.storageViewer.unloadContent()},d.prototype.removeFilter=function(){this.storageViewer.removeFilter(this.setting.filter)},d.prototype.possessFeedItemForMount=function(){for(var e=window.gui.playerData.inventory.objects,t=Object.keys(e),i=0,n=t.length;i<n;i+=1)if(s(e[t[i]]))return!0;return!1},d.prototype.possessFeedItemForPet=function(e){for(var t=window.gui.playerData.inventory.objects,i=Object.keys(t),n=e.item.foodItems,o=e.item.foodTypes,s=0,a=i.length;s<a;s+=1){var r=t[i[s]];if(n.indexOf(r.objectGID)!==-1||o.indexOf(r.item.typeId)!==-1)return!0}return!1},d.prototype.possessFeedItemForLivingObject=function(e){for(var t=window.gui.playerData.inventory.objects,i=Object.keys(t),n=e.livingObjectCategory,o=0,s=i.length;o<s;o+=1){var a=t[i[o]];if(!a.livingObjectCategory&&a.item.type.id===n)return!0}return!1},d.prototype.reset=function(){this.placeHolder.setText(p("ui.common.selectItem")),this.itemBox.hide(),this.confirmBtn.disable(),this.quantity.setValue(1),this._givenXp=0,this.quantity.disable(),"shield"!==this.mode&&"shieldTutorial"!==this.mode||(this.emit("quantityReset"),this.item&&(this.storageViewer.unSelectSlot(this.item.objectUID),this.item=null)),this.minBtn.disable(),this.maxBtn.disable()},d.prototype._createDom=function(e){var t=this;this.viewerBox=e.createChild("div",{className:"viewer"}),this.viewerBox.appendChild(t.storageViewer.storageUI);var i=e.createChild("div",{className:"itemBox"});this.itemBox=i.appendChild(new f({showTitle:!0})),this.placeHolder=new _(i);var n=e.createChild("div",{className:"quantityBox"});this.quantityLabel=n.createChild("div",{className:"label"});var o=this.quantity=n.appendChild(new g({title:p("ui.common.quantity"),maxValue:3e4}));this.minBtn=n.appendChild(new h({text:p("ui.common.minWord"),className:["greenButton","minButton"]},function(){o.setValue(1),t._emitQuantityUpdating(1)})),this.maxBtn=n.appendChild(new h({text:p("ui.common.maxWord"),className:["greenButton","minButton"]},function(){o.setValue(Math.min(3e4,t.item.quantity)),t._emitQuantityUpdating(Math.min(3e4,t.item.quantity))})),this.confirmBtn=e.appendChild(new h({text:p("ui.common.validation"),className:["greenButton","confirm"]})),this.confirmBtn.on("tap",function(){var e=o.getValue();window.gui.openConfirmPopup({title:p("ui.popup.warning"),message:t.setting.confirmMessage(e,t.item.item.nameId),cb:function(i){if(i){if(!t.item||!t.item.objectUID)return console.error("Item or objectUID of the item select for the feeding is undefined");if("shieldTutorial"===t.mode){var n=window.gui.playerData;window.dofus.sendMessage("QuestObjectiveValidationMessage",{questId:n.shieldTutorialQuestId,objectiveId:n.shieldTutorialQuestObjective}),t.unloadContent()}else t.setting.confirmAction(e,t.item.objectUID,t.params)}}})})},d.prototype.selectItem=function(e){if(this.item=e,"shield"===this.mode||"shieldTutorial"===this.mode)for(var t=0;t<e.effects.length;t++)e.effects[t].actionId===w.ACTION_SHIELD_INTERACT_WITH_TYPE&&(this._givenXp=e.effects[t].value);this.itemBox.displayItem(e),this.itemBox.show(),this.placeHolder.setText(null),this.confirmBtn.enable(),this.quantity.setValue(1),this._emitQuantityUpdating(1),this.quantity.maxValue=Math.min(3e4,e.quantity),this.quantity.enable(),this.minBtn.enable(),this.maxBtn.enable()},d.prototype._emitQuantityUpdating=function(e){"shield"!==this.mode&&"shieldTutorial"!==this.mode||this.emit("quantityUpdated",e,this._givenXp)},e.exports=d},function(e,t,i){function n(){s.call(this,{title:r("ui.mount.renameTooltip"),className:"MountRenameWindow",positionInfo:{left:"c",top:"c",width:"400px",height:"200px"}});var e=this.windowBody.createChild("div",{className:"mainContainer"});e.createChild("div",{className:"text",text:r("ui.mount.popupRename")});var t=this._validate.bind(this);this._inputName=e.appendChild(new u({className:"inputName",attr:{type:"text",maxlength:h}},t)),this._inputName.on("change",function(e){this.setValue(e.replace(/[^a-zA-Z]+/g,""))}),e.appendChild(new a(r("ui.common.ok"),{className:"okBtn"},t)),this.on("open",function(e){this._previousName=e.name,this._mountId=e.mountId,this._inputName.setValue(e.name),e.inputBox&&this._positionNextTo(e.inputBox)}),this.on("opened",function(){this._inputName.focus()})}i(1179);var o=i(191).inherits,s=i(233),a=i(246).DofusButton,r=i(29).getText,l=i(277),c=i(225),u=i(582),d=l.MIN_RIDE_NAME_LEN,h=l.MAX_RIDE_NAME_LEN,p=153,m=108;o(n,s),e.exports=n,n.prototype._validate=function(){var e=this._inputName.rootElement.value;this._inputName.rootElement.value=this._inputName.rootElement.value.replace(/[^a-zA-Z]+/g,""),e&&this._previousName!==e&&e.length>=d&&e.length<=h&&window.dofus.sendMessage("MountRenameRequestMessage",{name:e,mountId:this._mountId}),c.close(this.id)},n.prototype._positionNextTo=function(e){var t=e.rootElement.getBoundingClientRect();this.position.x=t.left-p,this.position.y=t.top-m}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"FamilyTreeWindow",positionInfo:{left:"c",top:"c",width:"688px",height:"511px"}}),this._reset(),this.on("open",this._setMount)}i(1181);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(202);o(n,s),e.exports=n,n.prototype._reset=function(){this._hasContent=!1,this._myMount=null,this._myMountName=null,this._ancestorBoxes=null},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._createContent=function(){this._hasContent=!0;var e=this.windowBody.createChild("div",{className:"tree"});this._myMount=e.createChild("div",{className:["mountDisplay","myMount"]}),this._myMountName=e.createChild("div",{className:"myMountName"}),this._ancestorBoxes=[];for(var t=3,i=0,n=1;n<=t;n+=1)for(var o=i;i<Math.pow(2,n)+o;i+=1){var s=["mountDisplay","ancestor_"+i,"geneMinus"+n];this._ancestorBoxes.push(e.createChild("div",{className:s}))}},n.prototype._setMount=function(e){this._hasContent||this._createContent();var t=e.ancestor||[],i=e.name||a("ui.common.noName");this.windowTitle.setText(a("ui.mount.ancestors",i)),this._myMountName.setText(i);for(var n=["gfx/mounts/"+e.model+".png"],o=0;o<t.length;o++)t[o]&&n.push("gfx/mounts/"+t[o]+".png");var s=this;r.preloadImages(n,function(e){if(s._hasContent){s._myMount.setStyle("backgroundImage",e[0]);for(var i=1,n=0;n<t.length;n++)if(t[n]){var o=e[i++];s._ancestorBoxes[n].setStyle("backgroundImage",o)}else s._ancestorBoxes[n].setStyle("backgroundImage","none")}})}},function(e,t){},function(e,t,i){function n(){function e(){var e,t=s.freeOnFailCheckbox.isActivate()&&s.freeOnFailCheckbox.isVisible();e=s.payingCheckbox.isActivate()?o.CRAFT_OPTION_NOT_FREE:o.CRAFT_OPTION_NONE;
var i;i=t?o.CRAFT_OPTION_NOT_FREE_EXCEPT_ON_FAIL:o.CRAFT_OPTION_NONE;var n;return n=s.noResourceCheckbox.isActivate()?o.CRAFT_OPTION_RESOURCES_REQUIRED:o.CRAFT_OPTION_NONE,e+i+n}function t(){s.jobCrafterDirectorySettings={jobId:s.job.id,minSlot:p,userDefinedParams:e()},window.dofus.sendMessage("JobCrafterDirectoryDefineSettingsMessage",{settings:s.jobCrafterDirectorySettings})}function i(e){var t=window.gui.playerData.jobs.craftersSettings,i={};for(var n in t)if(t[n].jobId===e){i=t[n];break}var a=i.userDefinedParams,r=0!==(a&o.CRAFT_OPTION_NOT_FREE),l=0!==(a&o.CRAFT_OPTION_NOT_FREE_EXCEPT_ON_FAIL),c=0!==(a&o.CRAFT_OPTION_RESOURCES_REQUIRED);s.payingCheckbox.toggleActivation(r),s.freeOnFailCheckbox.toggleActivation(l),s.noResourceCheckbox.toggleActivation(c),s.selector.clearContent();for(var u=window.gui.playerData.jobs.getMaxSlotsByJobId(s.job.id),d=1;d<=u;d+=1)s.selector.addOption(d,d);s.selector.setValue(i.minSlot?i.minSlot:1)}function n(){window.dofus.sendMessage("JobAllowMultiCraftRequestSetMessage",{enabled:!this.isPublicMode})}a.call(this,{className:"JobOptionsWindow",title:l("ui.craft.jobOptions"),positionInfo:{left:"c",top:"c",width:400,height:240}});var s=this,d=l("ui.craft.enablePublicMode"),h=l("ui.craft.disablePublicMode"),p=1;this.once("open",function(){var e=s.windowBody.createChild("div",{className:"container"});e.createChild("div",{text:l("ui.craft.referencingOptions")}),s.payingCheckbox=e.appendChild(new c(l("ui.craft.notFree"))),s.freeOnFailCheckbox=e.appendChild(new c(l("ui.craft.freeIfFailed"))),s.freeOnFailCheckbox.addClassNames("freeOnFail"),s.noResourceCheckbox=e.appendChild(new c(l("ui.craft.ressourcesNeeded")));var i=e.createChild("div",{className:"selectorWrapper"});i.createChild("div",{className:"selectorLabel",text:l("ui.craft.minItemInCraft")}),s.selector=i.appendChild(new u),s.selector.on("change",function(e){p=Number(e)});var o=s.windowBody.createChild("div",{className:"buttons"});this.publicButton=o.appendChild(new r(d,{className:"publicButton"})),this.publicButton.on("tap",n),this.saveButton=o.appendChild(new r(l("ui.common.save"),{className:"saveButton"})),this.saveButton.on("tap",t),window.gui.playerData.jobs.on("jobPublicMode",function(e){s.publicButton.setText(e?h:d),s.publicButton.isPublicMode=e})}),this.on("open",function(e){this.job=window.gui.playerData.jobs.list[e.jobId],this.freeOnFailCheckbox.toggleDisplay(!!this.job.info.specializationOfId),i(e.jobId)})}i(1183);var o=i(1184),s=i(191).inherits,a=i(233),r=i(246).DofusButton,l=i(29).getText,c=i(676),u=i(586);s(n,a),e.exports=n},function(e,t){},function(e,t){e.exports={CRAFT_OPTION_NONE:0,CRAFT_OPTION_NOT_FREE:1,CRAFT_OPTION_NOT_FREE_EXCEPT_ON_FAIL:2,CRAFT_OPTION_RESOURCES_REQUIRED:4}},function(e,t,i){function n(){function e(e){n.selectedSpellId=e.spellId,n.selectedSpellName=e.spellName}function t(e,t){var i=new c("div",{className:"icon",name:"icon"});i.setStyle("backgroundImage",t),d(i,function(){return new h({spell:e})}),n.table.addRow({icon:i,name:e.spell.nameId,rank:e.level},{spellId:e.id,spellName:e.spell.nameId})}function i(e){for(var i=[],o=0;o<e.length;o++){var s=e[o];i.push(s.getIconUri())}p.preloadImages(i,function(i){for(var o=0;o<e.length;o++)t(e[o],i[o]);e.length>0?(n.table.highlight(0),n.validButton.enable()):n.validButton.disable()})}a.call(this,{className:"SpellForgetWindow",title:l("ui.spellForget.title"),positionInfo:{left:"c",top:"c",width:400,height:350}});var n=this;this.selectedSpellId=null,this.selectedSpellName=null,this.table=this.windowBody.appendChild(new u({colIds:["icon","name","rank"],colCount:3,highlightable:!0,headerContent:["",l("ui.common.spellName"),l("ui.social.guildRank")],onRowTap:e})),this.validButton=this.windowBody.appendChild(new r(l("ui.common.validation"))),this.validButton.on("tap",function(){n.selectedSpellId&&window.gui.openConfirmPopup({title:l("ui.popup.warning"),message:l("ui.popup.spellForgetConfirm",n.selectedSpellName),cb:function(e){e&&window.dofus.sendMessage("ValidateSpellForgetMessage",{spellId:n.selectedSpellId})}})}),this.on("open",function(){this.table.clearContent();var e=window.gui.playerData.characters.mainCharacter.spellData.getSpells(m.USABLE),t=[];for(var n in e){var o=e[n];o.level>1&&t.push(o)}i(t)}),this.on("close",function(){this.selectedSpellId=null,this.selectedSpellName=null}),window.gui.on("SpellForgetUIMessage",function(e){e.open?s.openDialog("spellForget"):s.close("spellForget")})}i(1186);var o=i(191).inherits,s=i(225),a=i(233),r=i(246).DofusButton,l=i(29).getText,c=i(235),u=i(735),d=i(248).addTooltip,h=i(840),p=i(202),m=i(462).SpellData.SPELL_STATUS;o(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(e,t,i,n,o){var s=new _({className:[e,"blackButton"],text:t,tooltip:i},n);return o&&(t&&s.createChild("div",{className:"btnText",text:t}),s.createChild("div",{className:"btnIcon"})),s}function o(e,t,i){k.call(this,"div",{className:e}),this.myWindow=t,D(this),this.on("tap",i)}function s(){P.call(this,{title:"",noCloseButton:!0,className:"CharacterCreationWindow",positionInfo:{left:"c",top:"c",width:"100%",height:"100%",isFullScreen:!0}}),this._reset(),this.on("open",function(){this.addClassNames(["disabled","spinner"])}),this.on("opened",this._initialize)}function a(e,t){var i=e[t];return i?i.order||0:0}function r(){var e=this,t=e;A.getItems([t.itemId],function(e,i){return e?console.error(e):void R.showNotification(T("tablet.charCrea.potionNeeded",i[0].getName()),t)})}function l(){var e=this.myWindow;if(e.breedId!==this.breedId)return Date.now()-e.lastRendering<se?console.warn("Ignoring hammered button"):void e._selectBreed(this.breedId,void 0,e._currentColors)}function c(){this.myWindow._selectHead(this.headOrder,!0)}function u(e){var t=e.substring(1,e.length-1).split("|");return{bone:t[0],skin:t[1],color:t[2],scale:t[3]}}function d(){window.clearInterval(ge),ge=null,fe&&fe.rootElement&&(fe.setColor(le,ce),fe.myWindow._updateSprite())}function h(e){e&&(ge&&d(),fe=e,le=e.getColor(),ce=e.isCustomColor(),pe=0,me=Date.now(),ge=window.setInterval(h,ue));var t=he[pe%he.length],i={rgb:t,hex:M.colorArrayToHexa(t)};fe.setColor(i),fe.myWindow._updateSprite(),pe++,Date.now()-me>=de&&d()}function p(){var e=this.myWindow;e._selectColor(this.id),h(e.selectedColorBtn)}function m(e,t,i){var n=M.parseIndexedColor(t).color,o=[n.r,n.g,n.b];e.setColor({rgb:o,hex:M.colorArrayToHexa(o)},i)}i(1188);var f=i(202),g=i(184),_=i(246),v=i(198),y=i(415),b=i(661),w=i(1023),M=i(424),T=i(29).getText,C=i(1025),I=i(191).inherits,A=i(509),S=i(1189),E=i(277),x=i(483),L=i(252).showProgressively,N=i(30),O=i(611),D=i(228),R=i(248),P=i(233),B=i(225),k=i(235),F=i(1191),z=i(1193),H=i(663),q=i(1195).onSubmitRules,W=i(1195).onChangeRules,U=[2,1,2,1,3,2,1,1,1,3,1,2,3,2,2],Y=13518,G=10860,j=10861,V=10862,X=.6,Q={1:[174,252],2:[173,252],3:[197,252],4:[218,254],5:[172,253],6:[179,255],7:[189,253],8:[194,254],9:[195,252],10:[210,253],11:[200,256],12:[174,252],13:[238,239],14:[213,208],15:[259,239]},K=[200,252],J=0,Z=1,$=2,ee=3,te=1e3/24,ie=0,ne=1,oe=8,se=500,ae=.85,re=5;I(o,k),o.prototype.setSelected=function(e){e?this.addClassNames("selected"):this.delClassNames("selected")},I(s,P),e.exports=s,s.prototype._reset=function(){d(),this.step=J,this.relookingParams=null,this._relookingPreviousValues=null,this.allBreeds=null,this.numBreeds=0,this.headsMap=null,this.loadedHeads=[],this.lastRendering=0,this.breedBtns=[],this.headContainers=[],this.nameInput=null,this.currentIllustration=null,this.breedIllustration=this.breedIllustrationFade=null,this.breedDescription=null,this.breedName=null,this.breedStory=null,this.breedSelector=null,this.headSelector=null,this.colorPicker=null,this.colorButtons=null,this.selectedColor=null,this._currentColors=null,this._assetUrlCache={},this.spriteStatus={},this.breedId=1,this.sex=ie,this.cosmeticId=1,this.headOrder=0},s.prototype.freeContent=function(){document.activeElement.blur(),this.characterDisplay&&this.characterDisplay.release(),this.characterDisplay=null,this.windowBody.clearContent(),this.centeredContent.clearContent(),this._reset()},s.prototype._initialize=function(e){if(!this.allBreeds){var t=this;return void this._createAll(function(i){return i?console.error("characterCreation: initialize error",i):(t._initialize(e),void t._loadHeadImages())})}this.relookingParams=e&&e.relookingParams,this.relookingParams?this._initCharacterForRelooking():this._initRandomCharacter(),this.delClassNames(["disabled","spinner"])},s.prototype._initRandomCharacter=function(){this._stepLayoutSetup(Z),this.nameInput.setValue(""),this.sex=Math.random()>.45?ne:ie,this.breedSexTabs.openTab(this.sex),this.headSexTabs.openTab(this.sex);var e,t=Math.floor(Math.random()*this.numEasyBreeds),i=0;for(e=1;e<=this.numBreeds;e++)if(!(this.allBreeds[e].complexity>1)){if(i===t)break;i++}var n=Math.floor(Math.random()*oe);this._selectBreed(e,n)},s.prototype._initCharacterForRelooking=function(){var e,t,i=this.relookingParams,n=i.characterToRemodel;this._relookingPreviousValues={name:n.name,breed:n.breed,cosmeticId:n.cosmeticId,indexedColors:n.colors,sex:n.sex},i.canRebreed?(e=T("tablet.connection.rebreed"),t=T("tablet.charcrea.titleRebreed")):i.canRename?(e=T("ui.connection.rename"),t=T("ui.charcrea.titleRename")):i.canRecolor?(e=T("ui.connection.recolor"),t=T("ui.charcrea.titleRecolor")):i.canReface&&(e=T("ui.connection.relook"),t=T("ui.charcrea.titleRelook")),e&&(window.gui.openSimplePopup(e,T("ui.popup.warning")),this.pageTitle.setText(t));var o=a(this.headsMap,n.cosmeticId);this.nameInput.setValue(n.name),this.sex=n.sex?ne:ie,this.breedSexTabs.openTab(this.sex),this.headSexTabs.openTab(this.sex),i.canRebreed?this._stepLayoutSetup(Z):this._stepLayoutSetup($),this._currentColors=n.colors,this._selectBreed(n.breed,o,n.colors),i.canRecolor&&this._selectColor(0)},s.prototype._createAll=function(e){this.allBreeds=window.gui.databases.Breeds,this.numBreeds=Object.keys(this.allBreeds).length,this.numEasyBreeds=0;for(var t=1;t<=this.numBreeds;t++){var i=U[t-1];this.allBreeds[t].complexity=i,1===i&&this.numEasyBreeds++}this._leftSideSetup(),this._centerSetup(),this._rightSideSetup(),this._createBreedElements(),this._createHeadElements(),this._createNavButtons(),this._stepLayoutSetup(Z),this._listenersSetup(),this._loadAsyncData(e)},s.prototype._leftSideSetup=function(){this.breedSpinner=this.windowBody.createChild("div",{className:["breedIllustration","spinner"]}),this.breedIllustration=this.windowBody.createChild("div",{className:"breedIllustration"}),this.breedIllustrationFade=this.windowBody.createChild("div",{className:"breedIllustration"})},s.prototype._centerSetup=function(){this.centeredContent||(this.centeredContent=this.createChild("div"));var e=this.centeredContent;this._createTopLabel(e),this._createNameSelector(e),this.breedSelector=this._createSelector(e,"breedSexTabs"),this.headSelector=this._createSelector(e,"headSexTabs",!0),this._createBreedDescription(e),this._setupColorTool(e)},s.prototype._rightSideSetup=function(){var e=this.windowBody.createChild("div",{className:"rightBar"});this._setupCharacterOnIsland(e)},s.prototype._spreadVerticaly=function(e,t){for(var i=0,n=0;n<e.length;n++)i+=e[n].rootElement.clientHeight;var o=this.windowBody.rootElement.clientHeight-i;for(n=0;n<e.length;n++){var s=Math.round(o*t[n]/100);e[n].setStyle("marginBottom",Math.max(s,re)+"px")}},s.prototype._stepLayoutSetup=function(e){this.step=e;var t=e===$,i=e===Z;this.breedIllustration.toggleDisplay(i||t),this.characterOnIsland.toggleDisplay(i||t),this.breedSexTabs.toggleDisplay(i),this.breedDescription.toggleDisplay(i),this.nextBtn.toggleDisplay(i),this.nameSelector.toggleDisplay(t),this.nameErrWrapper.toggleDisplay(t),this.createBtn.toggleDisplay(t),this.headSexTabs.toggleDisplay(t),this.colorTool.toggleDisplay(t),i?(this._spreadVerticaly([this.topLabel,this.breedSexTabs,this.breedDescription],[15,15,50]),this.backButton.setText(T("ui.common.cancel"))):t&&(this._spreadVerticaly([this.topLabel,this.headSexTabs,this.nameSelector,this.colorTool],[5,5,5,85]),this._selectCurrentHeads(),this.relookingParams?(this._allowElement(this.headSexTabs,this.relookingParams.canRegender),this._allowElement(this.nameSelector,this.relookingParams.canRename,G),this._allowElement(this.colorTool,this.relookingParams.canRecolor,j),this.createBtn.setText(T("ui.common.validation")),this.backButton.setText(T("ui.common.cancel"))):(this._selectColor(0,!0),this.backButton.setText(T("ui.common.back"))))},s.prototype._allowElement=function(e,t,i){if(e.toggleTabAvailability){var n=this.sex===ie,o=e.header.getChildren(),s=o[n?ne:ie],a=o[this.sex],l=e.content;return this._allowElement(s,this.relookingParams.canRegender,V),this._allowElement(a,this.relookingParams.canReface),this._allowElement(l,this.relookingParams.canReface,Y),e.toggleTabAvailability(ie,this.relookingParams.canRegender),void e.toggleTabAvailability(ne,this.relookingParams.canRegender)}if(e.setStyle("opacity",t?1:X),!t){var c=e.appendChild(new k("div",{className:"disabledFeature"}));i&&(c.itemId=i,D(c),c.on("tap",r))}},s.prototype._next=function(){this._stepLayoutSetup($)},s.prototype._canStepBack=function(){return this.step!==Z&&!(this.relookingParams&&!this.relookingParams.canRebreed)},s.prototype._back=function(){this._canStepBack()?this._stepLayoutSetup(Z):(B.close(this.id),b.backToSelection())},s.prototype._createSelector=function(e,t,i){var n={};n.females=new k("div",{className:"females"}),n.males=new k("div",{className:"males"});var o=e.appendChild(new O({className:["sexTabs",t],tabClassName:"mySwipeTabBtn"}));i&&o.hide(),o.addTab("",n.males,ie),o.addTab("",n.females,ne);var s=this;return o.on("openTab",function(e){s._updateSex(e)}),this[t]=o,n},s.prototype._createBreedButton=function(e,t){var i=new o("breedSelectionButton",this,l);i.breedId=e.id;var n=t===ie?this.breedSelector.males:this.breedSelector.females;return n=n.getChild(e.complexity),n.appendChild(i),i},s.prototype._createHeadContainer=function(e,t){var i=new k("div",{className:"headContainer",hidden:!0}),n=1+(e-1)*oe*2+t*oe;i.buttons=[];for(var s=0;s<oe;s++){var a=new o("headSelectionButton",this,c);i.appendChild(a),i.buttons.push(a),a.headOrder=s,a.cosmeticId=n+s,a.gender=t}var r=t===ie?this.headSelector.males:this.headSelector.females;return r.appendChild(i),i},s.prototype._createBreedElements=function(){for(var e=1;e<=3;e++)this.breedSelector.males.createChild("div",{className:"complexityLevel",name:e}),this.breedSelector.females.createChild("div",{className:"complexityLevel",name:e});for(var t=0;t<this.numBreeds;t++){var i=t+1,n=this.allBreeds[i];this.breedBtns[t]=this._createBreedButton(n,ie),this.breedBtns[t+this.numBreeds]=this._createBreedButton(n,ne)}},s.prototype._createHeadElements=function(){for(var e=1;e<=this.numBreeds;e++)this.headContainers[e]=[this._createHeadContainer(e,ie),this._createHeadContainer(e,ne)]},s.prototype._loadAsyncData=function(e){var t=this;N.getAllDataMap("Heads",function(i,n){if(i)return e(i);t.headsMap=n;for(var o=[],s=1;s<=t.numBreeds;s++){var a=("0"+s).slice(-2);o.push("gfx/classes/CreaPerso_btn_0"+a+".png"),o.push("gfx/classes/CreaPerso_btn_1"+a+".png")}f.preloadImages(o,function(i){for(var n=0;n<t.numBreeds;n++){var o=t.breedBtns[n];o.setStyles({backgroundImage:i[2*n+ie]}),o=t.breedBtns[n+t.numBreeds],o.setStyles({backgroundImage:i[2*n+ne]})}e()})})},s.prototype._loadHeadImages=function(e,t){if(this.loadedHeads[e])return t&&t();var i,n;e?(i=1+(e-1)*oe*2,n=i+2*oe-1,this.loadedHeads[e]=!0):(i=1,n=this.numBreeds*oe*2);for(var o=this.headsMap,s=[],a=i;a<=n;a++)s.push("gfx/cosmetics/"+o[~~a].assetId+".png");var r=this;f.preloadImages(s,function(s){if(!r.headContainers.length)return t&&t();if(!e)for(var a=1;a<=r.numBreeds;a++)r.loadedHeads[a]=!0;for(var l=0,c=i;c<=n;c++){var u=o[~~c],d=r.headContainers[u.breed][u.gender].buttons[u.order];d.setStyle("backgroundImage",s[l++])}return t&&t()})},s.prototype._listenersSetup=function(){var e=this;window.gui.on("CharacterCreationResultMessage",function(t){if(t.result===v.OK)return b.confirmNewCharacterCreation(),B.close(e.id);var i;switch(t.result){case v.ERR_INVALID_NAME:i=T("ui.charcrea.nameRules");break;case v.ERR_NAME_ALREADY_EXISTS:i=T("ui.popup.charcrea.nameAlreadyExist");break;case v.ERR_TOO_MANY_CHARACTERS:i=T("ui.popup.charcrea.tooManyCharacters");break;case v.ERR_NOT_ALLOWED:i=T("ui.popup.charcrea.notSubscriber");break;case v.ERR_RESTRICED_ZONE:i=T("ui.charSel.deletionErrorUnsecureMode");break;default:i=T("ui.popup.charcrea.noReason")}R.showNotification(i,e.createBtn),e.delClassNames(["disabled","spinner"])}),window.gui.on("CharacterNameSuggestionSuccessMessage",function(t){e.nameInput.setValue(t.suggestion,!0)})},s.prototype._buildColorsArray=function(){for(var e=new Array(g.CHARACTER_COLORS),t=[],i=0;i<g.CHARACTER_COLORS;i++){var n=this.colorButtons[i],o=n.getColor(),s=M.getIndexedColor(i+1,o.rgb[0],o.rgb[1],o.rgb[2]);e[i]=s,t.push(n.isCustomColor()?s:null)}return this._currentColors=t,e},s.prototype._selectCurrentHeads=function(){if(this.headSexTabs.isVisible()){for(var e=1,t=this.numBreeds;e<=t;e++)this.headContainers[e][ie].hide(),this.headContainers[e][ne].hide();this.headContainers[this.breedId][ie].show(),this.headContainers[this.breedId][ne].show()}},s.prototype._updateSprite=function(e){var t=this.allBreeds[this.breedId],i=u(t[(this.sex===ne?"female":"male")+"Look"]),n=i.skin,o=i.scale,s=this.headsMap[this.cosmeticId].skins,a=this._buildColorsArray().join("#");this.spriteStatus.bodySkin===n&&this.spriteStatus.headSkin===s&&this.spriteStatus.colorsHash===a&&this.spriteStatus.orientation===this.orientation&&this.spriteStatus.scale===o||(this.spriteStatus.bodySkin=n,this.spriteStatus.headSkin=s,this.spriteStatus.colorsHash=a,this.spriteStatus.orientation=this.orientation,this.spriteStatus.scale=o,this._drawCharacter(e))},s.prototype._getAsset=function(e,t){var i=this;return this._assetUrlCache[e]?t(this._assetUrlCache[e]):void f.preloadImage(e,function(n){i._assetUrlCache[e]=n,t(n)})},s.prototype._updateBreedIllustration=function(){if(this.breedIllustration.isVisible()){var e="gfx/illusUi/illus_breed_full/artwork_"+this.breedId+this.sex+".png";if(e!==this.currentIllustration){this.currentIllustration=e;var t=this.breedIllustration;this.breedIllustration=this.breedIllustrationFade,this.breedIllustrationFade=t,L(null,500,null,this.breedIllustrationFade),this.breedSpinner.show();var i=this;this._getAsset(e,function(e){if(i.breedIllustration){i.breedIllustration.setStyle("backgroundImage",e),i.breedSpinner.hide();var t="breed"+i.breedId+i.sex;i.breedIllustration.setClassNames(["breedIllustration",t]),L(i.breedIllustration,500)}})}}},s.prototype._updateBreedIsland=function(){var e=this;this._getAsset("gfx/bases/base_"+this.breedId+".png",function(t){if(e.characterDisplay){var i=Q[e.breedId];i||(console.warn("Missing center tile data for breed:",e.breedId),i=K);var n=e.characterDisplay.rootElement.getBoundingClientRect(),o=.5*n.width,s=ae*n.height;e.islandImage.setStyles({backgroundImage:t,left:o-i[0]+"px",top:e.characterDisplay.rootElement.offsetTop+s-i[1]+"px"}),L(e.islandImage),L(e.rotationLeft),L(e.rotationRight)}})},s.prototype._updateBreedDescription=function(){var e=this.allBreeds[this.breedId];this.breedName.setText(e.longNameId),this.breedStory.content.setText(e.gameplayDescriptionId),this.breedStory.refresh(),this.breedStory.goToTop(),this.breedComplexity.replaceClassNames(["level1","level2","level3"],["level"+e.complexity])},s.prototype._toggleBreedBtn=function(e,t){this.breedBtns[e-1].setSelected(t),this.breedBtns[e-1+this.numBreeds].setSelected(t)},s.prototype._selectBreed=function(e,t,i){this._toggleBreedBtn(this.breedId,!1),this._toggleBreedBtn(e,!0),this.breedId=e,this._updateBreedIllustration(),this.characterDisplay.setStyle("opacity",0),this._updateBreedIsland(),this._updateBreedDescription(),this._selectCurrentHeads(),this._loadHeadImages(e),this._selectHead(void 0!==t?t:this.headOrder),i?this._loadColors(i,!0):this._resetColors(),this.orientation=ee,this._updateSprite(!0)},s.prototype._updateSex=function(e){this.sex!==e&&(this.sex=e,this._updateBreedIllustration(),this._selectCurrentHeads(),this._selectHead(this.headOrder),this.headSexTabs.openTab(e),this.breedSexTabs.openTab(e),this._updateSprite(!0))},s.prototype._selectHead=function(e,t){var i=this.headContainers[this.breedId][this.sex].buttons[e];if(i.cosmeticId!==this.cosmeticId){this.cosmeticId=i.cosmeticId,this.headOrder=e;for(var n=this.headContainers[this.breedId][this.sex].buttons,o=0;o<n.length;o++)n[o].setSelected(n[o]===i);t&&this._updateSprite(!1)}};var le,ce,ue=100,de=500,he=[[255,144,0],[255,228,0]],pe=0,me=0,fe=null,ge=null;s.prototype._colorChanged=function(e){this.selectedColorBtn&&(this.selectedColorBtn.setColor(e,!0),this._updateSprite())},s.prototype._setupColorTool=function(e){var t=this.colorTool=e.createChild("div",{className:"colorTool",hidden:!0});t.setStyle("opacity",0),t.show();var i=this.colorSelector=t.createChild("div",{className:"colorSelector"}),o=i.createChild("div",{className:"colorButtons"}),s=o.createChild("div",{className:"buttonBox"});this.colorButtons=new Array(g.CHARACTER_COLORS+1);for(var a=0;a<=g.CHARACTER_COLORS;a++)this.colorButtons[a]=s.appendChild(new S(this,a,p,{active:a<g.CHARACTER_COLORS}));this.selectedColorBtn=null;var r=i.createChild("div",{className:"picker"}),l=this.pickerRect=r.rootElement.getBoundingClientRect();this.colorPicker=r.appendChild(new w),this.colorPicker.updateDimensions(l.width,l.height),t.hide(),t.setStyle("opacity",1);var c=this;this.colorPicker.on("newColor",function(e){if(c.selectedColorBtn){c.selectedColorBtn.setColor(e,!0);var t=Date.now();(!c.colorPicker.lastUpdate||t-c.colorPicker.lastUpdate>te)&&(c.colorPicker.lastUpdate=t,c._updateSprite())}}),this.colorPicker.on("colorChanged",function(e){c._colorChanged(e)});var u=this.colorPickerFooter=t.createChild("div",{className:"colorPickerFooter"});u.appendChild(new n("resetColorBtn","",T("tablet.charCrea.resetCurrentColor"),function(){return c.selectedColorBtn&&c.selectedColorBtn.getColor()?(c._resetColorButton(c.selectedColorBtn),c._selectColor(c.selectedColorBtn.id,!0),void c._updateSprite()):R.showNotification(T("tablet.charCrea.resetCurrentColor"),this)},(!0))),u.appendChild(new n("randomColorBtn",T("tablet.charCrea.randomColors"),T("tablet.charCrea.randomColorsTip"),function(){for(var e=0;e<g.CHARACTER_COLORS;e++)c.colorButtons[e].randomize();c._selectColor(0,!0),c._updateSprite()},(!0))),u.appendChild(new n("resetAllColorBtn",T("tablet.charCrea.resetAll"),T("tablet.charCrea.resetAllTip"),function(){c._resetColors(),c._updateSprite(),c._currentColors=null}));var d=this.colorPicker.appendChild(new C);d.on("confirm",function(e){var t=M.hexToRgb(e);t&&(c.colorPicker.setCurrentColor([t.r,t.g,t.b]),c._colorChanged(c.colorPicker.getCurrentColor()))}),u.appendChild(new n("hexColorBtn","#",T("ui.charcrea.hexColorTip"),function(){d.open({x:0,y:0,defaultValue:""})}))},s.prototype._createTopLabel=function(e){var t=this.topLabel=e.createChild("div",{className:"topLabel"});t.createChild("div",{className:"topLabelBackground"}),t.createChild("div",{className:"fioritureRococo"}),this.pageTitle=t.createChild("div",{className:"topLabelText",text:T("ui.charcrea.title")})},s.prototype._createBreedDescription=function(e){this.breedDescription=e.createChild("div",{className:"breedDescription"});var t=this.breedDescription.createChild("div",{className:"descriptionZone"}),i=t.createChild("div",{className:"descriptionText"});this.breedName=i.createChild("div",{className:"breedName",text:"."}),this.breedName.setText(""),this.breedStory=i.appendChild(new x({className:"breedStory"},{showHintArrows:!0}));var o=i.createChild("div",{className:"footer"}),s=this.breedComplexity=o.createChild("div",{className:"breedComplexity"});s.createChild("div",{className:"label",text:T("tablet.charCrea.difficulty")+T("ui.common.colon")}),s.createChild("div",{className:["sword","sword1"]}),s.createChild("div",{className:["sword","sword2"]}),s.createChild("div",{className:["sword","sword3"]});var a=this;this.moreInfoBtn=o.appendChild(new n("moreInfoBtn",T("ui.charcrea.more"),"",function(){B.open("breedDetail",{breedData:a.allBreeds[a.breedId]})}));var r=this.rootElement.clientHeight-this.breedDescription.rootElement.offsetTop-2*this.breedStory.rootElement.offsetTop;this.breedStory.setStyle("maxHeight",r+"px")},s.prototype._createNameSelector=function(e){var t=this,i=this.nameSelector=e.createChild("div",{className:"nameSelector",hidden:!0}),o=this.nameErrWrapper=e.createChild("div",{className:"nameErrors",hidden:!0}),s=o.appendChild(new z);this.nameInput=i.appendChild(new F({className:"nameInput",attr:{type:"text",id:"nameInput",maxlength:E.MAX_PLAYER_NAME_LEN},onChangeRules:W,onSubmitRules:q,blockInvalidInput:!1},function(e){e.blur()})),this.nameInput.setPlaceholder(T("ui.popup.charcrea.noName")),this.nameInput.on("validationFailed",function(e){if(t._needsNameCheck()){var i=[];e.forEach(function(e){i.push(" - "+T(e.error))}),i.length>0&&s.setText(i.join("\n"))}}),this.nameInput.on("validationPassed",function(){s.setText("")}),this.randomiseBtn=i.appendChild(new n("randomiseBtn","",T("tablet.charCrea.randomNameTip"),function(){window.dofus.sendMessage("CharacterNameSuggestionRequestMessage")},(!0)))},s.prototype._createRotationButton=function(e,t){var i=this,n=this.characterOnIsland.createChild("div",{className:e,hidden:!0}),o=n.appendChild(new _({className:"shadow",repeatDelay:100},function(){i.orientation=i.characterDisplay.rotateCharacter(t)}));return o.createChild("div",{className:"arrow"}),n},s.prototype._setupCharacterOnIsland=function(e){var t=this.characterOnIsland=e.createChild("div",{className:"characterOnIsland"});this.islandImage=t.createChild("div",{className:"islandImage"}),this.characterDisplay=t.appendChild(new y({scale:2})),this.rotationRight=this._createRotationButton("rotationRight",!0),this.rotationLeft=this._createRotationButton("rotationLeft",!1)},s.prototype._createNavButtons=function(){var e=this;this.backButton=this.windowBody.appendChild(new n("cancelBtn","","",function(){e._back()})),this.nextBtn=this.characterOnIsland.appendChild(new _({text:T("tablet.charCrea.next"),className:["greenButton","nextBtn"]},function(){e._next()})),this.createBtn=this.characterOnIsland.appendChild(new _({text:T("ui.charcrea.create"),className:["greenButton","createButton"]},function(){e._createCharacter()}))},s.prototype._checkRelookingMandatoryChanges=function(e,t){var i=this.relookingParams,n=this.nameInput.getValue();if(i.canRename===H.MANDATORY&&this._relookingPreviousValues.name===n)return R.showNotification(T("tablet.charcrea.sameName"),this.createBtn),!1;if(i.canRebreed===H.MANDATORY&&this._relookingPreviousValues.breed===this.breedId)return R.showNotification(T("tablet.charcrea.sameBreed"),this.createBtn),!1;if(i.canRegender===H.MANDATORY&&this._relookingPreviousValues.sex===t)return R.showNotification(T("tablet.charcrea.sameSex"),this.createBtn),!1;if(i.canReface===H.MANDATORY&&this._relookingPreviousValues.cosmeticId===this.cosmeticId)return R.showNotification(T("tablet.charcrea.sameFace"),this.createBtn),!1;if(i.canRecolor===H.MANDATORY){for(var o=!0,s=this._relookingPreviousValues.indexedColors,a=0;a<s.length;a+=1)if(s[a]!==e[a]){o=!1;break}if(o)return R.showNotification(T("tablet.charcrea.sameColors"),this.createBtn),!1}return!0},s.prototype._createCharacter=function(){var e=this.nameInput.getValue(this._needsNameCheck());if(this._needsNameCheck()){if(e===!1)return;var t=e.length;if(0===t)return R.showNotification(T("ui.popup.charcrea.noName"),this.createBtn);if(t<E.MIN_PLAYER_NAME_LEN||t>E.MAX_PLAYER_NAME_LEN)return R.showNotification(T("ui.charcrea.nameRules"),this.createBtn)}var i=this._buildColorsArray(),n=this.sex===ne,o={name:e,breed:this.breedId,sex:n,colors:i,cosmeticId:this.cosmeticId};if(this.relookingParams){var s=this._checkRelookingMandatoryChanges(i,n);if(!s)return;o.headSkin=this.spriteStatus.headSkin,o.remodelingInformation={name:e,breed:this.breedId,sex:n,colors:i,cosmeticId:this.cosmeticId,entityLook:this._buildEntityLook()},b.confirmCharacterRelooking(o)}else this.addClassNames(["disabled","spinner"]),document.activeElement.blur(),window.dofus.sendMessage("CharacterCreationRequestMessage",o)},s.prototype._buildEntityLook=function(){return{bonesId:1,indexedColors:this._buildColorsArray(),scales:[this.spriteStatus.scale],skins:[this.spriteStatus.bodySkin,this.spriteStatus.headSkin],subentities:[]}},s.prototype._drawCharacter=function(e){this.lastRendering=Date.now();var t=this;this.characterDisplay.setLook(this._buildEntityLook(),{boneType:"characters/",skinType:"characters/",direction:this.orientation},function(){e&&L(t.characterDisplay,300,50)})},s.prototype._selectColor=function(e,t){var i=this.colorButtons[e];(i!==this.selectedColorBtn||t)&&(this.selectedColorBtn&&this.selectedColorBtn.deselect(),this.selectedColorBtn=i,i.select(),this.colorPicker.setCurrentColor(i.getColor().rgb))},s.prototype._resetColorButton=function(e){var t=(this.sex===ne?"female":"male")+"Colors",i=this.allBreeds[this.breedId][t][e.id];m(e,i,!1)},s.prototype._resetColors=function(e){for(var t=0;t<g.CHARACTER_COLORS;t++){var i=this.colorButtons[t];e&&i.isCustomColor()||this._resetColorButton(i)}this._selectColor(0,!0)},s.prototype._loadColors=function(e,t){for(var i=0;i<g.CHARACTER_COLORS;i++)null!==e[i]?m(this.colorButtons[i],e[i],t):this._resetColorButton(this.colorButtons[i])},s.prototype._needsNameCheck=function(){return!this.relookingParams||this.relookingParams.canRename}},function(e,t){},function(e,t,i){function n(e,t,i,n){n=n||{},this.myWindow=e,this.id=t,this.active=n.active,this.selected=!1,this.currentColor=null,this.isCustom=!1,a.call(this,"div",{className:"plusColorButton"}),r(this),this.active&&i&&"function"==typeof i?this.on("tap",i):this.addClassNames("inactive"),this.plainColor=this.createChild("div",{className:"plainColor"})}i(1190);var o=i(424),s=i(191).inherits,a=i(235),r=i(228);s(n,a),e.exports=n,n.prototype.select=function(){this.addClassNames("selected"),this.selected=!0},n.prototype.deselect=function(){this.delClassNames("selected"),this.selected=!1},n.prototype.isCustomColor=function(){return this.isCustom},n.prototype.setColor=function(e,t){this.isCustom=t,this.currentColor=e,e?(this.plainColor.setStyle("display","block"),this.plainColor.setStyle("background",e.hex),this.plainColor.setStyle("background","-moz-linear-gradient(top,  #ffffff 0%, "+e.hex+" 14%, "+e.hex+" 85%, "+e.hex+" 85%, #110f0d 100%)"),this.plainColor.setStyle("background","-webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(14%,"+e.hex+"), color-stop(85%,"+e.hex+"), color-stop(85%,"+e.hex+"), color-stop(100%,#110f0d))"),this.plainColor.setStyle("background","-webkit-linear-gradient(top,  #ffffff 0%,"+e.hex+" 14%,"+e.hex+" 85%,"+e.hex+" 85%,#110f0d 100%)"),this.plainColor.setStyle("background","-o-linear-gradient(top,  #ffffff 0%,"+e.hex+" 14%,"+e.hex+" 85%,"+e.hex+" 85%,#110f0d 100%)"),this.plainColor.setStyle("background","-ms-linear-gradient(top,  #ffffff 0%,"+e.hex+" 14%,"+e.hex+" 85%,"+e.hex+" 85%,#110f0d 100%)"),this.plainColor.setStyle("background","linear-gradient(to bottom,  #ffffff 0%,"+e.hex+" 14%,"+e.hex+" 85%,"+e.hex+" 85%,#110f0d 100%)")):this.plainColor.setStyle("display","none")},n.prototype.getColor=function(){return this.currentColor},n.prototype.randomize=function(){var e=Math.floor(255*Math.random()),t=Math.floor(255*Math.random()),i=Math.floor(255*Math.random()),n=[e,t,i];n={rgb:n,hex:o.colorArrayToHexa(n)},this.setColor(n,!0)}},function(e,t){},function(e,t,i){function n(e,t){function i(e){!e.regex||e.regex instanceof RegExp||(e.regex=new RegExp(e.regex,e.regexFlags))}s.call(this,e,t),this.addClassNames("InputBoxValidated");var n="",o=this.onChangeRules=e.onChangeRules||[],a=this.onSubmitRules=e.onSubmitRules||[],r=void 0===e.blockInvalidInput||e.blockInvalidInput;o.forEach(i),a.forEach(i),this.on("change",function(e){for(var t=[],i=0;i<o.length;i+=1){var s=o[i],a=void 0===s.expectedResult||s.expectedResult;
s.regex&&s.regex.test(e)!==a&&(s.transform?e=s.transform(e):t.push({error:s.error}))}t.length>0&&r?this.setValue(n,!1):(n=e,this.setValue(n,!1)),t.length>0?(this.addClassNames("invalid"),this.emit("validationFailed",t)):(this.delClassNames("invalid"),this.emit("validationPassed"))})}i(1192);var o=i(191).inherits,s=i(582);o(n,s),e.exports=n,n.prototype.getValue=function(e){var t=s.prototype.getValue.call(this);if(e=void 0===e||e,!e)return t;var i,n,o,a=[];for(i=0;i<this.onChangeRules.length;i+=1)n=this.onChangeRules[i],o=void 0===n.expectedResult||n.expectedResult,n.regex&&n.regex.test(t)!==o&&n.error&&a.push({error:n.error});for(i=0;i<this.onSubmitRules.length;i+=1)n=this.onSubmitRules[i],o=void 0===n.expectedResult||n.expectedResult,n.regex&&n.regex.test(t)!==o&&n.error&&a.push({error:n.error});return 0===a.length?(this.delClassNames("invalid"),this.emit("validationPassed"),t):(this.addClassNames("invalid"),this.emit("validationFailed",a),!1)}},function(e,t){},function(e,t,i){function n(e){e=e||{},s.call(this,"div",e),this.addClassNames("InputBoxErrors"),this.setText(e.text||"")}i(1194);var o=i(191).inherits,s=i(235);o(n,s),e.exports=n,n.prototype.setText=function(e){s.prototype.setText.call(this,e),e?this.show():this.hide()}},function(e,t){},function(e,t){t.onChangeRules=[{regex:"^[a-z]$",expectedResult:!1,transform:function(e){return e.toUpperCase()}},{regex:"([A-Z].*|\\[[A-Z].*|)$",error:"tablet.charCrea.name.capStart"},{regex:"^[a-z-\\[\\]]*$",regexFlags:"i",error:"tablet.charCrea.name.lettersDashes"},{regex:"[\\s]+",expectedResult:!1,error:"tablet.charCrea.name.noSpaces"},{regex:"^(-|[a-z]-)",expectedResult:!1,regexFlags:"i",error:"tablet.charCrea.name.no1st2ndDash"},{regex:"^.*-.*-",expectedResult:!1,error:"tablet.charCrea.name.1DashMax"},{regex:"^.*[^-\\[][A-Z]",expectedResult:!1,error:"tablet.charCrea.name.capAfterDash"},{regex:"(.)\\1{2,}",expectedResult:!1,regexFlags:"i",error:"tablet.charCrea.name.identical2Consec"},{regex:"([b-df-hj-np-tv-xz]){4,}",expectedResult:!1,regexFlags:"i",error:"tablet.charCrea.name.consonants3Consec"},{regex:"^[\\S]{,20}$",expectedResult:!1,error:"tablet.charCrea.name.nameLength"}],t.onSubmitRules=[{regex:"^[\\S]{3,20}$",error:"tablet.charCrea.name.nameLength"},{regex:"[aeiouy]+",regexFlags:"i",error:"tablet.charCrea.name.must1Vowel"}]},function(e,t,i){function n(){function e(e){e=e||{},l._totalFailure=0,l._totalSuccess=0,l._done=0;var t=[],i=l._mySlotElems.getGivenIngredientsInfo(),n=l._targetSlotElems.getGivenIngredientsInfo();i.length>0&&n.length<=0&&(t=i,t.push(l._mySlotElems.getRuneSignatureInfo()));var o=l.jobsData.checkRecipe(l._skillId);if(l._skillId===l.jobsData.SKILLID_DECRAFT)for(var s=0;s<t.length;s+=1){var a=t[s];a.GID&&(o.itemToCraft.ingredientIds.push(a.GID),o.itemToCraft.quantities.push(a.quantity))}l._craftResultBox.checkRecipe(t,o),o.isRecipeKnown&&!e.keepResultVisible?(l._itemResult.hide(),l._craftResultBox._clearProgress(),l.highlightedRecipeId=o.itemToCraft.resultId):l.highlightedRecipeId=null,l._recipeList.highlightRecipe(l.highlightedRecipeId)}function t(e){e=e||{count:0};var t=e.count||0;l._done=l._totalQty-t,l._craftResultBox.setProgress(l._done,l._totalQty)}function i(i){var n=i.reason;c.displayAutoCraftStopReasonMessage(n),l._isInAutoCraft=!1,n===p.STOPPED_REASON_OK&&t({count:0}),e({keepResultVisible:!0}),l._restoreMergeStopButtons()}function n(e){var n=e._messageType;if(l.openState)switch(n){case"ExchangeCraftResultMessage":case"ExchangeCraftResultWithObjectIdMessage":case"ExchangeCraftResultWithObjectDescMessage":l._onResultEvents(e);break;case"ExchangeReplayCountModifiedMessage":l._updateQtyToCraft(e);break;case"ExchangeItemAutoCraftRemainingMessage":t(e);break;case"ExchangeItemAutoCraftStopedMessage":i(e);break;case"ExchangeCraftSlotCountIncreasedMessage":l._slotCountIncreased(e);break;default:console.error(new Error(n+" not handle by CraftingWindow"))}}s.call(this,{className:"CraftingWindow",title:"",noCloseButton:!0,positionInfo:{left:"0.5%",bottom:"2%",width:"76%",height:"95%",isDefault:!0}});var o={left:"0.5%",bottom:"2%",width:320,height:"95%"};this._positionInfos={decrafting:o,wrapping:o};var r={right:"0.5%",bottom:"2%",width:"34.8%",height:"95%"};this._inventoryPositionInfos={decrafting:r,wrapping:r},this._mergeLabels={crafting:a("ui.common.merge"),decrafting:a("ui.common.decraft")};var l=this,h=window.gui;this._domCreated=!1,this._recipeList=null,this._mySlotElems=null,this._targetSlotElems=null,this._craftResultBox=null,this._itemResult=null,this._totalQty=1,this._done=0,this._isInAutoCraft=!1,this._skillId=null,this.jobsData=h.playerData.jobs,this._updateQtyToCraft=function(e){l._totalQty=e.count,l._craftResultBox.setQty(l._totalQty,!0),l._isInAutoCraft=l._totalQty>1},this.addAndModifySlots=function(t){d.createItemInstances(t,function(t,i){if(t)return console.error("Crafting: addAndModifySlots cannot createItemInstances",t);var n=i.array[0];h.playerData.inventory.objects[n.objectUID]?l._mySlotElems.addAndModifySlot(n):l._targetSlotElems.addAndModifySlot(n),l._mySlotElems.setNbSlots(),l._targetSlotElems.setNbSlots(),e()})},this.objectRemoved=function(t){l._targetSlotElems.removeIngredient(t),l._mySlotElems.removeIngredient(t),l._mySlotElems.setNbSlots(),l._targetSlotElems.setNbSlots(),e()},this._onResultEvents=function(e){l._onResult(e,function(e,t){return e?console.error("Crafting: onResult error",e):void l.giveTheResult(t.objectInfo,t.message)})},this._slotCountIncreased=function(e){var t=e.newMaxSlot;l._updateRecipeList(t),l._updateSlotElems(t)},this._updateSlotElems=function(e){l._updateMySlotElems(e)},h.on("ExchangeCraftResultMessage",n),h.on("ExchangeCraftResultWithObjectIdMessage",n),h.on("ExchangeCraftResultWithObjectDescMessage",n),h.on("ExchangeReplayCountModifiedMessage",n),h.on("ExchangeItemAutoCraftRemainingMessage",n),h.on("ExchangeItemAutoCraftStopedMessage",n),h.on("ExchangeCraftSlotCountIncreasedMessage",n),this.on("open",function(e){l._domCreated||l._createDom(),l._onOpen(e)}),this.on("close",function(){l._mySlotElems.clear(),l._targetSlotElems.clear(),l._recipeList.reset(),l._craftResultBox.clear(),l.jobsData.clearAfterCraft(),l._skillId=null,l._paymentButton.hide(),u.close("craftPayment")}),this.on("closed",function(){this._updatePerCraftType()}),this._buttonMergeAction=function(){function e(){window.dofus.sendMessage("ExchangeReadyMessage",{ready:!0,step:2}),l._isInAutoCraft?l._buttonMerge.disable():l._restoreMergeStopButtons()}var t=l._mySlotElems.getGivenIngredientsInfo().length;if(t+=l._targetSlotElems.getGivenIngredientsInfo().length,!(t<1))return l._skillId!==l.jobsData.SKILLID_DECRAFT?e():void window.gui.openConfirmPopup({title:a("ui.popup.warning"),message:a("ui.craft.decraftConfirm"),cb:function(t){t&&e()}})}}i(1197);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(1015),l=i(246).DofusButton,c=i(710),u=i(225),d=i(509),h=i(1198),p=i(711),m=i(951),f=i(1199),g=i(1201),_=i(383);o(n,s),e.exports=n,n.prototype._restoreMergeStopButtons=function(){this._stopBtn.disable(),this._buttonMerge.enable()},n.prototype._createDom=function(){var e=this,t=this.windowBody.createChild("div",{className:"col1"}),i=this.windowBody.createChild("div",{className:"col2"});this._recipeList=t.appendChild(new r({isInCraft:!0})),this._recipeList.on("recipeSelected",function(t){return this.isRecipeCraftableFromInventory(t)?void(t!==e.highlightedRecipeId?window.dofus.sendMessage("ExchangeSetCraftRecipeMessage",{objectGID:t}):e._totalQty<e._craftResultBox.getMaxQuantity()?e._requestReplayCountChange(e._totalQty+1):e._craftResultBox.setQty(e._totalQty,!0)):window.gui.openSimplePopup(a("ui.craft.dontHaveAllIngredient"))}),this._targetSlotElems=i.appendChild(new g),this._mySlotElems=i.appendChild(new g),_.on("dragStart",e.localizeEvent(function(t,i){switch(i){case"craftInventory":e._mySlotElems.showDropHighlight(t.getItem()),t.once("dragEnd",function(){e._mySlotElems.hideDropHighlight()});break;case"recipeList":e._craftResultBox.selectSlot(!0),t.once("dragEnd",function(){e._craftResultBox.selectSlot(!1)})}})),this._craftResultBox=i.appendChild(new f),this._craftResultBox.on("craftReplayCount",function(t){e._requestReplayCountChange(t)});var n=i.createChild("div",{className:"buttonsContainer"});this._buttonMerge=n.appendChild(new l(a("ui.common.merge"),{className:"mergeButton"})),this._buttonMerge.on("tap",e._buttonMergeAction),this._stopBtn=n.appendChild(new l(a("ui.common.stop"),{className:"stopButton",disable:!0})),this._stopBtn.on("tap",function(){window.dofus.sendMessage("ExchangeReplayStopMessage")}),this._paymentButton=n.appendChild(new l(a("ui.common.payment"),{className:"paymentButton"})),this._paymentButton.on("tap",function(){u.open("craftPayment")}),this._itemResult=i.createChild("div",{className:"itemResult"});var o=this._itemResult.createChild("div",{className:"titleBar"});this._itemName=o.createChild("div",{className:"itemName"}),this._itemLevel=o.createChild("div",{className:"itemLevel"}),this._itemDescription=this._itemResult.appendChild(new m),this._domCreated=!0},n.prototype._requestReplayCountChange=function(e){window.dofus.sendMessage("ExchangeReplayMessage",{count:e})},n.prototype._updateRecipeList=function(e){var t=this.jobsData.getRecipesBySkill(this._skillId);this._recipeList.addRecipes(t,{nbCase:e,mode:"craft"});var i=e>8?8:e;this.jobsData.setExistingSlotCount(i),this.toggleClassName("noRecipe",!t.length)},n.prototype._updatePerCraftType=function(e){u.positionWindow(this.id,this._positionInfos[e]),u.positionWindow("craftInventory",this._inventoryPositionInfos[e]),this._buttonMerge.setText(this._mergeLabels[e]||this._mergeLabels.crafting)},n.prototype._updateMySlotElems=function(e){var t=9===e;this._mySlotElems.setNbSlots(),this._mySlotElems.toggleSignatureSlot(t)},n.prototype._onOpen=function(e){var t=e.msg;this._skillId=t.skillId,this._totalQty=1,this._totalFailure=0,this._totalSuccess=0,this.highlightedRecipeId=null,this._craftResultBox.clear(),this._itemResult.hide(),this._targetSlotElems.hide(),this._paymentButton.hide(),this._restoreMergeStopButtons(),this._mySlotElems.setPlayerName(window.gui.playerData.characterBaseInformations.name);var i,n=t.maxCase||t.nbCase;i=void 0===e.isCrafter?"SOLO":e.isCrafter?"CRAFTER":"CLIENT",this.jobsData.startCraftingSession(i,this._skillId,n),this.jobsData.on("objectAdded",this.addAndModifySlots),this.jobsData.on("objectModified",this.addAndModifySlots),this.jobsData.on("objectRemoved",this.objectRemoved),this._updateRecipeList(n),this._updateSlotElems(n),this._updatePerCraftType(e.type)},n.prototype._onResult=function(e,t){var i="",n=null,o=window.gui,s=this,r="",l=e.craftResult,c=e.objectInfo&&e.objectInfo.quantity||1;return c>1&&this._updateQtyToCraft({count:0}),n=e.objectGenericId||e.objectInfo&&e.objectInfo.objectGID,l===h.CRAFT_IMPOSSIBLE?(s._totalFailure+=c,i=a("ui.craft.noResult"),o.openSimplePopup(i)):l===h.CRAFT_FAILED&&(s._totalFailure+=c,s._isInAutoCraft||o.openSimplePopup(a("ui.craft.failed"))),s._isInAutoCraft||s._restoreMergeStopButtons(),n?void d.getItems([n],function(o){if(o)return t(o);var u=d.items[n];r=u.nameId,l===h.CRAFT_SUCCESS&&(s._totalSuccess+=c,i=a("ui.craft.craftSuccessSelf",c,r)),t(null,{objectName:r,objectInfo:e.objectInfo,craftResult:l,message:i})}):t(null,{objectName:r,objectInfo:e.objectInfo,craftResult:l,message:i})},n.prototype.giveTheResult=function(e,t){function i(e){d.createItemInstances(e,function(t,i){if(t)return console.error("Crafting: updateItemResultDescription Failed to create item instances",t);var n=i.map[e.objectUID];o._itemDescription.displayItem(n),o._itemName.setText(n.item.nameId),o._itemLevel.setText(a("ui.common.short.level")+n.item.level),o._itemResult.show()})}var n=window.gui,o=this;t&&n.chat.logMsg(t),this._recipeList.refreshDisplayedRecipes(),e&&i(e),this._craftResultBox.updateFailSuccessValues(this._totalFailure,this._totalSuccess)}},function(e,t){},function(e,t){e.exports={CRAFT_IMPOSSIBLE:0,CRAFT_FAILED:1,CRAFT_SUCCESS:2,CRAFT_NEUTRAL:3}},function(e,t,i){function n(){s.call(this,"div",{className:["CraftResultBox","hoverable"]});var e=this;this._maxQuantity=this._currentQuantity=1,this._minMaxSelector=this.appendChild(new r),this._minMaxSelector.on("confirm",function(t){e.emit("craftReplayCount",t)});var t=this.createChild("div",{className:"resultContainer"}),i=t.createChild("div",{className:"resultObjectBox"});this._resultSlot=i.appendChild(new u);var n=i.createChild("div",{className:"resultNameBox"});this._resultName=n.createChild("div",{className:"label"});var o=t.createChild("div",{className:"secondRow"}),c=this._qtyButton=o.appendChild(new d({className:"quantityBtn"}));this._quantity=c.createChild("div",{className:"quantity",text:"x1"}),c.createChild("div",{className:"btnIcon"});var p=this.successFailBox=o.createChild("div",{className:"successFailBox",hidden:!0}),m=p.createChild("div",{className:"nameCol"});m.createChild("div",{className:"label",text:a("ui.craft.success")+a("ui.common.colon")}),m.createChild("div",{className:"label",text:a("ui.craft.failure")+a("ui.common.colon")});var f=p.createChild("div",{className:"valueCol"});this._successValue=f.createChild("div",{className:"value"}),this._failureValue=f.createChild("div",{className:"value"}),this._progressLine=t.createChild("div",{className:"progressBox",hidden:!0}),this._progressBar=this._progressLine.appendChild(new l({className:["progressBar","orange"]})),this._progressValue=this._progressLine.createChild("div",{className:"value"}),h.setDroppable(this,["recipeList"]),this.on("drop",function(e,t,i){i.selectRecipe()}),this._qtyButton.disable(),this._qtyButton.on("tap",function(){e._minMaxSelector.open({min:1,max:e._maxQuantity,defaultValue:e._currentQuantity})})}i(1200);var o=i(191).inherits,s=i(235),a=i(29).getText,r=i(386),l=i(605),c=i(509),u=i(832),d=i(246),h=i(383),p=350;o(n,s),e.exports=n,n.prototype.prepareItem=function(e){var t=this;c.getItems([e],function(i){if(i)return console.error(i);var n=c.items[e];t._resultSlot.setItem(n),t._resultName.setText(n.nameId)})},n.prototype.setQty=function(e,t){this._currentQuantity=e,this._quantity.setText("x "+e),t&&(this._qtyButton.addClassNames("highlighted"),this.highlightTimeout&&window.clearTimeout(this.highlightTimeout),this.highlightTimeout=window.setTimeout(function(e){e._qtyButton.delClassNames("highlighted")},p,this))},n.prototype._setMaxQuantity=function(e){this._maxQuantity=e},n.prototype.setProgress=function(e,t){if(1===e){if(t<=1)return;this._progressLine.show(),this._progressBar.setValue(e)}this._progressBar.setValue(e/t),this._progressValue.setText(e+" / "+t)},n.prototype.updateFailSuccessValues=function(e,t){this.successFailBox.show(),this._failureValue.setText(e),this._successValue.setText(t)},n.prototype.checkRecipe=function(e,t){function i(){var t,i,n=window.gui.playerData,o=n.inventory.objects,s={},a=-1;for(t=0,i=e.length;t<i;t+=1){var r=e[t];if(o[r.UID]){var l=o[r.UID].quantity;s[r.GID]=l}}for(t=0,i=e.length;t<i;t+=1)if(e[t].GID){var c=e[t].GID,u=e[t].quantity,d=s[c],h=Math.floor(d/u);(a===-1||a>h)&&(a=h)}var p=s[n.jobs.RUNE_SIGNATURE_GID];return p&&a>p&&(a=p),a}var n=e.length<=0;if(t.isRecipeKnown?this.prepareItem(t.itemToCraft.resultId):this._clearItem(),n)this._qtyButton.disable(),this._setMaxQuantity(1);else{this._qtyButton.enable();var o=i();this._setMaxQuantity(o)}},n.prototype.getMaxQuantity=function(){return this._maxQuantity},n.prototype._clearItem=function(){this._resultSlot.unset(),this._resultName.setText(""),this.setQty(1),this._qtyButton.disable()},n.prototype.toggleReady=function(e){this.toggleClassName("isReady",e)},n.prototype._clearProgress=function(){this._progressLine.hide(),this.successFailBox.hide()},n.prototype.clear=function(){this._clearItem(),this._clearProgress(),this._setMaxQuantity(1)},n.prototype.selectSlot=function(e){this._resultSlot.toggleClassName("selected",e)}},function(e,t){},function(e,t,i){function n(){function e(e){s.moveItemToCraft("craftInventory",o,e)}function t(t,i){return o=t,o.objectGID===s.RUNE_SIGNATURE_GID?e(1):1===i?e(1):void n._minMaxSelector.open({min:1,max:i})}function i(e,t,i){return!this._isRemote&&(!!e.slot&&s.howManyCanBeAddedToCraft(i,e.slot.getItem(),1)>0)}c.call(this,"div",{className:["CraftActorBox","hoverable"]});var n=this;this._usedSlots=0,this._runeSignatureUid=null,this.highlightedSlots=[],this._minMaxSelector=this.appendChild(new u),this._minMaxSelector.setStyles({left:"20px",top:"30px"});var o=null,s=this.jobsData=window.gui.playerData.jobs;this._minMaxSelector.on("confirm",e);var r=this.createChild("div",{className:"wrapper"}),l=this._slotsContainer=r.createChild("div",{className:"slotsContainer"});a.setDroppable(this,["craftInventory"],{isDropAllowed:i}),this.on("drop",function(e){t(e.itemInstance,e.getQuantity())}),this._playerName=l.createChild("div",{className:"playerName"}),this._playerRole=l.createChild("div",{className:"playerRole"}),this._allSlots=l.createChild("div",{className:"allSlots"}),this._signatureSlot=l.appendChild(this._createItemSlot("signatureSlot")),this._signatureSlot.hide();for(var d=0;d<s.MAX_CRAFT_SLOTS;d+=1)this._allSlots.appendChild(this._createItemSlot())}function o(e,t,i){return!!i.getItem()&&(this.backgroundImage=i.getImage(),!0)}function s(){this.craftActorBox._slotTapHandler(this)}i(1202);var a=i(383),r=i(832),l=i(191).inherits,c=i(235),u=i(386),d=i(29).getText;l(n,c),e.exports=n,n.prototype._createItemSlot=function(e){var t=new r({noDoubleTap:!0});return e&&t.addClassNames(e),t.on("tap",s),t.craftActorBox=this,this._isRemote||a.setDraggable(t,{prepareForDrag:o},"crafting",{slot:t}),t},n.prototype._slotTapHandler=function(e){if(!this._isRemote){var t=e.getItem();if(t){var i=this.jobsData.getQuickTransferInfo("crafting",t,e.getQuantity());e!==this.selectedSlot?(window.gui.openContextualMenuAround("item",e,{item:t}),this._selectCurrentSlot(e,i.movedQty>1?"stackMove":"")):this.jobsData.removeItemFromCraft(t.objectUID,i.movedQty)}}},n.prototype._selectCurrentSlot=function(e,t){this.selectedSlot&&this._unselectCurrentSlot(),this.selectedSlot=e,e.select({extraStyle:t})},n.prototype._unselectCurrentSlot=function(){this.selectedSlot&&(this.selectedSlot.unselect(),this.selectedSlot=null)},n.prototype.setNbSlots=function(){for(var e=this._allSlots.getChildren(),t=this._usedSlots+this.jobsData.getFreeSlotCount(),i=0,n=e.length;i<n;i+=1){var o=e[i],s=i>=t;o.toggleClassName("locked",s),o.isLocked=s}},n.prototype.toggleSignatureSlot=function(e){this._signatureSlot.toggleDisplay(e)},n.prototype.showDropHighlight=function(e){if(this.highlightedSlots=[],e.objectGID===this.jobsData.RUNE_SIGNATURE_GID)this.highlightedSlots.push(this._signatureSlot);else for(var t=this._allSlots.getChildren(),i=0;i<t.length;i++){var n=t[i],o=n.getItem();if(o&&o.objectUID===e.objectUID){this.highlightedSlots=[n];break}o||n.isLocked||this.highlightedSlots.push(n)}for(var s=0;s<this.highlightedSlots.length;s++)this.highlightedSlots[s].addClassNames("selected")},n.prototype.hideDropHighlight=function(){for(var e=0;e<this.highlightedSlots.length;e++)this.highlightedSlots[e].delClassNames("selected");this.highlightedSlots=[]},n.prototype.setAsRemote=function(){this._isRemote=!0,this._slotsContainer.addClassNames("client")},n.prototype.setPlayerName=function(e){this._playerName.setText(e)},n.prototype.toggleReady=function(e){this.toggleClassName("isReady",e)},n.prototype._findSlotByUID=function(e){for(var t=this._allSlots.getChildren(),i=0,n=t.length;i<n;i+=1){var o=t[i];if(o.itemInstance&&o.itemInstance.objectUID===e)return i}return null},n.prototype.addAndModifySlot=function(e){var t,i=this._allSlots.getChildren();if(e.objectGID===this.jobsData.RUNE_SIGNATURE_GID)return this._runeSignatureUid=e.objectUID,void this._signatureSlot.setItem(e);var n=this._findSlotByUID(e.objectUID);n||0===n?(t=i[n],t.setItem(e)):(t=i[this._usedSlots],t.setItem(e),this._usedSlots+=1)},n.prototype.removeIngredient=function(e){if(e===this._runeSignatureUid)return this._signatureSlot.unselect(),this._signatureSlot.unset(),void(this._runeSignatureUid=null);var t=this._findSlotByUID(e);if(t||0===t){this._unselectCurrentSlot();for(var i=this._allSlots.getChildren(),n=t+1;n<i.length;n++)i[n-1].setItem(i[n].getItem());i[i.length-1].unset(),this._usedSlots-=1}},n.prototype.getGivenIngredientsInfo=function(){for(var e=this._allSlots.getChildren(),t=[],i=0,n=e.length;i<n;i+=1){var o=e[i].itemInstance;o&&t.push({UID:o.objectUID,GID:o.objectGID,quantity:o.quantity})}return t},n.prototype.getRuneSignatureInfo=function(){var e=this._signatureSlot.itemInstance;return e?{UID:e.objectUID,GID:e.objectGID,quantity:e.quantity}:{}},n.prototype.setCrafterJobLevel=function(e,t,i){t?this._playerRole.setText(i+" "+d("ui.common.short.level")+" "+t):this._playerRole.setText(d("ui.craft.client"))},n.prototype.clear=function(){this._unselectCurrentSlot(),this.hideDropHighlight(),this._minMaxSelector.hide(),this._isRemote=!1,this._usedSlots=0,this._runeSignatureUid=null,this._signatureSlot.unset(),this._signatureSlot.hide();for(var e=this._allSlots.getChildren(),t=0;t<e.length;t++)e[t].unset();this.setNbSlots()}},function(e,t){},function(e,t,i){function n(){function e(){u+=1}function t(e){var t=e.ready,i=o._buttonMerge;o._craftResultBox.toggleReady(t),o._mySlotElems.toggleReady(t),o._targetSlotElems.toggleReady(t),t?c.playerData.id===e.id&&(i.setText(s("ui.common.cancel")),o._restoreMergeStopButtons()):(i.setText(s("ui.common.merge")),o._isReady=!1)}function i(){o._craftResultBox.toggleReady(!1),o._mySlotElems.toggleReady(!1),o._targetSlotElems.toggleReady(!1),o._buttonMerge.setText(s("ui.common.merge")),o._isReady=!1}function n(i){var n=i._messageType;if(o.openState)switch(n){case"ExchangeObjectAddedMessage":case"ExchangeObjectModifiedMessage":case"ExchangeObjectRemovedMessage":case"ExchangeGoldPaymentForCraftMessage":case"ExchangeItemPaymentForCraftMessage":case"ExchangeModifiedPaymentForCraftMessage":case"ExchangeRemovedPaymentForCraftMessage":case"ExchangeClearPaymentForCraftMessage":e();break;case"ExchangeIsReadyMessage":t(i);break;default:console.error(new Error(n+" not handle by CraftingMultiWindow"))}}a.call(this);var o=this,c=window.gui;this.jobsData=c.playerData.jobs,this._mySlotElems=null,this._targetSlotElems=null,this._craftResultBox=null,this._isReady=!1,this._otherName="";var u=0;this._updateSlotElems=function(e){o._updateMySlotElems(e);var t=9===e;o._targetSlotElems.setPlayerName(o._otherName),o._targetSlotElems.setNbSlots(),o._targetSlotElems.setAsRemote(),o._mySlotElems.toggleSignatureSlot(t&&"CRAFTER"===o.jobsData.craftSide),o._targetSlotElems.toggleSignatureSlot(t&&"CLIENT"===o.jobsData.craftSide)},this._onResultEvents=function(e){i(),o._buttonMerge.disable(),o._onResult(e,function(e,t){if(e)return console.error("Crafting multi: onResult error",e);var i=t.message,n=t.craftResult,a=t.objectInfo,l=t.objectName,c=a&&a.quantity||1;n===r.CRAFT_SUCCESS&&(i="CRAFTER"===o.jobsData.craftSide?s("ui.craft.successTarget",c,l,o._otherName):s("ui.craft.successOther",o._otherName,c,l)),o.giveTheResult(a,i)})},c.on("ExchangeObjectAddedMessage",n),c.on("ExchangeObjectModifiedMessage",n),c.on("ExchangeObjectRemovedMessage",n),c.on("ExchangeGoldPaymentForCraftMessage",n),c.on("ExchangeItemPaymentForCraftMessage",n),c.on("ExchangeModifiedPaymentForCraftMessage",n),c.on("ExchangeRemovedPaymentForCraftMessage",n),c.on("ExchangeClearPaymentForCraftMessage",n),c.on("ExchangeIsReadyMessage",n),this.on("close",function(){o._otherName="",u=0,i(),l.close("craftPayment")}),this._buttonMergeAction=function(){var e=o._mySlotElems.getGivenIngredientsInfo().length;e+=o._targetSlotElems.getGivenIngredientsInfo().length,e<1||(o._isReady=!o._isReady,window.dofus.sendMessage("ExchangeReadyMessage",{ready:o._isReady,step:u}))}}var o=i(191).inherits,s=i(29).getText,a=i(1196),r=i(1198),l=i(225);o(n,a),e.exports=n,n.prototype._onOpen=function(e){var t=e&&e.sourceName||"",i=e&&e.targetName||"",n=window.gui.playerData.characterBaseInformations.name,o=t===n;this._otherName=o?i:t;var s=e&&e.isCrafter;a.prototype._onOpen.call(this,e),l.close("cancel",{keepDialog:!0});var r=e&&e.msg||{},c=r.enrichData&&r.enrichData.jobName||"";this._targetSlotElems.setCrafterJobLevel(r.skillId,r.crafterJobLevel,c),this._targetSlotElems.show(),this._paymentButton.show();var u=l.getWindow("craftPayment");u.setForCrafter(s),u.setOnSuccess(!1)}},function(e,t,i){function n(){function e(){d.open("crafter",{crafter:this.crafter,job:T})}function t(){window.gui.openContextualMenu("player",{playerId:this.playerInfo.playerId,accountId:b.accountId,playerName:this.playerInfo.playerName})}function i(e){var t=new p("div",{className:"avatar"}),i="gfx/heads/SmallHead_"+e.breed+(e.sex?0:1)+".png";return m.preloadImage(i,function(e){t&&t.rootElement&&t.setStyle("backgroundImage",e)}),t}function n(e){var i=new h({className:"userNameButton",text:e.playerName});return i.playerInfo=e,i.on("tap",t),i}function s(t){var s=t||{},a=new h;a.crafter=s,a.on("tap",e);var r=0!==(s.jobInfo.userDefinedParams&o.CRAFT_OPTION_NOT_FREE),l="( "+s.playerInfo.worldX+","+s.playerInfo.worldY+" )",c=s.playerInfo.isInWorkshop?l:"-",u={avatar:i(s.playerInfo),name:n(s.playerInfo),level:s.jobInfo.jobLevel,coord:c,cost:r?I:A,nbSlots:s.jobInfo.minSlots,button:a};return u}function f(e){if(b.table.clearContent(),e.length)for(var t=0;t<e.length;t+=1)g(e[t])}function g(e){var t=b.table.addRow(s(e));C[e.playerInfo.playerId]=t}function _(e){var t=C[e.playerId],i=b.table.getRows().indexOf(t);b.table.delRow(i),delete C[e.playerId]}function v(e){var t=C[e.playerInfo.playerId],i=b.table.getRows().indexOf(t);b.table.updateRow(i,s(e))}function y(){b.selector.clearContent(),b.table.clearContent()}a.call(this,{className:"CraftersListWindow",title:r("ui.craft.craftersList"),positionInfo:{top:"c",left:"c",width:600,height:480}});var b=this,w=window.gui,M=[],T={},C={},I=r("ui.common.yes"),A=r("ui.common.no");w.on("ExchangeStartOkJobIndexMessage",function(e){d.openDialog(b.id,{msg:e})}),w.on("JobCrafterDirectoryListMessage",function(e){f(e.listEntries)}),w.on("JobCrafterDirectoryAddMessage",function(e){return C[e.listEntry.playerInfo.playerId]?v(e.listEntry):void g(e.listEntry)}),w.on("JobCrafterDirectoryRemoveMessage",_),this.once("open",function(){b.selector=b.windowBody.appendChild(new l),b.table=b.windowBody.appendChild(new c({colIds:["avatar","name","level","coord","cost","nbSlots","button"],colCount:7,highlightable:!0,headerContent:["","Name","Lvl.","coord","cost","nb",""]})),b.selector.on("change",function(e){return e<0?void b.table.clearContent():(T=e,void window.dofus.sendMessage("JobCrafterDirectoryListRequestMessage",{jobId:e.id}))})}),this.on("open",function(e){e=e||{},M=e.msg.jobs,u.getData("Jobs",M,function(e,t){if(e)return console.error(e);b.selector.clearContent(),b.selector.addOption(r("ui.craft.chooseJob"),-1);for(var i=0;i<t.length;i+=1){var n=t[i];b.selector.addOption(n.nameId,n)}1===t.length&&b.selector.select(t[0])})}),this.on("close",y)}i(1205);var o=i(1184),s=i(191).inherits,a=i(233),r=i(29).getText,l=i(586),c=i(735),u=i(30),d=i(225),h=i(246),p=i(235),m=i(202);s(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(e){n.characterDisplay.clear(),n.characterDisplay.setLook(e,{direction:l.DIRECTION_SOUTH,animation:"AnimStatique",boneType:"characters/",skinType:"characters/",riderOnly:!0})}function t(t,i){var o=t.playerInfo.playerId;window.gui.playerData.id===o?e(window.gui.playerData.characterBaseInformations.entityLook):window.dofus.sendMessage("ContactLookRequestByIdMessage",{contactType:r.SOCIAL_CONTACT_CRAFTER,playerId:t.playerInfo.playerId}),n.name.setText(t.playerInfo.playerName),n.jobName.setText(i.nameId),n.jobLevel.setText(t.jobInfo.jobLevel);var s=t.playerInfo.alignmentSide;s!==f.ALIGNMENT_ANGEL&&s!==f.ALIGNMENT_EVIL&&(s=f.ALIGNMENT_NEUTRAL);var l="gfx/alignments/wings/Artisan_tx_bg"+s+"_frame0.png";m.preloadImage(l,function(e){n.characterDisplay.setStyle("backgroundImage",e)}),n.nearCraftTable.setText(t.playerInfo.isInWorkshop?c:g),n.coordinates.setText("-"),t.playerInfo.isInWorkshop&&(n.coordinates.setText("( "+t.playerInfo.worldX+","+t.playerInfo.worldY+" )"),p.getData("SubAreas",t.playerInfo.subAreaId,function(e,t){if(e)return console.error(e);var i=window.gui.databases.Areas[t.areaId];n.location.setText(i.nameId+" ( "+t.nameId+" )")}));var u=t.jobInfo.userDefinedParams,d=0!==(u&a.CRAFT_OPTION_NOT_FREE),h=0!==(u&a.CRAFT_OPTION_NOT_FREE_EXCEPT_ON_FAIL),_=0!==(u&a.CRAFT_OPTION_RESOURCES_REQUIRED);n.checkboxNotFree.toggleActivation(d),n.freeOnFailCheckbox.toggleDisplay(!!i.specializationOfId),n.freeOnFailCheckbox.toggleActivation(h),n.checkboxRessourcesNeeded.toggleActivation(_),n.minItems.setText(t.jobInfo.minSlots),n.messageButton.enable()}function i(){n.characterDisplay.release(),delete n.crafter}u.call(this,{className:"CrafterWindow",title:d("ui.craft.crafter"),positionInfo:{top:"c",left:"c",width:550,height:380}});var n=this,c=d("ui.common.yes"),g=d("ui.common.no");this.once("open",function(){var i=this.windowBody.createChild("div",{className:"colsWrapper"}),a=i.createChild("div",{className:"col1"}),r=i.createChild("div",{className:"col2"}),l=a.createChild("div",{className:["block","blockCharacter"]});this.characterDisplay=l.appendChild(new s({scale:2})),this.characterDisplay.clear();var c=r.createChild("div",{className:["block","blockInfos"]});c.createChild("div",{className:"title",text:d("ui.common.informations")});var u=c.createChild("div",{className:"line"});u.createChild("div",{className:"label",text:d("ui.common.name")}),this.name=u.createChild("div",{className:["value","name"]});var p=c.createChild("div",{className:"line"});p.createChild("div",{className:"label",text:d("ui.craft.job")}),this.jobName=p.createChild("div",{className:["value","job"]});var m=c.createChild("div",{className:"line"});m.createChild("div",{className:"label",text:d("ui.craft.jobLevel")}),this.jobLevel=m.createChild("div",{className:["value","jobLevel"]});var f=r.createChild("div",{className:["block","blockLocation"]});f.createChild("div",{className:"title",text:d("ui.common.localisation")});var g=f.createChild("div",{className:"line"});this.location=g.createChild("div",{className:["value","location"]});var _=f.createChild("div",{className:"line"});_.createChild("div",{className:"label",text:d("ui.craft.nearCraftTable")}),this.nearCraftTable=_.createChild("div",{className:["value","nearCraftTable"]});var v=f.createChild("div",{className:"line"});v.createChild("div",{className:"label",text:d("ui.common.coordinates")}),this.coordinates=v.createChild("div",{className:["value","coordinates"]});var y=r.createChild("div",{className:["block","blockOptions"]});y.createChild("div",{className:"title",text:d("ui.craft.jobOptions")}),this.checkboxNotFree=y.appendChild(new h(d("ui.craft.notFree"))),this.checkboxNotFree.disable(),this.freeOnFailCheckbox=y.appendChild(new h(d("ui.craft.freeIfFailed"))),this.freeOnFailCheckbox.addClassNames("freeOnFail"),this.freeOnFailCheckbox.disable(),this.checkboxRessourcesNeeded=y.appendChild(new h(d("ui.craft.ressourcesNeeded"))),this.checkboxRessourcesNeeded.disable();var b=y.createChild("div",{className:"line"});b.createChild("div",{className:"label",text:d("ui.craft.minItemInCraft")}),this.minItems=b.createChild("div",{className:["value","minItems"]}),this.messageButton=this.windowBody.appendChild(new o(d("ui.common.wMessage"))),this.messageButton.addClassNames("messageButton"),this.messageButton.on("tap",function(){window.gui.chat.startPrivateMessage(n.crafter.playerInfo.playerName)}),window.gui.on("ContactLookMessage",function(t){n.crafter&&e(t.look)}),window.gui.on("JobCrafterDirectoryAddMessage",function(e){n.crafter&&e.listEntry.playerInfo.playerId===n.crafter.playerInfo.playerId&&(n.crafter=e.listEntry,t(n.crafter,n.job))}),window.gui.on("JobCrafterDirectoryRemoveMessage",function(e){n.crafter&&e.playerId===n.crafter.playerInfo.playerId&&n.messageButton.disable()})}),this.on("open",function(e){e=e||{},this.crafter=e.crafter,this.job=e.job,t(this.crafter,this.job)}),this.on("close",i)}i(1207);var o=i(246).DofusButton,s=i(415),a=i(1184),r=i(1208),l=i(457),c=i(191).inherits,u=i(233),d=i(29).getText,h=i(676),p=i(30),m=i(202),f=i(472);
c(n,u),e.exports=n},function(e,t){},function(e,t){e.exports={SOCIAL_CONTACT_FRIEND:0,SOCIAL_CONTACT_SPOUSE:1,SOCIAL_CONTACT_PARTY:2,SOCIAL_CONTACT_GUILD:3,SOCIAL_CONTACT_ALLIANCE:4,SOCIAL_CONTACT_CRAFTER:5,SOCIAL_CONTACT_INTERLOCUTOR:6}},function(e,t,i){function n(){g.call(this,{className:"CraftMagusWindow",title:"",positionInfo:{left:"0.5%",bottom:"2%",width:"76%",height:"95%"},noCloseButton:!0}),this._initialize(),this.once("open",this._createDom),this.on("open",this._onOpen),this.on("close",this._onClose)}function o(e,t,i){return!!e.slot&&this.myWindow.jobsData.canItemMove(i,"crafting",e.slot.getItem())}i(1210);var s=i(246).DofusButton,a=i(710),r=i(1198),l=i(383),c=i(29).getText,u=i(191).inherits,d=i(951),h=i(509),p=i(832),m=i(386),f=i(503),g=i(233),_=i(1211),v=a.SMITHMAGIC_RUNE_ID,y=a.SMITHMAGIC_POTION_ID,b=a.SIGNATURE_RUNE_ID,w=a.SIGNATURE_AVAILABLE_LEVEL,M=["item","rune","signatureRune"],T=53,C=56;u(n,g),e.exports=n,n.prototype._initVariables=function(e){this.isMultiCraft=!!e,this.exchangeStep=0,this.isInAutoCraft=!1,this.newItemInstance=null,this.newItemSlotType=null,this.skillId=null,this.skillData=null,this.droppedLocation="",this.droppedItemSource="",this.currentCraftingItem=null},n.prototype._initialize=function(){function e(){u.isInAutoCraft=!0,u._updateCraftingButtons(),d("ExchangeReplayMessage",{count:-1}),d("ExchangeReadyMessage",{ready:!0,step:u.exchangeStep})}function t(){u.isInAutoCraft=!1,u._updateCraftingButtons(),d("ExchangeReadyMessage",{ready:!0,step:u.exchangeStep})}function i(e){h.createItemInstances(e.object,function(e,t){if(e)return console.error("Craft Magus: updateSlot cannot createItemInstances",e);if(u.openState){var i=t.array[0],n=u._getItemSlotType(i.item),o=u._getSlotByType(n);o.setItem(i),o.dragUiInfo.backgroundImage=o.getImage(),l.enableDrag(o),"item"===n&&(u.currentCraftingItem=i,u.itemBox.displayItem(i),u.setItemBoxVisibility(!0)),u._updateCraftingButtons()}})}function n(e){var t=e.objectUID,i=u._getSlotTypeByUID(t);i&&(u._unselectCurrentSlot(),u._resetSlot(i),u._updateSlotsImage(),"item"===i&&u.setItemBoxVisibility(!1),u._updateCraftingButtons())}function o(e){i(e),p()}function s(e){n(e),p()}function a(e){var t=window.gui;if(e.craftResult===r.CRAFT_IMPOSSIBLE){var i=c("ui.craft.noResult");return t.openSimplePopup(i),t.chat.logMsg(i),d("ExchangeReadyMessage",{ready:!1,step:u.exchangeStep}),u.isInAutoCraft=!1,void u._updateCraftingButtons()}h.createItemInstances(e.objectInfo,function(t,i){if(t)return console.error("CraftMagusWindow createItemInstances",t);if(u.openState){var n=i.array[0];_.display(u.currentCraftingItem,n,e)}})}this._initVariables();var u=this,d=window.dofus.sendMessage,p=this.incrementStep=function(){u.exchangeStep+=1};this.onMergeAllBtnTap=e,this.onMergeBtnTap=t;var m=window.gui;m.on("ObjectModifiedMessage",this.localizeEvent(i)),m.on("ExchangeObjectAddedMessage",this.localizeEvent(o)),m.on("ExchangeObjectModifiedMessage",this.localizeEvent(o)),m.on("ExchangeObjectRemovedMessage",this.localizeEvent(s)),m.on("ExchangeCraftResultMagicWithObjectDescMessage",this.localizeEvent(a)),m.on("ExchangeCraftResultMessage",this.localizeEvent(a)),m.on("ExchangeItemAutoCraftStopedMessage",this.localizeEvent(this._onAutoCraftStopped.bind(this)))},n.prototype._createDom=function(){function e(e,t,n){var o=n.getItem();return!!o&&i.jobsData.getQuickTransferInfo("crafting",o,1).movedQty>0}function t(t){var n=new p({name:t,noDoubleTap:!0});return n.dragUiInfo={backgroundImage:"none",prepareForDrag:e},l.setDraggable(n,n.dragUiInfo,"crafting",{slot:n}),l.disableDrag(n),n.on("tap",function(){i._simpleTapOnSlot(n)}),n}var i=this,n=this.col1=this.windowBody.createChild("div",{className:"col1"}),a=this.col2=this.windowBody.createChild("div",{className:"col2"}),r=this.craftingBoxContainer=n.createChild("div",{className:"craftingBoxContainer"}),u=r.createChild("div",{className:["craftingBoxDropArea","hoverable"]});l.setDroppable(u,["craftInventory","ingredientsBag"],{isDropAllowed:o}),u.on("drop",this._itemDropOnCraftBox.bind(this)),u.myWindow=this;for(var h=this.craftingBox=u.createChild("div",{className:"craftingBox"}),g=this.craftingSlots=h.createChild("div",{className:"craftingSlots"}),_=0;_<M.length;_+=1){var v=M[_];g.appendChild(t(v))}this.minMaxSelector=this.windowContent.appendChild(new m),this.minMaxSelector.on("confirm",this._moveItem.bind(this));var y=n.createChild("div",{className:"buttonsContainer"});this.mergeAllBtn=y.appendChild(new s(c("ui.common.mergeAll"),{className:"mergeAllBtn"})),this.mergeAllBtn.on("tap",this.onMergeAllBtnTap),this.mergeBtn=y.appendChild(new s(c("ui.common.merge"),{className:"mergeBtn"})),this.mergeBtn.on("tap",this.onMergeBtnTap),this.stopBtn=y.appendChild(new s(c("ui.common.stop"),{className:"stopBtn"})),this.stopBtn.on("tap",this._onStopBtnTap.bind(this)),this._setEnableCraftingButtons(!1),this.itemBox=a.appendChild(new d({showDescription:!0,showTitle:!0,minRows:0})),this.itemPlaceholder=new f(a,{noHeight:!0}),this.itemPlaceholder.setText(" ")},n.prototype._onOpen=function(e){this.jobsData=window.gui.playerData.jobs;var t=e.msg;this.skillId=t.skillId,this.skillData=this.jobsData.getSkill(t.skillId),this.setTitle(this.skillData.nameId),this._updateSlotsImage(),this.selectedSlot=null,this.setItemBoxPlaceholderText(c("tablet.craftHelp.magicSolo")),this.setItemBoxVisibility(!1),this.jobsData.startCraftingSession("SOLO",this.skillId,1)},n.prototype._onClose=function(){this.jobsData.clearAfterCraft(),this._initVariables(),this._resetSlots(),this._unselectCurrentSlot(),this.setItemBoxVisibility(!1),this._setEnableCraftingButtons(!1)},n.prototype._isCraftableItem=function(e){return this.skillData.modifiableItemType===e.typeId},n.prototype._hasSignatureSlot=function(){var e=window.gui.playerData.jobs.list,t=this.skillData.parentJobId,i=e[t]||{},n=i.experience||{};return n.jobLevel>=w},n.prototype._getSlotByType=function(e){return this.craftingSlots.getChild(e)},n.prototype._slotHasItem=function(e){var t=this._getSlotByType(e);return!!t.itemInstance},n.prototype._updateSlotsImage=function(){var e=this.skillData.modifiableItemType;this._getSlotByType("item").setBackgroundImageByItemType(e),this._getSlotByType("rune").setBackgroundImageByItemType(v);var t=this._hasSignatureSlot(),i=this._getSlotByType("signatureRune");i.toggleClassName("signatureSlot",t),i.toggleClassName("locked",!t)},n.prototype._resetSlot=function(e){var t=this._getSlotByType(e);t.unset(),l.disableDrag(t)},n.prototype._resetSlots=function(){for(var e=0;e<M.length;e+=1)this._resetSlot(M[e])},n.prototype._getItemSlotType=function(e){var t,i=this.skillData;return this._isCraftableItem(e)?t="item":i.isForgemagus&&e.typeId===v||e.typeId===y?t="rune":e.id===b&&(t="signatureRune"),t},n.prototype._getSlotTypeByUID=function(e){for(var t=0;t<M.length;t+=1){var i=M[t],n=this._getSlotByType(i);if(n.itemInstance&&n.itemInstance.objectUID===e)return i}},n.prototype._setEnableMergeButtons=function(e){this.mergeAllBtn.setEnable(e),this.mergeBtn.setEnable(e)},n.prototype._setEnableCraftingButtons=function(e){this._setEnableMergeButtons(e),this.stopBtn.setEnable(e)},n.prototype._updateCraftingButtons=function(){this._setEnableMergeButtons(!this.isInAutoCraft&&this._slotHasItem("item")&&this._slotHasItem("rune")),this.stopBtn.setEnable(this.isInAutoCraft),this.isInAutoCraft?this.jobsData.startCombining():this.jobsData.stopCombining()},n.prototype._moveItem=function(e){this.jobsData.moveItemToCraft("craftInventory",this.newItemInstance,e)},n.prototype._itemDropOnCraftBox=function(e,t){if(this.skillId&&e.itemInstance&&(this.newItemSlotType=this._getItemSlotType(e.itemInstance.item),this.newItemSlotType)){var i=this.newItemInstance=e.itemInstance;this.droppedLocation="crafting",this.droppedItemSource=t;var n=e.getQuantity();n=this.jobsData.howManyCanBeAddedToCraft(t,i,n),0!==n&&(1===n?this._moveItem(1):this.minMaxSelector.open({min:1,max:n,defaultValue:n,x:T,y:C}))}},n.prototype._onStopBtnTap=function(){window.dofus.sendMessage("ExchangeReplayStopMessage")},n.prototype._onAutoCraftStopped=function(e){a.displayAutoCraftStopReasonMessage(e.reason),this.isInAutoCraft=!1,this._updateCraftingButtons()},n.prototype.setItemBoxPlaceholderText=function(e){this.placeholderText=e,this.isPlaceholderVisible&&this.itemPlaceholder.setText(this.placeholderText)},n.prototype.setItemBoxVisibility=function(e){this.itemBox.toggleDisplay(e),e?this.itemPlaceholder.setText(null):this.itemPlaceholder.setText(this.placeholderText),this.isPlaceholderVisible=!e},n.prototype._simpleTapOnSlot=function(e){var t=e.getItem();if(t){e!==this.selectedSlot&&window.gui.openContextualMenuAround("item",e,{item:t});var i=this.jobsData.getQuickTransferInfo("crafting",t,e.getQuantity());i.movedQty&&(e!==this.selectedSlot?this._selectCurrentSlot(e,i.movedQty>1?"stackMove":""):this.jobsData.removeItemFromCraft(t.objectUID,i.movedQty))}},n.prototype._selectCurrentSlot=function(e,t){this.selectedSlot&&this._unselectCurrentSlot(),this.selectedSlot=e,e.select({extraStyle:t})},n.prototype._unselectCurrentSlot=function(){this.selectedSlot&&(this.selectedSlot.unselect(),this.selectedSlot=null)}},function(e,t){},function(e,t,i){function n(e){for(var t=0;t<e.length;t+=1)if("ObjectEffectMinMax"===e[t]._type||"EffectInstanceMinMax"===e[t]._type)return e[t];return null}function o(e){return"ObjectEffectInteger"===e._type||"EffectInstanceInteger"===e._type||"ObjectEffectDice"===e._type||"EffectInstanceDice"===e._type}var s=i(400).createEffectInstances,a=i(29).getText,r=i(1212),l=i(399);t.display=function(e,t,i){var c=window.gui.chat,u=e.effects,d=t.effects,h=n(u),p=n(d);if(h&&p&&h.actionId!==p.actionId)return c.logMsg(a("ui.craft.success"));var m={},f={};u=u.filter(o),d=d.filter(o),u.forEach(function(e){m[e.actionId]=e}),d.forEach(function(e){f[e.actionId]=e});var g,_,v,y,b,w=!1,M=[],T=[];for(g=0;g<u.length;g+=1){y=u[g],_=y.actionId,b=y.value;var C=parseInt(y.effect.operator+y.value,10);if(f.hasOwnProperty(_)){var I=parseInt(f[_].effect.operator+f[_].value,10);v=I-C}else v=-C;if(_===l.ACTION_ITEM_CHANGE_DURABILITY)return v=f[_].diceNum-m[_].diceNum,void c.logMsg(a("ui.craft.success")+" : +"+v+", "+f[_].description);v&&(M.push({_type:y._type,actionId:_,value:v,effectCaller:"CraftMagus "+e.objectGID}),v>0&&(w=!0)),T.push(_)}for(g=0;g<d.length;g+=1)y=d[g],_=y.actionId,T.indexOf(_)>=0||(b=y.value,M.push({_type:y._type,actionId:_,value:b,effectCaller:"CraftMagus "+e.objectGID}),b>0&&(w=!0));var A=a(w?"ui.craft.success":"ui.craft.failure");s(M,function(e,t){if(e)return console.error("Craft Magus: craftResultText cannot createItemInstances",e);for(var n,o,s="",l=0;l<t.length;l+=1)n=t[l],n.effect.bonusType&&(o=n.description,o=n.value>0?"+"+o:o,s+=" "+o+",",s=s.replace("--","-"));var u="";i.magicPoolStatus===r.MAGIC_POOL_INCREASE?u=" +"+a("ui.craft.smithResidualMagic"):i.magicPoolStatus===r.MAGIC_POOL_LOSS?u=" -"+a("ui.craft.smithResidualMagic"):s=s.substring(0,s.length-1),s+=u,s&&(A+=a("ui.common.colon")),c.logMsg(A+s)})}},function(e,t){e.exports={MAGIC_POOL_NO_CHANGE:1,MAGIC_POOL_INCREASE:2,MAGIC_POOL_LOSS:3}},function(e,t,i){function n(){c.call(this),this.addClassNames("CraftMagusMultiWindow"),this.on("opened",function(){this._resizeIngredientSlots(),this._updateIngrediensSlotsPageCount()})}function o(){this.myWindow._tapOnBagSlot(this)}function s(e,t,i){return!!e.slot&&this.myWindow.jobsData.canItemMove(i,"ingredientsBag",e.slot.getItem())}i(1214);var a=i(246).DofusButton,r=i(676),l=i(710),c=i(1209),u=i(383),d=i(29).getText,h=i(191).inherits,p=i(509),m=i(832),f=i(828),g=i(225),_=40,v=40,y=30,b=l.SIGNATURE_AVAILABLE_LEVEL;h(n,c),e.exports=n,n.prototype._initVariables=function(){c.prototype._initVariables.call(this,!0),this.isCrafter=null,this.isCraftingMode=!1,this.crafterSkillLevel=1,this.currentPage=-1,this.pageCount=-1},n.prototype._initialize=function(){function e(e){var t=!!e.allowed;l.allowCrafterIngredientsCheckbox.toggleActivation(t,!0),l.jobsData.setCrafterIngredientsAllowed(t)}function t(e,t,i){var n=l.jobsData.getQuickTransferInfo("ingredientsBag",i.getItem(),1);return n.movedQty>0}function i(e){l._unselectBagSlot();var i=e.object;p.createItemInstances(i,function(e,n){if(e)return console.error(e);var s=n.map[i.objectUID],a=new m({itemData:s,name:i.objectUID,noDoubleTap:!0});a.setQuantity(s.quantity),l.ingredientsSlots.appendChild(a),a.on("tap",o),a.myWindow=l,u.setDraggable(a,{backgroundImage:a.getImage(),prepareForDrag:t},"ingredientsBag",{slot:a}),l._updateIngrediensSlotsPageCount()})}function n(e){l._unselectBagSlot();var t=e.object,i=t.objectUID,n=t.quantity,o=l.ingredientsSlots.getChild(i);o&&o.setQuantity(n)}function s(e){l._unselectBagSlot();var t=e.objectUID,i=l.ingredientsSlots.getChild(t);i&&(i.destroy(),l._updateIngrediensSlotsPageCount())}function a(e,t,i){if(l._unselectBagSlot(),!(!l.skillId||!e.itemInstance||!l._getItemSlotType(e.itemInstance.item)||l.isCrafter&&"craftInventory"===t||l.isCrafter&&"crafting"===t&&l._isMyItem(e.itemInstance.objectUID))){l.newItemInstance=e.itemInstance,l.droppedLocation="ingredientsBag",l.droppedItemSource=t;var n=e.getQuantity();return 1===n?l._moveItem(1):void l.minMaxSelector.open({min:1,max:n,defaultValue:n,x:i.x,y:i.y})}}function r(e){var t=e.ready;l._updateExchangeReadyDisplay(!!t)}c.prototype._initialize.call(this);var l=this;this.itemDropOnBag=a;var d=window.gui;d.on("ExchangeMultiCraftCrafterCanUseHisRessourcesMessage",this.localizeEvent(e)),d.on("ExchangeObjectPutInBagMessage",this.localizeEvent(i)),d.on("ExchangeObjectRemovedFromBagMessage",this.localizeEvent(s)),d.on("ExchangeObjectModifiedInBagMessage",this.localizeEvent(n)),d.on("ExchangeIsReadyMessage",this.localizeEvent(r));var h=this.incrementStep;d.on("ExchangeGoldPaymentForCraftMessage",this.localizeEvent(h)),d.on("ExchangeItemPaymentForCraftMessage",this.localizeEvent(h)),d.on("ExchangeModifiedPaymentForCraftMessage",this.localizeEvent(h)),d.on("ExchangeRemovedPaymentForCraftMessage",this.localizeEvent(h)),d.on("ExchangeClearPaymentForCraftMessage",this.localizeEvent(h))},n.prototype._tapOnBagSlot=function(e){var t=e.getItem(),i=e.getQuantity(),n=this.jobsData.getQuickTransferInfo("ingredientsBag",t,i),o=n.movedQty;e!==this.selectedBagSlot&&window.gui.openContextualMenuAround("item",e,{item:t}),o&&(e!==this.selectedBagSlot?this._selectBagSlot(e,o>1?"stackMove":""):this.isCrafter?this.jobsData.moveItemToCraft("ingredientsBag",t,o):this.jobsData.removeItemFromCraft(e.itemInstance.objectUID,o))},n.prototype._selectBagSlot=function(e,t){this.selectedBagSlot&&this._unselectBagSlot(),this.selectedBagSlot=e,e.select({extraStyle:t})},n.prototype._unselectBagSlot=function(){this.selectedBagSlot&&(this.selectedBagSlot.unselect(),this.selectedBagSlot=null)},n.prototype._createDom=function(){c.prototype._createDom.call(this);var e=this,t=this.craftingBox.createChild("div");this.crafterName=t.createChild("span",{className:"playerName"}),this.crafterDescription=t.createChild("span");var i=this.craftingBox.createChild("div");this.clientName=i.createChild("span",{className:"playerName"}),this.clientDescription=i.createChild("span"),this.acceptBtn=new a(d("ui.common.accept"),{className:"acceptBtn"}),this.acceptBtn.on("tap",function(){window.dofus.sendMessage("ExchangeReadyMessage",{ready:!0,step:e.exchangeStep})}),this.acceptBtn.insertBefore(this.stopBtn),this.ingredientsBag=this.col1.createChild("div",{className:"ingredientsBag"}),this.ingredientsBag.createChild("div",{className:"title",text:d("ui.craft.ingredientBag")}),this.ingredientsSlotsContainer=this.ingredientsBag.createChild("div",{className:"ingredientsSlotsContainer"}),this.ingredientsSlotsBox=this.ingredientsSlotsContainer.createChild("div",{className:"ingredientsSlotsBox"}),this.ingredientsSlotsMask=this.ingredientsSlotsBox.createChild("div",{className:["ingredientsSlotsMask","hoverable"]}),u.setDroppable(this.ingredientsSlotsMask,["craftInventory","crafting"],{isDropAllowed:s}),this.ingredientsSlotsMask.on("drop",this.itemDropOnBag),this.ingredientsSlotsMask.myWindow=this,this.ingredientsSlots=this.ingredientsSlotsMask.createChild("div",{className:"ingredientsSlots"}),this.pagination=this.ingredientsSlotsContainer.appendChild(new f),this.pagination.on("previous",function(){e._ingrediensSlotsGoToPage(e.currentPage-1)}),this.pagination.on("next",function(){e._ingrediensSlotsGoToPage(e.currentPage+1)}),this.pagination.on("page",function(t){e._ingrediensSlotsGoToPage(t)}),this.allowCrafterIngredientsCheckbox=this.ingredientsBag.appendChild(new r("",(!1))),this.allowCrafterIngredientsCheckbox.on("change",function(e){window.dofus.sendMessage("ExchangeMultiCraftSetCrafterCanUseHisRessourcesMessage",{allow:e})}),this.paymentBtn=new a(d("ui.common.payment"),{className:"paymentBtn"}),this.paymentBtn.on("tap",function(){g.open("craftPayment")}),this.col2.appendChild(this.paymentBtn)},n.prototype._onOpen=function(e){this.jobsData=window.gui.playerData.jobs;var t=e.msg;this.skillId=t.skillId,this.skillData=this.jobsData.getSkill(t.skillId),this.setTitle(this.skillData.nameId),this._roleSetup(e),this._updateSlotsImage(),this.selectedBagSlot=null,this.jobsData.startCraftingSession(this.isCrafter?"CRAFTER":"CLIENT",this.skillId,1);var i=d(this.isCrafter?"tablet.craftHelp.magicMultiCrafter1":"tablet.craftHelp.magicMultiClient1");this.setItemBoxPlaceholderText(i),this.setItemBoxVisibility(!1),g.close("cancel",{keepDialog:!0})},n.prototype._onClose=function(){c.prototype._onClose.call(this),this.ingredientsSlots.clearContent(),this.selectedBagSlot=null,g.close("craftPayment")},n.prototype._roleSetup=function(e){var t=e&&e.sourceName||"",i=e&&e.targetName||"",n=window.gui.playerData.characterBaseInformations.name,o=t===n,s=o?i:t,a=e&&e.isCrafter;this.isCrafter=a,this.mergeAllBtn.toggleDisplay(a),this.mergeBtn.toggleDisplay(a),this.acceptBtn.toggleDisplay(!a),this.allowCrafterIngredientsCheckbox.setText(d(a?"ui.craft.crafterRunesAllowed":"ui.craft.allowCrafterRunes"));var r=!1,l=!0;this.allowCrafterIngredientsCheckbox.toggleActivation(r,l),this.allowCrafterIngredientsCheckbox.setEnable(!a);var c=g.getWindow("craftPayment");c.setForCrafter(a),c.setOnSuccess(!0);var u=window.gui.playerData.jobs.list[this.skillData.parentJobId]||{},h=u.experience||{};this.crafterSkillLevel=e.msg.crafterJobLevel||h.jobLevel,this.crafterName.setText(a?n:s),this.clientName.setText(a?s:n);var p=e.msg.enrichData.jobName;this.crafterDescription.setText(" - "+p+" "+d("ui.common.level")+" "+this.crafterSkillLevel),this.clientDescription.setText(" - "+d("ui.craft.client")),this._updateExchangeReadyDisplay(!1)},n.prototype._hasSignatureSlot=function(){return this.crafterSkillLevel>=b},n.prototype._setEnableIngredientsBag=function(e){this.ingredientsSlotsBox.toggleClassName("disabled",!e)},n.prototype._setEnableCraftingBox=function(e){this.craftingSlots.toggleClassName("disabled",!e)},n.prototype._resizeIngredientSlots=function(){this.ingredientsSlotsBox.hide();var e=this.ingredientsSlotsContainer.rootElement,t=e.offsetWidth,i=e.offsetHeight-y,n=this.ingredientsSlotsRowNum=Math.floor(i/_),o=Math.floor(t/v);this.maxIngredientsSlotsPerPage=n*o;var s=o*v,a=n*_;this.ingredientsSlotsBox.setStyles({width:t+"px",height:i+"px"}),this.ingredientsSlotsMask.setStyles({width:s+"px",height:a+"px"}),this.ingredientsSlotsBox.show()},n.prototype._updateExchangeReadyDisplay=function(e){var t=this.isCraftingMode=e;this.jobsData.switchToCrafter(t);var i;this.isCrafter?(this._setEnableCraftingBox(t),this._setEnableIngredientsBag(t),i=e?"tablet.craftHelp.magicMultiCrafter2":"tablet.craftHelp.magicMultiCrafter1"):(this._setEnableCraftingBox(!1),this._setEnableIngredientsBag(!t),this.acceptBtn.setEnable(!t),this.stopBtn.setEnable(t),i=e?"tablet.craftHelp.magicMultiClient2":"tablet.craftHelp.magicMultiClient1"),this.setItemBoxPlaceholderText(d(i))},n.prototype._updateCraftingButtons=function(){this.isCrafter&&c.prototype._updateCraftingButtons.call(this)},n.prototype._isMyItem=function(e){return!!window.gui.playerData.inventory.objects[e]},n.prototype._ingrediensSlotsGoToPage=function(e){if(!(this.currentPage===e||e<0||e>this.pageCount-1)){this.currentPage=e;var t="translateY(-"+e*this.ingredientsSlotsRowNum*_+"px)";this.ingredientsSlots.setStyles({webkitTransform:t,transform:t}),this.pagination.setCurrent(e)}},n.prototype._updateIngrediensSlotsPageCount=function(){var e=this.ingredientsSlots.getChildren().length;this.pageCount=Math.ceil(e/this.maxIngredientsSlotsPerPage)||1,this.pagination.setPageCount(this.pageCount),this._ingrediensSlotsGoToPage(this.pageCount-1)},n.prototype._moveItem=function(e){var t="crafting"===this.droppedLocation||"craftInventory"===this.droppedItemSource&&"ingredientsBag"===this.droppedLocation;t?this.jobsData.moveItemToCraft(this.droppedItemSource,this.newItemInstance,e):this.jobsData.removeItemFromCraft(this.newItemInstance.objectUID,e)},n.prototype._onStopBtnTap=function(){return this.isCrafter?c.prototype._onStopBtnTap.call(this):void window.dofus.sendMessage("ExchangeReadyMessage",{ready:!1,step:this.exchangeStep})},n.prototype._onAutoCraftStopped=function(e){return this.isCrafter?c.prototype._onAutoCraftStopped.call(this,e):(l.displayAutoCraftStopReasonMessage(e.reason),void(this.isInAutoCraft=!1))}},function(e,t){},function(e,t,i){function n(){function e(){l.open("craftPayment")}this._positionInfoNormal={left:"c",bottom:"10%",width:550,height:165},this._positionInfoOnSuccess={left:"c",bottom:"10%",width:550,height:225},s.call(this,{className:"CraftPaymentWindow",title:a("ui.common.payment"),positionInfo:this._positionInfoNormal,customClose:!0});var t=this,i=window.gui;this._domCreated=!1,this._readOnly=!1,this.closeButton.on("tap",function(){t.hide()}),i.on("ExchangeGoldPaymentForCraftMessage",function(i){var n=i.goldSum;i.onlySuccess?t._successPayment.setKama(n):t._normalPayment.setKama(n),e()}),i.on("ExchangeItemPaymentForCraftMessage",function(i){p.createItemInstances(i.object,function(n,o){if(n)return console.error("PaymentWindow: ExchangeItemPaymentForCraftMessage cannot createItemInstances",n);var s=o.array[0];i.onlySuccess?t._successPayment.addItem(s):t._normalPayment.addItem(s),e()})}),i.on("ExchangeModifiedPaymentForCraftMessage",function(i){p.createItemInstances(i.object,function(n,o){if(n)return console.error("PaymentWindow: ExchangeModifiedPaymentForCraftMessage cannot createItemInstances",n);var s=o.array[0];i.onlySuccess?t._successPayment.modifyItem(s):t._normalPayment.modifyItem(s),e()})}),i.on("ExchangeRemovedPaymentForCraftMessage",function(i){i.onlySuccess?t._successPayment.removeItem(i.objectUID):t._normalPayment.removeItem(i.objectUID),e()}),i.on("ExchangeClearPaymentForCraftMessage",function(e){e.paymentType===u.PAYMENT_ON_SUCCESS_ONLY&&t._successPayment.clearPayment(),e.paymentType===u.PAYMENT_IN_ANY_CASE&&t._normalPayment.clearPayment(),t.hide()}),this.once("open",function(){t._domCreated||t._createDom()}),this.on("close",function(){t._normalPayment.reset(),t._successPayment.reset(),t._readOnly=!1})}i(1216);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(246).DofusButton,l=i(225),c=i(1217),u=i(1219),d=i(383),h=i(386),p=i(509);o(n,s),e.exports=n,n.prototype._createDom=function(){function e(e){window.dofus.sendMessage("ExchangeItemObjectAddAsPaymentMessage",{paymentType:s,bAdd:!0,objectToMoveId:o,quantity:e})}function t(t,i){return o=t,1===i?e(1):void n._minMaxSelector.open({min:1,max:i})}function i(e){if(!n._readOnly){s=this.paymentType;var i=e.itemInstance,o=e.getQuantity();t(i.objectUID,o)}}var n=this,o=null,s=u.PAYMENT_IN_ANY_CASE;this._minMaxSelector=this.appendChild(new h),this._minMaxSelector.setStyles({left:"20px",top:"30px"});var l=this.windowBody,p=this._normalPayment=l.appendChild(new c(u.PAYMENT_IN_ANY_CASE)),m=this._successPayment=l.appendChild(new c(u.PAYMENT_ON_SUCCESS_ONLY));this._minMaxSelector.on("confirm",e),d.setDroppable(p,["craftInventory"]),p.on("drop",i),p.paymentType=u.PAYMENT_IN_ANY_CASE,this._addDragEvents(p),d.setDroppable(m,["craftInventory"]),m.on("drop",i),m.paymentType=u.PAYMENT_ON_SUCCESS_ONLY,this._addDragEvents(m),p.on("kamaChange",function(e){window.dofus.sendMessage("ExchangeItemGoldAddAsPaymentMessage",{paymentType:u.PAYMENT_IN_ANY_CASE,quantity:e})}),m.on("kamaChange",function(e){window.dofus.sendMessage("ExchangeItemGoldAddAsPaymentMessage",{paymentType:u.PAYMENT_ON_SUCCESS_ONLY,quantity:e})});var f=l.appendChild(new r(a("ui.common.confirm"),{className:"confirmBtn"}));f.on("tap",function(){n.hide()}),n._domCreated=!0},n.prototype.setForCrafter=function(e){this._domCreated||this._createDom(),this._normalPayment.setReadonly(e),this._successPayment.setReadonly(e),this._readOnly=e},n.prototype.setOnSuccess=function(e){this._domCreated||this._createDom(),this._successPayment.toggleDisplay(e),e?this.positionInfo=this._positionInfoOnSuccess:this.positionInfo=this._positionInfoNormal},n.prototype._addDragEvents=function(e){function t(e,t){n&&n.selectSlots(t)}var i=this,n=e;d.on("dragStart",i.localizeEvent(function(e,i,n){t(n.source,!0)})),d.on("dragEnd",i.localizeEvent(function(e,i,n){t(n.source,!1)}))}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"PaymentSlotsKamas"});var t=this;this._MAX_SLOTS=5,this._currentKama=0,this._currentItems=[],this._currentPage=1,this._readOnly=!1,this._paymentType=e;var i=this.createChild("div",{className:"itemsContent"});this._previousBtn=i.appendChild(new u({className:["previousBtn","arrow"]},function(){t._currentPage-=1,t._updateItems()}));var n=i.createChild("div",{className:"itemsSlotsAndLabel"});e===d.PAYMENT_ON_SUCCESS_ONLY&&n.createChild("div",{className:"itemsLabel",text:c("ui.craft.additionalPayment")});for(var o=this._itemsSlots=n.createChild("div",{className:"itemsSlots"}),h=0;h<this._MAX_SLOTS;h+=1){var p=o.appendChild(new l({noDoubleTap:!0}));p.itemUI={width:40,height:40,onDragClassName:"slot"},a.setDraggable(p,p.itemUI,"craftPayment",{slot:p}),a.disableDrag(p)}this._nextBtn=i.appendChild(new u({className:["nextBtn","arrow"]},function(){t._currentPage+=1,t._updateItems()}));var m=this.createChild("div",{className:"pagesContent"});this._pagesCount=m.createChild("div",{className:"pagesCount"}),this._updatePagesCount();var f=this.createChild("div",{className:"kamaContent"});f.createChild("div",{className:"kamaLabel",text:c("ui.common.kamas")});var g=this._numberInput=f.appendChild(new r({minValue:0,title:c("ui.common.kamas")}));g.on("focus",function(){g.maxValue=window.gui.playerData.inventory.kamas}),g.on("change",function(e){t._currentKama!==e&&(t._currentKama=e,t.emit("kamaChange",e))})}i(1218);var o=i(191).inherits,s=i(235),a=i(383),r=i(388),l=i(832),c=i(29).getText,u=i(246),d=i(1219);o(n,s),e.exports=n,n.prototype.setKama=function(e){this._numberInput.setValue(e),this._numberInput.blur()},n.prototype.setReadonly=function(e){this._numberInput.setReadonly(e),this._itemsSlots.toggleClassName("disable",e),this._readOnly=e},n.prototype.selectSlots=function(e){this._readOnly&&(e=!1);for(var t=this._itemsSlots.getChildren(),i=0,n=t.length;i<n;i+=1)t[i].toggleClassName("selected",e)},n.prototype._getPageMax=function(){return parseInt(this._currentItems.length/this._MAX_SLOTS,10)+1},n.prototype._updatePagesCount=function(){var e=this._getPageMax();this._currentPage>e&&(this._currentPage=e),this._currentPage<1&&(this._currentPage=1);var t=this._currentPage;this._pagesCount.setText(t+"/"+e),t>=e?this._nextBtn.disable():this._nextBtn.enable(),t<=1?this._previousBtn.disable():this._previousBtn.enable()},n.prototype._getItemIndex=function(e){for(var t=this._currentItems,i=0,n=t.length;i<n;i+=1){var o=t[i];if(o){var s=o.objectUID;if(s===e)return i}}return null},n.prototype.addItem=function(e){this._currentItems.push(e),this._updateItems()},n.prototype.modifyItem=function(e){var t=this._getItemIndex(e.objectUID);null!==t&&(this._currentItems[t]=e,this._currentPage=parseInt(t/this._MAX_SLOTS,10)+1,this._updateItems())},n.prototype.removeItem=function(e){var t=this._getItemIndex(e);null!==t&&(this._currentItems.splice(t,1),this._updateItems())},n.prototype._updateItems=function(){this._updatePagesCount();for(var e=this._itemsSlots.getChildren(),t=this._currentPage-1,i=0,n=e.length;i<n;i+=1){var o=i+t*this._MAX_SLOTS,s=e[i],r=this._currentItems[o];r?(s.setItem(r),s.itemUI.backgroundImage=s.getImage(),s.paymentType=this._paymentType,this._readOnly?a.disableDrag(s):a.enableDrag(s)):(delete s.paymentType,s.unset(),a.disableDrag(s))}},n.prototype.clearPayment=function(){this._currentKama=0,this._currentPage=1,this._numberInput.setValue(""),this._currentItems=[],this._updateItems()},n.prototype.reset=function(){this._readOnly=!1,this.clearPayment()}},function(e,t){},function(e,t){e.exports={PAYMENT_ON_SUCCESS_ONLY:0,PAYMENT_IN_ANY_CASE:1}},function(e,t,i){function n(e){function t(e){return O===E.SKILLID_WRAP_GIFT||N&&N[e.objectGID]}function i(e){var t=e.item,i=E.getSkill(O);return!i||(t.typeId===i.modifiableItemType&&t.enhanceable||t.typeId===d.SMITHMAGIC_RUNE_ID||t.typeId===d.SMITHMAGIC_POTION_ID||e.objectGID===d.SIGNATURE_RUNE_ID&&E.canCrafterSign&&"CLIENT"!==E.craftSide)}function n(e){return e.item.isEquippable()}function s(e){return"craftPayment"===I?window.dofus.sendMessage("ExchangeItemObjectAddAsPaymentMessage",{paymentType:T,bAdd:!1,objectToMoveId:w,quantity:e}):"ingredientsBag"===I?window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:w,quantity:-e}):void E.removeItemFromCraft(w,e)}function h(e){p(e.object,e.remote)}function p(t,i){var n=t.objectUID,o=S.objects[n];if(o){var s=o.quantity-t.quantity;e.setItemQuantity(n,s),s>0&&!i&&y(n)}}function m(t){var i=t.count,n=E.getCraftTable();for(var o in n){var s=parseInt(o,10),a=n[o].quantity,r=S.objects[s];r&&e.setItemQuantity(s,r.quantity-a*i)}}function f(e){g(e.objectUID,e.remote)}function g(t,i){e.resetItemQuantity(t),i||y(t)}function _(e,t,i,n){return w=e.itemInstance.objectUID,M=e.itemInstance.objectGID,T=e.paymentType,M===E.RUNE_SIGNATURE_GID&&"craftPayment"!==I?s(1):1===n?s(1):void x.open({min:1,max:n,defaultValue:n,x:t,y:i})}function v(e,t,i){return!!e.slot&&E.canItemMove(i,"craftInventory",e.slot.getItem())}function y(t){var i=e.getSlotByUID(t);if(i){var n=E.getQuickTransferInfo("craftInventory",i.getItem(),i.getQuantity());n.movedQty>0&&e.selectSlot(i,n.movedQty>1?"stackMove":"")}}function b(e,t,i){return E.howManyCanBeAddedToCraft("craftInventory",i.getItem(),1)>0}r.call(this,{title:l("ui.common.inventory"),className:"CraftInventoryWindow",positionInfo:{right:"0.5%",bottom:"2%",width:"23.2%",height:"95%",isDefault:!0}}),e.registerView(this,{enableSlotContext:!1,tapSelectedEmitsDoubleTap:!0,showHoverFrame:!0,prepareForDragFunction:b,manualReset:!0});var w,M,T,C=!1,I=null,A=window.gui,S=A.playerData.inventory,E=A.playerData.jobs,x=A.windowsContainer.appendChild(new c);x.on("confirm",s);var L=!0,N=null,O=null,D=null,R=null,P=new u(l("ui.craft.craftFilter"),(!0));P.on("change",function(t){L=t,t?e.addFilters([R]):e.removeFilter(R),e.filterList(!0)}),A.on("ExchangeItemPaymentForCraftMessage",this.localizeEvent(h)),A.on("ExchangeModifiedPaymentForCraftMessage",this.localizeEvent(h)),A.on("ExchangeObjectPutInBagMessage",this.localizeEvent(h)),A.on("ExchangeObjectModifiedInBagMessage",this.localizeEvent(h)),this.on("itemModified",this.localizeEvent(function(e){h({object:e,remote:!1})})),A.on("ExchangeReplayCountModifiedMessage",this.localizeEvent(m)),A.on("ExchangeRemovedPaymentForCraftMessage",this.localizeEvent(f)),A.on("ExchangeClearPaymentForCraftMessage",this.localizeEvent(f)),A.on("ExchangeObjectRemovedFromBagMessage",this.localizeEvent(f)),this.on("open",function(s){C||(C=!0,o(this,["crafting","craftPayment","ingredientsBag"],{isDropAllowed:v}),this.on("drop",function(e,t,i){I=t,_(i.slot,i.x,i.y,i.slot.getQuantity())})),E.on("objectAdded",p),E.on("objectModified",p),E.on("objectRemoved",g),s=s||{},D=s.type;var r=s.msg;O=r.skillId;var l=r.maxCase||r.nbCase;"craftMagus"===D?(N={},R=i):"decrafting"===D?R=n:(N=E.getStorageCraftFilterMap(O,l),R=t),e.storageUI.appendChild(P),e.clearFilters(),e.addFilters([a.unlinkedItemsFilter]),L&&e.addFilters([R]),
e.filterList(),e.resetDisplay()}),this.on("close",function(){x.hide(),N=null,O=null,D=null}),this.on("closed",function(){e.storageUI.removeChild(P),e.clearFilters(),e.resetItemsQuantity(),e.filterList()}),this.on("slot-tap",function(t){var i=t.getItem();window.gui.openContextualMenuAround("item",t,{item:i});var n=E.getQuickTransferInfo("craftInventory",i,t.getQuantity()),o=n.movedQty;return 0===o?e.unSelectSlot():void(o>1&&t.select({extraStyle:"stackMove"}))}),this.on("slot-doubletap",function(t){var i=t.getItem(),n=E.getQuickTransferInfo("craftInventory",i,t.getQuantity()),o=n.movedQty;return 0===o?e.unSelectSlot():void E.moveItemToCraft(this.id,i,o)})}i(1221);var o=i(383).setDroppable,s=i(191).inherits,a=i(509),r=i(233),l=i(29).getText,c=i(386),u=i(676),d=i(710);s(n,r),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(e){if(e.exchangeType===l.PLAYER_TRADE){var t=y.playerData;g=t.id,_=t.characterBaseInformations.name;var i=h.setupNames(v._targetInfo.targetId,e.source);if(!i)return console.error("TradeWithPlayer: setupNames");b=i.sourceName,w=i.targetName,h.setupCancelPopupTexts({title:a("ui.exchange.requestInProgress"),message:a("ui.exchange.requestInProgress")}),h.setupConfirmPopupTexts({title:a("ui.exchange.exchangeRequest"),message:a("ui.exchange.resquestMessage",b)}),h.askingExchangePopup()}}function t(e){e.exchangeType===l.PLAYER_TRADE&&(r.close("cancel",{keepDialog:!0}),v._domCreated||v._createDom(),y.once("ExchangeLeaveMessage",function(e){var t,i=e.success;t=a(i?"ui.exchange.success":"ui.exchange.cancel"),y.chat.logMsg(t)}),e.firstCharacterId===g?(T=e.firstCharacterCurrentWeight,C=e.secondCharacterCurrentWeight,I=e.firstCharacterMaxWeight,A=e.secondCharacterMaxWeight,M=w):(C=e.firstCharacterCurrentWeight,T=e.secondCharacterCurrentWeight,A=e.firstCharacterMaxWeight,I=e.secondCharacterMaxWeight,M=b),v.setTitle(M+" <-> "+_),v._myTradeSpace.initializePods(T,I),v._otherCharacterTradeSpace.setAsRemote(),v._otherCharacterTradeSpace.initializePods(C,A),i(),r.continueDialog(["tradeWithPlayer","tradeWithPlayerAndNPCInventory"]))}function i(){var e=v._otherCharacterTradeSpace.getEstimationPrice(),t=v._myTradeSpace.getEstimationPrice(),i=!1,n=!1,o=!1;t>0&&t>=2*e&&(i=!0,o=!0),e>0&&e>=2*t&&(i=!0,n=!0),v._otherCharacterTradeSpace.setEstimationPrice(e,{color:i,warning:n}),v._myTradeSpace.setEstimationPrice(t,{color:i,warning:o})}function n(){i(),window.clearTimeout(S),S=window.setTimeout(function(){(v._myTradeSpace.isGoldOrItemToTrade()||v._otherCharacterTradeSpace.isGoldOrItemToTrade())&&v._buttonConfirm.enable()},1e3*p),v._buttonConfirm.disable()}function o(e){v._exchangeStep+=1,e.remote?v._otherCharacterTradeSpace.modifyKama(e.quantity):v._myTradeSpace.modifyKama(e.quantity),n()}function c(e){var t=e.remote,i=e.object,o=i.objectUID,s=i.quantity;v._exchangeStep+=1,v._toggleConfirmForMe(!1),d.createItemInstances(i,function(e,i){if(e)return console.error(e);var a=i.map[o],r=a.weight,l=E[o];l||(l=E[o]={});var c=l.quantity||0;l.weight=r,l.quantity=s;var u=r*(s-c);t?(v._otherCharacterTradeSpace.addAndModifyItem(a),v._otherCharacterTradeSpace.blink(p),v._otherCharacterTradeSpace.incrementExchangePodsQty(-u),v._myTradeSpace.incrementExchangePodsQty(u)):(v._myTradeSpace.addAndModifyItem(a),v._otherCharacterTradeSpace.incrementExchangePodsQty(u),v._myTradeSpace.incrementExchangePodsQty(-u)),n()})}function u(e){var t=e.remote,i=e.objectUID;v._exchangeStep+=1,v._toggleConfirmForMe(!1);var o=E[i];o||console.warn("TradeWithPlayer: no itemMap for",i);var s=o.weight*o.quantity;E[i]={},t?(v._otherCharacterTradeSpace.removeItem(i),v._otherCharacterTradeSpace.blink(p),v._otherCharacterTradeSpace.incrementExchangePodsQty(s),v._myTradeSpace.incrementExchangePodsQty(-s)):(v._myTradeSpace.removeItem(i),v._otherCharacterTradeSpace.incrementExchangePodsQty(-s),v._myTradeSpace.incrementExchangePodsQty(s)),n()}function m(e){var t=e.id,i=e.ready;t===g?v._toggleConfirmForMe(i):v._otherCharacterTradeSpace.toggleReady(i)}function f(){v.targetInfo={},E={},v._otherCharacterTradeSpace.reset(),v._myTradeSpace.reset(),v._toggleConfirmForMe(!1),v._otherCharacterTradeSpace.toggleReady(!1),v._buttonConfirm.disable(),v._exchangeStep=0}s.call(this,{className:"TradeWithPlayerWindow",title:"",positionInfo:{left:"0.5%",top:"2%",width:"612px",height:"350px"}});var g,_,v=this,y=window.gui;this._targetInfo={};var b,w,M,T,C,I,A,S,E={};this._domCreated=!1,this._otherCharacterTradeSpace=null,this._myTradeSpace=null,this._buttonConfirm=null,this._iConfirmed=!1,this._exchangeStep=0,y.on("ExchangeRequestedTradeMessage",e),y.on("ExchangeStartedWithPodsMessage",t),y.on("ExchangeKamaModifiedMessage",this.localizeEvent(o)),y.on("ExchangeObjectAddedMessage",this.localizeEvent(c)),y.on("ExchangeObjectModifiedMessage",this.localizeEvent(c)),y.on("ExchangeObjectRemovedMessage",this.localizeEvent(u)),y.on("ExchangeIsReadyMessage",this.localizeEvent(m)),this._toggleConfirmForMe=function(e){v._iConfirmed=e,v._myTradeSpace.toggleReady(e),e?v._buttonConfirm.disable():v._buttonConfirm.enable()},this.on("close",f)}i(1223);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(225),l=i(280),c=i(1224),u=i(246).DofusButton,d=i(509),h=i(712),p=2;o(n,s),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.windowBody,i=t.createChild("div",{className:["otherCharacterSpace","tradeSpace"]});this._otherCharacterTradeSpace=i.appendChild(new c({blinkDuration:p}));var n=t.createChild("div",{className:["mySpace","tradeSpace"]});this._myTradeSpace=n.appendChild(new c({blinkDuration:p,dragInteraction:!0,canRemove:!0}));var o=t.createChild("div",{className:"tradeButtons"});this._buttonConfirm=o.appendChild(new u(a("ui.common.validation"),{className:"buttonConfirm",disable:!0})),this._buttonConfirm.on("tap",function(){if(!e._iConfirmed)return!e._otherCharacterTradeSpace.hasFreePods()&&e._myTradeSpace.getItemsToTradeCount()>0?window.gui.openSimplePopup(a("ui.storage.noRoomForTransfert")):void window.dofus.sendMessage("ExchangeReadyMessage",{ready:!0,step:e._exchangeStep})});var s=o.appendChild(new u(a("ui.common.cancel"),{className:"buttonCancel"}));s.on("tap",function(){return e._iConfirmed?window.dofus.sendMessage("ExchangeReadyMessage",{ready:!1,step:e._exchangeStep}):void r.close(e.id)}),this._domCreated=!0},n.prototype.prepareMakeExchange=function(e){this._targetInfo=e}},function(e,t){},function(e,t,i){function n(e){e=e||{},s.call(this,"div",{className:"TradeSpace"});var t=this;this._isRemote=!1,this._blinkDuration=e.blinkDuration||5,this._blinkTimeout=null,this._currentUID=null,this._podsTooltip=new s("div"),this._podsTooltipText="",this._maxPods=0,this._currentPods=0,this._exchangePods=0,this._podsPercent=0,this._estimationPrice={},this.selectedSlot=null,this._minMaxSelector=this.appendChild(new l),this._minMaxSelector.setStyles({left:"20px",top:"50px"}),this._minMaxSelector.on("confirm",function(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:t._currentUID,quantity:e*(this.fromInventory?1:-1)})}),this._tradeGold=this.appendChild(new a),this._tradeGold.on("kamaChange",function(e){window.dofus.sendMessage("ExchangeObjectMoveKamaMessage",{quantity:e})}),this._exchangePodsContent=this.createChild("div",{className:"exchangePodsContent"}),this._exchangePodsProgressBar=this._exchangePodsContent.appendChild(new d({className:"exchangePodsProgressBar"})),h(this._exchangePodsProgressBar,t._podsTooltip);var i=this.createChild("div",{className:"slotBox"});e.dragInteraction&&(p.setDroppable(i,["tradeWithPlayerAndNPCInventory"]),i.on("drop",function(e){var i=e.itemInstance,n=e.getQuantity();return 1===n?window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:i.objectUID,quantity:1}):(t._currentUID=i.objectUID,t._minMaxSelector.fromInventory=!0,void t._minMaxSelector.open({min:1,max:n}))})),this.canRemove=e.canRemove,this._allSlots=i.createChild("div",{className:"slots"});var n=this.createChild("div",{className:"estimationContent"});n.createChild("div",{className:["estimationLabel","half"],text:u("ui.exchange.estimatedValue")+u("ui.common.colon")});var o=n.createChild("div",{className:["estimationValueContent","half"]});this._estimationValue=o.createChild("div",{className:"estimationValue"}),this._estimationWarning=o.createChild("div",{className:"estimationWarning"});var r=null;h(this._estimationWarning,function(){return r?r:r=new s("div",{text:u("ui.exchange.warning")})})}i(1225);var o=i(191).inherits,s=i(235),a=i(1226),r=i(832),l=i(386),c=i(252),u=i(29).getText,d=i(605),h=i(248).addTooltip,p=i(383);o(n,s),e.exports=n,n.prototype.setAsRemote=function(){this._isRemote=!0,this._tradeGold.setAsRemote()},n.prototype.modifyKama=function(e){this._isRemote&&this._tradeGold.blink(this._blinkDuration),this._tradeGold.setKama(e)},n.prototype.blink=function(e){e=e||3;var t=this;window.clearTimeout(this._blinkTimeout),this._blinkTimeout=window.setTimeout(function(){t._allSlots.delClassNames("blink")},1e3*e),this._allSlots.addClassNames("blink")},n.prototype.setEstimationPrice=function(e,t){t=t||{},this._estimationValue.setText(c.kamasToString(e)),this._estimationValue.toggleClassName("warning",t.color),this._estimationWarning.setStyle("visibility",t.warning?"visible":"hidden")},n.prototype.addAndModifyItem=function(e){function t(){var t=s._estimationPrice[l],i=e.item.averagePrice;i<0||(t||(t=s._estimationPrice[l]={}),t.averagePrice=e.item.averagePrice,t.quantity=c)}function i(){if(!s._isRemote&&s.canRemove){var e=o.itemInstance;if(e){s._currentUID=e.objectUID;var t=e.quantity;if(1===t)return window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:s._currentUID,quantity:-1});s._minMaxSelector.fromInventory=!1,s._minMaxSelector.open({min:1,max:e.quantity})}}}function n(e){"remove"===e&&i()}var o,s=this,a=this._allSlots,l=e.objectUID,c=e.quantity;t(),o=a.getChild("slot"+l),o||(o=a.appendChild(new r({name:"slot"+l})),o.setContextMenu("item",{item:o.itemInstance,remove:s.canRemove,onClose:n,enableActions:!1,enableDestroy:!1}),s.canRemove&&(o.on("doubletap",i),o.on("tap",function(){s.selectedSlot&&s.selectedSlot.delClassNames("selected"),s.selectedSlot=this,s.selectedSlot.addClassNames("selected")}))),o.setItem(e),s.canRemove&&p.setDraggable(o,{backgroundImage:o.getImage()},"tradeSpace")},n.prototype.removeItem=function(e){delete this._estimationPrice[e];var t=this._allSlots.getChild("slot"+e);t&&(t===this.selectedSlot&&(this.selectedSlot=null),t.destroy())},n.prototype.getEstimationPrice=function(){var e=this._tradeGold.getKama(),t=this._estimationPrice;for(var i in t){var n=t[i];e+=n.quantity*n.averagePrice}return e},n.prototype.toggleReady=function(e){this._tradeGold.toggleReady(e),this._allSlots.toggleClassName("isReady",e)},n.prototype.setPodsProgressBar=function(){var e=this._maxPods,t=this._currentPods,i=this._exchangePods;if(e){var n=this._podsPercent=Math.min(100,Math.floor(100*(t+i)/e));this._exchangePodsProgressBar.setValue(this._podsPercent/100),n<=60?this._exchangePodsProgressBar.replaceClassNames(["yellow","orange","red"],["green"]):n<=70?this._exchangePodsProgressBar.replaceClassNames(["green","orange","red"],["yellow"]):n<=80?this._exchangePodsProgressBar.replaceClassNames(["green","yellow","red"],["orange"]):this._exchangePodsProgressBar.replaceClassNames(["green","yellow","orange"],["red"]),this._podsTooltipText=u("ui.common.player.weight",c.kamasToString(t+i,""),c.kamasToString(e,"")),this._podsTooltip.setText(this._podsTooltipText)}},n.prototype.initializePods=function(e,t){this._maxPods=t,this._currentPods=e,this._exchangePods=0,this.setPodsProgressBar()},n.prototype.activateNpcTradeMode=function(){this._exchangePodsContent.hide(),this._tradeGold.setReadOnly(!0)},n.prototype.incrementExchangePodsQty=function(e){this._exchangePods+=e,this.setPodsProgressBar()},n.prototype.isGoldOrItemToTrade=function(){if(this._tradeGold.getKama()>0)return!0;for(var e=this._allSlots.getChildren(),t=0,i=e.length;t<i;t+=1){var n=e[t];if(n.itemInstance)return!0}return!1},n.prototype.getItemsToTradeCount=function(){for(var e=0,t=this._allSlots.getChildren(),i=0;i<t.length;i++)t[i].itemInstance&&e++;return e},n.prototype.hasFreePods=function(){return this._maxPods-(this._currentPods+this._exchangePods)>=0},n.prototype.reset=function(){this._tradeGold.reset(),this._isRemote=!1,this._currentUID=null,this._maxPods=0,this._currentPods=0,this._exchangePods=0,this._podsPercent=0,this._estimationPrice={},this._exchangePodsContent.show(),this._tradeGold.show(),window.clearTimeout(this._blinkTimeout),this._allSlots.delClassNames("blink"),this._podsTooltip.setText(""),this._allSlots.clearContent(),this.selectedSlot=null}},function(e,t){},function(e,t,i){function n(){s.call(this,"div",{className:"TradeGold"});var e=this;this._blinkTimeout=null,this._currentKama=0,this._kamaContent=this.createChild("div",{className:"kamaContent"});var t;l.addTooltip(this._kamaContent,function(){return t||(t=new s("div",{className:"kamaTooltip",text:a("ui.exchange.kamas")})),t}),l.enableTooltip(this._kamaContent,!1);var i=this._kamaContent.createChild("div",{className:"imgContent"});i.createChild("div",{className:"kamaImg"});var n=this._kamaContent.createChild("div",{className:"kamaInput"}),o=this._input=n.appendChild(new r({minValue:0,title:a("ui.common.kamas")}));n.createChild("div",{className:"kamaUnit",text:a("ui.common.short.kama")}),o.on("focus",function(){o.maxValue=window.gui.playerData.inventory.kamas}),o.on("change",function(t){e._currentKama!==t&&(e._currentKama=t,e.emit("kamaChange",t))})}i(1227);var o=i(191).inherits,s=i(235),a=i(29).getText,r=i(388),l=i(248);o(n,s),e.exports=n,n.prototype.getKama=function(){return this._input.getValue()},n.prototype.setKama=function(e){this._input.setValue(e)},n.prototype.blink=function(e){e=e||3;var t=this;window.clearTimeout(this._blinkTimeout),this._blinkTimeout=window.setTimeout(function(){t._kamaContent.delClassNames("blink")},1e3*e),this._kamaContent.addClassNames("blink")},n.prototype.toggleReady=function(e){this._kamaContent.toggleClassName("isReady",e)},n.prototype.setAsRemote=function(){l.enableTooltip(this._kamaContent,!0),this._input.setReadonly(!0)},n.prototype.reset=function(){this._input.setValue(0),this._input.setReadonly(!1),window.clearTimeout(this._blinkTimeout),this._kamaContent.delClassNames("blink"),this._currentKama=0,l.enableTooltip(this._kamaContent,!1)},n.prototype.setReadOnly=function(e){this._input.setReadonly(e)}},function(e,t){},function(e,t,i){function n(){function e(){p._domCreated||p._createDom(),m.once("ExchangeLeaveMessage",function(e){var t,i=e.success;t=a(i?"ui.exchange.success":"ui.exchange.cancel"),m.chat.logMsg(t)}),""===p._npcName&&console.error("TradeWithNPCWindow: npcName is missing on mapid:",window.isoEngine.mapRenderer.mapId),p.setTitle(p._npcName+" <-> "+m.playerData.characterBaseInformations.name),p._myTradeSpace.activateNpcTradeMode(),p._npcTradeSpace.setAsRemote(),p._npcTradeSpace.activateNpcTradeMode(),t(),r.continueDialog(["tradeWithNPC","tradeWithPlayerAndNPCInventory"])}function t(){var e=p._npcTradeSpace.getEstimationPrice(),t=p._myTradeSpace.getEstimationPrice(),i=!1,n=!1,o=!1;t>0&&t>=2*e&&(i=!0,o=!0),e>0&&e>=2*t&&(i=!0,n=!0),p._npcTradeSpace.setEstimationPrice(e,{color:i,warning:n}),p._myTradeSpace.setEstimationPrice(t,{color:i,warning:o})}function i(){t(),window.clearTimeout(h),h=window.setTimeout(function(){p._npcTradeSpace.isGoldOrItemToTrade()&&p._buttonConfirm.enable()},1e3*d),p._buttonConfirm.disable()}function n(e){var t=e.remote,n=e.object,o=n.objectUID;p._exchangeStep+=1,u.createItemInstances(n,function(e,n){if(e)return console.error(e);var s=n.map[o];t?(p._npcTradeSpace.addAndModifyItem(s),p._npcTradeSpace.blink(d)):p._myTradeSpace.addAndModifyItem(s),i()})}function o(e){var t=e.remote,n=e.objectUID;p._exchangeStep+=1,t?(p._npcTradeSpace.removeItem(n),p._npcTradeSpace.blink(d)):p._myTradeSpace.removeItem(n),i()}function l(){p._npcTradeSpace.reset(),p._myTradeSpace.reset(),p._buttonConfirm.disable(),p._exchangeStep=0,p._npcName=""}function c(e){p._exchangeStep+=1,e.remote?p._npcTradeSpace.modifyKama(e.quantity):p._myTradeSpace.modifyKama(e.quantity)}s.call(this,{className:"TradeWithNPCWindow",title:"",positionInfo:{left:"0.5%",top:"2%",width:"612px",height:"300px"}});var h,p=this,m=window.gui;this._npcName="",this._domCreated=!1,this._npcTradeSpace=null,this._myTradeSpace=null,this._buttonConfirm=null,this._exchangeStep=0,m.on("ExchangeStartOkNpcTradeMessage",e),m.on("ExchangeKamaModifiedMessage",this.localizeEvent(c)),m.on("ExchangeObjectAddedMessage",this.localizeEvent(n)),m.on("ExchangeObjectModifiedMessage",this.localizeEvent(n)),m.on("ExchangeObjectRemovedMessage",this.localizeEvent(o)),this.on("closed",l)}i(1229);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(225),l=i(1224),c=i(246).DofusButton,u=i(509),d=2;o(n,s),e.exports=n,n.prototype.prepareExchange=function(e){this._npcName=e},n.prototype._createDom=function(){var e=this,t=this.windowBody,i=t.createChild("div",{className:["otherCharacterSpace","tradeSpace"]});this._npcTradeSpace=i.appendChild(new l({blinkDuration:d}));var n=t.createChild("div",{className:["mySpace","tradeSpace"]});this._myTradeSpace=n.appendChild(new l({blinkDuration:d,dragInteraction:!0,canRemove:!0}));var o=t.createChild("div",{className:"tradeButtons"});this._buttonConfirm=o.appendChild(new c(a("ui.common.validation"),{className:"buttonConfirm",disable:!0})),this._buttonConfirm.on("tap",function(){window.dofus.sendMessage("ExchangeReadyMessage",{ready:!0,step:e._exchangeStep})});var s=o.appendChild(new c(a("ui.common.cancel"),{className:"buttonCancel"}));s.on("tap",function(){r.close(e.id)}),this._domCreated=!0}},function(e,t){},function(e,t,i){function n(e){function t(){for(var t in h)e.resetItemQuantity(t);h={}}function i(t){if(!t.remote){var i=t.object.objectUID,n=u.objects[i];e.setItemQuantity(i,n.quantity-t.object.quantity),h[i]=!0}}function n(t){if(!t.remote){var i=t.objectUID;e.resetItemQuantity(i),delete h[i]}}a.call(this,{title:r("ui.common.inventory"),className:"TradeWithPlayerAndNPCInventoryWindow",positionInfo:{right:"0.5%",top:"2%",width:"23.2%",height:"95%"}}),this.storageViewer=e,e.registerView(this,{manualReset:!0}),c.setDroppable(this,["tradeSpace"]),this.on("drop",function(e){var t=e.itemInstance.quantity;return 1===t?window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:e.itemInstance.objectUID,quantity:-1}):(o=e.itemInstance.objectUID,p.fromInventory=!1,void p.open({min:1,max:t}))});var o,u=window.gui.playerData.inventory,d=window.gui,h={},p=this.appendChild(new l);p.setStyles({left:"-100px",top:"100px"}),p.on("confirm",function(e){window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:o,quantity:e*(this.fromInventory?1:-1)})}),d.on("ExchangeObjectRemovedMessage",this.localizeEvent(n)),d.on("ExchangeObjectAddedMessage",this.localizeEvent(i)),d.on("ExchangeObjectModifiedMessage",this.localizeEvent(i)),this.on("open",function(){e.addFilters([s.unlinkedItemsFilter]),e.filterList(),e.resetDisplay()}),this.on("close",function(){e.removeFilter(s.unlinkedItemsFilter),e.filterList(),p.hide(),t()}),this.on("slot-doubletap",function(e){var t=e.itemInstance;o=t.objectUID;var i=e.getQuantity();return 1===i?window.dofus.sendMessage("ExchangeObjectMoveMessage",{objectUID:o,quantity:1}):(p.fromInventory=!0,void p.open({min:1,max:i}))})}i(1231);var o=i(191).inherits,s=i(509),a=i(233),r=i(29).getText,l=i(386),c=i(383);o(n,a),e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"CancelWindow",positionInfo:{left:"c",top:"c",width:600,height:200},noCloseButton:!0});var e=this,t=this.windowBody.createChild("div",{className:"messageBox"});this.message=t.createChild("div",{className:"message"});var i=this.windowBody.createChild("div",{className:"buttonContainer"}),n=i.appendChild(new a(r("ui.common.cancel")));n.on("tap",function(){"function"==typeof e.cb&&e.cb(),e.close()})}i(1233);var o=i(191).inherits,s=i(233),a=i(246).DofusButton,r=i(29).getText,l=i(678);o(n,s),e.exports=n,n.prototype.update=function(e,t){t=t||{},this.windowTitle.setText(e.title),this.message.clearContent(),this.message.appendChild(l.process(e.message,{isNonChat:!0})),this.cb=e.cb,this.keepDialog=t.keepDialog}},function(e,t){},function(e,t,i){function n(){T.call(this,{className:"OptionsWindow",title:m("ui.common.options"),positionInfo:{left:"c",top:"c",width:"80%",height:"70%"}}),this.optionDefinitions=null,this.elements={},this.sections=null,this.currentSection=null,this._gameOptionChangedHandler=this._gameOptionChanged.bind(this),this._initOptionDefinitions(),this.on("open",this._open),this.on("opened",this._opened),this.on("close",this._close)}function o(e,t){var i=e.appendChild(new p(t.text,(!1)));return i.addClassNames("settingOption"),i.on("change",u.bind(t)),i}function s(e,t){var i=t.values,n=t.labels||i,o=e.createChild("div");o.createChild("div",{className:["settingOption","dropdownLabel"],text:t.text});for(var s=o.appendChild(new v({className:"settingOption"})),a=0;a<i.length;a++)s.addOption(n[a],i[a]);return s.on("change",u.bind(t)),s}function a(e,t){var i=t.tooltipText,n=e.appendChild(new h(t.text,{className:["settingOption","optionButton"]},u.bind(t)));return i&&d.addTooltip(n,i),n}function r(e,t){return e.createChild("div",{className:"header",text:t.text})}function l(e,t){return e.createChild("div",{className:"infoText",text:t.text})}function c(e,t){return e.appendChild(new t.CustomClass(t,u.bind(t)))}function u(e){this.gameOptionId&&(g.changeValue(this.gameOptionId,e,x),window.gui.emit("gameOptionChanged",{value:e,gameOptionId:this.gameOptionId})),this.action&&this.action(e)}i(1235);var d=i(248),h=i(246).DofusButton,p=i(676),m=i(29).getText,f=i(191).inherits,g=i(190),_=i(483),v=i(586),y=i(500).SingleSelectionList,b=i(1236),w=i(866),M=i(195),T=i(233),C=i(196),I=i(1238),A=i(252),S=i(650),E=i(1241),x="OptionsWindow",L={bool:o,dropdown:s,button:a,header:r,infoText:l,custom:c};f(n,T),e.exports=n,n.prototype._open=function(){this.sections||this._createContent(),this.refreshUi()},n.prototype._opened=function(e){e&&e.tab&&this._selectTab(e.tab)},n.prototype._close=function(){M.saveNow()},n.prototype.freeContent=function(){this.windowBody.clearContent(),this.sections=this.currentSection=null,this.elements={},this.menuList=this.settingsScroller=this.settingsCol=null},n.prototype._createContent=function(){var e=this;this.sections={};var t=this.windowBody.createChild("div",{className:"wrapper"}),i=t.createChild("div",{className:"menuCol"});this.menuList=i.appendChild(new y({className:"menu"},{disableSelectionToggle:!0})),this.menuList.on("selected",function(t){e._showSection(t.id),this.scrollToElement(t)});var n=t.createChild("div",{className:"settingsCol"});this.settingsScroller=n.appendChild(new _({className:"settings"})),this.settingsCol=this.settingsScroller.content;for(var o=0;o<this.optionDefinitions.length;o++)this._createSection(this.optionDefinitions[o],o)},n.prototype._createSection=function(e,t){this.menuList.addItem({id:t,element:e.title},{noRefresh:!0});var i=this.settingsCol.createChild("div",{className:["optionSection",e.name+"Section"],hidden:!0});if(e.text){var n=i.createChild("div",{className:"titleBox"});n.createChild("div",{className:"sectionDescription",text:e.text})}for(var o=i.createChild("div",{className:"allOptions"}),s=e.elements,a=0;a<s.length;a++){var r=this._createElement(o,s[a]);this.elements[t+"-"+a]=r}this.sections[t]=i},n.prototype._createElement=function(e,t){var i=this,n=L[t.type];if(!n)return console.error("Invalid element type:",t.type);var o=n(e,t);t.className&&o.addClassNames(t.className);var s=t.gameOptionId;return s&&(g.on(s,this._gameOptionChangedHandler),o.on("destroy",function(){g.removeListener(s,i._gameOptionChangedHandler)})),o},n.prototype._gameOptionChanged=function(e,t,i){i!==x&&this.refreshUi()},n.prototype.refreshUi=function(){for(var e=0;e<this.optionDefinitions.length;e++)this._refreshSection(e);this._updateTabsVisibility(),this._updateElementsVisibility()},n.prototype._refreshSection=function(e){for(var t=this.optionDefinitions[e],i=t.elements,n=0;n<i.length;n++){var o,s=i[n],a=this.elements[e+"-"+n];s.getCurrentValue?o=s.getCurrentValue():s.gameOptionId&&(o=g[s.gameOptionId]),"bool"===s.type?a.toggleActivation(o,!0):"dropdown"===s.type?a.select(o,!0):"custom"===s.type&&"function"==typeof a.updateVisual&&a.updateVisual(o)}},n.prototype._updateTabsVisibility=function(){for(var e=0,t=null,i=0;i<this.optionDefinitions.length;i++){var n=this.optionDefinitions[i],o=!n.shouldShow||n.shouldShow(),s=this.menuList.getChildren()[0],a=s.getChild(i);a.toggleDisplay(o),o?(e++,a.toggleClassName("odd",e%2===0),null===t&&(t=i)):this._hideSection(i)}this.currentSection||null===t||this.menuList.selectItem(t,{noSound:!0})},n.prototype._updateElementsVisibility=function(e){void 0===e&&(e=this.currentSectionId);var t=this.optionDefinitions[e];if(!t||!t.elements)return console.error("Invalid section ID: "+e);for(var i=0;i<t.elements.length;i++){var n=t.elements[i],o=!n.shouldShow||n.shouldShow(),s=this.elements[e+"-"+i];s.toggleDisplay(o)}},n.prototype._showSection=function(e){this.currentSection&&this.currentSection.hide(),this.currentSection=this.sections[e],this.currentSectionId=e,this.currentSection.show(),this._updateElementsVisibility(e),this.settingsScroller.refresh()},n.prototype._hideSection=function(e){var t=this.sections[e];this.currentSection===t&&(this.currentSection.hide(),this.currentSection=null)},n.prototype._selectTab=function(e){var t=this._getSectionByName(e);return void 0===t?console.error("Invalid tab "+e):void this.menuList.selectItem(t,{scrollToElement:!0})},n.prototype._getSectionByName=function(e){for(var t=0;t<this.optionDefinitions.length;t++)if(e===this.optionDefinitions[t].name)return t},n.prototype._initOptionDefinitions=function(){this.optionDefinitions=[{name:"game",title:m("ui.common.general"),elements:[{type:"header",text:m("ui.option.worldOption")},{type:"bool",gameOptionId:"showAllMonsters",text:m("ui.option.viewAllMonsterInGroup")},{type:"dropdown",gameOptionId:"maxTitlesOrnaments",text:m("tablet.option.viewTitlesOrnaments"),values:[0,1,5,10,15,20],labels:[0,1,5,10,15,20]},{type:"dropdown",gameOptionId:"maxActorsBeforeCreatureMode",text:m("ui.option.creaturesMode"),values:[0,10,20,40,9999],labels:[0,10,20,40,m("ui.common.infinit")]},{type:"bool",gameOptionId:"alwaysShowGrid",text:m("tablet.option.alwaysShowGrid")},{type:"dropdown",gameOptionId:"menubarSize",text:m("tablet.option.menubarSize"),values:[2,3,4,5,6],labels:[2,3,4,5,6]},{type:"header",text:m("tablet.option.compass")},{type:"bool",gameOptionId:"autoGpsFlags",text:m("tablet.option.autoGpsFlags")},{type:"button",text:m("tablet.option.unfollowAllQuests"),action:window.gui.GPS.questFollower.unfollowAllQuests.bind(window.gui.GPS.questFollower)},{type:"bool",gameOptionId:"autoGpsPhoenixes",text:m("tablet.option.autoGpsPhoenixes")}]},{name:"fight",title:m("ui.common.fight"),elements:[{type:"header",text:m("ui.common.fight")},{type:"dropdown",gameOptionId:"menubarSizeInFight",text:m("tablet.option.fight.menubarSizeInFight"),values:[2,3,4,5,6],labels:[2,3,4,5,6]},{type:"dropdown",gameOptionId:"toolbarThicknessInFight",shouldShow:function(){return window.gui.ipadRatio},text:m("tablet.option.fight.toolbarThicknessInFight"),values:[1,2,3],labels:[1,2,3]},{type:"bool",gameOptionId:"showMountsInFight",text:m("tablet.option.showMountsInFight"),action:window.isoEngine.actorManager.refreshActorsLook.bind(window.isoEngine.actorManager)},{type:"bool",gameOptionId:"hideDeadFighters",text:m("ui.option.hideDeadFighters")},{type:"bool",gameOptionId:"allowSpellEffects",text:m("ui.option.allowSpellEffects")},{type:"bool",gameOptionId:"confirmBoxWhenWalking",text:m("tablet.option.fight.confirmBoxWhenWalking")},{type:"bool",gameOptionId:"showSpeechBubbleInFight",text:m("tablet.option.fight.showSpeechBubbleInFight")},{type:"bool",gameOptionId:"orderFighters",text:m("tablet.option.fight.orderFighters")},{type:"bool",gameOptionId:"showApMpUsed",text:m("tablet.option.fight.showApMpUsed")},{type:"bool",gameOptionId:"fightAlwaysShowGrid",text:m("tablet.option.fightAlwaysShowGrid")},{type:"header",text:m("ui.charcrea.spells")},{type:"dropdown",gameOptionId:"confirmBoxWhenDragCasting",text:m("tablet.option.fight.confirmBoxWhenDragCasting"),values:[C.NEVER,C.ALWAYS,C.EMPTY_ONLY],labels:[m("tablet.option.fight.Never"),m("tablet.option.fight.Always"),m("tablet.option.fight.EmptyOnly")]},{type:"dropdown",gameOptionId:"confirmBoxWhenClickCasting",text:m("tablet.option.fight.confirmBoxWhenClickCasting"),values:[C.NEVER,C.ALWAYS,C.EMPTY_ONLY],labels:[m("tablet.option.fight.Never"),m("tablet.option.fight.Always"),m("tablet.option.fight.EmptyOnly")]}]},{name:"sounds",title:m("ui.option.audio"),elements:[{type:"header",text:m("ui.option.audioSubtitle")},{type:"bool",gameOptionId:"soundOnPlayerTurnStart",text:m("ui.option.startTurnSound")},{type:"custom",CustomClass:b,text:m("ui.option.musics"),channelId:"music"},{type:"custom",CustomClass:b,text:m("ui.option.environment"),channelId:"sfx"},{type:"custom",CustomClass:b,text:m("ui.option.sounds"),channelId:"ui"}]},{name:"notification",shouldShow:S.isAvailable,title:m("ui.common.notification"),elements:[{type:"header",text:m("ui.common.notification")},{type:"bool",gameOptionId:"systemNotificationsEnabled",text:m("tablet.option.enableNotifications"),className:"groupSwitch"},{type:"bool",gameOptionId:"wantPromoNotif",text:m("tablet.option.wantPromoNotif"),shouldShow:S.isEnabled},{type:"bool",gameOptionId:"wantPrismAttackedNotif",text:m("tablet.option.wantPrismAttackedNotif"),shouldShow:S.isEnabled},{type:"bool",gameOptionId:"wantPrismVulnerableNotif",text:m("tablet.option.wantPrismVulnerableNotif"),shouldShow:S.isEnabled}]},{name:"misc",title:m("ui.option.miscellaneousOptions"),elements:[{type:"header",text:m("ui.common.chat")},{type:"bool",gameOptionId:"censorship",text:m("ui.option.censorship")},{type:"bool",gameOptionId:"chatTimestamp",text:m("ui.option.useChatTime")},{type:"header",text:m("ui.tutorial.tutorial")},{type:"bool",gameOptionId:"tutorialTips",text:m("ui.option.allowTutorial")},{type:"button",text:m("ui.option.resetHints"),action:w.resetTips.bind(w)},{type:"header",text:m("tablet.option.spellTooltip")},{type:"bool",gameOptionId:"spellTooltipName",text:m("tablet.option.spellTooltipName")},{type:"bool",gameOptionId:"spellTooltipApRange",text:m("tablet.option.spellTooltipApRange")},{type:"bool",gameOptionId:"spellTooltipCritical",text:m("tablet.option.spellTooltipCritical")},{type:"bool",gameOptionId:"spellTooltipEffect",text:m("tablet.option.spellTooltipEffect")},{type:"bool",gameOptionId:"spellTooltipDescription",text:m("tablet.option.spellTooltipDescription")}]},{name:"about",title:m("tablet.ui.about"),elements:[{type:"header",text:m("tablet.ui.about")},{type:"infoText",text:window.gui.getBuildVersion()},{type:"button",text:m("tablet.legals.tou"),action:A.openUrlInAppBrowser.bind(null,m("tablet.legals.link.tou"))},{type:"button",text:m("tablet.legals.gcs"),action:A.openUrlInAppBrowser.bind(null,m("tablet.legals.link.gcs"))},{type:"custom",CustomClass:I}]},{name:"performances",title:m("tablet.option.performances"),shouldShow:function(){return E.getAvailableEngineIds().length>1},elements:[{type:"dropdown",text:m("tablet.option.performances.engine"),values:E.getAvailableEngineIds(),labels:E.getAvailableEngineNames(),action:E.changeEngineOptionAction,getCurrentValue:function(){return E.getCurrentEngineId()}}]}]}},function(e,t){},function(e,t,i){function n(e){function t(){i.changeVolume(this.volume),l.playUiSound("SPEC_BUTTON")}o.call(this,"div",{className:"SoundChannelVolume"});var i=this;this.preferences=r.getValue("soundPreferences",l.getDefaultParams(),!0),this.channelId=e.channelId;var n=e.text;this.createChild("div",{className:"label",text:n});for(var a=this.createChild("div",{className:"volumeButtons"}),c=this.buttons=[],u=0;u<5;u++){var d=a.appendChild(new s("",{className:["volume","volume"+u]}));c.push(d),d.volume=u/4,d.disable(),d.on("tap",t)}this.preferences[this.channelId]=this.preferences[this.channelId]||{
volume:0,muted:!0},this.setPosition(this.preferences[this.channelId].volume||0)}i(1237);var o=i(235),s=i(246).DofusButton,a=i(191).inherits,r=i(195),l=i(258);a(n,o),e.exports=n,n.prototype.setPosition=function(e){e=Math.max(0,Math.min(4,~~(4*e)));for(var t=0;t<5;t++)this.buttons[t].enable();this.buttons[e].disable()},n.prototype.changeVolume=function(e){l.setChannelVolume(this.channelId,e),this.setPosition(e),this.preferences[this.channelId].volume=e,this.preferences[this.channelId].muted=0===e,r.setValue("soundPreferences",this.preferences,null,!0)}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"socialBox"});var e=this,t=this.appendChild(new r({className:["socialNetworkButton","facebookButton"]})),i=this.appendChild(new r({className:["socialNetworkButton","twitterButton"]})),n=this.appendChild(new r({className:["socialNetworkButton","discordButton"]})),s=this.appendChild(new r({className:["socialNetworkButton","forumButton"]}));s.appendChild(new a("div",{className:["forumButtonLeft"]})),this.forumButtonCaption=s.appendChild(new a("div",{className:["forumButtonCenter"]})),s.appendChild(new a("div",{className:["forumButtonRight"]})),h(t),t.on("tap",function(){var t=o();e._openSocialNetwork({schemeiOS:"fb://",schemeUrl:"fb://profile/"+p[t].facebookPageNumericId,browserUrl:"https://www.facebook.com/"+p[t].facebookPageNumericId})}),h(i),i.on("tap",function(){var t=o();e._openSocialNetwork({schemeiOS:"twitter://",schemeAndroid:"com.twitter.android",schemeUrl:"twitter://user?screen_name="+p[t].twitterAccountId,browserUrl:"https://twitter.com/"+p[t].twitterAccountId})}),h(n),n.on("tap",function(){var e=o();d.openUrlInDeviceBrowser("https://discordapp.com/invite/"+p[e].discordGroupId)}),h(s),s.on("tap",function(){d.openUrlInAppBrowser(u("tablet.forum.link"))}),this.updateContent()}function o(){var e=window.Config.language;return p[e]||(e=p.fallbackLanguage),e}i(1239);var s=i(191).inherits,a=i(235),r=i(246),l=i(185),c=i(29),u=c.getText,d=i(252),h=i(228),p=i(1240);s(n,a),n.prototype._openSocialNetwork=function(e){if(!window.appAvailability)return d.openUrlInDeviceBrowser(e.browserUrl);var t="";l.isIOSApp?t=e.schemeiOS:l.isAndroidApp&&(t=e.schemeAndroid),window.appAvailability.check(t,function(){window.open(e.schemeUrl,"_system","location=no")},function(){d.openUrlInDeviceBrowser(e.browserUrl)})},n.prototype.updateContent=function(){this.forumButtonCaption.setText(u("tablet.login.forum"))},e.exports=n},function(e,t){},function(e,t){e.exports={fr:{facebookPageId:"DOFUSTouch",facebookPageNumericId:"1663041913975144",twitterAccountId:"DofusTouch",discordGroupId:"K93B4xW"},en:{facebookPageId:"DOFUSTouch",facebookPageNumericId:"1663041913975144",twitterAccountId:"DOFUSTouch_EN",discordGroupId:"K93B4xW"},fallbackLanguage:"en"}},function(e,t,i){function n(){return!!(window.cordova&&window.cordova.plugins&&window.cordova.plugins.WebViewSelector)&&(!!c.isAndroid&&(!(!window.device||!window.device.version)&&o()))}function o(){var e=window.device.version.toString();return e=e.split(".")[0],e=e.replace(/\D/g,""),e=~~e,e>=7}var s,a=i(29).hasText,r=i(29).getText,l=i(225),c=i(185),u="DEFAULT";t.getCurrentEngineId=function(){return n()?window.cordova.plugins.WebViewSelector.currentEngine:u},t.getEngineName=function(e){var t="tablet.webViewSelector.engine."+e;return a(t)?r(t):e},t.setCurrentEngine=function(e,i){return n()?t.getAvailableEngineIds().indexOf(e)===-1?i(r("tablet.webViewSelector.engineUnknown",e)):void window.cordova.plugins.WebViewSelector.setEngine(e,function(e){return e?(console.error("webViewSelector error: "+e),i(r("tablet.webViewSelector.pluginError"))):void i()}):i(r("tablet.webViewSelector.pluginNotFound"))},t.getAvailableEngineIds=function(){if(!s)if(n())try{s=JSON.parse(JSON.stringify(window.cordova.plugins.WebViewSelector.availableEngines))}catch(e){s=[u]}else s=[u];return s},t.getAvailableEngineNames=function(){for(var e=t.getAvailableEngineIds(),i=[],n=0;n<e.length;n++)i.push(t.getEngineName(e[n]));return i},t.changeEngineOptionAction=function(e){if(n()&&e!==t.getCurrentEngineId()){var i=window.gui;t.setCurrentEngine(e,function(e){return e?(i.openSimplePopup(r("tablet.webViewSelector.unableToChangeEngine")+" "+e),void l.getWindow("options").refreshUi()):void i.openConfirmPopup({message:r("tablet.webViewSelector.restartNeeded")+" "+r("tablet.webViewSelector.restartQuestion"),cb:function(e){return e?void navigator.app.exitApp():i.openSimplePopup(r("tablet.webViewSelector.delayedRestart"),r("ui.popup.information"))}})})}}},function(e,t,i){function n(){r.call(this,{className:"FightEndRewardsWindow",positionInfo:{left:"c",top:"c",width:356,height:274}}),this.scroller=this.windowBody.appendChild(new a),this.scroller.content.addClassNames("overlayBox")}i(1243);var o=i(191).inherits,s=i(832),a=i(483),r=i(233);o(n,r),e.exports=n,n.prototype.updateContent=function(e,t,i){this.setTitle(e);var n=this.scroller.content;n.clearContent();for(var o=0;o<t.length;o+=1)n.appendChild(new s({itemData:t[o],quantity:i[t[o].id]||0,tooltipOptions:{openOnTap:!0}}));this.scroller.refresh()}},function(e,t){},function(e,t,i){function n(){a.call(this,{className:"HardcoreDeathWindow",positionInfo:{left:"c",top:"c",width:500,height:365}});var e=this;this.once("open",function(){e._createDom()})}i(1245);var o=i(191).inherits,s=i(282),a=i(233),r=i(235),l=i(225),c=i(246).DofusButton,u=i(29).getText,d=i(202);o(n,a),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.windowBody.createChild("div",{className:"message"}),i=new r("div",{className:"characterIllu"});this.insertAsFirstChild(i),d.preloadImage("gfx/illusUi/Heroique_tx_GameOver.png",function(e){i.setStyle("backgroundImage",e)});var n=this.windowBody.createChild("div",{className:"buttonContainer"}),o=n.appendChild(new c(u("ui.common.yes")));o.on("tap",function(){l.close(e.id),s.goBackToSelectionOf("character")}),this.windowTitle.setText(u("ui.common.gameover")),t.setHtml(u("ui.gameuicore.hardcoreDeath"))}},function(e,t){},function(e,t,i){function n(){c.call(this,{title:s("ui.common.confirm"),className:"ShopConfirmWindow",positionInfo:{left:"c",top:"c",width:500,height:300,isModal:!0}}),this._hintArrow=null,this._reset(),this.on("open",this._onOpen),this.on("close",this._onClose);var e=this;l.on("canNotComputeSoftPrices",function(){if(e.articleBox){var t=!e.isPurchasing,i=!e.params.article.product&&!!e.params.isSoft;t&&i&&u.close(e.id)}}),l.on("computedSoftPricesChange",function(){if(e.articleBox){var t=!e.isPurchasing,i=!e.params.article.product&&!!e.params.isSoft;t&&i&&(d.enrichWithSoftPrice(e.params.article),e.updateAmount())}})}i(1247);var o=i(246),s=i(29).getText,a=i(252),r=i(191).inherits,l=i(806),c=i(233),u=i(225),d=i(805),h=i(718),p=i(1248);r(n,c),e.exports=n,n.prototype._reset=function(){this.params=null,this.cb=null,this.articleBox=null,this.buyBtn=null,this.buyBtnAmount=null,this.buyBtnIcon=null,this.purchaseLoader=null,this._setIsPurchasing(!1)},n.prototype._onOpen=function(){this.articleBox||this._createContent()},n.prototype._onClose=function(){return this._hintArrow.hideArrow(),this.cb&&this.cb(!1)},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._createContent=function(){var e=this.windowBody.createChild("div",{className:"twoColumns"}),t=e.createChild("div",{className:"leftCol"});this.articleBox=t.appendChild(new p(null,{boxWidth:190,boxHeight:220},{showTitle:!0,promoType:"corner"}));var i=e.createChild("div",{className:"rightCol"});i.createChild("div",{className:"buyLabel",text:s("ui.common.buy")});var n=s("ui.common.quantity")+s("ui.common.colon")+"1";i.createChild("div",{className:"quantityLabel",text:n});var a=this;this.buyBtn=i.appendChild(new o({className:["buyBtn","greenButton"]},function(){a._setIsPurchasing(!0),a.cb(!0)})),this._hintArrow=this.buyBtn.appendChild(new h);var r=this.buyBtn.createChild("div",{className:"btnContent"});this.buyBtnAmount=r.createChild("div",{className:"btnAmount"}),this.buyBtnIcon=r.createChild("div",{className:"btnIcon"}),this.purchaseLoader=i.createChild("div",{className:["purchaseLoader","spinner"],hidden:!0}),this.purchaseLoader.createChild("div",{className:"purchaseLoaderLabel",text:s("tablet.shop.transactionInProgress")})},n.prototype.confirmBuy=function(e,t){u.open(this.id),this._setIsPurchasing(!1),this.params=e,this.cb=t,this.articleBox.update(e.article),this.updateAmount()},n.prototype._setIsPurchasing=function(e){this.isPurchasing=!!e,this.articleBox&&(e?(this.closeButton.disable(),this.buyBtn.disable()):(this.closeButton.enable(),this.buyBtn.enable()),this.purchaseLoader.toggleDisplay(e))},n.prototype.updateAmount=function(){if(this.articleBox){var e=this.params,t=e.article,i=t.product;if(i&&e.isInApp)this.buyBtnAmount.setText(i.price),this.buyBtnIcon.hide();else{var n=e.isSoft,o=window.gui.playerData.inventory,s=n?o.kamas:o.goultines,r=n?t._softPrice:t._hardPrice;r>s&&!t._isTutorial?this.buyBtn.disable():this.buyBtn.enable(),this.buyBtnAmount.setText(a.intToString(r)),this.buyBtnIcon.show(),this.buyBtnIcon.toggleClassName("hardCcy",!n),this.buyBtnIcon.toggleClassName("softCcy",!!n),t._isTutorial&&(this.buyBtn.enable(),this._hintArrow.showArrow(30,40))}}}},function(e,t){},function(e,t,i){function n(e,t,i){l.call(this,"div",{className:"box"}),this.options=i||{},this._createDom(),e&&this.update(e),t&&this.resize(t)}function o(){this.emit("tapItemImage")}function s(e){return e.promo&&1===e.promo.length&&e.promo[0].image?e.promo[0].image:e.image&&e.image.length>m?e.image[m].url:null}function a(e){var t=e._promoRate;return t?t:u("tablet.shop.offer")}i(1249);var r=i(191).inherits,l=i(235),c=i(228),u=i(29).getText,d=i(1250),h=i(1252),p=i(205).formatUrlToCssUrl,m=1;r(n,l),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.options,i=this.createChild("div",{className:"slot"});i.createChild("div",{className:"slotBackground"});var n=i.createChild("div",{className:"slotIllu"});if(this.slotImg=n.createChild("div",{className:"slotImg"}),t.showDescription&&(this.description=i.createChild("div",{className:"description"})),i.createChild("div",{className:"slotBorder"}),t.canTapImage&&(c(i),i.on("tap",o.bind(this))),t.showTitle&&(this.title=this.createChild("div",{className:"title"})),t.showButtons){var s=this._articleButtons=this.appendChild(new d);s.on("tapIAPButton",function(){e.emit("tapIAPButton")}),s.on("tapHardButton",function(){e.emit("tapHardButton")}),s.on("tapSoftButton",function(){e.emit("tapSoftButton")})}if("banner"===t.promoType)this._promoBanner=i.createChild("div",{className:"promoBanner"}),this._promoBannerOver=i.createChild("div",{className:"promoBannerOver"});else if("corner"===t.promoType){var a=this._promoCorner=i.createChild("div",{className:"promoCorner"});a.createChild("div",{className:"promoDummy"});var r=a.createChild("div",{className:"promoElement"});r.createChild("div",{className:"margin"});var l=r.createChild("div",{className:"rotatedContainer"});this._promoRate=l.createChild("div",{className:"text"})}else"strip"===t.promoType&&(this._promoStrip=this.createChild("div",{className:"promoStrip"}));this.on("destroy",function(){this._clearCountdown()})},n.prototype._clearCountdown=function(){this.countdown&&this.countdown.clear()},n.prototype.clear=function(){this._clearCountdown()},n.prototype.update=function(e){var t=this.options;this.articleId=e.id;var i=s(e);this.slotImg.setStyle("backgroundImage",i?p(i):"none");var n=!e.hasOwnProperty("_softPrice");this.toggleClassName("goultineOnly",n);var o,r,l=t.promoType;if("banner"===l){var c=e.enddate;if(this._promoBanner.toggleDisplay(!!c),this._promoBannerOver.toggleDisplay(!1),c){var d=this;this._clearCountdown(),this.countdown=new h(new Date(c),function(e,t,i){return e?console.error(e):void d._promoBanner.setText(u("tablet.shop.promo.banner",i))},function(){return d.rootElement?(d._promoBannerOver.setText(u("tablet.shop.promo.banner.over")),d._promoBannerOver.toggleDisplay(!0),void d._promoBanner.toggleDisplay(!1)):console.error(new Error("articleBox onTimeout: the box is missing "+d.articleId))})}}else"corner"===l?(o=e._promoRate,r=!!(o||e.promo&&e.promo.length||e.enddate),this._promoCorner.toggleDisplay(r),r&&this._promoRate.setText(a(e))):"strip"===l&&(o=e._promoRate,r=!!(o||e.promo&&e.promo.length||e.enddate),this._promoStrip.toggleDisplay(r),r&&this._promoStrip.setText(a(e)));t.showTitle&&this.title.setText(e.name),this.updatePrice(e),t.showDescription&&this.description.setHtml(e.description)},n.prototype.updatePrice=function(e){this.options.showButtons&&this._articleButtons.update(e)},n.prototype.resize=function(e){this.setStyles({width:e.boxWidth+"px",height:e.boxHeight+"px"}),this.options.showButtons&&this._articleButtons.resize(e)}},function(e,t){},function(e,t,i){function n(e,t){r.call(this,"div",{className:"priceButtonsBox"}),this._hintArrow=null,this._createDom(),e&&this.update(e),t&&this.resize(t)}function o(e){"tapHardButton"===e&&this._clearHintArrow(),this.emit(e)}function s(e,t,i,n){var o;e.toggleClassName("iap",!!n),n?(e.delClassNames(["unavailable"]),e.currentPriceText.setText(t)):(e.toggleClassName("unavailable",!t),t?(e.currentPriceText.setText(l.kamasToString(t,"")),t>=p?e.replaceClassNames(["lowPrice"],["bigPrice"]):t<m?e.replaceClassNames(["bigPrice"],["lowPrice"]):e.delClassNames(["lowPrice","bigPrice"]),e.enable(),i&&(o=l.kamasToString(i,""),e.originalPriceText.setText(o))):(e.currentPriceText.setText(d("ui.item.averageprice.unavailable")),e.replaceClassNames(["lowPrice"],["bigPrice"]),e.disable()))}i(1251);var a=i(191).inherits,r=i(235),l=i(252),c=i(246),u=c.DofusButton,d=i(29).getText,h=i(718),p=1e6,m=1e3;a(n,r),e.exports=n,n.prototype._createDom=function(){function e(e,i){var n=i?["priceButton",i]:"priceButton",o=t.appendChild(new u("",{className:n},e)),s=o.createChild("div",{className:"prices"}),a=s.createChild("div",{className:"original"});o.originalPriceText=a.createChild("div",{className:"text"}),a.createChild("div",{className:"icon"});var r=s.createChild("div",{className:"current"});return o.currentPriceText=r.createChild("div",{className:"text"}),r.createChild("div",{className:"icon"}),o}this.createChild("div",{className:"priceBorder"});var t=this.priceButtons=this.createChild("div",{className:"priceButtons"});this.iapButton=e(o.bind(this,"tapIAPButton")),this.hardButton=e(o.bind(this,"tapHardButton"),"hard"),this.softButton=e(o.bind(this,"tapSoftButton"),"soft")},n.prototype.update=function(e){this.articleId=e.id;var t=e._hardOriginalPrice,i=e.product;if(this._clearHintArrow(),this.iapButton.hide(),this.hardButton.hide(),this.softButton.hide(),this.hardButton.delClassNames("twoPrices"),this.iapButton.delClassNames("twoPrices"),i&&(s(this.iapButton,e._inAppPrice,e.original_price,!0),this.iapButton.show()),e._hardPrice){this.priceButtons.toggleClassName("promo",!!t),s(this.hardButton,e._hardPrice,t),s(this.softButton,e._softPrice,e._softOriginalPrice),this.hardButton.show();var n=!e.hasOwnProperty("_softPrice");this.softButton.toggleDisplay(!n),n&&i&&(this.iapButton.addClassNames("twoPrices"),this.hardButton.addClassNames("twoPrices")),n||this.hardButton.addClassNames("twoPrices");var o=e._isTutorial;o&&(this.softButton.disable(),this.hardButton.disable(),e.id===window.gui.tutorialManager.SHOP_TUTO_ARTICLE_ID&&(this.hardButton.enable(),this._hintArrow||(this._hintArrow=this.appendChild(new h)),this._hintArrow.showArrow(20,20)))}},n.prototype.resize=function(){},n.prototype._clearHintArrow=function(){this._hintArrow&&(this._hintArrow.clearContent(),this._hintArrow=null)}},function(e,t){},function(e,t,i){function n(e,t,i){this._endTimestamp=e,this._updateCallback=t,this._endCallback=i,this._endTimeout=null,this._updateTimeout=null,this._setUpdateTimeout(),this._setEndTimeout()}function o(e){var t;return e.day?t=e.day+" "+s("tablet.time.days.short",e.day):e.hour?t=e.hour+" "+s("tablet.time.hours.short",e.hour):e.minute&&(t=e.minute+" "+s("tablet.time.minutes.short",e.minute)),t}var s=i(29).getText,a=6e4,r=60*a,l=24*r;e.exports=n,n.prototype.clear=function(){window.clearTimeout(this._updateTimeout),window.clearTimeout(this._endTimeout),this._endTimeout=null,this._updateTimeout=null,this._endTimestamp=null,this._updateCallback=null,this._endCallback=null},n.prototype._setEndTimeout=function(){var e=this,t=Date.now(),i=this._endTimestamp-t;i>l||(i>0?this._endTimeout=window.setTimeout(function(){e._endCallback(),e.clear()},i):(this._endCallback(),this.clear()))},n.prototype._setUpdateTimeout=function(){var e,t=this,i=Date.now(),n=this._endTimestamp-i;if(!(n<=0)){var s=n%a===0?1:0,c=Math.max(0,~~(n/l)-s),u=Math.max(0,~~(n/r)-s),d=Math.max(0,~~(n/a)-s);c?e=n%l||l:u?e=n%r||r:d&&(e=n%a||a);var h={day:c,hour:u,minute:d||1},p=o(h);if(!p)return t._updateCallback(new Error("Time left could not be formatted, day: "+h.day+", hour: "+h.hour+", minute: "+h.minute));t._updateCallback(null,h,p),e&&(this._updateTimeout=window.setTimeout(function(){t._setUpdateTimeout()},e))}}},function(e,t,i){function n(){s.call(this,{window:{className:"MarketWindow",positionInfo:{top:20,left:60,right:20,bottom:20}}}),this.addTab("shop",new a),this.on("open",function(e){this.tabs.openTab(e.tabId,e.tabParams,{delayOpenedEvent:!0,forceOpen:!0})})}i(1254);var o=i(191).inherits,s=i(990),a=i(1255);o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){m.close("market")}function o(){c.call(this,"div",{className:"ShopWindow",name:"shop"}),this.nbArticlesVisible=1,this.activeTopTab=null,this.selectedTopTab=null,this.selectedSubTab=null,this.openedCategory=null,this.categoriesName={},this.categoriesData={},this.bonusCountdown=null,this.requestTimestamp=0,this.requestTimeout=null,this.lastAction=null,this._isInitializing=!1,this.articlesMap={},this._views={},this._currentViewName=null,this._previousViewName=null,this._categoryToOpenWhenReady=null,this._needsResize=!1,this._isOpened=!1,this._articleIdToOpen=0,this._isTutorial=!1,window.gui.on("connected",function(){s()}),this.once("open",function(){this._createDom(),this._setupEvents()}),this.on("open",function(e){e=e||{},this._isTutorial=e.tutorialMode,this._isTutorial&&(this._closeButton.hide(),this.wallet.goultinesBtn.disable(),this.wallet.setFakeHardAmount(400)),e&&e.articleId&&(this._articleIdToOpen=e.articleId)}),this.on("opened",function(e){return this._isOpened=!0,this._isTutorial?(this._needsResize&&this.resize(),this._startTutorial()):this._currentViewName&&!this._isTutorial?void(e.category&&this._navigateToCategory(e.category)):(this._categoryToOpenWhenReady=e.category,this._isInitializing||this._reinitializeShop(),this._needsResize&&this.resize(),void s())}),this.on("close",function(){this._isOpened=!1,this._isTutorial&&(this.wallet.resetFakeHardAmount(),this._closeButton.show(),this._isTutorial=!1),this.clearShop()})}function s(){window.gui.playerData.isShopDisabled()||window.dofus.send("restoreMysteryBox")}function a(){return window.gui.playerData.identification.subscriptionEndDate}i(1256);var r=i(191).inherits,l=i(29).getText,c=i(235),u=i(1013),d=i(258).playUiSound,h=i(246),p=i(228),m=i(225),f=i(1104),g=i(806),_=i(1257),v=i(1259),y=i(1261),b=i(1252),w=i(805),M=i(203),T=i(248),C={en:i(1264),fr:i(1265),de:i(1266),es:i(1267),it:i(1268),pt:i(1269)},I=500,A="itemsList",S="homepage",E="itemDetails",x="homepage",L=556,N=557,O={id:x,name:"",child:[]},D={id:L,name:"Goultine",child:[]},R={lines:1,columns:2,promoType:"strip",showArticleDescription:!0,canTapImage:!1},P={557:R},B={557:!0};r(o,c),e.exports=o,o.prototype._startTutorial=function(){var e=window.Config.language||"en",t=C[e]||C.en;this.onShopOpenSuccess(t)};var k=!0,F=!0;o.prototype.setSubCategoryRowVisible=function(e){var t=F!==e;F=e,this.subCategoryRow.toggleDisplay(e),this.subCategoryRowSeparator.toggleDisplay(e),t&&(this.viewContainer.toggleClassName("hasSubCategory",e),this.resize())},o.prototype._activateTopTab=function(e){var t=e.getWuiName(),i=this.activeTopTab;if(i){if(e===i)return;this._deactivateTopTab(i)}if(this.setSubCategoryRowVisible(!1),t===x)this.closeCategory(this.openedCategory),this._setView(S);else{if(this._isSameCategory(t))return;if(e.sublist){for(var n=this.subCategoryRow.getChildren(),o=0;o<n.length;o++)this.subCategoryRow.removeChild(n[o]);this.subCategoryRow.appendChild(e.sublist),this.setSubCategoryRowVisible(!0),k&&(e.sublist.deactivate(),this.selectedSubTab=null)}this._openCategory(t)}this.activeTopTab=e,this.selectedTopTab=t,e.addClassNames("on"),d("TAB")},o.prototype._activateSubCategory=function(e){var t=e.getWuiName();this._isSameCategory(t)||(this.selectedSubTab=t,this._openCategory(t),d("TAB"))};var z=!0;o.prototype._deactivateTopTab=function(e){var t=e.getWuiName();t!==x&&(e.sublist&&(this.setSubCategoryRowVisible(!1),e.sublist.deactivate()),this._isSameCategory(t)&&this.closeCategory(t)),e.delClassNames("on"),this.activeTopTab=null},o.prototype._deactivateSubCategory=function(e){var t=e.getWuiName();this._isSameCategory(t)&&(this.closeCategory(t),z&&(this.selectedSubTab=null,this._openCategory(this.selectedTopTab)))},o.prototype.deactivateAllCategories=function(){z=!1,this.activeTopTab&&this._deactivateTopTab(this.activeTopTab),z=!0},o.prototype.reactivateCategories=function(){var e=this.selectedTopTab;if(e){k=!1;var t=this.topTabsList.getChild(e);if(this._activateTopTab(t),!t.sublist||!this.selectedSubTab)return void(k=!0);t.sublist.selectItem(this.selectedSubTab),k=!0}},o.prototype._openGoultinesCategory=function(){this._isSameCategory(L)||(this.deactivateAllCategories(),this.setSubCategoryRowVisible(!1),this._openCategory(L))},o.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"row1"});t.createChild("div",{className:["separator","first"]}),this.subCategoryRowSeparator=t.createChild("div",{className:["separator","second"]}),O.name=l("tablet.shop.homepage.name"),this.topTabsList=t.createChild("div",{className:"topTabsList"}),this._closeButton=t.appendChild(new h({className:"closeButton",scaleOnPress:!0})),this._closeButton.on("tap",function(){n()}),this.wallet=t.appendChild(new f({emitTap:!0})),this.wallet.on("moreGoultinesTap",function(){var t=e.topTabsList.getChild(D.id);t&&e._activateTopTab(t)}),this.subCategoryRow=this.createChild("div",{className:"subCategoryRow"}),this.viewContainer=this.createChild("div",{className:"row2"}),this.bonusDisplay=new c("div",{className:"bonusDisplay"});var i=l("tablet.shop.bonusTimeLeft")+l("ui.common.colon");this.bonusDisplay.createChild("div",{className:"title",text:i.toUpperCase()}),this.bonusDetails=this.bonusDisplay.createChild("div",{className:"details"}),this.setSubCategoryRowVisible(!1),this._views[S]=new _,this._views[A]=new v,this._views[E]=new y},o.prototype._setView=function(e,t){if(this._currentViewName!==e){this.deactivateAllCategories(),this._previousViewName=this._currentViewName,this._currentViewName=e;for(var i=this.viewContainer,n=i.getChildren(),o=0;o<n.length;o++)i.removeChild(n[o]);var s=this._views[e];s&&(i.appendChild(s),s.update(t))}},o.prototype.goToPreviousView=function(){return this._previousViewName===S?this.reactivateCategories():this._previousViewName===A?(this.reactivateCategories(),void this._views[A].restoreScrollPosition()):void this._setView(this._previousViewName)},o.prototype._displayItemDetails=function(e){if(!this._isTutorial){if(this._currentViewName===A){var t=this._views,i=t[A];i.saveScrollPosition()}var n=this.articlesMap[e],o=this.openedCategory||x,s=this.categoriesName[o];this._setView(E,{article:n,categoryName:s})}},o.prototype._setupEvents=function(){function e(e){u._isTutorial||w.purchaseArticleOnStore(u.articlesMap[e])}function t(e,t){if(u._isTutorial){var i=window.gui.tutorialManager;e===i.SHOP_TUTO_ARTICLE_ID&&m.getWindow("shopConfirm").confirmBuy({article:u.articlesMap[e]},function(e){return e?void M.setTimeout(function(){window.dofus.sendMessage("QuestObjectiveValidationMessage",{questId:i.SHOP_TUTO_QUEST_ID,objectiveId:8078}),window.gui.openSimplePopup(l("tablet.tutorial.shop.end"),l("ui.common.congratulation")),i.stopShopTutorial(),m.close("shopConfirm"),n()},1e3):void u._views[S].updateArticlesPrices(u.articlesMap)})}else w.purchaseArticleOnAnkama(u.articlesMap[e],t)}function i(e){u.showSubCategoryRow(e)}function o(){u.showSubCategoryRow(!1)}var s=window.dofus.connectionManager,a=this._views,r=a[A],c=a[E],u=this;s.on("shopOpenError",function(e){u.onShopOpenError(e)}),s.on("shopOpenSuccess",function(e){u.onShopOpenSuccess(e)}),s.on("shopOpenCategoryError",function(e){u.onShopOpenCategoryError(e)}),s.on("shopOpenCategorySuccess",function(e){u.onShopOpenCategorySuccess(e)}),s.on("AccessoryPreviewErrorMessage",function(e){console.error(new Error("Accessory preview failed with: "+e.error)),c.setLook(null)}),s.on("AccessoryPreviewMessage",function(e){c.setLook(e.look)}),window.gui.on("resize",function(){u.resize()});for(var d in a){var h=a[d];h.on("displayItemDetails",this._displayItemDetails.bind(this)),h.on("purchaseIAP",e),h.on("purchaseOnAnkama",t),h.on("showSubCategoryRow",i),h.on("hideSubCategoryRow",o)}r.on("loadAdditionalContent",function(){u._saveAndExecuteAction(function(){u.loadAdditionalContent()})}),r.on("nbArticlesVisibleUpdated",function(e){u.nbArticlesVisible=e}),c.on("goToPreviousView",function(){u.goToPreviousView()}),c.on("requestPrevisualization",function(e){s.sendMessage("AccessoryPreviewRequestMessage",{genericId:e})}),g.on("canNotComputeSoftPrices",function(){u.isOpen()&&u.updateArticlesPrices()}),g.on("computedSoftPricesChange",function(){u.isOpen()&&u.updateArticlesPrices()})},o.prototype.isOpen=function(){return m.getWindow("market").openState},o.prototype.showSubCategoryRow=function(e){for(var t=this.subCategoryRow.getChildren(),i=0;i<t.length;i++)this.subCategoryRow.removeChild(t[i]);var n=!!e;this.setSubCategoryRowVisible(n),n&&this.subCategoryRow.appendChild(e)},o.prototype._navigateToCategory=function(e){"goultines"===e?this._openGoultinesCategory():"bonuspack"===e&&this._openCategory(N)},o.prototype.onShopOpenError=function(){this._isInitializing=!1,this.viewContainer.delClassNames("spinner"),this.isOpen()&&this._showErrorPopup(!0)},o.prototype.onShopOpenSuccess=function(e){if(this._isInitializing=!1,this.viewContainer.delClassNames("spinner"),this.isOpen()){this._isTutorial?this.wallet.goultinesBtn.disable():this.wallet.goultinesBtn.enable();var t=e.home;this.setCategories(t.categories);var i=this.topTabsList.getChildren();i.length&&this._activateTopTab(i[0]);var n;if(t._highlightImageArticle){var o=this.validateArticles([t._highlightImageArticle]);o.length&&(n=o[0])}var s;t.gondolahead_article&&(s=this.validateArticles(t.gondolahead_article));var a;if(t._highlightCarouselArticle){var r=this.validateArticles([t._highlightCarouselArticle]);r.length&&(a=r[0])}if(t.hightlight_popup){for(var l=[],c=0,u=t.hightlight_popup.length;c<u;c+=1){var d=t.hightlight_popup[c];d.external_article&&l.push(d.external_article)}this.validateArticles(l)}var h={gondolaHeadArticles:s,highlightCarousel:t._selectedHighlightCarousel,highlightCarouselArticle:a,highlightImageArticle:n};this._views[S].update(h),this._categoryToOpenWhenReady&&this._navigateToCategory(this._categoryToOpenWhenReady),window.wizPurchase&&w.checkPendingPurchases(),this._articleIdToOpen&&this._displayItemDetails(this._articleIdToOpen)}},o.prototype.onShopOpenCategoryError=function(e){if(this._isSameCategory(e.categoryId)){var t=this._views[A];t.setSpinnerVisible(!1),t.setLoadingAdditionalContent(!1),this._showErrorPopup()}},o.prototype.onShopOpenCategorySuccess=function(e){this._loadCategoryWithMessage(e)},o.prototype.resize=function(){if(!this._isOpened)return void(this._needsResize=!0);var e=this._views;for(var t in e)e[t].resize(this.viewContainer);this._needsResize=!1},o.prototype._showErrorPopup=function(e){var t=this;m.getWindow("confirm").update({title:l("ui.common.error"),message:l("ui.popup.accessDenied.serviceUnavailable")+" "+l("tablet.common.askRetry"),cb:function(i){return i?t.lastAction?void t.lastAction():void t._reinitializeShop():void(e&&n())}}),m.openDialog(["confirm"])},o.prototype._isSameCategory=function(e){return e===this.openedCategory},o.prototype._saveAndExecuteAction=function(e){this.lastAction=e,e()},o.prototype.updateArticlesPrices=function(){var e=this.articlesMap;for(var t in e)w.enrichWithSoftPrice(e[t]);var i=this._views;for(var n in i)i[n].updateArticlesPrices(this.articlesMap)},o.prototype._reinitializeShop=function(){function e(e){console.error(e),t._isInitializing=!1,t.viewContainer.delClassNames("spinner"),t.isOpen()&&t._showErrorPopup(!0)}var t=this;this._saveAndExecuteAction(function(){t._isInitializing=!0,t.viewContainer.addClassNames("spinner"),w.getStoreInfos(function(t){return t?e(t):void window.dofus.send("shopOpenRequest")})})},o.prototype.clearShop=function(){var e=this.activeTopTab;e&&this._deactivateTopTab(e),this.closeCategory(this.openedCategory),this.clearCategories(),this.requestTimestamp=0,this.requestTimeout=null,this.lastAction=null,this._isInitializing=!1,this._articleIdToOpen=0,this.wallet.goultinesBtn.disable(),this._setView(S),this._currentViewName=null,this._previousViewName=null;var t=this._views;for(var i in t)t[i].clear()},o.prototype.setCategories=function(e){this.clearCategories(),this._addTopCategories(e)},o.prototype._createCategoryLabel=function(e){var t=new c("div",{className:"textContainer"});return t.createChild("div",{className:"text",text:e.name.toUpperCase()}),t},o.prototype._addTopCategories=function(e){function t(e){s._activateSubCategory(e)}function i(e){s._deactivateSubCategory(e)}function n(){s._activateTopTab(this)}function o(e){s.categoriesName[e.id]=e.name;var o=s.topTabsList.createChild("div",{name:e.id,className:"tab"}),a=o.createChild("div",{className:"icon"});if(a.addClassNames("icon-"+e.id),p(o),o.on("tap",n.bind(o)),T.addTooltip(o,e.name),e.child.length){var r=o.sublist=new u;r.on("activate",t),r.on("deactivate",i),s._addSubCategories(r,e.child)}s._isTutorial&&e.id!==x&&(o.setEnable(!1),o.addClassNames("disable"))}var s=this;o(O);for(var a=0;a<e.length;a++)o(e[a])},o.prototype._addSubCategories=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];this.categoriesName[n.id]=n.name;var o=this._createCategoryLabel(n),s=e.addItem(n.id,o);s.addClassNames("tab")}},o.prototype.clearCategories=function(){this.topTabsList.clearContent(),this.activeTopTab=null,this.selectedTopTab=null,this.selectedSubTab=null,this.openedCategory=null,this.categoriesName={},this.categoriesData={},this.articlesMap={}},o.prototype._loadCategoryWithMessage=function(e){var t=e.categoryId,i=this.categoriesData[t];if(i){if(i.page!==e.page-1)return;i.page=e.page,i.articles=i.articles.concat(e.articles)}else this.categoriesData[t]=e;this._isSameCategory(t)&&this._loadCategory(e)},o.prototype.validateArticles=function(e){for(var t=w.validateArticles(e),i=0;i<t.length;i++){var n=t[i];this.articlesMap[n.id]=n}return t},o.prototype._loadCategory=function(e){var t=this._views[A];if(0===e.totalArticles)return void t.showNoResult(this.categoriesName[this.openedCategory],~~e.categoryId);var i=this.validateArticles(e.articles),n=Math.ceil(e.totalArticles/this.nbArticlesVisible),o=e.page===n;t.addArticles(i,o)},o.prototype.showBonusDetails=function(){var e=this,t=a();t?(this.bonusCountdown&&this.bonusCountdown.clear(),this.bonusCountdown=new b(new Date(t),function(t,i,n){return t?console.error(t):void e.bonusDetails.setText(n.toUpperCase())},function(){e.bonusDetails.setText(l("tablet.shop.noActiveBonus").toUpperCase())})):this.bonusDetails.setText(l("tablet.shop.noActiveBonus").toUpperCase()),this.showSubCategoryRow(this.bonusDisplay)},o.prototype._openCategory=function(e){this._currentViewName!==A&&this._setView(A);var t=this,i=this._views[A],n=P[e];if(i.setConstraints(n)&&i.resize(this.viewContainer),i.setClassNames(["itemsListView","_"+e]),!this._isSameCategory(e)){(this.openedCategory||0===this.openedCategory)&&this.closeCategory(this.openedCategory),B[e]&&this.showBonusDetails(),this.openedCategory=e;var o=this.categoriesData[this.openedCategory];o?this._loadCategory(o):this._saveAndExecuteAction(function(){
i.setSpinnerVisible(!0),t._requestPageOfCategory(e,1)})}},o.prototype.loadAdditionalContent=function(){if(this.openedCategory){this._views[A].setLoadingAdditionalContent(!0);var e=this.categoriesData[this.openedCategory];return e?void this._requestPageOfCategory(this.openedCategory,e.page+1):console.error(new Error("Trying to load additional content of a non-opened category."))}},o.prototype._requestPageOfCategory=function(e,t){var i={categoryId:e,page:t,size:this.nbArticlesVisible},n=function(){window.dofus.send("shopOpenCategoryRequest",i)};window.clearTimeout(this.requestTimeout);var o=Date.now(),s=o-this.requestTimestamp;s>I?n():this.requestTimeout=window.setTimeout(n,I-s),this.requestTimestamp=o},o.prototype.closeCategory=function(e){this.openedCategory&&this._isSameCategory(e)&&(B[e]&&this.bonusCountdown&&(this.bonusCountdown.clear(),this.bonusCountdown=null),this._views[A].clearItems(),this.openedCategory=null)}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"homepageView"}),this.highlightArticleBox=null,this.highlightCarouselArticle=null,this._createDom()}function o(e,t){return{boxWidth:e,boxHeight:t}}i(1258);var s=i(191).inherits,a=i(235),r=i(1248),l=i(44),c=i(228),u=i(205).formatUrlToCssUrl,d=6,h=5,p=8,m=155,f=200,g=1,_=m/f;s(n,a),e.exports=n,n.prototype.clear=function(){this.highlightArticleBox&&(this.highlightArticleBox.clear(),this.highlightArticleBox=null);for(var e=this.gondolaHead.getChildren(),t=0;t<e.length;t++)e[t].clear();this.highlightCarouselArticle=null,this.highlightCarouselImage.hide(),this.highlightImage.clearContent(),this.gondolaHead.clearContent()},n.prototype._createDom=function(){var e=this,t=this.createChild("div",{className:"highlights"});this.gondolaHead=this.createChild("div",{className:"gondolaHead"});var i=t.createChild("div",{className:"highlightCarousel"});this.highlightCarouselImage=i.createChild("div",{className:"highlightCarouselImage"}),this.highlightCarouselImage.hide(),c(i),i.on("tap",function(){e.highlightCarouselArticle&&e.emit("displayItemDetails",e.highlightCarouselArticle.id)}),this.highlightImage=t.createChild("div",{className:"highlightImage"})},n.prototype.resize=function(){},n.prototype.update=function(e){function t(){b.emit("purchaseIAP",this.articleId)}function i(){b.emit("purchaseOnAnkama",this.articleId,l.GOULTINE)}function n(){b.emit("purchaseOnAnkama",this.articleId,l.KAMA)}function s(){b.emit("displayItemDetails",this.articleId)}function a(e,o,a){a=a||{},a.canTapImage=!0,a.showButtons=void 0===a.showButtons||a.showButtons,a.showTitle=void 0===a.showTitle||a.showTitle;var l=!!window.parseInt(e.showCountDown,10);a.promoType=l?"banner":a.promoType;var c=new r(e,o,a);return c.on("tapIAPButton",t),c.on("tapHardButton",i),c.on("tapSoftButton",n),c.on("tapItemImage",s),c}if(this.emit("hideSubCategoryRow"),e){this.clear();var c=e.highlightCarousel,m=!1;if(c){var f=c.image;f.length>d&&(m=!0,this.highlightCarouselArticle=e.highlightCarouselArticle,this.highlightCarouselImage.setStyle("backgroundImage",u(f[d].url)))}this.highlightCarouselImage.toggleDisplay(m);var v,y,b=this,w=e.highlightImageArticle;if(w){this.highlightImage.show();var M=this.highlightImage.rootElement.getBoundingClientRect();y=o(M.width,M.height),this.highlightArticleBox=a(w,y,{promoType:"banner"}),this.highlightImage.appendChild(this.highlightArticleBox)}else this.highlightImage.hide();var T=e.gondolaHeadArticles;if(T){var C=this.gondolaHead.rootElement.getBoundingClientRect(),I=~~C.width+2*h,A=~~C.height-p,S=~~(A*_)+2*h,E=Math.min(T.length,~~(I/S)),x=I-S*E,L=~~(x/E),N=S+L;S=N/A>g?A*g-2*h:N-2*h,y=o(S,A);for(var O=0;O<E;O++)v=a(T[O],y,{promoType:"corner"}),this.gondolaHead.appendChild(v)}}},n.prototype.updateArticlesPrices=function(e){var t=this.gondolaHead.getChildren();this.highlightArticleBox&&t.push(this.highlightArticleBox);for(var i=0;i<t.length;i++){var n=t[i],o=n.articleId;if(o){var s=e[o.toString()];s?n.updatePrice(s):console.error(new Error("Article "+o+" missing for an ArticleBox"))}}}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:"itemsListView"}),this.articlesPerLine=u,this.articlesPerColumn=d,this._isAdditionalContentLoading=!1,this._boxHeight=_,this._boxWidth=g,this._scrollMargin=0,this._scrollPosition=null,this.constraints={},this.setConstraints(w),this._createDom()}i(1260);var o=i(191).inherits,s=i(29).getText,a=i(235),r=i(483),l=i(1248),c=i(44),u=2,d=1,h=9,p=0,m=11,f=9,g=155,_=200,v=_+m,y=40,b=548,w={lines:null,columns:null,promoType:"corner",showArticleDescription:!1,canTapImage:!0};o(n,a),e.exports=n,n.prototype.clear=function(){for(var e=this._getArticleBoxes(),t=0;t<e.length;t++)e[t].clear();this._scrollPosition=null},n.prototype._createDom=function(){var e=this;this._itemsScroll=this.appendChild(new r({className:"scroll"},{isHorizontal:!0})),this._itemsList=this._itemsScroll.content.createChild("div",{className:"itemsList"});for(var t=0;t<this.articlesPerColumn;t++)this._itemsList.createChild("div",{className:"itemsLine"});this._loadContent=this._itemsScroll.content.createChild("div",{className:"loadContent"}),this._loadContent.hide(),this._noResultMessage=this._itemsScroll.content.createChild("div",{className:"rightLabel"}),this._noResultMessageText=this._noResultMessage.createChild("div",{className:"text"}),this._noResultMessage.hide(),this._itemsScroll.on("scrollEnd",function(){!e._isAdditionalContentLoading&&e._loadContent.isVisible()&&Math.abs(this.iScroll.maxScrollX-this.iScroll.x)<y&&e.emit("loadAdditionalContent")})},n.prototype.update=function(){},n.prototype.resize=function(e){this._computeMargins(e);var t=this._getItemsMap(),i=this.getArticleBoxSize();for(var n in t)t[n].resize(i);this._itemsScroll.refresh(),this.emit("nbArticlesVisibleUpdated",(this.articlesPerLine+1)*this.articlesPerColumn)},n.prototype.saveScrollPosition=function(){this._scrollPosition=this._itemsScroll.getScrollPosition()},n.prototype.restoreScrollPosition=function(){var e=this._scrollPosition;e&&this._itemsScroll.scrollTo(e.x,e.y),this._scrollPosition=null},n.prototype.getArticleBoxSize=function(){return{boxWidth:this._boxWidth,boxHeight:this._boxHeight}},n.prototype.setConstraints=function(e){e=e||w;var t=!1;for(var i in w){var n=e.hasOwnProperty(i)?e[i]:w[i];this.constraints[i]!==e[i]&&(this.constraints[i]=n,t=!0)}return t},n.prototype.addArticles=function(e,t){this.setSpinnerVisible(!1),this.setLoadingAdditionalContent(!1),this._loadContent.toggleDisplay(!t),this._addArticles(e)},n.prototype.showNoResult=function(e,t){this.clearItems();var i;i=t===b?s("tablet.shop.category.emote.noResults"):e?s("ui.search.noResultFor",e):s("ui.search.noResult"),this._noResultMessageText.setText(i),this._noResultMessage.show()},n.prototype._addArticles=function(e){function t(){d.emit("purchaseIAP",this.articleId)}function i(){d.emit("purchaseOnAnkama",this.articleId,c.GOULTINE)}function n(){d.emit("purchaseOnAnkama",this.articleId,c.KAMA)}function o(){d.emit("displayItemDetails",this.articleId)}for(var s=0,a=this._itemsList.getChildren(),r=a.length,u=this.getArticleBoxSize(),d=this,h=0;h<e.length;h++){var p={showButtons:!0,showTitle:!0,promoType:this.constraints.promoType,showDescription:this.constraints.showArticleDescription,canTapImage:this.constraints.canTapImage},m=!!window.parseInt(e[h].showCountDown,10);p.promoType=m?"banner":p.promoType;var f=new l(e[h],u,p);f.on("tapIAPButton",t),f.on("tapHardButton",i),f.on("tapSoftButton",n),f.on("tapItemImage",o),a[s%r].appendChild(f),s++}this._itemsScroll.refresh()},n.prototype.setLoadingAdditionalContent=function(e){this._isAdditionalContentLoading=e,e?(this._loadContent.addClassNames("spinner"),this._loadContent.delClassNames("showArrow")):(this._loadContent.delClassNames("spinner"),this._loadContent.addClassNames("showArrow"))},n.prototype.setSpinnerVisible=function(e){e?this._itemsScroll.addClassNames("spinner"):this._itemsScroll.delClassNames("spinner")},n.prototype.clearItems=function(){this.setSpinnerVisible(!1),this.setLoadingAdditionalContent(!1);for(var e=this._itemsList.getChildren(),t=0;t<e.length;t++)e[t].clearContent();this._loadContent.hide(),this._noResultMessage.hide(),this._itemsScroll.refresh(),this._itemsScroll.goToTop()},n.prototype._setNumberOfLines=function(e){if(e!==this.articlesPerColumn){this.articlesPerColumn=e;var t,i=[],n=this._itemsList.getChildren(),o=n.length-e;for(t=0;t<n.length;t++){for(var s=n[t],a=s.getChildren(),r=0;r<a.length;r++)i.push(s.removeChild(a[r]));o>0&&(s.destroy(),o--)}if(n.length<e){var l=e-n.length;for(t=0;t<l;t++)this._itemsList.createChild("div",{className:"itemsLine"})}if(i.length)for(n=this._itemsList.getChildren(),t=0;t<i.length;t++)n[t%e].appendChild(i[t])}},n.prototype._computeMargins=function(e){var t=this.constraints,i=e.rootElement.getBoundingClientRect(),n=i.width-2*p,o=i.height-(2*p+h),s=t.lines||Math.max(d,~~(o/v)),a=o-v*s,r=~~(a/s);if(this._boxHeight=_+r,t.columns){var l=n-(g+2*f)*t.columns,c=~~(l/t.columns);this._boxWidth=g+c}else this._boxWidth=g+r;var y=this._boxHeight+m,b=this._boxWidth+2*f;this.articlesPerLine=t.columns||Math.max(u,~~(n/b)),a=o-y*s,a>1&&(this._scrollMargin=~~(.5*a),this._itemsScroll.setStyles({"margin-top":this._scrollMargin+"px","margin-bottom":this._scrollMargin+"px"})),this._setNumberOfLines(s),this._itemsScroll.refresh()},n.prototype._getArticleBoxes=function(){for(var e=[],t=this._itemsList.getChildren(),i=0;i<t.length;i++)e=e.concat(t[i].getChildren());return e},n.prototype.updateArticlesPrices=function(e){for(var t=this._getArticleBoxes(),i=0;i<t.length;i++){var n=t[i],o=n.articleId;if(o){var s=e[o];s?n.updatePrice(s):console.error(new Error("Article "+o+" missing for an ArticleBox"))}}},n.prototype._getItemsMap=function(){for(var e={},t=this._itemsList.getChildren(),i=0;i<t.length;i++)for(var n=t[i].getChildren(),o=0;o<n.length;o++){var s=n[o];e[s.getWuiName()]=s}return e}},function(e,t){},function(e,t,i){function n(){r.call(this,"div",{className:"itemDetailsView"}),this._resetProperties(),this._createDom()}function o(){return window.gui.playerData.characterBaseInformations.entityLook}i(1262);var s=i(191).inherits,a=i(29).getText,r=i(235),l=i(246),c=i(415),u=i(228),d=i(509),h=i(1248),p=i(1250),m=i(457),f=i(202),g=i(483),_=i(832),v=i(225),y=i(44),b=i(1263),w=i(592),M=i(399),T=i(252),C={};C[M.ACTION_LADDER_ID]=!0,C[M.ACTION_ITEM_CHANGE_PETS_LIFE]=!0,C[M.ACTION_ITEM_PETS_SHAPE]=!0,C[M.ACTION_ITEM_PETS_EAT]=!0,C[M.ACTION_PETS_LAST_MEAL]=!0,C[M.ACTION_ID_LIVING_OBJECT_MOOD]=!0,C[M.ACTION_ID_LIVING_OBJECT_SKIN]=!0,C[M.ACTION_ID_LIVING_OBJECT_CATEGORY]=!0,C[M.ACTION_ID_LIVING_OBJECT_LEVEL]=!0,C[983]=!0,C[984]=!0,C[620]=!0;var I=641,A=429,S=A/I,E=.85,x=2/236;s(n,r),e.exports=n,n.prototype._resetProperties=function(){this._classSymbolImage=null,this._firstItemOfSet=null,this._articleId=null},n.prototype.clear=function(){this._resetProperties(),this._articleBox.clear(),this._characterDisplay.release()},n.prototype._createDom=function(){function e(){n.emit("purchaseIAP",n._articleId)}function t(){n.emit("purchaseOnAnkama",n._articleId,y.GOULTINE)}function i(){n.emit("purchaseOnAnkama",n._articleId,y.KAMA)}var n=this,o=this._backToCategory=new r("div",{className:"goToPrevious"}),s=new l({className:"arrow"},function(){n.emit("goToPreviousView")});o.appendChild(s),this._backToCategoryText=o.createChild("div",{className:"text"}),this.promoBanner=this.createChild("div",{className:"promoBanner"}),this._leftColumnScroller=new g({className:"left"}),this.appendChild(this._leftColumnScroller);var d=this._leftColumnScroller;this.promoDescription=d.content.createChild("div",{className:"promoDescription"});var m=d.content.createChild("div",{className:"topRow"}),f=m.createChild("div",{className:"illuContainer"});f.createChild("div",{className:"dummy"});var _=f.createChild("div",{className:"illuElement"});this._articleBox=_.appendChild(new h);var w=m.createChild("div",{className:"nameAndDescription"});this._name=w.createChild("div",{className:"section"}),this._description=w.createChild("div",{className:"subSection"}),this._weight=this._articleBox.createChild("div",{className:"weight"}),this._linkToItemSet=m.appendChild(new l({className:"setButton",scaleOnPress:!0},function(){n._firstItemOfSet&&v.open("itemSets",n._firstItemOfSet)}));var M=this._itemsListRow=d.content.createChild("div",{className:"itemsListRow"});M.createChild("div",{className:"section",text:a("tablet.shop.comesWith").toUpperCase()}),this._itemsList=M.createChild("div",{className:"subSection"});var T=d.content.createChild("div",{className:"leftItemDetails"});this._effectsBox=T.appendChild(new b(a("ui.common.effects",2).toUpperCase()));var C=d.content.createChild("div",{className:"rightItemDetails"});this._conditionsBox=C.appendChild(new b(a("ui.common.conditions").toUpperCase())),this._characBox=C.appendChild(new b(a("ui.common.caracteristics").toUpperCase()));var I=this.createChild("div",{className:"right"}),A=I.createChild("div",{className:"charaContainer"});A.createChild("div",{className:"dummy"});var S=A.createChild("div",{className:"charaElement"}),E=S.createChild("div",{className:"characterOnIsland"});this._characterOnIsland=E,this._islandImage=E.createChild("div",{className:"islandImage"});var x=this._characterDisplay=E.appendChild(new c),L=x.createChild("div",{className:"leftButton"});u(L,{repeatDelay:100}),L.on("tap",function(){x.rotateCharacter(!1)});var N=x.createChild("div",{className:"rightButton"});u(N,{repeatDelay:100}),N.on("tap",function(){x.rotateCharacter(!0)});var O=I.createChild("div",{className:"priceBottomSection"}),D=this._articleButtons=O.appendChild(new p);D.on("tapIAPButton",e),D.on("tapHardButton",t),D.on("tapSoftButton",i)},n.prototype.resize=function(){var e=this._characterDisplay.rootElement.getBoundingClientRect(),t=S*e.height,i=E*e.height;this._characterDisplay.setStyle("top",t-i+"px");var n=x*e.width;this._characterDisplay.setScale(n),this._leftColumnScroller.refresh()},n.prototype._displayConditions=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=i.text,o=i.isMalus?["malus"]:[];if("string"==typeof n)this._conditionsBox.addRow(n,o);else for(var s=0;s<n.length;s++)this._conditionsBox.addRow(n[s],o)}},n.prototype._displayOneItem=function(e){this._itemsListRow.hide(),this._linkToItemSet.hide();var t=a("ui.common.short.weight",e.getProperty("realWeight"));this._weight.setText(a("ui.common.weight")+a("ui.common.colon")+t);var i;if(this._effectsBox.clearContent(),this._effectsBox.show(),e.hideEffects)this._effectsBox.addRow(a("ui.set.secretBonus"));else{var n=w.getSortedEffectInstances(e);if(n&&n.length)for(i=0;i<n.length;i++){var o=n[i];if(!C[o.effectId])if(""!==o.description){var s=o.effect.bonusType,r=[];s===-1?r.push("malus"):1===s&&r.push("bonus"),this._effectsBox.addRow(o.description,r)}else console.error("Effect "+o.effectId+" not supported for item "+e.getProperty("id"))}this._effectsBox.hasRow()||this._effectsBox.addRow(a("tablet.common.none",0),["placeholder"])}this._conditionsBox.clearContent(),this._conditionsBox.show();var l=e.getProperty("conditionsFormatted"),c=e.getProperty("targetConditionsFormatted");if(0===l.length&&0===c.length?this._conditionsBox.addRow(a("tablet.common.none",1),["placeholder"]):(this._displayConditions(l),this._displayConditions(c)),this._characBox.clearContent(),e.getProperty("isWeapon")){this._characBox.show();var u=e.getProperty("statsFormatted");if(0===u.length)this._characBox.addRow(a("tablet.common.none",1),["placeholder"]);else for(i=0;i<u.length;i++)this._characBox.addRow(u[i])}else this._characBox.hide();this._leftColumnScroller.refresh()},n.prototype._displayMultipleItems=function(e){function t(){v.open("itemBox",{itemData:this.data})}this._itemsListRow.show(),this._effectsBox.hide(),this._conditionsBox.hide(),this._characBox.hide();var i,n=0;this._itemsList.clearContent();for(var o=0;o<e.length;o++){i=e[o],n+=i.getProperty("realWeight");var s=new _({itemData:i});s.on("tap",t),this._itemsList.appendChild(s)}var r=a("ui.common.short.weight",n);this._weight.setText(a("ui.common.weight")+a("ui.common.colon")+r),i=e[0];var l=i.itemSetId;l&&l!==-1?(this._firstItemOfSet=i,this._linkToItemSet.show()):(this._firstItemOfSet=null,this._linkToItemSet.hide()),this._leftColumnScroller.refresh()},n.prototype.update=function(e){if(this.emit("showSubCategoryRow",this._backToCategory),e){this._itemsListRow.hide(),this._effectsBox.hide(),this._conditionsBox.hide(),this._characBox.hide(),this._backToCategoryText.setText(a("tablet.shop.backTo",e.categoryName));var t=e.article;this._articleId=t.id,this._name.setText(t.name.toUpperCase()),this._description.setHtml(t.description),T.allLinksOnTargetBlank(this._description),this._articleBox.update(t),this._articleButtons.update(t),this._setClassSymbol(),this._characterDisplay.hide(),this._islandImage.addClassNames("spinner");var i=t.promo&&t.promo.length,n=t._promoRate;if(i||n||t.enddate){this._leftColumnScroller.addClassNames("promo"),this.promoBanner.show(),this.promoDescription.toggleDisplay(!!i);var s,r;if(i||n||!t.enddate?n||t.enddate?(s=a("tablet.shop.offer")+a("ui.common.colon"),n&&(s+=n),t.enddate&&(n&&(s+=" "),r=new Date(t.enddate),s+=a("tablet.common.until",r.toLocaleDateString()))):s=a("tablet.shop.offer"):(r=new Date(t.enddate),s=a("tablet.common.available",a("tablet.common.until",r.toLocaleDateString()))),this.promoBanner.setText(s),i){for(var l=t.promo,c="",u=a("ui.common.colon"),h=0;h<i-1;h++)c+=l[h].name+u+l[h].description+"<br /><br />";c+=l[i-1].name+u+l[i-1].description,this.promoDescription.setHtml(c)}}else this._leftColumnScroller.delClassNames("promo"),this.promoBanner.hide(),this.promoDescription.hide();this._leftColumnScroller.refresh();var p=this,m=t.itemsId;d.getItems(m,function(e,t){if(e)return console.error("ItemDetailsView#update: getItems",e);var i=t.length;if(m.length!==i)return console.error(new Error("Some items are missing, ids requested: "+m+", items get: "+t));i&&(1===i?p._displayOneItem(t[0]):p._displayMultipleItems(t));for(var n=[],s=0;s<i;s++){var a=t[s];a.isEquippable()&&n.push(a.getProperty("id"))}n.length?p.emit("requestPrevisualization",n):p.setLook(o())})}},n.prototype.setLook=function(e){e=e||o();var t=this;this._characterDisplay.setLook(e,{boneType:"characters/",skinType:"characters/",direction:m.DIRECTION_SOUTH_WEST,keepDirection:!1,keepModels:!0},function(){t._islandImage.delClassNames("spinner"),t._characterDisplay.show()})},n.prototype.updateArticlesPrices=function(e){var t,i=this._articleBox,n=this._articleButtons,o=i.articleId;o&&(t=e[o],t?i.updatePrice(t):console.error(new Error("Article "+o+" missing for an ArticleBox"))),o=n.articleId,o&&(t=e[o],t?n.update(t):console.error(new Error("Article "+o+" missing for an ArticleButtons")))},n.prototype._setClassSymbol=function(){if(!this._classSymbolImage){var e=this,t=window.gui.playerData.characterBaseInformations;f.preloadImage("gfx/illusUi/symboles_classe/FichePerso_tx_symboleClasse_frame"+(t.breed-1)+".png",function(t){e._classSymbolImage=t,e._characterOnIsland.setStyle("backgroundImage",t)})}}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"itemDetailsBox"}),this._createDom(e)}i(1262);var o=i(191).inherits,s=i(235);o(n,s),e.exports=n,n.prototype._createDom=function(e){var t=this.createChild("div",{className:"header"});t.createChild("div",{className:"title",text:e}),t.createChild("div",{className:"titleCorner"}),this._content=this.createChild("div",{className:"content"})},n.prototype.clearContent=function(){this._content.clearContent()},n.prototype.addRow=function(e,t){t=t||[],t.push("row"),this._content.createChild("div",{className:t,text:e})},n.prototype.hasRow=function(){return this._content.getChildCount()>0}},function(e,t){e.exports={_messageType:"shopOpenSuccess",home:{categories:[{id:557,name:"Bonus Packs",child:[]},{id:545,name:"Items",child:[]},{id:617,name:"Prestige",child:[]}],gondolahead_article:[{id:9312,name:"Mimisymbic",currency:"GOU",price:5e3,hardOnlyTuto:!0,_isTutorial:!0,references:[{reference_virtualgift:[{id:"14485"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/9312/gallery_all_200_200.png"}]},{id:-777,name:"Novice Shield",currency:"GOU",price:400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"10798"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/-777/gallery_all_200_200.png"}]},{id:8434,name:"Novice Pack",currency:"GOU",price:4400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"12420"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/8434/gallery_all_200_200_2.png"}]}],_selectedHighlightCarousel:{id:765,type:"ARTICLE",image:[{},{},{},{},{},{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/765/mea_all_950_531.jpg"}]},_highlightImageArticle:{id:7540,name:"Bonus Pack 30-Day",currency:"GOU",references:[],promo:[],price:3060,_isTutorial:!0,image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/7540/gallery_all_200_200.png"}]}}}},function(e,t){e.exports={_messageType:"shopOpenSuccess",home:{categories:[{id:557,name:"Bonus Packs",child:[]},{id:545,name:"Tous les Objets",child:[]},{id:617,name:"Prestige",child:[]}],gondolahead_article:[{id:9312,name:"Mimibiote",currency:"GOU",price:5e3,hardOnlyTuto:!0,_isTutorial:!0,references:[{reference_virtualgift:[{id:"14485"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/9312/gallery_all_200_200.png"}]},{id:-777,name:"Bouclier du dbutant",currency:"GOU",price:400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"10798"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/-777/gallery_all_200_200.png"}]},{id:8434,name:"Pack Novice",currency:"GOU",price:4400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"12420"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/8434/gallery_all_200_200_2.png"}]}],_selectedHighlightCarousel:{id:765,type:"ARTICLE",image:[{},{},{},{},{},{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/765/mea_all_950_531.jpg"}]},_highlightImageArticle:{id:7540,name:"Bonus Pack 30 jours",currency:"GOU",references:[],promo:[],price:3060,_isTutorial:!0,image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/7540/gallery_all_200_200.png"}]}}}},function(e,t){e.exports={_messageType:"shopOpenSuccess",home:{categories:[{id:557,name:"Bonus-Paket",child:[]},{id:545,name:"Ingame-Artikel",child:[]},{id:617,name:"Prestige",child:[]}],gondolahead_article:[{id:9312,name:"Mimibiont",currency:"GOU",price:5e3,hardOnlyTuto:!0,_isTutorial:!0,references:[{reference_virtualgift:[{id:"14485"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/9312/gallery_all_200_200.png"}]},{id:-777,name:"Anfnger-Schild",currency:"GOU",price:400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"10798"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/-777/gallery_all_200_200.png"}]},{id:8434,name:"Novizenpaket",currency:"GOU",price:4400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"12420"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/8434/gallery_all_200_200_2.png"}]}],_selectedHighlightCarousel:{id:765,type:"ARTICLE",image:[{},{},{},{},{},{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/765/mea_all_950_531.jpg"}]},_highlightImageArticle:{id:7540,name:"Bonus-Paket 30 Tage",currency:"GOU",references:[],promo:[],price:3060,_isTutorial:!0,image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/7540/gallery_all_200_200.png"}]}}}},function(e,t){e.exports={_messageType:"shopOpenSuccess",home:{categories:[{id:557,name:"Bonus Packs",child:[]},{id:545,name:"Objetos",child:[]},{id:617,name:"Prestigio",child:[]}],gondolahead_article:[{id:9312,name:"Mimobionte",currency:"GOU",price:5e3,hardOnlyTuto:!0,_isTutorial:!0,references:[{reference_virtualgift:[{id:"14485"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/9312/gallery_all_200_200.png"}]},{id:-777,name:"Escudo de principiante",currency:"GOU",price:400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"10798"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/-777/gallery_all_200_200.png"}]},{id:8434,name:"Pack de Principiante",currency:"GOU",price:4400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"12420"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/8434/gallery_all_200_200_2.png"}]}],_selectedHighlightCarousel:{id:765,type:"ARTICLE",image:[{},{},{},{},{},{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/765/mea_all_950_531.jpg"}]},_highlightImageArticle:{id:7540,name:"Bonus Pack 30 das",currency:"GOU",references:[],promo:[],price:3060,_isTutorial:!0,image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/7540/gallery_all_200_200.png"}]}}}},function(e,t){e.exports={_messageType:"shopOpenSuccess",home:{categories:[{id:557,name:"Bonus Packs",child:[]},{id:545,name:"Oggetti del gioco",child:[]},{id:617,name:"Prestigio",child:[]}],gondolahead_article:[{id:9312,name:"Mimibio",currency:"GOU",price:5e3,hardOnlyTuto:!0,_isTutorial:!0,references:[{reference_virtualgift:[{id:"14485"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/9312/gallery_all_200_200.png"}]},{id:-777,name:"Scudo del debuttante",currency:"GOU",price:400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"10798"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/-777/gallery_all_200_200.png"}]},{id:8434,name:"Pack Novizio",currency:"GOU",price:4400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"12420"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/8434/gallery_all_200_200_2.png"}]}],_selectedHighlightCarousel:{id:765,type:"ARTICLE",image:[{},{},{},{},{},{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/765/mea_all_950_531.jpg"}]},_highlightImageArticle:{id:7540,name:"Bonus Pack 30 giorni",currency:"GOU",references:[],promo:[],price:3060,_isTutorial:!0,image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/7540/gallery_all_200_200.png"}]}}}},function(e,t){e.exports={_messageType:"shopOpenSuccess",home:{categories:[{id:557,name:"Pacote Bnus",child:[]},{id:545,name:"Itens",child:[]},{id:617,name:"Prestgio",child:[]}],gondolahead_article:[{id:9312,name:"Mimibitico",currency:"GOU",price:5e3,hardOnlyTuto:!0,_isTutorial:!0,references:[{reference_virtualgift:[{id:"14485"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/9312/gallery_all_200_200.png"}]},{id:-777,name:"Escudo de Aprendiz",currency:"GOU",price:400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"10798"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/-777/gallery_all_200_200.png"}]},{id:8434,name:"Pacote do Iniciante",currency:"GOU",price:4400,_isTutorial:!0,references:[{reference_virtualgift:[{id:"12420"}]}],promo:[],image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/8434/gallery_all_200_200_2.png"}]}],_selectedHighlightCarousel:{id:765,type:"ARTICLE",image:[{},{},{},{},{},{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/765/mea_all_950_531.jpg"}]},_highlightImageArticle:{id:7540,name:"Pacote Bnus - 30 dias",currency:"GOU",references:[],promo:[],price:3060,_isTutorial:!0,image:[{},{url:"https://dofustouch.cdn.ankama.com/assets/shopTuto/v1/img/article/7540/gallery_all_200_200.png"}]}}}},function(e,t,i){function n(){r.call(this,{title:s("tablet.shop.needMoreHardCurrency").toUpperCase(),className:"BuyHardCurrencyConfirmWindow",positionInfo:{left:"c",top:"c",width:540,height:440,isModal:!0}}),this._reset(),this.on("open",this._onOpen);var e=this,t=window.dofus.connectionManager;t.on("shopIAPArticlesSuccess",function(t){e.content&&e.displayHardCurrencyPack(t)}),t.on("shopIAPArticlesError",function(){e.content&&e.displayError(d.NO_PACK,new Error("IAP articles are not available"))})}i(1271);var o=i(246),s=i(29).getText,a=i(191).inherits,r=i(233),l=i(225),c=i(805),u=i(1248),d={NO_PACK:0,AMOUNT_TOO_HIGH:1};a(n,r),e.exports=n,n.prototype._reset=function(){this.content=null,this.buyPackText=null,this.articleBoxContainer=null,this.articleBox=null,this.hardCurrencyAmountMissing=0},n.prototype._onOpen=function(){this.content||this._createContent()},n.prototype.freeContent=function(){this.windowBody.clearContent(),this._reset()},n.prototype._createContent=function(){this.content=this.windowBody.createChild("div",{className:"content"});var e=this.content.createChild("div",{className:"buyPackTextContainer"});this.buyPackText=e.createChild("div",{className:"buyPackText"}),this.articleBoxContainer=this.content.createChild("div",{className:"articleBoxContainer"}),this.articleBox=this.articleBoxContainer.appendChild(new u(null,{boxWidth:190,boxHeight:220},{showTitle:!0,showButtons:!0,promoType:"corner"})),this.content.appendChild(new o({text:s("tablet.shop.seeAllHardCurrencyPacks"),className:["greenButton","seePacksBtn"]},function(){l.close("buyHardCurrencyConfirm"),l.open("market",{tabId:"shop",tabParams:{category:"goultines"}})}))},n.prototype.confirmBuy=function(e){l.open(this.id),this.content.hide(),this.windowBody.addClassNames("spinner"),this.hardCurrencyAmountMissing=e;var t=this;c.getStoreInfos(function(e){return e?t.displayError(d.NO_PACK,e):void window.dofus.send("shopIAPArticlesRequest")})},n.prototype.displayError=function(e,t){t&&console.error(t),this.content&&(this.content.show(),this.articleBoxContainer.hide(),this.windowBody.delClassNames("spinner"),e===d.AMOUNT_TOO_HIGH?this.buyPackText.setText(s("tablet.shop.noHardCurrencyPackForAmount")):this.buyPackText.setText(s("tablet.shop.noHardCurrencyPack")))},n.prototype.displayHardCurrencyPack=function(e){var t=c.validateArticles(e.articles),i=null,n=Number.MAX_VALUE;if(!t.length)return this.displayError(d.NO_PACK,new Error("No valid IAP "+t.length+" out of "+e.articles.length+" articles"));for(var o=0;o<t.length;o++){var a=t[o],r=1===a.references.length&&a.references[0];if(r&&"GOULTINE"===r.type){var u=parseInt(r.quantity,10);isNaN(u)||u<this.hardCurrencyAmountMissing||u<n&&(n=u,i=a)}}return i?(this.content.show(),this.articleBoxContainer.show(),this.windowBody.delClassNames("spinner"),this.buyPackText.setText(s("tablet.shop.buyHardCurrencyPack",n)),this.articleBox.update(i),void this.articleBox.on("tapIAPButton",function(){l.close("buyHardCurrencyConfirm"),c.purchaseArticleOnStore(i)})):this.displayError(d.AMOUNT_TOO_HIGH)}},function(e,t){},function(e,t,i){function n(){r.call(this,{title:s("tablet.purchasesPending.title"),className:"PurchasesPendingWindow",noCloseButton:!0,positionInfo:{left:"c",top:"c",width:450,height:243,isModal:!0}}),this._reset(),this.on("open",this._onOpen);var e=this,t=window.dofus.connectionManager;t.on("shopIAPArticlesSuccess",function(t){if(e._content){var i=t.articles;c.validateArticles(i),e._displayPurchasesList(null,i)}}),t.on("shopIAPArticlesError",function(){e._content&&e._displayPurchasesList(new Error("IAP articles are not available"))})}i(1273);var o=i(246),s=i(29).getText,a=i(191).inherits,r=i(233),l=i(225),c=i(805),u={PENDING:0,FAILED:1,SUCCEEDED:2};a(n,r),e.exports=n,n.prototype._reset=function(){this.windowBody.clearContent(),this._content=null,this._description=null,this._spinner=null,this._pendingPurchases=[],this._purchasesDetails={},this._isProcessing=!1},n.prototype._onOpen=function(){this._content||this._createContent()},n.prototype.freeContent=function(){this._reset()},n.prototype._createContent=function(){
this._content=this.windowBody.createChild("div",{className:"content"});var e=this._content.createChild("div",{className:"textBox"});this._description=e.createChild("div",{className:"description"}),this._purchasesList=e.createChild("div",{className:"purchasesList"}),this._spinner=e.createChild("div",{className:["spinnerContainer","spinner"]}),this._validationDone=e.createChild("div",{className:"validationDone",hidden:!0}),this._okButton=this._content.appendChild(new o({text:s("ui.common.ok"),className:["greenButton","okButton"]},function(){l.close("purchasesPending")})),this._okButton.disable()},n.prototype._processNext=function(){var e=this._pendingPurchases.shift();c.validatePendingIAP(e)},n.prototype._displayPurchasesListNotAvailable=function(){this._spinner.hide(),this._purchasesList.setText(s("tablet.purchasesPending.listNotAvailable"))},n.prototype._displayPurchasesList=function(e,t){if(e&&console.error(e),this._content)if(e)this._displayPurchasesListNotAvailable();else{for(var i=0;i<t.length;i++){var n=t[i],o=this._purchasesDetails[n.key];if(o){var s=this._purchasesList.getChild(n.key);s||(s=this._purchasesList.createChild("div",{className:"entry",name:n.key,text:n.name}),s.createChild("div",{className:"state"}),s.createChild("div",{className:"name",text:n.name})),o.article=n;var a=o.state;switch(a){case u.PENDING:s.delClassNames(["failure","success"]);break;case u.FAILED:s.replaceClassNames(["success"],["failure"]);break;case u.SUCCEEDED:s.replaceClassNames(["failure"],["success"])}}}Object.keys(this._purchasesDetails).length<=this._purchasesList.getChildCount()?this._spinner.hide():this._spinner.show()}},n.prototype.validatePendingPurchases=function(e){if(!e||!e.length)return console.error(new Error("No purchase to validate: "+e));var t=e.filter(function(e){return!this._purchasesDetails[e.productId]},this);if(t.forEach(function(e){this._purchasesDetails[e.productId]={state:u.PENDING,article:null}},this),this._pendingPurchases=this._pendingPurchases.concat(t),t.length){l.open(this.id),this._description.setText(s("tablet.purchasesPending.description",Object.keys(this._purchasesDetails).length)+s("ui.common.colon")),this._spinner.show();var i=this;c.getStoreInfos(function(e){return e?i._displayPurchasesList(e):(window.dofus.send("shopIAPArticlesRequest"),void i._startProcessing())})}},n.prototype._startProcessing=function(){this._isProcessing||(this._isProcessing=!0,this._validationDone.hide(),this._okButton.disable(),this._processNext())},n.prototype._endProcessing=function(){var e=0,t=!1;for(var i in this._purchasesDetails){var n=this._purchasesDetails[i].state;n===u.SUCCEEDED?e++:t||n!==u.FAILED||(t=!0)}t&&window.wizPurchase.refreshReceipt(function(){},function(e){console.error("Refresh receipt failed",e)}),this._purchasesList.getChildCount()||this._displayPurchasesListNotAvailable(),this._isProcessing=!1,this._validationDone.setText(s("tablet.purchasesPending.validationDone",e)),this._validationDone.show(),this._okButton.enable()},n.prototype.validateNextPendingPurchases=function(e,t){if(e&&console.error(e),this._content){var i=this._purchasesList.getChild(t);this._purchasesDetails[t].state=e?u.FAILED:u.SUCCEEDED,i&&(e?i.replaceClassNames(["success"],["failure"]):i.replaceClassNames(["failure"],["success"])),this._pendingPurchases.length?this._processNext():this._endProcessing()}}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"ToaWindow",title:a("ui.toa.interfaceTitle"),positionInfo:{left:"c",top:"c",width:"75%",height:"90%",minWidth:700,maxHeight:650,mustAvoidToolbar:!0}}),this.once("open",function(){var e=window.gui.playerData.ToaData;e.initRanksData(),this.body=this.windowBody.createChild("div",{className:"ToaBody"});var t=new l,i=new c,n=new u;this.createTabs(this.body,[{title:a("ui.toa.maintabGeneral"),content:t,name:e.GENERAL_TAB_NAME},{title:a("ui.toa.maintabComposition"),content:i,name:e.COMPOSITION_TAB_NAME},{title:a("ui.toa.maintabLadder"),content:n,name:e.LADDER_TAB_NAME}])}),this.on("open",function(){this.setupTabs(),this.body.tabs.emitOnCurrentTab("open")})}i(1275);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(934),l=i(1276),c=i(1280),u=i(1282),d=i(184),h=!1;o(n,s),e.exports=n,n.prototype.createTabs=function(e,t){e.tabs=new r,e.appendChild(e.tabs),e.panels=e.createChild("div",{className:"panels"}),e.panelCollection={};for(var i=0,n=t.length;i<n;i+=1){var o=t[i].name;e.panelCollection[o]=e.panels.appendChild(t[i].content),e.tabs.addTab(t[i].title,e.panelCollection[o],i)}var s=this.body.tabs;s.openFirstTab(),this.setupTabs()},n.prototype.setupTabs=function(){var e=window.gui.playerData.ToaData,t=this.body.tabs,i=t.getTabsMap(),n=this,o=t.getCurrentTab().tab.isEnable();for(var s in i){var a=i[s],r=a.target.getWuiName();e.canTabBeDisable(r)?a.tab.disable():a.tab.enable()}e.isQuestAccomplished()||h||(window.gui.playerData.quests.on("questFinished",function(e){e.questId===d.TOA_QUEST_ID&&n.setupTabs()}),h=!0),o||t.openFirstTab()}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:["panel","generalTab"],name:"general"});var e=this;this.openedTabId=null,this.once("open",function(){e._setupDom()}),this.on("open",function(){var e=window.gui.playerData.ToaData,t=e.current.score,i=c.getStepsData();this._mapLocationButton&&this._mapLocationButton.destroy(),i?(this._score.delClassNames("unavailable"),this._score.setText(o("ui.common.score")+o("ui.common.colon")+t)):(this._score.addClassNames("unavailable"),this._score.setText(o("ui.toa.ascensionClosed")));var n=e.isQuestAccomplished(),s={type:n?"zaap":"quest",x:n?u:h,y:n?d:p};this._mapLocationButton=this._localisationBox.appendChild(new l(s))})}i(1277);var o=i(29).getText,s=i(191).inherits,a=i(235),r=i(483),l=i(1002).MapLocationButton,c=i(1278),u=-73,d=-17,h=-33,p=-11;s(n,a),e.exports=n,n.prototype._setupDom=function(){var e=this.createChild("div",{className:"contentBlock"}),t=this._mainScroller=e.appendChild(new r({className:"ToaScroller"})),i=t.content.createChild("div",{className:"scrollBlock"});this._createContent(i),t.refresh()},n.prototype._createContent=function(e){var t=e.createChild("div",{className:"generalContent"}),i=t.createChild("div",{className:"introBlock"}),n=i.createChild("div",{className:"col1"}),s=n.createChild("div",{className:"titleHeaderContentBlock"});s.createChild("div",{className:"title"}).setHtml(o("ui.toa.welcome"));var a=i.createChild("div",{className:"col2"}),r=a.createChild("div",{className:"scoreBoxHeaderContentBlock"});this._score=r.createChild("div",{className:"playerScore"}),n.createChild("div",{className:"description"}).setHtml(o("ui.toa.welcomeText"));var l=this._localisationBox=a.createChild("div",{className:"localisationBox"});l.createChild("div",{className:"locDescription",text:o("ui.toa.localisation")}),t.createChild("hr",{className:"separator"});var u=t.createChild("div",{className:"rewardsBlock"}),d=u.createChild("div",{className:"rewardsHeader"}),h=d.createChild("div",{className:"rewardsTitleBox"});h.createChild("div",{className:"title"}).setHtml(o("ui.toa.rewards"));var p=u.createChild("div",{className:"rewardsContent"}),m=window.gui.playerData.ToaData,f=[{id:"rankName",header:o("ui.toa.rewardsBoardRank"),sort:!1},{id:"score",header:o("ui.toa.rewardsBoardScore"),sort:!1},{id:"details",header:o("ui.toa.maintabLadder"),sort:!1},{id:"rewards",header:o("ui.grimoire.quest.rewards"),format:function(e){return c.displayRewardsDetails(e.id)},sort:!1}];c.createTable(p,f,!1),c.setContent(p,m.ranks),p.createChild("div",{className:"description"}).setHtml(o("ui.toa.rewardsText")),t.createChild("hr",{className:"separator"});var g=t.createChild("div",{className:"scoreBlock"}),_=g.createChild("div",{className:"scoreHeader"}),v=_.createChild("div",{className:"scoreTitleBox"});v.createChild("div",{className:"title"}).setHtml(o("ui.toa.scoring"));var y=g.createChild("div",{className:"scoreContent"});y.createChild("div",{className:"description"}).setHtml(o("ui.toa.scoringText")),t.createChild("hr",{className:"separator"});var b=t.createChild("div",{className:"rulesBlock"}),w=b.createChild("div",{className:"rulesHeader"}),M=w.createChild("div",{className:"rulesTitleBox"});M.createChild("div",{className:"title"}).setHtml(o("ui.toa.rules"));var T=b.createChild("div",{className:"rulesContent"});T.createChild("div",{className:"description"}).setHtml(o("ui.toa.rulesText"))}},function(e,t){},function(e,t,i){function n(e,t,i,n){n||(n=!1),e.table=e.appendChild(new d(t,i,{clickable:!1})),e.table.scroller.setEnable(n)}function o(e,t){return e.table.getRowCount()>0&&e.table.clearContent(),t?p(t)?e.table.setPlaceholderText(h("ui.search.noResult")):(e.table.setPlaceholderText(null),void e.table.addMap(t)):e.table.setPlaceholderText(h("ui.toa.ladderUnavailable"))}function s(e){var t=new g("div",{className:"rewardsDisplay"}),i=window.gui.playerData.ToaData.ranks[e];return i?(a(i,function(e,n){if(e)return void console.error("Loaded static achievement data error",e);var o=[],s=[];n.sort(function(e,t){var i=e.quantity||6,n=t.quantity||6;return n-i});for(var a=0;a<n.length;a+=1)n[a]&&n[a].data&&(s.push(n[a].data.id),o.push(n[a]));v.getItems(s,function(e){if(e)return void console.error("Failed to get items",e);for(var n=0;n<s.length;n+=1){var a=s[n],r=v.items[a],c=t.appendChild(new _({name:"icon"+n})),u=o[n];if(r&&"Item"===u.data._type){var d=h("ui.item.averageprice")+" : ",p=r.getProperty("averagePrice");d+=p===-1?h("ui.item.averageprice.unavailable"):y.kamasToString(p),c.setContextMenu("item",{item:r})}var m=u.url,f=u.quantity,b=u.data;c.setImage(m),f&&c.setQuantity(f);var w=new g("div");w.createChild("div",{text:b.nameId||l(b)}),d&&"Item"===u.data._type&&w.createChild("div",{text:d}),b.descriptionId&&w.createChild("div",{text:b.descriptionId,className:"details"}),c.setTooltip(w)}if(i.goultines){var M=t.appendChild(new _({name:"iconGoultine"}));M.icon.addClassNames("iconGoultine"),M.setQuantity(i.goultines);var T=new g("div");T.createChild("div",{text:h("ui.common.goultines")}),M.setTooltip(T)}})}),t):t}function a(e,t){function i(e,i){if(!l)return e?(l=!0,t(e)):(c=c.concat(i),s+=i.length,a+=1,s===o||a===n.length?t(null,c):void 0)}if(!e)return t(null,[]);for(var n=["Items","Ornaments"],o=0,s=0,a=0,l=!1,c=[],u=[],d=[],h=0;h<e.rewards.length;h++)u.push(e.rewards[h].itemId),d.push(e.rewards[h].quantity);var p=[];return e.ornament>0&&p.push(e.ornament),o+=u.length+p.length,r(n[0],u,"gfx/items","iconId",d,i),r(n[1],p,"gfx/ornaments","iconId",[],i),0===o?t(null,[]):void 0}function r(e,t,i,n,o,s){return t.length?void m.getDataMap(e,t,function(e,a){function r(e){if(l.length!==e.length)return s("Achievement: Missing rewards data or images");var t=l.map(function(t,i){var n=c[t]||{};return{url:e[i],quantity:n.quantity,data:n.data}});return s(null,t)}if(e)return s(e);for(var l=[],c={},u=0;u<t.length;u+=1){var d=a[t[u]],h=b.join(i,null!==n?d[n]+".png":"");c[h]={data:d,quantity:o[u]||null},l.push(h)}return f.preloadImages(l,r)}):s(null,[])}function l(e){return window.gui.playerData.characterBaseInformations.sex?e.nameFemaleId:e.nameMaleId}function c(e,t){e.table.setContentLoading(t)}function u(){return window.gui.playerData.ToaData.current.steps?window.gui.playerData.ToaData.current.steps:null}var d=i(593),h=i(29).getText,p=i(205).isEmptyObject,m=i(30),f=i(202),g=i(235),_=i(834),v=i(509),y=i(252),b=i(1279);e.exports.createTable=n,e.exports.setContent=o,e.exports.displayRewardsDetails=s,e.exports.loadImages=r,e.exports.tabSpinner=c,e.exports.getStepsData=u},function(e,t,i){(function(e){function i(e,t){for(var i=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var i=[],n=0;n<e.length;n++)t(e[n],n,e)&&i.push(e[n]);return i}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(e){return o.exec(e).slice(1)};t.resolve=function(){for(var t="",o=!1,s=arguments.length-1;s>=-1&&!o;s--){var a=s>=0?arguments[s]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,o="/"===a.charAt(0))}return t=i(n(t.split("/"),function(e){return!!e}),!o).join("/"),(o?"/":"")+t||"."},t.normalize=function(e){var o=t.isAbsolute(e),s="/"===a(e,-1);return e=i(n(e.split("/"),function(e){return!!e}),!o).join("/"),e||o||(e="."),e&&s&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,i){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=t.resolve(e).substr(1),i=t.resolve(i).substr(1);for(var o=n(e.split("/")),s=n(i.split("/")),a=Math.min(o.length,s.length),r=a,l=0;l<a;l++)if(o[l]!==s[l]){r=l;break}for(var c=[],l=r;l<o.length;l++)c.push("..");return c=c.concat(s.slice(r)),c.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=s(e),i=t[0],n=t[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},t.basename=function(e,t){var i=s(e)[2];return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},t.extname=function(e){return s(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(t,i(33))},function(e,t,i){function n(){o=h.getStepsData();var e=window.gui.playerData.ToaData;r.call(this,"div",{className:["panel","compositionTab"],name:"composition"});var t=this;this.openedTabId=null,this.once("open",function(){t._setupDom()}),this.on("open",function(){o=h.getStepsData();var t=e.getCurrentStage();p=t.step,m=t.stage;var i=e.current.score;if(this._mapLocationButton&&this._mapLocationButton.destroy(),o){w||this._createSteps(this._stepList),this._scoreCompo.setText(s("ui.common.score")+s("ui.common.colon")+i);var n=e.getStepsScoreRatio();this._stepsLabel.forEach(function(e){var t=n[e.stepNumber-1];e.element.setText(s("ui.toa.step")+" "+e.stepNumber+" - "+t+"%")}),this._selectInitialStage(p,m)}}),window.gui.on("disconnect",function(){w&&t._stepList.clearContent(),w=!1})}i(1281);var o,s=i(29).getText,a=i(191).inherits,r=i(235),l=i(258).playUiSound,c=i(500).SingleSelectionList,u=i(228),d=i(202),h=i(1278),p=1,m=1,f=1.645,g=7,_=1,v=3,y=4,b=-500,w=!1;a(n,r),e.exports=n,n.prototype._setupDom=function(){var e=this.createChild("div",{className:"unscrollableContentBlock"});this._createContent(e)},n.prototype._createContent=function(e){var t=this,i=e.createChild("div",{className:"compositionContent"});if(o){var n=this.col1=i.createChild("div",{className:"col1"}),a=i.createChild("div",{className:"col2"}),r=this._stepList=n.appendChild(new c({className:"tree"}));r.on("selected",function(e){p=e.id,e.sublist.show(),l("TAB"),r.refresh(),r.scrollToElement(e)}),r.on("deselected",function(e){p=null,e.sublist.hide(),r.refresh()});var u=a.createChild("div",{className:"statBlock"});this._challengeBlock=u.createChild("div",{className:"challengeBlock"});var d=u.createChild("div",{className:"scoreBlock"}),h=d.createChild("div",{className:"scoreBoxHeaderContentBlock"});this._scoreCompo=h.createChild("div",{className:"playerScore"}),this.scoreBox=d.createChild("div",{className:"floorScoreBoxHeaderContentBlock"}),a.createChild("hr",{className:"separator"});var m=a.createChild("div",{className:"monsterListWrapper"}),f=this._monsterList=m.appendChild(new c);f.on("selected",function(e){e.more?(e.more.show(),this.refresh()):(t._createMonsterMoreInfo(e),this.refresh())}),f.on("deselected",function(e){e.more.hide(),this.refresh()})}else i.createChild("div",{className:"col2",text:s("ui.toa.ascensionClosed")})},n.prototype._createSteps=function(e){var t=this,i=window.gui.playerData.ToaData,n=i.getStepsScoreRatio();return this._stepsLabel=[],o?(o.forEach(function(o){var a=new r("div",{className:"label",name:o.stepNumber});a.createChild("div",{className:"arrow"}),t._stepsLabel.push({element:a.createChild("div",{className:"text",text:s("ui.toa.step")+" "+o.stepNumber+" - "+n[o.stepNumber-1]+"%"}),stepNumber:o.stepNumber});var l=e.addItem({id:o.stepNumber,element:a},{noRefresh:!0});l.sublist=l.appendChild(new r("div",{className:"sublist"})),o.stages.forEach(function(e){var n=new r("div",{className:"label",name:e.stageLevel});n.createChild("div",{className:"text",text:s("ui.toa.stage")+" "+e.stageLevel}),l.sublist.appendChild(n),u(n),n.on("tap",function(){t._resetSelectedSubElement(),m=e.stageLevel,n.addClassNames("selected"),t.selectedSubAreaElement=n;var o=i.getMonsterIds(m,p),s=i.getChallengeIds(m,p);i.gatheringCompositionData(o,s,function(e,i,n){return e?console.error(e):(t._showMonsters(i),t._showChallenges(n),void t._showScore(n))})})}),l.sublist.hide()}),void(w=!0)):console.error(new Error("Cannot create steps, list is empty."))},n.prototype._addMonster=function(e,t,i,n){var o=new r("div",{className:"infos"}),a=o.createChild("div",{className:"gfx"});a.setStyle("backgroundImage",t);var l=o.createChild("div",{className:"infosGroupRight"}),c=l.createChild("div",{className:"cf"}),u=["name"],d={};e.isBoss&&u.push("boss"),e.isMiniBoss&&u.push("miniBoss"),e.isQuestMonster&&u.push("questMonster");var h=window.gui.playerData.isModeratorOrMore(),p=e.nameId;h&&(p+=" ("+e.id+")"),c.createChild("div",{className:u,text:p}),e.grades.forEach(function(e){e.grade===n&&(d=e)});var f=window.gui.playerData.ToaData.getMonsterLevelScaled(m),g=s("ui.common.short.level")+" "+f;c.createChild("div",{className:"level",text:g});var _=this._monsterList.addItem({id:i,element:o,data:e},{noRefresh:!0});_.addClassNames("monster"),_.monsterData=d,_.monsterData.scaledLvl=f,_.monsterData.isBoss=e.isBoss},n.prototype._createMonsterMoreInfo=function(e){function t(e,t){var i="lifePoints"===t?c:o[t],n=e+": "+i;d.createChild("div",{className:"stat",text:n})}function i(e){var t=o[e],i=t;h.createChild("div",{className:["stat","resistance",e],text:i})}e.more=e.createChild("div",{className:"more"});var n=e.more.createChild("div",{className:"cf"}),o=e.monsterData,a=o.scaledLvl,r=o.lifepointsRatio,l=o.isBoss?v:_,c=Math.pow(a,f),u=r*g+l*y;u/=y+g,c=Math.trunc(c*u+b);var d=n.createChild("div",{className:["col","colLeft"]});d.createChild("div",{className:"subtitle",text:s("ui.common.caracteristics")}),t(s("ui.short.lifePoints"),"lifePoints"),t(s("ui.short.actionPoints"),"actionPoints"),t(s("ui.short.movementPoints"),"movementPoints");var h=n.createChild("div",{className:["col","colRight"]});h.createChild("div",{className:"subtitle",text:s("ui.common.resistances")}),i("neutralResistance"),i("earthResistance"),i("fireResistance"),i("waterResistance"),i("airResistance")},n.prototype._showChallenges=function(e){var t=window.gui.playerData.ToaData;this._challengeBlock.clearContent();var i=t.getSelectedStageSucceedChallengeIds(m);if(t.isSelectedStageDone(m))for(var n in e){for(var o=this._challengeBlock.createChild("div",{className:"challengeContent"}),a=!1,r=0;r<i.length;r++)i[r]===e[n].id&&(o.createChild("div",{className:"succeed"}),a=!0);a||o.createChild("div",{className:"failed"}),o.createChild("div",{className:"description",text:e[n].nameId+s("ui.common.colon")+e[n].points})}else for(n in e)o=this._challengeBlock.createChild("div",{className:"challengeContent"}),o.createChild("div",{className:"description",text:e[n].nameId+s("ui.common.colon")+e[n].points})},n.prototype._showScore=function(e){var t=this,i=window.gui.playerData.ToaData,n=i.calculateMaxStageScore(m,e);t.scoreBox.clearContent(),t.scoreBox.createChild("div",{className:"floorScore",text:s("ui.toa.floorScore")+s("ui.common.colon")+i.getSelectedStageScore(m)}),t.scoreBox.createChild("div",{className:"floorScore",text:s("ui.toa.compoFloorScoreMax")+s("ui.common.colon")+n})},n.prototype._selectInitialStage=function(e,t){if(e){var i=this._stepList.getItem(e);if(i){this._stepList.selectItem(e);var n=i.sublist.getChild(t);n.tap(),this._stepList.showElement(n)}}},n.prototype._showMonsters=function(e){var t=this,i=window.gui.playerData.ToaData;this._monsterList.clearContent(),this._monsterList.delClassNames("spinner");var n=[];for(var o in e)n.push("gfx/monsters/"+e[o].id+".png");d.preloadImages(n,function(n){var o=0,s=i.getMonstersData(m,p);for(var a in e){for(var r=0;r<s.length;r++)e[a].id===s[r].creatureGenericId&&t._addMonster(e[a],n[o],a+r,s[r].grade);o++}t._monsterList.refresh()})},n.prototype._resetSelectedSubElement=function(){this.selectedSubAreaElement&&this.selectedSubAreaElement.rootElement&&this.selectedSubAreaElement.hasClassName("selected")&&(this.selectedSubAreaElement.delClassNames("selected"),this.selectedSubAreaElement=null)}},function(e,t){},function(e,t,i){function n(){a.call(this,"div",{className:["panel","ladderTab"],name:"ladder"}),this.openedTabId=null,this._servers=[];var e=l.getStepsData();this.once("open",function(){this._setupDom(),this._setupListener()}),this.on("open",function(){this.currentPage=-1,this.pageCount=-1,this.selectedServer="",this._servers=window.gui.serversData.getAllowedServerList(),this._toaClosedblock.toggleClassName("off",Boolean(e)),this._updateServersSelectorContent(),this._requestingLadderData()})}i(1283);var o=i(29).getText,s=i(191).inherits,a=i(235),r=i(586),l=i(1278),c=i(828),u=i(184);s(n,a),e.exports=n,n.prototype._setupDom=function(){var e=this.createChild("div",{className:"unscrollableContentBlock"});this._createContent(e)},n.prototype._requestingLadderData=function(){var e=window.gui.playerData.ToaData;l.tabSpinner(this._ladderBlock,!0),e.requestLadderData(this.currentPage===-1?0:this.currentPage,this.selectedServer),e.requestMaxRankLadderData(window.gui.serversData.connectedServerData.id)},n.prototype._setupListener=function(){function e(){i._updatePageCount(),l.tabSpinner(i._ladderBlock,!1),l.setContent(i._ladderBlock,n.current.ladder.data)}function t(){l.tabSpinner(i._playerBlock,!1),l.setContent(i._playerBlock,n.current.ladder.player)}var i=this,n=window.gui.playerData.ToaData;n.on("toaLadderDataSuccess",e),n.on("toaPlayerRankDataSuccess",t),n.on("toaLadderDataFailure",e),n.on("toaPlayerRankDataFailure",t)},n.prototype._updatePageCount=function(){var e=window.gui.playerData.ToaData,t=Math.ceil(e.current.ladder.nbPlayer/u.NB_PLAYER_PER_LADDER_PAGE)||1;t!==this.pageCount&&(this.pageCount=t,this._displayPage(0),this.pagination.setPageCount(t))},n.prototype._updateServersSelectorContent=function(){this._serversSelector.clearContent(),this._serversSelector.addOption(o("ui.toa.ladderFilterChoiceAll"),"");for(var e=0;e<this._servers.length;e++)this._serversSelector.addOption(this._servers[e]._name||this._servers[e].id,this._servers[e].id)},n.prototype._createContent=function(e){function t(e){return e.rank+1}function i(e){return window.gui.serversData.getServerNameById(e.server)}var n=this,s=e.createChild("div",{className:"ladderContent"}),a=s.createChild("div",{className:"header"}),u=a.createChild("div",{className:"filtersBlock"});u.createChild("div",{className:"description",text:o("ui.toa.ladderFilterText")+o("ui.common.colon")});var d=u.createChild("div",{className:"selectorsBlock"}),h=d.createChild("div",{className:"serverSelectorBox"});h.createChild("div",{className:"description",text:o("ui.toa.ladderFilterServer")});var p=this._serversSelector=h.appendChild(new r({className:"serverSelector"}));p.on("change",function(e){n.currentPage=-1,n.pageCount=-1,n.selectedServer=e,n._ladderBlock.table.setPlaceholderText(""),n._requestingLadderData()});var m=this._toaClosedblock=a.createChild("div",{className:"toaClosedBlock"});m.createChild("div",{className:"toaClosedImg"}),m.createChild("div",{className:"toaClosedText",text:o("ui.toa.ascensionClosed")});var f=this._ladderBlock=s.createChild("div",{className:"ladderBlock"}),g=[{id:"rank",header:o("ui.toa.rewardsBoardRank"),sort:!1,format:t},{id:"name",header:o("ui.common.name"),sort:!1},{id:"breed",header:o("ui.toa.ladderFilterBreed"),sort:!1},{id:"level",header:o("ui.common.level"),sort:!1},{id:"server",header:o("ui.toa.ladderFilterServer"),sort:!1,format:i},{id:"score",header:o("ui.common.score"),sort:!1}];l.createTable(f,g,"rank",!0),this.pagination=f.appendChild(new c),this.pagination.on("previous",function(){n._displayPage(n.currentPage-1)}),this.pagination.on("next",function(){n._displayPage(n.currentPage+1)}),this.pagination.on("page",function(e){n._displayPage(e)}),g=[{id:"rank",header:o("ui.toa.rewardsBoardRank"),sort:!1,format:t},{id:"name",header:o("ui.common.name"),sort:!1},{id:"score",header:o("ui.common.score"),sort:!1},{id:"rewards",header:o("ui.grimoire.quest.rewards"),format:function(e){return l.displayRewardsDetails(e.rankId)},sort:!1}];var _=this._playerBlock=e.createChild("div",{className:"ladderPlayerContent"});l.createTable(_,g,!1)},n.prototype._displayPage=function(e){this.currentPage!==e&&(e<0||e>this.pageCount||(this.currentPage=e,this.pagination.setCurrent(e),this._requestingLadderData()))}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"ShieldWindow",title:a("ui.shield.interfaceTitle"),positionInfo:{left:"c",top:"c",width:"75%",height:"90%",minWidth:700,maxHeight:530,mustAvoidToolbar:!0}});var e=window.gui.playerData.inventory,t=this;this._isTutorial=!1,this.feedingBox=new r(this),this.loadedSpells={},this._shield={},this.once("open",function(){this._createDom()}),this.on("open",function(e){this._isTutorial=e.itemInstance.item.id===f.fakeShieldId,this._shieldsListButton.toggleClassName("disabled",this._isTutorial);var t=e.itemInstance.item.shieldModelId,i=e.itemInstance.item.shieldBonuses;this._shield={shieldUID:e.itemInstance.objectUID,model:t,bonusesPerLevel:i,itemInstance:e.itemInstance},this._isTutorial?(this._shield.model=1,this._shield.bonusesPerLevel=[{effectId:125,descriptionId:"#1{~1~2 to }#2 Vitality",bonusRatio:1}],this._updateTutorialShieldInformations(e.itemInstance),e.mode="shieldTutorial"):(this._updateShieldInformations(e.itemInstance),e.mode="shield"),this.feedingBox.update(e)}),this.on("close",function(){this._isTutorial||this.feedingBox.removeFilter(),this._resetPreview()}),this.on("closed",function(){this.feedingBox.unloadContent(),this._shield={}}),this.on("slot-tap",function(e){var t=this._isTutorial&&!window.gui.shieldTutorialManager.isSpellSlotStepPassed();return 100===this._shield.level||t?this.feedingBox.storageViewer.unSelectSlot(e.data.objectUID):void this.feedingBox.selectItem(e.itemInstance)}),this.on("itemQuantity",function(){t.feedingBox.reset()}),this.on("itemRemoved",function(){this.feedingBox.reset(),this._resetPreview()}),this.feedingBox.on("quantityUpdated",function(e,i){var n=e*i;t._setXpPreview(n)}),this.feedingBox.on("quantityReset",function(){t._resetPreview()}),window.gui.on("QuestObjectiveValidatedMessage",function(){window.gui.playerData.isShieldTutorialFortified()&&t._isTutorial&&(t.feedingBox.reset(),t._resetPreview(),t._updateTutorialShieldInformations(t._shield.itemInstance))}),e.on("itemModified",function(e){e.objectUID===t._shield.shieldUID&&(t.feedingBox.reset(),t._updateShieldInformations(e))})}i(1285);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(1177),l=i(459),c=i(838),u=i(981),d=i(399),h=i(228),p=i(29).processText,m=i(225),f=i(575),g={visibilityOptions:{spellTooltipName:!0,spellTooltipDescription:!0}},_=5226,v=35;o(n,s),e.exports=n,n.prototype._createDom=function(){var e=this.windowBody.createChild("div",{className:"ShieldBody"}),t=this,i=e.createChild("div",{className:"ShieldContent"}),n=e.createChild("div",{className:"FeedingContent"}),o=i.createChild("div",{className:"PreviewContent"});this._shieldBg=o.createChild("div",{className:"ShieldImg"}),h(this._shieldBg,{repeatDelay:1,doubletapTimeout:1}),this._shieldBg.on("tap",function(){t._isTutorial||m.open("ShieldSelectionWindow",t._shield.shieldUID)}),this._shieldsListButton=this._shieldBg.createChild("div",{className:"shieldsListButton"});var s=o.createChild("div",{className:"ShieldDescription"});this._shieldName=s.createChild("div",{className:"ShieldName"});var r=s.createChild("div",{className:"ShieldDetails"});this._spellSlot=r.appendChild(new c);var l=r.createChild("div",{className:"ShieldLvlDescription"});this._shieldLvl=l.createChild("div",{className:"ShieldLvl"}),this._shieldLvlPreview=l.createChild("div",{className:"ShieldLvlPreview"});var d=i.createChild("div",{className:["statsContent"]}),p=d.createChild("div",{className:"experienceContent"}),f=p.createChild("div",{className:"experienceLabel"});f.setText(a("ui.common.experiment")+a("ui.common.colon")),this._xpbar=p.appendChild(new u({valueClassNames:["oldXp","gainedXp"]})),this._xpbar.reached100=this._xpbar.createChild("div",{className:"reached100"}),this._xpbar.reached100.addClassNames("off");var g=p.createChild("div",{className:"xpDescription"});this._xpDetails=g.createChild("div",{className:"xpDetails"}),this._xpDetailsPreview=g.createChild("div",{className:"xpDetailsPreview"}),d.createChild("div",{className:"effectsLabel",text:a("ui.effects")+a("ui.common.colon")}),this._effects=d.createChild("div",{className:"effectsList"}),this.feedingBox.init(n)},n.prototype._setEffectsList=function(e){if(e){this._effects.clearContent();var t=this._effects.createChild("ul",{className:"ShieldEffectsList"});t.effects={};for(var i=window.gui.playerData.isShieldTutorialFortified(),n=this._shield.bonusesPerLevel,o=0;o<e.length;o+=1){var s=e[o],a=s.effect,r=s.description;if(i&&n[0].effectId===s.effectId){var l=s.value+Math.floor(n[0].bonusRatio*v);r=p(s.effect.descriptionId,l)}r&&e[o].actionId!==d.ACTION_CAST_STARTING_SPELL&&e[o].actionId!==d.ACTION_SHIELD_EXPERIENCE&&(t.effects[a.id]=t.createChild("li"),t.effects[a.id].setText(r),t.effects[a.id].currentStatDescription=r,t.effects[a.id].isPreview=!1,a.bonusType===-1?t.effects[a.id].addClassNames("malus"):1===a.bonusType&&t.effects[a.id].addClassNames("bonus"))}this._effectsList=t}},n.prototype._loadSpellData=function(e,t){if(!e)return t();var i=this.loadedSpells;l.createSpells(e,function(e,n){if(e)return t(e);n=l.sortSpells(n,"minPlayerLevel");for(var o=0;o<n.length;o+=1){var s=n[o];i[s.id]=s}t()})},n.prototype._updateSpell=function(e){this._spellSlot.addClassNames("spinner");var t=this;this._loadSpellData(e,function(i){if(i)return console.error(i);var n=t.loadedSpells[e];t._spellSlot.setSpell(n,g)}),this._spellSlot.delClassNames("spinner")},n.prototype._updateLevel=function(){this._shieldLvl.setText(a("ui.common.shieldRank",this._shield.level))},n.prototype._calculateXP=function(e,t){return 1e4*e+t},n.prototype._updateXP=function(){var e=window.gui.databases.ShieldModelsLevels[this._shield.model].requiredXpLevels,t=e[Math.min(99,this._shield.level)],i=e[Math.min(99,this._shield.level)-1];this._xpDetails.setText(this._shield.currentXP+" / "+t),this._xpbar.setValues([(this._shield.currentXP-i)/(t-i),0])},n.prototype._setXpPreview=function(e){this._resetPreview();for(var t=window.gui.databases.ShieldModelsLevels[this._shield.model].requiredXpLevels,i=t[Math.min(99,this._shield.level)],n=t[Math.min(99,this._shield.level)-1],o=e+this._shield.currentXP,s=0,a=(this._shield.currentXP-n)/(i-n),r=(o-n)/(i-n);this._shield.level<100&&t[this._shield.level+s]<=o;)s++;var l=Math.min(e,t[99]-this._shield.currentXP);if(s){this._shieldLvlPreview.setText("( + "+s+" )");var c=this._shield.bonusesPerLevel;if(c)for(var u,d=0,h=0;h<c.length;h++){u=Math.floor(c[h].bonusRatio*(s+this._shield.level)),d=Math.floor(c[h].bonusRatio*this._shield.level);var m=u-d;if(m>1){var f=this._effectsList.effects[c[h].effectId];if(f){var g=f.currentStatDescription;f.setText(g+" ( +"+m+" )")}else{var _=this._effectsList.createChild("li");_.isPreview=!0,_.setText("( "+p(c[h].descriptionId,m)+" )")}}}}this._xpbar.reached100.toggleClassName("off",s<1),this._xpDetailsPreview.setText("( + "+l+" )"),this._xpbar.setValues([a,r])},n.prototype._resetPreview=function(){this._shieldLvlPreview.clearContent(),this._xpDetailsPreview.clearContent(),this._xpbar.reached100.addClassNames("off"),this._effectsList.getChildren().forEach(function(e){
e.isPreview?e.destroy():e.setText(e.currentStatDescription)})},n.prototype._updateShieldInformations=function(e){var t=this,i=e.effectsMap[d.ACTION_CAST_STARTING_SPELL],n=e.effectsMap[d.ACTION_SHIELD_EXPERIENCE];i&&t._updateSpell(i.diceNum),n&&(t._shield.currentXP=t._calculateXP(n.diceSide,n.value),t._shield.level=n.diceNum,t._updateXP(),t._updateLevel()),this._shieldBg.setStyle("backgroundImage",e.item.image),this._shieldName.setText(e.getProperty("nameId")),this._setEffectsList(e.effects)},n.prototype._updateTutorialShieldInformations=function(e){this._updateSpell(_);var t=window.gui.playerData.isShieldTutorialFortified();this._shield.currentXP=t?this._calculateXP(0,2500):this._calculateXP(0,0),this._shield.level=t?35:1,this._updateXP(),this._updateLevel(),this._shieldBg.setStyle("backgroundImage",e.item.image),this._shieldName.setText(e.getProperty("nameId")),this._setEffectsList(e.effects)},n.prototype.setNewShield=function(e){this._shield={shieldUID:e.objectUID,model:e.item.shieldModelId,bonusesPerLevel:e.item.shieldBonuses};var t={itemInstance:e,mode:"shield"};this.feedingBox.update(t),this._resetPreview(),this.feedingBox.reset(),this._setEffectsList(e.effects),this._updateShieldInformations(e)},n.prototype.getShieldSpellSlot=function(){return this._spellSlot}},function(e,t){},function(e,t,i){function n(){r.call(this,{title:s("ui.shield.interfaceTitle"),className:"ShieldSelectionWindow",positionInfo:{right:"c",bottom:"c",width:400,height:490,mustAvoidToolbar:!0}}),this.once("opened",function(){this._createDom()}),this.on("opened",function(e){this._currentShieldUID=e,this._reset(),this._update()}),this.on("close",function(){this._removeFilter()}),this.on("closed",function(){this._unloadContent()}),this.on("slot-tap",function(e){this._selectItem(e.itemInstance)}),this.on("itemRemoved",function(){this._reset()}),this.storageViewer=new d({enablePresets:!1,dataHandler:window.gui.playerData.inventory,enableLookAllObjects:!0}),this.storageViewer.registerView(this,{manualOpening:!0,enableSlotContext:!1})}function o(){var e={},t=window.gui.playerData.inventory.objects;for(var i in t){var n=t[i];n.isShieldManageable()&&(e[i]=n)}return e}i(1287);var s=i(29).getText,a=i(191).inherits,r=i(233),l=i(246),c=i(951),u=i(503),d=i(903),h=i(225);a(n,r),n.prototype._filterShield=function(e){return e.isShieldManageable()&&this._currentShieldUID!==e.objectUID},n.prototype._update=function(){function e(e){return e.isShieldManageable()&&t!==e.objectUID}var t=this._currentShieldUID;this._filter=e,this.storageViewer.addFilters([this._filter]);var i=o();this.storageViewer.setItemList(i)},n.prototype._unloadContent=function(){this.storageViewer.unloadContent()},n.prototype._removeFilter=function(){this.storageViewer.removeFilter(this._filter)},n.prototype._reset=function(){this.placeHolder.setText(s("ui.common.selectItem")),this.itemSelected=null,this.itemBox.hide(),this.confirmBtn.disable()},n.prototype._createDom=function(){var e=this;this.viewerBox=this.windowBody.createChild("div",{className:"viewer"}),this.viewerBox.appendChild(e.storageViewer.storageUI);var t=this.windowBody.createChild("div",{className:"itemBox"});this.itemBox=t.appendChild(new c({showTitle:!0})),this.placeHolder=new u(t),this.confirmBtn=this.windowBody.appendChild(new l({text:s("ui.common.validation"),className:["greenButton","confirm"]})),this.confirmBtn.on("tap",function(){h.getWindow("shieldWindow").setNewShield(e.itemSelected),h.close("ShieldSelectionWindow")})},n.prototype._selectItem=function(e){this.itemSelected=e,this.itemBox.displayItem(e),this.itemBox.show(),this.placeHolder.setText(null),this.confirmBtn.enable()},e.exports=n},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"HelpWindow",title:a("ui.helpWindow.title"),positionInfo:{left:"c",top:"c",width:"90%",height:"97%",maxWidth:905,maxHeight:620,mustAvoidToolbar:!0}}),this.once("open",function(){this._setupDom()}),this.on("open",function(e){void 0!==e.part&&void 0!==e.subPart&&(f=e.part,g=e.subPart),this._setContent()})}i(1289);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(258).playUiSound,l=i(500).SingleSelectionList,c=i(483),u=i(235),d=i(228),h=i(593),p=i(229).events,m=i(252),f=-1,g=-1,_=[{title:"ui.helpWindow.category1",subParts:[{title:"ui.helpWindow.category1sub1",text:"ui.helpWindow.category1sub1text",forbiddenLanguages:[]}]},{title:"ui.helpWindow.category2",subParts:[{title:"ui.helpWindow.category2sub1",text:"ui.helpWindow.category2sub1text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub2",text:"ui.helpWindow.category2sub2text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub3",text:"ui.helpWindow.category2sub3text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub4",text:"ui.helpWindow.category2sub4text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub5",text:"ui.helpWindow.category2sub5text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub6",text:"ui.helpWindow.category2sub6text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub7",text:"ui.helpWindow.category2sub7text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub8",text:"ui.helpWindow.category2sub8text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub9",text:"ui.helpWindow.category2sub9text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub10",text:"ui.helpWindow.category2sub10text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub11",text:"ui.helpWindow.category2sub11text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub12",text:"ui.helpWindow.category2sub12text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub13",text:"ui.helpWindow.category2sub13text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub14",text:"ui.helpWindow.category2sub14text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub15",text:"ui.helpWindow.category2sub15text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub16",text:"ui.helpWindow.category2sub16text1",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub17",text:"ui.helpWindow.category2sub17text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub18",text:"ui.helpWindow.category2sub18text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub19",text:"ui.helpWindow.category2sub19text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub20",text:"ui.helpWindow.category2sub20text",forbiddenLanguages:[]},{title:"ui.helpWindow.category2sub21",text:"ui.helpWindow.category2sub21text",forbiddenLanguages:[]}]},{title:"ui.helpWindow.category3",subParts:[{title:"ui.helpWindow.category3sub1",text:"ui.helpWindow.category3sub1text",forbiddenLanguages:[]},{title:"ui.helpWindow.category3sub2",text:"ui.helpWindow.category3sub2text",forbiddenLanguages:[]},{title:"ui.helpWindow.category3sub3",text:"ui.helpWindow.category3sub3text",forbiddenLanguages:[]},{title:"ui.helpWindow.category3sub4",text:"ui.helpWindow.category3sub4text",forbiddenLanguages:[]}]},{title:"ui.helpWindow.category4",subParts:[{title:"ui.helpWindow.category4sub1",text:"ui.helpWindow.category4sub1text",forbiddenLanguages:[]}]},{title:"ui.helpWindow.category5",subParts:[{title:"ui.helpWindow.category5sub1",text:"ui.helpWindow.category5sub1text",forbiddenLanguages:[]},{title:"ui.helpWindow.category5sub2",text:"ui.helpWindow.category5sub2text",forbiddenLanguages:[]},{title:"ui.helpWindow.category5sub3",text:"ui.helpWindow.category5sub3text",forbiddenLanguages:[]},{title:"ui.helpWindow.category5sub4",text:"ui.helpWindow.category5sub4text",forbiddenLanguages:["en","de","es","it","pt"]},{title:"ui.helpWindow.category5sub5",text:"ui.helpWindow.category5sub5text",forbiddenLanguages:["en","de","es","it","pt"]}]},{title:"ui.helpWindow.category6",subParts:[{title:"ui.helpWindow.category6sub1",text:"ui.helpWindow.category6sub1text",forbiddenLanguages:[]},{title:"ui.helpWindow.category6sub2",text:"ui.helpWindow.category6sub2text",forbiddenLanguages:[]},{title:"ui.helpWindow.category6sub3",text:"ui.helpWindow.category6sub3text",forbiddenLanguages:[]}]},{title:"ui.helpWindow.category7",subParts:[{title:"ui.helpWindow.category7sub1",text:"ui.helpWindow.category7sub1text",forbiddenLanguages:[]},{title:"ui.helpWindow.category7sub2",text:"ui.helpWindow.category7sub2text",forbiddenLanguages:[]},{title:"ui.helpWindow.category7sub3",text:"ui.helpWindow.category7sub3text",forbiddenLanguages:[]}]}];o(n,s),e.exports=n,n.prototype._getDopeulsData=function(){for(var e=["20","40","60","80","100","120","140","160","180","200"],t=["1","2","3","5","6","8","10","12","14","17"],i=["2450","8100","18150","33800","56250","86700","126350","176400","238050","312500"],n=["1400","3600","6600","10400","15000","20400","26600","33600","41400","50000"],o={},s=0;s<10;s+=1)o[s]={level:e[s],nbrDoplon:t[s],expPerQuest:i[s],expPerFight:n[s]};return o},n.prototype._setupDom=function(){this.body=this.windowBody.createChild("div",{className:"helpBody"});var e=this.body.createChild("div",{className:"col1"}),t=this.body.createChild("div",{className:"col2"});e.createChild("div",{className:"col1Header",text:a("ui.helpWindow.menuTitle")});var i=this._summaryList=e.appendChild(new l({className:"tree"}));i.on("selected",function(e){e.sublist.show(),r("TAB"),i.refresh(),i.scrollToElement(e)}),i.on("deselected",function(e){e.sublist.hide(),i.refresh()}),this._createPart(i);var n=this._mainScroller=t.appendChild(new c({className:"col2Scroller"})),o=n.content.createChild("div",{className:"scrollBlock"});this._title=o.createChild("h2",{className:"contentTitle"}),this._content=o.createChild("div",{className:"content"})},n.prototype._createPart=function(e){function t(){n._resetSelectedSubCatElement(),this.addClassNames("selected"),n.selectedSubCatElement=this,f=this.i,g=this.j,n._setContent(),n._mainScroller.goToTop()}function i(e){for(var t=0;t<e.length;t++)if(window.Config.language===e[t])return!1;return!0}var n=this;this._stepsLabel=[];for(var o=0;o<_.length;o++){var s=_[o],r=new u("div",{className:"label",name:"part"+o});r.createChild("div",{className:"arrow"}),n._stepsLabel.push({element:r.createChild("div",{className:"text",text:a(s.title)})});var l=e.addItem({id:o,element:r},{noRefresh:!0});l.sublist=l.appendChild(new u("div",{className:"sublist"}));for(var c=0;c<s.subParts.length;c++){var h=s.subParts[c];if(i(h.forbiddenLanguages)){var p=new u("div",{className:"label",name:"subpart"+o+c});p.createChild("div",{className:"text",text:a(h.title)}),l.sublist.appendChild(p),p.i=o,p.j=c,d(p),p.on("tap",t)}}l.sublist.hide()}},n.prototype._setContent=function(){if(this._title.clearContent(),this._content.clearContent(),f!==-1&&g!==-1)if(this._title.setText(a(_[f].subParts[g].title)),1===f&&15===g){this._content.appendChild(this._formatLinks(a(_[f].subParts[g].text)));var e=[{id:"level",header:a("ui.helpWindow.category2sub16table1"),sort:!1},{id:"nbrDoplon",header:a("ui.helpWindow.category2sub16table2"),sort:!1},{id:"expPerQuest",header:a("ui.helpWindow.category2sub16table3"),sort:!1},{id:"expPerFight",header:a("ui.helpWindow.category2sub16table4"),sort:!1}],t=this._getDopeulsData();this._content.table=this._content.appendChild(new h(e,(!1),{clickable:!1})),this._content.table.scroller.setEnable(!1),this._content.table.addMap(t),this._content.appendChild(this._formatLinks(a("ui.helpWindow.category2sub16text2")))}else this._content.appendChild(this._formatLinks(a(_[f].subParts[g].text)));else this._content.setText(a("ui.helpWindow.defaultText"));this._mainScroller.refresh()},n.prototype._formatLinks=function(e){function t(e,t){e.addEventListener(p.end,function(e){m.openUrlInAppBrowser(t),e.preventDefault()})}var i=new u("div");i.setHtml(e);for(var n,o,s=i.rootElement.getElementsByTagName("a"),a=0;a<s.length;a++)n=s[a],o=n.href,t(n,o);return i},n.prototype._resetSelectedSubCatElement=function(){this.selectedSubCatElement&&(this.selectedSubCatElement.delClassNames("selected"),this.selectedSubCatElement=null)}},function(e,t){},function(e,t,i){function n(){u.call(this,{className:"ToaRetryPopup",positionInfo:{left:"c",top:"c",width:600,height:200},noCloseButton:!0});var e=this;this._domCreated=!1,this._stepNumber=-1,this._retryError=null,this._logic=new c;var t=this.windowBody.createChild("div",{className:"messageBox"});this._message=t.createChild("div",{className:"message"}),this.on("open",function(t){e._domCreated||e._createDom(),e._retryError=null,e._stepNumber=t.stepNumber,e._enableButtons(!0),e.setTitle(r("ui.toa.retryTitle")),window.gui.gifts.getToaRetryPendingUid().length?e._message.setText(r("ui.toa.retryOwned")):e._message.setText(r("ui.toa.retryMessage",a.TOA_RETRY_HC_PRICE))})}i(1291);var o=i(191).inherits,s=i(246),a=i(184),r=i(29).getText,l=i(207).logger,c=i(1292),u=i(233),d=i(225);o(n,u),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.windowBody.createChild("div",{className:"buttonContainer"});this._buttonYes=t.appendChild(new s({text:a.TOA_RETRY_HC_PRICE.toString(),addIcon:"after",className:["button","buttonYes"]},function(){e._enableButtons(!1),e._buy()})),this._buttonNo=t.appendChild(new s({text:r("ui.common.no"),className:["button","buttonNo"]},function(){e._retryError&&l.error("ToaRetryPopup retry cancelled",e._retryError),d.close(e.id)})),this._setupListeners(window.gui),this._domCreated=!0},n.prototype._buy=function(){var e=this;this._retryError=null,this._logic.buy(this._stepNumber,window.gui.playerData.inventory,function(t,i){e._buyCallback(t,i)})},n.prototype._buyCallback=function(e,t){return e?e.message===this._logic.NEED_HC?void this._enableButtons(!0):e.message===this._logic.ALREADY_IN_PROGRESS?void l.warning("ToaRetryPopup: already in process"):e.message===this._logic.GET_STORE_INFOS_ERROR?(this._enableButtons(!0),void this._retry(e)):e.message===this._logic.CANNOT_ASSIGN_PENDING_RETRY?(this._enableButtons(!0),window.gui.openPopup({title:r("ui.common.error"),message:r("tablet.shop.couldNotBuy")+" (code: caprerr)"}),l.error("ToaRetryPopup buy (caprerr)",e),void d.close(this.id)):e.message===this._logic.GIFT_TIMEOUT?(this._enableButtons(!0),window.gui.openPopup({title:r("tablet.gift.unableToAssignTitle"),message:r("tablet.gift.unableToAssign")+" (code: gterr)"}),l.error("ToaRetryPopup buy (gterr)",e),void d.close(this.id)):(this._enableButtons(!0),window.gui.openPopup({title:r("ui.common.error"),message:r("tablet.shop.couldNotBuy")+" (code: genbuyerr)"}),l.error("ToaRetryPopup buy (genbuyerr)",e),void d.close(this.id)):(window.dofus.sendMessage("ContinueTowerOfAscensionWithCreditRequestMessage",{stepNumber:t}),this._enableButtons(!0),void d.close(this.id))},n.prototype._setupListeners=function(e){this._logic.initialize(e.gifts)},n.prototype._enableButtons=function(e){return e?(this._buttonYes.enable(),this._buttonNo.enable(),void this._buttonYes.delClassNames("spinner")):(this._buttonYes.disable(),this._buttonNo.disable(),void this._buttonYes.addClassNames("spinner"))},n.prototype._retry=function(e){this.setTitle(r("ui.common.error")),this._message.setText(r("ui.popup.accessDenied.serviceUnavailable")+" "+r("tablet.common.askRetry")),this._retryError=e}},function(e,t){},function(e,t,i){function n(){this._cb=null,this._inventory=null,this._actionIdMap={},this._giftModule=null,this._giftTimeout=null,this._stepNumber=-1}var o=i(271),s=i(805),a=i(207),r=a.logger,l=i(184);n.prototype.STEP_NUMBER_IS_NOT_A_VALID_NUMBER="stepNumberIsNotAValidNumber",n.prototype.GET_STORE_INFOS_ERROR="storeInfosFailed",n.prototype.ALREADY_IN_PROGRESS="alreadyInProgress",n.prototype.NEED_HC="needHardCurrency",n.prototype.CANNOT_ASSIGN_PENDING_RETRY="cannotAssignPendingRetry",n.prototype.GIFT_TIMEOUT="giftTimeout",e.exports=n,n.prototype.initialize=function(e){function t(e){if(e.length)for(var t=0;t<e.length;t+=1){for(var n=e[t],o=n.uid,s=n.items||[],a=null,r=0;r<s.length;r+=1)if(s[r].objectGID===l.TOA_RETRY_ITEM_ID){a=s[r];break}a&&(i._actionIdMap[o]=!0)}}var i=this;this._giftModule=e,o.on("StartupActionsListMessage",function(e){t(e.actions)}),o.on("StartupActionAddMessage",function(e){t([e.newAction])}),o.on("toaContinueError",function(e){if("PAIDFAILED"===e.reason){var t=i._inventory.goultines;return s.openNotEnoughHardCurrencyPopup(l.TOA_RETRY_HC_PRICE-t),i._fireCallbackAndClean(new Error(i.NEED_HC))}return i._fireCallbackAndClean(e)}),e.on("giftAssignRequestResult",function(e){if(i._actionIdMap[e.actionId])return delete i._actionIdMap[e.actionId],i._fireCallbackAndClean()}),o.on("toaContinueSuccess",function(){i._startGiftTimeout(),a.send("moneyGoultinesAmountRequest")})},n.prototype.buy=function(e,t,i){var n=this;if(this._cb)return i(new Error(n.ALREADY_IN_PROGRESS));var o=e===parseInt((e||0).toString(),10);if(!e||!o||e<0)return i(new Error(this.STEP_NUMBER_IS_NOT_A_VALID_NUMBER+": "+e));if(this._stepNumber=e,this._inventory=t,this._cb=i,this._giftModule.getToaRetryPendingUid().length){var r=this._giftModule.getToaRetryPendingUid()[0];this._actionIdMap[r]=!0;var c=this._giftModule.assignPendingToaRetry(r);if(!c)return this._fireCallbackAndClean(new Error(n.CANNOT_ASSIGN_PENDING_RETRY))}else this._giftModule.setAutoAssign(!0),s.getStoreInfos(function(e){if(e)return n._fireCallbackAndClean(new Error(n.GET_STORE_INFOS_ERROR));var t=n._inventory.goultines;return t-l.TOA_RETRY_HC_PRICE<0?(s.openNotEnoughHardCurrencyPopup(l.TOA_RETRY_HC_PRICE-t),n._fireCallbackAndClean(new Error(n.NEED_HC))):void a.send("toaContinue",{goultinesAmount:t})})},n.prototype._fireCallbackAndClean=function(e){this._cb?this._cb(e,this._stepNumber):r.error(new Error("ToaRetryPopupLogic: cb is falsy")),this._inventory=null,this._cb=null,this._stepNumber=-1,this._actionIdMap={},this._giftModule.setAutoAssign(!1),this._stopGiftTimeout()},n.prototype._startGiftTimeout=function(){var e=this;this._giftTimeout=setTimeout(function(){e._fireCallbackAndClean(new Error(e.GIFT_TIMEOUT))},l.TOA_RETRY_TIMEOUT)},n.prototype._stopGiftTimeout=function(){clearTimeout(this._giftTimeout)}},function(e,t,i){function n(){a.call(this,{className:"PromotionPopup",positionInfo:{left:"c",top:"c",width:600,height:200}}),this._createDom()}i(1294);var o=i(191).inherits,s=i(246),a=i(233),r=i(29).getText,l=i(225);o(n,a),e.exports=n,n.prototype._createDom=function(){var e=this,t=this.windowBody.createChild("div",{className:"messageBox"});this.setTitle(r("tablet.popup.promotionPopup.title")),t.createChild("div",{className:"message"}).setHtml(r("tablet.popup.promotionPopup.content"));var i=this.windowBody.createChild("div",{className:"buttonContainer"});i.appendChild(new s({text:r("tablet.popup.promotionPopup.button"),className:["button","buttonNo"]},function(){l.close(e.id),l.open("market",{tabId:"shop"})}))}},function(e,t){},function(e,t,i){function n(){var e=this;c.call(this,{className:"MarketingWindow",positionInfo:{left:"c",top:"c",width:500,height:340}}),this.articleId=0,this.promoImg=this.windowBody.createChild("div",{className:"promoImg"}),this.windowBody.createChild("div",{className:"buttonContainer"}).appendChild(new s({className:"greenButton",text:r("ui.popup.shopMarketingConfirm")},function(){u.open("market",{tabId:"shop",tabParams:{articleId:e.articleId}}),e.close()})),this.on("opened",function(e){this._updateContent(e)}),this.on("close",function(){this.articleId=0})}i(1296);var o=i(191).inherits,s=i(246),a=i(205).formatUrlToCssUrl,r=i(29).getText,l=i(195),c=i(233),u=i(225),d=i(28);o(n,c),e.exports=n,n.prototype._updateContent=function(e){this.setTitle(e.name),this.articleId=e.id,this.promoImg.setStyle("backgroundImage",a(e.image[1].url));var t=window.gui.playerData.ShopData.getPromoDisplayUserPrefKey(),i=l.getValue(t,{});i[this.articleId]=d.now(),l.setValue(t,i)}},function(e,t){},function(e,t,i){function n(){var e=this;l.call(this,{className:"RatingWindow",positionInfo:{left:"c",top:"c",width:500,height:200}}),this.on("open",function(){e._initialize(),e._reset()}),this.on("close",function(){e._reset()}),this.isDislikeDofus=!1,this.isLikeDofus=!1,this.question=this.windowBody.createChild("div",{className:"question",text:a("ui.popup.ratingQuestion")}),this.buttonContainer=this.windowBody.createChild("div",{className:"buttonContainer"});var t=function(){console.log("Successfully launched review app")},i=function(e){console.error("Error launching review app: "+e)};this.yesButton=this.buttonContainer.appendChild(new s({className:"greenButton",text:a("ui.popup.ratingYes")},function(){e.isLikeDofus?(window&&window.LaunchReview&&(window.LaunchReview.isRatingSupported()?window.LaunchReview.rating(t,i):window.LaunchReview.launch(t,i)),e._setUserPref({isNeverAsk:!0,isNumAsked:!0}),e.close()):e._likeDofus()})),this.noButton=this.buttonContainer.appendChild(new s({className:"greenButton",text:a("ui.popup.ratingNo")},function(){e.isDislikeDofus?(e._setUserPref({isNeverAsk:!0,isNumAsked:!1}),e.close()):e.isLikeDofus?(e._setUserPref({isNeverAsk:!1,isNumAsked:!0}),e.close()):e._dislikeDofus()}))}i(1298);var o=i(191).inherits,s=i(246),a=i(29).getText,r=i(195),l=i(233);o(n,l),e.exports=n,n.prototype._setUserPref=function(e){var t=r.getValue("rateDofus");t||(t={isNeverAsk:!1,numAsked:0}),e.isNeverAsk&&(t.isNeverAsk=!0),e.isNumAsked&&t.numAsked++,r.setValue("rateDofus",t,null),this.close()},n.prototype._reset=function(){this.isDislikeDofus=!1,this.isLikeDofus=!1},n.prototype._initialize=function(){this.question.setText(a("ui.popup.ratingQuestion")),this.noButton.setText(a("ui.popup.ratingNo")),this.yesButton.setText(a("ui.popup.ratingYes"))},n.prototype._dislikeDofus=function(){this.isDislikeDofus=!0,this.question.setText(a("ui.popup.ratingDislikeQuestion")),this.noButton.setText(a("ui.popup.ratingWhyNotNo")),this.yesButton.setText(a("ui.popup.ratingWhyNotYes"))},n.prototype._likeDofus=function(){this.isLikeDofus=!0,this.question.setText(a("ui.popup.ratingLikeQuestion")),this.noButton.setText(a("ui.popup.ratingLikeNo")),this.yesButton.setText(a("ui.popup.ratingLikeYes"))}},function(e,t){},function(e,t,i){function n(){c.call(this,"div",{className:["connectionSplashScreen","hidding"],hidden:!0}),this.currentLevel=null,this.autoRemoveTimeout=null,this.state=""}function o(e){e.autoRemoveTimeout=null,e.replaceClassNames(["blocking"],["warning"])}i(1300);var s=i(29).getText,a=i(252),r=i(191).inherits,l=i(272),c=i(235),u=l.WARNING,d=l.BLOCKING,h=15e3;r(n,c),e.exports=n,n.prototype._createContent=function(){this.lockingDiv=this.createChild("div",{className:"lockingDiv"});var e=this.createChild("div",{className:"splashScreenMsg"});this.message=e.createChild("div",{className:"message"}),e.createChild("div",{className:["spinner","splashSpinner"]})},n.prototype._appear=function(e){if(e!==this.currentLevel)switch(this.currentLevel=e,this.lockingDiv||this._createContent(),this.autoRemoveTimeout=window.clearTimeout(this.autoRemoveTimeout),this.show(),a.forceReflow(this),e){case d:this.replaceClassNames(["hidding","warning"],["blocking"]),this.autoRemoveTimeout=window.setTimeout(o,h,this);break;case u:this.replaceClassNames(["hidding","blocking"],["warning"])}},n.prototype._disappear=function(){this.lockingDiv&&(this.currentLevel=null,this.replaceClassNames(["warning","blocking"],["hidding"]),window.clearTimeout(this.autoRemoveTimeout),this.autoRemoveTimeout=window.setTimeout(function(e){e.hide()},500,this))},n.prototype.onStateChange=function(e,t){if(e!==this.state)switch(this.state=e,e){case"UNSTABLE":this._appear(t||u),this.message.setText(s("tablet.connect.lost"));break;case"RECONNECTING":this._appear(this.currentLevel||u),this.message.setText(s("tablet.connect.retrying",t));break;case"RELOADING":this._appear(d),this.message.setText(s("tablet.connect.reloading"));break;case"CONNECTED":case"DISCONNECTED":this._disappear();break;default:console.error("ConnectionSplashScreen#onStateChange: invalid state: "+e)}}},function(e,t){},function(e,t,i){function n(e){e||window.gui.initializeAfterLogin(function(e){e&&(console.error("initializeAfterLogin failed:",e),window.gui.openSimplePopup(h("ui.popup.connectionFailed.text")))})}function o(){a.call(this,"div",{className:["loginScreen","screen"],hidden:!0}),this.addClassNames("vulkaniaSkin"),E=v.isWebGlSupported(),this._connectMethod=_.getValue("connectMethod",x,!0);var e=window.gui,t=this;this._changeLangMethod=O.UPDATE_DOM,this.once("show",function(){L={de:h("tablet.language.de"),en:h("tablet.language.en"),es:h("tablet.language.es"),fr:h("tablet.language.fr"),it:h("tablet.language.it"),pt:h("tablet.language.pt")},this._createContent()}),E&&(this.on("show",this._updateContent),e.on("appLeaveBackground",function(){t.isVisible()&&t._updateContent()}),this.on("hide",function(){t.delClassNames("backgroundImage")})),e.on("NicknameRegistrationMessage",function(){y.open("nickname")}),window.dofus.on("wasAlreadyConnected",function(){e.openSimplePopup(h("ui.connection.disconnectAccount"),h("ui.popup.warning"))})}i(1302);var s=i(191).inherits,a=i(235),r=i(258),l=i(246),c=i(478),u=i(183).dimensions,d=i(29),h=d.getText,p=i(283),m=i(252),f=i(282),g=i(228),_=i(195),v=i(445),y=i(225),b=i(1238),w=i(1303),M=i(1306),T=i(1311),C=i(1313),I=i(1315),A=i(1319),S=i(1310).connectMethod,E=!0,x=S.lastCharacter,L={},N=670,O={UPDATE_DOM:0,RELOAD_PAGE:1},D=i(184).TOTAL_MAP_ASSETS_SIZE_IN_GB;s(o,a),e.exports=o,o.prototype._createContent=function(){function e(e){e.on("submit",function(e){e=e||{},t._login(e.login,e.password,e.save)})}var t=this;if(!E)return this._webGlUnsupported=this.createChild("div",{className:"webGlUnsupported"}),this._webGlUnsupported.setText(h("tablet.login.webGlUnsupported")),void console.error("WebGL is not supported");this._splashScreenNews=this.appendChild(new w);var i=this.createChild("div",{className:"verticalPositionerWrapper"}),n=i.createChild("div",{className:"verticalPositioner"});n.createChild("div",{className:"spacer"}),n.createChild("div",{className:"spacer"}),this._leftColumn=n.createChild("div",{className:"leftColumn"}),this._newsBlock=this._leftColumn.appendChild(new I(this)),this._forumBlock=this._leftColumn.appendChild(new A(this)),this._forumBlock.retractableBlock.setBoundedRetractableBlock(this._newsBlock.retractableBlock),this._newsBlock.retractableBlock.expand(),this._loginForm=n.appendChild(new C(this)),this._guestForm=n.appendChild(new M(this)),this._tokenForm=n.appendChild(new T(this)),n.createChild("div",{className:"spacer"}),n.createChild("div",{className:"spacer"}),e(this._loginForm),e(this._guestForm),e(this._tokenForm),this.displayAppropriateForm(),this._createTopButtons(),this._createBottomLinks(),this._createSocialButtons(),this._audioSetup()},o.prototype._createTopButtons=function(){var e=this.createChild("div",{className:"topButtons"});this._createPreloadMapButton(e),this._createLangButton(e)},o.prototype._createPreloadMapButton=function(e){var t=[{getCaption:function(){var e=h("tablet.common.acronymGigabytes",D);return h("tablet.login.settings.downloadMaps",e)},cb:function(){y.open("preloadMap",{})}}];e.appendChild(new l({className:["settingsButton","simpleButton"],addIcon:!0},function(){for(var i=[],n=0;n<t.length;n++){var o=t[n];i.push({caption:o.getCaption(),cb:o.cb})}c.openAround("generic",e,{title:"",actions:i})}))},o.prototype._createLangButton=function(e){function t(){n._changeLanguage(this.lang,i)}var i=window.Config,n=this;this._langButton=e.createChild("div",{className:"langButton"}),this._langFlag=this._langButton.createChild("div",{className:"flagText"}),g(this._langButton),this._langButton.on("tap",function(){for(var e=[],o=i.language,s=0;s<i.serverLanguages.length;s++){var r=i.serverLanguages[s],l=new a("div",{className:"langLine"}),u=L[r];u||(console.error(new Error("No language label for language "+r)),u=r),l.createChild("div",{className:"caption",text:u});var d=["langLineParent"];r===o&&d.push("current"),e.push({wuiDomChild:l,addClassNames:d,lang:r,cb:t})}c.openAround("generic",n._langButton,{title:"",actions:e})})},o.prototype._changeLanguage=function(e,t){var i=this;if(e!==t.language)return this._changeLangMethod===O.RELOAD_PAGE?(_.setValue("lang",e),_.saveNow(),void window.location.reload()):void d.initialize({language:e,chaseText:t.chaseText},function(n){return n?console.error("LoginScreen getText init",n):(t.language=e,i.backToLogin(),_.setValue("lang",e,1),void i._updateContent())})},o.prototype._createBottomLinks=function(){function e(){m.openUrlInAppBrowser(this.link)}var t=this.createChild("div",{className:"footer"});this._versionLabel=t.createChild("div",{className:"globalMenuVersion"}),this._tou=t.appendChild(new l({className:["link"]})),this._gcs=t.appendChild(new l({className:["link"]})),this._tou.on("tap",e),this._gcs.on("tap",e)},o.prototype._createSocialButtons=function(){var e=this,t=this._leftColumn;u.screenHeight<N&&(t=e),this.socialButtons=new b,t.appendChild(this.socialButtons)},o.prototype._audioSetup=function(){var e=_.getValue("soundPreferences",r.getDefaultParams(),!0);r.setupChannels(e),r.settings.audioPath=window.Config.assetsUrl+"/audio/",r.initialize(),e.ui.muted||r.createUiSound("GEN_BUTTON")},o.prototype.showLoginForm=function(){this._loginForm.show(),this._guestForm.hide(),this._tokenForm.hide()},o.prototype.showGuestForm=function(){return window.Config.disabledFeatures.guest?(this.showLoginForm(),console.error(new Error("showGuestForm: guest is disabled"))):(this._loginForm.hide(),this._guestForm.show(),void this._tokenForm.hide())},o.prototype.showTokenForm=function(){this._loginForm.hide(),this._guestForm.hide(),this._tokenForm.show()},o.prototype.displayAppropriateForm=function(){if(p.hasKeyFromStorage()&&!window.Config.byPassToken)this.showTokenForm();else if(window.Config.disabledFeatures.guest)this.showLoginForm();else{var e=_.getValue("hasAccount",!1,!0);e?this.showLoginForm():this.showGuestForm()}},o.prototype.openRegisterWindow=function(e){var t=this,i={guestAccount:e,onValidate:function(e){t._afterValidation(e)}};y.open("birthdayLimit",i)},o.prototype._afterValidation=function(e){return e?(_.delValue("guestAccount"),_.delValue("lastIdentification"),_.setValue("hasAccount",!0),_.saveNow(),window.gui.openSimplePopup(h("ui.popup.accessDenied.unvalidatedEmail"),h("ui.common.congratulation")),this._guestForm.refresh(),void this.showLoginForm()):this._updateContent()},o.prototype.backToLogin=function(){y.closeAll(),window.gui.splashScreen.hide(),this.show()},o.prototype._login=function(e,t,i){var o=this;this._changeLangMethod=O.RELOAD_PAGE,y.open("cleanAssets",function(s){return s?n(s):(window.gui.splashScreen.show(),e?f.startLoginProcessWithPassword(o._connectMethod,e,t,i,n):f.startLoginProcessWithoutPassword(o._connectMethod,n))})},o.prototype._updateContent=function(){this.addClassNames("backgroundImage"),this.displayAppropriateForm(),this._loginForm.refresh(),this._guestForm.refresh(),this._tokenForm.refresh(),this._newsBlock.refresh(),this._forumBlock.refresh(),this._langFlag.setText(window.Config.language),this._tou.setText(h("tablet.legals.tou")),this._gcs.setText(h("tablet.legals.gcs")),this._tou.link=h("tablet.legals.link.tou"),this._gcs.link=h("tablet.legals.link.gcs"),this.socialButtons.updateContent(),this._versionLabel.setText(window.gui.getBuildVersion()),this.autoProposeRegistration&&(this.autoProposeRegistration=!1,window.setTimeout(this.openRegisterWindow.bind(this,this._guestForm.guestAccount),0)),this._splashScreenNews.showSplashScreen(window.Config.language),c.getContextMenu("generic").forceUpdateCancelButton()},o.prototype.proposeRegistrationAfterGuestLimit=function(){var e=this;window.gui.openConfirmPopup({message:h("tablet.oldGuest.limitQuestion"),cb:function(t){t&&(e.autoProposeRegistration=!0,window.gui.disconnect())}})}},function(e,t){},function(e,t,i){function n(){c.call(this,"div",{className:"SplashScreenNews",hidden:!0});var e="20200609",t=new Date("2020-05-21T22:00:00.000Z").getTime(),i=new Date("2020-07-09T21:59:00.000Z").getTime(),n={fr:"https://www.dofus-touch.com/fr/mmorpg/actualites/news/1184844-sortir-tete-eau-ligne",es:"https://www.dofus-touch.com/en/forum/99-informaciones-anuncios/6692-mantenerse-flote-linea",en:"https://www.dofus-touch.com/en/mmorpg/news/announcements/1184845-staying-above-water-online"};this._splashScreenNewsLogic=new p(n,e,i,t),
this._language=null,this._href=null;var a=this,r=this.appendChild(new u({className:"splashscreen-bg",scaleOnPress:!1},function(){s(a._language),a.hide()}));this._interactiveImage=r.appendChild(new u({scaleOnPress:!1},function(){a._href?h.openUrlInAppBrowser(a._href):console.error("SplashScreenNews: url missing for language",a._language),o(a._language),a._close()}));var l=this._interactiveImage.appendChild(new d({className:["closeButton"],scaleOnPress:!0}));l.on("tap",function(){s(a._language),a._close()})}function o(e){a(!0,e)}function s(e){a(!1,e)}function a(e,t){r.log("HUD.Click_on_button",{interface_id:"SplashScreenNews",button_id:e?"BTN_SPLASHSCREEN_OPEN_LINK":"BTN_SPLASHSCREEN_CLOSE",clic_parameter_key:"language",clic_parameter_value:t,clic_type:"Simple_court"})}i(1304);var r=i(7),l=i(191).inherits,c=i(235),u=i(246),d=i(279),h=i(252),p=i(1305);l(n,c),e.exports=n,n.prototype.showSplashScreen=function(e){this._language=e;var t=this._splashScreenNewsLogic.shouldShowFor(e);t&&(this._splashScreenNewsLogic.setShownIn(e),this._interactiveImage.setClassNames(["splashscreen-image","lang-"+e]),this._href=this._splashScreenNewsLogic.getUrlFor(e)),this.toggleDisplay(t)},n.prototype._close=function(){this._language=null,this._href=null,this.hide()}},function(e,t){},function(e,t,i){"use strict";function n(e,t,i,n){this._urls=e,this._endMilliTimestamp=i||-1,this._startMilliTimestamp=n||0,this._seed=t}var o=i(207).logger,s=i(195),a=i(28),r="en",l="splashScreenNews-shown";e.exports=n,n.prototype.setShownIn=function(e){var t=this._getUserPrefKey(e);s.setValue(t,this._seed,1,!0)},n.prototype.shouldShowFor=function(e){var t=this._getUserPrefKey(e),i=!1,n=a.now();if(this._startMilliTimestamp>n)return!1;if(this._endMilliTimestamp!==-1&&n>this._endMilliTimestamp)return!1;var o=s.getValue(t,!0,!0);return o!==this._seed&&(i=!0),i},n.prototype.getUrlFor=function(e){var t=this._urls[e];return t||(t=this._urls[r]),t?t:(o.error("getUrlFor: url missing for lang "+e),null)},n.prototype._getUserPrefKey=function(e){var t=e;return t||(o.error(new Error("_getUserPrefKey: language missing with lang "+t)),t=r),l+"_"+t}},function(e,t,i){function n(e){function t(e){return n._recaptchaResponse=e,n._createGuest()}function i(){var e=window.Config,i=e.language||"en",n=e.recaptcha.ankamaUrl,o=n+"/"+i+"/captcha",s={origin:n,src:o,lang:i,callback:t};return u.open("recaptcha",s)}s.call(this,"div",{className:["GuestForm","rightColumn"],hidden:!0}),this.loginScreen=e;var n=this;this.guestAccount=null,this.isAlreadyGuest=null,this.nickname=null,this.createChild("div",{className:["frame","frame1"]});var o=this.createChild("div",{className:"content"});o.createChild("div",{className:"dofusTouchLogo"});var c=o.createChild("div",{className:"form"});this._introText=c.createChild("div",{className:"introText"}),this._btnPlay=c.createChild("div",{className:"horizontalCenter"}).appendChild(new a({className:["button","buttonPlay"],sound:"OK_BUTTON"})),this._btnPlay.on("tap",function(){var o=l.getValue("guestAgreement",!1,!0),s={onValidate:i,isModal:!0};if(!n.isAlreadyGuest)return void u.open("legalAgreement",s);if(!o)return s.onValidate=t,void u.open("legalAgreement",s);var a=l.getValue("lastIdentification",null,!0);if(a){var c=Date.now()-a;if(c>864e5)return window.gui.openConfirmPopup({title:r("tablet.oldGuest.register"),message:r("tablet.oldGuest.registerReminder"),cb:function(t){return t?e.openRegisterWindow(n.guestAccount):void n._play()}}),void n._updateLastIdentificationTime()}else n._updateLastIdentificationTime();n._play()}),this._connectionOptions=c.appendChild(new d(e,this)),this._createAccount=this.appendChild(new a({className:"switchAccountBtn"},function(){e.openRegisterWindow(n.guestAccount)})),this._hasAnAccount=this.appendChild(new a({className:"switchAccountBtn2nd"},function(){l.setValue("hasAccount",!0,1),e.showLoginForm()})),this.createChild("div",{className:"greenLine"})}i(1307);var o=i(191).inherits,s=i(235),a=i(246),r=i(29).getText,l=i(195),c=i(283),u=i(225),d=i(1308);o(n,s),e.exports=n,n.prototype.refresh=function(){this._btnPlay.enable(),this._btnPlay.setText(r("ui.common.play")),this._hasAnAccount.setText(r("tablet.login.haveLogin")),this._connectionOptions.refresh(),this._update()},n.prototype._update=function(){this.guestAccount=l.getValue("guestAccount",null,!0),this.isAlreadyGuest=!!(this.guestAccount&&this.guestAccount.login&&this.guestAccount.password),this.nickname=this.guestAccount&&this.guestAccount.nickname||"guestWithNoNickname",this.isAlreadyGuest?(this._createAccount.setText(r("tablet.oldGuest.register")),"guestWithNoNickname"===this.nickname?this._introText.setText(r("tablet.oldGuest.desc.no.nick")):this._introText.setText(r("tablet.oldGuest.desc",this.nickname))):(this._createAccount.setText(r("tablet.login.createAccount")),this._introText.setText(r("tablet.newGuest.desc")))},n.prototype._createGuest=function(){var e=this;this._btnPlay.disable(),c.createGuest(e._recaptchaResponse,function(t,i){if(t){var n=t.userError||r("ui.secureMode.error.default");return window.gui.openSimplePopup(n),void console.error(t.error)}return e._play(i)})},n.prototype._updateLastIdentificationTime=function(){l.setValue("lastIdentification",Date.now(),null,!0)},n.prototype._play=function(e){e=e||{login:this.guestAccount.login,password:this.guestAccount.password},this.emit("submit",{login:e.login,password:e.password,save:e.save})}},function(e,t){},function(e,t,i){function n(e,t,i){s.call(this,"div",{className:"ConnectionOptions"}),this.loginScreen=e,i=i||{};var n=this,o=this.createChild("div",{className:"bottomLinks"});i.forgotPassword&&(this._forgottenPassword=o.appendChild(new a({className:"forgottenPassword"})),this._forgottenPassword.on("tap",function(){l.openUrlInAppBrowser(this.link)})),this._connectionOptions=o.appendChild(new a({className:"connectionOptions"})),this._connectionOptions.on("tap",function(){var e=!n._advancedOptions.isVisible();n._advancedOptions.toggleDisplay(e),n._connectionOptions.toggleClassName("selected",e),e&&n._update()}),this._advancedOptions=this.createChild("div",{className:"advancedOptions"}),this._advancedOptions.hide(),this._grayLine=this._advancedOptions.createChild("div",{className:"grayLine"}),this.connectionMethodSelector=this._advancedOptions.appendChild(new c({className:""})),this._advancedOptions.createChild("div",{className:"clearFloat"}),this.connectionMethodSelector.on("change",function(e){n.loginScreen._connectMethod=e,u.setValue("connectMethod",e,null,!0)})}i(1309);var o=i(191).inherits,s=i(235),a=i(246),r=i(29).getText,l=i(252),c=i(586),u=i(195),d=i(1310);o(n,s),e.exports=n,n.prototype.refresh=function(){this._forgottenPassword&&(this._forgottenPassword.setText(r("ui.login.forgottenPassword")),this._forgottenPassword.link=r("tablet.link.findPassword")),this._connectionOptions.setText(r("tablet.login.connectionOptions")),this.connectionMethodSelector.clearContent();for(var e in d.connectMethod)this.connectionMethodSelector.addOption(r("tablet.login.connectionOption."+e),e);this._update()},n.prototype._update=function(){this.connectionMethodSelector.select(this.loginScreen._connectMethod,!0)}},function(e,t){},function(e,t){e.exports={connectMethod:{manual:"manual",lastServer:"lastServer",lastCharacter:"lastCharacter"}}},function(e,t,i){function n(e){s.call(this,"div",{className:["TokenForm","rightColumn"],hidden:!0}),this.loginScreen=e;var t=this;this.createChild("div",{className:["frame","frame1"]});var i=this.createChild("div",{className:"content"});i.createChild("div",{className:"dofusTouchLogo"});var n=i.createChild("div",{className:"form"});this._introText=n.createChild("div",{className:"introText"}),this._btnPlay=n.createChild("div",{className:"horizontalCenter"}).appendChild(new a({className:["button","buttonPlay"],sound:"OK_BUTTON"})),this._btnPlay.on("tap",function(){t._play()}),this._connectionOptions=n.appendChild(new c(e,this)),this._guestLink=this.appendChild(new a({className:"switchAccountBtn"},function(){l.resetHaapiKey(),t.loginScreen.showLoginForm()})),this.createChild("div",{className:"greenLine"})}i(1312);var o=i(191).inherits,s=i(235),a=i(246),r=i(29).getText,l=i(283),c=i(1308);o(n,s),e.exports=n,n.prototype.refresh=function(){var e=l.getHaapiUsername();this._introText.setText(r("tablet.token.desc",e)),this._btnPlay.setText(r("ui.common.play")),this._guestLink.setText(r("tablet.token.notme",e)),this._connectionOptions.refresh(),this._update()},n.prototype._update=function(){},n.prototype._play=function(){this.emit("submit")}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:["LoginForm","rightColumn"],hidden:!0}),this.loginScreen=e;var t=this;this.createChild("div",{className:["frame","frame1"]});var i=this.createChild("div",{className:["content"]});i.createChild("div",{className:["dofusTouchLogo"]});var n=i.createChild("div",{className:["form"]});this._labelLogin=n.createChild("label"),this._inputLogin=n.appendChild(new c({className:["inputText","whiteStyle"],attr:{type:"text"}})),this._inputLogin.on("validate",function(){t._inputPassword.focus()}),this._labelPassword=n.createChild("label"),this._inputPassword=n.appendChild(new c({className:["inputText","whiteStyle"],attr:{type:"password"}})),this._inputPassword.on("validate",function(){t._play()}),this._rememberName=n.appendChild(new r("")),this._btnPlay=n.createChild("div",{className:["horizontalCenter"]}).appendChild(new a({className:["button","buttonPlay"],sound:"OK_BUTTON"})),this._btnPlay.on("tap",function(){t._play()}),this._connectionOptions=n.appendChild(new h(e,this,{forgotPassword:!0})),this._guestLink=this.appendChild(new a({className:"switchAccountBtn"},function(){d.setValue("hasAccount",!1,1),t.loginScreen.showGuestForm()})),this.createChild("div",{className:"greenLine"})}i(1314);var o=i(191).inherits,s=i(235),a=i(246),r=i(676),l=i(29).getText,c=i(582),u=i(482),d=i(195),h=i(1308);o(n,s),e.exports=n,n.prototype.refresh=function(){this._labelLogin.setText(l("ui.login.username")),this._labelPassword.setText(l("ui.login.password")),this._btnPlay.setText(l("ui.common.play")),this._rememberName.setText(l("tablet.login.rememberMe")),this._guestLink.setText(l("tablet.login.noAccount")),this._guestLink.toggleDisplay(!window.Config.disabledFeatures.guest),this._connectionOptions.refresh(),this._update()},n.prototype._update=function(){this._rememberName.toggleActivation(!1,!0),this._inputLogin.setValue(""),window.developmentMode?this._inputPassword.setValue(window.Config.defaultPassword||""):this._inputPassword.setValue("")},n.prototype._play=function(){u.hide();var e=this._inputLogin.getValue(),t=this._inputPassword.getValue(),i=this._rememberName.isActivate();return window.developmentMode||e&&t?void this.emit("submit",{login:e,password:t,save:i}):window.gui.openSimplePopup(l("ui.popup.accessDenied.wrongCredentials"))}},function(e,t){},function(e,t,i){function n(e){function t(e){function t(){var t=i._newsUrls[e];t&&i.isTapping&&c.openUrlInAppBrowser(t)}i._banners[e].on("tap",t),i._bannerTitles[e].on("tap",t)}s.call(this,"div",{className:"NewsBlock",hidden:!1});var i=this;this.loginScreen=e,this._newsLoadedTime=0,this._currentPage=0,this._newsLang=null,this._transitioning=!1,this._setTimoutId=null,this._pageCount=v,this._carouselPages=[],this._banners=[],this._newsUrls=[],this._bannerTitles=[],this._date=[],this._dots=[],this.retractableBlock=this.appendChild(new u((!1)));var n=this.retractableBlock.getContainer();this._carouselMargin=n.createChild("div",{className:"carouselMargin"}),this._carouselWrapper=this._carouselMargin.createChild("div",{className:"carouselWrapper"}),c.cssTransition(this._carouselWrapper,g+"ms"),this._dotsWrapper=this._carouselMargin.createChild("div",{className:"dotsWrapper",hidden:!0});for(var o=0;o<v;o++)this._carouselPages[o]=this._carouselWrapper.createChild("div",{className:["carouselPage","page"+o],hidden:!0}),this._banners[o]=this._carouselPages[o].createChild("div",{className:["banner","spinner"]}),d(this._banners[o]),this._bannerTitles[o]=this._carouselPages[o].createChild("div",{className:"bannerTitle"}),d(this._bannerTitles[o]),this._date[o]=this._carouselPages[o].createChild("div",{className:"date"}),t(o),this._dots[o]=this._dotsWrapper.createChild("div",{className:"dot"});this._resetTransform(),this._updateDots(),this._rightArrow=n.appendChild(new a({className:"rightArrow",hidden:!0},function(){i._transitioning||i._scrollToNextNews()})),this._leftArrow=n.appendChild(new a({className:"leftArrow",hidden:!0},function(){i._transitioning||i._scrollToPrevNews()})),e.on("hide",function(){for(var e=0;e<v;e++)i._banners[e].setStyle("backgroundImage","initial");i._newsLoadedTime=0,i._clearTimeout()});var r=null;this.isTapping=!1,this.retractableBlock.allowDomEvents(),this.retractableBlock.on("dom.touchstart",function(e){if(!(i._pageCount<=1)){var t=h(e);r=t.x,i.isTapping=!0}}),this.retractableBlock.on("dom.touchmove",function(e){if(!(i._pageCount<=1)&&i.isTapping){var t=h(e),n=t.x-r;n>y&&(i.isTapping=!1,i._scrollToPrevNews()),n<-y&&(i.isTapping=!1,i._scrollToNextNews())}})}i(1316);var o=i(191).inherits,s=i(235),a=i(246),r=i(29).getText,l=i(283),c=i(252),u=i(1317),d=i(228),h=i(229).getPosition,p=i(205).formatUrlToCssUrl,m=5e3,f=288e5,g=600,_=475,v=3,y=20;o(n,s),e.exports=n,n.prototype.refresh=function(){this.retractableBlock.show(),this.retractableBlock.setTitle(r("tablet.login.news")),this._update()},n.prototype._update=function(){var e=window.Config,t=this;Date.now()-this._newsLoadedTime<f&&this._newsLang===e.language||(this._clearTimeout(),this._rightArrow.hide(),this._leftArrow.hide(),this._dotsWrapper.hide(),this._newsLoadedTime=0,this._banners[this._currentPage].addClassNames("spinner"),this._pageCount=0,l.getNewsList(v,function(i,n){if(i||!n)return t._noNewsFallback();if(!n.length)return t.loginScreen._forumBlock.retractableBlock.expand(),t._noNewsFallback();t._newsLoadedTime=Date.now(),t._pageCount=n.length,t._currentPage=0,t._resetTransform(),t._updateDots();for(var o=0;o<v;o++){var s=o<t._pageCount;if(t._dots[o].toggleDisplay(s),t._carouselPages[o].toggleDisplay(s),s){var a=n[o],r=a.image_url;t._banners[o].delClassNames(["spinner","noNewsFallback"]),r&&t._banners[o].setStyle("backgroundImage",p(r)),t._date[o].setText(a.date),t._date[o].show(),t._newsUrls[o]=a.url,t._bannerTitles[o].setText(a.name)}}var l=t._pageCount>1;t._rightArrow.toggleDisplay(l),t._leftArrow.toggleDisplay(l),t._dotsWrapper.toggleDisplay(l),l&&t._registerNextNewsChange(),t._newsLang=e.language}))},n.prototype._scrollToPrevNews=function(){this._scrollNews(-1)},n.prototype._scrollToNextNews=function(){this._scrollNews(1)},n.prototype._scrollNews=function(e){if(e===-1||1===e){var t=this;if(!this._transitioning){this._clearTimeout(),this._currentPage=(this._currentPage+this._pageCount+e)%this._pageCount;var i=e===-1?0:2*_;this._carouselPages[this._currentPage].setStyle("left",i+"px"),c.forceReflow(this._carouselWrapper),c.cssTransform(this._carouselWrapper,"translate("+(1===e?2*-_:0)+"px, 0px)"),this._updateDots(),this._transitioning=!0,setTimeout(function(){t._resetTransform(),t._transitioning=!1,t._registerNextNewsChange()},g+200)}}},n.prototype._updateDots=function(){for(var e=0;e<v;e++)this._dots[e].toggleClassName("selected",this._currentPage===e)},n.prototype._resetTransform=function(){c.cssTransition(this._carouselWrapper,"0ms"),c.forceReflow(this._carouselWrapper),c.cssTransform(this._carouselWrapper,"translate(-"+_+"px, 0px)"),c.forceReflow(this._carouselWrapper),c.cssTransition(this._carouselWrapper,g+"ms");for(var e=0;e<this._pageCount;e++){var t=e===this._currentPage-1||e-this._pageCount===this._currentPage-1,i=e===this._currentPage,n=e===this._currentPage+1||e+this._pageCount===this._currentPage+1,o=t||i||n;if(o){var s=2*_;i?s=_:t&&(s=0),this._carouselPages[e].setStyle("left",s+"px"),this._carouselPages[e].show()}else this._carouselPages[e].hide()}},n.prototype._registerNextNewsChange=function(){var e=this;null===this._setTimoutId&&(this._transitioning||0!==e._newsLoadedTime&&(this._setTimoutId=setTimeout(function(){this._setTimoutId=null,0!==e._newsLoadedTime&&(e._scrollToNextNews(),e._registerNextNewsChange())},m)))},n.prototype._clearTimeout=function(){null!==this._setTimoutId&&(clearTimeout(this._setTimoutId),this._setTimoutId=null)},n.prototype._noNewsFallback=function(){this._newsLoadedTime=0,this._leftArrow.hide(),this._rightArrow.hide(),this._dotsWrapper.hide(),this._clearTimeout();for(var e=0;e<v;e++)this._banners[e].delClassNames("spinner"),this._bannerTitles[e].setText(r("tablet.login.noNewsFallback")),this._date[e].hide();this._banners[this._currentPage].addClassNames("noNewsFallback"),this._newsUrls[this._currentPage]=r("tablet.forum.link")}},function(e,t){},function(e,t,i){function n(e){s.call(this,"div",{className:"RetractableBlock",hidden:!1});var t=this;this._isExpanded=!1,this._boundedBlock=null,this.createChild("div",{className:["frame","frame2"]});var i=this.createChild("div",{className:"content"}),n=0;r.log("HUD.Click_on_button",{interface_id:"ChangeLog",button_id:"BTN_CHANGELOG_OPEN_BEFORE_LOGIN",clic_parameter_key:"occurrence",clic_parameter_value:n,clic_type:"Simple_court"},{override:!0}),this._titleBox=i.createChild("div",{className:"titleBox"}),this._titleBullet=this._titleBox.createChild("div",{className:"titleBullet"}),this._title=this._titleBox.createChild("div",{className:"title"}),e&&(this._expandButton=this._titleBox.appendChild(new a({className:["greenButton","expandButton"]},function(){t._isExpanded?(t._retract(),t._boundedBlock&&t._boundedBlock.expand()):(t.expand(),r.log("HUD.Click_on_button",{interface_id:"ChangeLog",button_id:"BTN_CHANGELOG_OPEN_BEFORE_LOGIN",clic_parameter_key:"occurrence",clic_parameter_value:++n,clic_type:"Simple_court"},{override:!0}))})),this._expandButton.createChild("div",{className:"expandeButtonContent",text:"+"})),this._subTitle=this._titleBox.createChild("div",{className:"subTitle"}),this._retractable=i.createChild("div",{className:"retractable"}),l.push(this)}i(1318);var o=i(191).inherits,s=i(235),a=i(246),r=i(7),l=[];o(n,s),e.exports=n,n.prototype.getContainer=function(){return this._retractable},n.prototype.setTitle=function(e){this._title.setText(e)},n.prototype.setSubTitle=function(e){this._subTitle.setText(e)},n.prototype.expand=function(){for(var e=0;e<l.length;e++){var t=l[e];this===t?t._expand():t._retract()}},n.prototype._expand=function(){this._isExpanded||(this._retractable.addClassNames("expanded"),this._titleBox.addClassNames("expanded"),this._expandButton&&(this._boundedBlock?this._expandButton.setText("-"):this._expandButton.addClassNames("expanded")),this._isExpanded=!0)},n.prototype._retract=function(){this._isExpanded&&(this._retractable.delClassNames("expanded"),this._titleBox.delClassNames("expanded"),this._expandButton&&(this._boundedBlock?this._expandButton.setText("+"):this._expandButton.delClassNames("expanded")),this._isExpanded=!1)},n.prototype.setBoundedRetractableBlock=function(e){return this._boundedBlock||e._boundedBlock?console.error(new Error("RetractableBlock: a block is already bounded to another one")):(this._boundedBlock=e,void(e._boundedBlock=this))}},function(e,t){},function(e,t,i){function n(){u.call(this,"div",{className:"ForumBlock",hidden:!1}),this._newsLoaded=!1,this.retractableBlock=this.appendChild(new g((!0)));var e=this.retractableBlock.getContainer().createChild("div",{className:["forumNewsMargin"]});this._content=e.createChild("div",{className:["forumNews"]}),s()}function o(e){return e=e.filter(function(e){return!e.pinned}),e.sort(function(e,t){return Date.parse(t.added_date)-Date.parse(e.added_date)}),e[0]}function s(){var e={openTag:function(){return"<center>"+h("tablet.login.forumUnsupportedTag")+"</center><br />"},closeTag:function(){return""},displayContent:!1};d.addTags({h2:{openTag:function(){return"<h3>"},closeTag:function(){return"</h3>"}},h3:{openTag:function(){return"<h4>"},closeTag:function(){return"</h4>"}},hr:{openTag:function(){return'<br /><hr class="postSeparator"><br />'},closeTag:function(){return""}},embed:e,spoiler:e})}function a(e){return e=e.replace(/\[hr\]/g,"[hr][/hr]"),e=e.replace(/\[list=1\]/g,"[list type=decimal]")}function r(e){return e=e.replace(/(?:\r\n|\r|\n)/g,"<br />")}i(1320);var l=i(27),c=i(191).inherits,u=i(235),d=i(1321),h=i(29).getText,p=i(283),m=i(252),f=i(207).logger,g=i(1317);c(n,u),e.exports=n,n.prototype.refresh=function(){this.retractableBlock.show(),this.retractableBlock.setTitle(h("tablet.login.changelog")),this._update()},n.prototype._update=function(){var e=this;this._content.clearContent(),this._content.addClassNames("spinner"),p.getForumTopicsList(function(t,i){if(t)return window.developmentMode&&console.error(t),e._content.delClassNames("spinner"),e._content.setHtml(h("tablet.login.forumUnreachable")),void m.allLinksOnTargetBlank(e._content);var n=o(i);p.getForumPostsList(n.id,function(t,i){if(e._content.delClassNames("spinner"),t)return e._content.setHtml(h("tablet.login.forumUnreachable")),void m.allLinksOnTargetBlank(e._content);var o,s=[n].concat(i),c="";for(o=0;o<s.length;o++){c+=0===o?"<h2>"+s[o].title+"</h2><br/>":"<br /><br /><center>* * *</center><br />";var u=s[o].content;u=a(u),u=d.process({text:u}).html,u=r(u),c+=u}e._content.setHtml(c),m.allLinksOnTargetBlank(e._content);var p="",g=null;try{p=l(n.added_date,"yyyy-mm-dd")}catch(t){g=t}g&&f.error("dateFormat error, topic date: "+n.added_date+" error: "+g),e.retractableBlock.setSubTitle(p+h("ui.common.colon")+n.title)})})}},function(e,t){},function(e,t){var i=function(){"use strict";function e(){l=[];var e,t,i;for(e in r)if(r.hasOwnProperty(e)){for("*"===e?l.push("\\"+e):(l.push(e),r[e].noParse&&C.push(e)),r[e].validChildLookup={},r[e].validParentLookup={},r[e].restrictParentsTo=r[e].restrictParentsTo||[],r[e].restrictChildrenTo=r[e].restrictChildrenTo||[],i=r[e].restrictChildrenTo.length,t=0;t<i;t++)r[e].validChildLookup[r[e].restrictChildrenTo[t]]=!0;for(i=r[e].restrictParentsTo.length,t=0;t<i;t++)r[e].validParentLookup[r[e].restrictParentsTo[t]]=!0}c=new RegExp("<bbcl=([0-9]+) ("+l.join("|")+")([ =][^>]*?)?>((?:.|[\\r\\n])*?)<bbcl=\\1 /\\2>","gi"),u=new RegExp("\\[("+l.join("|")+")([ =][^\\]]*?)?\\]([^\\[]*?)\\[/\\1\\]","gi"),d=new RegExp("\\[("+C.join("|")+")([ =][^\\]]*?)?\\]([\\s\\S]*?)\\[/\\1\\]","gi"),function(){for(var e=[],t=0;t<l.length;t++)"\\*"!==l[t]&&e.push("/"+l[t]);h=new RegExp("(\\[)((?:"+l.join("|")+")(?:[ =][^\\]]*?)?)(\\])","gi"),p=new RegExp("(\\[)("+e.join("|")+")(\\])","gi")}()}function t(e,i,n,o,s,a,u){u=u||[],n++;var d,h,p,m,f=new RegExp("(<bbcl="+n+" )("+l.join("|")+")([ =>])","gi"),g=new RegExp("(<bbcl="+n+" )("+l.join("|")+")([ =>])","i"),_=a.match(f)||[],v=r[e]||{};for(f.lastIndex=0,_||(a=""),p=0;p<_.length;p++)g.lastIndex=0,m=_[p].match(g)[2].toLowerCase(),v&&v.restrictChildrenTo&&v.restrictChildrenTo.length>0&&(v.validChildLookup[m]||(h='The tag "'+m+'" is not allowed as a child of the tag "'+e+'".',u.push(h))),d=r[m]||{},d.restrictParentsTo.length>0&&(d.validParentLookup[e]||(h='The tag "'+e+'" is not allowed as a parent of the tag "'+m+'".',u.push(h)));return a=a.replace(c,function(e,i,n,o,s){return u=t(n,e,i,n,o,s,u),e}),u}function i(e){return e=e.replace(/\<([^\>][^\>]*?)\>/gi,function(e,t){var i=t.match(/^bbcl=([0-9]+) /);return null===i?"<bbcl=0 "+t+">":"<"+t.replace(/^(bbcl=)([0-9]+)/,function(e,t,i){return t+(parseInt(i,10)+1)})+">"})}function n(e){return e.replace(/<bbcl=[0-9]+ \/\*>/gi,"").replace(/<bbcl=[0-9]+ /gi,"&#91;").replace(/>/gi,"&#93;")}function o(e){var t=e.text;return t=t.replace(c,I)}function s(e){for(e=e.replace(/\[(?!\*[ =\]]|list([ =][^\]]*)?\]|\/list[\]])/gi,"<"),e=e.replace(/\[(?=list([ =][^\]]*)?\]|\/list[\]])/gi,">");e!==(e=e.replace(/>list([ =][^\]]*)?\]([^>]*?)(>\/list])/gi,function(e,t,i){for(var n=e;n!==(n=n.replace(/\[\*\]([^\[]*?)(\[\*\]|>\/list])/i,function(e,t,i){i=">/list]"===i?"</*]</list]":"</*][*]";var n="<*]"+t+i;return n})););return n=n.replace(/>/g,"<")})););return e=e.replace(/</g,"[")}function a(e){for(var t=function(e,t,n,o){return e=e.replace(/\[/g,"<"),e=e.replace(/\]/g,">"),i(e)};e!==(e=e.replace(u,t)););return e}var r,l,c,u,d,h,p,m={},f=/^(?:https?|file|c):(?:\/{1,3}|\\{1})[-a-zA-Z0-9:;@#%&()~_?\+=\/\\\.]*$/,g=/^(?:ftps?|c):(?:\/{1,3}|\\{1})[-a-zA-Z0-9:;@#%&()~_?\+=\/\\\.]*$/,_=/^(?:red|green|blue|orange|yellow|pink|black|white|beige|brown|grey|gray|silver|purple|maroon|lime|limegreen|olive|navy|teal|aqua)$/,v=/^#?[a-fA-F0-9]{6}$/,y=/[^\s@]+@[^\s@]+\.[^\s@]+/,b=/([1-9][\d]?p[xt]|(?:x-)?small(?:er)?|(?:x-)?large[r]?)/,w=/[#]?([A-Za-z][A-Za-z0-9_-]*)/,M=/(?:board=\d+;)?((?:topic|threadid)=[\dmsg#\.\/]{1,40}(?:;start=[\dmsg#\.\/]{1,40})?|action=profile;u=\d+)/,T=/^\/threads\/[a-z0-9\-]*\/posts[a-z0-9?\=\-#\&]*/i,C=[];r={anchor:{openTag:function(e,t){var i=e||"";return i=i.substr(1)||"",w.test(i)||(i=""),'<span id="post_'+i+'">'},closeTag:function(e,t){return"</span>"}},abbr:{openTag:function(e,t){var i=e||"";return i=i.substr(1)||"",i=i.replace(/<.*?>/g,""),'<abbr title="'+i+'">'},closeTag:function(e,t){return"</abbr>"}},acronym:{openTag:function(e,t){var i=e||"";return i=i.substr(1)||"",i=i.replace(/<.*?>/g,""),'<acronym title="'+i+'">'},closeTag:function(e,t){return"</acronym>"}},b:{openTag:function(e,t){return"<b>"},closeTag:function(e,t){return"</b>"}},bbcode:{openTag:function(e,t){return""},closeTag:function(e,t){return""}},black:{openTag:function(e,t){return'<span class="bbcode-color-black" style="color: black;">'},closeTag:function(e,t){return"</span>"}},blue:{openTag:function(e,t){return'<span class="bbcode-color-blue" style="color: blue;">'},closeTag:function(e,t){return"</span>"}},br:{openTag:function(e,t){return"<br />"},closeTag:function(e,t){return""}},btc:{openTag:function(e,t){return'<span class="BTC">BTC</span>'},closeTag:function(e,t){return""}},center:{openTag:function(e,t){return'<div align="center">'},closeTag:function(e,t){return"</div>"}},code:{openTag:function(e,t){return"<code>"},closeTag:function(e,t){return"</code>"},noParse:!0},color:{openTag:function(e,t){var i="",n=e||"=black";return n=n.substr(1)||"black",n=n.toLowerCase(),n=n.trim(),_.lastIndex=0,v.lastIndex=0,_.test(n)?i=n:v.test(n)?"#"!==n.substr(0,1)?(i="_"+n,n="#"+n):i="_"+n.substr(1):(n="black",i="black"),'<span class="bbcode-color-'+i+'" style="color:'+n+'">'},closeTag:function(e,t){return"</span>"}},email:{openTag:function(e,t){var i;return i=e?e.substr(1):t.replace(/<.*?>/g,""),i=i.trim(),y.lastIndex=0,y.test(i)?'<a href="mailto:'+i+'" target="_blank">':"<a>"},closeTag:function(e,t){return"</a>"}},ftp:{openTag:function(e,t){var i="";return i=e?e.substr(1):t.replace(/<.*?>/g,""),i=i.trim(),g.lastIndex=0,g.test(i)?'<a href="'+i+'" target="_blank">':'<a target="_blank">'},closeTag:function(e,t){return"</a>"}},glow:{openTag:function(e,t){var i=e||"";i=e.substr(1)||"",i=i.replace(/<.*?>/g,"");var n="",o=i.split(",")[0];return o=o.trim(),o=o.toLowerCase(),_.lastIndex=0,v.lastIndex=0,_.test(o)?n=o:v.test(o)?"#"!==o.substr(0,1)?(n="_"+o,o="#"+o):n="_"+o.substr(1):(o="inherit",n="inherit"),'<span class="bbcode-bgcolor-'+n+'" style="background-color: '+o+'">'},closeTag:function(e,t){return"</span>"}},green:{openTag:function(e,t){return'<span class="bbcode-color-green" style="color: green;">'},closeTag:function(e,t){return"</span>"}},hr:{openTag:function(e,t){return"<hr />"},closeTag:function(e,t){return""}},html:{openTag:function(e,t){return""},closeTag:function(e,t){return""}},i:{openTag:function(e,t){return"<i>"},closeTag:function(e,t){return"</i>"}},img:{openTag:function(e,t){var i=t;if(i=i.trim(),f.lastIndex=0,f.test(i)||(i=""),!e)return'<img src="'+i+'" />';var n=e;n=n.trim(),n=n.replace(/<.*?>/g,"");var o,s,a;if((n.match(/alt=/gi)||[]).length>1)return'<img src="'+i+'" />';if((n.match(/width=/gi)||[]).length>1)return'<img src="'+i+'" />';if((n.match(/height=/gi)||[]).length>1)return'<img src="'+i+'" />';var r=/^(alt=.+?|width=[0-9]+?|height=[0-9]+?)?\s*(alt=.+?|width=[0-9]+?|height=[0-9]+?)?\s*(alt=.+?|width=[0-9]+?|height=[0-9]+?)$/i.exec(n);if(r)for(var l=1;l<r.length;l++){var c=r[l]||"";c=c.trim(),/alt=/i.test(c)?o=c.substr(4):/width=/i.test(c)?s=c.substr(6):/height=/i.test(c)&&(a=c.substr(7))}var u='<img src="'+i+'" ';return o&&(u+='alt="'+o+'" '),s&&(u+='width="'+s+'" '),a&&(u+='height="'+a+'" '),u+="/>"},closeTag:function(e,t){return""},displayContent:!1},iurl:{openTag:function(e,t){var i;return i=e?e.substr(1):t.replace(/<.*?>/g,""),i=i.trim(),f.lastIndex=0,f.test(i)||(i="#"),'<a href="'+i+'" />'},closeTag:function(e,t){return""}},left:{openTag:function(e,t){return'<div class="bbcode-text-left" style="text-align: left;">'},closeTag:function(e,t){return"</div>"}},li:{openTag:function(e,t){return"<li>"},closeTag:function(e,t){return"</li>"},restrictParentsTo:["list","ul","ol"]},list:{openTag:function(e,t){var i="<ul>",n=e||"";return n=n.trim(),n=n.replace(/<.*?>/g,""),0===n.indexOf("type=")&&(n=n.replace("type=",""),n=n.trim(),/(none|disc|circle|square|decimal|decimal-leading-zero|lower-roman|upper-roman|lower-alpha|upper-alpha|lower-greek|lower-latin|upper-latin|hebrew|armenian|georgian|cjk-ideographic|hiragana|katakana|hiragana-iroha|katakana-iroha)/i.test(n)&&(i='<ul class="bbcode-list-'+n+'" style="list-style-type: '+n+'">')),i},closeTag:function(e,t){return"</ul>"},restrictChildrenTo:["*","li"]},ltr:{openTag:function(e,t){return'<div dir="ltr">'},closeTag:function(e,t){return"</div>"}},me:{openTag:function(e,t){var i=e||"";return i=i.substr(1),i=i.replace(/<.*?>/g,""),i=i.trim(),t&&(i+=" "),'<div class="bbcode-color-red" style="color: red;">* '+i+" "},closeTag:function(e,t){return"</div>"}},move:{openTag:function(e,t){return"<div>"},closeTag:function(e,t){return"</div>"}},noparse:{openTag:function(e,t){return""},closeTag:function(e,t){return""},noParse:!0},nobbc:{openTag:function(e,t){return""},closeTag:function(e,t){return""},noParse:!0},ol:{openTag:function(e,t){return"<ol>"},closeTag:function(e,t){return"</ol>"},restrictChildrenTo:["*","li"]},pre:{openTag:function(e,t){return"<pre>"},closeTag:function(e,t){return"</pre>"}},php:{openTag:function(e,t){return"<pre>"},closeTag:function(e,t){return"</pre>"},noParse:!0},quote:{openTag:function(e,t){var i='<div class="quoteHeader">Quote</div>',n='<div class="quote">',o=e||"";if(o=o.trim(),o=o.replace(/<.*?>/g,""),""===o)return i+n;if(0===o.indexOf("=")){var s=o.substr(1);return i='<div class="quoteHeader">',i+="Quote From: "+s,i+="</div>",i+n}if(/author="/i.test(o)){var a=o.toLowerCase(),r=o.substr(a.indexOf('author="')+7);return r=r.replace(/"/g,""),i='<div class="quoteHeader">',i+="Quote From: "+r,i+="</div>",i+n}var l,c,u,d=o.match(/author=/gi)||[];if(d.length>1||0===d.length)return i+n;if((o.match(/link=/gi)||[]).length>1)return i+n;if((o.match(/date=/gi)||[]).length>1)return i+n;var h=/^(author=.+?|link=.+?|date=[0-9]+?)?\s*(author=.+?|link=.+?|date=[0-9]+?)?\s*(author=.+?|link=.+?|date=[0-9]+?)$/i.exec(o);if(h)for(var p=1;p<h.length;p++){var m=h[p]||"";m=m.trim(),/author=/i.test(m)?l=m.substr(7):/link=/i.test(m)?(c=m.substr(5),M.test(c)||T.test(c)||(c=void 0)):/date=/i.test(m)&&(u=Number(m.substr(5)))}return l&&(i='<div class="quoteHeader">',i+="Quote From: "+l,i+="</div>"),l&&c&&u&&(i='<div class="quoteHeader">',i+='<a href="'+c+'">',i+="Quote from: "+l+" on ept-date="+u,i+="</a>",i+="</div>"),i+n},closeTag:function(e,t){return"</div>"}},right:{openTag:function(e,t){return'<div class="bbcode-text-right" style="text-align: right;">'},closeTag:function(e,t){return"</div>"}},red:{openTag:function(e,t){return'<span class="bbcode-color-red" style="color: red;">'},closeTag:function(e,t){return"</span>"}},rtl:{openTag:function(e,t){return'<div dir="rtl">'},closeTag:function(e,t){return"</div>"}},s:{openTag:function(e,t){return"<del>"},closeTag:function(e,t){return"</del>"}},shadow:{openTag:function(e,t){var i="",n="",o="",s="",a=/^(?:left|right|top|bottom)$/,r=/^[0-9]\d{0,2}$/,l=e||"";if(l=e.substr(1)||"",l=l.replace(/<.*?>/g,""),l.indexOf(",")<0)return"<span>";if(n=l.split(",")[0],n=n.trim(),n=n.toLowerCase(),_.lastIndex=0,
v.lastIndex=0,_.test(n)||(v.test(n)?"#"!==n.substr(0,1)&&(n="#"+n):n="black"),o=l.split(",")[1]||"",o=o.trim())if(a.test(o))o="left"===o?" -2px 2px":"right"===o?" 2px 2px":"top"===o?" 0 -2px":"bottom"===o?" 0 2px":" 0 0";else if(r.test(o)){var c=o,u=.0174532925*c;o=" "+Math.round(4*Math.cos(u))+"px",o+=" "+Math.round(-4*Math.sin(u))+"px"}else o=" 0 0";else o=" 0 0";s=l.split(",")[2]||"",s=s.trim(),s=s&&r.test(s)?" "+s+"px":" 0",i=n+o+s;var d=i.replace(/\s/gi,"_");return d=d.replace(/#/gi,"_"),'<span class="bbcode-shadow-'+d+'" style="text-shadow: '+i+'">'},closeTag:function(e,t){return"</span>"}},size:{openTag:function(e,t){var i=e||"";return i=i.substr(1)||"inherit",i=i.trim(),b.lastIndex=0,b.test(i)||(i="inherit"),'<span class="bbcode-size-'+i+'" style="font-size: '+i+' !important; line-height: 1.3em;">'},closeTag:function(e,t){return"</span>"}},spoiler:{openTag:function(e,t){return'<span class="spoiler">'},closeTag:function(e,t){return"</span>"}},sub:{openTag:function(e,t){return"<sub>"},closeTag:function(e,t){return"</sub>"}},sup:{openTag:function(e,t){return"<sup>"},closeTag:function(e,t){return"</sup>"}},tt:{openTag:function(e,t){return"<tt>"},closeTag:function(e,t){return"</tt>"}},time:{openTag:function(e,t){var i=t||"";return Number(i)?i="ept-date="+i:(i=new Date(i).getTime(),i="ept-date="+i),i},closeTag:function(e,t){return""},displayContent:!1},table:{openTag:function(e,t){return"<table>"},closeTag:function(e,t){return"</table>"},restrictChildrenTo:["tbody","thead","tfoot","tr"]},tbody:{openTag:function(e,t){return"<tbody>"},closeTag:function(e,t){return"</tbody>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},tfoot:{openTag:function(e,t){return"<tfoot>"},closeTag:function(e,t){return"</tfoot>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},thead:{openTag:function(e,t){return"<thead>"},closeTag:function(e,t){return"</thead>"},restrictChildrenTo:["tr"],restrictParentsTo:["table"]},td:{openTag:function(e,t){return'<td valign="top">'},closeTag:function(e,t){return"</td>"},restrictParentsTo:["tr"]},th:{openTag:function(e,t){return"<th>"},closeTag:function(e,t){return"</th>"},restrictParentsTo:["tr"]},tr:{openTag:function(e,t){return"<tr>"},closeTag:function(e,t){return"</tr>"},restrictChildrenTo:["td","th"],restrictParentsTo:["table","tbody","tfoot","thead"]},u:{openTag:function(e,t){return"<u>"},closeTag:function(e,t){return"</u>"}},ul:{openTag:function(e,t){return"<ul>"},closeTag:function(e,t){return"</ul>"},restrictChildrenTo:["*","li"]},url:{openTag:function(e,t){var i;return i=e?e.substr(1):t.replace(/<.*?>/g,""),i=i.trim(),f.lastIndex=0,f.test(i)||(i="#"),'<a href="'+i+'" target="_blank">'},closeTag:function(e,t){return"</a>"}},white:{openTag:function(e,t){return'<span class="bbcode-color-white" style="color: white;">'},closeTag:function(e,t){return"</span>"}},"*":{openTag:function(e,t){return"<li>"},closeTag:function(e,t){return"</li>"},restrictParentsTo:["list","ul","ol"]}},e();var I=function(e,t,i,o,s){i=i.toLowerCase();var a=r[i].noParse?n(s):s.replace(c,I),l=r[i].openTag(o,a),u=r[i].closeTag(o,a);return r[i].displayContent===!1&&(a=""),l+a+u};return m.tags=function(){return r},m.addTags=function(t){var i;for(i in t)r[i]=t[i];e()},m.process=function(e){var i={html:"",error:!1},n=[];for(e.text=e.text.replace(/</g,"&lt;"),e.text=e.text.replace(/>/g,"&gt;"),e.text=e.text.replace(h,function(e,t,i,n){return"<"+i+">"}),e.text=e.text.replace(p,function(e,t,i,n){return"<"+i+">"}),e.text=e.text.replace(/\[/g,"&#91;"),e.text=e.text.replace(/\]/g,"&#93;"),e.text=e.text.replace(/</g,"["),e.text=e.text.replace(/>/g,"]");e.text!==(e.text=e.text.replace(d,function(e,t,i,n){return n=n.replace(/\[/g,"&#91;"),n=n.replace(/\]/g,"&#93;"),i=i||"",n=n||"","["+t+i+"]"+n+"[/"+t+"]"})););return e.text=s(e.text),e.text=a(e.text),n=t("bbcode",e.text,-1,"","",e.text),i.html=o(e),i.html.indexOf("[")===-1&&i.html.indexOf("]")===-1||n.push("Some tags appear to be misaligned."),e.removeMisalignedTags&&(i.html=i.html.replace(/\[.*?\]/g,"")),e.addInLineBreaks&&(i.html='<div style="white-space:pre;">'+i.html+"</div>"),i.html=i.html.replace("&#91;","["),i.html=i.html.replace("&#93;","]"),i.html=i.html.replace(/&lt;/g,"<"),i.html=i.html.replace(/&gt;/g,">"),i.error=0!==n.length,i.errorQueue=n,i},m}();e.exports=i},function(e,t,i){function n(){s.call(this,"div",{className:"splashScreen",hidden:!0}),this.once("show",n.prototype._createContent);var e=this;window.gui.on("connected",function(){e.hide()})}i(1323);var o=i(191).inherits,s=i(235);o(n,s),e.exports=n,n.prototype._createContent=function(){this.log=this.createChild("div",{className:"logBox"}),this.createChild("div",{className:"dofusLogo"}),this.createChild("div",{className:["spinner","splashSpinner"]})},n.prototype.showMessage=function(e){this.log.setText(e)}},function(e,t){},function(e,t,i){function n(){function e(){var e=h.getValue();g.disable(),f.disable(),p.setText(l("ui.common.waiting")),p.delClassNames("error"),window.dofus.sendMessage("NicknameChoiceRequestMessage",{nickname:e})}function t(){window.dofus.disconnect(),a.close(n.id)}function i(){h.getValue().length<3?g.disable():g.enable()}s.call(this,{className:"NicknameWindow",title:"",positionInfo:{left:"c",top:"c",width:500,height:355},noCloseButton:!0});var n=this,o=this.windowBody,u=o.createChild("div",{className:"description"}),h=o.appendChild(new r({className:"nickname",attr:{maxlength:29}})),p=o.createChild("div",{className:"info"}),m=o.createChild("div",{className:"buttonContainer"}),f=m.appendChild(new c.DofusButton),g=m.appendChild(new c.DofusButton);this.once("open",function(){h.on("change",i),h.on("validate",function(){g.tap()}),g.on("tap",e),f.on("tap",function(){t()}),window.gui.on("NicknameRefusedMessage",function(e){p.setText(l(d[e.reason])),p.addClassNames("error"),g.enable(),f.enable()}),window.gui.on("NicknameAcceptedMessage",function(){window.gui.openConfirmPopup({title:l("ui.popup.warning"),message:l("tablet.nickname.reconnect.popup"),noDisable:!0,cb:function(e){e&&t()}})})}),this.on("open",function(){n.setTitle(l("ui.pseudoChoice.title")),u.setText(l("ui.pseudoChoice.help")),g.disable(),f.enable(),f.setText(l("ui.common.cancel")),g.setText(l("ui.common.validation")),h.focus()}),this.on("close",function(){p.setText(""),p.delClassNames("error"),h.setValue(""),h.blur()})}i(1325);var o=i(191).inherits,s=i(233),a=i(225),r=i(582),l=i(29).getText,c=i(246),u=i(1326),d={};d[u.ALREADY_USED]="ui.nickname.alreadyUsed",d[u.SAME_AS_LOGIN]="ui.nickname.equalsLogin",d[u.TOO_SIMILAR_TO_LOGIN]="ui.nickname.similarToLogin",d[u.INVALID_NICK]="ui.nickname.invalid",d[u.UNKNOWN_NICK_ERROR]="ui.nickname.unknown",o(n,s),e.exports=n},function(e,t){},function(e,t){e.exports={ALREADY_USED:1,SAME_AS_LOGIN:2,TOO_SIMILAR_TO_LOGIN:3,INVALID_NICK:4,UNKNOWN_NICK_ERROR:99}},function(e,t,i){function n(){function e(){return I>C}function t(e,t,i){h.series([function(t){return b?t():void u.createGuest(e,function(e,i){return e?t(e.error):(b=i,void t())})},function(e){t.guestLogin=b.login,t.guestPassword=b.password,u.validateGuest(t,e)}],function(e){i(e,{login:t.login,password:t.password})})}function i(){ne.setValue(ne.getValue().trim());var t=L.getValue().length,i=/^[a-zA-Z0-9-]*$/.test(L.getValue()),n=B.getValue().length,o=W.getValue().length,s=B.getValue()===W.getValue(),a=V.getValue().length,r=/.+@.+\..+/.test(V.getValue()),l=!e()||Z.getValue().length,c=!e()||/.+@.+\..+/.test(Z.getValue()),u=ne.getValue().length,d=/^[a-zA-Z0-9-]*$/.test(ne.getValue()),h=re.isActivate();return de.delClassNames("error"),de.setText(""),O.toggleDisplay(t&&!i),F.toggleDisplay(n&&o&&!s),U.toggleDisplay(n&&o&&!s),X.toggleDisplay(a&&!r),$.toggleDisplay(l&&!c),se.toggleDisplay(u&&!d),ge.disable(),t&&i&&n&&o&&s&&a&&l&&r&&c&&u&&d&&h?(ge.enable(),!0):(de.addClassNames("error"),!1)}function n(){m.openUrlInAppBrowser(this.link)}function o(e){if(e){for(var t=he.getChildren(),i=0;i<v;i++)t[i+1].setText((i>0?", ":"")+e[i]);he.addClassNames("visible")}}function y(e){var i={login:L.getValue(),password:B.getValue(),email:V.getValue(),nickname:ne.getValue(),birthDateTimestamp:I,parentEmail:Z.getValue()};b&&(i.guestLogin=b.login,i.guestPassword=b.password),t(e,i,function(e,t){return ge.enable(),e?e._statusCode>=600?(de.addClassNames("error"),de.setText(e.text),void o(e.suggests)):(window.gui.openSimplePopup(r("ui.secureMode.error.default")),console.error("RegisterWindow haapiCall",e)):w.close(t)})}s.call(this,{className:"RegisterWindow",title:"",positionInfo:{left:"c",top:"c",width:550,height:600}});var b,w=this,M=this.windowBody,T=function(){},C=null,I=null,A=M.createChild("form",{className:"formWrapper"}),S=A.createChild("div",{className:"fieldWrapper"}),E=S.createChild("div",{className:"label"}),x=S.createChild("div",{className:"inputWrapper"}),L=x.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"text",maxlength:19}})),N=x.createChild("div",{className:"help"});g.addTooltip(N,function(){var e=new _("div");return e.setHtml(r("ui.register.usernameRules")),e});var O=x.createChild("div",{className:"error"});g.addTooltip(O,function(){return new _("div",{text:r("tablet.register.usernameInvalid")})});var D=A.createChild("div",{className:"fieldWrapper"}),R=D.createChild("div",{className:"label"}),P=D.createChild("div",{className:"inputWrapper"}),B=P.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"password",maxlength:49}})),k=P.createChild("div",{className:"help"});g.addTooltip(k,function(){var e=new _("div");return e.setHtml(r("ui.register.pwdRules")),e});var F=P.createChild("div",{className:"error"});g.addTooltip(F,function(){return new _("div",{text:r("tablet.register.confirmpwdNotSame")})});var z=A.createChild("div",{className:"fieldWrapper"}),H=z.createChild("div",{className:"label"}),q=z.createChild("div",{className:"inputWrapper"}),W=q.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"password",maxlength:49}})),U=q.createChild("div",{className:"error"});g.addTooltip(U,function(){return new _("div",{text:r("tablet.register.confirmpwdNotSame")})});var Y=A.createChild("div",{className:"fieldWrapper"}),G=Y.createChild("div",{className:"label"}),j=Y.createChild("div",{className:"inputWrapper"}),V=j.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"email"}})),X=j.createChild("div",{className:"error"});g.addTooltip(X,function(){return new _("div",{text:r("tablet.register.emailInvalid")})});var Q=A.createChild("div",{hidden:!0,className:"fieldWrapper"}),K=Q.createChild("div",{className:"label"}),J=Q.createChild("div",{className:"inputWrapper"}),Z=J.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"email"}})),$=J.createChild("div",{className:"error"});g.addTooltip($,function(){return new _("div",{text:r("tablet.register.emailParentInvalid")})});var ee=A.createChild("div",{className:"fieldWrapper"}),te=ee.createChild("div",{className:"label"}),ie=ee.createChild("div",{className:"inputWrapper"}),ne=ie.appendChild(new a({className:["inputText","whiteStyle"],attr:{type:"text",maxlength:29}})),oe=ie.createChild("div",{className:"help"});g.addTooltip(oe,function(){var e=new _("div");return e.setHtml(r("ui.register.nicknameRules")),e});var se=ie.createChild("div",{className:"error"});g.addTooltip(se,function(){return new _("div",{text:r("tablet.register.pseudoInvalid")})});var ae=A.createChild("div",{className:"touWrapper"}),re=ae.appendChild(new d),le=A.createChild("div",{className:"touLinksWrapper"});le.createChild("span",{text:" ("});var ce=le.appendChild(new l({className:"link"}));le.createChild("span",{text:", "});var ue=le.appendChild(new l({className:"link"}));le.createChild("span",{text:")"});for(var de=M.createChild("div",{className:"info"}),he=M.createChild("div",{className:"suggestion"}),pe=he.createChild("label",{className:"label"}),me=0;me<v;me++)he.createChild("span",{className:"set"});var fe=M.createChild("div",{className:"buttonContainer"}),ge=fe.appendChild(new c);L.on("blur",i),B.on("blur",i),W.on("blur",i),V.on("blur",i),Z.on("blur",i),ne.on("blur",i),re.on("change",i),L.on("validate",function(){B.focus()}),B.on("validate",function(){W.focus()}),W.on("validate",function(){V.focus()}),V.on("validate",function(){e()?Z.focus():ne.focus()}),ne.on("validate",function(){ge.tap()}),ce.on("tap",n),ue.on("tap",n),ge.on("tap",function(){if(!i())return!1;if(ge.disable(),de.setText(r("ui.common.waiting")),he.delClassNames("visible"),de.delClassNames("error"),b)return y();var e=window.Config,t=e.language||"en",n=e.recaptcha.ankamaUrl,o=n+"/"+t+"/captcha",s={origin:n,src:o,lang:t,callback:y};f.open("recaptcha",s)}),this.on("open",function(t){O.hide(),F.hide(),U.hide(),X.hide(),$.hide(),se.hide(),T=t.onValidate,b=t.guestAccount,C=t.birthDateRegistrationLimitTimestamp,I=t.selectedBirthDateTimestamp,ge.disable(),E.setText(r("tablet.login.username")),R.setText(r("ui.login.password")),G.setText(r("tablet.register.email")),K.setText(r("tablet.register.emailParent")),H.setText(r("tablet.register.confirmpwd")),te.setText(r("tablet.login.pseudo")),re.setText(r("tablet.legals.accept")),ce.setText(r("tablet.legals.tou")),ce.link=r("tablet.legals.link.tou"),ue.setText(r("tablet.legals.gcs")),ue.link=r("tablet.legals.link.gcs"),ge.setText(r("ui.common.validation")),pe.setText(r("tablet.register.suggestion")),p.setAutomaticHide(!1),Q.toggleDisplay(e()),b?w.setTitle(r("tablet.oldGuest.register")):w.setTitle(r("ui.login.createAccount"))}),this.on("opened",function(){L.focus()}),this.on("close",function(e){return L.setValue(""),B.setValue(""),V.setValue(""),W.setValue(""),ne.setValue(""),ne.enable(),de.setText(""),de.delClassNames("error"),he.delClassNames("visible"),p.setAutomaticHide(!0),b=null,C=null,I=null,T(e)})}i(1328);var o=i(191).inherits,s=i(233),a=i(582),r=i(29).getText,l=i(246),c=l.DofusButton,u=i(283),d=i(676),h=i(31),p=i(482),m=i(252),f=i(225),g=i(248),_=i(235),v=3;o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(){E.disable(),v&&y&&E.enable()}function t(e,t,i){t--;var n=new Date(e,t,i);return n.getFullYear()===e&&n.getMonth()===t&&n.getDate()===i}function i(){E.disable();var i=T.getValue(),n=C.getValue(),o=I.getValue();if(i&&n&&o){var s=i+"-"+f.leadWithZero(n)+"-"+f.leadWithZero(o)+"T00:00Z",a=new Date(s);y=a.getTime();var r=Date.now(),l=!t(parseInt(i,10),parseInt(n,10),parseInt(o,10))||isNaN(y)||y>r;A.toggleDisplay(l),l&&(y=null),e()}}u.call(this,{className:"BirthdayLimitWindow",title:"",positionInfo:{left:"c",top:"c",width:450,height:200}});var n,o=this,l=this.windowBody,g=function(){},_=g,v=null,y=null,b=l.createChild("div",{className:"birthdayWrapper"}),w=b.createChild("div",{className:"label"}),M=b.createChild("div",{className:"birthdayWrapperInput"}),T=M.appendChild(new h({className:["inputText","whiteStyle","year"],attr:{type:"number"}}));M.createChild("div",{className:"birthdaySeparator",text:"/"});var C=M.appendChild(new h({className:["inputText","whiteStyle"],attr:{type:"number"}}));M.createChild("div",{className:"birthdaySeparator",text:"/"});var I=M.appendChild(new h({className:["inputText","whiteStyle"],attr:{type:"number"}})),A=M.createChild("div",{className:"error"});p.addTooltip(A,function(){return new m("div",{text:a("ui.register.invalidDate")})}),T.on("change",i),C.on("change",i),I.on("change",i);var S=l.createChild("div",{className:"buttonContainer"}),E=S.appendChild(new s);E.on("tap",function(){E.disable(),d.open("register",{onValidate:_,guestAccount:n,birthDateRegistrationLimitTimestamp:v,selectedBirthDateTimestamp:y}),o.close()}),T.on("validate",function(){C.focus()}),C.on("validate",function(){I.focus()}),I.on("validate",function(){E.tap()}),this.on("open",function(t){A.hide(),T.setPlaceholder(a("ui.common.placeholder.year")),C.setPlaceholder(a("ui.common.placeholder.month")),I.setPlaceholder(a("ui.common.placeholder.day")),_=t.onValidate,n=t.guestAccount,b.show(),w.setText(a("tablet.login.birthday")),E.disable(),E.setText(a("ui.common.validation")),v=null,c.setAutomaticHide(!1),n?o.setTitle(a("tablet.oldGuest.register")):o.setTitle(a("ui.login.createAccount")),r.registerOpenRequest(function(t,i){if(t)return console.error("BirthdayLimitWindow: registerOpenRequest",t);var n=new Date(i.value);v=n.getTime(),isNaN(v)&&(console.error(new Error("Invalid Date for birth date limit: dateFormat "+i.value)),v=null),e()})}),this.on("close",function(e){c.setAutomaticHide(!0),n=null,_(e),_=g})}i(1330);var o=i(246),s=o.DofusButton,a=i(29).getText,r=i(283),l=i(191).inherits,c=i(482),u=i(233),d=i(225),h=i(582),p=i(248),m=i(235),f=i(28);l(n,u),e.exports=n},function(e,t){},function(e,t,i){function n(){function e(){_.isActivate()?b.enable():b.disable()}function t(){u.openUrlInAppBrowser(this.link)}s.call(this,{className:"LegalAgreementWindow",title:"",positionInfo:{left:"c",top:"c",width:525,height:200,isFullScreen:!0},noCloseButton:!0}),this._canceled=!0;var i=this,n=this.windowBody,o=function(){},h=o,p=n.createChild("div",{className:"textWrapper"}),m=n.createChild("div",{className:"checkboxWrapper"}),f=p.appendChild(new r({className:"link"}));p.createChild("span",{text:", "});var g=p.appendChild(new r({className:"link"})),_=m.appendChild(new c),v=n.createChild("div",{className:"buttonContainer"}),y=v.appendChild(new l);y.addClassNames("cancel");var b=v.appendChild(new l);_.on("change",e),f.on("tap",t),g.on("tap",t),b.on("tap",function(){y.disable(),b.disable(),i._canceled=!1,i.close()}),y.on("tap",function(){i.close()}),this.on("open",function(e){h=e.onValidate,b.disable(),y.enable(),i.windowTitle.setText(a("ui.connection.legalAgreement")),_.setText(a("tablet.legals.accept")),f.setText(a("tablet.legals.tou")),f.link=a("tablet.legals.link.tou"),g.setText(a("tablet.legals.gcs")),g.link=a("tablet.legals.link.gcs"),y.setText(a("ui.common.cancel")),b.setText(a("ui.common.validation"))}),this.on("close",function(e){return i._canceled?void _.deactivate():(d.setValue("guestAgreement",!0,1,!0),h(e),void(h=o))})}i(1332);var o=i(191).inherits,s=i(233),a=i(29).getText,r=i(246),l=r.DofusButton,c=i(676),u=i(252),d=i(195);o(n,s),e.exports=n},function(e,t){},function(e,t,i){function n(){if(!navigator.connection)return!1;var e=window.Connection?window.Connection.WIFI:"wifi",t=navigator.connection.type;return t===e}function o(e){var t=this;e=e||{className:"preloadMapWindow",customClose:!0,positionInfo:{left:"c",top:"c",width:700,height:460,isModal:!0}},I.call(this,e),this._clearState(),this.closeButton.on("tap",function(){t._tryClose()});var i=this._mapPreloader=new b;i.on("step",function(e){t._updateState({progress:e.percent,downloadEstimate:{count:e.count,nbTotalMaps:e.nbTotalMaps,secondLeft:e.secondLeft}})}),i.on("error",function(e){console.error(e),t._updateState({currentScreen:E.ERROR})}),i.on("end",function(){t._updateState({currentScreen:E.DOWNLOAD_DONE})}),i.on("stop",function(){var e=t._state.currentScreen;e===E.DOWNLOAD_STOP&&t._tryClose()}),this.on("open",function(){w.start();var e=!!t.windowBody.getChildCount();e||t._createDom(),t._clearState(),t._updateState({isWiFiActivated:n(),currentScreen:E.DISCLAIMER}),t.startWifiCheckTimeout()}),this.on("close",function(){w.stop(),t.stopWifiCheckTimeout()});var o=window.gui;o.on("appGoBackground",function(){var e=t._state.currentScreen;e===E.DOWNLOAD_ACTIVE&&i.stop()}),o.on("appLeaveBackground",function(){var e=t._state.currentScreen;e===E.DOWNLOAD_ACTIVE&&i.restart()})}function s(e){this._state.isWiFiActivated=e,this._wifiState.toggleClassName("on",!!e),this._updateWifiStateText(e)}function a(e){switch(this._updateState({previousScreen:this._state.currentScreen}),this._state.currentScreen=e,this._hideAll(),this.closeButton.enable(),e){case E.DISCLAIMER:this._advice.show(),this._wifiState.show(),this._disclaimerText.show(),this._downloadButton.show(),this._downloadButton.enable(),this._cancelButton.show();break;case E.DOWNLOAD_PREPARE:this._downloading.show(),this._checkingAssetsText.show(),this._downloadWifiState.show(),this._progressBar.show(),this._stopButton.show(),this._stopButton.enable(),this._checkAssetsVersion();break;case E.DOWNLOAD_STOP:this.closeButton.disable(),this._downloading.show(),this._stoppingDownload.show(),this._downloadWifiState.show(),this._progressBar.show(),this._stopButton.show(),this._stopButton.disable();break;case E.DOWNLOAD_ACTIVE:this._downloading.show(),this._downloadEstimate.show(),this._downloadWifiState.show(),this._progressBar.show(),this._stopButton.show(),this._stopButton.enable(),this._state.hasStartedDownloading?this._retryDownloading():this._startDownloading();break;case E.DOWNLOAD_DONE:this._downloaded.show(),this._downloadEstimate.show(),this._downloadWifiState.show(),this._progressBar.show(),this._continueButton.show();break;case E.ERROR:this._downloading.show(),this._downloadError.show(),this._retryButton.show(),this._retryButton.enable(),this._cancelButton.show()}}function r(e){this._state.previousScreen=e}function l(e){this._state.progress=e,this._progressBar.setValue(e)}function c(e){if(!e&&0!==e)return v("tablet.common.computingTimeLeft");var t=[],i=Math.floor(e/L)%N;i&&t.push(i+" "+v("ui.time.minutes",i));var n=Math.floor(e/O);if(n)t.unshift(n+" "+v("ui.time.hours",n));else{var o=(e<0?0:e)%L;t.push(o+" "+v("ui.time.seconds",o))}return v("tablet.common.endsIn",t.join(" "))}function u(e,t){return t||(t="?"),v("tablet.common.mapsPlural",e+"/"+t)}function d(e){this._state.downloadEstimate=e;var t,i=e.count,n=e.nbTotalMaps;t=i===n?v("tablet.common.done"):c(e.secondLeft);var o=u(i,n);this._downloadEstimate.setText(v("tablet.common.hyphenSeparation",t,o))}function h(e){this._state.hasStartedDownloading=e}function p(e){this._state.wifiCheckTimeout&&(this._state.wifiCheckTimeout=window.clearTimeout(this._state.wifiCheckTimeout)),this._state.wifiCheckTimeout=e}function m(e){return e.json()}function f(e,t){var i=window.Config.dataUrl+"/assetsVersions.json?"+T.stringify(e);window.fetch(i).then(m).then(function(e){t(null,e)})["catch"](t)}i(1334);var g=i(1335),_=i(246),v=i(29).getText,y=i(191).inherits,b=i(911),w=i(377),M=i(605),T=i(39),C=i(30),I=i(233),A=i(184).TOTAL_MAP_ASSETS_SIZE_IN_GB,S=1e4,E={DISCLAIMER:0,DOWNLOAD_PREPARE:1,DOWNLOAD_ACTIVE:2,DOWNLOAD_STOP:3,DOWNLOAD_DONE:4,ERROR:5};y(o,I),e.exports=o,o.prototype._clearState=function(){this._state={currentScreen:null,downloadEstimate:null,hasStartedDownloading:!1,isWiFiActivated:!1,previousScreen:null,progress:0,wifiCheckTimeout:null}},o.prototype.freeContent=function(){this._advice=null,this._wifiState=null,this._disclaimerText=null,this._downloading=null,this._downloadingFirstLine=null,this._downloadingSecondLine=null,this._downloaded=null,this._downloadError=null,this._checkingAssetsText=null,this._stoppingDownload=null,this._downloadEstimate=null,this._downloadWifiState=null,this._progressBar=null,this._downloadButton=null,this._cancelButton=null,this._stopButton=null,this._continueButton=null,this._retryButton=null,this.windowBody.clearContent()},o.prototype._createDom=function(){var e=this,t=this.windowBody;t.createChild("div",{className:"screenshot"}),this._advice=t.createChild("div",{className:"advice"});var i=t.createChild("div",{className:"disclaimer"});this._wifiState=i.createChild("div",{className:"wifiState"}),this._disclaimerText=i.createChild("div",{className:"disclaimerText"}),this._downloading=t.createChild("div",{className:"downloading"}),this._downloadingFirstLine=this._downloading.createChild("div"),this._downloadingSecondLine=this._downloading.createChild("div",{className:"redLine"}),this._downloaded=t.createChild("div",{className:"downloaded"}),this._downloadError=t.createChild("div",{className:"downloadError"});var n=t.createChild("div",{className:"preloadBarBlock"});this._checkingAssetsText=n.createChild("div"),this._stoppingDownload=n.createChild("div"),this._downloadEstimate=n.createChild("div"),this._downloadWifiState=n.createChild("div",{className:"downloadWifiState"}),this._progressBar=n.appendChild(new M({className:["green"],epsilon:0}));var o=t.createChild("div",{className:"buttonContainer"});this._downloadButton=o.appendChild(new _({className:["greenButton"]},function(){e._downloadButton.disable(),e._updateState({currentScreen:E.DOWNLOAD_PREPARE})})),this._retryButton=o.appendChild(new _({className:["greenButton"]},function(){e._retryButton.disable(),e._updateState({currentScreen:e._state.previousScreen})})),this._cancelButton=o.appendChild(new _({className:["greenButton","greyButton"]},function(){e._tryClose()})),this._stopButton=o.appendChild(new _({className:["greenButton","greyButton"]},function(){e._stopButton.disable(),e._tryClose()})),this._continueButton=o.appendChild(new _({className:["greenButton"]},function(){e._tryClose()})),this._updateText(this._state.isWiFiActivated)},o.prototype._hideAll=function(){this._advice.hide(),this._wifiState.hide(),this._disclaimerText.hide(),this._downloading.hide(),this._downloaded.hide(),this._downloadError.hide(),this._checkingAssetsText.hide(),this._stoppingDownload.hide(),this._downloadEstimate.hide(),this._downloadWifiState.hide(),this._progressBar.hide(),this._downloadButton.hide(),this._cancelButton.hide(),this._stopButton.hide(),this._continueButton.hide(),this._retryButton.hide()};var x={currentScreen:a,downloadEstimate:d,hasStartedDownloading:h,isWiFiActivated:s,previousScreen:r,progress:l,wifiCheckTimeout:p};o.prototype._updateState=function(e){for(var t in e){var i=x[t];i&&this._state[t]!==e[t]&&i.call(this,e[t])}};var L=60,N=60,O=N*L;o.prototype.startWifiCheckTimeout=function(){var e=this,t=window.setTimeout(function(){e._updateState({isWiFiActivated:n()}),e.startWifiCheckTimeout()},S);this._updateState({wifiCheckTimeout:t})},o.prototype.stopWifiCheckTimeout=function(){this._updateState({wifiCheckTimeout:null})},o.prototype._updateText=function(e){this.setTitle(v("tablet.preload.title"));var t=v("tablet.common.acronymGigabytes",A);this._advice.setText(v("tablet.preload.advice",t)),this._disclaimerText.setText(v("tablet.preload.disclaimer")),this._downloadingFirstLine.setText(v("tablet.preload.downloading")),this._downloadingSecondLine.setText(v("tablet.preload.downloadingWarning")),this._downloaded.setText(v("tablet.preload.done")),this._downloadError.setText(v("tablet.preload.error")),this._checkingAssetsText.setText(v("tablet.preload.checkingAssets")),this._stoppingDownload.setText(v("tablet.common.stopping")),this._downloadButton.setText(v("tablet.common.downloadSize",t)),this._cancelButton.setText(v("ui.common.cancel")),this._stopButton.setText(v("tablet.common.stop")),this._continueButton.setText(v("tablet.common.continue")),this._retryButton.setText(v("tablet.common.retry")),this._updateWifiStateText(e)},o.prototype._updateWifiStateText=function(e){var t=v(e?"tablet.common.activated":"tablet.common.deactivated");this._wifiState.setText(t);var i=e?'<span class="on">'+t+"</span>":t;this._downloadWifiState.setHtml(v("tablet.common.wifiState",i))},o.prototype._tryClose=function(){var e=this._state.currentScreen;return e===E.DOWNLOAD_PREPARE?this._updateState({currentScreen:E.DOWNLOAD_STOP}):e===E.DOWNLOAD_ACTIVE?(this._updateState({currentScreen:E.DOWNLOAD_STOP}),this._mapPreloader.stop()):void this.close()},o.prototype._hasStopped=function(){return this._state.currentScreen===E.DOWNLOAD_STOP},o.prototype._checkAssetsVersion=function(){function e(e){console.error(e),t._updateState({currentScreen:E.ERROR})}var t=this;this._updateState({progress:0}),g.getVersions(function(i,n){return i?e(i):t._hasStopped()?t._tryClose():(t._updateState({progress:.33}),void f(n,function(i,n){return i?e(i):t._hasStopped()?t._tryClose():(t._updateState({progress:.67}),void g.upgradeAssets(n,function(i){return i?e(i):t._hasStopped()?t._tryClose():void t._updateState({progress:1,currentScreen:E.DOWNLOAD_ACTIVE})}))}))})},o.prototype._startDownloading=function(){var e=this;e._updateState({hasStartedDownloading:!0,progress:0,downloadEstimate:{count:0}}),C.getAllDataMap("Areas",function(t,i){if(t)return console.error(t);if(e._hasStopped())return e._tryClose();var n=[];for(var o in i)n.push(i[o].id);e._mapPreloader.preloadAreas(n)})},o.prototype._retryDownloading=function(){this._mapPreloader.restart()}},function(e,t){},function(e,t,i){function n(e,t,i){function n(e){return e||0===e||(e=t),i(null,e)}function o(e){return i(e)}var a=window.plugins&&window.plugins.appPreferences;if(a)return a.fetch(n,o,e);var r;try{r=window.localStorage.getItem(e)}catch(l){return s.setImmediate(function(){return o(l)})}return s.setImmediate(function(){return n(r)})}function o(e,t,i){var n=window.plugins&&window.plugins.appPreferences;if(n)return n.store(function(){i()},i,t,e);try{window.localStorage.setItem(t,e)}catch(o){return s.setImmediate(function(){return i(o)})}return s.setImmediate(i)}var s=i(31),a=i(30),r="plugins.wizassets.assetsversion",l="client.main.staticdataversion",c="0.0.0",u="1";t.upgradeAssets=function(e,t){function i(t){function i(){return o(n,r,t)}var n=e.assetsVersion;if(!n)return t();var s=window.wizAssets;return s?s.deleteFiles(e.changedFiles,i,t):i()}function n(t){var i=e.staticDataVersion;return i?void a.eraseDiskCache(function(e){return e?t(e):void a.initializeDiskCache(function(){console.info("Updating staticDataVersionKey to "+i),o(i,l,t)})}):t()}return e.staticDataVersion||e.assetsVersion?void s.series([n,i],function(e){return e?t(e):t()}):t()},t.getVersions=function(e){function t(e,t,i,o){n(t,i,function(t,i){return t?o(t):(a[e]=i,o())})}function i(e){return t("assetsVersion",r,c,e)}function o(e){return t("staticDataVersion",l,u,e)}var a={};s.series([o,i],function(t){return t?e("Could not get the client assets version: "+t):e(null,a)})}},function(e,t,i){function n(){d.call(this,{className:"CleanAssetsWindow",noCloseButton:!0,positionInfo:{left:"c",top:"c",width:500,height:200,isModal:!0}}),this._createdDom=!1,this._progressBar=null;var e=this;this.on("open",function(t){return e._createDom(),e._checkAssetsVersion(function(i){return e.close(),i?(console.error(new Error("cleanAssets "+i)),window.gui.openSimplePopup(r("ui.popup.accessDenied.unknown"),r("ui.popup.accessDenied")),t(i)):t()})})}function o(e){return e.json()}function s(e,t){var i=window.Config.dataUrl+"/assetsVersions.json?"+u.stringify(e);window.fetch(i).then(o).then(function(e){t(null,e)})["catch"](t)}i(1337);var a=i(1335),r=i(29).getText,l=i(191).inherits,c=i(605),u=i(39),d=i(233);l(n,d),e.exports=n,n.prototype.freeContent=function(){this._progressBar=null,this._createdDom=!1,this.windowBody.clearContent()},n.prototype._createDom=function(){if(!this._createdDom){this.setTitle(r("ui.cleanAssets.title"));var e=this.windowBody,t=e.createChild("div",{className:"descriptionBlock"});t.createChild("div",{text:r("ui.cleanAssets.description")});var i=e.createChild("div",{className:"preloadBarBlock"});this._progressBar=i.appendChild(new c({className:["green"],epsilon:0})),this._createdDom=!0}},n.prototype._checkAssetsVersion=function(e){var t=this;this._updateTheProgressBar(0),a.getVersions(function(i,n){return i?e(i):(t._updateTheProgressBar(.33),void s(n,function(i,n){return i?e(i):(t._updateTheProgressBar(.67),void a.upgradeAssets(n,function(i){return i?e(i):(t._updateTheProgressBar(1),e())}))}))})},n.prototype._updateTheProgressBar=function(e){this._progressBar&&this._progressBar.setValue(e)}},function(e,t){},function(e,t,i){function n(){c.call(this,{className:"connectionQueueWindow",positionInfo:{left:"c",top:"c",width:600,height:200},noCloseButton:!0}),this.once("open",this._createContent),this._setupEventListeners()}function o(){var e=window.gui.serversData;return e?e.connectedServerData:null}i(1339);var s=i(246).DofusButton,a=i(29).getText,r=i(191).inherits,l=i(282),c=i(233),u=i(225);r(n,c),e.exports=n,n.prototype._setupEventListeners=function(){var e=this;window.dofus.connectionManager.on("LoginQueueStatusMessage",function(t){e._queueStatusUpdate("login",t.position,t.total)}),window.dofus.connectionManager.on("QueueStatusMessage",function(t){e._queueStatusUpdate("game",t.position,t.total)})},n.prototype._createContent=function(){this.windowTitle.setText(a("ui.queue.wait"));
var e=this.windowBody.createChild("div",{className:"messageBox"});this.message=e.createChild("div",{className:"message"});var t=this.windowBody.createChild("div",{className:"buttonContainer"}),i=t.appendChild(new s(a("ui.queue.back"))),n=this;i.on("tap",function(){return o()?(l.goBackToSelectionOf("server"),void u.close(n.id)):window.dofus.disconnect()})},n.prototype._queueStatusUpdate=function(e,t,i){if(0===t)return u.close(this.id);u.open(this.id);var n=a("ui.queue.number",t,i),s=o();s&&(n+="\n\n"+a("ui.queue.server",s._name)),this.message.setText(n)}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"popupWindow",title:"Popup",customClose:!0,positionInfo:{left:"c",bottom:"c",width:600,height:210}}),this.messageStack=[]}i(1341);var o=i(191).inherits,s=i(233),a=i(225),r=i(246).DofusButton,l=i(29).getText,c=i(678);o(n,s),e.exports=n,n.prototype._createContent=function(){function e(){return t.messageStack.shift(),0===t.messageStack.length?void a.close(t.id):void t._update()}var t=this,i=this.windowBody.createChild("div",{className:"messageBox"});this.message=i.createChild("div",{className:"message"});var n=this.windowBody.createChild("div",{className:"buttonContainer"}),o=n.appendChild(new r(l("ui.common.ok")));o.on("tap",e),this.closeButton.on("tap",e)},n.prototype._update=function(){this.message||this._createContent(),this.message.clearContent();var e=this.messageStack[0],t=e.message.split("<br>").length<=2?"center":"left";this.message.setStyle("text-align",t),this.message.appendChild(c.process(e.message,{isNonChat:!0})),this.windowTitle.setText(e.title)},n.prototype.addContent=function(e){var t=this.messageStack;if(t.length){var i=t[t.length-1];if(i.message===e.message&&i.title===e.title)return}t.push(e),1===t.length&&this._update()}},function(e,t){},function(e,t,i){function n(){s.call(this,{className:"RecaptchaWindow",positionInfo:{left:"c",top:10,width:400,height:175,isFullScreen:!0,isModal:!0},noCloseButton:!0});var e=this;this.recaptcha=this.windowBody.createChild("iframe");var t=window.dofus.connectionManager;this.on("open",function(t){var i=t.callback;delete t.callback,e.update(t,i)}),t.on("RecaptchaRequestMessage",function(t){function i(e){window.dofus.send("recaptchaResponse",e)}var n=window.Config,o=n.recaptcha.proxyUrl,s={origin:o,sitekey:t.enrichData.sitekey,src:o+r,lang:n.language||"en",callback:i};a.open(e.id,s)})}i(1343);var o=i(191).inherits,s=i(233),a=i(225),r="/recaptcha";o(n,s),e.exports=n,n.prototype.update=function(e,t){e.type="recaptchaLoad";var i=this,n=this.recaptcha.rootElement;n.onload=function(){n.contentWindow.postMessage(e,e.origin)},window.addEventListener("message",function o(n){if(n.origin===e.origin){var s=n.data;return"recaptchaShow"===s.type?i.recaptcha.show():(window.removeEventListener("message",o),a.close("recaptcha"),t(s))}}),n.src=e.src}},function(e,t){},function(e,t){var i=0,n=!1,o=function(e){for(var t=e.target;t!==document.body;){var n=window.getComputedStyle(t),o=n.getPropertyValue("-webkit-overflow-scrolling"),s=n.getPropertyValue("overflow-y"),a=parseInt(n.getPropertyValue("height"),10),r="touch"===o&&("auto"===s||"scroll"===s),l=t.scrollHeight>t.offsetHeight;if(r&&l){var c=e.touches?e.touches[0].screenY:e.screenY,u=i<=c&&0===t.scrollTop,d=i>=c&&t.scrollHeight-t.scrollTop===a;return void((u||d)&&e.preventDefault())}t=t.parentNode}e.preventDefault()},s=function(e){i=e.touches?e.touches[0].screenY:e.screenY},a=function(){window.addEventListener("touchstart",s,!1),window.addEventListener("touchmove",o,!1),n=!0},r=function(){window.removeEventListener("touchstart",s,!1),window.removeEventListener("touchmove",o,!1),n=!1},l=function(){return n},c=document.createElement("div");document.documentElement.appendChild(c),c.style.WebkitOverflowScrolling="touch";var u="touch"===window.getComputedStyle(c)["-webkit-overflow-scrolling"];document.documentElement.removeChild(c),u&&a();var d={enable:a,disable:r,isEnabled:l};e.exports=d},function(e,t,i){i(1346),i(1384),i(1387),i(1392),i(1394),i(1395),i(1396),i(1397),e.exports=i(1347)},function(e,t,i){var n=i(1347),o=i(894),s=o.compressPath,a=i(225),r=i(29).getText,l=i(271),c=i(269),u=3e3,d=1e3,h=[23,24,25];n.prototype.onArrived=function(e){if(window.dofus.sendMessage("GameMapMovementConfirmMessage",null),this.mapRenderer.removeMovementFeedback(),this.endMovementCallback){var t=this.endMovementCallback;this.endMovementCallback=null,t(null,e)}},n.prototype.cancelUserActorMovement=function(e){if(this.isMovementWaitingForConfirmation)return this.lastMoveRequestTime&&!a.isDialogActive()&&Date.now()-this.lastMoveRequestTime>d&&window.gui.connectionSplashScreen.onStateChange("UNSTABLE"),this.endMovementCallback=e,void(this.isMovementCanceled=!0);this.isMovementCanceled=!1;var t=this.actorManager.userActor;return t.moving?(this.mapRenderer.removeMovementFeedback(),this.endMovementCallback=null,void t.cancelMovement(e)):(this.endMovementCallback=e,this.onArrived())},n.prototype.cancelMoveAndDo=function(e){return this.actorManager.userActor.moving||this.isMovementWaitingForConfirmation?this.cancelUserActorMovement(e):e()},n.prototype.roleplayUserActorMovement=function(e){var t=e[e.length-1],i=this.actorManager.userActor;if(this.isMovementWaitingForConfirmation=!1,window.gui.connectionSplashScreen.onStateChange("CONNECTED"),window.gui.emit("checkServerLag","roleplayUserActorMovement","stop"),this.isMovementCanceled)return this.cancelUserActorMovement(this.endMovementCallback);if(!i.moving){for(var n=null,o=0;o<e.length;o++)if(e[o]===i.cellId){n=o;break}if(null===n)return i.cellId!==t&&i.setDisposition(t),this.onArrived(t);if(i.cellId===t)return i.setDisposition(t),this.onArrived(t);var s=e.slice(n);i.setPath(s),i.setCellPosition(s[s.length-1])}this.removeAllListeners("arrived"),this.once("arrived",this.onArrived);var a=[];if(!i.isPathMatchingServerPath(e,a)){if(0!==a.length){this.endMovementCallback=null;var r=this;return i.switchPath(a,function(){r.emit("arrived",t)})}return i.noMovement(),i.setDisposition(t),this.endMovementCallback=null,this.onArrived(t)}},n.prototype._movePlayerOnMap=function(e,t,i){if(i&&"function"==typeof i||(i=function(){}),window.gui.playerData.inventory.isOverloaded()&&!window.gui.playerData.isMutant())return void window.gui.chat.logMsg(r("tablet.inventoryFullCannotMove"));t=t||!1;var n=this.actorManager.userActor,a=n.cellId;if(a===e)return i(null,e),e;for(var l=0;l<h.length;l++)if(n.look.bonesId===h[l])return null;var c=this.mapRenderer.map,u=this.actorManager.occupiedCells,d=n.canMoveDiagonally,p=o.getPath(a,e,u,d,t);if(p.length<=1)return i(new Error("_movePlayerOnMap noPath:"+a+":"+e)),null;this.isMovementWaitingForConfirmation=!0,this.lastMoveRequestTime=Date.now(),window.gui.emit("checkServerLag","roleplayUserActorMovement","start"),window.dofus.sendMessage("GameMapMovementRequestMessage",{keyMovements:s(p),mapId:c.id});var m=p[p.length-1],f=this;this.mapRenderer.addMovementFeedback(m),this.endMovementCallback=i,n.setPath(p,{cb:function(){f.emit("arrived",m)}});var g=this.mapScene.camera;return g.setAcceleration(1),n.pathTween.removeOnUpdate(),n.onMovementUpdate=function(){g.moveTo(n.x,n.y)},n.pathTween.onUpdate(n.onMovementUpdate),this.userPreviousPosition=n.cellId,n.setCellPosition(m),m},n.prototype.cancelCameraMovement=function(){var e=this.actorManager.userActor;e.pathTween.removeOnUpdate(e.onMovementUpdate)},n.prototype.noMovement=function(){c.isFightMode||(console.warn("[ISO ENGINE] previous movement request has been refused, canceling movement"),this.onQuickReconnection())},n.prototype.getChangeMapCellAt=function(e,t,i){var n=this.mapScene.convertCanvasToSceneCoordinate(e,t);if(!this.mapRenderer.isReady)return-1;var o=this.mapRenderer.getCellId(n.x,n.y);return this.mapRenderer.getChangeMapFlags(o.cell)[i]?o.cell:-1},n.prototype._requestMapChange=function(e,t){window.foreground.lock("loadMap"),window.dofus.sendMessage("ChangeMapMessage",{mapId:e}),this.launchMapTransition(t);var i=this;this.changeMapTimeout=window.setTimeout(function(){l.unlockMessages(),i.changeMapTimeout=null;var e=window.foreground;e.unlock("loadMap"),e.hideBorderArrow(),i.cancelMapTransition(t)},u)},n.prototype.gotoNeighbourMap=function(e,t,i,n){function o(i,n){i||n!==t||s._requestMapChange(s.mapRenderer.map[e+"NeighbourId"],e)}var s=this;if(this.actorManager.userActor.moving)return this.cancelUserActorMovement(function(){s.gotoNeighbourMap(e,t,i,n)});var a=window.gui.tutorialManager;if(!a.inTutorial||a.isChangingMap){var r=this._movePlayerOnMap(t,!1,o);r===t&&window.foreground.showBorderArrow(e,i,n)}},n.prototype.clearPendingMovement=function(){this.isMovementWaitingForConfirmation=!1,this.endMovementCallback=null,this.isMovementCanceled=!1}},function(e,t,i){function n(){s.call(this);var e=document.createElement("canvas");e.id="engineCanvas";var t=document.getElementById("dofusBody");t.appendChild(e),this.mapScene=new l({canvas:e,name:"mapScene",l:-a.HORIZONTAL_OFFSET,t:-a.VERTICAL_OFFSET,w:a.MAP_SCENE_WIDTH,h:a.MAP_SCENE_HEIGHT,canvasWidth:0,canvasHeight:0,maxZoom:a.MAX_ZOOM_MAP,pixelRatio:a.PIXEL_RATIO,textureRatio:a.PRERENDER_RATIO_MAP,cameraAcceleration:1.15,nbCacheableSprites:a.MAX_SPRITES_BUFFER_MAP,textureMemoryCacheSize:a.MAX_TEXTURE_MEMORY_MAP,prerenderQualityRatio:a.PRERENDER_RATIO_MAP,adjustToCanvasRatio:!0,usePrecisionRendering:!0});var i={scene:this.mapScene,layer:a.MAP_LAYER_BACKGROUND,position:-1,x:-a.HORIZONTAL_OFFSET,y:-a.VERTICAL_OFFSET,w:a.MAP_SCENE_WIDTH,h:a.MAP_SCENE_HEIGHT,id:"mapBackground"};this.renderer=this.mapScene.renderer,this.background=new u(i),this.actorManager=new d({isoEngine:this,scene:this.mapScene}),this.mapRenderer=new c(this.mapScene,this.background),this.highlightedElements={},this.isInGame=!1,this.isMovementWaitingForConfirmation=!1,this.endMovementCallback=null,this.isMovementCanceled=!1,this.actionQueue=new g,this.lastContextualMenuSkillId=null,r.start(),this.mapScene.camera.setZoom(0),this._initGridOverlayLayers(),this._previousTurn=!1,this._isUserTurn=!1;var n=this,o=this.background;this.on("GameFightStartMessage",function(){n._resetFightPositionLayer()}),this.on("GameFightEndMessage",function(){n._resetFightPositionLayer(),n._resetSpellRangeLayer(),n._resetSpellEffectLayer(),n._resetWalkLayer(),n._resetWalkAreaLayer(),n._resetEnemyWalkAreaLayer(),o.removeTargetHighlights(),window.foreground.confirmBox.close(),this._isUserTurn=!1}),v.on("gameContextChanged",this.onGameContextChanged.bind(this)),this._initLoadingProgress(),this.bitmapFonts=null,this._currentBannerTweens={backTween:null,textTween:null}}var o=i(191).inherits,s=i(209).EventEmitter,a=i(184),r=i(1114),l=i(1110),c=i(1348),u=i(1358),d=i(1365),h=i(1368),p=i(437),m=i(225),f=i(471),g=i(1383),_=i(271),v=i(269);o(n,s),e.exports=n,n.prototype._loadBitmapFonts=function(){if(null===this.bitmapFonts){var e=this;f.loadModel("bitmapFonts","atlas",function(t,i){var n=e.mapScene.createTexture(i,"atlas","mimap","permanent");e.bitmapFonts={characters:{dimensions:t.characters,texture:n},numbers:{dimensions:t.numbers,texture:n}}})}},n.prototype.initialize=function(){h.initialize(this),this.mapRenderer.initialize(),this.actionQueue.initialize(),p.loadMissingTemplatesInfo(),this._loadBitmapFonts()},n.prototype._activateMapScene=function(){return this.isInGame===!1&&(r.addScene(this.mapScene),r.addScene(this.actorManager),this.isInGame=!0,!0)},n.prototype._deactivateMapScene=function(){return this.isInGame===!0&&(this.mapScene.clear(0,0,0,0),r.removeScene(this.mapScene),r.removeScene(this.actorManager),this.clearUserMovementZone(),this.background.resetAndClear(),this.releaseMap(),this.interactiveDisconnect(),this.isInGame=!1,!0)},n.prototype.disconnect=function(){_.unlockMessages(),this.emit("disconnect"),this._deactivateMapScene(),this.mapTransitionDisconnect(),this.background&&this.background.gridAnimator&&this.background.gridAnimator.clear(),this.clearPendingMovement(),this.actionQueue.clear(),this.actorManager.turnNicknamesOff()},n.prototype.transmitMessage=function(e){this.emit(e._messageType,e)},n.prototype.releaseMap=function(e){this.isInGame!==!1&&(v.isRoleplayMode&&this.actorManager.removeAllActors(),this.cleanupChallenges(),this.background.releaseMap(),this.mapRenderer.releaseMap(e),this.actionQueue.clear())},n.prototype.onGameContextChanged=function(){this.clearHighlights(),this.clearPendingMovement(),this.actionQueue.clear(),v.isFightMode?(this.cleanupChallenges(),r.removeScene(this.actorManager)):(r.addScene(this.actorManager),this.actorManager.userActor.show(),this.clearUserMovementZone(),this.background.deleteAllZones())},n.prototype.setInteractiveBlink=function(e){this.interactiveBlink=e},n.prototype._updateMapInfoData=function(e,t){this.mapRenderer.setStatedElements(e.statedElements),this.addChallenges(e.fights),this.mapRenderer.setInteractiveElements(e.interactiveElements),this.mapRenderer.updateObstacles(e.obstacles),t&&t.noMovementWaitReset||(this.isMovementWaitingForConfirmation=!1)},n.prototype.onQuickReconnection=function(e){if(!window.gui.isConnected)return e&&e();if(window.gui.playerData&&window.gui.playerData.isFighting)return e&&e();if(this.endMovementCallback=null,this.isMovementCanceled=!1,this.isMovementWaitingForConfirmation=!1,this.mapRenderer.removeMovementFeedback(),this.actionQueue.clear(),m.isDialogActive())return e&&e();window.foreground.lock("quickReconnection"),this.lastMoveRequestTime=null,this.actorManager.pause(),window.dofus.sendMessage("MapInformationsRequestMessage",{mapId:this.mapRenderer.mapId});var t=this;this.once("mapLoaded",function(){if(window.foreground.unlock("quickReconnection"),t.userPreviousPosition){var i=t.userPreviousPosition;window.dofus.sendMessage("GameMapMovementCancelMessage",{cellId:i});var n=t.actorManager.userActor;n.noMovement(),n.setDisposition(i,n.direction)}return t.actorManager.unpause(),e&&e()})},n.prototype.attackActor=function(e){var t=this.actorManager.actors,i=t[e];if(i){var n=i.cellId,o=this.actorManager.userActor,s=function(){window.dofus.sendMessage("GameRolePlayAttackMonsterRequestMessage",{monsterGroupId:e})};return o.cellId===n?s():void this._movePlayerOnMap(n,!1,s)}},n.prototype.updateDimensions=function(e){this.mapScene.setCanvasDimensions(e.mapWidth,e.mapHeight,e.mapLeft,e.mapTop,"absolute")&&this.mapScene.camera.setZoom(0),this.isInGame&&this.mapScene.requireCompleteRefresh()},n.prototype.useItem=function(e,t,i){var n=this.mapScene.convertCanvasToSceneCoordinate(e,t),o=this.mapRenderer.getCellId(n.x,n.y).cell,s=this.actorManager.occupiedCells[o];s&&s.length&&s[0].actorId>=0?window.dofus.sendMessage("ObjectUseOnCharacterMessage",{characterId:s[0].actorId,objectUID:i}):window.dofus.sendMessage("ObjectUseOnCellMessage",{cells:o,objectUID:i})},n.prototype.sendToFightSequence=function(e){this.emit(e._messageType,e)}},function(e,t,i){function n(e,t){s.call(this);var i=this;this.mapId=null,this.map=null,this.mapScene=e,this.background=t,this.grid=new o,y.on("gameContextChanged",this.onGameContextChanged.bind(this)),this.graphics=[],this.statedElements=[],this.interactiveElements={},this.identifiedElements={},this.objects={},this.animatedElements=[],this.paddockProperties=null,this.isReady=!1,v.on("PaddockPropertiesMessage",function(e){i.paddockProperties=e.properties})}var o=i(1349),s=i(209).EventEmitter,a=i(191).inherits,r=i(756),l=i(184),c=i(1350),u=i(430),d=i(759),h=i(1351),p=i(1352),m=i(1353),f=i(890),g=i(894),_=i(1354),v=i(271),y=i(269),b=i(1356),w=i(753),M=i(195),T=l.BACKGROUND_PATH,C=l.FOREGROUND_PATH,I={r:255,g:0,b:0,a:.75},A={r:0,g:0,b:0,a:1},S=1,E=2,x=52,L=-l.CELL_HEIGHT/4,N=131,O=14,D=56,R=224;a(n,s),e.exports=n,n.prototype.initialize=function(){f.initialize()},n.prototype.setMap=function(e,t){var i=e.mapData;this.map=i,this.mapId=i.id,this.grid.initialize(i.cells,y.isRoleplayMode),this.loadMap(e,t)},n.prototype.releaseMap=function(e){e!==this.mapId&&(this.mapScene.clean(),this.isReady=!1,this.graphics=[],this.statedElements=[],this.interactiveElements={},this.identifiedElements={},this.objects={},this.animatedElements=[],this.paddockProperties=null,this.mapId=null,this.map=null)},n.prototype.stopAnimatedElements=function(){for(var e=this.animatedElements,t=0;t<e.length;t++)e[t].stop()},n.prototype.startAnimatedElements=function(){for(var e=this.animatedElements,t=0;t<e.length;t++)e[t].animate()},n.prototype.loadMap=function(e,t){for(var i=e.mapData,n=e.msg,o={},s=n.statedElements,a=0;a<s.length;a++)o[s[a].elementId]=!0;this.graphics=[],this.statedElements=[],this.animatedElements=[];var r=new b(this,t);r.nAssetsToLoad+=1;var c=new h({id:"mapSceneStaticSprites"+this.mapId,scene:this.mapScene,holdsStatics:!0});this.graphics.push(c);var p=i.atlasLayout,m=p.graphicsPositions;r.loadAtlas(p,c);for(var f,g=i.midgroundLayer,_=Object.keys(g),v=0;v<_.length;v++)for(var I=_[v],A=g[I],S=0;S<A.length;S++){var E=A[S];E.position=parseInt(I,10),E.layer=l.MAP_LAYER_PLAYGROUND,E.scene=this.mapScene;var x=E.hue;if(x[0]=1+x[0]/127,x[1]=1+x[1]/127,x[2]=1+x[2]/127,x[3]=1,E.look)if(E.id&&o[E.id])f=r.loadStatedElement(E),this.statedElements.push(f);else{if(!E.anim){console.warn("[MapRenderer.loadMap] Animated Graphic skipped",E);continue}f=r.loadAnimatedGraphic(E),this.animatedElements.push(f),this.graphics.push(f)}else{if(!E.g){console.warn("[MapRenderer.loadMap] Element of unidentified type skipped",E);continue}f=c.addSprite(E,m[E.g])}f.id&&(this.identifiedElements[f.id]=f)}c.finalize(p.width,p.height);var L=this,N=T+i.id+".jpg";if(r.nAssetsToLoad+=1,u.loadTexture(N,function(e){L.background.updateMap(e),r.notifyAssetAsLoaded()},this.mapScene.renderer,"linear"),i.foreground){var O=new d({x:-l.HORIZONTAL_OFFSET,y:-l.VERTICAL_OFFSET,w:l.MAP_SCENE_WIDTH,h:l.MAP_SCENE_HEIGHT,scene:this.mapScene,layer:l.MAP_LAYER_FOREGROUND});this.graphics.push(O);var D=C+i.id+".png";r.nAssetsToLoad+=1,u.loadTexture(D,function(e){if("empty_texture"===e.id){O.remove();var t=L.graphics.indexOf(O);t!==-1&&L.graphics.splice(t,1)}else O.texture=e,O.forceRefresh();r.notifyAssetAsLoaded()},this.mapScene.renderer,"linear")}r.notifyAssetAsLoaded();var R=M.getValue("tacticModeEngaged",!1);R&&y.isFightMode&&w.turnOn()},n.prototype.onGameContextChanged=function(){this.removeMovementFeedback(),y.isFightMode?this.switchGameContextFight():this.switchGameContextRoleplay()},n.prototype.switchGameContextFight=function(){this.stopAnimatedElements();for(var e=0;e<this.statedElements.length;e++){var t=this.statedElements[e];t.changeState(1,!0)}for(var i in this.objects)this.objects[i].remove();this.objects={},this.map&&this.grid.initialize(this.map.cells,!1)},n.prototype.switchGameContextRoleplay=function(){this.startAnimatedElements(),this.map&&this.grid.initialize(this.map.cells,!0)},n.prototype.addObjects=function(e){if(!this.isReady){var t=this,i=this.mapId;return this.once("ready",function(){t.mapId===i&&t.addObjects(e)})}for(var n=0;n<e.length;n++){var o=e[n];if(o.img){var s=this.getCellSceneCoordinate(o.cellId);o.x=s.x-x/2,o.y=s.y-x/2+L,o.position=o.cellId,o.w=x,o.h=x,o.scene=this.mapScene;var a=this.mapScene.createTexture(o.img,"object:"+o.objectGID),r=new d(o,a);this.objects[o.cellId]=r}else console.error("createObjectGfx: no img for "+JSON.stringify(o))}},n.prototype.removeObjects=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=this.objects[i];n&&(n.remove(),delete this.objects[i])}},n.prototype.setInteractiveElements=function(e){this.interactiveElements={};for(var t=0,i=e.length;t<i;t++){var n=e[t];this.interactiveElements[n.elementId]=n}},n.prototype.updateInteractiveElements=function(e){for(var t=this.interactiveElements,i=0;i<e.length;i++){var n=e[i],o=t[n.elementId];o?(o.disabledSkills=n.disabledSkills,o.enabledSkills=n.enabledSkills):console.warn("Interactive element id "+n.elementId+" does not exist.")}},n.prototype.setStatedElements=function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t],o=this.identifiedElements[n.elementId];o?o instanceof c&&(y.isFightMode?(o.state=-1,o.changeState(1)):o.changeState?o.changeState(n.elementState):o.state=n.elementState):console.warn("stated element not identified:"+n.elementId+", cellId="+n.elementCellId)}},n.prototype.updateStatedElements=function(e){for(var t=this.identifiedElements,i=0,n=e.length;i<n;i++){var o=e[i],s=t[o.elementId];s?s.changeState?s.changeState(o.elementState):(console.warn("Identified element "+o.elementId+" is not a stated element."),s.state=o.elementState):console.warn("Identified element "+o.elementId+" not found.")}},n.prototype.getPaddockProperties=function(){return this.paddockProperties},n.prototype.isPaddock=function(e){var t=e.id;if(!t)return!1;var i=this.interactiveElements[t];return!!i&&i.elementTypeId===l.ELEMENT_TYPE_ID.PADDOCK},n.prototype.addArrowsOnCellsOneShot=function(e,t,i,n){for(var o=[],s=0;s<e.length;s++)o[s]=this.getCellSceneCoordinate(e[s]),o[s].x+=t||0,o[s].y+=i||0;p.addArrowsOneShot(o,e,n,this.mapScene)},n.prototype.addTapFeedback=function(e,t){f.addTapFeedback({x:e,y:t})},n.prototype.addMovementFeedback=function(e){var t=this.getCellSceneCoordinate(e);f.addMovementFeedback({x:t.x,y:t.y,position:e})},n.prototype.removeTapFeedback=function(){f.removeTapFeedback()},n.prototype.removeMovementFeedback=function(){f.removeMovementFeedback()},n.prototype.addArrowOnCell=function(e,t,i,n,o){var s=this.getCellSceneCoordinate(e);s.x+=t||0,s.y+=i||0,p.addArrow(s,e,n,this.mapScene,o)},n.prototype.addArrowOnGraphic=function(e,t,i,n,o){if(!e||!e.bbox)return console.warn("addArrowOnGraphic: invalid graphic entity");var s={x:(e.bbox[0]+e.bbox[1])/2+(t||0),y:(e.bbox[2]+e.bbox[3])/2+(i||0)};p.addArrow(s,null,n,this.mapScene,o)},n.prototype.addArrowsSequence=function(e,t,i,n){for(var o=[],s=0;s<e.length;s++)o[s]=this.getCellSceneCoordinate(e[s]),o[s].x+=t||0,o[s].y+=i||0;p.addArrowsSequence(o,e,n,this.mapScene)},n.prototype.removeArrows=function(){p.removeArrows()},n.prototype.addPingPictoOnCell=function(e,t,i){var n=this.getCellSceneCoordinate(t);m.addPingPicto(e,n,t,i)},n.prototype.removePingPicto=function(e){m.removePingPicto(e)},n.prototype.removeAllPingPictos=function(){m.removeAllPingPictos()},n.prototype.addCellHighlight=function(e,t,i,n){i=i||I,n=n||A;for(var o=0,s=t.length;o<s;o+=1){var a=t[o],r="rgba("+i.r+","+i.g+","+i.b+","+i.a+")",l="rgba("+n.r+","+n.g+","+n.b+","+n.a+")";window.background.addZone(new _([a],{color:r,outline:l}),e)}},n.prototype.deleteCellHighlight=function(e){window.background.deleteZoneById(e)},n.prototype.updateObstacles=function(e){if(!this.isReady){var t=this,i=this.mapId;return void this.once("ready",function(){t.mapId===i&&t.updateObstacles(e)})}if(!this.map)return void console.error(new Error("map is null, isReady is "+this.isReady));for(var n=this.map.cells,o=0,s=e.length;o<s;o++){var a=e[o],r=a.obstacleCellId,l=n[r],c=l.l;a.state===S?l.l|=1:a.state===E&&(l.l&=254),this.grid.updateCellState(r,l,c),g.updateCellPath(r,l)}},n.prototype.isWalkable=function(e){var t=y.isFightMode?5:1;return 1===(this.map.cells[e].l&t)},n.prototype.isFarmCell=function(e){return 32===(32&this.map.cells[e].l)},n.prototype.isVisibleCell=function(e){return 64===(64&this.map.cells[e].l)},n.prototype.getChangeMapFlags=function(e){if(!this.map)return console.error(new Error("map is null, isReady is "+this.isReady)),{};var t=this.map.cells[e].c||0;return 0===t?{}:{left:t&D&&e%14===0,right:t&N&&e%14===13,top:t&R&&e<28,bottom:t&O&&e>531}},n.prototype.getFirstMapFlag=function(e){var t=this.getChangeMapFlags(e);return t.left?"left":t.right?"right":t.top?"top":t.bottom?"bottom":null},n.prototype.getCellId=function(e,t){return this.grid.getCellAtSceneCoordinate({x:e,y:t})},n.prototype.getCellSceneCoordinate=function(e){var t=r.getCellCoord(e);if(this.isReady){if(!this.map)return console.error(new Error("map is null, cannot add cell elevation.")),t;t.y-=this.map.cells[e].f||0}return t},n.prototype.hideStatedElements=function(){for(var e=0;e<this.statedElements.length;e++)this.statedElements[e].hide()},n.prototype.showStatedElements=function(){for(var e=0;e<this.statedElements.length;e++)this.statedElements[e].show()},n.prototype.hideGraphics=function(){for(var e=0;e<this.graphics.length;e++)this.graphics[e].hide()},n.prototype.showGraphics=function(){for(var e=0;e<this.graphics.length;e++)this.graphics[e].show()}},function(e,t,i){"use strict";function n(){this.cells=[],this.bounds=[],this.cellId=void 0}function o(){this.grid=[],this.scenePositions=[]}function s(e,t,i,n,o){for(var s=0;s<e.length;s+=1){var a=e[s],r=t[a],l=(r.x-i)*_,c=(r.y-n)*v,u=l*l+c*c;u<o.dist&&(o.dist=u,o.cell=a)}}function a(e,t){var i=e.cells.indexOf(t);i!==-1&&(e.cells.splice(i,1),e.bounds.splice(i,1))}var r=i(184),l=i(895),c=r.CELL_WIDTH,u=r.CELL_HEIGHT,d=r.HORIZONTAL_OFFSET-c,h=r.VERTICAL_OFFSET-u/2,p=19,m=p+.225,f=Math.sqrt(2),g=f/2,_=f/c,v=f/u,y=33,b=34,w=14,M=2*w;e.exports=o,o.prototype.getCoordinateGridFromCellId=function(e){var t=e%w-~~(e/M),i=t+p,n=t+~~(e/w);return{i:i,j:n}},o.prototype.getCoordinateCellIdFromGrid=function(e){return this.grid[e.i][e.j].cellId},o.prototype.getCoordinateGridFromScene=function(e){var t=(e.x-d)*_,i=(e.y-h)*v,n=g*t-g*i+m,o=g*t+g*i,s=Math.max(0,Math.min(y-1,~~n)),a=Math.max(0,Math.min(b-1,~~o));return{i:s,j:a,dx:n-s,dy:o-a}},o.prototype.getCoordinateSceneFromGrid=function(e){var t=e.i-m,i=e.j;return{x:(g*t+g*i)/_+c/2+d,y:(g*i-g*t)/v+h}},o.prototype.getSceneCoordinateFromCellId=function(e){return this.getCoordinateSceneFromGrid(this.getCoordinateGridFromCellId(e))},o.prototype.getCellAtSceneCoordinate=function(e){var t=this.getCoordinateGridFromScene(e),i=this.grid[t.i][t.j],n=i.cells;if(0===n.length)return this.getClosestCell(t,e);for(var o=t.dx,s=t.dy,a=i.bounds,r=0,l=a.length;r<l;r+=1){var c=a[r];if(c[0]<=o&&o<=c[1]&&c[2]<=s&&s<=c[3])return{cell:n[r],dist:0}}return this.getClosestCell(t,e)},o.prototype.getClosestCell=function(e,t){for(var i,n,o,a,r=e.i,l=e.j,c=t.x,u=t.y,d=0,h={cell:-1,dist:1/0};h.cell===-1;){for(o=Math.max(l-d,0),a=Math.min(l+d,b-1),n=Math.min(r+d,y-1),i=Math.max(r-d,0);i<=n;i+=1)s(this.grid[i][o].cells,this.scenePositions,c,u,h),s(this.grid[i][a].cells,this.scenePositions,c,u,h);for(i=Math.max(r-d,0),n=Math.min(r+d,y-1),a=Math.min(l+d-1,b-1),o=Math.max(l-d+1,0);o<=a;o+=1)s(this.grid[i][o].cells,this.scenePositions,c,u,h),s(this.grid[n][o].cells,this.scenePositions,c,u,h);d+=1}return h},o.prototype.getNearbyCellInZone=function(e,t,i,n){if(!n||0===n.length)return console.error(new Error('"zone" is not an array')),null;if(void 0!==n[e])return e;for(var o=null,s=[],a=l.getNeighbourCells(e,!0),r=0;r<a.length;r++)void 0!==a[r]&&void 0!==n[a[r]]&&s.push(a[r]);var c=1/0;for(r=0;r<s.length;r++){var u=s[r],d=this.scenePositions[u],h=(d.x-t)*_,p=(d.y-i)*v,m=h*h+p*p;m<c&&(c=m,o=u)}return o},o.prototype.updateCellState=function(e,t,i){var n=t.l;0===(1&n)?0!==(1&i)&&this._removeCell(e,t):0===(1&i)&&this._addCell(e,t)},o.prototype._removeCell=function(e,t){delete this.scenePositions[e];var i=this.useAltitude&&t.f||0,n=this.getCoordinateGridFromCellId(e);if(0===i)a(this.grid[n.i][n.j],e);else{var o=i/u,s=Math.floor(n.i+o),r=Math.floor(n.j-o);if(s>=y||r>=b)return;var l=s+1,c=r+1;if(l<0||c<0)return;s>=0&&(r>=0&&a(this.grid[s][r],e),c<b&&a(this.grid[s][c],e)),l<y&&(r>=0&&a(this.grid[l][r],e),c<b&&a(this.grid[l][c],e))}},o.prototype._addCell=function(e,t){var i,n=this.getCoordinateGridFromCellId(e);this.grid[n.i][n.j].cellId=e;var o=this.useAltitude&&t.f||0,s=this.getCoordinateSceneFromGrid(n);if(s.y-=o,this.scenePositions[e]=s,0===o)i=this.grid[n.i][n.j],i.cells.push(e),i.bounds.push([0,1,0,1]);else{var a=o/u,r=n.i+a,l=n.j-a,c=Math.floor(r),d=Math.floor(l);if(c>=y||d>=b)return;var h=c+1,p=d+1;if(h<0||p<0)return;var m=r-c,f=l-d;c>=0&&(d>=0&&(i=this.grid[c][d],i.cells.push(e),i.bounds.push([m,1,f,1])),p<b&&(i=this.grid[c][p],i.cells.push(e),i.bounds.push([m,1,0,f]))),h<y&&(d>=0&&(i=this.grid[h][d],i.cells.push(e),i.bounds.push([0,m,f,1])),p<b&&(i=this.grid[h][p],i.cells.push(e),i.bounds.push([0,m,0,f])))}},o.prototype.initialize=function(e,t){this.cellList=e,this.useAltitude=t,this.grid=[],this.scenePositions=[];for(var i=0;i<y;i+=1){var o=new Array(b);this.grid[i]=o;for(var s=0;s<b;s+=1)o[s]=new n}for(var a=e.length-1;a>=0;a-=1){var r=e[a];0!==(1&r.l)&&this._addCell(a,r)}}},function(e,t,i){function n(e,t){s.call(this,e,t),this.state=-1,this.animated=!1}var o=i(191).inherits,s=i(420),a={2:!0};o(n,s),e.exports=n,n.prototype.changeState=function(e,t){function i(){o.assignSymbol(l,c),n.animated=c}if(this.state!==e){var n=this,o=this.animManager,s=this.state;if(this.state=e,!o.isVoidAnimManager){var r={id:"AnimState"+s+"_to_AnimState"+e+"_0",base:"AnimState"+s+"_to_AnimState"+e,direction:0},l={id:"AnimState"+e+"_0",base:"AnimState"+e,direction:0},c=a[e]||!1;!t&&o.template&&o.template.exposedSymbols[r.id]?(this.animated=!0,o.assignSymbol(r,!1,i)):i()}}}},function(e,t,i){function n(e){a.call(this,e),this._updatedSprites=[],this._atlasTexture=null,this._spriteByteSize=this.renderer.getNbBytesPerSprite(),this._vertexBuffer=null,this._floatView=null,this._longView=null,this._sprites=[],this._vertexBufferCreated=!1,this._vertexBufferIndexPerPosition=new Array(l+1)}function o(e,t,i){r.call(this,e),this.batch=i,this.renderer=i.renderer;var n=e.cx||0,o=e.cy||0,s=e.x,a=e.y,l=e.sx||1,c=e.sy||1,u=e.cw,d=e.ch,h=-n*l,p=-o*c,m=(u-n)*l,f=-o*c,g=-n*l,_=(d-o)*c,v=(u-n)*l,y=(d-o)*c,b=e.rotation||0;if(0!==b){var w=Math.cos(b),M=Math.sin(b),T=h,C=m,I=g,A=v;h=h*w-p*M,p=T*M+p*w,m=m*w-f*M,f=C*M+f*w,g=g*w-_*M,_=I*M+_*w,v=v*w-y*M,y=A*M+y*w}this.x0=h+s,this.y0=p+a,this.x1=m+s,this.y1=f+a,this.x2=g+s,this.y2=_+a,this.x3=v+s,this.y3=y+a,this.bbox[0]=Math.min(this.x0,this.x1,this.x2,this.x3),this.bbox[1]=Math.max(this.x0,this.x1,this.x2,this.x3),this.bbox[2]=Math.min(this.y0,this.y1,this.y2,this.y3),this.bbox[3]=Math.max(this.y0,this.y1,this.y2,this.y3),this.graphicInAtlas=t,this.spriteIndex=0}var s=i(191).inherits,a=i(421),r=i(422),l=i(184).NB_CELLS;s(n,a),e.exports=n,n.prototype.holdsStatics=!0,n.prototype.setTexture=function(e){this._atlasTexture=e,this._updatedSprites.push(this),this.forceRefresh()},n.prototype.draw=function(e,t){if(null!==this._atlasTexture&&!(e.layer>this.layer||t.layer<this.layer)){var i;e.layer<this.layer?i=0:(i=Math.round(e.position),i<0?i=0:i>l&&(i=l));var n;t.layer>this.layer?n=l:(n=Math.round(t.position),n<0?n=0:n>l&&(n=l));var o=this._vertexBufferIndexPerPosition[i],s=this._vertexBufferIndexPerPosition[n];o!==s&&this.renderer.drawSpriteSubBatch(this.id,o,s)}},s(o,r),o.prototype.isWithinBounds=function(e,t){return this.bbox[0]<=e&&e<=this.bbox[1]&&this.bbox[2]<=t&&t<=this.bbox[3]},o.prototype.render=function(){null!==this.batch._atlasTexture&&this.renderer.drawSpriteSubBatch(this.batch.id,6*this.spriteIndex,6*this.spriteIndex+6)},o.prototype.forceRefresh=function(){this.isOutdated===!1&&(this.isOutdated=!0,this.batch._updatedSprites.push(this),this.batch.forceRefresh())},n.prototype.addSprite=function(e,t){var i=new o(e,t,this);return this._sprites.push(i),i},n.prototype.finalize=function(e,t){this._createVertexBuffer(e,t),this._updatedSprites.push(this),this.forceRefresh()},n.prototype.refreshAnimation=function(e){if(this.isOutdated=!1,0!==this._updatedSprites.length){for(var t=0;t<this._updatedSprites.length;t+=1){var i=this._updatedSprites[t];this._updateSpriteHighlight(i),void 0!==e&&e.push(i.bbox.slice()),i.isOutdated=!1}var n=this.id,o=this.renderer.getBufferData(n);if(void 0===o){var s=this._atlasTexture;if(null!==s&&this._vertexBufferCreated){var a=this._floatView,r=!1;this.renderer.loadSpriteBuffer(n,a,s,this.bbox,r),this.renderer.lockBuffer(n)}}this._updatedSprites.length=0}},n.prototype._updateSpriteHighlight=function(e){var t=e.spriteIndex*this._spriteByteSize,i=t/4,n=this._longView.subarray(i,i+this._spriteByteSize/4),o=e.tint,s=Math.max(-128,Math.min(127,64*o[0])),a=Math.max(-128,Math.min(127,64*o[1])),r=Math.max(-128,Math.min(127,64*o[2])),l=Math.max(-128,Math.min(127,64*o[3])),c=(l<<24&4278190080)+(r<<16&16711680)+(a<<8&65280)+(255&s);n[3]=n[8]=n[13]=c,n[18]=n[23]=n[28]=c,this.renderer.updateVertexBuffer(this.id,n,t)},n.prototype._createVertexBuffer=function(e,t){this._vertexBuffer=new window.ArrayBuffer(this._spriteByteSize*this._sprites.length),
this._floatView=new window.Float32Array(this._vertexBuffer),this._longView=new window.Uint32Array(this._vertexBuffer);for(var i=this._floatView,n=this._longView,o=this._longView,s=1/0,a=-(1/0),r=1/0,c=-(1/0),u=0,d=0;d<this._sprites.length;d+=1){var h=this._sprites[d],p=h.graphicInAtlas,m=d*this._spriteByteSize/4;for(h.spriteIndex=d;u<h._position;)this._vertexBufferIndexPerPosition[u]=6*d,u+=1;this._vertexBufferIndexPerPosition[u]=6*d+6;var f=h.bbox;f[0]<s&&(s=f[0]),f[1]>a&&(a=f[1]),f[2]<r&&(r=f[2]),f[3]>c&&(c=f[3]),i[m+0]=h.x0,i[m+1]=h.y0,i[m+5]=h.x2,i[m+6]=h.y2,i[m+10]=h.x3,i[m+11]=h.y3,i[m+15]=h.x0,i[m+16]=h.y0,i[m+20]=h.x3,i[m+21]=h.y3,i[m+25]=h.x1,i[m+26]=h.y1;var g=p.sx/e*65535&65535,_=p.sy/t*4294901760&4294901760,v=(p.sx+p.sw)/e*65535&65535,y=(p.sy+p.sh)/t*4294901760&4294901760;n[m+2]=g+_,n[m+7]=g+y,n[m+12]=v+y,n[m+17]=g+_,n[m+22]=v+y,n[m+27]=v+_;var b=h.tint,w=Math.max(-128,Math.min(127,64*b[0])),M=Math.max(-128,Math.min(127,64*b[1])),T=Math.max(-128,Math.min(127,64*b[2])),C=Math.max(-128,Math.min(127,64*b[3])),I=(C<<24&4278190080)+(T<<16&16711680)+(M<<8&65280)+(255&w);o[m+3]=o[m+8]=o[m+13]=I,o[m+18]=o[m+23]=o[m+28]=I,o[m+4]=o[m+9]=o[m+14]=0,o[m+19]=o[m+24]=o[m+29]=0}for(;u<=l;)this._vertexBufferIndexPerPosition[u]=6*d,u+=1;this.bbox[0]=s,this.bbox[1]=a,this.bbox[2]=r,this.bbox[3]=c,this._vertexBufferCreated=!0},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id),this._atlasTexture&&this._atlasTexture.release()}},function(e,t,i){function n(e,t,i){d.call(this,e,t),this._centerX=e.w/2,this._centerY=e.h,this.orientation=e.orientation,this.tween=null,this._startAnimation(i)}function o(){0!==v.length&&(v.forEach(function(e){t.addArrow.apply(null,e)}),v=[])}function s(e,t,i,s,a){if(!y)return v.push(arguments),void(b||(b=!0,g.loadTexture("ui/hintArrow/arrow.png",function(e){y=e,o()},s.renderer,"linear","permanent")));var r={x:e.x,y:e.y,w:w,h:M,position:t,layer:u.MAP_LAYER_POINT_LABELS,orientation:i,scene:s};_.push(new n(r,y,a))}function a(){v=[];for(var e=0;e<_.length;e++)_[e].remove();_=[],(x.playing||x.starting)&&x.stop(),(L.playing||L.starting)&&L.stop()}function r(e,t,i,n,o){a(),s(e[o],t[o],i,n),x.reset(I,function(){++o>=e.length&&(o=0),r(e,t,i,n,o)}),x.start()}function l(e,t,i,n){r(e,t,i,n,0)}function c(e,t,i,n){if(!L.playing&&!L.starting){a();for(var o=0;o<e.length;o++)s(e[o],t[o],i,n);L.reset(I,function(){a()}),L.start()}}var u=i(184),d=i(759),h=i(191).inherits,p=i(439).easing,m=i(439).Tween,f=i(439).Delay,g=i(430),_=[],v=[],y=null,b=!1,w=60,M=60,T=24,C=2,I=2*(T+C),A={up:0,down:180,left:-90,right:90,upLeft:-45,upRight:45,downLeft:-135,downRight:135},S=3,E=3;h(n,d),Object.defineProperty(n.prototype,"centerX",{get:function(){return this._centerX},set:function(e){this._centerX=e,this.forceRefresh()}}),Object.defineProperty(n.prototype,"centerY",{get:function(){return this._centerY},set:function(e){this._centerY=e,this.forceRefresh()}}),n.prototype._startAnimation=function(e){var t=A[this.orientation]||0;this.rotation=t*Math.PI/180,this.tween&&(this.tween.stop(),this.tween=null);var i=this.centerY-S,n=this.centerY+S;return this.tween=new m(this,["alpha","centerY"]).from({alpha:0,centerY:i}).to({alpha:1,centerY:i},C).to({alpha:1,centerY:n},T,p.trigo,E).to({alpha:0,centerY:n},C).to({alpha:0,centerY:n},T).start(e||!0),this},n.prototype.stop=function(){this.tween.stop()},n.prototype.render=function(){var e=this.renderer;e.save(),e.translate(this._x,this._y),e.rotate(this._rotation),e.translate(-this._centerX,-this._centerY),e.multiplyColor(this.tint[0],this.tint[1],this.tint[2],this.tint[3]),e.drawImage(this.texture,0,0,this.w,this.h),e.restore()},n.prototype.generateCurrentFrameData=function(){return[-this._centerX,this.w-this._centerX,-this._centerY,this.h-this._centerY]},t.addArrow=s;var x=new f,L=new f;t.removeArrows=a,t.addArrowsSequence=l,t.addArrowsOneShot=c},function(e,t,i){var n=i(184),o=i(426),s=i(425),a={up:0,down:180*Math.PI/180},r={pingIcon:"ping_Icon",mp:"btn_DeplaceToi",warning:"btn_Attention",stop:"btn_Stop",attack:"btn_Attaque",move:"btn_Deplace",heal:"btn_Soigne",boost:"btn_Boost",tackle:"btn_Entrave",valid:"btn_Valide"},l={};t.addPingPicto=function(e,t,i,c){if(!r[c])return void console.error("[IsoEngine.addPingPicto] No base for type",c);var u=new s({layer:n.MAP_LAYER_ICONS,x:t.x,y:t.y,scene:window.isoEngine.mapScene}),d=new s({layer:n.MAP_LAYER_ICONS,x:t.x,y:t.y,scene:window.isoEngine.mapScene});o.loadAnimationManager(u,"embedded","ping",function(e){e.assignSymbol({base:r.pingIcon,direction:-1},!1)}),o.loadAnimationManager(d,"embedded","ping",function(e){e.assignSymbol({base:r[c],direction:-1},!1)}),l[e]={back:u,front:d};var h=70,p=0;u.rotation=a.up;var m=window.isoEngine.actorManager.occupiedCells[i]||[];if(m.length>0){var f=m[0].bbox;p=f?f[2]-t.y:-100,p-=h,t.y+p<0&&(p=f?f[3]-t.y:100,p+=h,u.rotation=a.down)}else p=-h,t.y+p<0&&(p=h,u.rotation=a.down);u.y=t.y+p,d.y=t.y+p,window.isoEngine.mapRenderer.addCellHighlight(e,[i],window.gui.pingSystem.PING_CELL_COLOR)},t.removePingPicto=function(e){window.isoEngine.mapRenderer.deleteCellHighlight(e);var t=l[e];return t?(t.back&&t.back.remove(),t.front&&t.front.remove(),void delete l[e]):void console.warn("IsoEngine removePing: There no ping picto with the id",e)},t.removeAllPingPictos=function(){for(var e in l)l.hasOwnProperty(e)&&t.removePingPicto(e)}},function(e,t,i){function n(e,t){if(t=t||{},this.id=null,this.outline=t.outline||!1,this.color=t.color,this.data=t.data||null,this.gfx=null,this._boxBatch=null,this._lineBatch=null,!this.outline&&!this.color)return void console.error("[Zone] It is not possible to create a zone without colors and outline");if(this.outline){var i=s.getZoneOutlines(e);this._lineBatch=new l({scene:window.isoEngine.mapScene,x:0,y:0,position:5,lines:i,lineWidth:4,hue:r.anyToColorArray(this.outline),layer:a.MAP_LAYER_BACKGROUND,id:"zoneOutline"+f++})}if(this.color){for(var n=[],d=0;d<e.length;d++){var g=o.cellCoord[e[d]],_=u,v=g.x,y=g.y-_;n.push({x0:v,y0:y,x1:v+p,y1:y+m,x2:v,y2:y+h,x3:v-p,y3:y+m})}this._boxBatch=new c({scene:window.isoEngine.mapScene,x:0,y:0,position:1,boxes:n,hue:r.anyToColorArray(this.color),layer:a.MAP_LAYER_BACKGROUND,id:"zoneColor"+f++})}}var o=i(756),s=i(1355),a=i(184),r=i(424),l=i(1113),c=i(758),u=a.GRID_ALTITUDE_OFFSET,d=a.CELL_WIDTH,h=a.CELL_HEIGHT,p=d/2,m=h/2,f=1;e.exports=n,n.prototype.destroy=function(){null!==this.gfx&&this.gfx.remove(),this._lineBatch&&(this._lineBatch.remove(),this._lineBatch=null),this._boxBatch&&(this._boxBatch.remove(),this._boxBatch=null)}},function(e,t,i){function n(e){var t=y*(e[0]-f),i=y*e[1],n=(t+i)/b+g,o=(i-t)/w+_;return n=~~Math.round(n),o=~~Math.round(2*o)/2-u,{x:n,y:o}}function o(e,t){t[e]?delete t[e]:t[e]=!0}function s(e,t){var i=r.getMapPointFromCellId(e);o(i.x+":"+i.y+":H",t),o(i.x+1+":"+i.y+":V",t),o(i.x+":"+(i.y+1)+":H",t),o(i.x+":"+i.y+":V",t)}function a(e){for(var t={},i=0;i<e.length;i++)s(e[i],t);t=Object.keys(t);for(var o=[],a=0;a<t.length;a++){var r=t[a].split(":");r[0]=~~r[0],r[1]=~~r[1];var l=n(r);"H"===r[2]?r[0]+=1:r[1]+=1;var u=n(r);o.push(new c(l.x,l.y,u.x,u.y))}return o}var r=i(895),l=i(184),c=i(1112),u=l.GRID_ALTITUDE_OFFSET,d=l.CELL_WIDTH,h=l.CELL_HEIGHT,p=.325,m=1.338,f=20.225,g=l.HORIZONTAL_OFFSET-d/2-p,_=l.VERTICAL_OFFSET-h/2-m,v=Math.sqrt(2),y=v/2,b=v/d,w=v/h;e.exports.getZoneOutlines=a},function(e,t,i){function n(e,t){this.mapRenderer=e,this.onLoadedCallback=t,this.nAssetsLoaded=0,this.nAssetsToLoad=0,this._atlas=document.createElement("canvas"),this._atlasContext=this._atlas.getContext("2d"),this.obsolete=!1,null!==d&&(d.obsolete=!0);var i=this;d=i}var o=i(426),s=i(1350),a=i(269),r=i(1357),l=i(202),c=i(184),u=c.IMG_PATH,d=null;e.exports=n,n.prototype.notifyAssetAsLoaded=function(){if(this.nAssetsLoaded+=1,window.isoEngine.showLoadingProgress(this.nAssetsLoaded/this.nAssetsToLoad),this.nAssetsLoaded===this.nAssetsToLoad){if(this.onLoadedCallback(),this.onLoadedCallback=null,this.obsolete)return;this.mapRenderer.isReady=!0,this.mapRenderer.emit("ready"),this.obsolete=!0}},n.prototype.loadStatedElement=function(e){var t=new s(e),i=this;return this.nAssetsToLoad+=1,o.loadAnimationManager(t,"bone",e.look+"/state",function(){t.changeState(t.state,!0),i.notifyAssetAsLoaded()}),t},n.prototype.loadAnimatedGraphic=function(e){var t=new r(e),i=this;return this.nAssetsToLoad+=1,o.loadAnimationManager(t,"bone",e.look+"/motion",function(){a.isFightMode?t.stop():t.animate(),i.notifyAssetAsLoaded()}),t},n.prototype.loadAtlas=function(e,t){function i(){if(r+=1,r===a){var e=c.mapRenderer.mapScene,i=c.mapRenderer.mapId,n=e.createTexture(c._atlas,"mapAtlas"+i,"linear");c._atlas.width=1,c._atlas.height=1,t.setTexture(n)}c.notifyAssetAsLoaded()}function n(e,t){l.loadImage(e,function(e){if(!c.obsolete){var n=t.sx,o=t.sy,s=t.sw,a=t.sh,r=t.cx||0,l=t.cy||0,u=t.cw||s,d=t.ch||a;r+u>e.width&&(u=e.width-r),l+d>e.height&&(d=e.height-l),c._atlasContext.drawImage(e,r,l,u,d,n,o,s,a),i()}})}this._atlas.width=e.width,this._atlas.height=e.height;var o=e.graphicsPositions,s=Object.keys(o),a=s.length,r=0;this.nAssetsToLoad+=a;for(var c=this,d=0;d<s.length;d+=1){var h=s[d],p=o[h],m=p.jpg?"jpg":"png",f=m+"/"+h+"."+m,g=u+f;n(g,p)}}},function(e,t,i){function n(e){s.call(this,e,e.animManager),this.animStatic=!!e.astc,this.delayMin=e.dmin||0,this.delayMax=e.dmax||0,this._timeout=null,this._stopped=!0}var o=i(191).inherits,s=i(420),a={id:"AnimStatique_0",base:"AnimStatique",direction:0},r={id:"AnimStart_0",base:"AnimStart",direction:0};o(n,s),e.exports=n,n.prototype.animate=function(){this._stopped&&(this._stopped=!1,this.delayMax?(this.animStatic&&this.animManager.assignSymbol(a,!1),this._animateShoot()):this._animateLoop())},n.prototype.stop=function(){this._stopped=!0,this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this.delayMax||this.animManager.assignSymbol(a,!1)},n.prototype.remove=function(){this.stop(),s.prototype.remove.call(this)},n.prototype._animateLoop=function(){this.animManager.assignSymbol(r,!0)},n.prototype._animateShoot=function(){var e=this;if(!this._stopped){var t=1e3*(this.delayMin+(this.delayMax-this.delayMin)*Math.random());this._timeout=window.setTimeout(function(){e._stopped||e.animManager.assignSymbol(r,!1,function(){e._stopped||(e.animStatic&&e.animManager.assignSymbol(a,!1),e._animateShoot())})},t)}}},function(e,t,i){function n(e){var t=this;l.call(this,e,e.scene.renderer.getEmptyTexture()),this.zones=[],this.displayGrid=!1,this.tacticalMode=!1,this.gridLines=null,this.tacticalBoxes=null,this.gridAnimator=null,this.isDebugMode=!1,_.on("gameContextChanged",this.onGameContextChanged.bind(this)),g.on("alwaysShowGrid",function(e){_.isFightMode||t.toggleGrid(e)}),g.on("fightAlwaysShowGrid",function(e){_.isFightMode&&t.toggleGrid(e)})}function o(e,t){var i=window.foreground.convertScreenToCanvasCoordinate(e,t),n=window.isoEngine.mapScene.convertCanvasToSceneCoordinate(i.x,i.y);return window.isoEngine.mapRenderer.getCellId(n.x,n.y)}var s=i(184),a=i(756),r=i(191).inherits,l=i(759),c=i(1112),u=i(757),d=i(1113),h=i(1359),p=i(1363),m=i(439).Tween,f=i(1364),g=i(190),_=i(269),v=s.CELL_WIDTH,y=s.CELL_HEIGHT,b=s.GRID_ALTITUDE_OFFSET,w=s.MAP_LAYER_BACKGROUND,M=v/2,T=y/2,C=[.8,.8,.8,.8];r(n,l),e.exports=n,n.prototype.resetAndClear=function(){this.displayGrid=!1},n.prototype.clear=function(){this.texture?(this.texture.release(),this.texture=null):console.warn("[Background.clear] Clearing background although no texture was ever set")},n.prototype.releaseMap=function(){this.deleteAllZones(),this.gridLines&&(this.gridLines.remove(),this.gridLines=null)},n.prototype.updateMap=function(e){this._cleared=!1,this.texture=e,this.show(),this.gridLines||this.generateWalkableGrid()},n.prototype.onGameContextChanged=function(){var e=_.isFightMode?g.fightAlwaysShowGrid:g.alwaysShowGrid;this.generateWalkableGrid(),this.toggleGrid(e)},n.prototype.toggleGrid=function(e){if(this.displayGrid!==e&&(this.displayGrid=e,null!==this.gridLines))if(e)this.gridLines.show(),new m(this.gridLines,["alpha"]).to({alpha:1},20).start();else{var t=this;new m(this.gridLines,["alpha"]).to({alpha:0},15).start().onFinish(function(){t.gridLines&&t.gridLines.hide()})}},n.prototype.generateWalkableGrid=function(){this.gridAnimator||(this.gridAnimator=new h);var e=window.isoEngine.mapRenderer;if(e.map&&e.map.cells){for(var t=e.map.cells,i=_.isRoleplayMode,n={},o=[],r=[],l=0;l<s.NB_CELLS;l++){var p=e.isWalkable(l);if(p){var f=t[l],g=a.cellCoord[l],v=(i&&f.f||0)+b,I=g.x,A=I-M,S=I+M,E=g.y-v,x=E+T,L=E+y,N=I+"."+E+"-"+S+"."+x,O=I+"."+L+"-"+S+"."+x,D=I+"."+L+"-"+A+"."+x,R=I+"."+E+"-"+A+"."+x;void 0===n[N]&&(n[N]=!0,r.push(new c(I,E,S,x))),void 0===n[O]&&(n[O]=!0,r.push(new c(S,x,I,L))),void 0===n[D]&&(n[D]=!0,r.push(new c(I,L,A,x))),void 0===n[R]&&(n[R]=!0,r.push(new c(A,x,I,E)));var P=new u(I,E,S,x,I,L,A,x);P.cellId=l,o.push(P)}}this.gridLines&&this.gridLines.remove(),this.gridLines=new d({scene:window.isoEngine.mapScene,x:0,y:0,position:3,lines:r,lineWidth:2,hue:C,layer:w,id:"combatGrid"}),this.gridLines.alpha=0,this.displayGrid?(this.gridLines.show(),new m(this.gridLines,["alpha"]).to({alpha:1},20).start()):this.gridLines.hide(),this.isDebugMode&&(this.initDebugOverlay(),this.cellIdOverlay.clear(),this.cellIdOverlay.generateOverlay())}},n.prototype.setGridColor=function(e){this.gridLines.hue=e},n.prototype.initDebugOverlay=function(){if(!this.cellIdOverlay){var e={scene:this.scene,layer:s.MAP_LAYER_FOREGROUND,position:1,x:-s.HORIZONTAL_OFFSET,y:-s.VERTICAL_OFFSET,w:s.MAP_SCENE_WIDTH,h:s.MAP_SCENE_HEIGHT,id:"cellIdOverlay"};this.cellIdOverlay=new f(e)}},n.prototype.toggleDebugMode=function(e){this.isDebugMode=!this.isDebugMode,this.initDebugOverlay(),this.isDebugMode?this.cellIdOverlay.generateOverlay(e):this.cellIdOverlay.clear()},n.prototype.highlightDebugCells=function(e,t){this.isDebugMode&&this.cellIdOverlay&&this.cellIdOverlay.colorCells(e,t)},n.prototype.deleteAllZones=function(){for(var e=0;e<this.zones.length;e++)this.zones[e].destroy();this.zones=[]},n.prototype.addZone=function(e,t){this.zones.push(e),e.id=t},n.prototype.deleteZone=function(e){e.destroy();var t=this.zones.indexOf(e);return t===-1?console.warn("Removing a non existing zone"):void this.zones.splice(t,1)},n.prototype.deleteZoneById=function(e,t){for(var i=0;i<this.zones.length;)this.zones[i].id===e?(t&&t(this.zones[i]),this.zones[i].destroy(),this.zones.splice(i,1)):i++},n.prototype.getDataOfZoneId=function(e){for(var t=0;t<this.zones.length;t++)if(this.zones[t].id===e)return this.zones[t].data;return null};var I=10;n.prototype.colorCurrentDragCell=function(e,t,i){if(i.data){var n=window.foreground.convertScreenToCanvasCoordinate(e,t-I),o=window.isoEngine.mapScene.convertCanvasToSceneCoordinate(n.x,n.y),s=window.isoEngine.mapRenderer.getCellId(o.x,o.y),a=s.cell;window.isoEngine.cellHover(a,i.data.id)}},n.prototype.dragCellRelease=function(e,t,i){if(_.isFightMode){if(!i.data)return;var n=o(e,t-I);window.isoEngine.cellHoverRelease(n.cell)}},n.prototype.addGridAnimation=function(e){return this.gridAnimator.addGridAnimation(e)},n.prototype.removeGridLayer=function(e){this.gridAnimator?this.gridAnimator.removeGridLayer(e):this.gridAnimator=new h};var A=[];n.prototype.addTargetHighLights=function(e,t,i,n,o,s){var a=new p(e,t,i);A.push(a),a.animate(n,o),s&&a.hide()},n.prototype.removeTargetHighlights=function(){A.forEach(function(e){e.stopped===!1&&(e.stop(),e.remove())}),A=[]},n.prototype.hideTargetHighlights=function(){A.forEach(function(e){e.hide()})},n.prototype.showTargetHighlights=function(){A.forEach(function(e){e.show()})}},function(e,t,i){function n(){this._gridOverlay=new o,this._gridOverlay.hide(),this._layers=new a,this._layersBeingRemoved=new a}var o=i(1360),s=i(1362),a=i(429),r=i(302),l=i(303);e.exports=n,n.prototype.addGridAnimation=function(e){if(0===Object.keys(e).length)return console.error(new Error("Trying to add animation with no cells!")),null;this._gridOverlay.show();var t=new s(e,this._gridOverlay);return t.playAnimation(),t._listReference=this._layers.addFront(t),this._resetBoundingBox(),t},n.prototype.removeGridLayer=function(e){if(e){this._layers.removeByReference(e._listReference),e._listReference=null;for(var t,i,n=e.cellInfos,o=Object.keys(n),a={},c=this._layers.first;null!==c;c=c.next)for(t=0;t<o.length;t++)i=o[t],c.object.cellInfos[i]&&void 0===a[i]&&(a[i]=c.object.cellInfos[i]);for(t=0;t<o.length;t++){i=o[t];var u=n[i];void 0===a[i]&&(a[i]=new r(i,u.distanceToPlayer,l.empty))}e._listReference=this._layersBeingRemoved.add(e);var d=this,h=new s(a,this._gridOverlay);h.playAnimation(function(){d._resetBoundingBox(),d._layersBeingRemoved.removeByReference(e._listReference),e._listReference=null})}},n.prototype._resetBoundingBox=function(){this._gridOverlay._bbox=[1/0,-(1/0),1/0,-(1/0)];for(var e=this._layersBeingRemoved.first;null!==e;e=e.next)this._expandToFitBox(e.object);if(0===this._layers.length)this._gridOverlay.hide();else for(this._layers.length>64&&console.error("layers are likely leaking"),e=this._layers.first;null!==e;e=e.next)this._expandToFitBox(e.object)},n.prototype.clear=function(){this._layers.clear()},n.prototype._expandToFitPoint=function(e,t){var i=this._gridOverlay._bbox;i[0]>e&&(i[0]=e),i[2]>t&&(i[2]=t),i[1]<e&&(i[1]=e),i[3]<t&&(i[3]=t)},n.prototype._expandToFitBox=function(e){var t=this._gridOverlay._bbox,i=e.bbox[0]-43;i<t[0]&&(t[0]=i);var n=e.bbox[1]+43;n>t[1]&&(t[1]=n);var o=e.bbox[2]-22;o<t[2]&&(t[2]=o);var s=e.bbox[3]+22;s>t[3]&&(t[3]=s)}},function(e,t,i){function n(){var e={scene:window.isoEngine.mapScene,position:1,hue:[0,0,0,0],layer:-1,id:"gridFeedbackOverlay"};s.call(this,e),this._bbox=[1/0,-(1/0),1/0,-(1/0)],this._boxByteSize=this.renderer.getNbBytesPerBox(),this.createGrid(),this.forceRefresh(),this._updated=!1}var o=i(1361),s=i(421),a=i(191).inherits,r=i(184),l=i(756),c=i(757),u=r.CELL_WIDTH,d=r.CELL_HEIGHT,h=u/2,p=d/2;a(n,s),e.exports=n,n.prototype.createGrid=function(){this.spriteBoxes=[],this._vertexBuffer=new window.ArrayBuffer(r.NB_CELLS*this._boxByteSize);for(var e=0;e<r.NB_CELLS;e++){var t=l.cellCoord[e],i=t.x,n=i-h,s=i+h,a=t.y-r.GRID_ALTITUDE_OFFSET,u=a+p,m=a+d,f=new c(i,a,s,u,i,m,n,u),g=e*this._boxByteSize,_=new window.Float32Array(this._vertexBuffer,g,this._boxByteSize/4),v=new window.Uint32Array(this._vertexBuffer,g,this._boxByteSize/4),y=new o(e,f,_,v,this);this.spriteBoxes[y.cellId]=y}},n.prototype._expandToFitPoint=function(e,t){this._bbox[0]>e&&(this._bbox[0]=e),this._bbox[1]<e&&(this._bbox[1]=e),this._bbox[2]>t&&(this._bbox[2]=t),this._bbox[3]<t&&(this._bbox[3]=t)},n.prototype._expandToFitBox=function(e){this._expandToFitPoint(e.x0,e.y0),this._expandToFitPoint(e.x1,e.y1),this._expandToFitPoint(e.x2,e.y2),this._expandToFitPoint(e.x3,e.y3)},n.prototype.draw=function(){this.renderer.drawBoxBatch(this.id)},n.prototype.render=function(){this.renderer.save(),this.draw(this.renderer),this.renderer.restore()},n.prototype.remove=function(){},n.prototype.generateCurrentFrameData=function(){this._updated&&(this.renderer.releaseBuffer(this.id),this._updated=!1);var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=!1;this.renderer.loadSpriteBuffer(t,this._vertexBuffer,null,this._bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t,i){function n(e,t,i,n,s){this._cellId=e;var r=a.empty;this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.sx=r.sx,this.sy=r.sy,this.rotation=0,this.gridOverlay=s,this._translateX=t.x0,this._translateY=t.y1,this._box=t,this._vertexBuffer=i,this._colorBuffer=n,this._restore(),this._translate(),this._fillVertexBuffer(),this.tween=new o(this,["sx","sy","r","g","b","a"]);var l=this;this.tween.onUpdate(function(){l.setBuffer()}),this._transformState=a.empty}var o=i(439).Tween,s=i(439).easing,a=i(303);e.exports=n,Object.defineProperty(n.prototype,"cellId",{get:function(){return this._cellId}}),n.prototype.animate=function(e,t){this._transformState=e;var i=11;return this.tween.reset().wait(t).to(e,i,s.backOut,2.3).start(),t+i},n.prototype._restore=function(){this._x0=0,this._y0=-21.5,this._x1=-43,this._y1=0,this._x2=0,this._y2=21.5,this._x3=43,this._y3=0},n.prototype._translate=function(){this._x0+=this._translateX,this._x1+=this._translateX,this._x2+=this._translateX,this._x3+=this._translateX,this._y0+=this._translateY,this._y1+=this._translateY,this._y2+=this._translateY,this._y3+=this._translateY},n.prototype._rotate=function(){if(0!==this.rotation){var e=Math.cos(this.rotation),t=Math.sin(this.rotation),i=this._x0,n=this._x1,o=this._x2,s=this._x3;this._x0=e*i-t*this._y0,this._y0=t*i+e*this._y0,this._x1=e*n-t*this._y1,this._y1=t*n+e*this._y1,this._x2=e*o-t*this._y2,this._y2=t*o+e*this._y2,this._x3=e*s-t*this._y3,this._y3=t*s+e*this._y3}},n.prototype._scale=function(){this._x0*=this.sx,this._x1*=this.sx,this._x2*=this.sx,this._x3*=this.sx,this._y0*=this.sy,this._y1*=this.sy,this._y2*=this.sy,this._y3*=this.sy},n.prototype.setBuffer=function(){this._restore(),this._scale(),this._rotate(),this._translate(),this._fillVertexBuffer(),this.gridOverlay._updated=!0,this.gridOverlay.forceRefresh()},n.prototype._fillVertexBuffer=function(){var e=Math.max(-128,Math.min(127,64*this.r)),t=Math.max(-128,Math.min(127,64*this.g)),i=Math.max(-128,Math.min(127,64*this.b)),n=Math.max(-128,Math.min(127,64*this.a)),o=(n<<24&4278190080)+(i<<16&16711680)+(t<<8&65280)+(255&e);this._vertexBuffer[0]=this._x0,this._vertexBuffer[1]=this._y0,this._colorBuffer[3]=o,this._vertexBuffer[5]=this._x1,this._vertexBuffer[6]=this._y1,this._colorBuffer[8]=o,this._vertexBuffer[10]=this._x2,this._vertexBuffer[11]=this._y2,this._colorBuffer[13]=o,this._vertexBuffer[15]=this._x2,this._vertexBuffer[16]=this._y2,this._colorBuffer[18]=o,this._vertexBuffer[20]=this._x3,this._vertexBuffer[21]=this._y3,this._colorBuffer[23]=o,this._vertexBuffer[25]=this._x0,this._vertexBuffer[26]=this._y0,this._colorBuffer[28]=o}},function(e,t,i){function n(e,t){this.cellInfos=e,this._gridOverlay=t,this.bbox=[1/0,-(1/0),1/0,-(1/0)],this._listReference=null}var o=i(439).Delay;e.exports=n,n.prototype.playAnimation=function(e){for(var t=-(1/0),i=this._gridOverlay.spriteBoxes,n=Object.keys(this.cellInfos),s=0;s<n.length;s++){var a=n[s],r=this.cellInfos[a],l=i[a],c=r.transformState;if(l.transformState!==c){var u=l.animate(c,.6*r.distanceToPlayer);t<u&&(t=u),this._expandToFitBox(l)}}if(e){if(t<=0)return e();new o(t,e).start()}},n.prototype._expandToFitPoint=function(e,t){this.bbox[0]>e&&(this.bbox[0]=e),this.bbox[2]>t&&(this.bbox[2]=t),this.bbox[1]<e&&(this.bbox[1]=e),this.bbox[3]<t&&(this.bbox[3]=t)},n.prototype._expandToFitBox=function(e){this._expandToFitPoint(e._x0,e._y0),this._expandToFitPoint(e._x1,e._y1),this._expandToFitPoint(e._x2,e._y2),this._expandToFitPoint(e._x3,e._y3)}},function(e,t,i){function n(e,t,i){var n={scene:window.isoEngine.mapScene,position:1,layer:a.MAP_LAYER_TARGET_INDICATOR,id:"lightColumn"+e,x:t,alpha:0};o.call(this,n),this.red=0,this.green=0,this.blue=0,this.stopped=!1,this._defineShape(i);var s=this;this._tween=new r(this,["scaleX","scaleY","red","green","blue","alpha"]),this._tween.onUpdate(function(){var e=s.tint;e[0]=s.red,e[1]=s.green,e[2]=s.blue})}var o=i(421),s=i(191).inherits,a=i(184),r=i(439).Tween,l=i(439).easing;s(n,o),e.exports=n,n.prototype.draw=function(){this.renderer.drawBoxBatch(this.id)},n.prototype._defineShape=function(e){this._x0=16,this._y0=e,this._x1=23,this._y1=-a.VERTICAL_OFFSET,this._x2=-23,this._y2=-a.VERTICAL_OFFSET,this._x3=-16,this._y3=e,this._x4=20,this._y4=-a.VERTICAL_OFFSET,this._x5=-20,this._y5=-a.VERTICAL_OFFSET,this._bbox=[this._x2,this._x1,this._y1,this._y0];var t=this.renderer.getNbBytesPerVertex(),i=new window.ArrayBuffer(12*t);this._vertexBuffer=new window.Float32Array(i),this._colorBuffer=new window.Uint32Array(i);var n=1077952576,o=4210752;this._vertexBuffer[0]=this._x0,this._vertexBuffer[1]=this._y0,this._colorBuffer[3]=o,this._vertexBuffer[5]=this._x1,this._vertexBuffer[6]=this._y1,this._colorBuffer[8]=o,this._vertexBuffer[10]=this._x4,this._vertexBuffer[11]=this._y4,this._colorBuffer[13]=n,this._vertexBuffer[15]=this._x0,this._vertexBuffer[16]=this._y0,this._colorBuffer[18]=o,this._vertexBuffer[20]=this._x4,this._vertexBuffer[21]=this._y4,this._colorBuffer[23]=n,this._vertexBuffer[25]=this._x5,this._vertexBuffer[26]=this._y5,this._colorBuffer[28]=n,this._vertexBuffer[30]=this._x0,this._vertexBuffer[31]=this._y0,this._colorBuffer[33]=o,this._vertexBuffer[35]=this._x5,this._vertexBuffer[36]=this._y5,this._colorBuffer[38]=n,this._vertexBuffer[40]=this._x3,this._vertexBuffer[41]=this._y3,this._colorBuffer[43]=o,this._vertexBuffer[45]=this._x2,this._vertexBuffer[46]=this._y2,this._colorBuffer[48]=o,this._vertexBuffer[50]=this._x3,this._vertexBuffer[51]=this._y3,this._colorBuffer[53]=o,this._vertexBuffer[55]=this._x5,this._vertexBuffer[56]=this._y5,this._colorBuffer[58]=n},n.prototype.animate=function(e,t){var i={scaleX:e.sx,scaleY:e.sy,red:e.r,green:e.g,blue:e.b,alpha:e.a},n={scaleX:t.sx,scaleY:t.sy,red:t.r,green:t.g,blue:t.b,alpha:t.a},o=this;this._tween.reset().from({scaleX:e.sx/2,scaleY:e.sy,red:e.r,green:e.g,blue:e.b,alpha:0},l.polyOut,4).to(i,6).onFinish(function(){this.stopped||o._tween.reset().from(i).to(n,20,l.trigo,1).start(!0)}).start()},n.prototype.stop=function(){this._tween.stop(),this.stopped=!0},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=!1;this.renderer.loadSpriteBuffer(t,this._vertexBuffer,null,this._bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t,i){function n(e){r.call(this,e),this.indexText=document.createElement("canvas"),this.indexText.width=e.w,this.indexText.height=e.h,this.indexTextContext=this.indexText.getContext("2d"),this.indexTextContext.font="20px Verdana",this.indexTextContext.fillStyle="rgba(0,0,0,0.6)",this.indexTextContext.textAlign="center"}var o=i(184),s=i(756),a=i(191).inherits,r=i(759),l=o.CELL_WIDTH,c=o.CELL_HEIGHT,u=o.GRID_ALTITUDE_OFFSET,d=l/2;a(n,r),e.exports=n,n.prototype.generateOverlay=function(e){this._generateOverlay(e)},n.prototype._generateOverlay=function(e,t,i){var n=window.isoEngine.mapRenderer;if(n.map&&n.map.cells){var a=n.map.cells;"string"==typeof e&&(this.indexTextContext.fillStyle=e),this.indexTextContext.clearRect(0,0,this.indexText.width,this.indexText.height);for(var r=0;r<o.NB_CELLS;r++){var l=n.isWalkable(r);if(l){var h=a[r],p=s.cellCoord[r],m=h.f?h.f+u:u,f=p.x,g=p.y-m;if(t&&t.indexOf(r)>=0){var _=this.indexTextContext.fillStyle;this.indexTextContext.fillStyle=i,this.indexTextContext.fillText(r,f+d+10,g+c),this.indexTextContext.fillStyle=_}else this.indexTextContext.fillText(r,f+d+10,g+c)}}this.texture&&this.texture.release(),this.texture=window.isoEngine.mapScene.createTexture(this.indexText),this.show()}},n.prototype.clear=function(){this.texture?(this.texture.release(),this.texture=null):console.warn("[CellIdOverlay.clear] Clearing CellIdOverlay although no texture was ever set"),this.hide()},n.prototype.colorCells=function(e,t){this._generateOverlay(null,e,t)}},function(e,t,i){function n(){}function o(e){s.prototype.actorManager=this,this.isoEngine=e.isoEngine,this.scene=e.scene,this.isTransparentModeOn=!1,this.isCreatureModeOn=!1,this.paused=!0,this.actors={},this.occupiedCells={},this.followers=[],this.customAnimMethods={},this.userId=0,this.userActor=new s({data:{_type:"GameRolePlayCharacterInformations"},scene:this.scene,actorManager:this}),this.userActor.setWhiteListedness(!0),this.fighterIndicator=null,this._onIdAdded={},this._queuedToCarryActors={},this._nickNamesOn=!1,this._fullNicknameLabelCount=0,this._setupListeners()}var s=i(876),a=i(190),r=i(895),l=i(894),c=i(184),u=i(1366),d=i(410),h=i(890),p=i(1367),m=i(271),f=i(269),g=i(195),_=i(252),v=.001,y=1.5,b=.38,w=.002,M=.5,T=.2,C={};e.exports=o,o.prototype._setupListeners=function(){var e=this;this.isoEngine.on("GameFightSynchronizeMessage",function(t){for(var i=t.fighters,n=0,o=i.length;n<o;n++){var s=i[n];if(s.alive){var a=s.contextualId,r=e.getActor(a);if(r){var l=s.disposition.cellId;l===-1||r.cellId===l||r.moving||r.setDisposition(l,null)}else e.addEmptyActor(s)}}}),f.on("gameContextChanged",this.onGameContextChanged.bind(this)),a.on("maxTitlesOrnaments",this.optionModifiedMaxTitlesOrnaments.bind(this)),m.on("MapNpcsQuestStatusUpdateMessage",function(t){e.updateQuestIcons(t)})},o.prototype.optionModifiedMaxTitlesOrnaments=function(){this.resetNicknames()},o.prototype.resetNicknames=function(){var e=window.isoEngine.mapRenderer;this._nickNamesOn&&(e.isReady?(this.turnNicknamesOff(),this.turnNicknamesOn()):e.once("ready",this.resetNicknames.bind(this)))},o.prototype.onGameContextChanged=function(){f.isRoleplayMode&&this.cleanupActorAnimations(),this.resetNicknames()},o.prototype.removeInvisibilityOfAllActors=function(){var e=d.VISIBLE;this.userActor.setInvisibility(e);for(var t in this.actors)this.actors[t].setInvisibility(e)},o.prototype.cleanupActorAnimations=function(){this.userActor.cleanupAnimations();for(var e in this.actors)this.actors[e].cleanupAnimations()},o.prototype.isActorInvisible=function(e){var t=this.getActor(e);return!!t&&t.isInvisible},o.prototype.getActor=function(e){var t=e===this.userId?this.userActor:this.actors[e];return t},o.prototype.getActorFromNpcId=function(e){var t=this.actors;for(var i in t){var n=t[i];if(n.isNPC()&&(n.data.npcId===e||e===-1))return n}return null},o.prototype.getActorFromMonsterId=function(e){var t=this.actors;for(var i in t){var n=t[i],o=n.data||{},s=o.staticInfos;if(s&&s.mainCreatureLightInfos&&(s.mainCreatureLightInfos.creatureGenericId===e||e===-1))return n}return null},o.prototype.getActorData=function(e,t){var i=this.getActor(e);return i?t(null,i.data):t(new Error("actorNotFound"))},o.prototype.pause=function(){this.paused=!0},o.prototype.unpause=function(){this.paused=!1},o.prototype.setUserCharacterData=function(e){var t=e.id,i=e.entityLook;this.userId=t,this.userActor.actorId=t,this.userActor.actorManager=this,this.userActor.data.name=e.name,this.userActor.data.playerId=t,this.setActorLook(t,i,{},null)},o.prototype.switchUserActor=function(e){if(this.userId!==e){var t=this.getActor(e);if(!t)return console.error("switchUserActor: No actor with id",e);var i=this.userActor.isDead,n=this.userId;this.actors[n]=this.userActor,this.userId=e,this.userActor=t,delete this.actors[e],i?this.removeActor(n):window.isoEngine.tryDisplayUserMovementZone()}},o.prototype.setActorLook=function(e,t,i,o){var s=o||n,a=this.getActor(e);if(!a)return console.warn("amsal: No actor with id",e),s();if(a.animated)return s();t||console.error(new Error("amsal: The look is missing."));var r=C[e];return r||(C[e]=_.createFifo(),r=C[e]),r.push(function(e){function n(e,t){a.staticAnim(function(){return e(),t()})}return a.riderEntity=null,a.setLook(t,i,function(){var t=a.animManager;a.isFollower&&(t.audioVol=T);var i=a.look;if(a.carriedEntity){var o=a.riderEntity||a.animManager;return o.addAnimation({base:"carrying",direction:-1},function(){return o.addAnimationModifier("AnimStatique","AnimStatiqueCarrying"),o.addAnimationModifier("AnimMarche","AnimMarcheCarrying"),o.addAnimationModifier("AnimCourse","AnimCourseCarrying"),o.addAnimationModifier("AnimHit","AnimHitCarrying"),o.addAnimationModifier("AnimTacle","AnimTacleCarrying"),n(e,s)})}return 1===i.bonesId&&i.skins&&i.skins[0]&&u[i.skins[0]]&&t.addAnimationModifier("AnimStatique","AnimStatique"+i.skins[0]),n(e,s)})})},o.prototype.getIndexedVisibleActors=function(e){var t={};for(var i in this.actors)if(this.actors.hasOwnProperty(i)){var n=this.actors[i],o=!n.isInvisible;e&&e.showAlsoInvisibleInMyTeam&&(o=_.isActorVisibleToUser(i)),o&&(t[n.cellId]=n)}return t[this.userActor.cellId]=this.userActor,t},o.prototype.removeAllActors=function(){this.cleanupActorAnimations();for(var e in this.actors)this.actors[e].removeTeamCircle(),this.actors[e].remove();this.actors={},this.occupiedCells={},this.followers=[],this.customAnimMethods={}},o.prototype.updateMapInfoData=function(e){
if(window.gui.isConnected){var t=this.userActor;if(window.gui.playerData.isSpectator||t.show(),!f.isFightMode){var i,n,o,s=e.actors,a=s.length,r=0;for(i=0;i<a;i++){o=s[i],n=this.getActor(o.contextualId),n||(r+=1);var l=o.staticInfos&&o.staticInfos.underlings;r+=l?l.length:0}for(this.checkCreatureMode(r),i=0;i<a;i++){o=s[i];var c=o.contextualId;c===this.userId&&(t.removeIcons(),this.isoEngine.userPreviousPosition=o.disposition.cellId),n=this.getActor(c),n?n.updateData(o):n=this.addEmptyActor(o),this.setActorLook(c,o.look,{},null),o.staticInfos&&o.staticInfos.underlings&&this.addActorFollowers(n,o.staticInfos.underlings)}this.resetNicknames()}}},o.prototype.updateQuestIcons=function(e){if(e.mapId===this.isoEngine.mapRenderer.mapId){var t,i=this.actors,n=e.npcsIdsWithQuest;for(var o in i)t=i[o],t.isNPC()&&n.indexOf(t.actorId)===-1&&t.removeQuestIcon();for(var s=0;s<n.length;s++)t=this.getActor(n[s]),t&&t.addQuestIcon(e.questFlags[s])}},o.prototype.addActor=function(e,t){var i=this,n=e.contextualId,o=!0,s=this.getActor(n);s?(s.updateData(e),o=!1):s=this.addEmptyActor(e);var a=function(){for(var t in i._queuedToCarryActors){var n=i.getActor(t);n===s&&(n.carryCharacter(i._queuedToCarryActors[t]),delete i._queuedToCarryActors[t])}var o=e.disposition&&e.disposition.carryingCharacterId;if(o){var a=i.getActor(o);a?a.carryCharacter(s):i._queuedToCarryActors[o]=s}};this.setActorLook(n,e.look,{},function(){return e.staticInfos&&e.staticInfos.underlings&&i.addActorFollowers(s,e.staticInfos.underlings),a(),t&&t(i.actors[n])});var r=s.getFighter();return window.gui.playerData.isFighting&&!s.isFollower&&r&&s.addTeamCircle(),this.addedActor(s.actorId),this._attachOrUpdateNicknameLabel(s,o),s},o.prototype._attachOrUpdateNicknameLabel=function(e,t){var i=this._nickNamesOn&&e.isPlayer()&&e.isDisplayed&&!e.isInvisible;i&&(t||!e.nicknameLabel?this._attachNicknameLabel(e):("full"===e.nicknameLabel.getType()&&this._fullNicknameLabelCount--,e.updateNicknameLabel(f.isRoleplayMode&&this._fullNicknameLabelCount<a.maxTitlesOrnaments),"full"===e.nicknameLabel.getType()&&this._fullNicknameLabelCount++))},o.prototype.addEmptyActor=function(e){var t=e.contextualId,i=this.getActor(t);if(i)return i;var n=e.disposition,o=n.cellId,a=n.direction;return i=new s({actorId:t,position:o,cellId:o,direction:a,data:e,scene:this.scene,layer:this.isTransparentModeOn?c.MAP_LAYER_TRANSPARENT:c.MAP_LAYER_PLAYGROUND,alpha:this.isTransparentModeOn?c.TRANSPARENT_MODE_ALPHA:1,actorManager:this}),this.actors[t]=i,i.setDisposition(o,a),i},o.prototype.removeActor=function(e,t){var i,n=this;if(e===this.userId){if(i=this.userActor,!i.isDead)return}else i=this.actors[e];return i?t||!i.moving&&!i.animated?void i.remove():void i.pathTween.onceFinish(function(){n.getActor(e)&&n.removeActor(e)}):console.warn("[ACTOR MANAGER] removeActor: actor not found",e)},o.prototype._removeActor=function(e){var t=!1;e.fighterIndicator&&e.fighterIndicator.remove(),e.removeTurnNumber();var i=e.actorId;this.removeActorOccupation(e),this.customAnimMethods[i]&&delete this.customAnimMethods[i],e.nicknameLabel&&("full"===e.nicknameLabel.getType()&&(this._fullNicknameLabelCount--,t=!0),e.removeNicknameLabel()),e.removeTeamCircle(),delete this.actors[i],e.followers&&this.removeActorFollowers(e),t&&this.refreshNicknames()},o.prototype.removeActors=function(e,t){for(var i=0,n=e.length;i<n;i++)this.removeActor(e[i],t)},o.prototype.resetActors=function(){this.removeAllActors(),this.userActor.show()},o.prototype.actorMovement=function(e,t){var i=e.actorId,n=e.keyMovements,o=n[n.length-1],s=window.isoEngine;if(f.isRoleplayMode&&i===this.userId)return s.roleplayUserActorMovement(n);var a=this.getActor(i);return a?(a.setCellPosition(o),this.paused?(a.position=o,t&&t()):(2===n.length&&(n=l.normalizePath(n)),n.length>1?void(this.isoEngine.mapRenderer.isReady?a.setPath(n,{slide:e.slide,cb:t}):a.setDisposition(o)):t&&t())):(this.addEmptyActor({contextualId:i,disposition:{cellId:o,direction:1}}),t&&t())},o.prototype.setActorsDisposition=function(e,t){for(var i=0,n=e.length;i<n;i++){var o=e[i];if(o.cellId!==-1){var s=o.id,a=this.getActor(s);if(!a){if(t)continue;if(!o.cellId&&0!==o.cellId)continue;var r=window.gui.fightManager.getFighter(s);if(r&&r.data&&!r.data.alive)continue;a=this.addEmptyActor({contextualId:s,disposition:o})}a.cellId===o.cellId&&a.direction===o.direction||a.setDisposition(o.cellId,o.direction)}}},o.prototype.removeActorOccupation=function(e){var t=e.cellId;if(null!==t){var i=this.occupiedCells[t];if(void 0===i)return;var n=i.indexOf(e);n===-1?console.warn("[ActorManager.removeActorOccupation] Trying to remove an actor from an empty cell",e):1===i.length?delete this.occupiedCells[t]:i.splice(n,1)}},o.prototype.addActorOccupation=function(e){var t=e.cellId,i=this.occupiedCells[t];if(void 0===i)this.occupiedCells[t]=[e];else{var n=i.indexOf(e);n===-1?i.push(e):console.warn("[ActorManager.addActorOccupation] Trying to add an actor to a cell that it already belongs to",e)}},o.prototype.computeFollowerPosition=function(e){var t=r.getMapPointFromCellId(e);t.i=t.x,t.j=t.y;for(var i=1;Math.random()<i;){var n=l.getAccessibleCells(t.i,t.j),o=n.length;if(0===o)break;for(var s=[],a=0,c=0;c<o;c++){var u=n[c],d=r.getCellIdFromMapPoint(u.i,u.j),h=void 0===this.occupiedCells[d]?1:v;s[c]=h,a+=h}for(var p=0,m=a*Math.random()-s[0];m>0&&p<o;)p+=1,m-=s[p];t=n[p===o?p-1:p],e=r.getCellIdFromMapPoint(t.i,t.j),i=this.occupiedCells[e]?.995:.8}return e},o.prototype.addActorFollowers=function(e,t,i){var n=t.length;if(0!==n&&(a.showAllMonsters||i)){null===e.followers&&(e.followers=[]);for(var o=e.actorId,s=0;s<n;s++){var r=t[s],l=o+":follower:"+s,c=this.getActor(l);if(!c){var u=this.computeFollowerPosition(e.cellId);c=this.addEmptyActor({contextualId:l,disposition:{cellId:u,direction:1+2*Math.round(3*Math.random())}}),c.isFollower=!0,i===!0?c.isolationCoefficient=M:(c.isolationCoefficient=w,r.staticInfos&&r.staticInfos.isMiniBoss?c.addIcon("miniBoss"):c.removeIcon("miniBoss"),r.staticInfos||console.error("ActorManager#addActorFollowers: no staticInfos","actorId:",o,"followerId:",l)),e.followers.push(c),c.groupBoss=e,c.data=e.data,this.followers.push(c)}this.setActorLook(l,r.look,{},null)}}},o.prototype.removeActorFollowers=function(e,t){var i=e.followers;e.followers=[];var n=[];if(i&&i.length){for(var o=0;o<i.length;o++){var s=i[o];n.push(s.actorId);var a=this.followers.indexOf(s);a!==-1&&this.followers.splice(a,1)}this.removeActors(n,t)}},o.prototype.addAnimBehaviourToActor=function(e,t){var i=this.actors[e];return i?this.customAnimMethods[e]?console.warn("ActorManager.addAnimBehaviourToActor: actor "+e+" already has a custom animation"):this.followers.indexOf(i)!==-1?console.error(new Error("ActorManager.addAnimBehaviourToActor: cannot add an anim behaviour to a follower")):"function"!=typeof t?console.error(new Error("ActorManager.addAnimBehaviourToActor: animationMethod is not a function")):void(this.customAnimMethods[e]=t):console.error(new Error("ActorManager.addAnimBehaviourToActor: actor "+e+" unknown"))},o.prototype._moveFollower=function(e){if(e.moving!==!0){var t=e.cellId,i=r.getMapPointFromCellId(t),n=r.getMapPointFromCellId(e.groupBoss.cellId),o=i.x,s=i.y,a=n.x-o,c=n.y-s,u=Math.sqrt(a*a+c*c);if(1===this.occupiedCells[t].length){var d=.95/(1+(u-1)*e.isolationCoefficient);if(e.groupBoss.moving===!0&&(d*=.8),Math.random()<d)return}for(var h,p={i:i.x,j:i.y},m=[t],f=1;Math.random()<f;){var g=l.getAccessibleCells(p.i,p.j),_=g.length;if(0===_)return;for(var b=[],w=0,M=0;M<_;M++){var T=g[M],C=r.getCellIdFromMapPoint(T.i,T.j),I=void 0===this.occupiedCells[C]?1:v,A=T.i-p.i,S=T.j-p.j;I*=0===A&&0===S?v*v:0===A?Math.pow(y,c/S):Math.pow(y,a/A),b[M]=I,w+=I}for(var E=0,x=w*Math.random()-b[0];x>0&&E<_;)E+=1,x-=b[E];p=g[E===_?E-1:E],h=r.getCellIdFromMapPoint(p.i,p.j),m.push(h),f=1-1/(1+.5*u)}e.setCellPosition(h),e.setPath(m)}},o.prototype.refresh=function(){for(var e in this.customAnimMethods)this.customAnimMethods[e]();var t=this.followers.length;if(t>0){var i=Object.keys(this.actors).length;if(Math.random()>Math.min(.1,b/i))return;for(var n=0;n<t;n++)this._moveFollower(this.followers[n])}},o.prototype.updateActorsAggressableStatus=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=t[i],s=this.getActor(n);if(s&&s.data.humanoidInfo&&s.data.humanoidInfo.options)for(var a=s.data.humanoidInfo.options,r=0;r<a.length;r++){var l=a[r];if("HumanOptionAlliance"===l._type){l.aggressable=o,s.addConquestIcon(l);break}}}},o.prototype.addSmileyOnActor=function(e,t){var i=this.getActor(e);i&&i.addSmileyIcon(t)},o.prototype.setReadyIconOnActor=function(e,t){void 0===t&&(t=!1);var i=this.getActor(e);i&&(t?i.addReadyIconOnActor():i.removeReadyIconOnActor())},o.prototype.removeReadyIcon=function(){for(var e=Object.keys(this.actors),t=e.length,i=0;i<t;i++){var n=this.actors[e[i]];n.removeReadyIconOnActor()}this.userActor.removeReadyIconOnActor()},o.prototype.setTransparentMode=function(e){if(this.isTransparentModeOn!==e){var t,i;e?(t=c.MAP_LAYER_TRANSPARENT,i=c.TRANSPARENT_MODE_ALPHA):(t=c.MAP_LAYER_PLAYGROUND,i=1);for(var n in this.actors){var o=this.actors[n];o.layer=t,o.alpha=i}this.userActor.layer=t,this.userActor.alpha=i,this.isTransparentModeOn=e}},o.prototype.checkCreatureMode=function(e){var t=Object.keys(this.actors).length+e+1,i=a.maxActorsBeforeCreatureMode<t;i=i||g.getValue("creatureMode",!1),this.setCreatureMode(i)},o.prototype.onMaxActorsBeforeCreatureModeChange=function(e){var t=Object.keys(this.actors).length+1,i=e<t;i=i||g.getValue("creatureMode",!1),this.setCreatureMode(i)},o.prototype.setCreatureMode=function(e){if(e!==this.isCreatureModeOn){if(!e)return this._exitCreatureMode();this.isCreatureModeOn=!0,this.userActor.carriedEntity||this.userActor.setCreatureLook({},null);for(var t in this.actors){var i=this.actors[t];i.setCreatureLook({},null),i.fighterIndicator&&(i.fighterIndicator.y=i.bbox[2]-i.y)}this.userActor.carriedEntity&&this.userActor.setCreatureLook({},null)}},o.prototype._exitCreatureMode=function(){if(this.isCreatureModeOn){this.isCreatureModeOn=!1,this.userActor.carriedEntity||this.userActor.useRealLook();for(var e in this.actors){var t=this.actors[e];t.useRealLook(),t.fighterIndicator&&(t.fighterIndicator.y=t.bbox[2]-t.y)}this.userActor.carriedEntity&&this.userActor.useRealLook()}},o.prototype.getPlayers=function(e){var t=[];for(var i in this.actors){var n=this.actors[i];n.data&&(n.data.playerId||0===n.data.playerId)&&t.push(n)}return e&&t.push(this.userActor),t},o.prototype.getActorsIDList=function(){var e=[];for(var t in this.actors){var i=this.actors[t];e.push(i.actorId)}return e.push(this.userActor.actorId),e},o.prototype.turnIndicatorOff=function(){window.isoEngine.mapRenderer.removeMovementFeedback()},o.prototype.turnIndicatorOn=function(e){if(window.isoEngine.mapRenderer.map){this.turnIndicatorOff();var t=this.getActor(e.id);if(t){var i=t.getFighterData(),n=t.getTeamId(),o=e.data.disposition.cellId;if(o!==-1)if(i.isCarryied&&t.parentActor){var s=t.parentActor.bbox[2]+(t.bbox[3]-t.bbox[2]);h.addTurnFeedback({x:t.parentActor.x,y:s,position:o},n)}else h.addTurnFeedback({x:t.x,y:t.y,position:o},n)}}},o.prototype.removeTeamCircles=function(){this.userActor.removeTeamCircle();for(var e=0;e<this.actors.length;e++){var t=this.actors[e];t.removeTeamCircle()}},o.prototype.selectionIndicatorOff=function(e){var t=this.getActor(e.id);t&&t.fighterIndicator&&t.fighterIndicator.remove()},o.prototype.selectionIndicatorOn=function(e){var t=this.getActor(e.id);t&&(t.fighterIndicator&&t.fighterIndicator.remove(),e.data.disposition.cellId!==-1&&(t.fighterIndicator=new p(t.x,t.bbox[2]-12)))},o.prototype.removeAllFighterIndicators=function(){this.userActor.fighterIndicator&&this.userActor.fighterIndicator.remove();for(var e=0;e<this.actors.length;e++){var t=this.actors[e];t.fighterIndicator&&t.fighterIndicator.remove()}},o.prototype.turnNumberOn=function(e,t){function i(e,i){i||(i=e===o.userActor.actorId?o.userActor:o.actors[e]),""===t?i.removeTurnNumber():i.addTurnNumber(t)}var n,o=this;n=e===this.userActor.actorId?this.userActor:this.actors[e],n?i(e,n):this._onIdAdded[e]=i},o.prototype.areNicknamesOn=function(){return this._nickNamesOn},o.prototype.turnNicknamesOn=function(){this._nickNamesOn=!0,this._attachNicknameLabel(this.userActor);for(var e in this.actors){var t=this.actors[e];t.isPlayer()&&t.isDisplayed&&!t.isInvisible&&this._attachNicknameLabel(t)}},o.prototype.refreshNickname=function(e){return e.nicknameLabel?void(e.moving||"full"===e.nicknameLabel.getType()||(e.updateNicknameLabel(f.isRoleplayMode&&this._fullNicknameLabelCount<a.maxTitlesOrnaments),"full"===e.nicknameLabel.getType()&&this._fullNicknameLabelCount++)):void console.warn("Tried to refresh non existing nickname label")},o.prototype.refreshNicknames=function(){this.refreshNickname(this.userActor);for(var e in this.actors){var t=this.actors[e];t.isPlayer()&&t.isDisplayed&&!t.isInvisible&&this.refreshNickname(t)}},o.prototype._attachNicknameLabel=function(e){f.isRoleplayMode&&this._fullNicknameLabelCount<a.maxTitlesOrnaments?(e.addNicknameLabel(!0),e.nicknameLabel&&"full"===e.nicknameLabel.getType()&&this._fullNicknameLabelCount++,e.moving&&e.nicknameLabel.set(e,"name")):e.addNicknameLabel(!1)},o.prototype.turnNicknamesOff=function(){this._nickNamesOn=!1;for(var e in this.actors)this.actors[e].removeNicknameLabel();this.userActor.removeNicknameLabel(),this._fullNicknameLabelCount=0},o.prototype.debugActorIdsOn=function(){for(var e in this.actors)this.actors[e].addNicknameLabel(!1,e);this.userActor.addNicknameLabel(!1,this.userActor.actorId)},o.prototype.debugActorIdsOff=function(){for(var e in this.actors)this.actors[e].removeNicknameLabel();this.userActor.removeNicknameLabel()},o.prototype.addedActor=function(e){var t=this._onIdAdded[e];t&&(t(e),delete this._onIdAdded[e])},o.prototype.allTurnNumbersOff=function(){for(var e in this.actors)this.actors[e].removeTurnNumber();this.userActor.removeTurnNumber()},o.prototype.removeAllCarryStatus=function(e){for(var t in this.actors)this.actors[t].carriedEntity&&e.removeCarrying(this.actors[t]);this.userActor.carriedEntity&&e.removeCarrying(this.userActor)},o.prototype.refreshFighter=function(e){var t=window.actorManager.getActor(e.informations.contextualId);t&&(window.gui.transmitFightSequenceMessage(e),t.setDisposition(e.informations.disposition.cellId,e.informations.disposition.direction),t.setLook(e.informations.look,{},function(){t.applyLook({look:e.informations.look})}))},o.prototype.refreshActorsLook=function(){for(var e in this.actors){var t=this.actors[e];t.refreshLook()}this.userActor.refreshLook()},o.prototype.clearQueuedToCarryActors=function(){this._queuedToCarryActors={}}},function(e,t){e.exports={10:!0,11:!0,20:!0,21:!0,30:!0,31:!0,40:!0,41:!0,50:!0,51:!0,60:!0,61:!0,70:!0,71:!0,80:!0,81:!0,90:!0,91:!0,100:!0,101:!0,110:!0,111:!0,120:!0,121:!0,1405:!0,1407:!0,1437:!0,1438:!0,1663:!0,1664:!0}},function(e,t,i){function n(e,t){this.vertices=[{x:-40,y:60,r:1,g:0,b:0,a:1},{x:40,y:60,r:1,g:0,b:0,a:1},{x:-30,y:50,r:1,g:1,b:0,a:.3},{x:30,y:50,r:1,g:1,b:0,a:.3},{x:-40,y:40,r:1,g:0,b:0,a:1},{x:-30,y:45,r:1,g:1,b:0,a:.3},{x:30,y:45,r:1,g:1,b:0,a:.3},{x:40,y:40,r:1,g:0,b:0,a:1},{x:0,y:10,r:1,g:1,b:0,a:.5},{x:0,y:0,r:1,g:0,b:0,a:1}],this.triangles=[[1,0,2],[2,0,4],[4,5,2],[8,5,4],[4,9,8],[8,9,7],[7,6,8],[3,6,7],[7,1,3],[2,3,1],[3,2,5],[5,6,3],[5,8,6]];var i={scene:window.isoEngine.mapScene,position:1,layer:1,x:e,y:t,id:"FighterIndicator"+u++};o.call(this,i),this._indicatorByteSize=this.renderer.getNbBytesPerVertex()*this.triangles.length*l,this.updated=!0,this.red=1,this.green=1,this.blue=0,this.alpha=1,this.sx=.4,this.sy=.4,this.rotation=Math.PI,this._buffer=new window.ArrayBuffer(this._indicatorByteSize),this._vertexBuffer=new window.Float32Array(this._buffer),this._colorBuffer=new window.Uint32Array(this._buffer),this.loadIndicator(),this.renderer.releaseBuffer(i.id),this.forceRefresh();var n=this,s=this.sx,c=this.sy,d=this.green,h=this.alpha;this.tween=new a(this,["scaleX","scaleY","green","alpha"]).from({scaleX:s,scaleY:c,green:d,alpha:h}).to({scaleX:.25,scaleY:.25,green:.8,alpha:.7},7,r.sineIn).to({scaleX:s,scaleY:c,green:d,alpha:h},7,r.sineOut).onUpdate(function(){n.loadIndicator()}).start(!0)}var o=i(421),s=i(191).inherits,a=i(439).Tween,r=i(439).easing,l=3,c=5,u=0;s(n,o),e.exports=n,n.prototype.loadIndicator=function(){for(var e=1/0,t=-(1/0),i=1/0,n=-(1/0),o=0;o<this.triangles.length;o++)for(var s=0;s<l;s++){var a=(o*l+s)*c,r=this.vertices[this.triangles[o][s]],u=r.x,d=r.y,h=Math.max(-128,Math.min(127,64*r.r)),p=Math.max(-128,Math.min(127,64*this.green)),m=Math.max(-128,Math.min(127,64*r.b)),f=Math.max(-128,Math.min(127,64*(this.alpha&&r.a))),g=(f<<24&4278190080)+(m<<16&16711680)+(p<<8&65280)+(255&h);this._vertexBuffer[a]=u,this._vertexBuffer[a+1]=d,this._colorBuffer[a+3]=g,e>u?e=u:t<u&&(t=u),i>d?i=d:n<d&&(n=d)}this._bbox=[e,t,i,n],this.updated=!0},n.prototype.render=function(){this.renderer.save(),this.renderer.translate(this._x,this._y),0!==this._rotation&&this.renderer.rotate(this._rotation),this.renderer.scale(this._scaleX,this._scaleY),this.updated&&(this.renderer.drawBoxBatch(this.id),this.renderer.releaseBuffer(this.id),this.updated=!1,this.forceRefresh()),this.renderer.restore()},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this.id,i=!1;this.renderer.loadSpriteBuffer(t,this._vertexBuffer,null,this._bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)},n.prototype.remove=function(){this.tween&&this.tween.stop(),o.prototype.remove.call(this)}},function(e,t,i){function n(e,t){t.push(function(t){return window.gui.transmitFightSequenceMessage(e),t()})}function o(e){window.dofus.connectionManager.emit(e._messageType,e)}function s(e,t){var i=window.actorManager.getActor(e.sourceId);i&&t.push(function(t){window.gui.transmitFightSequenceMessage(e),i.oneShootAnim({base:"AnimTacle"},!0,t)})}function a(e,t){var i=window.actorManager,n=i.getActor(e.targetId);t.push(function(t){return window.gui.transmitFightSequenceMessage(e),n?void n.death(t):(console.warn("Actor "+e.targetId+" not found."),t())})}function r(e,t){t.push(function(t){window.gui.transmitFightSequenceMessage(e),e._summon.show(),t()})}function l(e,t){e._doNotProcess||t.push(function(t){window.gui.transmitFightSequenceMessage(e);var i=window.actorManager.getActor(e.targetId);i.applyLook(e._loadedLook),t()})}function c(e,t){t.push(function(t){window.actorManager.refreshFighter(e),t()})}function u(){f=!0,g=!1,_=0,v=null,y=!1,b=null,w=[],S.clearMarks()}function d(){return f?(window.gui.transmitFightSequenceMessage({_messageType:"confirmTurnEnd"}),window.dofus.sendMessage("GameFightTurnReadyMessage",{isReady:!0}),void(g=!1)):void(g=!0)}function h(e){return _>0?void(_-=1):(v._synchronizeBuff=e,window.gui.transmitFightSequenceMessage(v),_=0,void(v=null))}function p(){window.actorManager.removeAllFighterIndicators(),window.actorManager.allTurnNumbersOff(),window.actorManager.removeAllCarryStatus(x);var e=window.gui.fightManager.getFighter(window.actorManager.userActor.actorId);return e&&e.setShield(0),f?(window.gui.transmitFightSequenceMessage(b),y=!1,b=null,window.actorManager.userActor.isDead=!1,void u()):void(y=!0)}function m(e){function t(){function e(){return f=!0,w.length?(v&&h(!1),m(w.shift())):(window.dofus.sendMessage("GameActionAcknowledgementMessage",{valid:!0,actionId:s.actionId}),v&&h(!0),y?p():void(g&&d()))}try{window.gui.fightManager.finishFightSequence(e)}catch(t){console.error("fightManager#finishFightSequence",t),e()}}var i=window.isoEngine;if(!i.mapRenderer.isReady)return i.once("mapLoaded",function(){m(e)});if(window.gui.fightManager.fightState!==N.UNDEFINED){if(!f)return void w.push(e);f=!1;var n=e.sequence,o=n.shift(),s=n.pop();if(o.sequenceType!==s.sequenceType)return console.error(new Error("Different sequenceType"));if(o.authorId!==s.authorId)return console.error(new Error("Different authorId"));var a=new T;return a.runSequence(n,function(e){if(e)return console.error("sequenceAssetPreload error:",e),t();for(var i=[],o=0;o<n.length;o++){var s=n[o],a=O[s._messageType];void 0!==a?a&&a(s,i):console.error(new Error("[process messageSequence] Unsupported game action: "+s._messageType))}try{M.series(i,function(e){e&&console.error("sequenceAnimationEnd error:",e),t()})}catch(r){console.error("sequenceAnimationEnd catch error:",r),t()}})}}var f,g,_,v,y,b,w,M=i(31),T=i(1369),C=i(1375),I=i(1377),A=i(1379),S=i(1380),E=i(1381),x=i(1382),L=i(269),N=i(394).FIGHT_STATES,O={GameMapMovementMessage:A.mapMovement,GameActionFightSlideMessage:A.slideMovement,GameActionFightTeleportOnSameMapMessage:A.teleport,GameActionFightExchangePositionsMessage:A.exchangePositions,GameActionFightCloseCombatMessage:C,GameActionFightSpellCastMessage:C,GameActionFightLifePointsGainMessage:I.lifePointVariation,GameActionFightLifePointsLostMessage:I.lifePointVariation,GameActionFightLifeAndShieldPointsLostMessage:I.lifePointVariation,GameActionFightPointsVariationMessage:I.actionOrMovementPointVariation,GameActionFightDispellableEffectMessage:I.buffVariation,GameActionFightMarkCellsMessage:S.addMark,GameActionFightUnmarkCellsMessage:S.removeMark,GameActionFightTriggerGlyphTrapMessage:S.triggerGlyphTrap,GameActionFightVanishMessage:E.vanish,GameActionFightInvisibilityMessage:E.setVisibility,GameActionFightInvisibleDetectedMessage:E.detected,GameActionFightInvisibleObstacleMessage:null,GameActionFightCarryCharacterMessage:x.carryCharacter,GameActionFightThrowCharacterMessage:x.throwCharacter,GameActionFightDropCharacterMessage:x.dropCharacter,GameActionFightSummonMessage:r,GameActionFightChangeLookMessage:l,GameActionFightTackledMessage:s,_GameActionFightLeaveMessage:a,GameActionFightDeathMessage:a,GameActionFightKillMessage:a,GameActionFightDispellEffectMessage:n,GameActionFightDispellSpellMessage:n,GameActionFightDispellMessage:n,GameActionFightSpellCooldownVariationMessage:n,GameActionFightSpellImmunityMessage:n,GameActionFightReduceDamagesMessage:n,GameActionFightReflectDamagesMessage:n,GameActionFightReflectSpellMessage:n,GameActionFightModifyEffectsDurationMessage:n,GameActionFightDodgePointLossMessage:n,GameFightTurnListMessage:n,GameActionFightStealKamaMessage:null,GameActionFightTriggerEffectMessage:null,GameFightRefreshFighterMessage:c,TextInformationMessage:o,FighterStatsListMessage:n,SequenceStartMessage:null,SequenceEndMessage:null};u(),t.initialize=function(e){function t(e){S.syncMarks(e.marks)}e.on("messageSequence",m),e.on("GameFightTurnReadyRequestMessage",d),e.on("GameFightSynchronizeMessage",function(e){_=w.length,v=e,f&&h(!1)}),e.on("disconnect",function(){u()}),e.on("GameFightLeaveMessage",function(t){var i=t.charId===window.actorManager.userId,n=window.gui,o=n.fightManager.fightState;if(o===N.BATTLE){var s=n.fightManager.getFighter(t.charId);if(s&&s.data.alive){var a={_messageType:"messageSequence",sequence:[{_messageType:"SequenceStartMessage"},{_messageType:"_GameActionFightLeaveMessage",actionId:0,sourceId:0,targetId:t.charId},{_messageType:"SequenceEndMessage"}]};e.emit("messageSequence",a)}}n.transmitFightSequenceMessage(t),i&&e.emit("GameFightEndMessage",{_messageType:"GameFightEndMessage"})}),e.on("FighterStatsListMessage",function(t){var i=window.gui,n=i.fightManager.fightState;if(n===N.BATTLE){var o={_messageType:"messageSequence",sequence:[{_messageType:"SequenceStartMessage"},t,{_messageType:"SequenceEndMessage"}]};e.emit("messageSequence",o)}else i.transmitFightSequenceMessage(t)}),e.on("GameFightEndMessage",function(e){window.actorManager.removeInvisibilityOfAllActors(),b=e,p()}),e.on("GameFightSpectateMessage",t),e.on("GameFightResumeMessage",t),e.on("GameFightResumeWithSlavesMessage",t),e.on("GameContextDestroyMessage",function(){L.isRoleplayMode||f||(y&&window.gui.transmitFightSequenceMessage(b),u())})},t.getCellIdsAffectedByMarks=S.getCellIdsAffectedByMarks},function(e,t,i){function n(e,t,i,n){if(e){var o=n||0;return t===G&&(o=0),{base:"AnimArme",type:o}}if(void 0!==i){var s=i;return t===G&&(s=1),{base:"AnimAttaque",type:s}}return null}function o(e,t){var i=t.actors;return i[e]||(i[e]={}),i[e]}function s(e,t){var i=H(),n=o(e,t);if(!n.position&&0!==n.position){var s=i.actorManager.getActor(e);if(!s)return console.error(new Error("No actor "+e));var a=s.look||{};n.position=s.cellId,n.direction=s.direction,n.bonesId=a.bonesId}return n}function a(e,t,i,n){if(0!==t){var o=H(),a=o.actorManager.getActor(t);if(!a||a.animManager.isTemporary)return console.warn("No actor",t);i.direction=s(t,n).direction,e.addAnimation(a,i)}}function r(e,t){var i=x.getMapPointFromCellId(e),n=x.getMapPointFromCellId(t),o=x.getCoordinateSceneFromGrid(i),s=x.getCoordinateSceneFromGrid(n),a=s.y-o.y,r=s.x-o.x;return Math.atan2(a,r)}function l(e,t,i,n,o,s,a,l,c){o=o||0;var u=L.cellCoord[s];if(u){var d=H(),h=new P({scene:d.isoEngine.mapScene,position:s,x:u.x,y:u.y-(a||0)});if(c){var p;p=c===Y.TOWARD_POSITION2?r(s,l):r(l,s),h.rotation=q[o]?p+Math.PI:p}return t["_"+n+"Orientation"]=o,t["_"+n]=h,e.loadAnimationManager(h,i+"/FX"),h}}function c(e,t,i){var n=window.actorManager,o=n.getActor(t);if(!o)return void console.warn("Source actor does not exist");var s=new R({actorId:i+":"+t,position:o.position,scene:n.scene});return e.loadAnimationManager(s,i+"/FX"),s}function u(e,t,i){t._missileGfx=c(e,t.sourceId||t.casterId,i)}function d(e,t,i,n,o,s,a,r,c,u){var d=m(r,s),h=f(c,r,"casterGfx"===n);return l(e,t,i,n,d,o,a,u,h)}function h(e,t,i,n,o){function s(i,n){var o=a.getCoordinateCellIdFromGrid({i:i,j:n});E&&b===o&&(x=!0,y.stop());var s=d(e,t,c,"trailGfx",o,u,T,C,I,h);s&&(s.scaleX=S,s.scaleY=S,L.push(s))}var a=window.isoEngine.mapRenderer.grid,r=window.actorManager.getActor(t.sourceId||t.casterId),l=t._scriptParams,c=l.trailGfxId,u=i.direction,h=r.position,p=a.getCoordinateGridFromCellId(h),m=p.i,f=p.j,g=a.getCoordinateGridFromCellId(t.destinationCellId||t.targetCellId),_=g.i,v=g.j,y=new D;y.set(m,f,_,v);var b,w=1+(l.trailGfxMinScale||0)/10,M=1+(l.trailGfxMaxScale||0)/10,T=l.targetGfxYOffset2,C=l.trailDisplayType,I=l.targetGfxOriented2,A=t.spellLevel/6,S=M*A+w*(1-A),E=l.endTrailOnTarget,x=!1;E&&(b=n.position);var L=[];y.exec(s);for(var N=Object.keys(o),O=[],R=0;R<N.length;R++)O.push(o[N[R]]);var P=F.createPropertyNameCompareFunc("distanceToPlayer");O.sort(P);for(var B=1;B<O.length&&!x;B++){var k=O[B],z=a.getCoordinateGridFromCellId(k.cellId);s(z.i,z.j)}t._trailGfxs=L,t._trailGfxsOrientation=u}function p(e,t,i,n){if(t._scriptParams.useSpellZone){e.addWaitingRequest();var o=t.sourceId||t.casterId,s=t.destinationCellId||t.targetCellId,a=t.spellId,r=t.spellLevel;window.gui.fightManager.getFighterSpell(a,o,function(o,a){var l;if(o)console.error(o),l=[];else{var c=a;if(c.setLevel(r),!window.isoEngine.mapRenderer.map||!window.isoEngine.mapRenderer.map.cells)return e.removeWaitingRequest();var u=window.isoEngine.mapRenderer.map.cells;l=B(u,i.position,s,c.getZoneEffect())}h(e,t,i,n,l),e.removeWaitingRequest()})}else h(e,t,i,n,[])}function m(e,t){switch(e){case U.RANDOM:return Math.floor(8*Math.random());case U.ORIENTED:return t;default:return 0}}function f(e,t,i){return t===U.ORIENTED?Y.NONE:e?i?Y.TOWARD_POSITION2:Y.TOWARD_POSITION1:Y.NONE}function g(e,t,i){var o="GameActionFightCloseCombatMessage"===t._messageType,r="GameRolePlaySpellAnimMessage"===t._messageType,c=t.sourceId||t.casterId,h=s(c,i);if(h){if(t.destinationCellId!==-1&&h.position!==t.destinationCellId){var m=x.getOrientation(h.position,t.destinationCellId,!1);h.direction=m,t._casterOrientation=m}if(!t.silentCast){var f,g;if(t.targetId){if(f=s(t.targetId,i),!f)return;g=F.isActorVisibleToUser(t.targetId)?f.position:null}else f={direction:1};var _=g||t.destinationCellId||t.targetCellId;t._targetCellId=_;var v=t._scriptParams||{};if(v.casterGfxId&&d(e,t,v.casterGfxId,"casterGfx",h.position,h.direction,v.casterGfxYOffset,v.casterGfxDisplayType,v.casterGfxOriented,_),v.targetGfxId&&d(e,t,v.targetGfxId,"targetGfx",_,h.direction,v.targetGfxYOffset,v.targetGfxDisplayType,v.targetGfxOriented,h.position),v.targetGfxId2&&d(e,t,v.targetGfxId2,"targetGfx2",_,h.direction,v.targetGfxYOffset2,v.targetGfxDisplayType2,v.targetGfxOriented2,h.position),r){var y=v.animId;y&&!v.targetGfxId&&(v.targetGfxId2&&console.error(new Error("Message contains a targetGfdId2 and ")),l(e,t,y,"targetGfx2",1,_)),t._spellAnimSymbol={base:"AnimAttaque",type:403}}else v.missileGfxId&&u(e,t,v.missileGfxId),t._spellAnimSymbol=n(o,h&&h.bonesId,v.animId,t._weaponTypeId);v.trailGfxId&&p(e,t,h,f),t._spellAnimSymbol&&a(e,c,t._spellAnimSymbol,i);for(var b=t._lifeVariationMsgs||[],w=t._deadIds,M=0;M<b.length;M++){var T=b[M],C=T.targetId;w&&w.indexOf(C)!==-1?T._isDead=!0:b[M].loss&&a(e,C,{base:"AnimHit"},i)}}}}function _(e,t,i){var n=window.actorManager.getActor(t.sourceId);n&&!n.animManager.isVoidAnimManager&&(e.addAnimation(n,{base:"carrying",direction:-1}),a(e,t.sourceId,{base:"AnimPickup"},i),t._direction=s(t.sourceId,i).direction)}function v(e,t,i){a(e,t.sourceId,{base:"AnimDrop"},i),t._direction=s(t.sourceId,i).direction}function y(e,t,i){a(e,t.sourceId,{base:"AnimThrow"},i),t._throwingProjectile=c(e,t.sourceId,W),t._direction=s(t.sourceId,i).direction}function b(e,t){window.gui.fightManager.loadFighter(t);var i=e.loadActor(t.summon);i.hide(),t._summon=i}function w(e,t,i){var n=o(t.targetId,i);if(n.look!==t.entityLook)return void(t._doNotProcess=!0);var s=window.actorManager.getActor(t.targetId);e.loadLook(t,s,t.entityLook)}function M(e,t){var i=t.informations,n=window.actorManager.getActor(i.contextualId);e.loadLook(t,n,i.look)}function T(e,t,i){a(e,t.targetId,{base:"AnimMort"},i),t._animSymbol="AnimMort"}function C(e,t,i){a(e,t.targetId,{base:"AnimHit"},i),t._animSymbol="AnimHit"}function I(e,t,i){a(e,t.sourceId,{base:"AnimTacle"},i)}function A(e,t,i){a(e,t.targetId,{base:"AnimVanish"},i)}function S(e,t){var i=t.mark;i._glyphGfxId&&l(e,i,i._glyphGfxId,"glyph",0,0)}function E(){}var x=i(895),L=i(756),N=i(1370),O=i(184),D=i(1371),R=i(1372),P=i(425),B=i(1374).getSpellEffectZone,k=i(426),F=i(252),z=i(419),H=i(189),q=O.ANIM_SYMETRY,W="21209",U={NORMAL:0,RANDOM:1,ORIENTED:2},Y={NONE:0,TOWARD_POSITION1:1,TOWARD_POSITION2:2},G=1107,j={GameActionFightSpellCastMessage:g,GameActionFightCloseCombatMessage:g,GameActionFightChangeLookMessage:w,GameActionFightSummonMessage:b,GameActionFightDeathMessage:T,GameActionFightKillMessage:T,GameActionFightTackledMessage:I,GameActionFightMarkCellsMessage:S,GameActionFightCarryCharacterMessage:_,GameActionFightThrowCharacterMessage:y,GameActionFightDropCharacterMessage:v,_GameActionFightLeaveMessage:T,GameActionFightVanishMessage:A,GameActionFightLifeAndShieldPointsLostMessage:C,GameActionFightLifePointsLostMessage:C,GameFightRefreshFighterMessage:M,GameRolePlaySpellAnimMessage:g};E.prototype.runSequence=function(e,t){var i=N(e);this.nAssetsToLoad=1,this.nAssetsLoaded=0;var n=this;this.onAssetsLoaded=function(){if(n.nAssetsLoaded+=1,n.nAssetsLoaded===n.nAssetsToLoad)return t()},this.reduceNumberOfAssetsToLoad=function(){if(n.nAssetsToLoad-=1,n.nAssetsLoaded===n.nAssetsToLoad)return t()};for(var o=0;o<e.length;o++){var s=e[o],a=j[s._messageType];a&&a(this,s,i)}this.onAssetsLoaded()},E.prototype.addAnimation=function(e,t){this.nAssetsToLoad+=1,e.animManager.addAnimation(t,this.onAssetsLoaded)},E.prototype.loadAnimationManager=function(e,t){this.nAssetsToLoad+=1,k.loadAnimationManager(e,"bone",t,this.onAssetsLoaded)},E.prototype.loadActor=function(e){return this.nAssetsToLoad+=1,window.actorManager.addActor(e,this.onAssetsLoaded)},E.prototype.loadLook=function(e,t,i){this.nAssetsToLoad+=1;var n=this.onAssetsLoaded,o={addToSprite:!1};t._isCandidateToHideTheMountInFight(i)&&(i=z.getLookWithoutMount(i)),k.loadLook(t,i,o,function(t){e._loadedLook={animationManager:t,look:i},n()})},E.prototype.addWaitingRequest=function(){this.nAssetsToLoad+=1},E.prototype.removeWaitingRequest=function(){this.reduceNumberOfAssetsToLoad()},e.exports=E},function(e,t,i){function n(){f={},g=null;
}function o(e){return f[e]||(f[e]={id:e}),f[e]}function s(e){var t=o(e.targetId);return t?(t.death=!0,void(g&&g._deadIds.push(e.targetId))):console.error("Actor "+e.targetId+" not found.")}function a(e){var t=o(e.sourceId);t.tackled=!0}function r(e){g&&(e._spell=g,g._pointVariationMsgs.push(e))}function l(e){g&&(e._spell=g,g._lifeVariationMsgs.push(e))}function c(e){var t=window.actorManager.getActor(e.targetId);t&&t.setOnScreenPosition(e.cellId)}function u(e){var t=o(e.targetId);t.look=e.entityLook}function d(e){var t=e.summon.contextualId,i=o(t),n=e.summon.disposition;i.position=n.cellId,i.direction=n.direction,i.isSummoned=!0,g&&(g.targetId=t)}function h(e){g=e,g._deadIds=[],g._lifeVariationMsgs=[],g._pointVariationMsgs=[]}function p(e){if(e.cellId!==-1){var t=window.actorManager.getActor(e.sourceId);t&&1===_.getDistance(t.cellId,e.cellId)&&(e._messageType="GameActionFightDropCharacterMessage")}}function m(){g=null}var f,g,_=i(895),v={GameActionFightCloseCombatMessage:h,GameActionFightSpellCastMessage:h,GameMapMovementMessage:null,GameActionFightSlideMessage:null,GameActionFightPointsVariationMessage:r,GameActionFightLifeAndShieldPointsLostMessage:l,GameActionFightLifePointsGainMessage:l,GameActionFightLifePointsLostMessage:l,GameActionFightTeleportOnSameMapMessage:null,GameActionFightExchangePositionsMessage:null,GameActionFightSummonMessage:d,GameActionFightMarkCellsMessage:null,GameActionFightUnmarkCellsMessage:null,GameActionFightChangeLookMessage:u,GameActionFightInvisibilityMessage:null,_GameActionFightLeaveMessage:s,GameActionFightDeathMessage:s,GameActionFightKillMessage:s,GameActionFightVanishMessage:null,GameActionFightTriggerEffectMessage:null,GameActionFightDispellEffectMessage:null,GameActionFightDispellSpellMessage:null,GameActionFightDispellMessage:null,GameActionFightDodgePointLossMessage:null,GameActionFightSpellCooldownVariationMessage:null,GameActionFightSpellImmunityMessage:null,GameActionFightInvisibleObstacleMessage:null,GameActionFightReduceDamagesMessage:null,GameActionFightReflectDamagesMessage:null,GameActionFightReflectSpellMessage:null,GameActionFightStealKamaMessage:null,GameActionFightTackledMessage:a,GameActionFightTriggerGlyphTrapMessage:m,GameActionFightDispellableEffectMessage:null,GameActionFightModifyEffectsDurationMessage:null,GameActionFightCarryCharacterMessage:null,GameActionFightThrowCharacterMessage:p,GameActionFightDropCharacterMessage:null,GameActionFightInvisibleDetectedMessage:c,GameFightTurnListMessage:null,GameRolePlaySpellAnimMessage:null};e.exports=function(e){n();for(var t=0;t<e.length;t++){var i=e[t],o=v[i._messageType];o&&o(i)}return{actors:f}}},function(e,t){function i(){this.sourceX=0,this.sourceY=0,this.targetX=0,this.targetY=0,this.x=0,this.y=0,this.incX=0,this.incY=0,this.error=0,this.deltaError=0,this._stop=!1,this.cb=null}e.exports=i,i.prototype.set=function(e,t,i,n){this.sourceX=~~e||0,this.sourceY=~~t||0,this.targetX=~~i||0,this.targetY=~~n||0},i.prototype.exec=function(e){var t=[];e&&"function"==typeof e||(e=function(e,i){t.push([e,i])}),this.cb=e,this._stop=!1,this.error=0,this.deltaError=0,this.x=this.sourceX,this.y=this.sourceY;var i=this.targetX-this.sourceX,n=this.targetY-this.sourceY,o=Math.abs(i),s=Math.abs(n);this.incX=i>0?1:-1,this.incY=n>0?1:-1;var a;for(0===i&&0===n?(this._stop=!0,a=null):0===i?a=this._vertical:0===n?a=this._horizontal:o===s?a=this._equalSlope:o>s?(a=this._xSlope,this.deltaError=s/o):(a=this._ySlope,this.deltaError=o/s);!this._stop;)a.apply(this),this.x===this.targetX&&this.y===this.targetY&&(this._stop=!0),this.cb(this.x,this.y,!0);return t},i.prototype.stop=function(){this._stop=!0},i.prototype._horizontal=function(){this.x+=this.incX},i.prototype._vertical=function(){this.y+=this.incY},i.prototype._equalSlope=function(){this.x+=this.incX,this.y+=this.incY},i.prototype._xSlope=function(){this.error+=this.deltaError,this.error>=.5&&(this.y+=this.incY,this.error-=1),this.x+=this.incX},i.prototype._ySlope=function(){this.error+=this.deltaError,this.error>=.5&&(this.x+=this.incX,this.error-=1),this.y+=this.incY}},function(e,t,i){function n(e){s.call(this,e,e.animManager),this.actorId=void 0!==e.actorId?e.actorId:null,this.path=[],this.step=0,this.moving=!1}var o=i(191).inherits,s=i(420),a=i(439).Tween,r=i(1373).prepare(3),l=i(1371),c=i(756),u=i(895),d=new l,h={base:"FX",direction:0};o(n,s),e.exports=n,n.prototype.isFx=!0,n.prototype.isTapped=function(){return!1},n.prototype.tap=function(){},n.prototype.refreshAnimation=function(e){if(this.moving===!0){var t=this.path,i=this.step,n=~~i,o=this.prevCoords,s={x:r([this.source[0],this.bezier[0],this.target[0]],i/this.pathLength),y:r([this.source[1],this.bezier[1],this.target[1]],i/this.pathLength)};this.x=s.x,this.y=s.y;var a=s.x-o.x,l=s.y-o.y;this.rotation=Math.atan2(l,a);var c=t[n];c!==this.prevPos&&(this.position=c),this.prevPos=c,this.prevCoords=s}this._refreshAnimation(e)},n.prototype._startPath=function(e){this.animManager.assignSymbol(h,!0),this.moving=!0;var t=this;new a(this,["step"]).from({step:0}).to({step:this.pathLength},this.duration).start().onFinish(function(){return t.remove(),e()})},n.prototype.launch=function(e,t,i,n,o){var s=window.isoEngine.mapRenderer.map;if(!s)return o(new Error("map is null, isReady is "+window.isoEngine.mapRenderer.isReady));var a=s.cells,r=this.position,l=[r],h=u.getMapPointFromCellId(r),p=u.getMapPointFromCellId(e);d.set(h.x,h.y,p.x,p.y),d.exec(function(e,t){l.push(u.getCellIdFromMapPoint(e,t))}),this.path=l,this.pathLength=l.length,this.mirrored=h.x>p.x,this.scaleY=this.mirrored?-1:1;var m=c.getCellCoord(r),f=c.getCellCoord(e),g=Math.abs(f.x-m.x),_=Math.abs(f.y-m.y),v=Math.sqrt(g*g+_*_);this.duration=v/10*t/1e3*24,m.y-=(a[r].f||0)+n,f.y-=(a[e].f||0)+n,m=[m.x,m.y],f=[f.x,f.y],this.source=m,this.target=f,this.bezier=[(m[0]+f[0])/2,(m[1]+f[1])/2-v*i],this.prevPos=r,this.prevCoords={x:2*m[0]-this.bezier[0],y:2*m[1]-this.bezier[1]},this._startPath(o)}},function(e,t){function i(e,t){return n(e.length)(e,t)}function n(e){if(e=0|+e,!e)throw new Error("Cannot create a interpolator with no elements");if(l[e])return l[e];for(var t=["var ut = 1 - t",""],i=e;i--;){for(var n=0;n<i;n+=1)i+1===e?t.push("var p"+n+" = arr["+n+"] * ut + arr["+(n+1)+"] * t"):i>1?t.push("p"+n+" = p"+n+" * ut + p"+(n+1)+" * t"):t.push("return p"+n+" * ut + p"+(n+1)+" * t");i>1&&t.push("")}return t=["return function bezier"+e+"(arr, t) {",t.map(function(e){return"  "+e}).join("\n"),"}"].join("\n"),Function(t)()}function o(e){return e[0]}function s(e,t){return e[0]+(e[1]-e[0])*t}function a(e,t){var i=1-t;return(e[0]*i+e[1]*t)*i+(e[1]*i+e[2]*t)*t}function r(e,t){var i=1-t,n=e[1]*i+e[2]*t;return((e[0]*i+e[1]*t)*i+n*t)*i+(n*i+(e[2]*i+e[3]*t)*t)*t}var l={1:o,2:s,3:a,4:r};e.exports=i,e.exports.prepare=n},function(e,t,i){function n(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++)for(var a=0;a<s;a++){var r=s-a;o.push([e+a,t-r,s]),o.push([e+r,t+a,s]),o.push([e-a,t+r,s]),o.push([e-r,t-a,s])}return o}function o(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++)o.push([e-s,t,s]),o.push([e+s,t,s]),o.push([e,t-s,s]),o.push([e,t+s,s]);return o}function s(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++)o.push([e-s,t-s,s]),o.push([e-s,t+s,s]),o.push([e+s,t-s,s]),o.push([e+s,t+s,s]);return o}function a(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++)o.push([e-s,t,s]),o.push([e+s,t,s]),o.push([e,t-s,s]),o.push([e,t+s,s]),o.push([e-s,t-s,s]),o.push([e-s,t+s,s]),o.push([e+s,t-s,s]),o.push([e+s,t+s,s]);return o}function r(e,t,i,n){var o=[];0===i&&o.push([e,t,0]);for(var s=i||1;s<=n;s++){o.push([e-s,t,s]),o.push([e+s,t,s]),o.push([e,t-s,s]),o.push([e,t+s,s]),o.push([e-s,t-s,s]),o.push([e-s,t+s,s]),o.push([e+s,t-s,s]),o.push([e+s,t+s,s]);for(var a=1;a<s;a++)o.push([e+s,t+a,s]),o.push([e+s,t-a,s]),o.push([e-s,t+a,s]),o.push([e-s,t-a,s]),o.push([e+a,t+s,s]),o.push([e-a,t+s,s]),o.push([e+a,t-s,s]),o.push([e-a,t-s,s])}return o}function l(e,t,i,n,o,s){for(var a=[],r=i;r<=n;r++){var l=e+r*o,c=t+r*s;a.push([l,c,r]);for(var u=1;u<=r;u++)a.push([l+u*s,c-u*o,r]),a.push([l-u*s,c+u*o,r])}return a}function c(e,t,i,n,o,s){var a=[];0===i&&a.push([e,t,0]);for(var r=i||1;r<=n;r++){var l=e-r*o,c=t-r*s;a.push([l+r*s,c-r*o,r]),a.push([l-r*s,c+r*o,r])}return a}function u(e,t,i,n){for(var o=[],s=i||1;s<=n;s++){o.push([e-s,t,s]),o.push([e+s,t,s]),o.push([e,t-s,s]),o.push([e,t+s,s]);for(var a=1;a<s;a++)o.push([e+s,t+a,s]),o.push([e+s,t-a,s]),o.push([e-s,t+a,s]),o.push([e-s,t-a,s]),o.push([e+a,t+s,s]),o.push([e-a,t+s,s]),o.push([e+a,t-s,s]),o.push([e-a,t-s,s])}return o}function d(e,t,i,n,o,s){for(var a=[],r=i;r<=n;r++)a.push([e+o*r,t+s*r,r]);return a}function h(e,t,i,o){return n(e,t,o,o)}function p(e,t,i,o){return n(e,t,o,y)}function m(e,t,i,n,o,s){var a=[];0===i&&a.push([e,t,0]);for(var r=i||1;r<=n;r++)a.push([e+s*r,t-o*r,r]),a.push([e-s*r,t+o*r,r]);return a}function f(e,t,i,n){for(var o=_.getMapPointFromCellId(t),s=n(o.x,o.y,0,i),a=[],r=0;r<s.length;r++){var l=_.getCellIdFromMapPoint(s[r][0],s[r][1]);if(void 0!==l){var c=e[l].l||0;1===(5&c)&&a.push(l)}}return a}var g=i(302),_=i(895),v=i(303),y=39;e.exports.getSpellRange=function(e,t,i){var a,r=_.getMapPointFromCellId(t);return a=i.castInLine&&i.castInDiagonal?o(r.x,r.y,i.minRange,i.range).concat(s(r.x,r.y,i.minRange,i.range)):i.castInLine?o(r.x,r.y,i.minRange,i.range):i.castInDiagonal?s(r.x,r.y,i.minRange,i.range):n(r.x,r.y,i.minRange,i.range)},e.exports.getCircleArea=function(e,t,i){return f(e,t,i,n)},e.exports.getCrossArea=function(e,t,i){return f(e,t,i,o)};var b={P:null,A:null,D:null,X:{fn:o,hasDirection:!1,withoutCenter:!1},L:{fn:d,hasDirection:!0,withoutCenter:!1},T:{fn:m,hasDirection:!0,withoutCenter:!1},C:{fn:n,hasDirection:!1,withoutCenter:!1},O:{fn:h,hasDirection:!1,withoutCenter:!1},"+":{fn:s,hasDirection:!1,withoutCenter:!1},G:{fn:r,hasDirection:!1,withoutCenter:!1},V:{fn:l,hasDirection:!0,withoutCenter:!1},W:{fn:u,hasDirection:!1,withoutCenter:!1},"/":{fn:d,hasDirection:!0,withoutCenter:!1},"-":{fn:m,hasDirection:!0,withoutCenter:!1},U:{fn:c,hasDirection:!0,withoutCenter:!1},Q:{fn:o,hasDirection:!1,withoutCenter:!0},"#":{fn:s,hasDirection:!1,withoutCenter:!0},"*":{fn:a,hasDirection:!1,withoutCenter:!1},I:{fn:p,hasDirection:!1,withoutCenter:!1}};e.exports.getSpellEffectZone=function(e,t,i,n){var o={},s=b[n.zoneShape];if(s){var a,r,l=_.getMapPointFromCellId(i);if(s.hasDirection){var c=_.getMapPointFromCellId(t);a=l.x===c.x?0:l.x>c.x?1:-1,r=l.y===c.y?0:l.y>c.y?1:-1}for(var u=s.withoutCenter?n.zoneMinSize||1:n.zoneMinSize,d=s.fn(l.x,l.y,u,n.zoneSize,a,r),h=0;h<d.length;h++){var p=_.getCellIdFromMapPoint(d[h][0],d[h][1]);if(void 0!==p){var m=e[p].l||0;1===(5&m)&&(o[p]=new g(p,d[h][2],window.foreground.fightIsUserTurn?v.areaOfEffect:v.areaOfEffectEnemyTurn))}}}else void 0===s&&console.error("Incorrect Effect shape id: "+n.zoneShape),o[i]=new g(i,0,window.foreground.fightIsUserTurn?v.areaOfEffect:v.areaOfEffectEnemyTurn);return o}},function(e,t,i){var n=i(1376),o=i(1377),s=i(439).Delay,a=i(190),r=17;e.exports=function(e,t){function i(i){t.push(function(t){return n.playGfx(e._targetGfx,e._targetGfxOrientation,p.targetGfxShowUnder,i?t:null),!i&&t()})}function l(){t.push(function(t){return n.playGfx(e._targetGfx2,e._targetGfx2Orientation,p.targetGfxShowUnder2),t()})}var c=window.actorManager,u=c.getActor(e.sourceId||e.casterId),d=c.getActorsIDList().join(", "),h=e._casterOrientation;h&&t.push(function(e){return u?u.setDisposition(null,h):console.error(new Error("Cannot setDisposition of source undefined. Before: "+d+" After: "+c.getActorsIDList().join(", "))),e()});var p=e._scriptParams||{};if(a.allowSpellEffects&&!e.silentCast){var m=e._spellAnimSymbol;m&&t.push(function(e){if(u){u.oneShootAnim(m,!0);var t=u.animManager.nbFrames;return new s(Math.min(r,t),e).start()}return console.error(new Error("Cannot oneShootAnim of source undefined. Before: "+d+" After: "+c.getActorsIDList().join(", "))),e()});var f=e._targetCellId||e.destinationCellId!==-1;f&&(e._targetGfx&&p.playTargetGfxFirst&&i(),e._targetGfx2&&p.playTargetGfxFirst2&&l()),p.casterGfxId&&t.push(function(t){return n.playGfx(e._casterGfx,e._casterGfxOrientation,p.casterGfxShowUnder),t()}),e._missileGfx&&e.destinationCellId!==-1&&t.push(function(t){e._missileGfx.launch(e.destinationCellId,void 0!==p.missileSpeed?p.missileSpeed+10:10,(p.missileCurvature||0)/10,p.missileGfxYOffset||0,t)}),p.trailGfxId&&t.push(function(t){n.playGfxTrailAnimation(e._trailGfxs,e._trailGfxsOrientation,p.trailGfxShowUnder,t)}),f&&(e._targetGfx&&!p.playTargetGfxFirst&&i(),e._targetGfx2&&!p.playTargetGfxFirst2&&l())}var g=e._lifeVariationMsgs&&e._lifeVariationMsgs.length>0;g&&(o.lifePointVariationBatch(e._lifeVariationMsgs,t),t.push(function(t){for(var i=0;i<e._lifeVariationMsgs.length;i++){var n=e._lifeVariationMsgs[i];if(!(n._isDead||n.delta>0)){var o=c.getActor(n.targetId);if(o){var s={base:n._animSymbol||"AnimHit"};o.oneShootAnim(s,!0)}else console.error("Target "+n.targetId+" is missing to play hit animation")}}return t()}));var _=e._pointVariationMsgs&&e._pointVariationMsgs.length>0;_&&o.actionOrMovementPointVariationBatch(e._pointVariationMsgs,t),(g||_)&&t.push(function(e){new s(15,e).start()}),t.push(function(t){return window.gui.transmitFightSequenceMessage(e),t()})}},function(e,t,i){function n(e,t,i,n){e.position+=i?-.1:.1,e.animManager.assignSymbol({base:"FX",direction:t},!1,function(){if(e.remove(),n)return n()})}function o(e,t,i,o){new s(o,function(){n(e,t,i)}).start()}var s=i(439).Delay,a=3;t.playGfx=n,t.playGfxTrailAnimation=function(e,t,i,n){for(var r=0,l=0;l<e.length;l+=1)o(e[l],t,i,r),r+=a;new s(r,n).start()}},function(e,t,i){function n(e){var t=Date.now(),i=M[e];if(i&&t<i+T){var n=i+T;return M[e]=n,n-t}return M[e]=t,0}function o(e){var t=window.isoEngine.bitmapFonts;if(t){var i=e.maxRotation||0,o=new l({position:0,layer:c.MAP_LAYER_POINT_LABELS,bitmapFont:t.numbers,scene:window.actorManager.scene,text:e.pointVariation,color:e.color||f,x:e.x+30*(Math.random()-.5),y:e.y+30*(Math.random()-.5),rotation:(Math.random()-.5)*i});o.hide();var s=n(e.targetId)*c.TIME_UNITS_PER_SECOND/1e3;new h(s,function(){new u(o.highlight,["red","green","blue"]).from({red:1,green:1,blue:1}).to({red:4,green:4,blue:4},3,d.polyOut,4).to({red:1,green:1,blue:1},8,d.polyOut,4).start(),new u(o,["scaleX","scaleY"]).from({scaleX:.2,scaleY:.2}).to({scaleX:1.8,scaleY:1.8},4,d.polyOut,4).to({scaleX:1,scaleY:1},10,d.polyOut,4).start();var e=o.rotation,t=(Math.random()-.5)*e;new u(o,["y","rotation"]).from({y:o.y,rotation:e}).to({y:o.y,rotation:e},8).to({y:o.y-60,rotation:t},30,d.polyOut,7).start(),new u(o,["alpha"]).from({alpha:0}).to({alpha:1},3,d.polyOut,4).to({alpha:0},38,d.polyIn,4).start().onFinish(function(){o.remove()}),o.show()}).start()}}function s(e,t){var i=window.actorManager.getActor(e.targetId);if(i){var n=window.gui.fightManager.isFighterOnUsersTeam(e.targetId),s=window.actorManager.isActorInvisible(e.targetId),a=e.actionId===m.ACTION_CHARACTER_MOVEMENT_POINTS_USE;if((n||!a||!s)&&(e.shieldLoss||0!==e.delta&&0!==e.loss)){var r;r=e.actionId===m.ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS||e.actionId===m.ACTION_CHARACTER_DEBOOST_ACTION_POINTS?"-"+e.delta:e.delta?e.delta>0?"+"+e.delta:e.delta:e.shieldLoss?"-"+e.shieldLoss:"-"+e.loss,o({x:i.x,y:i.y-70,maxRotation:.3,color:t,pointVariation:r,targetId:e.targetId})}}}function a(e,t,i){return!e._spell&&i&&(p.showApMpUsed||e.actionId!==m.ACTION_CHARACTER_MOVEMENT_POINTS_USE&&e.actionId!==m.ACTION_CHARACTER_ACTION_POINTS_USE)?void t.push(function(t){return s(e,i),window.gui.transmitFightSequenceMessage(e),t()}):t.push(function(t){return window.gui.transmitFightSequenceMessage(e),t()})}function r(e,t){t.push(function(t){for(var i=0;i<e.length;i++){var n=e[i];(p.showApMpUsed||n.actionId!==m.ACTION_CHARACTER_MOVEMENT_POINTS_USE&&n.actionId!==m.ACTION_CHARACTER_ACTION_POINTS_USE)&&n._labelColor&&s(n,n._labelColor)}return t()})}var l=i(1378),c=i(184),u=i(439).Tween,d=i(439).easing,h=i(439).Delay,p=i(190),m=i(399),f=[0,0,0,0],g=[.5,-.3,-.3,0],_=[.3,.3,-.5,0],v=[-.2,-.3,.5,0],y=[.2,.5,-.2,0],b=[.3,0,.5,0],w={};w[m.ACTION_CHARACTER_ACTION_POINTS_USE]=v,w[m.ACTION_CHARACTER_MOVEMENT_POINTS_USE]=y,w[m.ACTION_CHARACTER_MOVEMENT_POINTS_LOST]=y,w[m.ACTION_CHARACTER_ACTION_POINTS_LOST]=v,w[m.ACTION_CHARACTER_BOOST_ACTION_POINTS]=v,w[m.ACTION_CHARACTER_DEBOOST_ACTION_POINTS]=v,w[m.ACTION_CHARACTER_BOOST_MOVEMENT_POINTS]=y,w[m.ACTION_CHARACTER_DEBOOST_MOVEMENT_POINTS]=y,w[m.ACTION_CHARACTER_ACTION_POINTS_WIN]=v;var M={},T=500;t.createPointVariationLabel=o,t.lifePointVariation=function(e,t){e.shieldLoss?a(e,t,b):e._spell&&2===e._spell.critical?a(e,t,_):a(e,t,g)},t.actionOrMovementPointVariation=function(e,t){p.showApMpUsed||e.actionId===m.ACTION_CHARACTER_ACTION_POINTS_LOST||e.actionId===m.ACTION_CHARACTER_MOVEMENT_POINTS_LOST?a(e,t,w[e.actionId]):a(e,t,null)},t.buffVariation=function(e,t){"FightTemporaryBoostEffect"===e.effect._type&&(e.effect.actionId=e.actionId,a(e.effect,t,w[e.actionId])),t.push(function(t){return window.gui.transmitFightSequenceMessage(e),t()})},t.lifePointVariationBatch=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];n.shieldLoss?n._labelColor=b:n._spell&&2===n._spell.critical?n._labelColor=_:n._labelColor=g}r(e,t)},t.actionOrMovementPointVariationBatch=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];n._labelColor=w[n.actionId]}r(e,t)}},function(e,t,i){function n(e){e.id="textSpriteCount"+a++,s.call(this,e);var t=e.bitmapFont;this.characterDimensions=t.dimensions,this.texture=t.texture,this._characterByteSize=this.renderer.getNbBytesPerSprite(),this._bbox=[1/0,-(1/0),1/0,-(1/0)];var i=e.text;"number"==typeof i&&(i=i.toString());for(var n=0;n<i.length;n+=1)" "===i[n]||this.characterDimensions[i[n]]||(e.fallbackText||0===e.fallbackText?(console.error(new Error("TextSprite: character "+i[n]+" not in bitmap font: using fallback text")),i=e.fallbackText,"number"==typeof i&&(i=i.toString()),e.fallbackText=null,n=-1):(console.error(new Error("TextSprite: character "+i[n]+' not in bitmap font: replacing with a "."')),i=i.substr(0,n)+"."+i.substr(n+1)));this.textWidth=0,this.textHeight=0;var o,r,l,c=30;for(o=0;o<i.length;o+=1)r=i[o]," "===r?this.textWidth+=c:(l=this.characterDimensions[r],this.textWidth+=l.w,l.h>this.textHeight&&(this.textHeight=l.h));var u=-this.textWidth/2,d=-this.textHeight/2;for(this._bbox[0]=u,this._bbox[1]=u+this.textWidth,this._bbox[2]=d,this._bbox[3]=d+this.textHeight,this.characterPositions=[],o=0;o<i.length;o+=1)if(r=i[o]," "===r)u+=c;else{l=this.characterDimensions[r];var h=(this.textHeight-l.h)/2;this.characterPositions[o]={x:u,y:d+h},u+=l.w}this._createVertexBuffer(i,e.color)}var o=i(191).inherits,s=i(421),a=0;o(n,s),e.exports=n,n.prototype._createVertexBuffer=function(e,t){var i=e.length;this._vertexBuffer=new window.ArrayBuffer(i*this._characterByteSize),this._floatView=new window.Float32Array(this._vertexBuffer),this._longView=new window.Uint32Array(this._vertexBuffer);for(var n=this._floatView,o=this._longView,s=this._longView,a=this.texture.element.width,r=this.texture.element.height,l=0;l<e.length;l+=1){var c=e[l];if(" "!==c){var u=this.characterPositions[l],d=this.characterDimensions[c],h=l*this._characterByteSize/4,p=u.x,m=u.x+d.w,f=u.y,g=u.y+d.h;n[h+0]=p,n[h+1]=f,n[h+5]=p,n[h+6]=g,n[h+10]=m,n[h+11]=g,n[h+15]=p,n[h+16]=f,n[h+20]=m,n[h+21]=g,n[h+25]=m,n[h+26]=f;var _=d.x/a*65535&65535,v=d.y/r*4294901760&4294901760,y=(d.x+d.w)/a*65535&65535,b=(d.y+d.h)/r*4294901760&4294901760;o[h+2]=_+v,o[h+7]=_+b,o[h+12]=y+b,o[h+17]=_+v,o[h+22]=y+b,o[h+27]=y+v;var w=1077952576;s[h+3]=s[h+8]=s[h+13]=w,s[h+18]=s[h+23]=s[h+28]=w;var M=Math.max(-128,Math.min(127,128*t[0])),T=Math.max(-128,Math.min(127,128*t[1])),C=Math.max(-128,Math.min(127,128*t[2])),I=Math.max(-128,Math.min(127,128*t[3])),A=(I<<24&4278190080)+(C<<16&16711680)+(T<<8&65280)+(255&M);s[h+4]=s[h+9]=s[h+14]=A,s[h+19]=s[h+24]=s[h+29]=A}}this.renderer.releaseBuffer(this.id),this.forceRefresh()},n.prototype.draw=function(){this.renderer.drawSpriteBatch(this.id)},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this._floatView,i=!1;this.renderer.loadSpriteBuffer(this.id,t,this.texture,this.bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t){function i(e){e===window.actorManager.userId&&window.isoEngine.displayUserMovementZone()}function n(e){e===window.actorManager.userId&&window.isoEngine.clearUserMovementZone()}t.mapMovement=function(e,t){t.push(function(t){n(e.actorId),window.gui.transmitFightSequenceMessage(e),window.actorManager.actorMovement(e,t)})},t.slideMovement=function(e,t){e.startCellId!==-1&&e.endCellId!==-1&&t.push(function(t){n(e.actorId),window.gui.transmitFightSequenceMessage(e),window.actorManager.actorMovement({actorId:e.targetId,keyMovements:[e.startCellId,e.endCellId],slide:!0},t)})},t.teleport=function(e,t){if(e.cellId!==-1){var n=window.actorManager.getActor(e.targetId);n&&t.push(function(t){return window.gui.transmitFightSequenceMessage(e),n.setDisposition(e.cellId),i(e.targetId),t()})}},t.exchangePositions=function(e,t){var n=window.actorManager.getActor(e.sourceId),o=window.actorManager.getActor(e.targetId);t.push(function(t){return window.gui.transmitFightSequenceMessage(e),n&&n.setDisposition(e.casterCellId),o&&o.setDisposition(e.targetCellId),i(e.sourceId),i(e.targetId),t()})}},function(e,t,i){function n(e){var t=window.background,i=window.isoEngine,s=i.mapRenderer.map;if(!s)return i.once("mapLoaded",function(){n(e)});p[e.markId]=e;for(var a=e._glyph,c=0,d=e.cells.length;c<d;c++){var m=e.cells[c],f=m.cellId,g=l.parseIndexedColor(m.cellColor).color,_="rgba("+g.r+","+g.g+","+g.b+", 0.6)",v="rgba("+g.r+","+g.g+","+g.b+", 0.3)",y=o(m),b={spellId:e.markSpellId},w=new u(y,{color:v,outline:_,data:b});if(a){var M=r.cellCoord[f];a.x=M.x,a.y=M.y,a.position=f-.1,a.animManager.assignSymbol(h,!1),w.gfx=a}t.addZone(w,"mark:"+e.markId)}}function o(e){var t=window.isoEngine.mapRenderer.map;if(!t)return console.error(new Error("Can't get mark shape, map isn't ready yet")),[];var i=0===e.cellsType?a.getCircleArea:a.getCrossArea;return i(t.cells,e.cellId,e.zoneSize)}function s(e){return e._glyphGfxId&&!e._glyph?(e._glyph=new c({scene:window.isoEngine.mapScene}),void d.loadAnimationManager(e._glyph,"bone",e._glyphGfxId+"/FX",function(){n(e)})):void n(e)}var a=i(1374),r=i(756),l=i(424),c=i(425),u=i(1354),d=i(426),h={base:"FX",direction:0},p={};t.addMark=function(e,t){t.push(function(t){return n(e.mark),t()})},t.removeMark=function(e,t){delete p[e.markId];var i=window.background;t.push(function(t){return i.deleteZoneById("mark:"+e.markId,function(e){var t=e.gfx;e.gfx=null,t&&t.animManager.assignSymbol(h,!1,function(){t.remove()})}),t()})},t.triggerGlyphTrap=function(e,t){t.push(function(t){var i=window.background.getDataOfZoneId("mark:"+e.markId);return i?(e._spellId=i.spellId,window.gui.transmitFightSequenceMessage(e),t()):(console.warn("No data found for zone: mark:"+e.markId),t())})},t.syncMarks=function(e){for(var t=0;t<e.length;t++)s(e[t])},t.clearMarks=function(){p={}},t.getCellIdsAffectedByMarks=function(){for(var e={},t=Object.keys(p),i=0;i<t.length;i++)for(var n=p[t[i]],s=0;s<n.cells.length;s++)for(var a=o(n.cells[s]),r=0;r<a.length;r+=1){var l=a[r];e[l]||(e[l]=[]),e[l].push(n)}return e}},function(e,t){t.setVisibility=function(e,t){var i=window.actorManager,n=i.getActor(e.targetId);n&&t.push(function(t){window.gui.transmitFightSequenceMessage(e);var i=n.getFighterData();return n.setInvisibility(e.state,i.teamId),t()})},t.vanish=function(e,t){var i=window.actorManager,n=i.getActor(e.targetId);return n?void t.push(function(t){window.gui.transmitFightSequenceMessage(e),n.oneShootAnim({base:"AnimVanish"},!1,function(){return i.removeActor(e.targetId),t()})}):console.warn("No found actor with id "+e.targetId)},t.detected=function(e,t){var i=window.actorManager,n=i.getActor(e.targetId);if(!n)return console.error("No found actor with id "+e.targetId);var o=n.getFighterData(),s=i.userActor.getFighterData();o.teamId!==s.teamId&&t.push(function(e){return n.invisibleDetectedAnimation(),e()})}},function(e,t,i){function n(e){var t=!window.actorManager.isCreatureModeOn&&e.riderEntity||e.animManager;t.removeAnimationModifier("AnimStatique"),t.removeAnimationModifier("AnimMarche"),t.removeAnimationModifier("AnimCourse"),t.removeAnimationModifier("AnimHit"),t.removeAnimationModifier("AnimTacle"),t.removeSubentity(e.carriedEntity),e.carriedActor?e.carriedActor.parentActor=null:console.warn("attempted to drop actor that did not exist."),e.carriedEntity=null,e.carriedActor=null}var o=i(441),s=i(439).Delay,a=3;t.carryCharacter=function(e,t){var i=window.actorManager,n=i.getActor(e.sourceId),s=i.getActor(e.targetId);if(n&&s){var r={base:"AnimPickup",direction:e._direction},l=!i.isCreatureModeOn&&n.riderEntity||n.animManager,c={animManager:s.animManager,bindingPoint:"carried_3_0",symbolModifier:o[a],bindingPointCategory:a};s.parentActor=n,n.carriedEntity=c,n.carriedActor=s,s.getFighterData().isCarryied=!0,t.push(function(e){i.isCreatureModeOn||(l.addAnimationModifier("AnimStatique","AnimStatiqueCarrying"),l.addAnimationModifier("AnimMarche","AnimMarcheCarrying"),l.addAnimationModifier("AnimCourse","AnimCourseCarrying"),l.addAnimationModifier("AnimHit","AnimHitCarrying"),l.addAnimationModifier("AnimTacle","AnimTacleCarrying")),l.addSubentity(c),s.setDisposition(n.cellId),s.y=-1e3,n.oneShootAnim(r,!0,e)})}},t.removeCarrying=n,t.throwCharacter=function(e,t){var i=window.actorManager,o=i.getActor(e.targetId),a=i.getActor(e.sourceId);if(a&&o){var r=e.cellId,l={base:"AnimThrow",direction:e._direction};o.getFighterData().isCarryied=!1,t.push(function(e){a.oneShootAnim(l,!1,function(){n(a),a.staticAnim()});var t=new s(7,e);t.start(!1)}),r!==-1&&(t.push(function(t){e._throwingProjectile.launch(r,13,.3,70,t)}),t.push(function(t){return o.setDisposition(r),window.gui.transmitFightSequenceMessage(e),t()}))}},t.dropCharacter=function(e,t){var i=window.actorManager,o=i.getActor(e.sourceId),s=i.getActor(e.targetId);if(o){var a={base:"AnimDrop",direction:e._direction};s.getFighterData().isCarryied=!1,t.push(function(t){o.oneShootAnim(a,!1,function(){return n(o),s.setDisposition(e.cellId),o.staticAnim(),window.gui.transmitFightSequenceMessage(e),t()})})}}},function(e,t,i){function n(){this._queue=[],this._actionMap={},this._isActive=!1,this._currentActionId=null,this._endOfQueueOnly=!1}var o=i(184).ELEMENT_TYPE_ID,s=i(30),a=null;e.exports=n,n.prototype.initialize=function(){a||s.getAllDataMap("Interactives",function(e,t){if(e)return void console.error(new Error("ActionQueue.staticContent.getAllDataMap: "+e));a={};for(var i in t)1!==t[i].actionId&&(a[i]=!0);a[o.UNSPECIFIED]=!0})},n.prototype.enqueue=function(e,t,i){return!!this.canQueueMore()&&(this._isActive?!!this._actionMap[e]||(this._queue.push({actionId:e,action:i,endOfQueueOnly:t}),this._actionMap[e]=!0,!0):(this._isActive=!0,this._actionMap[e]=!0,this._currentActionId=e,this._endOfQueueOnly=t,i(),!0))},n.prototype.enqueueInteractive=function(e,t,i){var n=a&&a[t]||!1;return this.enqueue(e,n,i)},n.prototype.dequeue=function(e){if(this._isActive&&this._isCurrentAction(e)){delete this._actionMap[e];var t=this._queue.shift();if(!t)return void this.clear();this._currentActionId=t.actionId,this._endOfQueueOnly=t.endOfQueueOnly,t.action()}},n.prototype.canQueueMore=function(){if(!this._isActive)return!0;var e;return e=this._queue.length>0?!this._queue[this._queue.length-1].endOfQueueOnly:!this._endOfQueueOnly},n.prototype.isActive=function(){return this._isActive},n.prototype._isCurrentAction=function(e){return this._currentActionId===e},n.prototype.clear=function(){this._queue=[],this._actionMap={},this._isActive=!1,this._currentActionId=null,this._endOfQueueOnly=!1}},function(e,t,i){function n(e,t){return t.position-e.position}function o(e){switch(e){case 183:case 200:case 212:case 213:return!0;default:return!1}}function s(e){return 84===e&&window.gui.playerData.hasRight(v.JUMP_HOUSE)}function a(e,t){var i={red:1,green:1,blue:1},n={red:1.8,green:1.8,blue:1.8},o=new w(e.highlight,["red","green","blue"]);o.from(i);for(var s=0;s<t;s++)o.to(n,12),o.to(i,12);o.start()}var r=i(184),l=i(1347),c=i(895),u=i(29).getText,d=i(29).getTextFailover,h=i(1378),p=i(1385),m=i(876),f=i(1377),g=i(394).FIGHT_STATES,_=i(1386).trueName,v=i(493),y=i(439),b=y.Delay,w=y.Tween,M=y.easing,T={red:1.7,green:1.7,blue:1.7,alpha:1},C=10,I={DEFAULT:1,QUEUE:2},A=r.ELEMENT_TYPE_ID,S=[{elementTypeId:A.ZAAP,skillId:114},{elementTypeId:A.UNSPECIFIED,skillId:84},{elementTypeId:A.UNSPECIFIED,skillId:104},{elementTypeId:A.PADDOCK,skillId:175}],E=3e3,x={},L=null,N=4,O=4,D=new window.Uint8Array(N*O*4),R=null;l.prototype._isElementClicked=function(e,t,i){if(!e.isWithinBounds(t,i))return!1;var n=N,o=O;t-=n/2,i-=o/2;var s=e.renderer;null===R&&(R=s.startTextureUsage(n,o,1,"clickedInteractive")),s.startTextureRendering(R,t,t+n,i,i+o,!0),e.render();var a=s.gl;a.readPixels(0,0,n,o,a.RGBA,a.UNSIGNED_BYTE,D),s.stopTextureRendering();for(var r=D.length,l=0,c=3;c<r;c+=4)l+=D[c];return l>8},l.prototype._getAllInteractives=function(){for(var e=this.mapRenderer,t=e.identifiedElements,i=e.interactiveElements,o=this.actorManager.actors,s=[],a=Object.keys(i),r=0;r<a.length;r+=1){var l=a[r],c=i[l];if(0!==c.enabledSkills.length||0!==c.disabledSkills.length){var u=t[l];u&&s.push(u)}}for(var d=Object.keys(o),h=0;h<d.length;h+=1)s.push(o[d[h]]);return s.push(this.actorManager.userActor),s.sort(n),s},l.prototype._tapInteractive=function(e,t){var i,n=this.mapRenderer.interactiveElements,a=this._getAllInteractives(),r=window.gui.playerData.isAlive(),l=null,c=null,u=null;for(i=0;i<a.length;i++){var d=a[i];if(this._isElementClicked(d,e,t))if(d.actorId)if(d.isNPC()){if(!l){var h=d.data.npcData&&d.data.npcData.actions&&d.data.npcData.actions.length>0;(r||h)&&(l=d)}}else u||(u=d);else c||(c=d)}var p;if(p=this.actorManager.isTransparentModeOn?u||c||l:l||c||u,null===p)return this._lastTapId=null,!1;var m=!1,f=p.id||p.actorId,g=_([p._position,window.gui.playerData.position.mapId,f]);g===this._lastTapId?(m=!0,this._lastTapId=null):this._lastTapId=g,this.clearHighlights(null,I.DEFAULT);var v=this.actionQueue.isActive();if(p.tap)return v||(m&&p.actorId&&"GameRolePlayGroupMonsterInformations"===p.data.type?window.isoEngine.attackActor(p.actorId):p.tap(e,t)),!0;var y=n[p.id];if(!y)return!0;var b,w;if(1===y.enabledSkills.length){w=y.enabledSkills[0];var M=w.skillId;o(M)||s(M)||(b=w)}if(v&&!b)for(i=0;i<y.enabledSkills.length;i++)if(w=y.enabledSkills[i],w.skillId===this.lastContextualMenuSkillId){b=w;break}if(b){var T=this,C=this.actionQueue.enqueueInteractive(y.elementId,y.elementTypeId,function(){for(var e=!1,t=0;t<y.enabledSkills.length;t++){var i=y.enabledSkills[t];if(i.skillId===b.skillId){e=!0;break}}return e?void T.queueUseInteractive(y.elementId,b.skillInstanceUid):(T.actionQueue.clear(),T.clearHighlights(null,I.QUEUE))});return C?(this._addHighlight(p,I.QUEUE),!0):(!v&&1===y.enabledSkills.length&&b&&(this.instantUseInteractive(y.elementId,b.skillInstanceUid),this._addHighlight(p)),!0)}if(v)return!0;if(this._addHighlight(p),m)for(var A=0;A<S.length;A++)if(y.elementTypeId===S[A].elementTypeId)for(var E=0;E<y.enabledSkills.length;E++)if(y.enabledSkills[E].skillId===S[A].skillId)return this.instantUseInteractive(y.elementId,y.enabledSkills[E].skillInstanceUid),!0;var x=this.mapScene.convertSceneToCanvasCoordinate(e,t);return window.gui.openContextualMenu("interactive",y,{x:x.x,y:x.y}),!0},l.prototype._addHighlight=function(e,t){t=t||I.DEFAULT,e.highlight=T,this.highlightedElements[t]||(this.highlightedElements[t]=[]),this.highlightedElements[t].push(e)},l.prototype._clearHighlightType=function(e){var t=this.highlightedElements[e];if(t){for(var i=0;i<t.length;i++)t[i].highlight=null;this.highlightedElements[e]=[]}},l.prototype.clearHighlights=function(e,t){if(e){var i=this,n=new b(e,function(){i.clearHighlights(null,t)});return n.start();
}if(t)this._clearHighlightType(t);else{for(var o in this.highlightedElements)this._clearHighlightType(o);this.highlightedElements={}}},l.prototype.queueUseInteractive=function(e,t){this.clearHighlights(null,I.DEFAULT),this._useInteractive(e,t)},l.prototype.instantUseInteractive=function(e,t){this.clearHighlights(C),this._useInteractive(e,t)},l.prototype.useInteractive=function(e,t){this.clearHighlights(),this._useInteractive(e,t)},l.prototype._useInteractive=function(e,t){var i=this,n=this.mapRenderer.identifiedElements[e],o=n.position,s=this.actorManager.userActor,a=function(){var n=c.getOrientation(s.cellId,o,!1);s.setDisposition(null,n),i._interactiveUseTrackServerAnswer(e,t),window.dofus.sendMessage("InteractiveUseRequestMessage",{elemId:e,skillInstanceUid:t})};return c.areCellsNeighbours(s.cellId,o,!0)?a():void this._movePlayerOnMap(o,!0,a)},l.prototype.onInteractiveUseErrorMessage=function(e){var t=e.elemId;void 0!==x[t]&&(window.clearTimeout(x[t]),delete x[t]),this.actionQueue.dequeue(t);var i=this.mapRenderer.identifiedElements[t];i&&(i.highlight=null)},l.prototype._interactiveUseTrackServerAnswer=function(e){var t=this;x[e]=window.setTimeout(function(){console.warn("Server has been too slow to answer to an interactiveUseRequest: we are not waiting for him"),delete x[e],t.actionQueue.dequeue(e)},E)},l.prototype.isWaitingForInteractiveUseServerAnswer=function(){return Object.keys(x).length>0},l.prototype.interactiveUseStart=function(e){var t=this,i=this.actorManager.getActor(e.entityId),n=this.mapRenderer.identifiedElements[e.elemId],o=e.entityId===window.gui.playerData.id,s=0!==e.duration;if(o&&(void 0!==x[e.elemId]&&(window.clearTimeout(x[e.elemId]),delete x[e.elemId]),null!==L&&(console.error("interactiveUseStart: InteractiveUseStart received but was waiting an InteractiveUseEnded"),this._userStopUsingInteractive())),!i)return o?console.error("interactiveUseStart: user actor is not ready"):console.warn("interactiveUseStart: no actor with id "+e.entityId);if(!n)return console[o?"error":"warn"]("interactiveUseStart: no interactive with id "+e.elemId);var a=e._useAnimation;if(!a||"AnimStatique"===a)return void(o&&t.actionQueue.dequeue(e.elemId));n.highlight=null;var r=c.getOrientation(i.cellId,n.position,!1);return i.setDisposition(null,r),i.loadAndPlayAnimation({base:a},s),s?void(o?(i.isLocked=!0,L=window.setTimeout(function(){t._userStopUsingInteractive(e.elemId)},100*e.duration*2)):window.setTimeout(function(){i.staticAnim()},100*e.duration)):void(o&&t.actionQueue.dequeue(e.elemId))},l.prototype.interactiveUseEndedMessage=function(e){this._userStopUsingInteractive(e.elemId)},l.prototype._userStopUsingInteractive=function(e){null!==L&&(clearTimeout(L),L=null);var t=this.actorManager.userActor;t.isLocked=!1,t.staticAnim(),this.actionQueue.dequeue(e)},l.prototype.updateInteractiveElements=function(e){this.mapRenderer.updateInteractiveElements(e)},l.prototype.updateObstacles=function(e){this.mapRenderer.updateObstacles(e)},l.prototype.updateStatedElements=function(e){this.mapRenderer.updateStatedElements(e)},l.prototype.addObjects=function(e){this.mapRenderer.addObjects(e)},l.prototype.removeObjects=function(e){this.mapRenderer.removeObjects(e)},l.prototype._removeArrowsNowAndLater=function(e){this.removeArrows(),this.arrowTimeout&&(window.clearTimeout(this.arrowTimeout),this.arrowTimeout=null);var t=this;this.arrowTimeout=window.setTimeout(function(){t.arrowTimeout=null,t.removeArrows()},e)},l.prototype.addArrowOnCell=function(e,t,i,n,o){this.mapRenderer.addArrowOnCell(e,t,i,n,o)},l.prototype.addArrowOnGraphic=function(e,t,i,n,o){this.mapRenderer.addArrowOnGraphic(e,t,i,n,o)},l.prototype.addArrowsSequence=function(e,t,i,n){this.mapRenderer.addArrowsSequence(e,t,i,n)};var P={upLeft:{npc:[-.3,-3],monster:[-.5,-2]},downLeft:{npc:[-.5,-.3],monster:[-.5,.5]}};l.prototype._addArrowOnActor=function(e,t,i){var n=t?"monster":"npc",o="upLeft",s=P[o][n],a=s[0],l=s[1];e.y+l<60&&(o="downLeft",s=P[o][n],a=s[0],l=s[1]),i&&this._removeArrowsNowAndLater(i),this.mapRenderer.addArrowOnCell(e.cellId,a*r.CELL_WIDTH,l*r.CELL_HEIGHT,o)},l.prototype.addArrowOnNpc=function(e,t){var i=this.actorManager.getActorFromNpcId(e);return i?void this._addArrowOnActor(i,!1,t):console.warn("NPC not found with ID: "+e)},l.prototype.addArrowOnMonster=function(e,t){var i=this.actorManager.getActorFromMonsterId(e);return i?void this._addArrowOnActor(i,!0,t):console.warn("Monster not found with ID: "+e)},l.prototype.removeArrows=function(){this.mapRenderer.removeArrows()},l.prototype.highlightAllInteractives=function(e){e=e||1;var t=this.mapRenderer.interactiveElements,i=this.mapRenderer.identifiedElements,n=window.gui.fightManager.fightState,o=n===g.PREPARATION||n===g.BATTLE;for(var s in t){var r=t[s],l=i[s],c=l instanceof m;l&&(o&&!c||0===r.enabledSkills.length&&0===r.disabledSkills.length||a(l,e))}},l.prototype.highlightInteractivesWithDifferentType=function(){var e,t,i=this.mapRenderer.interactiveElements,n=this.mapRenderer.identifiedElements,o={};for(e in i){var s=i[e],r=n[e];r&&0!==s.enabledSkills.length&&(t=s.elementTypeId,o[t]||(o[t]=[]),o[t].push(r))}var l=[];for(t in o)if(~~t===A.UNSPECIFIED)l=l.concat(o[t]);else{var c=o[t].length,u=~~(Math.random()*c);l.push(o[t][u])}for(var d=0;d<l.length;d++)a(l[d],5)},l.prototype.displayNumericalValue=function(e){var t=this.actorManager.getActor(e.entityId);if(!t)return console.error("No entity with id",e.entityId);var i=t.x,n=t.y-80;f.createPointVariationLabel({x:i,y:n,pointVariation:"+"+e.value,color:[.2,-.1,-.2,0],maxRotation:.4}),e.valueOfBonus&&f.createPointVariationLabel({x:i,y:n,pointVariation:"+"+e.valueOfBonus,color:[.7,0,-.3,0],maxRotation:.4,targetId:e.entityId})};var B=0;l.prototype.displayTextBanner=function(e){if(this.bitmapFonts&&!window.gui.fightManager.isInactive){var t=u(e),i=d(e),n=this.mapScene,o=n.w/2,s=n.h/2,a=this.bitmapFonts.characters,l=new h({x:o,y:s,scene:n,text:t,fallbackText:i,position:2*B+1,layer:r.MAP_LAYER_POINT_LABELS,bitmapFont:a,color:[.2,.5,-.2,0],isHudElement:!0}),c=a.dimensions.bann,m=l.textWidth,f=l.textHeight,g=c.h,_=c.w,v=2,y=Math.floor(_/2-v),b=c.x,T=c.y,C=new p({x:o,y:s-f/2,scene:n,position:2*B,layer:r.MAP_LAYER_POINT_LABELS,texture:a.texture,controlPoints:[{x:-m/2-y,u:b,y:0,v:T},{x:-m/2,u:b+y,y:0,v:T},{x:m/2,u:b+y+v,y:g,v:T+g},{x:m/2+y,u:b+_,y:g,v:T+g}],isHudElement:!0}),I=new w(l,["y","alpha"]).from({y:s-30,alpha:0}).to({y:s-30,alpha:0},4).to({y:s,alpha:1},8,M.backOut,2).to({y:s,alpha:1},17).to({y:s-30,alpha:0},8,M.backIn,2).onFinish(function(){l.remove()}).start(),A=new w(C,["scaleX","alpha"]).from({scaleX:.7,alpha:0}).to({scaleX:1,alpha:1},8,M.backOut,2).to({scaleX:1,alpha:1},24).to({scaleX:.7,alpha:0},8,M.backIn,2).onFinish(function(){C.remove()}).start();B+=1,null!==this._currentBannerTweens.backTween&&(this._currentBannerTweens.backTween.starting||this._currentBannerTweens.backTween.playing)&&(this._currentBannerTweens.backTween.reset().to({scaleX:.7,alpha:0},8,M.polyOut,2).start(),this._currentBannerTweens.textTween.reset().to({y:s-30,alpha:0},8,M.polyOut,2).start()),this._currentBannerTweens.backTween=A,this._currentBannerTweens.textTween=I}},l.prototype.highlightActorOnAction=function(e,t){var i=this.actorManager.getActor(e);return i?(this._addHighlight(i),void this.clearHighlights(t||C)):console.warn("Actor with id "+e+" to highlight not found.")},l.prototype.interactiveDisconnect=function(){for(var e=Object.keys(x),t=0;t<e.length;t++)window.clearTimeout(x[e[t]]),delete x[e[t]];this.actionQueue.clear()}},function(e,t,i){function n(e){e.id="grid9ScaleCount"+a++,s.call(this,e),this._spriteByteSize=this.renderer.getNbBytesPerSprite(),this._bbox=[1/0,-(1/0),1/0,-(1/0)],this.controlPoints=e.controlPoints;var t=this.controlPoints[0],i=this.controlPoints[3];this.w=i.x-t.x,this.h=i.y-t.y,this._bbox[0]=t.x,this._bbox[1]=i.x,this._bbox[2]=t.y,this._bbox[3]=i.y,this.texture=e.texture,this._createVertexBuffer()}var o=i(191).inherits,s=i(421),a=0;o(n,s),e.exports=n,n.prototype._populateSpriteVertexBuffer=function(e,t,i,n,o,s,a,r,l){var c=this._floatView,u=this._longView,d=this._longView,h=this.texture.element.width,p=this.texture.element.height,m=e*this._spriteByteSize/4;c[m+0]=t,c[m+1]=s,c[m+5]=t,c[m+6]=r,c[m+10]=n,c[m+11]=r,c[m+15]=t,c[m+16]=s,c[m+20]=n,c[m+21]=r,c[m+25]=n,c[m+26]=s;var f=i/h*65535&65535,g=o/h*65535&65535,_=a/p*4294901760&4294901760,v=l/p*4294901760&4294901760;u[m+2]=f+_,u[m+7]=f+v,u[m+12]=g+v,u[m+17]=f+_,u[m+22]=g+v,u[m+27]=g+_;var y=1077952576;d[m+3]=d[m+8]=d[m+13]=y,d[m+18]=d[m+23]=d[m+28]=y},n.prototype._createVertexBuffer=function(){this._vertexBuffer=new window.ArrayBuffer(9*this._spriteByteSize),this._floatView=new window.Float32Array(this._vertexBuffer),this._longView=new window.Uint32Array(this._vertexBuffer);var e=this.controlPoints[0],t=this.controlPoints[1],i=this.controlPoints[2],n=this.controlPoints[3];this._populateSpriteVertexBuffer(0,e.x,e.u,t.x,t.u,e.y,e.v,t.y,t.v),this._populateSpriteVertexBuffer(1,t.x,t.u,i.x,i.u,e.y,e.v,t.y,t.v),this._populateSpriteVertexBuffer(2,i.x,i.u,n.x,n.u,e.y,e.v,t.y,t.v),this._populateSpriteVertexBuffer(3,e.x,e.u,t.x,t.u,t.y,t.v,i.y,i.v),this._populateSpriteVertexBuffer(4,t.x,t.u,i.x,i.u,t.y,t.v,i.y,i.v),this._populateSpriteVertexBuffer(5,i.x,i.u,n.x,n.u,t.y,t.v,i.y,i.v),this._populateSpriteVertexBuffer(6,e.x,e.u,t.x,t.u,i.y,i.v,n.y,n.v),this._populateSpriteVertexBuffer(7,t.x,t.u,i.x,i.u,i.y,i.v,n.y,n.v),this._populateSpriteVertexBuffer(8,i.x,i.u,n.x,n.u,i.y,i.v,n.y,n.v),this.renderer.releaseBuffer(this.id),this.forceRefresh()},n.prototype.draw=function(){this.renderer.drawSpriteBatch(this.id)},n.prototype.generateCurrentFrameData=function(){var e=this.renderer.getBufferData(this.id);if(void 0===e){var t=this._floatView,i=!1;this.renderer.loadSpriteBuffer(this.id,t,this.texture,this.bbox,i),this.renderer.lockBuffer(this.id)}return this._bbox},n.prototype.clear=function(){this.renderer.releaseBuffer(this.id)}},function(e,t){var i=Array.isArray;t.emaNeurt=function(e){return t.trueName(e,"")},t.trueName=function n(e,t){var o=(typeof e)[0],s="";if(t){if("object"==typeof t&&(t=t.valueOf()),"string"!=typeof t)throw new TypeError("Invalid type for salt: must be a string");s=t}var a=e;if("o"===o&&null!==e&&(a=e.valueOf()),o=(typeof a)[0],"o"!==o||null===a)return s.concat(o,a);if(a instanceof Date)return s.concat("d",a.toJSON());if(a instanceof RegExp)return s.concat("r",a.toString());if("f"===o)throw new TypeError("Invalid type: function");i(a)&&(o="a");var r,l;r=Object.keys(a),r.sort();for(var c=0;c<r.length;c+=1)l=r[c],s=s.concat(o,l,n(a[l]));return s}},function(e,t,i){function n(e,t){e?(C=!0,window.foreground.showInfobox(e,t)):C&&(C=!1,window.foreground.hideInfobox())}function o(){M=null,I=null,n(!1)}function s(){T=null,o()}function a(e,t,i,n,o,s){s.push(t);for(var r=e[t],l=r.pathNodes,c=null,u=0;u<l.length;u+=1){var d=l[u];if(d.from===i){c=new b;break}var h=o-n;if(!(0===h||h+1<d.distance-1)&&s.indexOf(d.from)===-1&&(c=a(e,d.from,i,n+1,o,w(s))))break}return c&&c.addNode(t,r,n),c}function r(e,t,i,n){var o=i[t];return o?(o.path||(o.path=a(i,t,e,0,n-1,[])),o.path):null}var l=i(1347),c=i(1388),u=i(894).compressPath,d=i(1371),h=i(895),p=i(258).playUiSound,m=i(302),f=i(303),g=i(1390),_=i(190),v=i(1386).trueName,y=i(196),b=i(1391),w=i(205).shallowCopyArray,M=null,T=null,C=!1,I=null,A=new d;l.prototype.fightTurnStart=function(e){this._previousTurn=this._isUserTurn,this._isUserTurn=e,window.background.hideTargetHighlights(),this._resetFightPositionLayer(),this._previousTurn!==this._isUserTurn&&(e?this._enemyToUserTurn():this._userToEnemyTurn()),this._resetWalkLayer(),s()},l.prototype._switchTurn=function(e,t,i,n,o){if(this._spellRangeLayer){for(var s={},a=this._spellRangeLayer.cellInfos,r=Object.keys(a),l=0;l<r.length;l++){var c=a[r[l]];c.transformState===e?s[c.cellId]=new m(c.cellId,c.distanceToPlayer,t):c.transformState===i&&(s[c.cellId]=new m(c.cellId,c.distanceToPlayer,n))}0!==Object.keys(s).length&&this._resetSpellRangeLayer(s)}if(this._spellEffectLayer){for(s={},a=this._spellEffectLayer.cellInfos,r=Object.keys(a),l=0;l<r.length;l++)c=a[r[l]],s[c.cellId]=new m(c.cellId,c.distanceToPlayer,o);this._resetSpellEffectLayer(s)}},l.prototype._enemyToUserTurn=function(){window.background.showTargetHighlights(),window.foreground.confirmBox.show(),this._switchTurn(f.inSightEnemyTurn,f.inSight,f.outSightEnemyTurn,f.outSight,f.areaOfEffect)},l.prototype._userToEnemyTurn=function(){this._switchTurn(f.inSight,f.inSightEnemyTurn,f.outSight,f.outSightEnemyTurn,f.areaOfEffectEnemyTurn)},l.prototype.touchCancel=function(){this.clearHighlights(),s()},l.prototype.touchMove=function(e,t,i){var n=this.mapScene.convertCanvasToSceneCoordinate(e,t),o=this.mapRenderer.getCellId(n.x,n.y).cell;if(M!==o)if(M=o,"fight"===i.mode&&void 0!==i.spellId)this.displayEffectZone(o);else if("fight"===i.mode&&this._isUserTurn){var s=this.actorManager.occupiedCells;s[o]?this._resetWalkLayer():(window.foreground.confirmBox.close(),I=this._displayPathInFight(o))}},l.prototype._displayPathInFight=function(e){var t=this.actorManager.userActor,i=t.cellId;T=T||c.getReachableZone(t,i);var s=e;if(!T[e]){var a=h.getMapPointFromCellId(i),l=h.getMapPointFromCellId(s);A.set(a.x,a.y,l.x,l.y),A.exec(function(e,t){var i=h.getCellIdFromMapPoint(e,t);T[i]?s=i:A.stop()})}var u=t.getFighterData(),d=u.stats,p=r(i,s,T,d.movementPoints);if(!p)return o();for(var g=p.reachable[p.reachable.length-1],_={},v=0;v<p.reachable.length;v++)_[p.reachable[v]]=new m(p.reachable[v],p.reachableMap[p.reachable[v]],f.walkable);for(var y=0;y<p.unreachable.length;y++)_[p.unreachable[y]]=new m(p.unreachable[y],p.unreachableMap[p.unreachable[y]],f.unwalkable);return p.reachable.length>0&&(_[g]=new m(g,0,f.walkableLast)),window.background.removeTargetHighlights(),this._resetWalkLayer(_),p.costMP>0||p.costAP>0?n("tackle",{ap:p.costAP,mp:p.costMP}):n(!1),p},l.prototype.touchEnd=function(e,t,i){i=i||{},i.canvasX=e,i.canvasY=t;var n=this.mapScene.convertCanvasToSceneCoordinate(e,t),o=this.mapRenderer,s=o.getCellId(n.x,n.y),a=o.getCellSceneCoordinate(s.cell);o.addTapFeedback(a.x,a.y),this._touchEnd(n.x,n.y,s,i)};var S=null;l.prototype.cellHover=function(e){window.gui.playerData.isFighting&&S!==e&&(S=e,this.displayEffectZone(e))},l.prototype.cellHoverRelease=function(e){var t=this._shouldSkipConfirmBox(_.confirmBoxWhenDragCasting,e);this._spellRangeLayer&&this._spellRangeLayer.cellInfos.hasOwnProperty(e)?t?(this._castSpellImmediately(e),this.clearSpellDisplay()):this._castSpellImmediatelyConfirm(e):this.clearSpellDisplay(),this._isUserTurn&&t&&this.displayUserMovementZone()},l.prototype._touchEnd=function(e,t,i,n){n.hasOwnProperty("mode")&&(window.gui.pingSystem.isActive()?this._tapPing(e,t,i):"fightPlacement"===n.mode?this._tapFightPlacement(e,t,i,n):"fight"===n.mode&&void 0!==n.spellId?this._tapFightWithSpell(e,t,i,n):"fight"===n.mode&&this._isUserTurn?this._tapFight(e,t,i,n):"roleplay"===n.mode&&this._tapRoleplay(e,t,i,n),s())},l.prototype.getCellActors=function(e){return this.actorManager.occupiedCells[e]||[]},l.prototype.getCellActorsByTypes=function(e){var t=this.getCellActors(e),i=t.length,n={};n.onlinePlayer=[],n.merchantPlayer=[],n.npc=[],n.other=[];for(var o=0;o<i;o+=1){var s=t[o];s.isNPC()?n.npc.push(s):s.isMerchant()?n.merchantPlayer.push(s):s.isOnlinePlayer()?n.onlinePlayer.push(s):n.other.push(s)}return n},l.prototype.isCellEmpty=function(e){var t=this.actorManager.occupiedCells[e]||[];return!(t.length>0)},l.prototype._tapPing=function(e,t,i){var n=window.gui.pingSystem;if(n.isPingBoxOpen())return n.cancelPingBox();var o=i.cell;n.openPingBox(o,this.isCellEmpty(o))},l.prototype._tapRoleplay=function(e,t,i,n){var o=this,s=n.canvasX,a=n.canvasY,r=n.changeMapRequest,l=this.mapRenderer,c=this.actorManager.userActor,u=this.actionQueue.isActive();if(u){var d=this._tapInteractive(e,t);if(!d&&!c.moving&&(r=r||l.getFirstMapFlag(i.cell))){var h=!0,p=this.actionQueue.enqueue("changeMap",h,function(){o.gotoNeighbourMap(r,i.cell,s,a)});return void(p&&window.foreground.showBorderArrow(r,s,a))}}else this.lastContextualMenuSkillId=null;if(!c.isLocked){if(c.moving||this.isMovementWaitingForConfirmation){if(window.foreground.hideBorderArrow(),u&&!r&&this._tapInteractive(e,t))return;return this.clearHighlights(),this.actionQueue.clear(),void this.cancelUserActorMovement(function(){o._touchEnd(e,t,i,n)})}if(!r){if(this._tapInteractive(e,t))return;var m=this.actorManager.occupiedCells[i.cell];if(m&&m[0]&&m[0].position===i)return void(0===i.dist&&m[0].tap(e,t,l.camera))}this.clearHighlights();var f=i.cell;return(r=r||l.getFirstMapFlag(i.cell))?this.gotoNeighbourMap(r,i.cell,s,a):void this._movePlayerOnMap(f)}},l.prototype._tapFightWithSpell=function(e,t,i,n){var o=i.cell;window.foreground.fightIsUserTurn?n.hideConfirmWindow=!1:n.hideConfirmWindow=!0;var s=this._shouldSkipConfirmBox(_.confirmBoxWhenClickCasting,o);s?this._castSpell(o,e,t,n):this._castSpellConfirm(o,e,t,n)},l.prototype._shouldSkipConfirmBox=function(e,t){var i=!1;return e===y.NEVER?i=!0:e===y.EMPTY_ONLY?i=!this.isCellEmpty(t):e===y.ALWAYS&&(i=!1),i},l.prototype.displayUserMovementZone=function(){if(this.mapRenderer.isReady&&!window.gui.playerData.isSpectator){this.clearSpellDisplay();var e=this.actorManager.userActor,t=e.cellId,i=T||c.getReachableZone(e,t);this.clearUserMovementZone();var n,o={},s=window.isoEngine.actorManager.userActor.cellId;for(var a in i)if(i.hasOwnProperty(a)){var r,l=g.getDistance(s,a);r=i[a].reachable?i[a].isTackled?f.walkAreaRequiresAP:f.walkArea:f.walkAreaRestricted,o[a]=new m((~~a),l,r),n=!0}n&&this._resetWalkAreaLayer(o)}},l.prototype.tryDisplayUserMovementZone=function(){return this._spellRangeLayer?void this.displaySpellRange():void this.displayUserMovementZone()},l.prototype.displayEnemyMovementZone=function(e){if(this.mapRenderer.isReady){this.clearSpellDisplay();var t=this.actorManager.getActor(e.id);if(t){var i=t.cellId,n=c.getReachableZone(t,i);this._resetWalkAreaLayer();for(var o,s={},a=Object.keys(n),r=0;r<a.length;r++){var l,u=a[r],d=g.getDistance(i,u);l=n[u].reachable?n[u].isTackled?f.enemyWalkAreaRequiresAP:f.enemyWalkArea:f.enemyWalkAreaRestricted,s[u]=new m((~~u),d,l),o=!0}o&&this._resetEnemyWalkAreaLayer(s)}}},l.prototype.removeEnemyMovementZone=function(){this._resetEnemyWalkAreaLayer(),this._isUserTurn&&(window.foreground.isSpellSelected()?window.foreground._displaySpellRange():this.displayUserMovementZone())},l.prototype._tapFight=function(e,t,i){function n(e){return e?(h.unshift(l),window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameMapMovementRequestMessage",{keyMovements:u(h),mapId:a}),d._resetWalkLayer(),void s()):void d._resetWalkLayer()}var a=this.mapRenderer.map.id,r=i.cell,l=this.actorManager.userActor.cellId,c=window.foreground.confirmBox,d=this;if(this.actorManager.occupiedCells[r]||!this._isUserTurn)return o(),this._resetWalkLayer(),void c.close();if(I||(I=this._displayPathInFight(r)),!I||0===I.reachable.length||!M&&I.reachable.indexOf(r)===-1&&I.unreachable.indexOf(r)===-1)return o(),this._resetWalkLayer(),void c.close();var h=I&&I.reachable;if(h&&h.indexOf(r)>-1){var p={mp:I.costMP,ap:I.costAP},m=v(["move",p,h,r,a]);_.confirmBoxWhenWalking?c.open("move",p,n,m):n(!0)}else d._resetWalkLayer()},l.prototype._tapFightPlacement=function(e,t,i,n){var o=this.actorManager.occupiedCells[i.cell];if(o)return void(0===i.dist&&o[0].tap(e,t,this.mapRenderer.camera));var s=i.cell,a=n.possiblePlacements||[],r=a.indexOf(s);r!==-1&&(window.dofus.sendMessage("GameFightPlacementPositionRequestMessage",{cellId:s}),p("FIGHT_POSITION"))};var E,x;l.prototype.holdStart=function(){this.highlightAllInteractives(5),E=this._getAllInteractives(),x=null},l.prototype.holdEnd=function(){this.clearHighlights(),this.removeEnemyMovementZone()},l.prototype.holdAndMove=function(e,t){for(var i=this.mapScene.convertCanvasToSceneCoordinate(e,t),n=null,o=0;o<E.length;o++){var s=E[o];if(this._isElementClicked(s,i.x,i.y)){n=s;break}}return n?x===n?n:(x=n,this.clearHighlights(),this._addHighlight(n),n):(x=null,void this.clearHighlights())}},function(e,t,i){function n(e,t){var i=e.getFighter(),n=t.getFighter();return i&&n?i.data.stats.invisibilityState!==_&&(i.data.stats.invisibilityState!==v&&(i.data.teamId!==n.data.teamId&&(i.data.alive!==!1&&(!i.data.isCarryied&&(!i.hasState(b)&&(!i.hasState(y)&&i.canTackle)))))):(console.warn("canBeTackler: Corresponding fighters could not be found."),!1)}function o(e,t,i){var n=e.getFighter();return n?n.data.stats.invisibilityState!==_&&(n.data.stats.invisibilityState!==v&&((!n.data.isCarryied||t!==i)&&(!n.hasState(w)&&!n.hasState(y)))):(console.error("Corresponding fighter could not be found."),!1)}function s(e,t){var i=Math.max(0,e.getFighterData().stats.tackleEvade||0),n=Math.max(0,t.getFighterData().stats.tackleBlock||0);return(i+2)/(n+2)/2}function a(e,t,i,a,r,l){i=Math.max(0,i),a=Math.max(0,a);var c={mp:0,ap:0};if(!o(e,r,l))return c;if(0===t.length)return c;for(var u=0;u<t.length;u++){var d=t[u];if(d&&n(d,e)){var h=s(e,d);h>=1||(c.mp+=~~(i*(1-h)+.5),c.ap+=~~(a*(1-h)+.5))}}return c}function r(e,t,i,n,o,s,a,r){this.cellId=e,this.from=t,this.availableMp=i,this.availableAp=n,this.costMP=o,this.costAP=s,this.distance=a,this.numberDamagingMarks=r}function l(e,t){var i=0,n=0;return e.availableMp>t.availableMp?i+=1:e.availableMp<t.availableMp&&(n+=1),e.availableAp>t.availableAp?i+=1:e.availableAp<t.availableAp&&(n+=1),e.numberDamagingMarks<t.numberDamagingMarks?i+=1:e.numberDamagingMarks>t.numberDamagingMarks&&(n+=1),i===n?M.SAME:i>n?M.BETTER:i<n?M.WORSE:void 0}function c(e,t){return e.numberDamagingMarks<t.numberDamagingMarks?-1:e.numberDamagingMarks===t.numberDamagingMarks?e.availableMp>t.availableMp?-1:e.availableMp===t.availableMp?e.availableAp>t.availableAp?-1:e.availableAp===t.availableAp?0:1:1:1}function u(e,t,i,n,o){this.availableMp=e.mp,this.availableAp=e.ap,this.costMP=t.mp,this.costAP=t.ap,this.pathNodes=i,this.reachable=n,this.isTackled=o,this.path=null}function d(e,t){var i=0,n=t[e];if(!n)return i;for(var o=0;o<n.length;o+=1){var s=n[o].markType;s!==f.TRAP&&s!==f.WALL||(i+=1)}return i}function h(e,t){var i={},n=e.getFighterData(),o=n.stats,s=o.movementPoints;if(s<=0)return i;var l=window.actorManager,h=window.isoEngine.mapRenderer,m=[],f={},_=new r(t,null,o.movementPoints,o.actionPoints,0,0,1,0);m.push(_),f[t]=_;for(var v=l.getIndexedVisibleActors({showAlsoInvisibleInMyTeam:!0}),y=g.getCellIdsAffectedByMarks();m.length;){for(var b,w=m.pop(),M=w.cellId,T=p.getNeighbourCells(M,!1),C=[],I=0;I<T.length;){b=T[I];var A=v[b];void 0===b||A?(T.splice(I,1),A&&C.push(A)):I++}var S=a(e,C,w.availableMp,w.availableAp,t,M),E=S.ap>0||S.mp>0,x=w.availableMp-S.mp-1,L=w.availableAp-S.ap,N=o.movementPoints-x,O=o.actionPoints-L,D=w.distance+1,R=w.numberDamagingMarks+d(M,y),P=x>=0;for(I=0;I<T.length;I++)if(b=T[I],h.isWalkable(b)){_=new r(b,M,x,L,N,O,D,R);var B=i[b];if(B){var k=B.update(_,P,E);if(!k)continue}else i[b]=new u({ap:L,mp:x},{ap:O,mp:N},[_],P,E);w.distance<s&&m.push(_)}}for(var F in i)i.hasOwnProperty(F)&&i[F].pathNodes.sort(c);return i}var p=i(895),m=i(410),f=i(1389),g=i(1368),_=m.INVISIBLE,v=m.DETECTED,y=6,b=95,w=96,M={SAME:1,WORSE:2,BETTER:3};u.prototype.update=function(e,t,i){for(var n=0;n<this.pathNodes.length;n+=1){var o=l(e,this.pathNodes[n]);if(o===M.SAME||o===M.WORSE)return!1;if(o===M.BETTER){this.pathNodes[n]=e;break}}return this.availableAp=e.availableAp,this.availableMp=e.availableMp,this.costMP=e.costMP,this.costAP=e.costAP,this.reachable=t,this.isTackled=i,!0},t.getReachableZone=h},function(e,t){e.exports={GLYPH:1,TRAP:2,WALL:3}},function(e,t,i){function n(e,t){var i=a(e),n=a(t),o=Math.abs(i.x-n.x)+Math.abs(i.y-n.y);return o}function o(e,t){var i=a(e),n=a(t),o=i.x-n.x,s=i.y-n.y;return Math.sqrt(o*o+s*s)}var s=i(895),a=s.getMapPointFromCellId;e.exports.getCellDistance=n,e.exports.getDistance=o},function(e,t){function i(){this.reachable=[],this.unreachable=[],this.costMP=0,this.costAP=0,this.reachableMap={},this.unreachableMap={}}e.exports=i,i.prototype.addNode=function(e,t,i){t.reachable?(this.reachable.push(e),this.reachableMap[e]=i):(this.unreachable.push(e),this.unreachableMap[e]=i),this.costMP=t.costMP,this.costAP=t.costAP}},function(e,t,i){function n(e,t,i,n){for(var o=h(i),s=Object.keys(t),a=0;a<s.length;a++){for(var r=s[a],u=h(r),p=c.getLine(o.x,o.y,u.x,u.y),m=!1,f=0,g=p.length;f<g;f++){var _=l(p[f].x,p[f].y),v=e[_];if(n[_]&&f<g-1||2!==(2&v.l)){m=!0;break}}m&&(t[r].transformState=window.foreground.fightIsUserTurn?d.outSight:d.outSightEnemyTurn)}return t}var o=i(1347),s=i(1374),a=i(1386).trueName,r=i(895),l=r.getCellIdFromMapPoint,c=i(1393),u=i(302),d=i(303),h=r.getMapPointFromCellId,p=null,m=null;o.prototype._initGridOverlayLayers=function(){this._fightPositionLayer=null,this._spellRangeLayer=null,this._spellEffectLayer=null,this._walkLayer=null,this._walkAreaLayer=null,this._enemyWalkAreaLayer=null},o.prototype._resetFightPositionLayer=function(e){this.background.removeGridLayer(this._fightPositionLayer),this._fightPositionLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetSpellRangeLayer=function(e){this.background.removeGridLayer(this._spellRangeLayer),this._spellRangeLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetSpellEffectLayer=function(e){this.background.removeGridLayer(this._spellEffectLayer),this._spellEffectLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetWalkLayer=function(e){this.background.removeGridLayer(this._walkLayer),this._walkLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetWalkAreaLayer=function(e){this.background.removeGridLayer(this._walkAreaLayer),this._walkAreaLayer=e?this.background.addGridAnimation(e):null},o.prototype._resetEnemyWalkAreaLayer=function(e){this.background.removeGridLayer(this._enemyWalkAreaLayer),this._enemyWalkAreaLayer=e?this.background.addGridAnimation(e):null},o.prototype.clearUserMovementZone=o.prototype._resetWalkAreaLayer,o.prototype.setCurrentSpell=function(e){p=e},o.prototype.displaySpellRange=function(){if(this.mapRenderer.map&&this.mapRenderer.map.cells&&p&&!this.actorManager.userActor.isDead){this.clearUserMovementZone();for(var e=this.mapRenderer.map.cells,t=this.actorManager.userActor.cellId,i=s.getSpellRange(e,t,p),o=window.actorManager.getIndexedVisibleActors(),a={},l={},c=window.foreground.fightIsUserTurn?d.outSight:d.outSightEnemyTurn,h=window.foreground.fightIsUserTurn?d.inSight:d.inSightEnemyTurn,f=0;f<i.length;f++){var g=r.getCellIdFromMapPoint(i[f][0],i[f][1]);if(void 0!==g&&!a[g])if(p.needFreeCell&&o[g])l[g]=i[f][2],a[g]=new u(g,i[f][2],c);else{var _=e[g].l||0;3===(7&_)&&(a[g]=new u(g,i[f][2],h),l[g]=i[f][2])}}p.castTestLos&&n(e,a,t,o),m=a,this._resetSpellRangeLayer(a),this._spellEffectLayer&&this._resetSpellEffectLayer(this._spellEffectLayer.cellInfos),this._walkLayer&&(this._resetWalkLayer(),window.foreground.confirmBox.hide())}},e.exports.getCell=n,o.prototype.displayEffectZone=function(e){if(this.background.removeTargetHighlights(),m&&p){if(!m.hasOwnProperty(e))return void this._resetSpellEffectLayer();if(m[e].transformState===d.outSight||m[e].transformState===d.outSightEnemyTurn)return void this._resetSpellEffectLayer();if(this.mapRenderer.map&&this.mapRenderer.map.cells){for(var t=this.actorManager.userActor.cellId,i=this.mapRenderer.map.cells,n=s.getSpellEffectZone(i,t,e,p.zoneEffect),o=this.actorManager.occupiedCells,a=Object.keys(n),r=0;r<a.length;r++)if(t=a[r],o[t]){var l=o[t][0],c=l.getTeamId();0===c?this.background.addTargetHighLights(t,o[t][0]._x,o[t][0]._y,d.redTeamStart,d.redTeamEnd,!window.foreground.fightIsUserTurn):this.background.addTargetHighLights(t,o[t][0]._x,o[t][0]._y,d.blueTeamStart,d.blueTeamEnd,!window.foreground.fightIsUserTurn)}this._resetSpellEffectLayer(n)}}},o.prototype._castSpell=function(e,t,i,n){var o=this.mapRenderer.grid.getNearbyCellInZone(e,t,i,m);return null===o?(window.foreground.deselectSpell(),window.gui.shortcutBar.deselectCurrentSlot(),void this.clearSpellDisplay()):(this.displayEffectZone(o),window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameActionFightCastRequestMessage",{spellId:p.spellId,cellId:o}),window.gui.fightManager.spellCastSucceeded(n.spellId,n.characterId),p=null,this.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot())},o.prototype._castSpellConfirm=function(e,t,i,n){var o=this.mapRenderer.grid.getNearbyCellInZone(e,t,i,m);if(null===o)return window.foreground.deselectSpell(),void window.gui.shortcutBar.deselectCurrentSlot();this.displayEffectZone(o);var s=a(["spell",p.spellId,e,o]),r=this;window.foreground.confirmBox.open("spell",p,function(e){return e?(window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameActionFightCastRequestMessage",{spellId:p.spellId,cellId:o}),window.gui.fightManager.spellCastSucceeded(n.spellId,n.characterId),p=null,r.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot()):(r.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot())},s,n.hideConfirmWindow)},o.prototype._castSpellImmediately=function(e){if(m&&p){if(null===e)return window.foreground.deselectSpell(),void window.gui.shortcutBar.deselectCurrentSlot();window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameActionFightCastRequestMessage",{spellId:p.spellId,cellId:e}),window.gui.fightManager.spellCastSucceeded(p.spellId,window.gui.playerData.characters.controlledCharacterId),this.clearSpellDisplay(),p=null,window.gui.shortcutBar.deselectCurrentSlot()}},o.prototype._castSpellImmediatelyConfirm=function(e){if(m&&p){if(null===e)return window.foreground.deselectSpell(),void window.gui.shortcutBar.deselectCurrentSlot();var t=a(["spell",p.spellId,e,e]),i=this;window.foreground.confirmBox.open("spell",p,function(t){return t?(window.gui.emit("checkServerLag","fightAction","start"),window.dofus.sendMessage("GameActionFightCastRequestMessage",{spellId:p.spellId,cellId:e}),window.gui.fightManager.spellCastSucceeded(p.spellId,window.gui.playerData.characters.controlledCharacterId),p=null,i.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot()):(i.clearSpellDisplay(),void window.gui.shortcutBar.deselectCurrentSlot())},t,!window.foreground.fightIsUserTurn)}},o.prototype.displayFightPositions=function(e){for(var t={},i=0,n=0;n<e.positionsForChallengers.length;n++){var o=e.positionsForChallengers[n];t[o]=new u(o,i,d.fullRed)}for(var s=0;s<e.positionsForDefenders.length;s++)o=e.positionsForDefenders[s],t[o]=new u(o,i,d.fullBlue);this._resetFightPositionLayer(t)},o.prototype.clearSpellDisplay=function(){this.background.removeTargetHighlights(),this._resetSpellEffectLayer(),this._resetSpellRangeLayer()}},function(e,t){e.exports.getLine=function(e,t,i,n){var o=[];e+=.5,t+=.5,i+=.5,n+=.5;var s=0,a=0,r=0,l=0;Math.abs(e-i)===Math.abs(t-n)?(r=Math.abs(e-i),s=i>e?1:-1,a=n>t?1:-1,l=1):Math.abs(e-i)>Math.abs(t-n)?(r=Math.abs(e-i),s=i>e?1:-1,a=(n-t)/r,a*=100,a=Math.ceil(a)/100,l=2):(r=Math.abs(t-n),s=(i-e)/r,s*=100,s=Math.ceil(s)/100,a=n>t?1:-1,l=3);for(var c=~~(3+r/2),u=~~(97-r/2),d=0;d<r;d++){var h,p,m=e+s,f=t+a;if(2===l){var g=Math.ceil(100*t+50*a)/100,_=Math.floor(100*t+150*a)/100,v=Math.floor(Math.abs(100*Math.floor(g)-100*g))/100,y=Math.ceil(Math.abs(100*Math.ceil(_)-100*_))/100;h=Math.floor(m),Math.floor(g)===Math.floor(_)?(p=Math.floor(f),(g===p&&_<p||_===p&&g<p)&&(p=Math.ceil(f)),o.push({x:h,y:p})):Math.ceil(g)===Math.ceil(_)?(p=Math.ceil(f),(g===p&&_<p||_===p&&g<p)&&(p=Math.floor(f)),o.push({x:h,y:p})):~~(100*v)<=c?o.push({x:h,y:Math.floor(_)}):~~(100*y)>=u?o.push({x:h,y:Math.floor(g)}):(o.push({x:h,y:Math.floor(g)}),o.push({x:h,y:Math.floor(_)}))}else if(3===l){var b=Math.ceil(100*e+50*s)/100,w=Math.floor(100*e+150*s)/100,M=Math.floor(Math.abs(100*Math.floor(b)-100*b))/100,T=Math.ceil(Math.abs(100*Math.ceil(w)-100*w))/100;p=Math.floor(f),Math.floor(b)===Math.floor(w)?(h=Math.floor(m),(b===h&&w<h||w===h&&b<h)&&(h=Math.ceil(m)),o.push({x:h,y:p})):Math.ceil(b)===Math.ceil(w)?(h=Math.ceil(m),
(b===h&&w<h||w===h&&b<h)&&(h=Math.floor(m)),o.push({x:h,y:p})):~~(100*M)<=c?o.push({x:Math.floor(w),y:p}):~~(100*T)>=u?o.push({x:Math.floor(b),y:p}):(o.push({x:Math.floor(b),y:p}),o.push({x:Math.floor(w),y:p}))}else o.push({x:Math.floor(m),y:Math.floor(f)});e=(100*e+100*s)/100,t=(100*t+100*a)/100}return o}},function(e,t,i){function n(e,t){return"fight:"+e+":"+t}function o(e){_[e]&&(console.warn("Fight with id "+e+" already exist."),_[e].remove()),this.id=e,this.teams={},_[e]=this}function s(e,t){switch(e.fightType){case c.FIGHT_TYPE_AGRESSION:return O[t.teamSide][~~(t.teamTypeId===d.TEAM_TYPE_BAD_PLAYER)];case c.FIGHT_TYPE_Koh:var i,n=null,o=null,s=null;switch("FightTeamMemberWithAllianceCharacterInformations"===t.teamMembers[0]._type&&(n=t.teamMembers[0].allianceInfos.allianceId),!0){case null!==o&&o===n:i=0;break;case null!==s&&n===s:i=1;break;default:i=2}return D[t.teamId][i];case c.FIGHT_TYPE_CHALLENGE:return v;case c.FIGHT_TYPE_PvT:return t.teamId===u.TEAM_CHALLENGER?v:b;default:return t.teamId===u.TEAM_CHALLENGER?v:y}}var a=i(1347),r=i(184),l=i(394),c=i(752),u=i(390),d=i(985),h=i(430),p=i(759),m=i(269),f=l.FIGHT_OPTION_KEY_TO_ENUM,g=l.FIGHT_OPTION_ICON_ID,_={};o.prototype.addTeam=function(e,t){this.teams[e]={id:e,contextualId:n(this.id,e),icons:{},options:{},cellId:t}},o.prototype.remove=function(){for(var e in this.teams){var t=this.teams[e];window.actorManager.removeActor(t.contextualId);for(var i in t.icons)t.icons[i].remove()}delete _[this.id]},o.prototype._createIcon=function(e,t,i){function n(i){return _[o.id]?a.icons[t]?i.release():(a.icons[t]=new p({layer:r.MAP_LAYER_ICONS,w:i.element.width,h:i.element.height,scene:s},i),a.options[t]||a.icons[t].hide(),void o._updateIconsPosition(e)):i.release()}var o=this,s=window.isoEngine.mapScene,a=this.teams[e];return a?g.indexOf(t)===-1?console.error(new Error("Unknown fightOption:"+t)):a.icons[t]?(console.warn("Icon "+t+" already exists for team "+e+" in fight "+this.id),void a.icons[t].show()):void h.loadTexture(i,n,s.renderer):console.error(new Error("No team with id "+e+" in fight "+this.id))},o.prototype._updateIconsPosition=function(e){var t=this.teams[e];if(!t)return console.error(new Error("No team with id "+e+" in fight "+this.id));var i=0,n=0;for(var o in t.icons)t.icons[o].isDisplayed&&i++,n=Math.max(t.icons[o].w,n);var s=.1*n,a=window.isoEngine.mapRenderer.grid.getSceneCoordinateFromCellId(t.cellId),l=a.x-(n+s)/2*(i-1),c=0;for(o in t.icons)t.icons[o].isDisplayed&&(t.icons[o].x=l+c*(n+s)-t.icons[o].w/2,t.icons[o].y=a.y-2.1*r.CELL_HEIGHT,c++)},o.prototype.setFightOption=function(e,t,i){var n=this.teams[e];if(!n)return console.error(new Error("No team with id "+e+" in fight "+this.id));if(void 0===n.options[t])return n.options[t]=i,void this._createIcon(e,t,"ui/spectator/fightOption"+t+".png");if(n.options[t]=i,n.icons[t]){var o=i?"show":"hide";n.icons[t][o](),this._updateIconsPosition(e)}},o.prototype.challengeOptionChange=function(e,t,i){var n=this.teams[e];return n?void(g.indexOf(t)!==-1&&this.setFightOption(e,t,i)):console.error(new Error("No team with id "+e+" in fight "+this.id))};var v=19,y=20,b=21,w=32,M=33,T=1237,C=1235,I=1236,A=2248,S=2249,E=2251,x=2252,L=2253,N=2255,O={"-1":[v,v],0:[T,T],1:[C,w],2:[I,M],3:[T,T]},D={0:[A,E,S],1:[x,N,L]};a.prototype.showChallenge=function(e){for(var t=this.actorManager,i=e.fightId,a=e.fightTeams,r=e.fightTeamsPositions,l=e.fightTeamsOptions,c=new o(i),u=0;u<a.length;u++){var d=a[u],h=s(e,d);d.fightId=i,d.look={bonesId:h,scales:[100],skins:[],indexedColors:[]},d.disposition={cellId:r[u],direction:0},d.contextualId=n(i,d.teamId),t.addEmptyActor(d),c.addTeam(d.teamId,r[u]),t.setActorLook(d.contextualId,d.look,{},null);for(var p in l[u])void 0!==f[p]&&l[u][p]&&c.setFightOption(d.teamId,f[p],!0)}},a.prototype.addChallenges=function(e){for(var t=0;t<e.length;t++)this.showChallenge(e[t])},a.prototype.removeChallenge=function(e){var t=_[e];return t?void t.remove():console.warn("No challenge with id "+e)},a.prototype.cleanupChallenges=function(){for(var e in _)_[e].remove()},a.prototype.challengeOptionChange=function(e,t,i,n){var o=_[e];return o?void o.challengeOptionChange(t,i,n):console.warn("No challenge with id "+e)},a.prototype.updateFightTeam=function(e){if(!m.isFightMode){var t=e.fightId,i=e.team;i.fightId=t;var o=i.teamId,s=n(t,o),a=this.actorManager.getActor(s);return a?void a.updateData(i):console.warn("No fight id "+s)}}},function(e,t,i){var n=i(1347),o=i(31),s=i(1369),a=i(1375),r=i(419),l=i(258).playUiSound,c=i(184),u=i(1363),d=i(1378),h=i(439),p=h.Tween,m=h.easing;n.prototype.checkAndConstructAnimType=function(e,t){if(!this.actorManager.isCreatureModeOn&&t){if(0===e.emoteId)return void t.staticAnim();var i=e._emote;if(i){var n=i.defaultAnim;if(n=n.substring(0,1).toUpperCase()+n.substring(1)+"_0",!i.eight_directions){var o=2*~~(t.direction/2)+1;o!==t.direction&&t.setDisposition(null,o)}return n}}},n.prototype.playEmote=function(e){var t=this.actorManager.getActor(e.actorId),i=this.checkAndConstructAnimType(e,t);i&&t.loadAndPlayAnimation({base:"AnimEmote",type:i},!1)},n.prototype.playRelookedEmote=function(e){var t=this.actorManager.getActor(e.actorId),i=this.checkAndConstructAnimType(e,t);i&&window.actorManager.setActorLook(e.actorId,e.look,{noSmokeAnimation:!0},function(){t.loadAndPlayAnimation({base:"AnimEmote",type:i},!1)})},n.prototype.playLevelUpAnimation=function(e){var t=this.actorManager.getActor(e);if(t){var i,n=t.look;if(n&&n.skins&&n.skins[0]){var o=n.skins[0];i=(1&o).toString()}else i=Math.random()<.5?"0":"1";var s;if(n&&1===n.bonesId)s="AnimEmoteInterface_"+i;else if(t.isRiding){var a=r.getLookOfRider(n);a&&2===a.bonesId&&(s="AnimLevelUpRiding")}s&&t.loadAndPlayAnimation({base:s,direction:1},!1),l("LEVEL_UP");var h=t.x,f=t.y,g="LEVEL UP",_=this.bitmapFonts.characters,v=new d({x:h,y:f,scene:this.mapScene,text:g,fallbackText:g,layer:c.MAP_LAYER_POINT_LABELS,bitmapFont:_,color:[.3,.5,-.1,0]});v.scaleX=.7,v.scaleY=.7,new p(v,["y","alpha"]).from({y:f,alpha:0}).to({y:f,alpha:0},9).to({y:f-40,alpha:1},8,m.backOut,2).to({y:f-40,alpha:1},16).to({y:f-90,alpha:0},12,m.backIn,2).onFinish(function(){v.remove()}).start();var y=new u(t.position,h,f);y.red=1,y.green=1,y.blue=.9,new p(y,["scaleX","scaleY","alpha"]).from({scaleX:.3,scaleY:.3,alpha:0}).to({scaleX:1,scaleY:1,alpha:1.7},7,m.polyOut,4).to({scaleX:.3,scaleY:1,alpha:1.7},20,m.polyOut,2).to({scaleX:.3,scaleY:1,alpha:0},7,m.polyOut,2).onFinish(function(){y.remove()}).start()}},n.prototype.playRoleplaySpellAnim=function(e,t){var i=new s;i.runSequence([e],function(){var i=[];a(e,i),o.series(i,t)})}},function(e,t,i){var n=i(1347),o=14,s=40;n.prototype._logMap=function(e){e=e||[];for(var t={},i=0;i<e.length;i++)t[e[i]]=!0;var n,a,r,l,c=this.mapRenderer.map,u=this.actorManager.occupiedCells,d=this.actorManager.userActor,h="",p=[];for(n=0;n<o;n++)h+="   ";var m=!0;for(a=0;a<s;a++){for(h+="\n",h+=m?"":"",n=0;n<o;n++)r=a*o+n,l=r<100?" ":"",l+=r,l+=r<10?" ":"",h+=m?"%c"+l+"%c":"%c"+l+"%c",t[r]?p.push("background-color: #FF0"):c&&2!==(2&c.cells[r].l)?p.push("background-color: #00F"):c&&0===(1&c.cells[r].l)?p.push("background-color: #113; color: #779"):d.cellId===r?p.push("background-color: #CD8; color: #072"):u[r]?p.push("background-color: #F88"):p.push("background-color: #FFF"),p.push("background-color: #FFF, color: #000");m=!m}for(h+="\n ",n=0;n<o;n++)h+="   ";p.unshift(h),console.log.apply(window.console,p)}},function(e,t,i){function n(e){this.progressEgg=new f({scene:e,position:5,alpha:1,x:e.w/2,y:e.h/2,isHudElement:!0,id:"loadingProgressEgg"}),this.progressEgg.setAnimManager(new g(this.progressEgg,new _(""),1.7,0)),this.progressEggFrameTween=new h(this.progressEgg.animManager,["frame"]),this.hide()}function o(e,t){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);for(var o in t)if(t.hasOwnProperty(o)){i[o]||(i[o]=[]);for(var s=t[o],a=0;a<s.length;a+=1)i[o].push(s[a])}return i}function s(e,t){var i=e.width,n=e.height,o=t.width,s=t.height,a={};for(var r in e.graphicsPositions)e.graphicsPositions.hasOwnProperty(r)&&(a[r]=e.graphicsPositions[r]);for(var l in t.graphicsPositions)if(t.graphicsPositions.hasOwnProperty(l)){if(a[l])continue;var c=t.graphicsPositions[l];c.sx+=i,a[l]=c}return{width:i+o,height:Math.max(n,s),graphicsPositions:a}}var a=i(184),r=i(1347),l=i(894),c=i(31),u=i(202),d=i(427),h=i(439).Tween,p=i(439).easing,m=i(759),f=i(1357),g=i(438),_=i(436),v=i(271),y=i(269),b=1200,w=100,M=20;n.prototype.loadAssets=function(e){var t=this.progressEgg.animManager,i=this.progressEgg.renderer;d.loadTemplate("loader","loadingLogo","",function(i){t.template=i,t.assignSymbol({base:"loadeur",direction:-1},!1),t.tween.stop(),t.frame=0,e()},i,"archivable")},n.prototype.hide=function(){this.progressEgg.hide(),this.progressEgg.animManager.clear()},n.prototype.show=function(){this.progressEgg.show()},r.prototype._initLoadingProgress=function(){this._loadingProgress=new n(this.mapScene),this._resetTransition()},r.prototype._resetTransition=function(){this._loadingFadeInTransitionRunning=!1,this._loadingProgressVisible=!1,this._waitingForMessage=!1,this._mapLoadingMessage=null,this._isMapLoading=!1,this._mapSceneTransitionGraphic=null},r.prototype.showLoadingProgress=function(e){var t=this._loadingProgress.progressEgg,i=t.animManager.nbFrames;this._loadingProgressVisible===!1?(this._loadingProgressVisible=!0,t.x=this.mapScene.w/2,t.y=this.mapScene.h/2,this._loadingProgress.show(),this._loadingProgress.progressEggFrameTween.reset().from({frame:0}).to({frame:.4*i},30,p.polyIn,2).start()):this._loadingProgress.progressEggFrameTween.reset().from({frame:t.animManager.frame}).to({frame:(.7*e+.4)*i},5).start()},r.prototype._hideLoadingProgress=function(){this._loadingProgressVisible=!1,this._loadingProgress.hide()},r.prototype.mapTransitionDisconnect=function(){this._mapSceneTransitionGraphic&&(this._mapSceneTransitionGraphic.remove(),this._resetTransition())},r.prototype._makeUserActorWalkInDirection=function(e,t){this.makeActorWalkInDirection(this.actorManager.userActor,e,t)},r.prototype.makeActorWalkInDirection=function(e,t,i,n){if(e){var o;switch(t){case"top":o=6;break;case"bottom":o=2;break;case"left":o=4;break;case"right":o=0;break;default:o=0}var s=a.ANGLE_PER_DIRECTION[o];i&&(s+=Math.PI);var r=Math.cos(s)*w,l=Math.sin(s)*w;e.walkToSceneCoordinate(e.x+r,e.y+l,o,M,n)}else if(console.error(new Error("makeActorWalkInDirection: actor is "+e)),n)return n()},r.prototype.launchMapTransition=function(e){var t=this;this._loadingProgress.loadAssets(function(){t.mapScene.setShader("mapTransition"),t.emit("launchMapTransition",e),t._activateMapScene()?(t._loadingProgress.progressEgg.alpha=1,t.mapScene.renderingParams.ratio=1,t._saveImageForTransition("black"),t._startLoading()):t._loadingFadeInTransitionRunning===!1&&(t._isMapLoading?t._startLoading():(e&&t._makeUserActorWalkInDirection(e,!1),t._runLoadingFadeInTransition()))})},r.prototype.cancelMapTransition=function(e){this.emit("cancelMapTransition",e),this.actorManager.userActor.setOnScreenPosition(this.actorManager.userActor.position),this._makeUserActorWalkInDirection(e,!0),this._waitingForMessage&&this._runLoadingFadeOutTransition(),this._mapLoadingMessage=null,this._waitingForMessage=!1},r.prototype._saveImageForTransition=function(e){var t=b,i=t*this.mapScene.h/this.mapScene.w,n=this.mapScene.renderer,o=n.startTextureUsage(t,i,1,null,"linear");if(n.startTextureRendering(o,0,t,0,i,!1),"black"===e)this.mapScene.clear(0,0,0,1);else{var s=t/this.mapScene.w;n.save(),n.scale(s,s),this.mapScene.render(),n.restore()}var a=!0;n.stopTextureRendering(a),null===this._mapSceneTransitionGraphic?this._mapSceneTransitionGraphic=new m({w:this.mapScene.w,h:this.mapScene.h,scene:this.mapScene,position:0,isHudElement:!0,alpha:1},o.texture):(this._mapSceneTransitionGraphic.clear(),this._mapSceneTransitionGraphic.texture=o.texture,this._mapSceneTransitionGraphic.show())},r.prototype._runLoadingFadeInTransition=function(){this._loadingFadeInTransitionRunning=!0,this._waitingForMessage=!0,this.showLoadingProgress(0),new h(this._loadingProgress.progressEgg,["alpha","scaleX","scaleY"]).from({alpha:0,scaleX:.8,scaleY:.8}).to({alpha:1,scaleX:1,scaleY:1},15,p.backOut,1.5).start(),this.mapScene.renderingParams.ratio=0;var e=this;new h(this.mapScene.renderingParams,["ratio"]).from({ratio:0}).to({ratio:1},15,p.polyInOut,3).start().onFinish(function(){e._saveImageForTransition("current"),e._loadingFadeInTransitionRunning=!1,e._startLoading()})},r.prototype._runLoadingFadeOutTransition=function(){var e=this,t=this.mapScene;new h(this._loadingProgress.progressEgg,["alpha","scaleX","scaleY"]).from({alpha:1,scaleX:1,scaleY:1}).to({alpha:0,scaleX:.8,scaleY:.8},10,p.backIn,1.5).start(),new h(this._mapSceneTransitionGraphic,["alpha"]).from({alpha:1}).to({alpha:0},10).onFinish(function(){null!==e._mapSceneTransitionGraphic&&(e._mapSceneTransitionGraphic.remove(),e._mapSceneTransitionGraphic=null)}).start(),new h(t.renderingParams,["ratio"]).from({ratio:1}).to({ratio:0},25,p.polyInOut,2).onFinish(function(){t.setShader("unfiltering"),t.renderingParams.ratio=.15,e._hideLoadingProgress()}).start(),y.isRoleplayMode&&this.makeActorWalkIn(this.actorManager.userActor)},r.prototype.makeActorWalkIn=function(e,t,i){t=t||100;var n,o=this.mapScene,s=e.x,r=e.y,l=Math.abs(o.l-s),c=Math.abs(o.l+o.w-s),u=Math.abs(o.t-r),d=Math.abs(o.t+o.h-r),h=l<t,p=c<t,m=u<t,f=d<t;if(h)n=m?1:f?7:0;else if(p)n=m?3:f?5:4;else if(m)n=2;else{if(!f)return;n=6}var g=a.ANGLE_PER_DIRECTION[n];e.x-=Math.cos(g)*w,e.y-=Math.sin(g)*w,e.walkToSceneCoordinate(s,r,n,M,i)},r.prototype.loadMap=function(e){this.changeMapTimeout?(window.clearTimeout(this.changeMapTimeout),this.changeMapTimeout=null):window.foreground.lock("loadMap"),this._mapLoadingMessage=e,this._loadingFadeInTransitionRunning===!1&&(this._waitingForMessage?this._startLoading():this.launchMapTransition())},r.prototype.reloadMap=function(e){if(!this.mapRenderer.isReady){var t=this;return void this.mapRenderer.once("ready",function(){t.reloadMap(e)})}this._updateMapInfoData(e,{noMovementWaitReset:!0}),window.foreground.show(),window.foreground.unlock("loadMap"),this.actorManager.updateMapInfoData(e),this.emit("mapLoaded",{isReload:!0}),this.interactiveBlink&&this.highlightInteractivesWithDifferentType()};var T=null,C=null;r.prototype._startLoading=function(){var e=this._mapLoadingMessage;if(null!==e){this._mapLoadingMessage=null,this._waitingForMessage=!1,this.actorManager.pause();var t=e.mapId,i=e.obstacleMapId;if(t!==C){this.releaseMap(C),C=t,this._isMapLoading=!0;var n=this,r=a.MAP_PATH+i+".json",l=a.MAP_PATH+t+".json",d=null,h=null;c.series([function(e){return i?void u.loadJson(r,function(t){return d=t,e()}):e()},function(e){u.loadJson(l,function(t){return h=t,d&&(h.obstacleMapId=i,h.cells=d.cells,h.midgroundLayer=o(h.midgroundLayer,d.midgroundLayer),h.atlasLayout=s(h.atlasLayout,d.atlasLayout)),e()})}],function(t){return t?window.dofus.disconnect("LOADING_MAP_ERROR "+t):h===a.EMPTY_JSON?window.dofus.disconnect("ASSET_MISSING"):void(h.id===C&&(null===T?(T={msg:e,mapData:h},n._loadMapAssets()):T={msg:e,mapData:h}))})}}},r.prototype._loadMapAssets=function(){var e=T.msg,t=T.mapData,i=this;this.mapRenderer.setMap(T,function(){return null!==T&&C!==t.id?void i._loadMapAssets():(window.foreground.show(),window.foreground.unlock("loadMap"),l.fillPathGrid(t),i._updateMapInfoData(e),i.actorManager.updateMapInfoData(e),i.actorManager.unpause(),i.actorManager.userActor.moving=!1,v.unlockMessages(),i.emit("mapLoaded"),i._runLoadingFadeOutTransition(),i.interactiveBlink&&i.highlightInteractivesWithDifferentType(),C=null,T=null,void(i._isMapLoading=!1))})}}]);
//# sourceMappingURL=script.js.map